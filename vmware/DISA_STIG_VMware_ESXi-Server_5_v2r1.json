{
    "custom_item_1": {
        "description": "ESXI5-VMNET-000003 - All virtual switches must have a clear network label.",
        "info": "Network labels must identify each port group with a name. These names are important because they serve as a functional descriptor for the port group. Without these descriptions, identifying port groups and their functions becomes difficult as the network becomes more complex.",
        "solution": "From the vSphere Client/vCenter, navigate to Home>> Inventory>> Networking. Clearly label/rename all port groups with a meaningful name.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39358,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250545r798634_rule,STIG-ID|ESXI5-VMNET-000003,STIG-Legacy|SV-51216,STIG-Legacy|V-39358,SWIFT-CSCv1|2.3,Vuln-ID|V-250545",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": ".+ \\\\(",
        "not_expect": "(portgroup name NOT configured)"
    },
    "custom_item_2": {
        "description": "ESXI5-VMNET-000004 - Virtual switch VLANs must be fully documented and have only the required VLANs.",
        "info": "When defining a physical switch port for trunk mode, only specified VLANs must be configured on the VLAN trunk link. The risk with not fully documenting all VLANs on the vSwitch is that it is possible that a physical trunk port might be configured without needed VLANs, or with unneeded VLANs, potentially enabling an administrator to either accidentally or maliciously connect a VM to an unauthorized VLAN.",
        "solution": "Both standard and distributed vSwitch configurations can be viewed in the vSphere Client. For vSwitch: Home>> Inventory>> Hosts and Clusters, then select an ESXi host in Inventory panel on left. In the Configuration tab, Hardware window, under Networking, select each vSwitch, and for each port group on the vSwitch, verify and record the VLAN IDs used. For dvSwitches, go to Home>> Inventory>> Networking and for each dvSwitch in the inventory, and for each dvPortGroup in each dvSwitch, select Edit Settings>> Policies>> VLAN and record all VLAN IDs.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39359,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250546r798637_rule,STIG-ID|ESXI5-VMNET-000004,STIG-Legacy|SV-51217,STIG-Legacy|V-39359,SWIFT-CSCv1|2.3,Vuln-ID|V-250546",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": ""
    },
    "custom_item_3": {
        "description": "ESXI5-VMNET-000005 - All vSwitch and VLAN IDs must be fully documented - 'vSwitch labels'",
        "info": "VLAN tagging used on a vSwitch must correspond to the IDs on external VLAN-aware upstream switches, if any. If VLAN IDs are not tracked completely, mistaken re-use of IDs could allow for traffic to be allowed between inappropriate physical and virtual machines. Similarly, wrong or missing VLAN IDs may lead to traffic not passing between appropriate physical and virtual machines.",
        "solution": "From the vSphere Client/vCenter: Go to 'Home>> Inventory>> Hosts and Clusters'. Select each ESXi host with virtual switches connected to active VMs. Go to 'Configuration>> Network>> vSwitch(?)>> Properties>> Ports>> [Portgroup Name]>> VLAN ID'. Record all VLAN IDs in a (site-specific) tracking system.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39360,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250547r798640_rule,STIG-ID|ESXI5-VMNET-000005,STIG-Legacy|SV-51218,STIG-Legacy|V-39360,SWIFT-CSCv1|2.3,Vuln-ID|V-250547",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": ""
    },
    "custom_item_4": {
        "description": "ESXI5-VMNET-000009 - All port groups must be configured with a clear network label.",
        "info": "Each port group must be identified with a network label/name. Names serve as a functional descriptor for the port group. Without these descriptions, identifying port groups and functions becomes difficult as the network becomes more complex.",
        "solution": "From the vSphere Client/vCenter, navigate to Home>> Inventory>> Networking. Clearly label all individual port groups with a meaningful name.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39366,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250551r798652_rule,STIG-ID|ESXI5-VMNET-000009,STIG-Legacy|SV-51224,STIG-Legacy|V-39366,SWIFT-CSCv1|2.3,Vuln-ID|V-250551",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": ".+ \\\\(",
        "not_expect": "(portgroup name NOT configured)"
    },
    "custom_item_5": {
        "description": "ESXI5-VMNET-000011 - All port groups must not be configured to VLAN 4095 except for Virtual Guest Tagging (VGT) - VGT",
        "info": "When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial-of-service or allow a guest VM to interact with traffic on an unauthorized VLAN.",
        "solution": "Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server, click on the desired host. Click the Configuration tab. Click Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively. Start the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and run the command to set the value to something other than the VGT 4095 value.\nesxcli network vswitch standard portgroup set --portgroup-name=--vlan-id=Re-enable Lockdown Mode on the host.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39368,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250553r798658_rule,STIG-ID|ESXI5-VMNET-000011,STIG-Legacy|SV-51226,STIG-Legacy|V-39368,SWIFT-CSCv1|2.3,Vuln-ID|V-250553",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "vlanId =",
        "not_expect": "vlanId = 4095"
    },
    "custom_item_6": {
        "description": "ESXI5-VMNET-000013 - The system must ensure that the virtual switch Forged Transmits policy is set to reject.",
        "info": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.",
        "solution": "The 'Forged Transmits' parameter must be set to 'Reject' on all vSwitches.\n\nFrom the vSphere Client/vCenter as administrator, using the vSphere Client to connect to the vCenter Server and as administrator: 1. Go to 'Home > Inventory > Hosts and clusters'. 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab 'Configuration > Network > vSwitch(?) > Properties > Ports > vSwitch > Default Policies > Security' 4. Set 'Forged Transmits' = 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39370,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250555r798664_rule,STIG-ID|ESXI5-VMNET-000013,STIG-Legacy|SV-51228,STIG-Legacy|V-39370,SWIFT-CSCv1|2.3,Vuln-ID|V-250555",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "forgedTransmits =",
        "expect": "forgedTransmits = False"
    },
    "custom_item_7": {
        "description": "ESXI5-VMNET-000014 - The system must ensure that the dvPortgroup Forged Transmits policy is set to reject.",
        "info": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.",
        "solution": "The 'Forged Transmits' parameter must be set to 'Reject' on all dvPortgroups.\n\nFrom the vSphere Client/vCenter as administrator:\n\nGo to Home >> Inventory >> Networking.\nSelect each dvPortgroup connected to VMs.\nGo to tab Summary >> Edit Settings >> Policies >> Security.\nSet 'Forged Transmits' = 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39371,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250556r798667_rule,STIG-ID|ESXI5-VMNET-000014,STIG-Legacy|SV-51229,STIG-Legacy|V-39371,SWIFT-CSCv1|2.3,Vuln-ID|V-250556",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "forgedTransmits =",
        "expect": "forgedTransmits = False"
    },
    "custom_item_8": {
        "description": "ESXI5-VMNET-000015 - The system must ensure the dvPortGroup MAC Address Change policy is set to reject.",
        "info": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. VMs, guest OSs, and/or applications that require specific MAC settings must be placed in a separate, specially-configured  dvPortgroup on the vDistributed Switch (vDS).",
        "solution": "Verify by using the vSphere Client to connect to the vCenter Server and as administrator:\nGo to Home >> Inventory >> Networking. Select each dvPortgroup connected to active VMs requiring securing. Go to tab Summary >> Edit Settings >> Policies >> Security. Change the 'Mac Address Changes' = 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39372,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250557r798670_rule,STIG-ID|ESXI5-VMNET-000015,STIG-Legacy|SV-51230,STIG-Legacy|V-39372,SWIFT-CSCv1|2.3,Vuln-ID|V-250557",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "macChanges =",
        "expect": "macChanges = False"
    },
    "custom_item_9": {
        "description": "ESXI5-VMNET-000016 - The system must ensure the virtual switch MAC Address Change policy is set to reject.",
        "info": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. VMs, guest OSs, and/or applications that require specific MAC settings must be placed in a separate, specially-configured  Portgroup on the vSwitch.",
        "solution": "From the vSphere Client, connect to the vCenter Server and as administrator:\nGo to 'Home>> Inventory>> Hosts and clusters'. Select each ESXi host with active virtual switches connected to active VMs requiring securing. Go to tab 'Configuration>> Network>> vSwitch(?)>> Properties>> Ports>> vSwitch>> Default Policies>> Security'. Change the 'Mac Address Changes' = 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39373,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250558r798673_rule,STIG-ID|ESXI5-VMNET-000016,STIG-Legacy|SV-51231,STIG-Legacy|V-39373,SWIFT-CSCv1|2.3,Vuln-ID|V-250558",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "macChanges =",
        "expect": "macChanges = False"
    },
    "custom_item_10": {
        "description": "ESXI5-VMNET-000018 - The system must ensure the virtual switch Promiscuous Mode policy is set to reject.",
        "info": "When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that  dvPortgroup. Promiscuous mode is disabled by default on the ESXi Server.",
        "solution": "From the vSphere Client/vCenter Server as administrator: Go to 'Home>> Inventory>> Hosts and clusters'. Select each ESXi host with active virtual switches connected to active VMs requiring securing. Go to tab 'Configuration>> Network>> vSwitch(?)>> Properties>> Ports>> vSwitch>> Default Policies>> Security'. Set 'Promiscuous Mode' = 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39375,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250560r798679_rule,STIG-ID|ESXI5-VMNET-000018,STIG-Legacy|SV-51233,STIG-Legacy|V-39375,SWIFT-CSCv1|2.3,Vuln-ID|V-250560",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "allowPromiscuous =",
        "expect": "allowPromiscuous = False"
    },
    "custom_item_11": {
        "description": "ESXI5-VMNET-000019 - The system must ensure the dvPortgroup Promiscuous Mode policy is set to reject.",
        "info": "When promiscuous mode is enabled for a dvPortgroup, all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that  dvPortgroup. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch.  An exception should be made for the dvPortgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that dvPortgroup.",
        "solution": "From the vSphere Client/vCenter Server as administrator:\n\nGo to Home >> Inventory >> Hosts and clusters.\nSelect each ESXi host with active virtual switches connected to active VMs requiring securing.\nGo to tab Home >> Inventory >> Networking. Individually select each dvPortgroup, then go to tab Summary >> Edit Settings >> Policies >> Security.\nSet the 'Promiscuous Mode' keyword to 'Reject'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39376,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250561r798682_rule,STIG-ID|ESXI5-VMNET-000019,STIG-Legacy|SV-51234,STIG-Legacy|V-39376,SWIFT-CSCv1|2.3,Vuln-ID|V-250561",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "allowPromiscuous =",
        "expect": "allowPromiscuous = False"
    },
    "custom_item_12": {
        "description": "GEN000100-ESXI5-000062 - The operating system must be a supported release.",
        "info": "An operating system release is considered supported if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software.",
        "solution": "Upgrade to a supported version.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39429,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250569r802864_rule,STIG-ID|GEN000100-ESXI5-000062,STIG-Legacy|SV-51287,STIG-Legacy|V-39429,SWIFT-CSCv1|2.3,Vuln-ID|V-250569",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "not_expect": "Product Version : 5.*"
    },
    "custom_item_13": {
        "description": "GEN000240-ESXI5-000058 - The system clock must be synchronized to an authoritative DoD time source.",
        "info": "To assure the accuracy of the system clock, it must be synchronized with an authoritative time source within DoD. Many system functions, including time-based login and activity restrictions, automated reports, system logs, and audit records depend on an accurate system clock. If there is no confidence in the correctness of the system clock, time-based functions may not operate as intended and records may be of diminished value.",
        "solution": "From the vSphere Client:  Select the host and click 'Configuration >> Time Configuration'.  Select the properties link and chose 'Options'.  From the General tab start the NTP service and select 'Start and stop with host'.  From the NTP Settings tab click the ' Add' button to add the organization defined, authoritative time source within DoD NTP servers.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39430,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250570r798709_rule,STIG-ID|GEN000240-ESXI5-000058,STIG-Legacy|SV-51288,STIG-Legacy|V-39430,SWIFT-CSCv1|2.3,Vuln-ID|V-250570",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "NTP Server : ",
        "expect": "NTP Server : @NTP_SERVER@"
    },
    "custom_item_14": {
        "description": "GEN001375-ESXI5-000086 - For systems using DNS resolution, at least two name servers must be configured.",
        "info": "To provide availability for name resolution services, multiple redundant name servers are mandated. A failure in name resolution could lead to the failure of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging.",
        "solution": "Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials.\nIf connecting to vCenter Server, click on the desired host.\nClick the Configuration tab and view the listed DNS server setting(s).\n\nIf DNS is configured has less than 2 servers configured, add a second server.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39427,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250578r798733_rule,STIG-ID|GEN001375-ESXI5-000086,STIG-Legacy|SV-51285,STIG-Legacy|V-39427,SWIFT-CSCv1|2.3,Vuln-ID|V-250578",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "expect": "- [0-9.]+ [0-9.]+"
    },
    "custom_item_15": {
        "description": "GEN005440-ESXI5-000078 - The system must not be used as a syslog server (log host) for systems external to the enclave - log host for systems external to the enclave",
        "info": "Syslog messages are typically unencrypted and may contain sensitive information and are, therefore, restricted to the enclave.",
        "solution": "Step 1:  Verify that the vSphere Syslog Collector syslog host has been configured. If not, install/enable the vSphere Syslog Collector.\nStep 2:  From the vSphere Client:  Select the host and click 'Configuration >> Advanced Settings >> Syslog >> Global'.\nStep 3: Set 'Syslog.global.logHost' to the syslog server hostname restricted to the enclave.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39279,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250588r798763_rule,STIG-ID|GEN005440-ESXI5-000078,STIG-Legacy|SV-51095,STIG-Legacy|V-39279,SWIFT-CSCv1|2.3,Vuln-ID|V-250588",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@"
    },
    "custom_item_16": {
        "description": "GEN005460-ESXI5-000060 - The system must only use remote syslog servers (log hosts) justified and documented using site-defined procedures.",
        "info": "If a remote log host is in use and it has not been justified and documented with the IAO, sensitive information could be obtained by unauthorized users without the SA's knowledge. A remote log host is any host to which the system is sending syslog messages over a network.",
        "solution": "Step 1:  Verify that the vSphere Syslog Collector syslog host has been configured. If not, install/enable the vSphere Syslog Collector. Step 2:  From the vSphere Client:  Select the host and click 'Configuration >> Advanced Settings >> Syslog >> Global'. Step 3: Set 'Syslog.global.logHost' to the syslog server hostname justified and documented with the IAO.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39278,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250589r798766_rule,STIG-ID|GEN005460-ESXI5-000060,STIG-Legacy|SV-51094,STIG-Legacy|V-39278,SWIFT-CSCv1|2.3,Vuln-ID|V-250589",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@"
    },
    "custom_item_17": {
        "description": "GEN007840-ESXI5-000119 - The DHCP client must be disabled if not used.",
        "info": "DHCP allows for the unauthenticated configuration of network parameters on the system by exchanging information with a DHCP server.",
        "solution": "From the vSphere Client/vCenter, click on the 'Configuration' tab; click on 'Networking'; click on 'Standard Switch/Properties';  click on 'Management NetworkProperties/Edit/IP Settings'; select 'Use the following IP settings'; fill in the IPAddress fields per local site requirements and click 'OK'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39287,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250606r798817_rule,STIG-ID|GEN007840-ESXI5-000119,STIG-Legacy|SV-51103,STIG-Legacy|V-39287,SWIFT-CSCv1|2.3,Vuln-ID|V-250606",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "DHCP Enabled : ",
        "not_expect": "DHCP Enabled : True"
    },
    "custom_item_18": {
        "description": "SRG-OS-000126-ESXI5 - The system must set a timeout for the ESXi Shell to automatically disable itself after a predetermined period.",
        "info": "The ESXiShellTimeout setting is the number of seconds that can elapse before a logon occurs after the ESXi Shell is enabled. After the timeout period, if a logon has not occurred, the shell is disabled. Leaving the shell enabled unnecessarily increases the potential for someone to gain privileged access to the host",
        "solution": "From the vSphere client select the host and click 'Configuration >> Advanced Settings'. Select UserVars.ESXiShellTimeOut parameter and configure it to a value not to exceed 900 seconds (15 minutes). A value of 0 disables the ESXi Shell timeout.",
        "reference": "800-171|3.7.5,800-53|MA-4e.,800-53r5|MA-4e.,CAT|II,CCI|CCI-000879,CSF|PR.MA-2,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39392,HIPAA|164.306(a)(1),ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-250634r798901_rule,STIG-ID|SRG-OS-000126-ESXI5,STIG-Legacy|SV-51250,STIG-Legacy|V-39392,TBA-FIISB|45.2.3,Vuln-ID|V-250634",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "UserVars\\.ESXiShellTimeout : ",
        "expect": "UserVars\\.ESXiShellTimeout : ([1-9]|[1-9][0-9]|[1-8][0-9][0-9]|900)$"
    },
    "custom_item_19": {
        "description": "SRG-OS-000145-ESXI5 - The system must be configured with a default gateway for IPv4 if the system uses IPv4, unless the system is a router.",
        "info": "If a system has no default gateway defined, the system is at increased risk of man-in-the-middle, monitoring, and Denial-of-Service attacks.",
        "solution": "From the vSphere Client/vCenter, click on the Configuration tab; click on DNS and Routing; click on Properties/DNS and Routing, Configuration/Routing. Add a default gateway (IP address is required). Click 'OK'",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39395,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250637r798910_rule,STIG-ID|SRG-OS-000145-ESXI5,STIG-Legacy|SV-51253,STIG-Legacy|V-39395,SWIFT-CSCv1|2.3,Vuln-ID|V-250637",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "not_expect": "Default Gateway : NOT configured"
    },
    "custom_item_20": {
        "description": "SRG-OS-000163-ESXI5 - The operating system must terminate the network connection associated with a communications session at the end of the session or after an organization-defined time period of inactivity.",
        "info": "If ESXi Shell is enabled on the host and a user neglects to initiate an SSH session the idle connection will remain available indefinitely increasing the potential for someone to gain privileged access to the host.",
        "solution": "From the vSphere client select the host and click 'Configuration >> Advanced Settings'. Select UserVars.ESXiShellTimeOut parameter and configure it to a value not to exceed 900 seconds (15 minutes). A value of 0 disables the ESXi Shell timeout.",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39405,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-250643r798928_rule,STIG-ID|SRG-OS-000163-ESXI5,STIG-Legacy|SV-51263,STIG-Legacy|V-39405,SWIFT-CSCv1|2.6,Vuln-ID|V-250643",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "UserVars\\.ESXiShellTimeout : ",
        "expect": "UserVars\\.ESXiShellTimeout : ([1-9]|[1-9][0-9]|[1-8][0-9][0-9]|900)$"
    },
    "custom_item_21": {
        "description": "SRG-OS-000197-ESXI5 - Remote logging for ESXi hosts must be configured.",
        "info": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host it can more easily monitor all hosts with a single tool. It can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.",
        "solution": "Step 1:  Verify the vSphere Syslog Collector syslog host has been configured. If not, install/enable the vSphere Syslog Collector.\nStep 2:  From the vSphere Client:  Select the host and click 'Configuration >> Advanced Settings >> Syslog >> Global'.\nStep 3: Set 'Syslog.global.logHost' to the syslog server hostname.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39408,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250645r798934_rule,STIG-ID|SRG-OS-000197-ESXI5,STIG-Legacy|SV-51266,STIG-Legacy|V-39408,SWIFT-CSCv1|2.3,Vuln-ID|V-250645",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@"
    },
    "custom_item_22": {
        "description": "SRG-OS-000215-ESXI5 - The operating system must back up audit records on an organization-defined frequency onto a different system or media than the system being audited.",
        "info": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host it can more easily monitor all hosts with a single tool. It can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.",
        "solution": "Step 1:  Verify the vSphere Syslog Collector syslog host has been configured. If not, install/enable the vSphere Syslog Collector.\nStep 2:  From the vSphere Client:  Select the host and click 'Configuration >> Advanced Settings >> Syslog >> Global'.\nStep 3: Set 'Syslog.global.logHost' to the syslog server hostname.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39409,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250646r798937_rule,STIG-ID|SRG-OS-000215-ESXI5,STIG-Legacy|SV-51267,STIG-Legacy|V-39409,SWIFT-CSCv1|2.3,Vuln-ID|V-250646",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@"
    },
    "custom_item_23": {
        "description": "SRG-OS-000217-ESXI5 - The operating system must protect the audit records resulting from non-local accesses to privileged accounts and the execution of privileged functions.",
        "info": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host it can more easily monitor all hosts with a single tool. It can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.",
        "solution": "Step 1:  Verify the vSphere Syslog Collector syslog host has been configured. If not, install/enable the vSphere Syslog Collector.\nStep 2:  From the vSphere Client:  Select the host and click 'Configuration >> Advanced Settings >> Syslog >> Global'.\nStep 3: Set 'Syslog.global.logHost' to the syslog server hostname.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250647r798940_rule,STIG-ID|SRG-OS-000217-ESXI5,STIG-Legacy|SV-51268,STIG-Legacy|V-39410,SWIFT-CSCv1|2.3,Vuln-ID|V-250647",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@"
    },
    "custom_item_24": {
        "description": "SRG-OS-99999-ESXI5-000131 - NTP time synchronization must be configured.",
        "info": "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal Time-UTC), it can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files. Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate.",
        "solution": "From the vSphere Client:  Select the host and click 'Configuration >> Time Configuration'.  Select the properties link and chose 'Options'.  From the General tab start the NTP service and select 'Start and stop with host'. From the NTP Settings tab click the 'Add' button to add the organization defined NTP servers.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39292,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250652r798955_rule,STIG-ID|SRG-OS-99999-ESXI5-000131,STIG-Legacy|SV-51108,STIG-Legacy|V-39292,SWIFT-CSCv1|2.3,Vuln-ID|V-250652",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "NTP Server : ",
        "expect": "NTP Server : @NTP_SERVER@"
    },
    "custom_item_25": {
        "description": "SRG-OS-99999-ESXI5-000132 - Persistent logging for all ESXi hosts must be configured.",
        "info": "ESXi can be configured to store log files on an in-memory file system. This occurs when the host's '/scratch' directory is linked to '/tmp/scratch'. When this is done only a single day's worth of logs are stored at any time, in addition, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not persistent across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.\n\nNote: ESXi automatically creates a persistent 4 GB Fat16 scratch partition on the local target device during installation. If space is not available, ESXi will store temporary data on a space constrained ramdisk. As ramdisk data does not persist across reboots, log and core files will be lost. Syslog.global.logDir points to a location on a local or remote datastore (and path) where log files can be saved to. The format [DatastoreName] DirectoryName/Filename maps to /vmfs/volumes/DatastoreName/DirectoryName/Filename. The [DatastoreName] is case sensitive and if the specified DirectoryName does not exist, it will be created. If the datastore path field is blank, logs are stored in their default location.",
        "solution": "From the vSphere Client, select the ESXi hosts and click 'Configuration >> Advanced Settings >> Syslog >> global' and specify a known, persistent datastore for 'Syslog.global.logDir'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39293,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250653r798958_rule,STIG-ID|SRG-OS-99999-ESXI5-000132,STIG-Legacy|SV-51109,STIG-Legacy|V-39293,SWIFT-CSCv1|2.3,Vuln-ID|V-250653",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logDir : ",
        "not_expect": "Syslog\\.global\\.logDir : /tmp/scratch"
    },
    "custom_item_26": {
        "description": "SRG-OS-99999-ESXI5-000135 - The system must disable DCUI to prevent local administrative control.",
        "info": "The DCUI allows for low-level host configuration, such as configuring IP address, hostname, and root password, as well as diagnostic capabilities, such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations. Actions performed from the DCUI are not tracked by vCenter Server. Even if Lockdown Mode is enabled, someone with the root password can perform administrative tasks in the DCUI bypassing RBAC and auditing controls provided through vCenter. DCUI access can be disabled. Disabling it prevents all local activity and thus forces actions to be performed in vCenter Server where they can be centrally audited and monitored.",
        "solution": "From the vSphere Client, select the host and select 'Configuration >> Security Profile'. In the services section select 'Properties'. Select 'Direct Console UI' and click 'Options'. From the pop-up stop the DCUI service and set the startup policy to 'start and stop manually'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39294,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250654r798961_rule,STIG-ID|SRG-OS-99999-ESXI5-000135,STIG-Legacy|SV-51110,STIG-Legacy|V-39294,SWIFT-CSCv1|2.3,Vuln-ID|V-250654",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Direct Console UI : running =",
        "expect": "Direct Console UI : running = False"
    },
    "custom_item_27": {
        "description": "SRG-OS-99999-ESXI5-000136 - The system must disable ESXi Shell unless needed for diagnostics or troubleshooting.",
        "info": "The ESXi Shell is an interactive command line environment available locally from the DCUI or remotely via SSH. Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls. The ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere client.",
        "solution": "From the vSphere Client, select the host then select 'Configuration >>  Security Profiles'. In the Services section select 'Properties'. Select the 'ESXi Shell' and click Options. Stop the ESXi Shell and select the option to 'Start and stop manually'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39295,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250655r798964_rule,STIG-ID|SRG-OS-99999-ESXI5-000136,STIG-Legacy|SV-51111,STIG-Legacy|V-39295,SWIFT-CSCv1|2.3,Vuln-ID|V-250655",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "ESXi Shell : running =",
        "expect": "ESXi Shell : running = False"
    },
    "custom_item_28": {
        "description": "SRG-OS-99999-ESXI5-000138 - The system must disable SSH.",
        "info": "The ESXi Shell is an interactive command line interface (CLI) available at the ESXi server console. The ESXi shell provides temporary access to commands essential for server maintenance. Intended primarily for use in break-fix scenarios, the ESXi shell is well suited for checking and modifying configuration details, not always generally accessible, using the vSphere Client. The ESXi shell is accessible remotely using SSH. Under normal operating conditions, SSH access to the host must be disabled. As with the ESXi shell, SSH is also intended only for temporary use during break-fix scenarios. SSH must therefore be disabled under normal operating conditions and must only be enabled for diagnostics or troubleshooting. Remote access to the host must therefore be limited to the vSphere Client at all other times.",
        "solution": "From the vSphere client, select the ESXi host, go to 'Configuration >> Security Profile'. In the 'Services' section select 'Properties'. Select 'SSH', 'Options...' and configure the 'SSH' option to 'Start and stop manually'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39390,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250657r798970_rule,STIG-ID|SRG-OS-99999-ESXI5-000138,STIG-Legacy|SV-51248,STIG-Legacy|V-39390,SWIFT-CSCv1|2.3,Vuln-ID|V-250657",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "TSM-SSH : running =",
        "expect": "TSM-SSH : running = False"
    },
    "custom_item_29": {
        "description": "SRG-OS-99999-ESXI5-000141 - The system must enable bidirectional CHAP authentication for iSCSI traffic.",
        "info": "When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MiTM attack, when not authenticating both the iSCSI target and host, in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.",
        "solution": "In the vSphere Client, select the host, and then choose: Configuration >> Storage Adaptors >> iSCSI Initiator Properties >>  CHAP >> CHAP (Target Authenticates Host). Select 'Use Chap', and configure the 'Name' and 'Secret' options.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39298,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250659r798976_rule,STIG-ID|SRG-OS-99999-ESXI5-000141,STIG-Legacy|SV-51114,STIG-Legacy|V-39298,SWIFT-CSCv1|2.3,Vuln-ID|V-250659",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "chapAuthEnabled : ",
        "not_expect": "chapAuthEnabled : False"
    },
    "custom_item_30": {
        "description": "SRG-OS-99999-ESXI5-000143 - The system must enable SSL for NFC.",
        "info": "NFC (Network File Copy) is used to migrate or clone a VM between two ESXi hosts over the network. By default, SSL is used only for the authentication of the transfer, but SSL must also be enabled on the data transfer. Without this setting VM contents could potentially be sniffed if the management network is not adequately isolated and secured.",
        "solution": "From the vSphere client select 'Administration >> vCenter Server Settings >> Advanced Settings'. Set 'config.nfc.useSSL = true'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39299,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250660r798979_rule,STIG-ID|SRG-OS-99999-ESXI5-000143,STIG-Legacy|SV-51115,STIG-Legacy|V-39299,SWIFT-CSCv1|2.3,Vuln-ID|V-250660",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "config\\.nfc\\.useSSL : ",
        "not_expect": "config\\.nfc\\.useSSL : FALSE"
    },
    "custom_item_31": {
        "description": "SRG-OS-99999-ESXI5-000144 - The system must ensure proper SNMP configuration",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : ",
        "expect": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : True"
    },
    "custom_item_32": {
        "description": "SRG-OS-99999-ESXI5-000144 - The system must ensure proper SNMP configuration - 'community name public does not exist'",
        "info": "If SNMP is not being used, it must remain disabled. If it is being used, the proper trap destination must be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack. SNMP must be configured on each ESXi host using Power/v CLI. vSphere PowerCLI is a command line tool used to automate vSphere management. PowerCLI is distributed as a Windows PowerShell snapin, and includes 300+ PowerShell cmdlets and use documentation.",
        "solution": "If SNMP is not being used, configure 'enabled' = 0. From the Power/v CLI, execute 'vicfg-snmp.pl --server-D'.\n\nIf SNMP is being used, ensure the community name is configured:\nFrom the vSphere CLI, type 'vicfg-snmp.pl --server hostname --username--password-c'.\n\nTo enable SNMP from the vSphere CLI, type.\n# vicfg-snmp.pl --server--username--password--enable",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39417,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250661r798982_rule,STIG-ID|SRG-OS-99999-ESXI5-000144,STIG-Legacy|SV-51275,STIG-Legacy|V-39417,SWIFT-CSCv1|2.3,Vuln-ID|V-250661",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.[0-9]+\\.community : ",
        "not_expect": "snmp\\.receiver\\.[0-9]+\\.community : [Pp][Uu][Bb][Ll][Ii][Cc]"
    },
    "custom_item_33": {
        "description": "SRG-OS-99999-ESXI5-000144 - The system must ensure proper SNMP configuration - 'community name private does not exist'",
        "info": "If SNMP is not being used, it must remain disabled. If it is being used, the proper trap destination must be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack. SNMP must be configured on each ESXi host using Power/v CLI. vSphere PowerCLI is a command line tool used to automate vSphere management. PowerCLI is distributed as a Windows PowerShell snapin, and includes 300+ PowerShell cmdlets and use documentation.",
        "solution": "If SNMP is not being used, configure 'enabled' = 0. From the Power/v CLI, execute 'vicfg-snmp.pl --server-D'.\n\nIf SNMP is being used, ensure the community name is configured:\nFrom the vSphere CLI, type 'vicfg-snmp.pl --server hostname --username--password-c'.\n\nTo enable SNMP from the vSphere CLI, type.\n# vicfg-snmp.pl --server--username--password--enable",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39417,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250661r798982_rule,STIG-ID|SRG-OS-99999-ESXI5-000144,STIG-Legacy|SV-51275,STIG-Legacy|V-39417,SWIFT-CSCv1|2.3,Vuln-ID|V-250661",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.[0-9]+\\.community : ",
        "not_expect": "snmp\\.receiver\\.[0-9]+\\.community : [Pp][Rr][Ii][Vv][Aa][Tt][Ee]"
    },
    "custom_item_34": {
        "description": "SRG-OS-99999-ESXI5-000145 - The system must ensure the vpxuser auto-password change meets policy.",
        "info": "By default, the vpxuser password will be automatically changed by vCenter every 30 days. Ensure this setting meets your policies; if not, configure to meet password aging policies.\n\nNOTE: It is very important the password aging policy not be shorter than the default interval that is set to automatically change the vpxuser password, to preclude the possibility that vCenter might get locked out of an ESXi host.",
        "solution": "From the vSphere client select 'Administration >> vCenter Server Settings >> Advanced Settings'. Set the 'VirtualCenter.VimPasswordExpirationInDays' to 60 or less. Note that it is strongly recommended that this value not be changed from '30'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39300,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250663r798988_rule,STIG-ID|SRG-OS-99999-ESXI5-000145,STIG-Legacy|SV-51117,STIG-Legacy|V-39301,SWIFT-CSCv1|2.3,Vuln-ID|V-250663",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "config.VirtualCenter.VimPasswordExpirationInDays : ",
        "expect": "config.VirtualCenter.VimPasswordExpirationInDays : (60|[1-5][0-9]|[0-9])$"
    },
    "custom_item_35": {
        "description": "SRG-OS-99999-ESXI5-000146 - The system must ensure the vpxuser password meets length policy.",
        "info": "The vpxuser password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies. Longer passwords make brute-force password attacks more difficult. The vpxuser password is added by vCenter, meaning no manual intervention is normally required. The vpxuser password length must never be modified to less than the default length of 32 characters.",
        "solution": "From the vSphere client select 'Administration >> vCenter Server Settings >> Advanced Settings'. Set the 'config.vpxd.hostPasswordLength' to comply with site requirements.  Default is 32 characters. Note that the vpxuser password is added by vCenter, meaning no manual intervention is required. The vpxuser password length must never be modified to less than the default length of 32 characters.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39302,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250664r798991_rule,STIG-ID|SRG-OS-99999-ESXI5-000146,STIG-Legacy|SV-51118,STIG-Legacy|V-39302,SWIFT-CSCv1|2.3,Vuln-ID|V-250664",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "config.vpxd.hostPasswordLength : ",
        "expect": "config.vpxd.hostPasswordLength : (3[2-9]|[4-9][0-9]|[1-9][0-9][0-9]+)"
    },
    "custom_item_36": {
        "description": "ESXi : enable-chap-auth",
        "xsl_stmt": "",
        "regex": "chapAuthEnabled : ",
        "expect": "chapAuthEnabled : True"
    },
    "custom_item_37": {
        "description": "SRG-OS-99999-ESXI5-000151 - The system must prevent unintended use of dvfilter network APIs.",
        "info": "If products that use the dvfilter network API are not used, the host should not be configured to send network information to a VM. If the API is enabled, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host.\n\nIf a product uses this API, the host must be verified as being correctly configured.",
        "solution": "From the vSphere client select the host and click 'Configuration >> Advanced Settings >> Net'\nSet the value of Net.DVFilterBindIpAddress to blank if a dvfilter-based network security appliance is not used or (where used) set the value of Net.DVFilterBindIpAddress to match the dvfilter-based network security appliance.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39346,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250667r799000_rule,STIG-ID|SRG-OS-99999-ESXI5-000151,STIG-Legacy|SV-51204,STIG-Legacy|V-39346,SWIFT-CSCv1|2.3,Vuln-ID|V-250667",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Net\\.DVFilterBindIpAddress : ",
        "expect": "Net\\.DVFilterBindIpAddress : NOT configured"
    },
    "custom_item_38": {
        "description": "SRG-OS-99999-ESXI5-000154 - The system must use Active Directory for local user authentication for accounts other than root and the vpxuser.",
        "info": "Creating local user accounts on each host presents challenges with having to synchronize account names and passwords across multiple hosts. Join ESXi hosts to an Active Directory domain to eliminate the need to create and maintain local user accounts. Using Active Directory for user authentication simplifies the ESXi host configuration and reduces the risk for configuration issues that could lead to unauthorized access. Note that when adding ESXi hosts to Active Directory, if the group 'ESX Admins' exists, all user/group accounts assigned to the group will have full administrative access to the host.",
        "solution": "Perform the following steps to configure the ESXi host to use Active Directory:\n(1) Log into the ESXi host using the vSphere Client and authenticating with the root account (or an equivalent account).\n(2) Select the ESXi host from the inventory and click the Configuration tab.\n(3) From the Software section, select Authentication Services.\n(4) Click Properties in the upper-right corner.\n(5) From the Directory Services Configuration dialog box, select Active Directory from the Select Directory Service Type drop-down list.\n(6) Supply the DNS domain name of the Active Directory domain this ESXi host will use for authentication.\n(7) Click the Join Domain button.\n(8) Specify a username and password that has permission to allow the host to join the domain.\n\nOnce the ESXi host is joined to Active Directory, users will be able to authenticate to an ESXi host using their Active Directory credentials. Using the vSphere Client or the vCLI, users can use either the domain\\username or username@domain syntax.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39348,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250669r799006_rule,STIG-ID|SRG-OS-99999-ESXI5-000154,STIG-Legacy|SV-51206,STIG-Legacy|V-39348,SWIFT-CSCv1|2.3,Vuln-ID|V-250669",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "UserVars\\.ActiveDirectoryPreferredDomainControllers : ",
        "expect": ""
    },
    "custom_item_39": {
        "description": "SRG-OS-99999-ESXI5-000155 - Active Directory ESX Admin group membership must be verified unused.",
        "info": "When adding ESXi hosts to Active Directory, if the group 'ESX Admins' exists, all user/group accounts assigned to the group will have full administrative access to the host. Discretion should be used when managing membership to the 'ESX Admins' group.",
        "solution": "From the vSphere Client/vCenter, select the host, then Configuration >> Software/Advanced Settings >> HostAgent.\n\nChange the 'Config.HostAgent.plugins.hostsvc.esxAdminsGroup' to a pre-defined group other than the default 'ESX Admins'.\n\nNote: The new administrator group must have been previously defined on the Active Directory server.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_ESXi_5.0_Server_STIG,GDPR|32.1.b,Group-ID|V-39349,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-250670r799009_rule,STIG-ID|SRG-OS-99999-ESXI5-000155,STIG-Legacy|SV-51207,STIG-Legacy|V-39349,SWIFT-CSCv1|2.3,Vuln-ID|V-250670",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_ESXi5_Server_V2R1_STIG.zip",
        "xsl_stmt": "",
        "regex": "Config\\.HostAgent\\.plugins\\.hostsvc\\.esxAdminsGroup : ",
        "not_expect": "ESX Admins"
    }
}