{
    "custom_item_1": {
        "description": "ESXi : audit-exception-users",
        "info": "Audit the list of users who are on the Exception Users List and whether the have administrator privleges.\nIn vSphere 6.0 and later, you can add users to the Exception Users list from the vSphere Web Client. These users do not lose their permissions when the host enters lockdown mode. Usually you may want to add service accounts such as a backup agent to the Exception Users list. Verify that the list of users who are exempted from losing permissions is legitimate and as needed per your enviornment. Users who do not require special permissions should not be exempted from lockdown mode.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-6CD8C2E3-7925-4706-8271-F42F2BCFF95D.html\nhttp://blogs.vmware.com/vsphere/2015/03/vsphere-6-0-lockdown-mode-exception-users.html",
        "solution": "From the vSphere web client, select host and click on \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". Scroll down until \"Lockdown Mode\".  Click \"Edit\" and then click on \"Exception Users\". Add or delete users as per your site requirements.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "DCUI\\.Access : ",
        "expect": "DCUI\\.Access : @AUDIT_EXCEPTION_USERS@$"
    },
    "custom_item_2": {
        "description": "ESXi : config-ntp",
        "info": "Configure NTP time synchronization.\nBy ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal TimeUTC), you can make it simpler to track and correlate an intruders actions when reviewing the relevant log files. Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC-A6CECA52F6CC.html",
        "solution": "# Set the NTP Settings for all hosts -\n$NTPServers = \"pool.ntp.org\", \"pool2.ntp.org\"Get-VMHost | Add-VmHostNtpServer $NTPServers",
        "reference": "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,QCSC-v1|13.2,QCSC-v1|8.2.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "NTP Server : ",
        "expect": "NTP Server : @NTP_SERVER@$"
    },
    "custom_item_3": {
        "description": "ESXi : config-persistent-logs",
        "info": "Configure persistent logging for all ESXi host.\nESXi can be configured to store log files on an in-memory file system.  This occurs when the host's \"/scratch\" directory is linked to \"/tmp/scratch\". When this is done only a single day's worth of logs are stored at any time. In addition log files will be reinitialized upon each reboot.  This presents a security risk as user activity logged on the host is only stored temporarily and will not persistent across reboots.  This can also complicate auditing and make it harder to monitor events and diagnose issues.  ESXi host logging should always be configured to a persistent datastore.\n\nhttp://kb.vmware.com/kb/1033696\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html",
        "solution": "# Set Syslog.global.logDir for each host -\nGet-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value \"NewLocation\" }",
        "reference": "800-171|3.3.8,800-53|AU-9,CSF|PR.PT-1,ITSG-33|AU-9",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logDir : ",
        "expect": "Syslog\\.global\\.logDir : @LOG_DIR@$"
    },
    "custom_item_4": {
        "description": "ESXi : config-snmp",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : ",
        "not_expect": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : True$"
    },
    "custom_item_5": {
        "description": "ESXi : config-snmp - 'snmp.receiver.X.community'",
        "info": "Ensure proper SNMP configuration.\nIf SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.  Note:  ESXi 5.1 and later supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74-B1AA-4A9D18AB6250.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-4309DE28-AFB6-4B2D-A8EA-A38D36A8C6E6.html\nSNMP V3 configuration - http://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.monitoring.doc/GUID-2E4B0F2A-11D8-4649-AC6C-99F89CE93026.html",
        "solution": "# Update the host SNMP Configuration (single host connection required) -\nGet-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity 'secret'",
        "reference": "800-171|3.5.2,800-53|IA-5c.,800-53r5|IA-5c.,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5c.,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.[0-9]+\\.community : ",
        "not_expect": "snmp\\.receiver\\.[0-9]+\\.community : [Pp][Uu][Bb][Ll][Ii][Cc]$"
    },
    "custom_item_6": {
        "description": "ESXi : config-snmp - 'snmp.receiver.X.enabled",
        "info": "Ensure proper SNMP configuration.\nIf SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.  Note:  ESXi 5.1 and later supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74-B1AA-4A9D18AB6250.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-4309DE28-AFB6-4B2D-A8EA-A38D36A8C6E6.html\nSNMP V3 configuration - http://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.monitoring.doc/GUID-2E4B0F2A-11D8-4649-AC6C-99F89CE93026.html",
        "solution": "# Update the host SNMP Configuration (single host connection required) -\nGet-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity 'secret'",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : ",
        "not_expect": "snmp\\.receiver\\.([Xx]|[0-9]+)\\.enabled : True$"
    },
    "custom_item_7": {
        "description": "ESXi : enable-ad-auth",
        "info": "Use Active Directory for local user authentication.\nJoin ESXi hosts to an Active Directory (AD) domain to eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced and reduces the risk of security breaches and unauthorized access.  Note: if the AD group \"ESX Admins\" (default) exists then all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-4FD32125-4955-439D-B39F-C654CCB207DC.html",
        "solution": "# Join the ESXI Host to the Domain\nGet-VMHost  | Get-VMHostAuthentication | Set-VMHostAuthentication -Domain $domain -User $username -Password $password -JoinDomain",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "UserVars\\.ActiveDirectoryPreferredDomainControllers : ",
        "expect": "UserVars\\.ActiveDirectoryPreferredDomainControllers : @PREF_DOM_CONTROLLER@"
    },
    "custom_item_8": {
        "description": "ESXi : enable-chap-auth",
        "info": "Enable bidirectional CHAP, also known as Mutual CHAP, authentication for iSCSI traffic.\nvSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Choosing not to enforce more stringent authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. By not authenticating both the iSCSI target and host, there is a potential for a MiTM attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation. http://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD-49B433E2F266.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-DFC745FB-CDD6-4828-8948-4D0E0561EEF8.html",
        "solution": "# Set the Chap settings for the Iscsi Adapter -\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here",
        "reference": "800-53|IA-3(1),800-53r5|IA-3(1),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-3(1),NESA|T5.4.3,QCSC-v1|13.2,TBA-FIISB|27.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "chapAuthEnabled : ",
        "not_expect": "chapAuthEnabled : False$"
    },
    "custom_item_9": {
        "description": "ESXi : enable-normal-lockdown-mode",
        "info": "Enable Normal Lockdown Mode to restrict access.\nEnabling lockdown mode disables direct access to an ESXi host requiring the host be managed remotely from vCenter Server.  This is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly.   By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.  Note:  Lockdown mode does not apply to  users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode.\n\nNote that users listed in the DCUI.Access list for each host are allowed to override lockdown mode and login to the DCUI.\n\nBy default the \"root\" user is the only user listed in the DCUI.Access list.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838-225F5FF480FF.html\nhttp://kb.vmware.com/kb/1008077",
        "solution": "# Enable lockdown mode for each host -\nGet-VMHost | Foreach { $_.EnterLockdownMode() }",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Lockdown Mode : ",
        "expect": "Lockdown Mode : lockdownNormal$"
    },
    "custom_item_10": {
        "description": "ESXi : enable-remote-syslog",
        "info": "Configure remote logging for ESXi hosts.\nRemote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host you can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server helps prevent log tampering and also provides a long-term audit record. To facilitate remote logging VMware provides the vSphere Syslog Collector.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.vcenterhost.doc/GUID-61E7E2EA-F531-4665-9225-58BA899F55A5.html",
        "solution": "# Set Syslog.global.logHost for each host -\nGet-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logHost -Value \"NewLocation\" }",
        "reference": "800-171|3.3.8,800-53|AU-9(2),800-53r5|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.2.1|10.5.3,PCI-DSSv3.2.1|10.5.4,PCI-DSSv4.0|10.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Syslog\\.global\\.logHost : ",
        "expect": "Syslog\\.global\\.logHost : @LOG_HOST@$"
    },
    "custom_item_11": {
        "description": "ESXi : enable-strict-lockdown-mode",
        "info": "Enable Strict lockdown mode to restrict access.\nEnabling lockdown mode disables direct access to an ESXi host requiring the host be managed remotely from vCenter Server.\n\nThis is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly.   By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.\n\nStrict lockdown mode stops the DCUI service. However, the ESXi Shell and SSH services are independent of lockdown mode. For lockdown mode to be an effective security measure, ensure that the ESXi Shell and SSH services are also disabled. Those services are disabled by default.\n\nWhen a host is in lockdown mode, users on the Exception Users list can access the host from the ESXi Shell and through SSH if they have the Administrator role on the host and if these services are enabled. This access is possible even in strict lockdown mode. Leaving the ESXi Shell service and the SSH service disabled is the most secure option.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838-225F5FF480FF.html",
        "solution": "#Run this at the vCenter level or against an individual host -\n#Create HostLockdownMode object\n$level = New-Object VMware.Vim.HostLockdownMode\n#Populate with level of lockdown:(lockdownDisabled,lockdownNormal,lockdownStrict)\n$level = \"lockdownStrict\"\n$esxihosts = get-vmhost\nforeach ($esxihost in $esxihosts)\n  {\n$myhost = Get-VMHost $esxihost | Get-View\n$lockdown = Get-View $myhost.ConfigManager.HostAccessManager\nWrite-Host \"\"\nWrite-Host \"Setting Lockdown mode to \" $level\n$lockdown.ChangeLockdownMode($level)\n$lockdown.UpdateViewData()\n$lockdownstatus = $lockdown.LockdownMode\nWrite-Host \"Lockdown mode on $esxihost is set to $lockdownstatus\"\nWrite-Host \"\"\n  }",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Lockdown Mode : ",
        "expect": "Lockdown Mode : lockdownStrict$"
    },
    "custom_item_12": {
        "description": "ESXi : firewall-enabled",
        "info": "Configure the ESXi host firewall to restrict access to services running on the host .\nUnrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299-9B10-5F3AEA52C605.html",
        "solution": "From the vSphere web client, select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\".\n\nFor each enabled services for both incoming and outgoing connections set a proper network/IP Range after deselecting \"Allow connections from any IP address\" checkbox.",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "ipAll :",
        "not_expect": ": Enabled , ipAll : true"
    },
    "custom_item_13": {
        "description": "ESXi : set-account-auto-unlock-time",
        "info": "Set the time after which a locked account is automatically unlocked.\nMultiple account login failures for the same account could possibly be a threat vector trying to brute force the system or cause denial of service. Such attempts to brute force the system should be limited by locking out the account after reaching a threshold.\n\nIn case, you would want to auto unlock the account, i.e. unlock the account without administrative action, set the time for which the account remains locked. Setting a high duration for which account remains locked would deter and serverly slow down the brute force method of logging in.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73-05ACDAE6BE43.html",
        "solution": "From the vSphere Web Client select the host, click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced Sytem Settings\". Enter \"Security.AccountUnlockTime\" in the filter. Click edit and set the value for this parameter to 900.",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Security\\.AccountUnlockTime : ",
        "expect": "Security\\.AccountUnlockTime : 900"
    },
    "custom_item_14": {
        "description": "ESXi : set-account-lockout",
        "info": "Set the count of maximum failed login attempts before the account is locked out.\nMultiple account login failures for the same account could possibly be a threat vector trying to brute force the system or cause denial of service. Such attempts to brute force the system should be limited by locking out the account after reaching a threshold.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73-05ACDAE6BE43.html",
        "solution": "From the vSphere Web Client select the host, click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced Sytem Settings\". Enter \"Security.AccountLockFailures\" in the filter. Click edit and set the value for this parameter to 3.",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Security\\.AccountLockFailures : ",
        "expect": "Security\\.AccountLockFailures : 3"
    },
    "custom_item_15": {
        "description": "ESXi : set-dcui-timeout",
        "info": "Audit DCUI timeout value.\nDCUI is used for directly logging into ESXi host and carrying out host management tasks. The idle connections to DCUI must be terminated to avoid any unintended usage of the DCUI originating from a left over login session.",
        "solution": "From the vSphere Web Client select the host, click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced Sytem Settings\". Enter \"UserVars.DcuiTimeOut\" in the filter. Click edit and set the value for this parameter to 600 or more restrictive.",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "UserVars\\.DcuiTimeOut : ",
        "expect": "UserVars\\.DcuiTimeOut : 600"
    },
    "custom_item_16": {
        "description": "ESXi : set-password-policies",
        "info": "Establish a password policy for password complexity.\nESXi uses the pam_passwdqc.so plug-in to set password strength and complexity.  It is important to use passwords that are not easily guessed and that are difficult for password generators to determine.   Password strength and complexity rules apply to all ESXi users, including root. They do not apply to Active Directory users when the ESX host is joined to a domain. Those password policies are enforced by AD.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73-05ACDAE6BE43.html",
        "solution": "# Set Security.PasswordQualityControl for each host -\n#these values are an example.\nGet-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Security.PasswordQualityControl -Value \"retry=3 min=8,8,8,7,6\" }",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Security\\.PasswordQualityControl : ",
        "expect": "Security\\.PasswordQualityControl : @PASSWORD_POLICY@"
    },
    "custom_item_17": {
        "description": "ESXi : set-shell-interactive-timeout",
        "info": "Set a timeout to automatically terminate idle ESXi Shell and SSH sessions.\nIf a user forgets to log out of their SSH session, the idle connection will remains open indefinitely, increasing the potential for someone to gain privileged access to the host.  The ESXiShellInteractiveTimeOut allows you to automatically terminate idle shell sessions.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027-0280B9ED1009.html\n\nhttp://kb.vmware.com/kb/2004746",
        "solution": "# Set UserVars.ESXiShellInteractiveTimeOut to 900 on all hosts -\nGet-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellInteractiveTimeOut -Value 900 }",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "UserVars\\.ESXiShellInteractiveTimeout : ",
        "expect": "UserVars\\.ESXiShellInteractiveTimeout : @SHELL_SESSION_TIMEOUT@$"
    },
    "custom_item_18": {
        "description": "ESXi : set-shell-timeout",
        "info": "Set a timeout to limit how long the ESXi Shell and SSH services are allowed to run.\nWhen the ESXi Shell or SSH services are enabled on a host they will run indefinitely.  To avoid having these services left running set the ESXiShellTimeOut.  The ESXiShellTimeOut defines a window of time after which the ESXi Shell and SSH services will automatically be terminated.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027-0280B9ED1009.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68-8096-F009B87ACB33.html\n\nhttp://kb.vmware.com/kb/2004746",
        "solution": "# Set Remove UserVars.ESXiShellTimeOut to 900 on all hosts -\nGet-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellTimeOut -Value 900 }",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "UserVars\\.ESXiShellTimeout : ",
        "expect": "UserVars\\.ESXiShellTimeout : @SHELL_TIMEOUT@$"
    },
    "custom_item_19": {
        "description": "ESXi : TransparentPageSharing-intra-enabled",
        "info": "Ensure default setting for intra-VM TPS is correct.\nAcknowledgement of the recent academic research that leverages Transparent Page Sharing (TPS) to gain unauthorized access to data under certain highly controlled conditions and documents VMwares precautionary measure of restricting TPS to individual virtual machines by default in upcoming ESXi releases. At this time, VMware believes that the published information disclosure due to TPS between virtual machines is impractical in a real world deployment.\n\nVMs that do not have the sched.mem.pshare.salt option set cannot share memory with any other VMs.\nhttps://kb.vmware.com/kb/2080735\nhttps://kb.vmware.com/kb/2097593\nhttps://kb.vmware.com/kb/2091682",
        "solution": "$tps = 2\n$VMHosts = Get-VMHost | Where {$_.ConnectionState -eq \"Connected\"}\nforeach ($VMHost in $VMHosts) {\nSet-VMHostAdvancedConfiguration -VMHost $VMHost -Name Mem.ShareForceSalting\" -Value $tps\n}",
        "reference": "800-53|SI-16,800-53r5|SI-16,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Mem\\.ShareForceSalting : ",
        "expect": "Mem\\.ShareForceSalting : 2$"
    },
    "custom_item_20": {
        "description": "vCenter : verify-nfc-ssl",
        "info": "Enable SSL for Network File copy (NFC).\nNFC (Network File Copy) is the name of the mechanism used to migrate or clone a VM between two ESXi hosts over the network.\n\n***By default, NFC over SSL is enabled (ie: \"True\") within a vSphere cluster but the value of the setting is null.***\n\nClients check the value of the setting and default to not using SSL for performance reasons if the value is null. This behavior can be changed by ensuring the setting has been explicitly created and set to \"True\". This will force clients to use SSL.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-B58A5750-A15C-4051-BD87-49F3B5C762B5.html",
        "solution": "$vCenter = \"MyvCenterFQDN\"\n$nfcset = get-advancedsetting -entity $vCenter -name config.nfc.useSSL | set-AdvancedSetting -value true -confirm:$false",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "config\\.nfc\\.useSSL : ",
        "expect": "config\\.nfc\\.useSSL : True$"
    },
    "custom_item_21": {
        "description": "VM : disable-console-copy",
        "info": "Explicitly disable copy/paste operations.\nCopy and paste operations are disabled by default. However, if you explicitly disable this feature audit controls can check that this setting is correct.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.copy.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.copy\\.disable : ",
        "expect": "isolation\\.tools\\.copy\\.disable : (True|NOT found)$"
    },
    "custom_item_22": {
        "description": "VM : disable-console-drag-n-drop",
        "info": "Explicitly disable copy/paste operations.\nCopy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct.\n\nThe default value is null. Setting this to true is just for audit.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.dnd.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.dnd\\.disable : ",
        "expect": "isolation\\.tools\\.dnd\\.disable : (True|NOT found)$"
    },
    "custom_item_23": {
        "description": "VM : disable-console-gui-options",
        "info": "Explicitly disable copy/paste operations.\nCopy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\" -value $false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.setGUIOptions\\.enable : ",
        "expect": "isolation\\.tools\\.setGUIOptions\\.enable : (False|NOT found)$"
    },
    "custom_item_24": {
        "description": "VM : disable-console-paste",
        "info": "Explicitly disable copy/paste operations.\nCopy and paste operations are disabled by default, however, if you explicitly disable this feature, audit controls can check that this setting is correct.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.paste.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.paste\\.disable : ",
        "expect": "isolation\\.tools\\.paste\\.disable : (True|NOT found)$"
    },
    "custom_item_25": {
        "description": "VM : disable-disk-shrinking-shrink",
        "info": "Disable virtual disk shrinking.\nShrinking a virtual disk reclaims unused space in it. The shrinking process itself, which takes place on the host, reduces the size of the disk's files by the amount of disk space reclaimed in the wipe process. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processesthat is, users and processes without root or administrator privilegeswithin virtual machines have the capability to invoke this procedure. A non-root user cannot wipe the parts of the virtual disk that require root-level permissions. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. Limited capability is available to non-administrative users in the guest.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.diskShrink\\.disable : ",
        "expect": "isolation\\.tools\\.diskShrink\\.disable : True$"
    },
    "custom_item_26": {
        "description": "VM : disable-disk-shrinking-wiper",
        "info": "Disable virtual disk shrinking.\nShrinking a virtual disk reclaims unused space in it. VMware Tools reclaims all unused portions of disk partitions (such as deleted files) and prepares them for shrinking. Wiping takes place in the guest operating system.  If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processesthat is, users and processes without root or administrator privilegeswithin virtual machines have the capability to invoke this procedure. A non-root user  cannot wipe the parts of the virtual disk that require root-level permissions.  However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. Limited capability is available to non-administrative users in the guest.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.diskWiper.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.diskWiper\\.disable : ",
        "expect": "isolation\\.tools\\.diskWiper\\.disable : True$"
    },
    "custom_item_27": {
        "description": "VM : disable-hgfs",
        "info": "Disable HGFS file transfers.\nCertain automated operations such as automated tools upgrades use a component in the hypervisor called \"Host Guest File System\" and an attacker could potentially use this to transfer files inside the guest OS\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-76EF6146-FA0E-467F-826F-C953815218C5.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.hgfsServerSet\\.disable : ",
        "expect": "isolation\\.tools\\.hgfsServerSet\\.disable : True$"
    },
    "custom_item_28": {
        "description": "VM : disable-independent-nonpersistent",
        "info": "Avoid using independent nonpersistent disks.\nThe security issue with nonpersistent disk mode is that successful attackers, with a simple shutdown or reboot, might undo or remove any traces that they were ever on the machine. To safeguard against this risk, production virtual machines should be set to use persistent disk mode; additionally, make sure that activity within the VM is logged remotely on a separate server, such as a syslog server or equivalent Windows-based event collector. Without a persistent record of activity on a VM, administrators might never know whether they have been attacked or hacked.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-1E583D6D-77C7-402E-9907-80B7F478D3FC.html",
        "solution": "#Alter the parameters for the following cmdlet to set the VM Disk Type:\nGet-VM  | Get-HardDisk | Set-HardDisk",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "scsi([Xx]|[0-9]+):([Yy]|[0-9]+)\\.mode :",
        "not_expect": "scsi([Xx]|[0-9]+):([Yy]|[0-9]+)\\.mode : NOT found$"
    },
    "custom_item_29": {
        "description": "VM : disable-unexposed-features-autologon",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on both vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\" -value $true",
        "reference": "800-53|AC-14a.,800-53r5|AC-14a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-14a.,NESA|T5.6.1,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.ghi\\.autologon\\.disable : ",
        "expect": "isolation\\.tools\\.ghi\\.autologon\\.disable : True$"
    },
    "custom_item_30": {
        "description": "VM : disable-unexposed-features-biosbbs",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.bios.bbs.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.bios\\.bbs\\.disable : ",
        "expect": "isolation\\.bios\\.bbs\\.disable : True$"
    },
    "custom_item_31": {
        "description": "VM : disable-unexposed-features-getcreds",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.getCreds.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.getCreds\\.disable : ",
        "expect": "isolation\\.tools\\.getCreds\\.disable : True$"
    },
    "custom_item_32": {
        "description": "VM : disable-unexposed-features-launchmenu",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.ghi\\.launchmenu\\.change : ",
        "expect": "isolation\\.tools\\.ghi\\.launchmenu\\.change : True$"
    },
    "custom_item_33": {
        "description": "VM : disable-unexposed-features-memsfss",
        "info": "Disable certain unexposed features.\nBecause VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that dont apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.memSchedFakeSampleStats\\.disable : ",
        "expect": "isolation\\.tools\\.memSchedFakeSampleStats\\.disable : True$"
    },
    "custom_item_34": {
        "description": "VM : disable-unexposed-features-protocolhandler",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.ghi\\.protocolhandler\\.info\\.disable : ",
        "expect": "isolation\\.tools\\.ghi\\.protocolhandler\\.info\\.disable : True$"
    },
    "custom_item_35": {
        "description": "VM : disable-unexposed-features-shellaction",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.ghi\\.host\\.shellAction\\.disable : ",
        "expect": "isolation\\.ghi\\.host\\.shellAction\\.disable : True$"
    },
    "custom_item_36": {
        "description": "VM : disable-unexposed-features-toporequest",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.dispTopoRequest\\.disable : ",
        "expect": "isolation\\.tools\\.dispTopoRequest\\.disable : True$"
    },
    "custom_item_37": {
        "description": "VM : disable-unexposed-features-trashfolderstate",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.trashFolderState\\.disable : ",
        "expect": "isolation\\.tools\\.trashFolderState\\.disable : True$"
    },
    "custom_item_38": {
        "description": "VM : disable-unexposed-features-trayicon",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.ghi\\.trayicon\\.disable : ",
        "expect": "isolation\\.tools\\.ghi\\.trayicon\\.disable : True$"
    },
    "custom_item_39": {
        "description": "VM : disable-unexposed-features-unity",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unity.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unity\\.disable : ",
        "expect": "isolation\\.tools\\.unity\\.disable : True$"
    },
    "custom_item_40": {
        "description": "VM : disable-unexposed-features-unity-interlock",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unityInterlockOperation\\.disable : ",
        "expect": "isolation\\.tools\\.unityInterlockOperation\\.disable : True$"
    },
    "custom_item_41": {
        "description": "VM : disable-unexposed-features-unitypush",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unity\\.push\\.update\\.disable : ",
        "expect": "isolation\\.tools\\.unity\\.push\\.update\\.disable : True$"
    },
    "custom_item_42": {
        "description": "VM : disable-unexposed-features-unity-taskbar",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unity\\.taskbar\\.disable : ",
        "expect": "isolation\\.tools\\.unity\\.taskbar\\.disable : True$"
    },
    "custom_item_43": {
        "description": "VM : disable-unexposed-features-unity-unityactive",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" -value $True",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unityActive\\.disable : ",
        "expect": "isolation\\.tools\\.unityActive\\.disable : True$"
    },
    "custom_item_44": {
        "description": "VM : disable-unexposed-features-unity-windowcontents",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" -value $True",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.unity\\.windowContents\\.disable : ",
        "expect": "isolation\\.tools\\.unity\\.windowContents\\.disable : True$"
    },
    "custom_item_45": {
        "description": "VM : disable-unexposed-features-versionget",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.vmxDnDVersionGet\\.disable : ",
        "expect": "isolation\\.tools\\.vmxDnDVersionGet\\.disable : True$"
    },
    "custom_item_46": {
        "description": "VM : disable-unexposed-features-versionset",
        "info": "Disable certain unexposed features.\nSome VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.guestDnDVersionSet\\.disable : ",
        "expect": "isolation\\.tools\\.guestDnDVersionSet\\.disable : True$"
    },
    "custom_item_47": {
        "description": "VM : disable-vix-messages",
        "info": "Disable VIX messages from the VM.\nThe VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should consider disabling certain features to reduce the potential for vulnerabilities.  The ability to send messages from the VM to the host is one of these features.  Note that disabling this feature does NOT adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and 3rd party solutions that rely upon this capability should continue to work. This is a deprecated interface. Enabling this setting is for Profile 1 only, to ensure that any deprecated interface is turned off for audit purposes.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.vixMessage\\.disable : ",
        "expect": "isolation\\.tools\\.vixMessage\\.disable : True$"
    },
    "custom_item_48": {
        "description": "VM : disable-VMtools-autoinstall",
        "info": "Disable tools auto install.\nTools auto install can initiate an automatic reboot, disabling this option will prevent tools from being installed automatically and prevents automatic machine reboots.\n\nFor Linux-based operating system, Open VM Tools is widely available as an distribution-based package. Consider using this method to manage your VM Tools installation. If you do this, you should disable VM Tools auto-install using this guideline.",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.tools.autoInstall.disable\" -value $true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.tools\\.autoInstall\\.disable : ",
        "expect": "isolation\\.tools\\.autoInstall\\.disable : True$"
    },
    "custom_item_49": {
        "description": "VM : disconnect-devices-floppy",
        "info": "Disconnect unauthorized devices.\nEnsure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other required parameters specify how each device is instantiated.  Any enabled or connected device represents a potential attack channel.\n\nWhen setting is set to FALSE, functionality is disabled, however the device may still show up withing the guest operation system.\n\nhttp://pubs.vmware.com/vsphere-55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335-CA46E915A729.html",
        "solution": "# Remove all Floppy drives attached to VMs -\nGet-VM | Get-FloppyDrive | Remove-FloppyDrive",
        "reference": "800-171|3.8.7,800-53|MP-7,800-53r5|MP-7,CN-L3|8.5.4.1(c),CSF|PR.PT-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,NESA|T1.4.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "floppy([Xx]|[0-9]+)\\.present :",
        "not_expect": "floppy[a-zA-Z0-9]\\.present : (False|NOT found)$"
    },
    "custom_item_50": {
        "description": "VM : disconnect-devices-parallel",
        "info": "Disconnect unauthorized devices.\nEnsure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other required parameters specify how each device is instantiated.  Any enabled or connected device represents a potential attack channel.\n\nWhen setting is set to FALSE, functionality is disabled, however the device may still show up withing the guest operation system.\n\nhttp://pubs.vmware.com/vsphere-55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335-CA46E915A729.html",
        "solution": "# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html\n# Remove all Parallel Ports attached to VMs\nGet-VM | Get-ParallelPort | Remove-ParallelPort",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "parallel([Xx]|[0-9]+)\\.present :",
        "expect": "parallel([Xx]|[0-9]+)\\.present : (False|NOT found)$"
    },
    "custom_item_51": {
        "description": "VM : disconnect-devices-serial",
        "info": "Disconnect unauthorized devices.\nEnsure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other required parameters specify how each device is instantiated.  Any enabled or connected device represents a potential attack channel.\n\nWhen setting is set to FALSE, functionality is disabled, however the device may still show up withing the guest operation system.\n\nhttp://pubs.vmware.com/vsphere-55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335-CA46E915A729.html",
        "solution": "# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html\n# Remove all Serial Ports attached to VMs\nGet-VM | Get-SerialPort | Remove-SerialPort",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "serial([Xx]|[0-9]+)\\.present :",
        "expect": "serial([Xx]|[0-9]+)\\.present : (False|NOT found)$"
    },
    "custom_item_52": {
        "description": "VM : limit-setinfo-size",
        "info": "Limit informational messages from the VM to the VMX file.\nThe configuration file containing these name-value pairs is limited to a size of 1MB. This 1MB capacity should be sufficient for most cases, but you can change this value if necessary. You might increase this value if large amounts of custom information are being stored in the configuration file. The default limit is 1MB;this limit is applied even when the sizeLimit parameter is not listed in the .vmx file.  Uncontrolled size for the VMX file can lead to denial of service if the datastore is filled.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-91BF834E-CB92-4014-8CF7-29CE40F3E8A3.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" -value 1048576",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "tools\\.setInfo\\.sizeLimit : ",
        "expect": "tools\\.setInfo\\.sizeLimit : (104857[0-6]|10485[0-6][0-9]|1048[0-4][0-9][0-9]|104[0-7][0-9][0-9][0-9]|10[0-3][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9]|[0-9][0-9][0-9]|[0-9][0-9]|[0-9])$"
    },
    "custom_item_53": {
        "description": "VM : prevent-device-interaction-connect",
        "info": "Prevent unauthorized removal, connection and modification of devices.\nIn a virtual machine, users and processes without root or administrator privileges can connect or disconnect devices, such as network adaptors and CD-ROM drives, and can modify device settings. Use the virtual machine settings editor or configuration editor to remove unneeded or unused hardware devices. If you want to use the device again, you can prevent a user or running process in the virtual machine from connecting, disconnecting, or modifying a device from within the guest operating system. By default, a rogue user with nonadministrator privileges in a virtual machine can:\n1. Connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive\n2. Disconnect a network adaptor to isolate the virtual machine from its network, which is a denial of service\n3. Modify settings on a device\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168-C62D9306DBD6.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.device.connectable.disable\" -value $true",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.device\\.connectable\\.disable : ",
        "expect": "isolation\\.device\\.connectable\\.disable : True$"
    },
    "custom_item_54": {
        "description": "VM : prevent-device-interaction-edit",
        "info": "Prevent unauthorized removal, connection and modification of devices.\nIn a virtual machine, users and processes without root or administrator privileges can connect or disconnect devices, such as network adaptors and CD-ROM drives, and can modify device settings. Use the virtual machine settings editor or configuration editor to remove unneeded or unused hardware devices. If you want to use the device again, you can prevent a user or running process in the virtual machine from connecting, disconnecting, or modifying a device from within the guest operating system. By default, a rogue user with nonadministrator privileges in a virtual machine can:\n1. Connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive\n2. Disconnect a network adaptor to isolate the virtual machine from its network, which is a denial of service\n3. Modify settings on a device\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168-C62D9306DBD6.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"isolation.device.edit.disable\" -value $true",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "isolation\\.device\\.edit\\.disable : ",
        "expect": "isolation\\.device\\.edit\\.disable : True$"
    },
    "custom_item_55": {
        "description": "VM : restrict-host-info",
        "info": "Do not send host information to guests.\nBy enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host.\n\nIf set to True a VM can obtain detailed information about the physical host. *The default value for the parameter is False but is displayed as Null. Setting to False is purely for audit purposes.*\n\nThis setting should not be TRUE unless a particular VM requires this information for performance monitoring.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB-A16A11951A2D.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\" -value $false",
        "reference": "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "tools\\.guestlib\\.enableHostInfo : ",
        "expect": "tools\\.guestlib\\.enableHostInfo : False$"
    },
    "custom_item_56": {
        "description": "VM : verify-network-filter",
        "info": "Control access to VMs through the dvfilter network APIs.\nAn attacker might compromise a VM by making use the dvFilter API. Configure only those VMs to use the API that need this access.\n\nThis setting is considered an \"Audit Only\" guideline. If there is a value present, the admin should check it to ensure it is correct.\n http://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html",
        "solution": "From the vSphere web client, select each VM and click \"Manage\" -> \"Settings\" -> \"VM Options\". Click \"Edit\". Go to \"VM Options\" tab and expand \"Advanced\". Click on \"Edit Configuration\". Click on \"Add Row\" and then add the desired configuration parameter with the desired value.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "ethernet[0-9]+\\.filter[0-9]+\\.name :",
        "expect": "ethernet[0-9]+\\.filter[0-9]+\\.name : NOT found$"
    },
    "custom_item_57": {
        "description": "VM : verify-PCI-Passthrough",
        "info": "Audit all uses of PCI or PCIe passthrough functionality.\nUsing the VMware DirectPath I/O feature to pass through a PCI or PCIe device to a virtual machine results in a potential security vulnerability.  The vulnerability can be triggered by buggy or malicious code running in privileged mode in the guest OS, such as a device driver.  Industry-standard hardware and firmware does not currently have sufficient error containment support to make it possible for ESXi to close the vulnerability fully.\n\nThere can be a valid business reason for a VM to have this configured. This is an audit-only guideline. You should be aware of what virtual machines are configured with direct passthrough of PCI and PCIe devices and ensure that their guest OS is monitored carefully for malicious or buggy drivers that could crash the host.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.powercli.ug.doc/GUID-0E922C7E-67DF-4A05-B4C0-013FC4EC60F4.html",
        "solution": "# Add the setting to all VMs -\nGet-VM | New-AdvancedSetting -Name \"pciPassthru*.present\" -value \"\"",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "pciPassthru.*\\.present : ",
        "expect": "pciPassthru.*\\.present : NOT found$"
    },
    "custom_item_58": {
        "description": "vNetwork : reject-forged-transmit - 'vSwitch'",
        "info": "Ensure that the Forged Transmits policy is set to reject.\nIf the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nForged transmissions is set to Accept by default.\n\nThis means the virtual switch does not compare the source and effective MAC addresses.\n\nTo protect against MAC address impersonation, all virtual switches should have forged transmissions set to Reject. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-7DC6486F-5400-44DF-8A62-6273798A2F80.html\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html",
        "solution": "From the vSphere Web Client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click edit. Go to \"Security\" and set the \"Forged Transmits\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "forgedTransmits =",
        "expect": "forgedTransmits = False$"
    },
    "custom_item_59": {
        "description": "vNetwork : reject-forged-transmit - 'PortGroup'",
        "info": "Ensure that the Forged Transmits policy is set to reject.\nIf the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nForged transmissions is set to Accept by default.\n\nThis means the virtual switch does not compare the source and effective MAC addresses.\n\nTo protect against MAC address impersonation, all virtual switches should have forged transmissions set to Reject. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-7DC6486F-5400-44DF-8A62-6273798A2F80.html\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html",
        "solution": "From the vSphere Web Client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click edit. Go to \"Security\" and set the \"Forged Transmits\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "forgedTransmits =",
        "expect": "forgedTransmits = False$"
    },
    "custom_item_60": {
        "description": "vNetwork : reject-mac-changes - 'vswitch'",
        "info": "Ensure that the MAC Address Changes policy is set to reject.\nIf the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-942BD3AA-731B-4A05-8196-66F2B4BF1ACB.html",
        "solution": "From the vSphere web client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click edit. Go to \"Security\" and set the \"MAC address changes\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "macChanges =",
        "expect": "macChanges = False$"
    },
    "custom_item_61": {
        "description": "vNetwork : reject-mac-changes - 'portgroup'",
        "info": "Ensure that the MAC Address Changes policy is set to reject.\nIf the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-942BD3AA-731B-4A05-8196-66F2B4BF1ACB.html",
        "solution": "From the vSphere web client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click edit. Go to \"Security\" and set the \"MAC address changes\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "macChanges =",
        "expect": "macChanges = False$"
    },
    "custom_item_62": {
        "description": "vNetwork : reject-promiscuous-mode - 'vswitch'",
        "info": "Ensure that the Promiscuous Mode policy is set to reject.\nWhen promiscuous mode is enabled for a virtual switch all virtual machines connected to the Portgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that Portgroup. Promiscuous mode is disabled by default on the ESXI Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch.  An exception should be made for the Portgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that Portgroup. Promiscous mode can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-92F3AB1F-B4C5-4F25-A010-8820D7250350.html",
        "solution": "From the vSphere Web Client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click Edit. Go to \"Security\" and set the \"Promiscuous Mode\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "allowPromiscuous =",
        "expect": "allowPromiscuous = False$"
    },
    "custom_item_63": {
        "description": "vNetwork : reject-promiscuous-mode - 'portgroup'",
        "info": "Ensure that the Promiscuous Mode policy is set to reject.\nWhen promiscuous mode is enabled for a virtual switch all virtual machines connected to the Portgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that Portgroup. Promiscuous mode is disabled by default on the ESXI Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch.  An exception should be made for the Portgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that Portgroup. Promiscous mode can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-92F3AB1F-B4C5-4F25-A010-8820D7250350.html",
        "solution": "From the vSphere Web Client select the host and click \"Manage\" -> \"Networking\" -> \"Virtual Switches\". For each virtual switch and for each port group within that virtual switch, click Edit. Go to \"Security\" and set the \"Promiscuous Mode\" to \"Reject\".",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "allowPromiscuous =",
        "expect": "allowPromiscuous = False$"
    },
    "custom_item_64": {
        "description": "vNetwork : verify-dvfilter-bind",
        "info": "Prevent unintended use of dvfilter network APIs.\nIf you are not using products that make use of the dvfilter network API, the host should not be configured to send network information to a VM. If the API is enabled, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host.  If you are using a product that makes use of this API then verify that the host has been configured correctly.\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html\n\nhttp://pubs.vmware.com/vsphere-60/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970-953C-ACCB36ADA8AD.html",
        "solution": "# Set Remove Net.DVFilterBindIpAddress to null on all hosts -\nGet-VMHost HOST1 | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Net.DVFilterBindIpAddress -Value \"\" }",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://www.vmware.com/content/dam/digitalmarketing/vmware/en/files/xls/vSphere_6_0_Hardening_Guide_GA_15_Jun_2015.xls",
        "xsl_stmt": "",
        "regex": "Net\\.DVFilterBindIpAddress : ",
        "expect": "Net\\.DVFilterBindIpAddress : NOT found$"
    }
}