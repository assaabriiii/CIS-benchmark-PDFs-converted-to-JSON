{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "3.1.1 Require Explicit Authorization for Cataloging (CATALOG_NOAUTH)",
        "info": "Db2 can be configured to allow users that do not possess the SYSADM authority to catalog and uncatalog databases and nodes. It is recommended that the CATALOG_NOAUTH parameter be set to NO.\n\nRationale:\n\nCataloging a database is the process of registering a database from a remote client to allow remote call and access. Setting CATALOG_NOAUTH to YES bypasses all permissions checks and allows anyone to catalog and uncatalog databases.",
        "solution": "Perform the following to require explicit authorization to catalog and uncatalog databases and nodes.\n\nAttach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using catalog_noauth no",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^NO$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(CATALOG_NOAUTH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_3": {
        "description": "DFTDBPATH OS Permissions",
        "value_data": "check316",
        "file": "@DB2_DFTDBPATH@"
    },
    "custom_item_4": {
        "description": "DFTDBPATH Setting",
        "value_data": "^.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(DFTDBPATH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_5": {
        "description": "3.1.3 Set Diagnostic Logging to Capture Errors and Warnings (DIAGLEVEL)",
        "info": "The DIAGLEVEL parameter specifies the type of diagnostic errors that will be recorded in the db2diag.log file. It is recommended that the DIAGLEVEL parameter be set to at least 3.\n\nRationale:\n\nThe recommended DIAGLEVEL setting is 3, but any value greater than 3 is also acceptable. A value of at least 3 will allow the Db2 instance to capture all errors and warnings that occur on the system.",
        "solution": "Attach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using diaglevel 3",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^NO$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(DIAGLEVEL\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_6": {
        "description": "3.1.4 Secure Permissions for All Diagnostic Logs (DIAGPATH)",
        "info": "The DIAGPATH parameter specifies the location of the diagnostic files for the Db2 instance. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All Db2 administrators should have full access to the directory.\n\nRationale:\n\nSecuring the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved.",
        "solution": "For Windows and Linux\nTo change the directory for the diagnostic logs:\n\nAttach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using diagpathAdditional steps for Windows:\n\nConnect to the Db2 host\n\nRight-click over the diagnostic log directory\n\nChoose Properties\n\nSelect the Security tab\n\nGrant the Full Control authority to all Db2 administrator accounts\n\nGrant only read and execute privileges to all other accounts (revoke any other privileges)\n\nAdditional steps for Linux:\n\nConnect to the Db2 host\n\nChange to the diagnostic log directory\n\nChange the permissions of the directory\n\n$ chmod -R 3777 .",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check318",
        "file": "@DB2_DIAGPATH@"
    },
    "custom_item_7": {
        "description": "3.1.5 Secure Permissions for Alternate Diagnostic Log Path (ALT_DIAGPATH)",
        "info": "The ALT_DIAGPATH parameter specifies an alternative location of the diagnostic files for the Db2 instance if the primary location specified by DIAGPATH is unavailable. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All Db2 administrators should have full access to the directory.\n\nRationale:\n\nSecuring the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved.",
        "solution": "For Windows and Linux\nTo change the directory for the diagnostic logs:\n\nAttach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using diagpathAdditional steps for Windows:\n\nConnect to the Db2 host\n\nRight-click over the diagnostic log directory\n\nChoose Properties\n\nSelect the Security tab\n\nGrant the Full Control authority to all Db2 administrator accounts\n\nGrant only read and execute privileges to all other accounts (revoke any other privileges)\n\nAdditional steps for Linux:\n\nConnect to the Db2 host\n\nChange to the diagnostic log directory\n\nChange the permissions of the directory\n\n$ chmod -R 3777 .",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check318",
        "file": "@DB2_ALTDIAGPATH@"
    },
    "custom_item_8": {
        "description": "3.1.6 Disable Client Discovery Requests (DISCOVER)",
        "info": "The DISCOVER parameter determines what kind of discovery requests, if any, the Db2 client can make. It is recommended that this is disabled.\n\nRationale:\n\nDiscovery capabilities may be used by a malicious entity to derive the names of and target Db2 instances. In this configuration, the client can not issue discovery requests.",
        "solution": "Run the following command:\n\ndb2 => update database manager configuration using discover disable",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^KNOWN$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(DISCOVER\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_9": {
        "description": "3.1.7 Disable Instance Discoverability (DISCOVER_INST)",
        "info": "The DISCOVER_INST parameter specifies whether the instance can be discovered in the network. It is recommended that instances not be discoverable.\n\nRationale:\n\nDiscovery capabilities may be used by a malicious entity to derive the names of and target Db2 instances.",
        "solution": "Attach to the Db2 instance:\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using discover_inst disable",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^DISABLE$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(DISCOVER_INST\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_10": {
        "description": "MAX_CONNECTIONS",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(MAX_CONNECTIONS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_11": {
        "description": "MAX_COORDAGENTS",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(MAX_COORDAGENTS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_12": {
        "description": "3.1.9 Set Administrative Notification Level (NOTIFYLEVEL)",
        "info": "The NOTIFYLEVEL parameter specifies the type of administration notification messages that are written to the administration notification log.\n\nIt is recommended that this parameter be set greater than or equal to 3.\n\nA setting of 3, which includes settings 1 & 2, will log all fatal errors, failing services, system integrity, as well as system health.\n\nRationale:\n\nThe system should be monitoring all Health Monitor alarms, warnings, and attentions. This may give an indication of any malicious usage on the Db2 instance.",
        "solution": "Attach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using notifylevel 3\n\nDefault Value:\n\nThe default value of NOTIFYLEVEL is 3.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^[3|4]$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(NOTIFYLEVEL\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_13": {
        "description": "3.1.10 Secure the Java Development Kit Installation Path (JDK_PATH)",
        "info": "The JDK_PATH parameter contains the directory under which the Software Developer's Kit (SDK) for Java(TM) is installed. The Java SDK is used for running Java stored procedures and user-defined functions. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.\n\nRationale:\n\nRestricting access to the Java JDK will help ensure that only an authorized JDK is used for running Java routines within Db2.",
        "solution": "For Windows and Linux:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command to change the JDK path, if necessary:\n\ndb2 => update database manager configuration using\n       jdk_pathAdditional steps for Windows:\n\nConnect to the Db2 host\n\nRight-click over the directory used as the JDK path\n\nChoose Properties\n\nSelect the Security tab\n\nAssign ownership of the directory to the Db2 Administrator\n\nGrant all Db2 administrator accounts the Full Control authority\n\nGrant only read and execute privileges to all other users (revoke all other privileges)\n\nAdditional steps for Linux:\n\nConnect to the Db2 host as root\n\nChange to the directory used as the JDK path\n\nAssign bin to be the owner of the directory using the chown command\n\nChange the permissions for the directory\n\n$ chmod -R 755",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check318",
        "file": "@DB2_JDK_PATH@"
    },
    "custom_item_14": {
        "description": "3.1.11 Secure the Python Runtime Path (PYTHON_PATH)",
        "info": "The PYTHON_PATH parameter contains the directory under which the Python runtime is installed. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.\n\nRationale:\n\nRestricting access to the python runtime will help ensure that only an authorized runtime is used for running Python routines within Db2.",
        "solution": "For Windows and Linux:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command to change the Python path, if necessary:\n\ndb2 => update database manager configuration using\n       python_pathAdditional steps for Windows:\n\nConnect to the Db2 host\n\nRight-click over the directory used as the Python path\n\nChoose Properties\n\nSelect the Security tab\n\nAssign ownership of the directory to the Db2 Administrator\n\nGrant all Db2 administrator accounts the Full Control authority\n\nGrant only read and execute privileges to all other users (revoke all other privileges)\n\nAdditional steps for Linux:\n\nConnect to the Db2 host as root\n\nChange to the directory used as the Python path\n\nAssign bin to be the owner of the directory using the chown command\n\nChange the permissions for the directory\n\n$ chmod -R 755",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check318",
        "file": "@DB2_PYTHON_PATH@"
    },
    "custom_item_15": {
        "description": "3.1.12 Secure the R Runtime Path (R_PATH)",
        "info": "The R_PATH parameter contains the directory under which the R runtime is installed. The R runtime is used for running R stored procedures and user-defined functions. It is recommended that the owner of this directory is bin on Linux and AIX, and a member of the Db2 administration group on Windows. The directory should have read and execute permission for all users, but only write permission for the owner.\n\nRationale:\n\nRestricting access to the R runtime will help ensure that only an authorized runtime is used for running R routines within Db2.",
        "solution": "For Windows and Linux:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command to change the R path, if necessary:\n\ndb2 => update database manager configuration using\n       r_pathAdditional steps for Windows:\n\nConnect to the Db2 host\n\nRight-click over the directory used as the R path\n\nChoose Properties\n\nSelect the Security tab\n\nAssign ownership of the directory to the Db2 Administrator\n\nGrant all Db2 administrator accounts the Full Control authority\n\nGrant only read and execute privileges to all other users (revoke all other privileges)\n\nAdditional steps for Linux:\n\nConnect to the Db2 host as root\n\nChange to the directory used as the R path\n\nAssign bin to be the owner of the directory using the chown command\n\nChange the permissions for the directory\n\n$ chmod -R 755",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check318",
        "file": "@DB2_R_PATH@"
    },
    "custom_item_16": {
        "description": "3.1.13 Secure the Communication Buffer Exit Library (COMM_EXIT_LIST)",
        "info": "A communication exit library is a dynamically loaded library that vendor applications use to examine communication buffers. The COMM_EXIT_LIST parameter specifies the list of communication buffer exist libraries. The permissions on the libraries should be secured so that users other than the instance owner do not have write privileges.\n\nRationale:\n\nIf a malicious user has write access to a communication exit library, they can overwrite it with their own thereby receiving all of the communication buffers that Db2 receives over the network. Securing the libraries will prevent a loss of confidentiality of data.",
        "solution": "To change permissions of a file on Linux:\n\nchmod 755To change permissions of a file on Windows:\n\nRight-click on the file\n\nChoose properties\n\nSelect the Security tab\n\nGrant the Full Control authority to all Db2 administrator accounts\n\nGrant only read and execute privileges to all other accounts (revoke any other privileges)",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check911",
        "file": "@DB2_PLUGIN_PATH@\\commexit\\@DB2_DATABASE@"
    },
    "custom_item_17": {
        "description": "3.2.1 Specify Secure Remote Shell Command (DB2RSHCMD)",
        "info": "The DB2RSHCMD registry varible specifies the remote shell command to use when starting remote database partitions and with the db2_all script to run utilities and commands on all database partitions. It is recommended that a value be used which encrypts the data sent between partitions, such as ssh.\n\nRationale:\n\nThe traditional rsh command sends all its data, including passwords, in plaintext between partitions. An attacker who can read network traffic may have access to these passwords and other data. Specifying a remote shell command, such as ssh encrypts the data sent over the network.\n\nImpact:\n\nEnabling this value without configuring public and private keys may result in an inability to start or stop Db2 across all partitions without manually issuing db2start/db2stop individually on each partition.",
        "solution": "Follow the guidance on this page to create public and private keys for ssh:\nhttps://www.ibm.com/docs/en/db2/11.5?topic=installation-enabling-execution-remote-commands\n\nRun the following command to set the DB2_RSHCMD registry variable to ssh:\n\ndb2set DB2RSHCMD=ssh\n\nDefault Value:\n\nIn Db2 V11.5 Mod Pack 5 or earlier, the default value is rsh.\n\nIn Db2 V11.5 Mod Pack 6 or later, the default value is ssh.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "DB2RSHCMD=ssh",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2RSHCMD'"
    },
    "custom_item_18": {
        "description": "3.2.2 Turn Off Remote Command Legacy Mode (DB2RCMD_LEGACY_MODE)",
        "info": "The DB2RCMD_LEGACY_MODE registry variable determines whether the Db2 Remote Command Service runs with enhanced security or not. It is recommended that legacy mode not be enabled.\n\nThis registry variable only applies to Db2 Servers running on Windows.\n\nRationale:\n\nLegacy mode requires the Db2 service account to have privileges to impersonate the client account.",
        "solution": "Run the following command to set the DB2RCMD_LEGACY_MODE registry variable to OFF:\n\ndb2set DB2RCMD_LEGACY_MODE=OFF\n\nDefault Value:\n\nThe default value of DB2RCMD_LEGACY_MODE is OFF.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "DB2RCMD_LEGACY_MODE=OFF",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2RCMD_LEGACY_MODE'"
    },
    "custom_item_19": {
        "description": "3.2.3 Disable Grants During Restore (DB2_RESTORE_GRANT_ADMIN_AUTHORITIES)",
        "info": "The DB2_RESTORE_GRANT_ADMIN_AUTHORITIES registry variable determines whether the authorization ID of the user performing a restore is granted administrative authorities (SECADM, DBADM, DATAACCESS, and ACCESSCTRL authorities) on the restored database. It is typically used when restoring a database on a server where the original database creator account does not exist. It is recommended that this variable not be set except when specifically performing a restore where you wish these privileges to be granted so they are not accidentally granted.\n\nRationale:\n\nUse of this registry variable may grant administrative authorities accidentally if the value is left on during normal operations and a restore is run.",
        "solution": "Run the following command to set the DB2_RESTORE_GRANT_ADMIN_AUTHORITIES registry variable to OFF:\n\ndb2set DB2_RESTORE_GRANT_ADMIN_AUTHORITIES=OFF\n\nDefault Value:\n\nThe default value of DB2_RESTORE_GRANT_ADMIN_AUTHORITIES is OFF.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "DB2_RESTORE_GRANT_ADMIN_AUTHORITIES=OFF",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2_RESTORE_GRANT_ADMIN_AUTHORITIES'"
    },
    "custom_item_20": {
        "description": "3.2.4 Enable Extended Security (DB2_EXTSECURITY)",
        "info": "The DB2_EXTSECURITY registry variable determines whether extended security is enabled on Windows. Extended security enables file permissions for all Db2 objects so they can be accessed by users in DB2ADMNS and DB2USERS groups. It is recommended that extended security be enabled.\n\nThis registry variable only applies to Db2 Servers running on Windows.\n\nRationale:\n\nExtended security provides file permission protection for Db2 objects when running in a multi-user environment.\n\nImpact:\n\nBefore enabling extended security for an existing installation, you should ensure you have added users to the DB2ADMNS and DB2USERS groups so that you are able to access Db2 once the permission have been applied. Once extended security is enabled, it is not recommended to be directly disabled, instead a full re-install should be used.",
        "solution": "Run the following command to enable extended security (consult documentation for additional options as appropriate):\n\ndb2extsec",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "DB2_EXTSECURITY=ON",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2_EXTSECURITY'"
    },
    "custom_item_21": {
        "description": "3.2.5 Limit OS Privileges of Fenced Mode Process (DB2_LIMIT_FENCED_GROUP)",
        "info": "The DB2_LIMIT_FENCED_GROUP registry variable allows restricting the operating system privileges of the fenced mode process (db2fmp) to the privileges assigned to the DB2USERS group.\n\nThis variable only has effect if extended security is enabled (DB2_EXTSEC) and the Db2 Service Account is not LocalSystem.\n\nThis registry variable only applies to Db2 Servers running on Windows.\n\nRationale:\n\nBy default, the fenced mode process has access to both the DB2ADMNS and DB2USERS groups.",
        "solution": "Run the following command to set the DB2_LIMIT_FENCED_GROUP registry variable to ON:\n\ndb2set DB2_LIMIT_FENCED_GROUP=ON\n\nDefault Value:\n\nThe default value of DB2_LIMIT_FENCED_GROUP is OFF.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "DB2_LIMIT_FENCED_GROUP=ON",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2_LIMIT_FENCED_GROUP'"
    },
    "custom_item_22": {
        "description": "3.3.1 Secure Db2 Runtime Library",
        "info": "A Db2 software installation will place all executables under the default\\sqllib directory. This directory needs to be secured so it grants only the necessary access to authorized users and administrators.\n\nRationale:\n\nThe Db2 runtime is comprised of files that are executed as part of the Db2 service. If these resources are not secured, an attacker may alter them to execute arbitrary code.",
        "solution": "For Windows:\n\nConnect to the Db2 host\n\nRight-click on the NODE000x\\sqldbdir directory\n\nChoose Properties\n\nSelect the Security tab\n\nSelect all DB administrator accounts and grant them the Full Control authority\n\nSelect all other accounts and revoke all privileges other than Read and Execute\n\nFor Linux:\n\nConnect to the Db2 host\n\nChange to the /NODE000x/sqldbdir directory\n\nChange the permission level of the directory to this recommended value\n\n$ chmod -R 755\n\nDefault Value:\n\nLinux\n\n$DB2PATH/NODE000x/sqldbdir is owned by the Db2 administrator with read, write, and execute access.\n\nWindows\n\n$DB2PATH\\NODE000x\\sqldbdir owned by the Db2 administrator with read, write, and execute access.\n\nThe database instance db2inst1 located in /home/NODE000x needs the following permissions:\n\ndrwxrwxr-x 11 db2inst1 db2grp1 4096 Aug 08 1:34 NODE0000\n\nAll lower directories need the same settings:\n\n/db2,/db2/data, /db2/data/db2inst1, /db2/data/db2inst1/db2inst1 and /db2/data/db2inst1/db2inst1/NODE0000 would need the same settings drwxrwxr-x.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "check21",
        "file": "@DB2_SQLDB_DIR@"
    },
    "custom_item_23": {
        "description": "4.1.2 Set Failed Archive Retry Delay (ARCHRETRYDELAY)",
        "info": "The ARCHRETRYDELAY parameter specifies the number of seconds the Db2 service will wait before it reattempts to archive log files after a failure. It is recommended that this parameter be set anywhere in the range of 10-30. You do not want the delay to be so short that the database ends up in a denial of service scenario, but you don't want the delay to be too long if an outside attack happens at the same time.\n\nRationale:\n\nEnsure that the value is non-zero, otherwise archive logging will not retry after the first failure. A denial of service attack can render the database without an archive log if this setting is not set. An archive log will ensure that all transactions can safely be restored or logged for auditing.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toTo successfully set the ARCHRETRYDELAY within the 10-30 range, run the following command:\n\ndb2 => update database configuration using archretrydelay *nn* (where *nn* is a range between 10-30)\n\nDefault Value:\n\nThe default value for ARCHRETRYDELAY is 20.",
        "reference": "800-53|AU-11,800-53r5|AU-11,CSCv8|8.10,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1A,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^1[0-9]|2[0-9]|30$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(ARCHRETRYDELAY\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_24": {
        "description": "4.1.3 Auto-restart After Abnormal Termination (AUTORESTART)",
        "info": "The AUTORESTART parameter specifies if the database manager will start a crash recovery automatically when the first user tries to connect to a database which has previously terminated abnormally.\n\nIf the parameter is set to OFF an explicit RESTART DATABASE command has to be issued to initiate a crash recovery.\n\nIt is recommended that this parameter is set to ON (which is also the default).\n\nRationale:\n\nSetting the database to auto-restart will reduce the downtime of the database.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using autorestart on\n\nDefault Value:\n\nThe default value for AUTORESTART is ON.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^ON$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(AUTORESTART\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_25": {
        "description": "4.1.4 Disable Database Discovery (DISCOVER_DB)",
        "info": "The DISCOVER_DB parameter specifies if the database will respond to a discovery request from a client. It is recommended that this parameter be set to DISABLE.\n\nRationale:\n\nSetting the database discovery to disabled can hide a database with sensitive data.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using discover_db disable",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^disable$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(DISCOVER_DB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_26": {
        "description": "LOGARCHMETH1 Setting",
        "value_data": "^DISK:.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(LOGARCHMETH1\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_27": {
        "description": "LOGARCHMETH1 OS Permissions",
        "value_data": "check3119",
        "file": "@DB2_LOGARCHMETH1@"
    },
    "custom_item_28": {
        "description": "LOGARCHMETH2 Setting",
        "value_data": "check3118",
        "file": "@DB2_LOGARCHMETH2@"
    },
    "custom_item_29": {
        "description": "LOGARCHMETH2 OS Permissions",
        "value_data": "^DISK:.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(LOGARCHMETH2\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_30": {
        "description": "FAILARCHPATH Setting",
        "value_data": "^DISK:.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(FAILARCHPATH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_31": {
        "description": "FAILARCHPATH OS Permissions",
        "value_data": "check3119",
        "file": "@DB2_FAILARCHPATH@"
    },
    "custom_item_32": {
        "description": "MIRRORLOGPATH Setting",
        "value_data": "^.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(MIRRORLOGPATH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_33": {
        "description": "MIRRORLOGPATH OS Permissions",
        "value_data": "check3120",
        "file": "@DB2_MIRRORLOGPATH@"
    },
    "custom_item_34": {
        "description": "OVERFLOWLOGPATH Setting",
        "value_data": "^.+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(OVERFLOWLOGLOGPATH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_35": {
        "description": "OVERFLOWLOGPATH OS Permissions",
        "value_data": "check3120",
        "file": "@DB2_OVERFLOWLOGPATH@"
    },
    "custom_item_36": {
        "description": "4.1.10 Establish Retention Set Size for Backups (NUM_DB_BACKUPS)",
        "info": "The NUM_DB_BACKUPS parameter specifies the number of backups to retain for a database before marking the oldest backup as deleted. It is recommended that this parameter be set to at least 12.\n\nRationale:\n\nRetain multiple copies of the database backup to ensure that the database can recover from an unexpected failure. This parameter should not be set to 0. Multiple backups should be kept ensuring that all logs and transactions can be used for auditing.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using num_db_backups 12",
        "reference": "800-171|3.8.9,800-53|CP-9,800-53|CP-10,800-53r5|CP-9,800-53r5|CP-10,CSCv7|10.1,CSCv8|11.2,CSF|PR.IP-4,CSF|RC.RP-1,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(ii),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,ITSG-33|CP-10,ITSG-33|CP-10a.,LEVEL|1M,NESA|M5.2.3,NESA|T2.2.4,QCSC-v1|5.2.3,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^1[2-9]|[1-9][0-9]+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(NUM_DB_BACKUPS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_37": {
        "description": "4.1.11 Set Archive Log Failover Retry Limit (NUMARCHRETRY)",
        "info": "The NUMARCHRETRY parameter determines how many times a database will try to archive the log file to the primary or the secondary archive destination before trying the failover directory. It is recommended that this parameter be set to 5.\n\nRationale:\n\nEstablishing a failover retry time limit will ensure that the database will always have a means to recover from an abnormal termination. This parameter should not be set to 0.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using numarchretry 5",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-4,800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-4,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv7|6.4,CSCv8|8.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.DS-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-4,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^5$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(NUMARCHRETRY\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_38": {
        "description": "4.1.12 Set Maximum Number of Applications (MAXAPPLS)",
        "info": "The MAXAPPLS parameter specifies the maximum number of concurrent applications that can be connected (both local and remote) to a database. In an instance with a single database, it is recommended that this value be set to AUTOMATIC. While this indicates that any number of connections should be allowed, an upper limit of MAX_CONNECTIONS database manager configuration parameter is still enforced. If there are multiple databases within the instance, then the sum of MAXAPPLS for each database should be less than or equal to MAX_CONNECTIONS.\n\nWhen AUTOMATIC is used, MAXAPPLS can also have a parameter. The value is not used to determine the maximum number of connections, but rather for dependent parameters, such as PCKCACHESZ and CATALOG_CACHESZ that can derive their value from MAXAPPLS. In such a case the value specified with AUTOMATIC should represent the expected number of connections.\n\nRationale:\n\nBy default, Db2 allows an unlimited number of users to access the Db2 instance. In addition to giving access to the Db2 instance to authorized users only, it is recommended to set a limit to the number of users allowed to access a Db2 instance. This helps prevent denial of service conditions should an authorized process malfunction and attempt many simultaneous connections.\n\nImpact:\n\nIncreasing the value of this parameter without lowering the MAXLOCKS parameter or increasing the LOCKLIST parameter could cause you to reach the database limit on locks (LOCKLIST) rather than the application limit and as a result cause pervasive lock escalation problems.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Connect to the Db2 database\n\ndb2 => connect toIf a single database is used in the instance, run the following command:\n\ndb2 => update database configuration using maxappls AUTOMATIC\n\nIf multiple databases are used in the instance, determine appropriate values for each database such that the sum of MAXAPPLS values equals the MAX_CONNECTIONS database manager configuration parameter value (for example 100 for each of 2 databases when MAX_CONNECTIONS is 200), and run the following command:\n\ndb2 => update database configuration using maxappls 200",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": ".+",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(MAXAPPLS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_39": {
        "description": "4.1.13 Ensure a Secure Connect Procedure is Used (CONNECT_PROC)",
        "info": "The CONNECT_PROC stored procedure runs as part of every connection to the database and allows customization of the application environment, such as setting special registers. It could for example, set the CURRENT_PATH special register which controls the search path for finding functions and procedures to execute. Only an authorized procedure should be used.\n\nRationale:\n\nThe CONNECT_PROC procedure could be used to modify the application environment within the connection causing unexpected behavior.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To turn off the connect proc, perform the following commands:\n\nConnect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using\n       connect_proc NULL IMMEDIATE",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1M,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(CONNECT_PROC\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_40": {
        "description": "4.1.14 Specify a Secure Location for External Tables (EXTBL_LOCATION)",
        "info": "The EXTBL_LOCATION database configuration parameter provides an allow list of paths that external tables may access for local files, for both reading and writing. It is recommended that this value be set to appropriate paths with the understanding that confidential data may reside in this directory. Specifying appropriate paths is part of an organizations standard operating procedures (SOP).\n\nRationale:\n\nExternal tables can read and write data to the paths configured within the EXTBL_LOCATION configuration parameter. To avoid a loss of confidentiality of the data which may be reside in these paths, they should be examined to ensure they match the values specified by the SOP.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To specify an external table location, perform the following commands:\n\nConnect to the Db2 database\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using extbl_location",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(EXTBL_LOCATION\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_41": {
        "description": "4.1.15 Disable Database Discoverability (DISCOVER_DB)",
        "info": "The DISCOVER_DB parameter specifies whether the database can be discovered in the network. It is recommended that databases not be discoverable.\n\nRationale:\n\nDiscovery capabilities may be used by a malicious entity to derive the names of and target Db2 databases.",
        "solution": "Connect to the Db2 database.\n\ndb2 => connect toRun the following command:\n\ndb2 => update database configuration using discover_db disable",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^disable$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(DISCOVER_DB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_42": {
        "description": "5.1 Specify a Secure Connection Authentication Type (SRVCON_AUTH)",
        "info": "This parameter can take on any of the following values:\n\nNOT_SPECIFIED\n\nCLIENT\n\nSERVER\n\nSERVER_ENCRYPT\n\nKERBEROS\n\nKRB_SERVER_ENCRYPT\n\nGSSPLUGIN\n\nGSS_SERVER_ENCRYPT\n\nSERVER_ENCRYPT_TOKEN\n\nKERBEROS_TOKEN\n\nGSSPLUGIN_TOKEN\n\nKRB_SVR_ENC_TOKEN\n\nGSS_SVR_ENC_TOKEN\n\nIf this parameter is set to NOT_SPECIFIED, then the type of authentication for connections is determined by the AUTHENTICATION parameter.\n\nRecommendations:\n\nDo not use CLIENT authentication type.\n\nSERVER_ENCRYPT instead of SERVER is recommended as a compensating configuration if TLS cannot be used to encrypted client server communications.\n\nRationale:\n\nWhen using CLIENT authentication type, the server trusts the client to authenticate the connecting user. A malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.\n\nWhen using SERVER authentication type without SSL enabled, the user ID and password that are sent from the client to the server during a connect or an attach are in plaintext format. Therefore, these credentials are exposed when sent across an unsecure network and can be intercepted by a malicious user.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is advisable to ensure that the setting is implemented during an approved maintenance window.",
        "solution": "Attach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration parameter\n       using srvcon_authRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start\n\nRefer to the 'encryption of data in motion' section for more information about using SSL for client-server communication.",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^SERVER$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(SRVCON_AUTH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_43": {
        "description": "5.2 Specify a Secure Authentication Type (AUTHENTICATION)",
        "info": "The AUTHENTICATION database manager configuration parameter specifies how and where authentication takes place for incoming connections to the database as well as local authorization of commands run outside a connection or attachment, such as tools run from the command line. This parameter can be overridden by the SRVCON_AUTH parameter for incoming connections.\n\nThis parameter can take on any of the following values:\n\nCLIENT\n\nSERVER\n\nSERVER_ENCRYPT\n\nDATA_ENCRYPT\n\nDATA_ENCRYPT_CMP\n\nKERBEROS\n\nKRB_SERVER_ENCRYPT\n\nGSSPLUGIN\n\nGSS_SERVER_ENCRYPT\n\nRecommendations:\n\nDo not use CLIENT, DATA_ENCRYPT or DATA_ENCRYPT_CMP authentication types.\n\nSERVER_ENCRYPT instead of SERVER is recommended as a compensating configuration if TLS cannot be used to encrypted client server communications.\n\nRationale:\n\nWhen using CLIENT authentication type, the server trusts the client to authenticate the connecting user. A malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.\n\nDATA_ENCRYPT and DATA_ENCRYPT_CMP authentication types provide the ability to encrypt both user credentials and user data when sent from the client to the server. Since these authentication types use DES encryption algorithm which is cryptographically weak, they are deprecated in favor of SSL.\n\nWhen using SERVER authentication type without SSL enabled, the user ID and password that are sent from the client to the server during a connect or an attach are in plaintext format. Therefore, these credentials are exposed when sent across an insecure network and can be intercepted by a malicious user.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.",
        "solution": "Attach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration parameter\n       using authenticationRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start\n\nRefer to the 'encryption of data in motion' section for more information about using SSL for client-server communication.",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(AUTHENTICATION\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_44": {
        "description": "5.3 Database Manager Configuration Parameter: ALTERNATE_AUTH_ENC",
        "info": "The ALTERNATE_AUTH_ENC database manager configuration parameter specifies the encryption algorithm that is used to encrypt user ID and password that are sent from the client during a connect or attach. This parameter is in effect when the authentication method that is negotiated between the client and the server is SERVER_ENCRYPT.\n\nIt is recommended to set this parameter to AES_ONLY.\n\nRationale:\n\nIf this parameter is set to a value other than AES_ONLY, the server can accept the DES encryption algorithm to encrypt the user credentials and DES is cryptographically weak in comparison to AES.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Attach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration parameter\n       using alternate_auth_enc aes_only\n\nRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(\\ALTERNATE_AUTH_ENC)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_45": {
        "description": "5.4 Database Manager Configuration Parameter: TRUST_ALLCLNTS",
        "info": "This database manager configuration parameter is only active when the authentication parameter is set to CLIENT which is not a recommended setting as discussed in the [authentication parameter section](#specify-a-secure-authentication-type-authentication). If the parameter is set to YES, the server assumes that the client side is handling authentication to the database. If the parameter is set to NO, the client must provide authentication to the server on behalf of the user.\n\nThe recommended value for this parameter is NO.\n\nRationale:\n\nIf the server trusts the client to authenticate the connecting user, a malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Attach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration parameter\n       using trust_allclnts no\n\nRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(TRUST_ALLCLNTS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_46": {
        "description": "5.5 Database Manager Configuration Parameter: TRUST_CLNTAUTH",
        "info": "This database manager configuration parameter is only active when the authentication parameter is set to CLIENT which is not a recommended setting as discussed in the [authentication parameter section](#specify-a-secure-authentication-type-authentication). If the parameter is set to CLIENT, the user ID and password are not needed, but if they are provided, authentication will occur at the client. If the parameter is set to SERVER, the user ID and password are needed and will be authenticated at the server.\n\nThe recommended value for this parameter is SERVER.\n\nRationale:\n\nIf the server trusts the client to authenticate the connecting user, a malicious user can connect to the database as any user including a database administrator by simply creating that user on the client system.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Attach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration parameter\n       using trust_clntauth SERVER\n\nRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53|AC-3,800-53r5|AC-2(1),800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|6.7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(TRUST_CLNTAUTH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_47": {
        "description": "5.6 Database Manager Configuration Parameter: FED_NOAUTH",
        "info": "The FED_NOAUTH database manager configuration parameter determines whether federated authentication will be bypassed at the instance. If this parameter is set to YES, the AUTHENTICATION parameter is set to SERVER or SERVER_ENCRYPT and the FEDERATED parameter is set to YES, then authentication at the instance is bypassed and is instead assumed to be performed at the data source.\n\nIt is recommended to set this parameter to NO.\n\nRationale:\n\nSetting FED_NOAUTH to NO will ensure that authentication is not bypassed for any users that are connecting to the instance.\n\nImpact:\n\nIt is important to be aware that the implementation of this recommendation results in a brief downtime. It is therefore advisable to ensure that the setting is implemented during an approved maintenance window.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Attach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using fed_auth no\n\nRestart the Db2 instance.\n\ndb2 => db2stop\ndb2 => db2start",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1M,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(FED_NOAUTH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_48": {
        "description": "5.8 DB2_GRP_LOOKUP Registry Variable (Windows only)",
        "info": "The DB2_GRP_LOOKUP registry variable specifies which Windows security mechanism is used to enumerate the groups that a user belongs to. Periodic review of this variable is required to ensure that the correct location is being used for group definitions during authentication.\n\nRationale:\n\nIncorrectly configured DB2_GRP_LOOKUP registry variable could result in unexpected authorization behavior where a low privileged user could potentially get access to sensitive data.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to set the DB2_GRP_LOOKUP registry variable to the appropriate location for group lookup:\n\ndb2set DB2_GRP_LOOKUP=",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all}"
    },
    "custom_item_49": {
        "description": "5.9 DB2DOMAINLIST Registry Variable (Windows only)",
        "info": "This registry variable is only active is the authentication parameter is set to CLIENT which is not a recommended setting as discussed in section 6.2. It is possible to have a user id be represented across multiple domains. Issues could arise when trying to authenticate such a user id. To prevent these issues, a listing of domains should be defined within the DB2DOMAINLIST registry variable.\n\nPeriodic review of the domain list assigned to the DB2DOMAINLIST registry variable helps ensure that non-essential domains do not have unnecessary authorizations.\n\nRationale:\n\nIncorrectly configured DB2DOMAINLIST registry variable could result in unexpected authorization behavior where a low privileged user could potentially get access to sensitive data.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to set the DB2DOMAINLIST registry variable to the appropriate domains:\n\ndb2set DB2DOMAINLIST=",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16.6,CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1M,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all}"
    },
    "custom_item_50": {
        "description": "5.10 DB2AUTH Registry Variable",
        "info": "The DB2AUTH registry variable is used to control various authentication related behaviors in Db2.\n\nThe following settings are recommended for this registry variable:\n\nUse DISABLE_CHGPASS which disables the ability to change a user's password from the client.\n\nUse JCC_ENFORCE_SECMEC which enforces that the Db2 server does not accept a clear text password security mechanism when using SERVER_ENCRYPT authentication type.\n\nIf CLIENT authentication is being used which is not recommended as discussed in section 6.2, it is also recommended to set this registry variable to TRUSTEDCLIENT_SRVENC and not TRUSTEDCLIENT_DATAENC. TRUSTEDCLIENT_SRVENC forces untrusted clients to use SERVER_ENCRYPT authentication type while TRUSTEDCLIENT_DATAENC forces them to use DATA_ENCRYPT.\n\nIf DB2AUTH is not set to DISABLE_CHGPASS, refer to the DB2CHGPWD_EEE registry variable section which specifies whether users are able to change passwords through Db2 in a partitioned database environment.\n\nRationale:\n\nAllowing a client to change a user's password through Db2 commands is not recommended since Db2 may not enforce the expected password change rules. In addition, the password change requests going through Db2 may not be audited as expected.\n\nPlain text passwords sent across an unsecure network are exposed and can be intercepted by a malicious user.\n\nDATA_ENCRYPT is deprecated since it uses DES encryption algorithm which is cryptographically weak. Furthermore, enforcing SERVER_ENCRYPT ensures that the user ID and password are encrypted when sent from the client to the server.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to set the DB2AUTH registry variable to the appropriate values:\n\ndb2set DB2AUTH=",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all}"
    },
    "custom_item_51": {
        "description": "5.11 DB2CHGPWD_EEE Registry Variable",
        "info": "The DB2CHGPWD_EEE registry variable specifies whether users are able to change passwords through Db2 in a partitioned database environment.\n\nIt is recommended to set this variable to NO.\n\nRationale:\n\nIf password management in the partitioned database environment is not centralized, then it could result in a situation where one partition has the updated password for a given user while the rest have the old password which is a security risk.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to set the DB2CHGPWD_EEE registry variable to NO:\n\ndb2set DB2CHGPWD_EEE=NO",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1M,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all}"
    },
    "custom_item_52": {
        "description": "6.1.1 Secure SYSADM Authority",
        "info": "The sysadm_group parameter defines the system administrator group (SYSADM) authority. It is recommended that the sysadm_group group contains authorized users only.\n\nRationale:\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Define a valid group name for the SYSADM group.\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration\n       using sysadm_groupDefault Value:\n\nThe default value for sysadm_group is NULL.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(\\SYSADM_GROUP)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_53": {
        "description": "6.1.2 Secure SYSCTRL Authority",
        "info": "The sysctrl_group parameter defines the system administrator group with system control (SYSCTRL) authority. It is recommended that the sysctrl_group group contains authorized users only.\n\nRationale:\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Define a valid group name for the SYSCTRL group.\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update dbm cfg using sysctrl_groupDefault Value:\n\nThe default value for sysctrl_group is NULL.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(\\SYSCTRL_GROUP)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_54": {
        "description": "6.1.3 Secure SYSMAINT Authority",
        "info": "The sysmaint_group parameter defines the system administrator group that possesses the system maintenance (SYSMAINT) authority. It is recommended that the sysmaint_group group contains authorized users only.\n\nRationale:\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Define a valid group name for the SYSMAINT group.\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration\n       using sysmaint_groupDefault Value:\n\nThe default value for sysmaint_group is NULL.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(\\SYSMAINT_GROUP)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_55": {
        "description": "6.1.4 Secure SYSMON Authority",
        "info": "The sysmon_group parameter defines the operating system groups with system monitor (SYSMON) authority. It is recommended that the sysmon_group group contain authorized users only.\n\nRationale:\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the Db2 instance will be at increased risk.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Define a valid group name for the SYSMON group.\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration\n       using sysmon_groupDefault Value:\n\nThe default value for sysmon_group is NULL.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SYSMON_GROUP\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_56": {
        "description": "7.1.1 Disable the Audit Buffer",
        "info": "Db2 can be configured to use an audit buffer where individual audit events are gathered into a large buffer to improve performance by reducing the number of writes to disk. It is recommended that the audit buffer be disabled by setting the size to 0.\n\nRationale:\n\nIncreasing the audit buffer size to greater than 0 will allocate space for the audit records generated by the audit facility. At scheduled intervals, or when the audit buffer is full, the db2auditd audit daemon empties the audit buffer to disk, writing the audit records asynchronously. As the events are held in memory for some time before being written to disk, if the database server happened to crash those event would be lost. Setting the buffer size to 0 ensure events are written directly to disk.\n\nImpact:\n\nDisabling the audit buffer may have noticeable impact on overall performance of the database server.",
        "solution": "Perform the following to disable the audit buffer:\n\nAttach to the Db2 instance\n\ndb2 => attach toRun the following command:\n\ndb2 => update database manager configuration using audit_buf_sz 0",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "^0$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(AUDIT_BUF_SZ\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_57": {
        "description": "7.1.2 Disable Limited Audit of Applications (DB2_LIMIT_AUDIT_APPS)",
        "info": "The DB2_LIMIT_AUDIT_APPS registry variable contains a list of application names that should not be audited. It is recommended that this variable should not be set and all applications should be audited.\n\nThe DB2_LIMIT_AUDIT_APPS registry variable is not documented.\n\nRationale:\n\nThe application name not to be audited is determined by the client and not validated by the server. It is possible for a malicious user to change their application name to avoid being audited.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following command to remove any applications from the list:\n\ndb2set DB2_LIMIT_AUDIT_APPS=",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-1,800-53|AU-2,800-53r5|AU-1,800-53r5|AU-2,CN-L3|8.1.4.3(a),CSCv8|8.1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-1,ITSG-33|AU-2,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all} | Select-String 'DB2_LIMIT_AUDIT_APPS'"
    },
    "custom_item_58": {
        "description": "7.1.4 Ensure Audit is Enabled Within the Instance",
        "info": "Auditing is crucial for securing and discovering issues within your databases.\n\nAuditing can help trigger events for changes to data objects, table DML, and user access.\n\nRationale:\n\nIf instance auditing is not enabled, issues may go undiscovered, and compromises and other incidents may occur without being quickly detected. It may also not be possible to provide evidence of compliance with security laws, regulations, and other requirements.",
        "solution": "Issue the following command to activate instance level auditing:\n\n$ db2audit start",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "TRUE",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2audit describe} | Select-String 'Audit active'"
    },
    "custom_item_59": {
        "description": "8.1.1 Configure a Server-side Key Store for TLS (SSL_SVR_KEYDB)",
        "info": "To enable TLS support in a Db2 server, it is necessary to configure a key store that will contain certificates to be used for secure TLS communication between a Db2 client and Db2 server.\n\nRationale:\n\nOn the server side, Db2 requires a key store to be configured. Otherwise, TLS support cannot be enabled.",
        "solution": "Perform the following to set SSL_SVR_KEYDB:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command, whereis the fully qualified path to the keystore file:\n\ndb2 => update dbm cfg using SSL_SVR_KEYDB(Optional) To use the Microsoft certificate store on Windows, set SSL_SVR_KEYDB to GSK_MS_CERTIFICATE_STORE:\n\ndb2 => update dbm cfg using SSL_SVR_KEYDB GSK_MS_CERTIFICATE_STORE\n\nIf a keystore file is being used, ensure only the instance owner and administrators have access to the file. Do not grant world readable or world writable permissions on the keystore file.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_SVR_KEYDB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_60": {
        "description": "8.1.2 Configure a Server-side Stash File for TLS (SSL_SVR_STASH)",
        "info": "If a key store file is being used to configure TLS support in a Db2 instance, a stash file must also be configured to allow the Db2 server to be able to read certificates from the keystore. If the Microsoft certificate store is configured on a Windows platform, a stash file is not required.\n\nRationale:\n\nDb2 does not have a method for an operator to enter a password for a server-side SSL key store, so a stash file must be used to provide the password to Db2. The Microsoft certificate store does not require a password, so a stash file is not required.",
        "solution": "Perform the following to set SSL_SVR_STASH:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command, whereis the fully qualified path to the keystore file:\n\ndb2 => update dbm cfg using SSL_SVR_STASHIf a stash file is being used, ensure only the instance owner and administrators have access to the file.\n\nDo not grant world readable or world writable permissions on the stash file.\nIf the Microsoft certificate store is being used on Windows, it is not necessary to set SSL_SVR_STASH.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_SVR_KEYDB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_61": {
        "description": "8.1.3 Configure an Endpoint Certificate (SSL_SVR_LABEL)",
        "info": "The SSL_SVR_LABEL database manager configuration parameter controls which certificate Db2 will serve to clients. This certificate must have its associated certificate chain present in the server-side key store and must be associated with a private key.\n\nRationale:\n\nIt is highly recommended to set SSL_SVR_LABEL. Leaving this parameter blank and allowing Db2 to utilize a default certificate will only work with CMS(.KDB) format key stores, and the feature is deprecated.",
        "solution": "Perform the following to set SSL_SVR_LABEL:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command, whereis the name of a certificate present in the server-side key store.\n\ndb2 => update dbm cfg using SSL_SVR_LABELIn Db2 11.5.4 and later, or Db2 11.1.4.5 and later with the DB2_DYNAMIC_SSL_LABEL registry variable set to ON, updating the value of SSL_SVR_LABEL while attached to the instance will cause the certificate served by Db2 to change while instance is running, with no effect on existing connections.\n\nPrior releases of Db2 require an instance recycle (db2stop/db2start) for the change to take effect.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-171|3.13.16,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53|SC-28,800-53|SC-28(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(a),CN-L3|8.1.4.8(b),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|16.4,CSCv7|16.5,CSCv8|3.10,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-1,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|28.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_SVR_LABEL\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_62": {
        "description": "8.1.4 Configure the Service Name for TLS (SSL_SVCENAME)",
        "info": "The SSL_SVCENAME database manager configuration parameter controls which port Db2 will listen on for TLS encrypted connections. SSL_SVCENAME can consist of one of the following:\n\nA port number\n\nService name defined in /etc/services (UNIX/Linux) or %WINDIR%\\system32\\drivers\\etc\\services (windows)\n\nRationale:\n\nDb2 must have a port number or service name defined to enable TLS communication. Db2 does not choose a default port number if SSL_SVCENAME is unset.",
        "solution": "Perform the following to set SSL_SVCENAME:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command, whereis a port number or named service.\n\ndb2 => update dbm cfg using SSL_SVCENAMEDb2 must be recycled (db2stop/db2start) for changes to SSL_SVCENAME to take effect.",
        "reference": "800-171|3.13.1,800-171|3.13.2,800-53|PL-8,800-53|SA-8,800-53r5|PL-8,800-53r5|SA-8,CSCv7|9.2,CSCv8|16.10,CSF|ID.AM-3,CSF|PR.IP-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|SA-8,ITSG-33|SA-8a.,LEVEL|1M,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|SS3,NIAv2|VL2,QCSC-v1|4.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_SVCENAME\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_63": {
        "description": "8.1.5 Configure a Secure TLS Version (SSL_VERSIONS)",
        "info": "The SSL_VERSIONS database manager configuration parameter controls which versions of the TLS protocol Db2 enables. In Db2 11.5 and earlier, TLS 1.0 and 1.1 are enabled by default if SSL_VERSIONS is not set.\n\nRationale:\n\nTLS 1.0 and 1.1 are considered insecure and have been deprecated as of Db2 11.5. It is recommended to use TLS 1.2",
        "solution": "Perform the following to set SSL_VERSIONS:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command to enable TLS 1.2 within the Db2 server.\n\ndb2 => update dbm cfg using SSL_VERSIONS TLSV12\n\nDb2 must be recycled (db2stop/db2start) for changes to SSL_VERSIONS to take effect.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_VERSIONS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_64": {
        "description": "8.1.6 Configure Secure TLS Cipher Suites (SSL_CIPHERSPECS)",
        "info": "The SSL_CIPHERSPECS database manager configuration parameter controls which cipher suites are enabled by Db2. If it is unset, Db2 will enable a default list of ciphers.\n\nRationale:\n\nThe default list of ciphers includes SHA1 ciphers, which are considered weak.\n\nIn addition, some cipher suites enabled by default do not support perfect forward secrecy. Depending on the security requirements of your organization, it may be necessary to restrict which ciphers are enabled by Db2.",
        "solution": "Perform the following to set SSL_CIPHERSPECS:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command to enable a specific set of ciphers within\nthe Db2 server.\n\ndb2 => update dbm cfg using SSL_CIPHERSPECSReplacewith one or multiple of the following cipher suites. If multiple items are specified, separate them with a single comma and no spaces.\n\nTLS_RSA_WITH_AES_256_GCM_SHA384\n\nTLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n\nTLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n\nTLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n\nTLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n\nTLS_RSA_WITH_AES_256_CBC_SHA256\n\nTLS_RSA_WITH_AES_128_GCM_SHA256\n\nTLS_RSA_WITH_AES_128_CBC_SHA256\n\nTLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n\nTLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n\nTLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n\nTLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_CIPHERSPECS\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_65": {
        "description": "8.1.7 Unset the Service Name for Plaintext Communication (SVCENAME)",
        "info": "The SSVCENAME database manager configuration parameter controls which port Db2 will listen on for unencrypted connections.\n\nRationale:\n\nTo prevent unencrypted remote connections to the DB2 instance, it is good practice to unset the value of the SVCENAME DBM CFG parameter to prevent Db2 from starting the TCP listener, even if DB2COMM is set to TCPIP.",
        "solution": "Perform the following to unset SVCENAME:\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command, whereis a port number or named service.\n\ndb2 => update dbm cfg using SVCENAME NULL\n\nDb2 must be recycled (db2stop/db2start) for changes to SSL_SVCENAME to take effect.",
        "reference": "800-171|3.13.1,800-171|3.13.2,800-53|PL-8,800-53|SA-8,800-53r5|PL-8,800-53r5|SA-8,CSCv7|9.2,CSCv8|16.10,CSF|ID.AM-3,CSF|PR.IP-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|SA-8,ITSG-33|SA-8a.,LEVEL|1M,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|SS3,NIAv2|VL2,QCSC-v1|4.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SVCENAME\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_66": {
        "description": "8.1.8 Configure a Client-side Key Store for TLS (SSL_CLNT_KEYDB)",
        "info": "To enable TLS support in a Db2 client, it is possible to configure a key store in the database manager configuration that will contain root certificates to be used for secure TLS communication between a Db2 client and Db2 server.\n\nRationale:\n\nOn the client side, Db2 requires the root certificates for the server to be available. This can be achieved by configuring a client-side keystore. This parameter is optional and is not needed if clients use the SSLClientKeystoredb or SSLServerCertificate parameters in the db2cli.ini or db2dsdriver.cfg files, or in the connection string.",
        "solution": "Perform the following to set SSL_CLNT_KEYDB:\n\nRun the following command, whereis the fully qualified path to the keystore file:\n\ndb2 => update dbm cfg using SSL_CLNT_KEYDB(Optional) To use the Microsoft certificate store on Windows, set SSL_CLNT_KEYDB to GSK_MS_CERTIFICATE_STORE:\n\ndb2 => update dbm cfg using SSL_CLNT_KEYDB GSK_MS_CERTIFICATE_STORE\n\nRestart the client application. If the CLP is being used, run the following command to terminate the background process\n\ndb2 => terminate\n\nIf a client-side keystore file is being used, ensure that any users running client applications, and administrators have access to the file. Do not grant world readable or world writable permissions on the stash file.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_CLNT_KEYDB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_67": {
        "description": "8.1.9 Configure a Client-side Stash File for TLS (SSL_CLNT_STASH)",
        "info": "If a key store file is being used to configure client-side TLS support in a Db2 instance, a stash file should also be configured to allow the Db2 client to be able to read certificates from the keystore. If the Microsoft certificate store is configured on a Windows platform, a stash file is not required.\n\nRationale:\n\nThe database manager configuration does not provide a method for specifying a password for the client-side SSL key store. The Microsoft certificate store does not require a password, so a stash file is not required.\n\nImpact:\n\nPerform the following to determine if SSL_CLNT_STASH is required, and if it is set.\n\nAttach to the Db2 instance.\n\ndb2 => attach toRun the following command:\n\ndb2 => get database manager configuration\n\nLocate the value of SSL_CLNT_KEYDB in the output:\n\nSSL client keydb file (SSL_CLNT_KEYDB) =\n\nIf the value of SSL_CLNT_KEYDB is not GSK_MS_CERTIFICATE_STORE, locate the value of SSL_CLNT_STASH and ensure SSL_CLNT_STASH is not blank.\n\nSSL client stash file (SSL_CLNT_STASH)=",
        "solution": "Perform the following to set SSL_CLNT_STASH:\n\nRun the following command, where is the fully qualified path to the keystore file:\n\ndb2 => update dbm cfg using SSL_CLNT_KEYDBRestart the client application.\nIf the CLP is being used, run the following command to terminate the background process\n\ndb2 => terminate\n\nIf a stash file is being used, ensure that any users running client applications, and administrators have access to the file. Do not grant world readable or world writable permissions on the stash file.\n\nIf the Microsoft certificate store is being used on Windows, it is not necessary to set SSL_CLNT_STASH.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(SSL_CLNT_KEYDB\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_68": {
        "description": "8.1.10 Enable TLS Communication Between HADR Primary and Standby Instances (HADR_SSL_LABEL)",
        "info": "The HADR_SSL_LABEL database configuration parameter controls whether connections between HADR peers are encrypted, and which certificate is served to an HADR peer when establishing an HADR connection.\n\nRationale:\n\nTo protect database data and log records when they are sent from a primary database to a standby database, the HADR_SSL_LABEL database configuration should be set.",
        "solution": "Perform the following steps on both the primary and any standby databases to enable TLS encrypted HADR. A server side keystore and stash file (SSL_SVR_KEYDB/SSL_SVR_STASH) must be configured to enable TLS encrypted HADR communication:\n\nRun the following command as the instance owner.\n\ndb2 => update db cfg forusing HADR_SSL_LABELReplacewith the name of a certificate present in the server-side keystore (SSL_SVR_KEYDB).\n\nIf it is active, HADR must be recycled for changes to the HADR_SSL_LABEL registry variable to take effect.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "Manual Review Required",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DB2_DATABASE@} | Select-String '\\(HADR_SSL_LABEL\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_69": {
        "description": "8.1.11 Enable Remote TLS Connections to Db2 (DB2COMM)",
        "info": "The DB2COMM registry variable controls what types of remote connections Db2 will accept. It can be configured to enable plaintext communication, encrypted communication, or both.\n\nRationale:\n\nFor security, DB2COMM should be set to enable only TLS encrypted communications.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to set DB2COMM and enable TLS:\n\nRun the following command as the instance owner.\n\ndb2set DB2COMM=SSL\n\nDb2 must be recycled (db2stop/db2start) for changes to the DB2COMM registry variable to take effect.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "value_data": "",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2set -all DB2COMM}"
    }
}