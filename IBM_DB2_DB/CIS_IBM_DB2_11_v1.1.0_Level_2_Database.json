{
    "custom_item_1": {
        "description": "4.1.1 Creating the Database Without PUBLIC Grants (RESTRICTIVE)",
        "info": "This parameter indicates whether the database was created with the RESTRICTIVE clause in the CREATE DATABASE statement. When creating a database, the use of the RESTRICTIVE clause will cause certain privileges to be revoked from PUBLIC.\n\nRationale:\n\nImpact:\n\nAllowing the default privileges granted to the group PUBLIC to remain in tack can have negative impacts on the database as well as undermine measures put in place to limit access to authorized users.",
        "solution": "There is no remediation for this parameter due to the fact that the placement of the RESTRICTIVE clause happens within the CREATE DATABASE statement. Unless your backup strategies allow for a complete overhaul of your environment where you are able to recreate the database with the RESTRICTIVE clause, we do not recommend changing this parameter. However, if you would like to align your database configuration to that which the RESTRICTIVE clause would provide, please ensure the following:\n\nSYSCAT.DBAUTH - Ensure PUBLIC is NOT granted the following authorities:\n\nCREATETAB\n\nBINDADD\n\nCONNECT\n\nIMPLICIT_SCHEMA\n\nSYSCAT.TABAUTH - Ensure PUBLIC is NOT granted the following privileges:\n\nSELECT on all SYSCAT and SYSIBM tables\n\nSELECT and UPDATE on all SYSSTAT tables\n\nSELECT on the following views in schema SYSIBMADM:\n\nALL_*\n\nUSER_*\n\nROLE_*\n\nSESSION_*\n\nDICTIONARY\n\nTAB\n\nSYSCAT.ROUTINEAUTH - Ensure PUBLIC is NOT granted the following privileges:\n\nEXECUTE with GRANT on all procedures in schema SQLJ\n\nEXECUTE with GRANT on all functions and procedures in schema SYSFUN\n\nEXECUTE with GRANT on all functions and procedures in schema SYSPROC\n\nEXECUTE on all table functions in schema SYSIBM\n\nEXECUTE on all other procedures in schema SYSIBM\n\nSYSCAT.MODULEAUTH - Ensure PUBLIC is NOT granted the following privileges:\n\nEXECUTE on the following modules in schema SYSIBMADM:\n\nDBMS_DDL\n\nDBMS_JOB\n\nDBMS_LOB\n\nDBMS_OUTPUT\n\nDBMS_SQL\n\nDBMS_STANDARD\n\nDBMS_UTILITY\n\nSYSCAT.PACKAGEAUTH - Ensure PUBLIC is NOT granted the following privileges:\n\nBIND on all packages created in the NULLID schema\n\nEXECUTE on all packages created in the NULLID schema\n\nSYSCAT.SCHEMAAUTH - Ensure PUBLIC' is NOT granted the following privileges:\n\nCREATEIN on schema SQLJ\n\nCREATEIN on schema NULLID\n\nSYSCAT.TBSPACEAUTH - Ensure PUBLIC is NOT granted the USE privilege on table space USERSPACE1.\n\nSYSCAT.WORKLOADAUTH - Ensure PUBLIC is NOT granted the USAGE privilege on SYSDEFAULTUSERWORKLOAD.\n\nSYSCAT.VARIABLEAUTH - Ensure PUBLIC is NOT granted the READ privilege on schema global variables in the SYSIBM schema.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "sql_request": "select value from sysibmadm.dbcfg where name = 'restrict_access'",
        "sql_expect": "YES"
    },
    "custom_item_2": {
        "description": "6.4.1 Ensure Trusted Contexts are Enabled",
        "info": "A Trusted Context object provides a means of enforcing encryption, assigning privileges based on roles, and ensuring that the actions performed on behalf of a user are performed in the context of the user's ID and privileges.\n\nRationale:\n\nCreating Trusted Context objects to enforce encryption and assign roles will protect data in transit and limit access to information on a per user/role basis. Additionally, it ensures actions can be traced back to the user.",
        "solution": "If there is no enabled Trusted Context object, create a Trusted Context object if needed and enable it.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "sql_request": "select contextname, enabled from syscat.contexts where enabled = 'Y'",
        "sql_expect": ".+"
    },
    "custom_item_3": {
        "description": "8.2.9 Rotate the Master Key",
        "info": "Key rotation refers to the process of changing encryption keys and is often required for compliance purposes. Similar to a password change, key rotation is done to reduce the risk that can come from exposure of the key, while it exists. Since the DEK used by Db2 for encryption is never outside of the encrypted database, backup, or transaction log, there is little risk of exposure. The same is not true for the MK, which lives outside of the database.\n\nThe rotation of the MK does not affect the encryption of the DEK within existing backups or archived transaction logs.\n\nThe master key (MK) should be rotated based on the frequency needed for compliance. Rotating MK requires decrypting any DEK encrypted with the old MK and then re-encrypting it with the new MK. The data is encrypted with a DEK and does not get re-encrypted.\n\nRationale:\n\nConsider rotating the MK as being similar to changing passwords every X number of days. You may also have external requirements to rotate the MK after a certain period of time.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The SYSPROC.ADMIN_ROTATE_MASTER_KEY procedure can be used to change the database key to comply with key rotation requirement. You must be connected to the database to run this command.\n\ndb2 => CALL SYSPROC.ADMIN_ROTATE_MASTER_KEY('newMasterKeyLabel')\n\nDb2 will automatically generate the new MK and label unless you provide a MK label for an existing MK. Key rotation is logged in the db2diag.log file:\n\n$ grep -A 3 'Key Rotation' ~/sqllib/db2dump/db2diag.log\nKey Rotation successful using label:\nDATA #2 : String, 46 bytes\nDB2_SYSGEN_db2inst1_SECRET_2021-04-29-11.22.01\n\nThe DEK is not externalized and does not need to be rotated. However, if you wish to rotate the DEK you can take an offline backup and restore to a new encrypted database, thus generating a new DEK.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/10752",
        "sql_request": "SELECT * FROM TABLE(SYSPROC.ADMIN_GET_ENCRYPTION_INFO())",
        "sql_expect": ""
    }
}