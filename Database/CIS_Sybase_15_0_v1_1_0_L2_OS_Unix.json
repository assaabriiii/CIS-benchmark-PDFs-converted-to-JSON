{
    "custom_item_1": {
        "description": "Linux found",
        "cmd": "uname -a",
        "expect": "Linux"
    },
    "custom_item_2": {
        "description": "5.3.1 Remove operating system related ESPs - sybsyesp.so",
        "info": "Sybase ASE installs a number of powerful ESPs that allow interaction with the operating\nsystem. A common target for an attacker is the xp_cmdshell ESP, which executes a native\noperating system command on the host system running Sybase ASE.\n\nThe operating system user context under which the command executes is controlled by the\nxp_cmdshell context configuration parameter. Though by default, this is set to only\npermit execution by users with System Administration privileges at the operating system\nlevel, it should be noted that this is insufficient since an attacker who compromised an\naccount with the sa_role could reconfigure the configuration parameter so that\nxp_cmdshell executes commands under the user context that the database server itself is\nrunning as.\n\nBy default, execution of the xp_cmdshell ESP is restricted to users with the sa_role. It is\nrecommended that it is removed, along with the other operating system related ESPs;\nxp_freedll, xp_logevent (Windows only) and xp_enumgroups (Windows only).\n\nFurthermore the library that houses each of these ESPs, sybsyesp.dll (Windows) or\nsybsyesp.so (Unix), should be deleted from the file system to prevent them from being\nrecreated by an attacker.\n\nRationale:\n\nThe xp_cmdshell ESP provides a clear path for privilege escalation from the database to the\noperating system. An attacker could use this functionality in conjunction with a SQL\ninjection attack to gain a foothold on the database host using it as a launch pad to\ncompromise other systems. If this ESP is not used, it is prudent to therefore remove it.",
        "solution": "1. Connect to the ASE server with a user that has the sa_role and execute the\nfollowing statements:\n\nexec sp_dropextendedproc 'xp_cmdshell'\n\nexec sp_dropextendedproc 'xp_freedll'\n\nIn addition, the following statements should be executed on Windows systems:\n\nexec sp_dropextendedproc 'xp_logevent'\n\nexec sp_dropextendedproc 'xp_enumgroups'\n\nIf the above statements return Access is denied, stop the ASE server and repeat the\ncommand.\n\n2. On Windows systems, execute the following command from a command prompt to\ndelete sybsyesp.dll. It is prudent to keep a copy of the file offline in case it needs\nthe xp_cmdshell functionality needs to be restored.\n\ndel %SYBASE%\\%SYBASE_ASE%\\dll\\sybsyesp.dll\n\nOn Unix systems, execute the following command from a command shell (assuming\nthe SYBASE environment variables have been set):\n\nrm $SYBASE\\$SYBASE_ASE\\lib\\sybsyesp.so\n\nOn Unix systems it may be necessary to stop and restart the ASE server for the\nchanges to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "file": "@SYBASE_PATH@/lib/sybsyesp.so"
    },
    "custom_item_3": {
        "description": "6.12 Update the Java Runtime Environment (JRE) regularly if Java is in use",
        "info": "Sybase ASE supports interaction with Java through standards such as JSQL. Sun\nMicrosystems JRE implementation is installed by default although a user with the sa_role\nmust enable Java before it can be used in the database.\n\nSun Microsystems regularly ship updated versions of the JRE to resolve security issues.\nWhilst many of these updates address technologies that have no bearing on Sybase (such as\nJava applets), some updates address security flaws in core JRE classes.\n\nIf Java is enabled it is recommended that the JRE is updated periodically.\n\nRationale:\n\nSecurity flaws in core JRE classes may allow a low privileged user to elevate privilege.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "1. Download the latest JRE from the Java download site. It is typically most convenient\nto download the offline, multi-language installer.\n\n2. Open a command prompt and execute the following command to make a backup of\nthe existing JRE installation folder:\n\nC:\\>xcopy /F /E /-Y /I '%SYBASE%/_jvm' '%SYBASE%\\_jvm.old'\n\n3. Open a command prompt and execute the following command to delete the existing\nJRE installation folder. Press Y to confirm deletion after thoroughly checking the\npath has been typed as shown below:\n\nC:\\>rmdir /S '%SYBASE%/_jvm'\n\n4. If the above command fails, stop the Sybase ASE server and execute the command\nagain.\n\n5. Run the downloaded JRE installer. Select the Advanced Installation Options check\nbox and configure the following options:\n\na. Set the installation path to be equivalent to %SYBASE%\\_jvm. Note that it is\nnot possible to supply a path in this form (i.e. using the %SYBASE%\nenvironment variable); the full path must be entered instead. The %SYBASE%\nenvironment variable corresponds to the ASE installation directory, typically\nC:\\Sybase so in this case the installation path would be C:\\Sybase\\_jvm.\nb. Deselect integration with Internet Explorer.\nc. Select installation of additional language support if required.\n\n6. Complete the JRE installation process and restart the Sybase ASE server if it was\nstopped in step 4.",
        "reference": "800-171|3.4.1,800-53|CM-8a.,800-53r5|CM-8a.,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,LEVEL|2NS,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "cmd": "/usr/bin/java -version",
        "expect": ""
    }
}