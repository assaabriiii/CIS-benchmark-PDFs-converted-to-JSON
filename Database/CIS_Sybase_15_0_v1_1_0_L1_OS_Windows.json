{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "1.2 Review the default login",
        "info": "When the login mode is set to Integrated or Mixed Mode authentication, domain usernames\nare mapped to database usernames via the syslogins table. If a domain user attempts to\nlogin to the database but has no corresponding syslogins entry, the user is logged in as\nthe account specified by the DefaultLogin registry key.\n\n\nThis registry key is empty by default, indicating that only domain users with valid\nsyslogins mappings may login. This setting should be reviewed to ensure that no default\nlogin has been set. If one has been set, its purpose should be fully established before it is\nmodified in order to prevent disruption to applications and users that may be reliant upon\nit. If similar functionality is required it can be accomplished by setting up a group within\nthe Windows domain and creating a mapping within the syslogins table.\n\nRationale:\n\nAssigning a value to the DefaultLogin registry key means that all users with valid\nWindows domain credentials have some level of access to the database. This goes against\nthe security best practice principle of least privilege.",
        "solution": "1. Set the value of the registry key\nHKEY_LOCAL_MACHINE\\SOFTWARE\\SYBASE\\Server\\\\DefaultLogin to the empty string (whereshould be substituted for the name of the ASE instance).",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "value_data": "Pass",
        "powershell_args": "$result='Pass';Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\SYBASE\\Server\\*\\' -name 'DefaultLogin' | ForEach-Object -Process {If($_.DefaultLogin -ne ''){$result='FAIL';$_.PSPath;'DefaultLogin : ' + $_.DefaultLogin}};$result;"
    },
    "custom_item_3": {
        "description": "6.10 Ensure restrictive permissions on the Sybase directory - Administrators",
        "info": "During installation, the Sybase ASE installer will prompt to create the designated install\ndirectory if it does not exist. On Windows systems the default installation path is\nc:\\sybase. The newly created folder will inherit the NTFS permissions of the parent\nfolder.\n\nInstalling Sybase ASE to the default directory typically permits standard authenticated\nusers to read all files in the directory, potentially exposing sensitive information if the\ndatabases themselves are located there. Furthermore, the default permissions also allow a\nstandard authenticated user to write new files in the directory. Note that users would need\nsufficient privilege to logon to the system locally or remotely via Terminal Services.\n\nThe NTFS permissions on the installation directory should be reviewed and modified if\nnecessary ensure that only Administrators and the user that the Sybase ASE server is\nconfigured to run as (typically NT AUTHORITY\\SYSTEM) have full control of the directory and\nthat all others users have no permissions on the folder.\n\n\nNote that removing permissions for a particular user is likely to impact that users ability to\nrun standard database connectivity tools such as isql.exe. It is recommended that\nmodifications to permissions are extensively tested on non-production systems first.\n\nRationale:\n\nWeak NTFS permissions may allow a standard domain user to access sensitive data or\nelevate privilege.",
        "solution": "1. Open a command prompt and execute the following command to remove standard\nuser access to the Sybase directory. Repeat this command specifying appropriate\nusernames/groups until only Administrators and the user that the Sybase ASE\nserver runs as have permissions on the directory.\n\ncacls %SYBASE% /E /R 'BUILTIN\\Users'\n\n2. The above command should return processed dir: C:\\sybase (or an appropriate\npath if Sybase is installed elsewhere). If an error is returned, consult the cacls\ndocumentation.",
        "reference": "800-171|3.1.5,800-53|AC-6(7)(b),800-53r5|AC-6(7)(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.5,ITSG-33|AC-6,LEVEL|1S,NESA|M1.1.3,NESA|T5.1.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "value_data": "",
        "powershell_args": "$f='@SYBASE_INSTALL_DIR@';icacls $f;"
    }
}