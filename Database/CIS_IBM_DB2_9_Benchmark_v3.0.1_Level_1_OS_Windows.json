{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "1.1 Install the latest fix packs",
        "info": "Periodically, IBM releases fix packs to enhance features and resolve defects, including security defects. It is recommended that the DB2 instance remain current with all fix packs.\n\nInstalling the latest DB2 fix pack will help protect the database from known vulnerabilities as well as reduce downtime that may otherwise result from functional defects.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Apply the latest fix pack as offered from IBM.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "ManualReviewRequired",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2level}"
    },
    "custom_item_3": {
        "description": "1.2 Use IP address rather than hostname",
        "info": "Use an IP address rather than a hostname to connect to the host of the DB2 instance.\n\nUsing a hostname to connect to a DB2 instance can display useful information about the host to an attacker. For example, hostnames for DB2 instances often contain the DB2 version number, host type, or operating system type.",
        "solution": "To reconfigure the connection string, launch the DB2 Configuration Assistant and change the connection's Hostname value from a text name to an IP address.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "= [0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\s*$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 list node directory show detail} | Select-String '^\\s*Hostname\\s*='"
    },
    "custom_item_4": {
        "description": "1.4 Use non-default account names",
        "info": "The DB2 service is installed with default accounts with well-known names such as db2admin, db2inst1, dasusr1, or db2fenc1. It is recommended that the use of these account names be avoided. The default accounts may be renamed and then used.\n\nThe use of default accounts may increase the DB2 service's susceptibility to unauthorized access by an attacker.",
        "solution": "For Windows:\n1. Right-click over the %DB2PATH% and select Properties from the menu.\n2. Go to the Security tab and re-assign all the user accounts with well-known default names to use non-default names.\nFor Linux, perform the following command:\nchown -R:$DB2PATH\nNotes:\nReview the impact of changing the usernames before performing this global change.",
        "reference": "800-171|3.1.1,800-53|AC-2f.,800-53r5|AC-2f.,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2f.,LEVEL|1S,NESA|M4.4.3,NESA|T5.2.1,NIAv2|SS14d,PCI-DSSv3.2.1|8.1.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "Accounts:",
        "powershell_args": "'Accounts:'; Get-WmiObject -Class Win32_UserAccount | Where-Object {$_.LocalAccount -match 'True'} | Select-Object Caption | Where {$_.caption -like '*db2admin' -or $_.caption -like '*db2inst1' -or $_.caption -like '*dausr1' -or $_.caption -like '*db2fenc1'} | Format-List"
    },
    "custom_item_5": {
        "description": "2.1 Secure the DB2 Runtime Library",
        "info": "A DB2 software installation will place all executables under the default\\sqllib directory. This directory needs to be secured so it grants only the necessary access to authorized users and administrators.\n\nThe DB2 runtime is comprised of files that are executed as part of the DB2 service. If these resources are not secured, an attacker may alter them to execute arbitrary code.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click on the %DB2PATH%\\sqllib directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all DB administrator accounts and grant them the Full Control authority\n6. Select all non-administrator accounts and revoke all privileges other than Read and Execute\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the $DB2PATH/sqllib directory\n3. Change the permission level of the directory to this recommended value:\nOS => chmod -R 750\nDefault Value:\nLinux: $DB2PATH/sqllib is owned by the DB2 administrator with read, write, and execute access.\nMS Windows: %DB2PATH%\\sqllib owned by the DB2 administrator with read, write, and execute access.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@"
    },
    "custom_item_6": {
        "description": "2.2 Secure the database container directory",
        "info": "A DB2 database container is the physical storage of the data.\n\nThe containers are needed in order for the database to operate properly. The loss of the containers can cause down time. Also, allowing excessive access to the containers may help an attacker to gain access to their contents. Therefore, secure the location(s) of the containers by restricting the access and ownership. Allow only the instance owner to have access to the tablespace containers.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Set the privileges for the directory of the containers. The recommended values are that only DB2 administrators have full access, and all other users have read-only access.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@INSTANCE_CONTAINER_PATH@"
    },
    "custom_item_7": {
        "description": "3.1.2 Encrypt user data across the network",
        "info": "DB2 supports a number of authentication mechanisms. It is recommended that the DATA_ENCRYPT authentication mechanism be used.\n\nThe DATA_ENCRYPT authentication mechanism employs cryptographic algorithms to protect the confidentiality of authentication credentials and user data as they traverse the network between the DB2 client and server.",
        "solution": "The suggested value is DATA_ENCRYPT so that authentication occurs at the server. To set this:\n1. Attach to the DB2 instance:\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using authentication data_encrypt\nDefault Value:\nThe default value for AUTHENTICATION is SERVER.",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|1S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DATA_ENCRYPT",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(AUTHENTICATION\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_8": {
        "description": "3.1.6 Secure permissions for default database file path",
        "info": "The dftdbpath parameter contains the default file path used to create DB2 databases. It is recommended that the permissions for this directory be set to full access for DB2 administrators and read and execute access only for all other accounts. It is also recommended that this directory be owned by the DB2 Administrator.\n\nRestricting access to the directory used as the default file path through permissions will help ensure that the confidentiality, integrity, and availability of the files there are protected.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the default file path, if necessary:\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click over the directory used as the default file path\n3. Choose Properties\n4. Select the Security tab\n5. Assign ownership of the directory to the DB2 Administrator\n6. Grant all DB administrator accounts the Full Control authority\n7. Grant only read and execute privileges to all other users (revoke all other privileges)\n\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the directory used as the default file path\n3. Assign the DB2 Administrator to be the owner of the directory using the chown command\n4. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for this directory is read and write access for non-administrator accounts.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "@DEFAULT_DB_DRIVE@:?$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(DFTDBPATH\\)'| %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_9": {
        "description": "Variable LOG_ARCH_PATH_1 has value",
        "value_data": "LOGARCHMETH1 = [A-Z]:\\.*",
        "powershell_args": "'LOGARCHMETH1 = @LOG_ARCH_PATH_1@'"
    },
    "custom_item_10": {
        "description": "3.2.4 Secure permissions for the primary archive log location",
        "info": "The logarchmeth1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute for all other accounts.\n\nRestricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the logarchmeth1 parameter. This will properly ensure that the primary logs are archived. A value of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the primary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth1Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the primary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH1 is OFF.\nThe default permissions for the directory are read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DISK:@LOG_ARCH_PATH_1@",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(LOGARCHMETH1\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_11": {
        "description": "3.2.4 Secure permissions for the primary archive log location - FILE_PERMISSIONS",
        "info": "The logarchmeth1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute for all other accounts.\n\nRestricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the logarchmeth1 parameter. This will properly ensure that the primary logs are archived. A value of OFF is not acceptable.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the primary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth1Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the primary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH1 is OFF.\nThe default permissions for the directory are read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AU-9(4),800-53|CM-6b.,800-53r5|AU-9(4),800-53r5|CM-6b.,CN-L3|8.1.4.3(d),CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|CM-6b.,LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@LOG_ARCH_PATH_1@"
    },
    "custom_item_12": {
        "description": "3.2.4 Secure permissions for the primary archive log location",
        "info": "The logarchmeth1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute for all other accounts.\n\nRestricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the logarchmeth1 parameter. This will properly ensure that the primary logs are archived. A value of OFF is not acceptable.\n\nNOTE: Since LOG_ARCH_PATH_1 variable does not have a value, LOGARCHMETH1 must be set to non-DISK archiving method.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the primary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth1Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the primary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH1 is OFF.\nThe default permissions for the directory are read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "^(DISK|OFF)",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(LOGARCHMETH1\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_13": {
        "description": "Variable LOG_ARCH_PATH_2 has value",
        "value_data": "LOGARCHMETH2 = [A-Z]:\\.*",
        "powershell_args": "'LOGARCHMETH2 = @LOG_ARCH_PATH_2@'"
    },
    "custom_item_14": {
        "description": "3.2.5 Secure permissions for the secondary archive log location",
        "info": "The logarchmeth2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived log be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the logarchmeth2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the secondary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth2\n\nAdditional steps for Windows (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the secondary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the secondary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH2 is OFF.\nThe default value for the directory is read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DISK:@LOG_ARCH_PATH_2@",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(LOGARCHMETH2\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_15": {
        "description": "3.2.5 Secure permissions for the secondary archive log location - FILE_PERMISSIONS",
        "info": "The logarchmeth2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived log be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the logarchmeth2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the secondary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth2\n\nAdditional steps for Windows (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the secondary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the secondary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH2 is OFF.\nThe default value for the directory is read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AU-9(4),800-53|CM-6b.,800-53r5|AU-9(4),800-53r5|CM-6b.,CN-L3|8.1.4.3(d),CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|CM-6b.,LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@LOG_ARCH_PATH_2@"
    },
    "custom_item_16": {
        "description": "3.2.5 Secure permissions for the secondary archive log location",
        "info": "The logarchmeth2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived log be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the logarchmeth2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.\n\nNOTE: Since LOG_ARCH_PATH_2 variable does not have a value, LOGARCHMETH2 must be set to non-DISK archiving method.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the secondary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth2\n\nAdditional steps for Windows (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the secondary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the secondary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH2 is OFF.\nThe default value for the directory is read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "^(DISK|OFF)",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(LOGARCHMETH2\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_17": {
        "description": "Variable FAIL_ARCH_PATH has value",
        "value_data": "FAILARCHPATH = [A-Z]:\\.*",
        "powershell_args": "'FAILARCHPATH = @FAIL_ARCH_PATH@'"
    },
    "custom_item_18": {
        "description": "3.2.6 Secure permissions for the tertiary archive log location",
        "info": "The failarchpath parameter specifies the type of media and the location used as the tertiary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the failarchpath parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the tertiary archive log directory, if necessary:\ndb2 => update database configuration using failarchpath\n\nAdditional steps for Windows (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the tertiary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the tertiary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for FAILARCHPATH is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "@FAIL_ARCH_PATH@",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(FAILARCHPATH\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_19": {
        "description": "3.2.6 Secure permissions for the tertiary archive log location - FILE_PERMISSIONS",
        "info": "The failarchpath parameter specifies the type of media and the location used as the tertiary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the failarchpath parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the tertiary archive log directory, if necessary:\ndb2 => update database configuration using failarchpath\n\nAdditional steps for Windows (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the tertiary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the tertiary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for FAILARCHPATH is null.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@FAIL_ARCH_PATH@"
    },
    "custom_item_20": {
        "description": "3.2.6 Secure permissions for the tertiary archive log location",
        "info": "The failarchpath parameter specifies the type of media and the location used as the tertiary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the failarchpath parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.  If FAIL_ARCH_PATH variable was not set, to a file path, the permissions could be supplied.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the tertiary archive log directory, if necessary:\ndb2 => update database configuration using failarchpath\n\nAdditional steps for Windows (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the tertiary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the tertiary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for FAILARCHPATH is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "ManualReviewRequired",
        "powershell_args": "'FAILARCHPATH = '; set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(FAILARCHPATH\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_21": {
        "description": "Variable MIRROR_LOG_PATH has value",
        "value_data": "MIRRORLOGPATH = [A-Z]:\\.*",
        "powershell_args": "'MIRRORLOGPATH = @MIRROR_LOG_PATH@'"
    },
    "custom_item_22": {
        "description": "3.2.7 Secure permissions for the log mirror location",
        "info": "The mirrorlogpath parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\n\nA mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected.",
        "solution": "For Windows and Linux:\n1. Connect to the DB2 database.\ndb2 => connect to $DB2INSTANCE user $USERNAME using $PASSWORD\n2. Run the following command from the DB2 command window to change the mirror log directory, if necessary:\ndb2 => update database configuration using mirrorlogpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the mirror log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for mirrorlogpath is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "@MIRROR_LOG_PATH@",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(MIRRORLOGPATH\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_23": {
        "description": "3.2.7 Secure permissions for the log mirror location - FILE_PERMISSIONS",
        "info": "The mirrorlogpath parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\n\nA mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows and Linux:\n1. Connect to the DB2 database.\ndb2 => connect to $DB2INSTANCE user $USERNAME using $PASSWORD\n2. Run the following command from the DB2 command window to change the mirror log directory, if necessary:\ndb2 => update database configuration using mirrorlogpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the mirror log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for mirrorlogpath is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AU-9(4),800-53|CM-6b.,800-53r5|AU-9(4),800-53r5|CM-6b.,CN-L3|8.1.4.3(d),CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|CM-6b.,LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@MIRROR_LOG_PATH@"
    },
    "custom_item_24": {
        "description": "3.2.7 Secure permissions for the log mirror location",
        "info": "The mirrorlogpath parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\n\nA mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.  If MIRROR_LOG_PATH variable was not set, to a file path, the permissions could be supplied.",
        "solution": "For Windows and Linux:\n1. Connect to the DB2 database.\ndb2 => connect to $DB2INSTANCE user $USERNAME using $PASSWORD\n2. Run the following command from the DB2 command window to change the mirror log directory, if necessary:\ndb2 => update database configuration using mirrorlogpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the mirror log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for mirrorlogpath is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "ManualReviewRequired",
        "powershell_args": "'MIRRORLOGPATH = '; set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database configuration for @DATABASE_NAME@} | Select-String '\\(MIRRORLOGPATH\\)' | %{$_ -split('= ')} | Select-Object -Last 1"
    },
    "custom_item_25": {
        "description": "3.3.1 Establish DAS administrative group",
        "info": "The dasadm_group parameter defines the group name with DAS Administration (DASADM) authority for the DAS. It is recommended that the dasadm_group group contains authorized users only.\n\nThe DAS is a special administrative tool that enables remote administration of DB2 servers. DASADM authority is the highest level of authority within the DAS.",
        "solution": "1. Attach to the DB2 instance.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database configuration using dasadm_groupDefault Value:\nThe default value for dasadm_group is null.",
        "reference": "800-171|3.1.5,800-53|AC-6(7),800-53r5|AC-6(7),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.5,ITSG-33|AC-6,LEVEL|1S,NESA|M1.1.3,NESA|T5.1.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "= .+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get admin configuration} | Select-String '\\(DASADM_GROUP\\)'"
    },
    "custom_item_26": {
        "description": "7.3 Establish a system maintenance group",
        "info": "The sysmaint_group parameter defines the system administrator group that possesses the system maintenance (SYSMAINT) authority. It is recommended that the sysmaint_group group contains authorized users only.\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
        "solution": "Define a valid group name for the SYSMAINT group. Note: This parameter does not apply to Windows platforms.\n1. Attach to the DB2 database.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using sysmaint_groupDefault Value:\nThe default value for SYSMAINT_GROUP is NULL.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "= .+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(SYSMAINT_GROUP\\)'"
    },
    "custom_item_27": {
        "description": "7.4 Establish a system monitoring group",
        "info": "The sysmon_group parameter defines the operating system groups with system monitor (SYSMON) authority. It is recommended that the sysmon_group group contains authorized users only.\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increase risk.",
        "solution": "Define a valid group name for the SYSMON group.\n1. Attach to the DB2 database.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using sysmon_groupDefault Value:\nThe default value for SYSMON_GROUP is NULL.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "= .+$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 get database manager configuration} | Select-String '\\(SYSMON_GROUP\\)'"
    },
    "custom_item_28": {
        "description": "8.5 Remove default databases",
        "info": "A DB2 Instance may come installed with default databases. It is recommended that the SAMPLE database be removed.\n\nRemoving unused, well-known databases will reduce the attack surface of the system.",
        "solution": "To drop sample databases:\n1. Connect to the DB2 database.\n2. Run the following command from the DB2 command window:\ndb2 => drop database sample",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "= SAMPLE$",
        "powershell_args": "set-item -path env:DB2CLP -value '**$$**' | Invoke-Command -ScriptBlock {db2 list database directory} | Select-String '^\\s*Database name'"
    },
    "custom_item_29": {
        "description": "8.6 Enable SSL communication with LDAP server",
        "info": "The communication layer between a DB2 instance and the LDAP server should be encrypted. It is recommended that the ENABLE_SSL parameter in the IBMLDAPSecurity.ini file be set to TRUE.\n\nEnabling SSL will help ensure the confidentiality of authentication credentials and other information that is sent to and from the DB2 instance and the LDAP server.",
        "solution": "Update the parameter value:\n1. Connect to the DB2 host.\n2. Edit the IBMLDAPSecurity.ini file\n3. Add or modify the file to include the following parameter:\nENABLE_SSL = TRUE\nNotes:\nThe file is located under INSTANCE_HOME/sqllib/cfg/, for Unix; and %DB2PATH%\\cfg\\, for MS Windows.",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|1S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "@DB2_PATH@\\cfg\\IBMLDAPSecurity.ini",
        "regex": "^ *[Ee][Nn][Aa][Bb][Ll][Ee]_[Ss][Ss][Ll] *=",
        "expect": "^ *[Ee][Nn][Aa][Bb][Ll][Ee]_[Ss][Ss][Ll] *= *[Tt][Rr][Uu][Ee]"
    },
    "custom_item_30": {
        "description": "8.7 Secure the permissions of the IBMLDAPSecurity.ini file",
        "info": "The IBMLDAPSecurity.ini file contains the IBM LDAP security plug-in configurations.\n\nRecommended value is read-only (RO) to Everyone/Other/Users/Domain Users. This will ensure that the parameter file is protected.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click over the file directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all non-administrator accounts and revoke the Full Control authority\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the file directory\n3. Change the permission level of the directory\nOS => chmod ?R 740\nDefault Value:\nThe default value for this directory is read and write access for non-administrator accounts.\nNotes:\nThe file is located under INSTANCE_HOME/sqllib/cfg/, for Unix; and %DB2PATH%\\cfg\\, for MS Windows.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\cfg\\IBMLDAPSecurity.ini"
    },
    "custom_item_31": {
        "description": "8.8 Secure the permissions of the SSLconfig.ini file",
        "info": "The SSLconfig.ini file contains the SSL configuration parameters for the DB2 instance, including the password for KeyStore.\n\nRecommended value is read-only (RO) to Everyone/Other/Users/Domain Users. This will ensure that the parameter file is protected.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click over the file directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all non-administrator accounts and revoke the Full Control authority\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the file directory\n3. Change the permission level of the directory\nOS => chmod ?R 740\nDefault Value:\nThe default value for this directory is read-and-write access to non-administrator accounts.\nNotes:\nThe file is located under INSTANCE_HOME/cfg/, for Unix; and %INSTHOME\\, for MS Windows. Only the instance owner should have access to this file.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\cfg\\SSLconfig.ini"
    },
    "custom_item_32": {
        "description": "10.1 Restrict access to the DB2 Control Center",
        "info": "The DB2 Control Center is a management tool that manages all registered DB2 instances and databases. It is recommended that access to the Control Center utility be granted to authorized users only.\n\nSecure this application where applicable, since it has access to the DB2 instance name, the host it resides on, and the database name.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To revoke access to the DB2 Control Center:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Control Center\n3. Revoke access from any unnecessary users.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\BIN\\db2cc.bat"
    },
    "custom_item_33": {
        "description": "10.2 Restrict access to the DB2 Configuration Assistant utility",
        "info": "The DB2 Configuration Assistant is a management tool that manages all connectivity setup to the DB2 instances and databases. It is recommended that access to the Configuration Assistant utility be granted to authorized users only.\n\nSecure this application where applicable, since it has access to the DB2 instance name, the host it resides on, and the database name, and the port number.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To revoke access to the DB2 Configuration Assistant from unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Configuration Assistant.\n3. Revoke access from unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\BIN\\db2ca.bat"
    },
    "custom_item_34": {
        "description": "10.3 Restrict access to the DB2 Health Monitor utility",
        "info": "The DB2 Health Monitor is a management tool that manages information about the database manager, database, tablespace and table space containers. It is recommended that access to the DB2 Health Monitor utility be granted to authorized users only.\n\nSecure this application where applicable, since it has sensitive information about the health of the database.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To revoke access to the DB2 Health Monitor from any unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Health Center\n3. Revoke access from any unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\BIN\\db2hc.bat"
    },
    "custom_item_35": {
        "description": "10.4 Restrict access to the DB2 Activity Monitor utility",
        "info": "The DB2 Activity Monitor is a management tool that monitors all application performance and concurrency, resource consumption, and SQL statement usage of a database. It is recommended that access to the DB2 Activity Monitor utility be granted to authorized users only.\n\nSecure this application where applicable, since it has vital statistics about the database.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To revoke access to the DB2 Activity Monitor from any unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Activity Monitor\n3. Revoke access from all unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "value_data": "DefaultAdminAccess",
        "file": "@DB2_PATH@\\BIN\\db2hc.bat"
    }
}