{
    "custom_item_1": {
        "description": "Linux found",
        "cmd": "uname -a",
        "expect": "Linux"
    },
    "custom_item_2": {
        "description": "1.1 Install the latest fix packs",
        "info": "Periodically, IBM releases fix packs to enhance features and resolve defects, including security defects. It is recommended that the DB2 instance remain current with all fix packs.\n\nInstalling the latest DB2 fix pack will help protect the database from known vulnerabilities as well as reduce downtime that may otherwise result from functional defects.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Apply the latest fix pack as offered from IBM.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2level",
        "expect": "ManualReviewRequired"
    },
    "custom_item_3": {
        "description": "1.2 Use IP address rather than hostname",
        "info": "Use an IP address rather than a hostname to connect to the host of the DB2 instance.\n\nUsing a hostname to connect to a DB2 instance can display useful information about the host to an attacker. For example, hostnames for DB2 instances often contain the DB2 version number, host type, or operating system type.",
        "solution": "To reconfigure the connection string, launch the DB2 Configuration Assistant and change the connection's Hostname value from a text name to an IP address.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 list node directory show detail | grep '^\\\\s*Hostname'",
        "expect": "= [0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\s*$"
    },
    "custom_item_4": {
        "description": "1.4 Use non-default account names",
        "info": "The DB2 service is installed with default accounts with well-known names such as db2admin, db2inst1, dasusr1, or db2fenc1. It is recommended that the use of these account names be avoided. The default accounts may be renamed and then used.\n\nThe use of default accounts may increase the DB2 service's susceptibility to unauthorized access by an attacker.",
        "solution": "For Windows:\n1. Right-click over the %DB2PATH% and select Properties from the menu.\n2. Go to the Security tab and re-assign all the user accounts with well-known default names to use non-default names.\nFor Linux, perform the following command:\nchown -R:$DB2PATH\nNotes:\nReview the impact of changing the usernames before performing this global change.",
        "reference": "800-171|3.1.1,800-53|AC-2f.,800-53r5|AC-2f.,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2f.,LEVEL|1S,NESA|M4.4.3,NESA|T5.2.1,NIAv2|SS14d,PCI-DSSv3.2.1|8.1.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "/etc/passwd",
        "regex": "(db2admin|db2inst1|dasusr1|db2fenc1)",
        "expect": "^(db2admin|db2inst1|dasusr1|db2fenc1):"
    },
    "custom_item_5": {
        "description": "2.1 Secure the DB2 Runtime Library",
        "info": "A DB2 software installation will place all executables under the default\\sqllib directory. This directory needs to be secured so it grants only the necessary access to authorized users and administrators.\n\nThe DB2 runtime is comprised of files that are executed as part of the DB2 service. If these resources are not secured, an attacker may alter them to execute arbitrary code.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click on the %DB2PATH%\\sqllib directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all DB administrator accounts and grant them the Full Control authority\n6. Select all non-administrator accounts and revoke all privileges other than Read and Execute\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the $DB2PATH/sqllib directory\n3. Change the permission level of the directory to this recommended value:\nOS => chmod -R 750\nDefault Value:\nLinux: $DB2PATH/sqllib is owned by the DB2 administrator with read, write, and execute access.\nMS Windows: %DB2PATH%\\sqllib owned by the DB2 administrator with read, write, and execute access.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib",
        "mask": "027"
    },
    "custom_item_6": {
        "description": "2.2 Secure the database container directory",
        "info": "A DB2 database container is the physical storage of the data.\n\nThe containers are needed in order for the database to operate properly. The loss of the containers can cause down time. Also, allowing excessive access to the containers may help an attacker to gain access to their contents. Therefore, secure the location(s) of the containers by restricting the access and ownership. Allow only the instance owner to have access to the tablespace containers.",
        "solution": "Set the privileges for the directory of the containers. The recommended values are that only DB2 administrators have full access, and all other users have read-only access.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_CONTAINER_PATH@",
        "owner": "@DB2_OWNER@",
        "mask": "022",
        "group": "@DB2_GROUP@"
    },
    "custom_item_7": {
        "description": "2.3 Set umask value for DB2 admin user .profile file",
        "info": "The DB2 Admin .profile file in Linux sets the environment variables and the settings for the user.\n\nThe umask value should be set to 022 for the owner of the DB2 software at all times, including before installing DB2.",
        "solution": "Add umask 022 to the .profile profile.",
        "reference": "800-171|3.1.1,800-53|AC-3(4)(d),800-53r5|AC-3(4)(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(4),LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/.profile",
        "regex": "^ *umask *[0-9]+ *$",
        "expect": "^ *umask *022 *$"
    },
    "custom_item_8": {
        "description": "3.1.2 Encrypt user data across the network",
        "info": "DB2 supports a number of authentication mechanisms. It is recommended that the DATA_ENCRYPT authentication mechanism be used.\n\nThe DATA_ENCRYPT authentication mechanism employs cryptographic algorithms to protect the confidentiality of authentication credentials and user data as they traverse the network between the DB2 client and server.",
        "solution": "The suggested value is DATA_ENCRYPT so that authentication occurs at the server. To set this:\n1. Attach to the DB2 instance:\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using authentication data_encrypt\nDefault Value:\nThe default value for AUTHENTICATION is SERVER.",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|1S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database manager configuration' | grep 'AUTHENTICATION'",
        "expect": "AUTHENTICATION.*=[\\\\s]*DATA_ENCRYPT[\\\\s]*$"
    },
    "custom_item_9": {
        "description": "3.1.6 Secure permissions for default database file path",
        "info": "The dftdbpath parameter contains the default file path used to create DB2 databases. It is recommended that the permissions for this directory be set to full access for DB2 administrators and read and execute access only for all other accounts. It is also recommended that this directory be owned by the DB2 Administrator.\n\nRestricting access to the directory used as the default file path through permissions will help ensure that the confidentiality, integrity, and availability of the files there are protected.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the default file path, if necessary:\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click over the directory used as the default file path\n3. Choose Properties\n4. Select the Security tab\n5. Assign ownership of the directory to the DB2 Administrator\n6. Grant all DB administrator accounts the Full Control authority\n7. Grant only read and execute privileges to all other users (revoke all other privileges)\n\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the directory used as the default file path\n3. Assign the DB2 Administrator to be the owner of the directory using the chown command\n4. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for this directory is read and write access for non-administrator accounts.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@INSTANCE_HOME@/sqllib/bin/db2 'get database manager configuration' | grep 'DFTDBPATH' | awk '{ print $NF }' | xargs ls -ld | awk '{ print $1,$3,$NF }'",
        "expect": "^drwx.[^w]..[^w]. @DB2_OWNER@ @INSTANCE_HOME@$"
    },
    "custom_item_10": {
        "description": "Determine if DIAGPATH is not configured",
        "cmd": "@DB2_BIN_PATH@/db2 get database manager configuration | /bin/egrep 'DIAGPATH' | awk '{ print $NF }'",
        "expect": "="
    },
    "custom_item_11": {
        "description": "3.1.8 Secure all diagnostic logs",
        "info": "The diagpath parameter specifies the location of the diagnostic files for the DB2 instance. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All DB2 administrators should have full access to the directory.\n\nSecuring the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For Windows and Linux, to change the directory for the diagnostic logs:\n1. Attach to the DB2 instance.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using diagpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click over the diagnostic log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant the Full Control authority to all DB2 administrator accounts\n6. Grant only read and execute privileges to all other accounts (revoke any other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the diagnostic log directory\n3. Change the permissions of the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for diagpath is NULL.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 get database manager configuration | /bin/egrep '\\\\(DIAGPATH\\\\)\\\\s*='",
        "expect": "\\\\(DIAGPATH\\\\)\\\\s*=\\\\s*$"
    },
    "custom_item_12": {
        "description": "3.1.8 Secure all diagnostic logs",
        "info": "The diagpath parameter specifies the location of the diagnostic files for the DB2 instance. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All DB2 administrators should have full access to the directory.\n\nSecuring the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved.",
        "solution": "For Windows and Linux, to change the directory for the diagnostic logs:\n1. Attach to the DB2 instance.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using diagpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click over the diagnostic log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant the Full Control authority to all DB2 administrator accounts\n6. Grant only read and execute privileges to all other accounts (revoke any other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the diagnostic log directory\n3. Change the permissions of the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for diagpath is NULL.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 get database manager configuration | /bin/egrep '\\\\(DIAGPATH\\\\)\\\\s*=' | awk '{ print $NF }' | xargs ls -ald",
        "expect": "^dr[-w]x[-r]-[-x][-r]-[-x]"
    },
    "custom_item_13": {
        "description": "Check if LOGARCHMETH1 is configured with DISK",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(LOGARCHMETH1\\\\)\\\\s*=' | awk '{ print $NF }'",
        "expect": "^[Dd][Ii][Ss][Kk]:"
    },
    "custom_item_14": {
        "description": "3.2.4 Secure permissions for the primary archive log location",
        "info": "The logarchmeth1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute for all other accounts.\n\nRestricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the logarchmeth1 parameter. This will properly ensure that the primary logs are archived. A value of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the primary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth1Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth1 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the primary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH1 is OFF.\nThe default permissions for the directory are read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(LOGARCHMETH1\\\\)\\\\s*=' | awk '{ gsub(/^[Dd][Ii][Ss][Kk]:/, \"\", $NF); print $NF }' | xargs ls -ld",
        "expect": "^drwxr-xr-x[\\\\s]+[0-9]+[\\\\s]+@DB2_OWNER@[\\\\s]+(@DB2_GROUP@|root)[\\\\s]*"
    },
    "custom_item_15": {
        "description": "Check if LOGARCHMETH2 is configured with DISK",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(LOGARCHMETH2\\\\)\\\\s*=' | awk '{ print $NF }'",
        "expect": "^[Dd][Ii][Ss][Kk]:"
    },
    "custom_item_16": {
        "description": "3.2.5 Secure permissions for the secondary archive log location",
        "info": "The logarchmeth2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived log be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the logarchmeth2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the secondary archive log directory, if necessary:\ndb2 => update database configuration using logarchmeth2\n\nAdditional steps for Windows (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the secondary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the logarchmeth2 parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the secondary archive log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for LOGARCHMETH2 is OFF.\nThe default value for the directory is read and write access.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(LOGARCHMETH2\\\\)\\\\s*=' | awk '{ gsub(/^[Dd][Ii][Ss][Kk]:/, \"\", $NF); print $NF }' | xargs ls -ld",
        "expect": "^drwxr-xr-x[\\\\s]+[0-9]+[\\\\s]+@DB2_OWNER@[\\\\s]+(@DB2_GROUP@|root)[\\\\s]*"
    },
    "custom_item_17": {
        "description": "Check if FAILARCHPATH is configured",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(FAILARCHPATH\\\\)\\\\s*=' | awk '{ print $NF }'",
        "expect": "^[^=]"
    },
    "custom_item_18": {
        "description": "3.2.6 Secure permissions for the tertiary archive log location",
        "info": "The failarchpath parameter specifies the type of media and the location used as the tertiary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\nRationale:\nRestricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected.\nAlthough there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the failarchpath parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
        "solution": "For Windows and Linux:\n1. Attach to the DB2 instance.\n2. Run the following command from the DB2 command window to change the tertiary archive log directory, if necessary:\ndb2 => update database configuration using failarchpath\n\nAdditional steps for Windows (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Right-click on the tertiary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux (assuming that the failarchpath parameter includes DISK):\n1. Connect to the DB2 host\n2. Change to the tertiary archive log directory\n3. Change the permissions for the directory\nOS => chmod ?R 755\nDefault Value:\nThe default value for FAILARCHPATH is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(FAILARCHPATH\\\\)\\\\s*=' | awk '{ print $NF }' | xargs ls -ld",
        "expect": "^drwxr-xr-x[\\\\s]+[0-9]+[\\\\s]+@DB2_OWNER@[\\\\s]+(@DB2_GROUP@|root)[\\\\s]*"
    },
    "custom_item_19": {
        "description": "Check if MIRRORLOGPATH is configured",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(MIRRORLOGPATH\\\\)\\\\s*=' | awk '{ print $NF }'",
        "expect": "^[^=]"
    },
    "custom_item_20": {
        "description": "3.2.7 Secure permissions for the log mirror location",
        "info": "The mirrorlogpath parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.\n\nA mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected.",
        "solution": "For Windows and Linux:\n1. Connect to the DB2 database.\ndb2 => connect to $DB2INSTANCE user $USERNAME using $PASSWORD\n2. Run the following command from the DB2 command window to change the mirror log directory, if necessary:\ndb2 => update database configuration using mirrorlogpath\n\nAdditional steps for Windows:\n1. Connect to the DB2 host\n2. Right-click on the primary archive log directory\n3. Choose Properties\n4. Select the Security tab\n5. Grant all DB2 administrator accounts the Full Control authority\n6. Grant all other accounts read and execute privileges only (revoke all other privileges)\n\nAdditional steps for Linux:\n1. Connect to the DB2 host\n2. Change to the mirror log directory\n3. Change the permissions for the directory\nOS => chmod -R 755\nDefault Value:\nThe default value for mirrorlogpath is null.",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1S,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database configuration for @DATABASE_NAME@' | egrep '\\\\(MIRRORLOGPATH\\\\)\\\\s*=' | awk '{ print $NF }' | xargs ls -ld",
        "expect": "^drwxr-xr-x[\\\\s]+[0-9]+[\\\\s]+@DB2_OWNER@[\\\\s]+(@DB2_GROUP@|root)[\\\\s]*"
    },
    "custom_item_21": {
        "description": "3.3.1 Establish DAS administrative group",
        "info": "The dasadm_group parameter defines the group name with DAS Administration (DASADM) authority for the DAS. It is recommended that the dasadm_group group contains authorized users only.\n\nThe DAS is a special administrative tool that enables remote administration of DB2 servers. DASADM authority is the highest level of authority within the DAS.",
        "solution": "1. Attach to the DB2 instance.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database configuration using dasadm_groupDefault Value:\nThe default value for dasadm_group is null.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get admin configuration' | egrep -i '\\\\(dasadm_group\\\\)' | awk '{ print $NF }' | xargs -IVAL awk -F: -v group=VAL 'tolower($1) == tolower(group) { print; f=1 } END { if (f != 1) { print \"No group found: \"group } }' /etc/group",
        "expect": "^[^: ]+:"
    },
    "custom_item_22": {
        "description": "7.3 Establish a system maintenance group",
        "info": "The sysmaint_group parameter defines the system administrator group that possesses the system maintenance (SYSMAINT) authority. It is recommended that the sysmaint_group group contains authorized users only.\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
        "solution": "Define a valid group name for the SYSMAINT group. Note: This parameter does not apply to Windows platforms.\n1. Attach to the DB2 database.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using sysmaint_groupDefault Value:\nThe default value for SYSMAINT_GROUP is NULL.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database manager configuration' | egrep -i '\\\\(sysmaint_group\\\\)' | awk '{ print $NF }' | xargs -IVAL awk -F: -v group=VAL 'tolower($1) == tolower(group) { print; f=1 } END { if (f != 1) { print \"No group found: \"group } }' /etc/group",
        "expect": "^[^: ]+:"
    },
    "custom_item_23": {
        "description": "7.4 Establish a system monitoring group",
        "info": "The sysmon_group parameter defines the operating system groups with system monitor (SYSMON) authority. It is recommended that the sysmon_group group contains authorized users only.\n\nIf an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increase risk.",
        "solution": "Define a valid group name for the SYSMON group.\n1. Attach to the DB2 database.\ndb2 => attach to $DB2INSTANCE\n2. Run the following command from the DB2 command window:\ndb2 => update database manager configuration using sysmon_groupDefault Value:\nThe default value for SYSMON_GROUP is NULL.",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'get database manager configuration' | egrep -i '\\\\(sysmon_group\\\\)' | awk '{ print $NF }' | xargs -IVAL awk -F: -v group=VAL 'tolower($1) == tolower(group) { print; f=1 } END { if (f != 1) { print \"No group found: \"group } }' /etc/group",
        "expect": "^[^: ]+:"
    },
    "custom_item_24": {
        "description": "8.1 Restrict access to starting and stopping DB2 instances",
        "info": "The DB2 instance manages the database environment and sets the configuration parameters. It is recommended that only administrators are allowed to start and stop the DB2 instance.\n\nOnly allowing privileged users to start and stop the DB2 instance will help ensure that the DB2 instance is controlled by authorized administrators.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "1. Connect to the host\n2. Review users and groups that have access to start and stop the DB2 instance\n3. Revoke access from any unnecessary users.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "awk -F: 'BEGIN { gid = \"@DB2_GROUP@\" } FILENAME == \"/etc/group\" && $1 == \"@DB2_GROUP@\" { gid=$3; gsub(/,/, \"\\\\n\", $4); print $4 } FILENAME == \"/etc/passwd\" && $4 == gid { print $1 } END { if (gid == \"@DB2_GROUP@\") { print \"No group @DB2_GROUP@ exists\" } }' /etc/group /etc/passwd | sort",
        "expect": "ManualReviewRequired"
    },
    "custom_item_25": {
        "description": "8.5 Remove default databases",
        "info": "A DB2 Instance may come installed with default databases. It is recommended that the SAMPLE database be removed.\n\nRemoving unused, well-known databases will reduce the attack surface of the system.",
        "solution": "To drop sample databases:\n1. Connect to the DB2 database.\n2. Run the following command from the DB2 command window:\ndb2 => drop database sample",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "cmd": "@DB2_BIN_PATH@/db2 'list database directory' | /bin/egrep 'Database name.*SAMPLE' | /bin/awk -F'= ' '{ print $2 } END { if (NR == 0) { print \"No default databases found\" } }'",
        "expect": "No default databases found"
    },
    "custom_item_26": {
        "description": "8.6 Enable SSL communication with LDAP server",
        "info": "The communication layer between a DB2 instance and the LDAP server should be encrypted. It is recommended that the ENABLE_SSL parameter in the IBMLDAPSecurity.ini file be set to TRUE.\n\nEnabling SSL will help ensure the confidentiality of authentication credentials and other information that is sent to and from the DB2 instance and the LDAP server.",
        "solution": "Update the parameter value:\n1. Connect to the DB2 host.\n2. Edit the IBMLDAPSecurity.ini file\n3. Add or modify the file to include the following parameter:\nENABLE_SSL = TRUE\nNotes:\nThe file is located under INSTANCE_HOME/sqllib/cfg/, for Unix; and %DB2PATH%\\cfg\\, for MS Windows.",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|1S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/cfg/IBMLDAPSecurity.ini",
        "regex": "^ *[Ee][Nn][Aa][Bb][Ll][Ee]_[Ss][Ss][Ll] *=",
        "expect": "^ *[Ee][Nn][Aa][Bb][Ll][Ee]_[Ss][Ss][Ll] *= *[Tt][Rr][Uu][Ee]"
    },
    "custom_item_27": {
        "description": "8.7 Secure the permissions of the IBMLDAPSecurity.ini file",
        "info": "The IBMLDAPSecurity.ini file contains the IBM LDAP security plug-in configurations.\n\nRecommended value is read-only (RO) to Everyone/Other/Users/Domain Users. This will ensure that the parameter file is protected.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click over the file directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all non-administrator accounts and revoke the Full Control authority\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the file directory\n3. Change the permission level of the directory\nOS => chmod ?R 740\nDefault Value:\nThe default value for this directory is read and write access for non-administrator accounts.\nNotes:\nThe file is located under INSTANCE_HOME/sqllib/cfg/, for Unix; and %DB2PATH%\\cfg\\, for MS Windows.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/cfg/IBMLDAPSecurity.ini",
        "mask": "037"
    },
    "custom_item_28": {
        "description": "8.8 Secure the permissions of the SSLconfig.ini file",
        "info": "The SSLconfig.ini file contains the SSL configuration parameters for the DB2 instance, including the password for KeyStore.\n\nRecommended value is read-only (RO) to Everyone/Other/Users/Domain Users. This will ensure that the parameter file is protected.",
        "solution": "For Windows:\n1. Connect to the DB2 host\n2. Right-click over the file directory\n3. Choose Properties\n4. Select the Security tab\n5. Select all non-administrator accounts and revoke the Full Control authority\nFor Linux:\n1. Connect to the DB2 host\n2. Change to the file directory\n3. Change the permission level of the directory\nOS => chmod ?R 740\nDefault Value:\nThe default value for this directory is read-and-write access to non-administrator accounts.\nNotes:\nThe file is located under INSTANCE_HOME/cfg/, for Unix; and %INSTHOME\\, for MS Windows. Only the instance owner should have access to this file.",
        "reference": "CSCv6|3.1,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/cfg/SSLconfig.ini",
        "mask": "037"
    },
    "custom_item_29": {
        "description": "10.1 Restrict access to the DB2 Control Center",
        "info": "The DB2 Control Center is a management tool that manages all registered DB2 instances and databases. It is recommended that access to the Control Center utility be granted to authorized users only.\n\nSecure this application where applicable, since it has access to the DB2 instance name, the host it resides on, and the database name.",
        "solution": "To revoke access to the DB2 Control Center:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Control Center\n3. Revoke access from any unnecessary users.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/bin/db2cc",
        "owner": "@DB2_OWNER@",
        "mask": "022",
        "group": "@DB2_GROUP@"
    },
    "custom_item_30": {
        "description": "10.2 Restrict access to the DB2 Configuration Assistant utility",
        "info": "The DB2 Configuration Assistant is a management tool that manages all connectivity setup to the DB2 instances and databases. It is recommended that access to the Configuration Assistant utility be granted to authorized users only.\n\nSecure this application where applicable, since it has access to the DB2 instance name, the host it resides on, and the database name, and the port number.",
        "solution": "To revoke access to the DB2 Configuration Assistant from unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Configuration Assistant.\n3. Revoke access from unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/bin/db2ca",
        "owner": "@DB2_OWNER@",
        "mask": "022",
        "group": "@DB2_GROUP@"
    },
    "custom_item_31": {
        "description": "10.3 Restrict access to the DB2 Health Monitor utility",
        "info": "The DB2 Health Monitor is a management tool that manages information about the database manager, database, tablespace and table space containers. It is recommended that access to the DB2 Health Monitor utility be granted to authorized users only.\n\nSecure this application where applicable, since it has sensitive information about the health of the database.",
        "solution": "To revoke access to the DB2 Health Monitor from any unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Health Center\n3. Revoke access from any unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/bin/db2hc",
        "owner": "@DB2_OWNER@",
        "mask": "022",
        "group": "@DB2_GROUP@"
    },
    "custom_item_32": {
        "description": "10.4 Restrict access to the DB2 Activity Monitor utility",
        "info": "The DB2 Activity Monitor is a management tool that monitors all application performance and concurrency, resource consumption, and SQL statement usage of a database. It is recommended that access to the DB2 Activity Monitor utility be granted to authorized users only.\n\nSecure this application where applicable, since it has vital statistics about the database.",
        "solution": "To revoke access to the DB2 Activity Monitor from any unnecessary users and groups:\n1. Connect to the host\n2. Review users and groups that have access to start the DB2 Activity Monitor\n3. Revoke access from all unnecessary users and groups.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/1654",
        "file": "@INSTANCE_HOME@/sqllib/bin/db2am",
        "owner": "@DB2_OWNER@",
        "mask": "022",
        "group": "@DB2_GROUP@"
    }
}