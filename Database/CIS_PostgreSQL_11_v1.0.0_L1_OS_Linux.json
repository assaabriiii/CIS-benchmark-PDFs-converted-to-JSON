{
    "custom_item_1": {
        "description": "Linux found",
        "cmd": "uname -a",
        "expect": "Linux"
    },
    "custom_item_2": {
        "description": "1.1 Ensure packages are obtained from authorized repositories",
        "info": "When obtaining and installing software packages (typically via yum), it's imperative that packages are sourced only from valid and authorized repositories. For PostgreSQL, a short list of valid repositories would include CentOS (www.centos.org) and the official PostgreSQL website (yum.postgresql.org).\n        Rationale:\n        Being open source, PostgreSQL packages are widely available across the internet through RPM aggregators and providers. However, using invalid or unauthorized sources for packages can lead to implementing untested, defective, or malicious software.\n        Many organizations choose to implement a local yum repository within their organization. Care must be taken to ensure that only valid and authorized packages are downloaded and installed into such local repositories.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Alter the configured repositories so they only include valid and authorized sources of packages.\n        As an example of adding an authorized repository, we will install the PGDG repository RPM from 'yum.postgresql.org':\n        [root@centos7 ~]# whoami\n        root\n        [root@centos7 ~]# yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n        Loaded plugins: fastestmirror\n        pgdg-redhat-repo-latest.noarch.rpm                                                           | 5.6 kB  00:00:00\n        Examining /var/tmp/yum-root-CubWbD/pgdg-redhat-repo-latest.noarch.rpm: pgdg-redhat-repo-42.0-4.noarch\n        Marking /var/tmp/yum-root-CubWbD/pgdg-redhat-repo-latest.noarch.rpm to be installed\n        Resolving Dependencies\n        --> Running transaction check\n        ---> Package pgdg-redhat-repo.noarch 0:42.0-4 will be installed\n        --> Finished Dependency Resolution\n\n        Dependencies Resolved\n\n        ====================================================================================================================\n        Package                     Arch              Version             Repository                                  Size\n        ====================================================================================================================\n        Installing:\n        pgdg-redhat-repo            noarch            42.0-4              /pgdg-redhat-repo-latest.noarch            6.8 k\n\n        Transaction Summary\n        ====================================================================================================================\n        Install  1 Package\n\n        Total size: 6.8 k\n        Installed size: 6.8 k\n        Is this ok [y/d/N]: y\n        Downloading packages:\n        Running transaction check\n        Running transaction test\n        Transaction test succeeded\n        Running transaction\n        Installing : pgdg-redhat-repo-42.0-4.noarch                                                                   1/1\n        Verifying  : pgdg-redhat-repo-42.0-4.noarch                                                                   1/1\n\n        Installed:\n        pgdg-redhat-repo.noarch 0:42.0-4\n\n        Complete!\n        Verify the repository has been added and is enabled:\n        [root@centos7 ~]# whoami\n        root\n        [root@centos7 ~]# yum repolist all | grep enabled:\n        base/7/x86_64                          CentOS-7 - Base           enabled: 10,019\n        extras/7/x86_64                        CentOS-7 - Extras         enabled:    409\n        pgdg10/7/x86_64                        PostgreSQL 10 7 - x86_64  enabled:    663\n        pgdg11/7/x86_64                        PostgreSQL 11 7 - x86_64  enabled:    487\n        pgdg94/7/x86_64                        PostgreSQL 9.4 7 - x86_64 enabled:    746\n        pgdg95/7/x86_64                        PostgreSQL 9.5 7 - x86_64 enabled:    732\n        pgdg96/7/x86_64                        PostgreSQL 9.6 7 - x86_64 enabled:    745\n        updates/7/x86_64                       CentOS-7 - Updates        enabled:  1,945",
        "reference": "800-171|3.4.1,800-171|3.4.9,800-53|CM-8,800-53|CM-11,800-53r5|CM-8,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv6|2,CSCv7|2.1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-8,LEVEL|1NS,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "yum repolist all | grep enabled",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_3": {
        "description": "1.2 Ensure Installation of Binary Packages",
        "info": "The PostgreSQL packages are installed on the Operating System from valid source.\n        Rationale:\n        Standard Linux distributions, although possessing the requisite packages, often do not have PostgreSQL pre-installed. The installation process includes installing the binaries and the means to generate a data cluster too. Package installation should include both the server and client packages. Contribution modules are optional depending upon one's architectural requirements (they are recommended though).\n        From a security perspective, it's imperative to verify the PostgreSQL binary packages are sourced from a valid Linux yum repository. The most common Linux repositories include CentOS base and PGDG base; however, it's up to the organization to validate. For a complete listing of all PostgreSQL binaries available via configured repositories inspect the output from yum provides libpq.so.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the version of PostgreSQL installed is not 11.x, the packages may be uninstalled using this command:\n        $ whoami\n        root\n        $ yum remove $(rpm -qa|grep postgres)\n        The next recommendation \"1.3 Ensure Installation of Community Packages\" describes how to explicitly choose which version of PostgreSQL to install, regardless of Linux distribution association.\n        Impact:\n        If the PostgreSQL version shipped as part of the default binary installation associated with your Linux distribution satisfies your requirements, this may be adequate for development and testing purposes. However, for production instances it's generally recommended to install the latest stable release of PostgreSQL.\n        CIS Controls:\n        <<>>Version 6\n            2 Inventory of Authorized and Unauthorized Software\n            Inventory of Authorized and Unauthorized Software\n            Version 7\n            2.1 Maintain Inventory of Authorized Software\n            Maintain an up-to-date list of all authorized software that is required in the enterprise for any business purpose on any business system.",
        "reference": "800-171|3.4.1,800-171|3.4.9,800-53|CM-8,800-53|CM-11,800-53r5|CM-8,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv6|2,CSCv7|2.1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-8,LEVEL|1NS,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "rpm -qa|grep postgres",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_4": {
        "description": "1.3 Ensure Installation of Community Packages",
        "info": "Adding, and installing, the PostgreSQL community packages to the host's package repository.\n        Rationale:\n        It's an unfortunate reality that Linux distributions do not always have the most up-to-date versions of PostgreSQL. Disadvantages of older releases include: missing bug patches, no access to highly desirable contribution modules, no access to 3rd party projects that are complimentary to PostgreSQL, and no upgrade path migrating from one version of PostgreSQL to the next. The worst set of circumstances is to be limited to a version of the RDBMS that has reached its end-of-life.\n        From a security perspective, it's imperative that Postgres Community Packages are only obtained from the official website https://yum.postgresql.org/. Being open source, the Postgres packages are widely available over the internet via myriad package aggregators and providers. Obtaining software from these unofficial sites risks installing defective, corrupt, or downright malicious versions of PostgreSQL.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following example adds the PGDG repository RPM for PostgreSQL, configures yum to prefer the PGDG packages for version 11, and installs the client-server-contributions rpms to the host where you want to install the RDBMS.\n        Using a web browser, go to http://yum.postgresql.org and navigate to the repo download link for your OS and version. Copy the URL to the repo file, and then tell yum to install it:\n        [root@centos7 ~]# whoami\n        root\n        [root@centos7 ~]# yum install https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n        Loaded plugins: fastestmirror\n        pgdg-redhat-repo-latest.noarch.rpm                                                           | 5.6 kB  00:00:00\n        Examining /var/tmp/yum-root-CubWbD/pgdg-redhat-repo-latest.noarch.rpm: pgdg-redhat-repo-42.0-4.noarch\n        Marking /var/tmp/yum-root-CubWbD/pgdg-redhat-repo-latest.noarch.rpm to be installed\n        Resolving Dependencies\n        --> Running transaction check\n        ---> Package pgdg-redhat-repo.noarch 0:42.0-4 will be installed\n        --> Finished Dependency Resolution\n\n        Dependencies Resolved\n\n        ====================================================================================================================\n        Package                     Arch              Version             Repository                                  Size\n        ====================================================================================================================\n        Installing:\n        pgdg-redhat-repo            noarch            42.0-4              /pgdg-redhat-repo-latest.noarch            6.8 k\n\n        Transaction Summary\n        ====================================================================================================================\n        Install  1 Package\n\n        Total size: 6.8 k\n        Installed size: 6.8 k\n        Is this ok [y/d/N]: y\n        Downloading packages:\n        Running transaction check\n        Running transaction test\n        Transaction test succeeded\n        Running transaction\n        Installing : pgdg-redhat-repo-42.0-4.noarch                                                                   1/1\n        Verifying  : pgdg-redhat-repo-42.0-4.noarch                                                                   1/1\n\n        Installed:\n        pgdg-redhat-repo.noarch 0:42.0-4\n\n        Complete!\n        Now, configure yum to prefer the PGDG packages for version 11:\n        [root@centos7 ~]# yum -y install yum-priorities\n        Loaded plugins: fastestmirror\n        Loading mirror speeds from cached hostfile\n        * base: mirror.sfo12.us.leaseweb.net\n        * extras: mirror.umd.edu\n        * updates: ftp.usf.edu\n        Resolving Dependencies\n        --> Running transaction check\n        ---> Package yum-plugin-priorities.noarch 0:1.1.31-50.el7 will be installed\n        --> Finished Dependency Resolution\n\n        Dependencies Resolved\n\n        ====================================================================================================================\n        Package                              Arch                  Version                       Repository           Size\n        ====================================================================================================================\n        Installing:\n        yum-plugin-priorities                noarch                1.1.31-50.el7                 base                 29 k\n\n        Transaction Summary\n        ====================================================================================================================\n        Install  1 Package\n\n        Total download size: 29 k\n        Installed size: 28 k\n        Downloading packages:\n        yum-plugin-priorities-1.1.31-50.el7.noarch.rpm                                               |  29 kB  00:00:00\n        Running transaction check\n        Running transaction test\n        Transaction test succeeded\n        Running transaction\n        Installing : yum-plugin-priorities-1.1.31-50.el7.noarch                                                       1/1\n        Verifying  : yum-plugin-priorities-1.1.31-50.el7.noarch                                                       1/1\n\n        Installed:\n        yum-plugin-priorities.noarch 0:1.1.31-50.el7\n\n        Complete!\n        [root@centos7 ~]# whoami\n        root\n        [root@centos7 ~]# vi /etc/yum.repos.d/pgdg-redhat-all.repo[pgdg11]\n            name=PostgreSQL 11 $releasever - $basearch\n            baseurl=https://download.postgresql.org/pub/repos/yum/11/redhat/rhel-$releasever-$basearch\n            enabled=1\n            gpgcheck=1\n            gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG\n            priority=1  <-- add this lineFinally, install the PostgreSQL packages:\n                    [root@centos7 ~]# whoami\n                    root\n                    [root@centos7 ~]# yum -y groupinstall 'PostgreSQL Database Server 11 PGDG'\n                    Loaded plugins: fastestmirror, priorities\n                    There is no installed groups file.\n                    Maybe run: yum groups mark convert (see man yum)\n                    Loading mirror speeds from cached hostfile\n                    * base: mirror.sfo12.us.leaseweb.net\n                    * extras: mirror.umd.edu\n                    * updates: ftp.usf.edu\n                    pgdg10                                                                                       | 3.6 kB  00:00:00\n                    pgdg11                                                                                       | 3.6 kB  00:00:00\n                    pgdg94                                                                                       | 3.6 kB  00:00:00\n                    pgdg95                                                                                       | 3.6 kB  00:00:00\n                    pgdg96                                                                                       | 3.6 kB  00:00:00\n                    1401 packages excluded due to repository priority protections\n                    Resolving Dependencies\n                    --> Running transaction check\n                    ---> Package postgresql11.x86_64 0:11.3-1PGDG.rhel7 will be installed\n                    --> Processing Dependency: libicu for package: postgresql11-11.3-1PGDG.rhel7.x86_64\n                    ---> Package postgresql11-contrib.x86_64 0:11.3-1PGDG.rhel7 will be installed\n                    --> Processing Dependency: libxslt.so.1(LIBXML2_1.0.22)(64bit) for package: postgresql11-contrib-11.3-1PGDG.rhel7.x86_64\n                    --> Processing Dependency: libxslt.so.1(LIBXML2_1.0.18)(64bit) for package: postgresql11-contrib-11.3-1PGDG.rhel7.x86_64\n                    --> Processing Dependency: libxslt.so.1(LIBXML2_1.0.11)(64bit) for package: postgresql11-contrib-11.3-1PGDG.rhel7.x86_64\n                    --> Processing Dependency: libxslt.so.1()(64bit) for package: postgresql11-contrib-11.3-1PGDG.rhel7.x86_64\n                    ---> Package postgresql11-libs.x86_64 0:11.3-1PGDG.rhel7 will be installed\n                    ---> Package postgresql11-server.x86_64 0:11.3-1PGDG.rhel7 will be installed\n                    --> Running transaction check\n                    ---> Package libicu.x86_64 0:50.1.2-17.el7 will be installed\n                    ---> Package libxslt.x86_64 0:1.1.28-5.el7 will be installed\n                    --> Finished Dependency Resolution\n\n                    Dependencies Resolved\n\n                    ====================================================================================================================\n                    Package                            Arch                 Version                         Repository            Size\n                    ====================================================================================================================\n                    Installing for group install \"PostgreSQL Database Server 11 PGDG\":\n                    postgresql11                       x86_64               11.3-1PGDG.rhel7                pgdg11               1.7 M\n                    postgresql11-contrib               x86_64               11.3-1PGDG.rhel7                pgdg11               616 k\n                    postgresql11-libs                  x86_64               11.3-1PGDG.rhel7                pgdg11               360 k\n                    postgresql11-server                x86_64               11.3-1PGDG.rhel7                pgdg11               4.7 M\n                    Installing for dependencies:\n                    libicu                             x86_64               50.1.2-17.el7                   base                 6.9 M\n                    libxslt                            x86_64               1.1.28-5.el7                    base                 242 k\n\n                    Transaction Summary\n                    ====================================================================================================================\n                    Install  4 Packages (+2 Dependent packages)\n\n                    Total download size: 14 M\n                    Installed size: 55 M\n                    Downloading packages:\n                    (1/6): libxslt-1.1.28-5.el7.x86_64.rpm                                                       | 242 kB  00:00:00\n                    warning: /var/cache/yum/x86_64/7/pgdg11/packages/postgresql11-11.3-1PGDG.rhel7.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 442df0f8: NOKEY\n                    Public key for postgresql11-11.3-1PGDG.rhel7.x86_64.rpm is not installed\n                    (2/6): postgresql11-11.3-1PGDG.rhel7.x86_64.rpm                                              | 1.7 MB  00:00:00\n                    (3/6): postgresql11-libs-11.3-1PGDG.rhel7.x86_64.rpm                                         | 360 kB  00:00:00\n                    (4/6): libicu-50.1.2-17.el7.x86_64.rpm                                                       | 6.9 MB  00:00:01\n                    (5/6): postgresql11-server-11.3-1PGDG.rhel7.x86_64.rpm                                       | 4.7 MB  00:00:00\n                    (6/6): postgresql11-contrib-11.3-1PGDG.rhel7.x86_64.rpm                                      | 616 kB  00:00:02\n                    --------------------------------------------------------------------------------------------------------------------\n                    Total                                                                               4.7 MB/s |  14 MB  00:00:03\n                    Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG\n                    Importing GPG key 0x442DF0F8:\n                    Userid     : \"PostgreSQL RPM Building Project\"\n                        Fingerprint: 68c9 e2b9 1a37 d136 fe74 d176 1f16 d2e1 442d f0f8\n                        Package    : pgdg-redhat-repo-42.0-4.noarch (installed)\n                        From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG\n                        Running transaction check\n                        Running transaction test\n                        Transaction test succeeded\n                        Running transaction\n                        Installing : postgresql11-libs-11.3-1PGDG.rhel7.x86_64                                                        1/6\n                        Installing : libicu-50.1.2-17.el7.x86_64                                                                      2/6\n                        Installing : postgresql11-11.3-1PGDG.rhel7.x86_64                                                             3/6\n                        Installing : libxslt-1.1.28-5.el7.x86_64                                                                      4/6\n                        Installing : postgresql11-contrib-11.3-1PGDG.rhel7.x86_64                                                     5/6\n                        Installing : postgresql11-server-11.3-1PGDG.rhel7.x86_64                                                      6/6\n                        Verifying  : postgresql11-libs-11.3-1PGDG.rhel7.x86_64                                                        1/6\n                        Verifying  : postgresql11-server-11.3-1PGDG.rhel7.x86_64                                                      2/6\n                        Verifying  : libicu-50.1.2-17.el7.x86_64                                                                      3/6\n                        Verifying  : libxslt-1.1.28-5.el7.x86_64                                                                      4/6\n                        Verifying  : postgresql11-11.3-1PGDG.rhel7.x86_64                                                             5/6\n                        Verifying  : postgresql11-contrib-11.3-1PGDG.rhel7.x86_64                                                     6/6\n\n                        Installed:\n                        postgresql11.x86_64 0:11.3-1PGDG.rhel7                  postgresql11-contrib.x86_64 0:11.3-1PGDG.rhel7\n                        postgresql11-libs.x86_64 0:11.3-1PGDG.rhel7             postgresql11-server.x86_64 0:11.3-1PGDG.rhel7\n\n                        Dependency Installed:\n                        libicu.x86_64 0:50.1.2-17.el7                            libxslt.x86_64 0:1.1.28-5.el7\n\n                        Complete!\n                        Note: The above-mentioned example is referenced as an illustration only. Package names and versions may differ.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv6|18.1,CSCv7|18.3,CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1NS,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "yum list installed postgres*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_5": {
        "description": "1.4 Ensure systemd Service Files Are Enabled",
        "info": "Confirm, and correct if necessary, the PostgreSQL systemd service is enabled.\n        Rationale:\n        Enabling the systemd service on the OS ensures the database service is active when a change of state occurs as in the case of a system startup or reboot.",
        "solution": "Irrespective of package source, PostgreSQL services can be identified because it typically includes the text string \"postgresql\". PGDG installs do not automatically register the service as a \"want\" of the default systemd target. Multiple instances of PostgreSQL services often distinguish themselves using a version number.\n        [root@centos7 ~]# whoami\n        root\n        [root@centos7 ~]# systemctl enable postgresql-11\n        Created symlink from /etc/systemd/system/multi-user.target.wants/postgresql-11.service to /usr/lib/systemd/system/postgresql-11.service.\n        [root@centos7 ~]# systemctl list-dependencies multi-user.target | grep -i postgres\n         postgresql-11.service\n        [root@centos7 ~]#",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv6|18,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1S,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "systemctl list-dependencies multi-user.target | grep -i postgresql",
        "expect": "^.*postgresql-11.service[\\\\s]*"
    },
    "custom_item_6": {
        "description": "2.1 Ensure the file permissions mask is correct",
        "info": "Files are always created using a default set of permissions. File permissions can be restricted by applying a permissions mask called the umask. The postgres user account should use a umask of 077 to deny file access to all user accounts except the owner.\n        Rationale:\n        The Linux OS defaults the umask to 002, which means the owner and primary group can read and write the file, and other accounts are permitted to read the file. Not explicitly setting the umask to a value as restrictive as 077 allows other users to read, write, or even execute files and scripts created by the postgres user account. The alternative to using a umask is explicitly updating file permissions after file creation using the command line utility chmod (a manual and error prone process that is not advised).",
        "solution": "Depending upon the postgres user's environment, the umask is typically set in the initialization file .bash_profile, but may also be set in .profile or .bashrc. To set the umask, add the following to the appropriate profile file:\n        $ whoami\n        postgres\n        $ cd ~\n        $ ls -ld .{bash_profile,profile,bashrc}\n        ls: cannot access .profile: No such file or directory\n        ls: cannot access .bashrc: No such file or directory\n        -rwx------. 1 postgres postgres 267 Aug 14 12:59 .bash_profile\n        $ echo \"umask 077\" >> .bash_profile\n        $ source .bash_profile\n        $ umask\n        0077\n        Default Value:\n        0022",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "/bin/grep -i \\\\'umask\\\\' /var/lib/pgsql/.bash_profile /var/lib/pgsql/.profile /var/lib/pgsql/.bashrc",
        "expect": "[Uu][Mm][Aa][Ss][Kk] [0-7]+77"
    },
    "custom_item_7": {
        "description": "2.2 Ensure the PostgreSQL pg_wheel group membership is correct - /etc/group",
        "info": "The group pg_wheel is explicitly created on a host where the PostgreSQL server is installed. Membership in this group enables an ordinary user account to gain 'superuser' access to a database cluster by using the sudo command (See 'Ensure sudo is configured correctly' later in this benchmark). Only user accounts authorized to have superuser access should be members of the pg_wheel group.\n        Rationale:\n        Users with unauthorized membership in the pg_wheel group can assume the privileges of the owner of the PostgreSQL RDBMS and administer the database, as well as accessing scripts, files, and other executables they should not be able to access.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the pg_wheel group does not exist, use the following command to create it:\n        $ whoami\n        root\n        $ groupadd pg_wheel && getent group pg_wheel\n        pg_wheel:x:502:\n        Note: that your system's group number may not be 502. That's OK.\n        Adding the postgres user to the newly created group is done by issuing:\n        $ whoami\n        root\n        $ gpasswd -a postgres pg_wheel\n        Adding user postgres to group pg_wheel\n        $ # verify membership\n        $ awk -F':' '/pg_wheel/{print $4}' /etc/group\n        postgres\n        Removing a user account from the 'pg_wheel' group is achieved by executing the following command:\n        $ whoami\n        root\n        $ gpasswd -d pg_wheel postgres\n        Removing user postgres from group pg_wheel\n        $ # verify the user was removed\n        $ awk -F':' '/pg_wheel/{print $4}' /etc/group\n        $",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "grep -i 'pg_wheel' /etc/group",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_8": {
        "description": "2.2 Ensure the PostgreSQL pg_wheel group membership is correct - /etc/passwd",
        "info": "The group pg_wheel is explicitly created on a host where the PostgreSQL server is installed. Membership in this group enables an ordinary user account to gain 'superuser' access to a database cluster by using the sudo command (See 'Ensure sudo is configured correctly' later in this benchmark). Only user accounts authorized to have superuser access should be members of the pg_wheel group.\n        Rationale:\n        Users with unauthorized membership in the pg_wheel group can assume the privileges of the owner of the PostgreSQL RDBMS and administer the database, as well as accessing scripts, files, and other executables they should not be able to access.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the pg_wheel group does not exist, use the following command to create it:\n        $ whoami\n        root\n        $ groupadd pg_wheel && getent group pg_wheel\n        pg_wheel:x:502:\n        Note: that your system's group number may not be 502. That's OK.\n        Adding the postgres user to the newly created group is done by issuing:\n        $ whoami\n        root\n        $ gpasswd -a postgres pg_wheel\n        Adding user postgres to group pg_wheel\n        $ # verify membership\n        $ awk -F':' '/pg_wheel/{print $4}' /etc/group\n        postgres\n        Removing a user account from the 'pg_wheel' group is achieved by executing the following command:\n        $ whoami\n        root\n        $ gpasswd -d pg_wheel postgres\n        Removing user postgres from group pg_wheel\n        $ # verify the user was removed\n        $ awk -F':' '/pg_wheel/{print $4}' /etc/group\n        $",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "grep -i 'pg_wheel' /etc/passwd",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_9": {
        "description": "4.1 Ensure sudo is configured correctly",
        "info": "It is common to have more than one authorized individual administering the PostgreSQL service at the Operating System level. It is also quite common to permit login privileges to individuals on a PostgreSQL host who otherwise are not authorized to access the server's data cluster and files. Administering the PostgreSQL data cluster, as opposed to its data, is to be accomplished via a localhost login of a regular UNIX user account. Access to the postgres superuser account is restricted in such a manner as to interdict unauthorized access. sudo satisfies the requirements by escalating ordinary user account privileges as the PostgreSQL RDBMS superuser.\n        Rationale:\n        Without sudo, there would not be capabilities to strictly control access to the superuser account and to securely and authoritatively audit its use.",
        "solution": "As superuser root, execute the command visudo to edit the /etc/sudoers file so the following line is present:\n        %pg_wheel ALL= /bin/su - postgres\n        This grants any Operating System user that is a member of the pg_wheel group to use sudo to become the postgres user.\n        Ensure that all Operating System user's that need such access are members of the group as detailed earlier in this benchmark.",
        "reference": "800-171|3.1.1,800-53|AC-2(9),800-53r5|AC-2(9),CN-L3|8.1.4.2(c),CSCv6|5.8,CSCv7|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NIAv2|AM16,PCI-DSSv3.2.1|8.5,PCI-DSSv4.0|8.2.2,PCI-DSSv4.0|8.2.3,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "file": "/etc/sudoers",
        "regex": "^pg_wheel",
        "expect": "^pg_wheel[\\\\s]+ALL=[\\\\s]+/bin/su[\\\\s]+-[\\\\s]+postgres"
    },
    "custom_item_10": {
        "description": "4.3 Ensure excessive function privileges are revoked",
        "info": "In certain situations, to provide required functionality, PostgreSQL needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by their organization. This is known as privilege elevation. Privilege elevation must be utilized only where necessary. Execute privileges for application functions should be restricted to authorized users only.\n        Rationale:\n        Ideally, all application source code should be vetted to validate interactions between the application and the logic in the database, but this is usually not possible or feasible with available resources even if the source code is available. The DBA should attempt to obtain assurances from the development organization that this issue has been addressed and should document what has been discovered. The DBA should also inspect all application logic stored in the database (in the form of functions, rules, and triggers) for excessive privileges.\n\n        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Where possible, revoke SECURITY DEFINER on PostgreSQL functions. To change a SECURITY DEFINER function to SECURITY INVOKER, run the following SQL:\n        $ whoami\n        root\n        $ sudo su - postgres\n        $ psql -c \"ALTER FUNCTION [functionname] SECURITY INVOKER;\"\n        If it is not possible to revoke SECURITY DEFINER, ensure the function can be executed by only the accounts that absolutely need such functionality:\n        REVOKE EXECUTE ON FUNCTION delete_customer(integer,boolean) FROM appreader;\n        REVOKE\n        Confirm that the appreader user may no longer execute the function:\n        SELECT proname, proacl FROM pg_proc WHERE proname = 'delete_customer';\n        proname     |                         proacl\n        -----------------+--------------------------------------------------------\n        delete_customer | {=X/postgres,postgres=X/postgres,appwriter=X/postgres}\n        (1 row)\n        Based on output above, appreader=X/postgres no longer exists in the proacl column results returned from query and confirms appreader is no longer granted execute privilege on the function.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv6|5.1,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1S,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "su - @PG_SUPER_USER@ -c \\'/bin/psql -c \"SELECT nspname, proname, proargtypes, prosecdef, rolname, proconfig FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid JOIN pg_authid a ON a.oid = p.proowner WHERE prosecdef OR NOT proconfig IS NULL;\"\\'",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_11": {
        "description": "6.7 Ensure FIPS 140-2 OpenSSL Cryptography Is Used - fips_enabled",
        "info": "Install, configure, and use OpenSSL on a platform that has a NIST certified FIPS 140-2 installation of OpenSSL. This provides PostgreSQL instances the ability to generate and validate cryptographic hashes to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owner's requirements.\n            Rationale:\n            Federal Information Processing Standard (FIPS) Publication 140-2 is a computer security standard developed by a U.S. Government and industry working group for validating the quality of cryptographic modules. Use of weak, or untested, encryption algorithms undermine the purposes of utilizing encryption to protect data. PostgreSQL uses OpenSSL for the underlying encryption layer.\n            The database and application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated. It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.\n            For detailed information, refer to NIST FIPS Publication 140-2, Security Requirements for Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant. The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A. Currently only Red Hat Enterprise Linux is certified as a FIPS 140-2 distribution of OpenSSL. For other operating systems, users must obtain or build their own FIPS 140-2 OpenSSL libraries.",
        "solution": "Configure OpenSSL to be FIPS compliant. PostgreSQL uses OpenSSL for cryptographic modules. To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL Documentation. Below is a general summary of the steps required:\n             Install the dracut-fips package\n            $ yum -y install dracut-fips\n            Loaded plugins: fastestmirror\n            Loading mirror speeds from cached hostfile\n            [snip]\n            Resolving Dependencies\n            --> Running transaction check\n            ---> Package dracut-fips.x86_64 0:033-554.el7 will be installed\n            --> Processing Dependency: hmaccalc for package: dracut-fips-033-554.el7.x86_64\n            --> Running transaction check\n            ---> Package hmaccalc.x86_64 0:0.9.13-4.el7 will be installed\n            --> Finished Dependency Resolution\n            Dependencies Resolved\n\n            Package                      Arch                    Version                          Repository             Size\n\n            Installing:\n            dracut-fips                  x86_64                  033-554.el7                      base                   61 k\n            Installing for dependencies:\n            hmaccalc                     x86_64                  0.9.13-4.el7                     base                   26 k\n\n            Transaction Summary\n            Install  1 Package (+1 Dependent package)\n\n            Total download size: 87 k\n            Installed size: 107 k\n            Downloading packages:\n            [snip]\n            Running transaction check\n            Running transaction test\n            Transaction test succeeded\n            Running transaction\n            Installing : hmaccalc-0.9.13-4.el7.x86_64                                                                    1/2\n            Installing : dracut-fips-033-554.el7.x86_64                                                                  2/2\n            Verifying  : hmaccalc-0.9.13-4.el7.x86_64                                                                    1/2\n            Verifying  : dracut-fips-033-554.el7.x86_64                                                                     2/2\n\n            Installed:\n            dracut-fips.x86_64 0:033-554.el7\n\n            Dependency Installed:\n            hmaccalc.x86_64 0:0.9.13-4.el7\n\n            Complete!\n             Recreate the initramfs file\n            $ dracut -f\n             Modify the kernel command line, e.g. GRUB_CMDLINE_LINUX, of the current kernel in the /etc/default/grub file by adding the following option: fips=1\n             Run one, or both if unsure how the machine is booting, of the following commands:\n            # If booting from BIOS\n            $ grub2-mkconfig -o /boot/grub2/grub.cfg\n\n            # If booting from EFI\n            $ grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg\n             If you have prelink installed you will want to execute prelink -u -a prior to the next reboot.\n             Reboot the system for changes to take effect.\n             Verify fips_enabled according to Audit Procedure above.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "cat /proc/sys/crypto/fips_enabled",
        "expect": "1"
    },
    "custom_item_12": {
        "description": "6.7 Ensure FIPS 140-2 OpenSSL Cryptography Is Used - openssl version",
        "info": "Install, configure, and use OpenSSL on a platform that has a NIST certified FIPS 140-2 installation of OpenSSL. This provides PostgreSQL instances the ability to generate and validate cryptographic hashes to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owner's requirements.\n            Rationale:\n            Federal Information Processing Standard (FIPS) Publication 140-2 is a computer security standard developed by a U.S. Government and industry working group for validating the quality of cryptographic modules. Use of weak, or untested, encryption algorithms undermine the purposes of utilizing encryption to protect data. PostgreSQL uses OpenSSL for the underlying encryption layer.\n            The database and application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated. It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.\n            For detailed information, refer to NIST FIPS Publication 140-2, Security Requirements for Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant. The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A. Currently only Red Hat Enterprise Linux is certified as a FIPS 140-2 distribution of OpenSSL. For other operating systems, users must obtain or build their own FIPS 140-2 OpenSSL libraries.",
        "solution": "Configure OpenSSL to be FIPS compliant. PostgreSQL uses OpenSSL for cryptographic modules. To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL Documentation. Below is a general summary of the steps required:\n             Install the dracut-fips package\n            $ yum -y install dracut-fips\n            Loaded plugins: fastestmirror\n            Loading mirror speeds from cached hostfile\n            [snip]\n            Resolving Dependencies\n            --> Running transaction check\n            ---> Package dracut-fips.x86_64 0:033-554.el7 will be installed\n            --> Processing Dependency: hmaccalc for package: dracut-fips-033-554.el7.x86_64\n            --> Running transaction check\n            ---> Package hmaccalc.x86_64 0:0.9.13-4.el7 will be installed\n            --> Finished Dependency Resolution\n            Dependencies Resolved\n\n            Package                      Arch                    Version                          Repository             Size\n\n            Installing:\n            dracut-fips                  x86_64                  033-554.el7                      base                   61 k\n            Installing for dependencies:\n            hmaccalc                     x86_64                  0.9.13-4.el7                     base                   26 k\n\n            Transaction Summary\n            Install  1 Package (+1 Dependent package)\n\n            Total download size: 87 k\n            Installed size: 107 k\n            Downloading packages:\n            [snip]\n            Running transaction check\n            Running transaction test\n            Transaction test succeeded\n            Running transaction\n            Installing : hmaccalc-0.9.13-4.el7.x86_64                                                                    1/2\n            Installing : dracut-fips-033-554.el7.x86_64                                                                  2/2\n            Verifying  : hmaccalc-0.9.13-4.el7.x86_64                                                                    1/2\n            Verifying  : dracut-fips-033-554.el7.x86_64                                                                     2/2\n\n            Installed:\n            dracut-fips.x86_64 0:033-554.el7\n\n            Dependency Installed:\n            hmaccalc.x86_64 0:0.9.13-4.el7\n\n            Complete!\n             Recreate the initramfs file\n            $ dracut -f\n             Modify the kernel command line, e.g. GRUB_CMDLINE_LINUX, of the current kernel in the /etc/default/grub file by adding the following option: fips=1\n             Run one, or both if unsure how the machine is booting, of the following commands:\n            # If booting from BIOS\n            $ grub2-mkconfig -o /boot/grub2/grub.cfg\n\n            # If booting from EFI\n            $ grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg\n             If you have prelink installed you will want to execute prelink -u -a prior to the next reboot.\n             Reboot the system for changes to take effect.\n             Verify fips_enabled according to Audit Procedure above.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "openssl version",
        "expect": "fips"
    },
    "custom_item_13": {
        "description": "7.3 Ensure WAL archiving is configured and functional - archive_command",
        "info": "Write Ahead Log (WAL) Archiving, or Log Shipping, is the process of sending transaction log files from the PRIMARY host either to one or more STANDBY hosts or to be archived on a remote storage device for later use, e.g. PITR. There are several utilities that can copy WALs including, but not limited to, cp, scp, sftp, and rynsc. Basically, the server follows a set of runtime parameters which defines when the WAL should be copied using one of the aforementioned utilities.\n            Rationale:\n            Unless the server has been correctly configured, one runs the risk of sending WALs in an unsecured, unencrypted fashion.",
        "solution": "Change parameters and restart the server as required.\n            Note: SSH public keys must be generated and installed as per industry standards.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "file": "@PG_CONF_FILE@",
        "regex": "^archive_command",
        "expect": "^archive_command = \\'.*ssh"
    },
    "custom_item_14": {
        "description": "7.3 Ensure WAL archiving is configured and functional - archive_mode",
        "info": "Write Ahead Log (WAL) Archiving, or Log Shipping, is the process of sending transaction log files from the PRIMARY host either to one or more STANDBY hosts or to be archived on a remote storage device for later use, e.g. PITR. There are several utilities that can copy WALs including, but not limited to, cp, scp, sftp, and rynsc. Basically, the server follows a set of runtime parameters which defines when the WAL should be copied using one of the aforementioned utilities.\n            Rationale:\n            Unless the server has been correctly configured, one runs the risk of sending WALs in an unsecured, unencrypted fashion.",
        "solution": "Change parameters and restart the server as required.\n            Note: SSH public keys must be generated and installed as per industry standards.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "file": "@PG_CONF_FILE@",
        "regex": "^archive_mode",
        "expect": "^archive_mode[\\\\s]+=[\\\\s]+on"
    },
    "custom_item_15": {
        "description": "8.3 Ensure the backup and restore tool, 'pgBackRest', is installed and configured",
        "info": "pgBackRest aims to be a simple, reliable backup and restore system that can seamlessly scale up to the largest databases and workloads. Instead of relying on traditional backup tools like tar and rsync, pgBackRest implements all backup features internally and uses a custom protocol for communicating with remote systems. Removing reliance on tar and rsync allows for better solutions to database-specific backup challenges. The custom remote protocol allows for more flexibility and limits the types of connections that are required to perform a backup which increases security.\nRationale:\nThe native PostgreSQL backup facility pg_dump provides adequate logical backup operations but does not provide for Point In Time Recovery (PITR). The PostgreSQL facility pg_basebackup performs physical backup of the database files and does provide for PITR, but it is constrained by single threading. Both of these methodologies are standard in the PostgreSQL ecosystem and appropriate for particular backup/recovery needs. pgBackRest offers another option with much more robust features and flexibility.\npgBackRest is open source software developed to perform efficient backups on PostgreSQL databases that measure in tens of terabytes and greater. It supports per file checksums, compression, partial/failed backup resume, high-performance parallel transfer, asynchronous archiving, tablespaces, expiration, full/differential/incremental, local/remote operation via SSH, hard-linking, restore, backup encryption, and more. pgBackRest is written in C and Perl and does not depend on rsync or tar but instead performs its own deltas which gives it maximum flexibility. Finally, pgBackRest provides an easy to use internal repository listing backup details accessible via the pgbackrest info command, as illustrated below.\n$ pgbackrest info\nstanza: proddb01\nstatus: ok\n\ndb (current)\n  wal archive min/max (11.3-1): 000000010000000000000012 / 000000010000000000000017\n\n      full backup: 20190603-153106F\n          timestamp start/stop: 2019-06-03 15:31:06 / 2019-06-03 15:31:49\n          wal start/stop: 000000010000000000000012 / 000000010000000000000012\n          database size: 29.4MB, backup size: 29.4MB\n          repository size: 3.4MB, repository backup size: 3.4MB\n\n      diff backup: 20190603-153106F_20181002-173109D\n          timestamp start/stop: 2019-06-03 17:31:09 / 2019-06-03 17:31:19\n          wal start/stop: 000000010000000000000015 / 000000010000000000000015\n          database size: 29.4MB, backup size: 2.6MB\n          repository size: 3.4MB, repository backup size: 346.8KB\n          backup reference list: 20190603-153106F\n\n      incr backup: 20190603-153106F_20181002-183114I\n          timestamp start/stop: 2019-06-03 18:31:14 / 2019-06-03 18:31:22\n          wal start/stop: 000000010000000000000017 / 000000010000000000000017\n          database size: 29.4MB, backup size: 8.2KB\n          repository size: 3.4MB, repository backup size: 519B\n          backup reference list: 20190603-153106F, 20190603-153106F_20190603-173109D\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "pgBackRest is not installed nor configured for PostgreSQL by default, but instead is maintained as a GitHub project. Fortunately, it is a part of the PGDG repository and can be easily installed:\n$ whoami\nroot\n$ yum -y install pgbackrest\nLoaded plugins: fastestmirror, priorities\nLoading mirror speeds from cached hostfile\nepel/x86_64/metalink                                       |  18 kB  00:00:00\n * base: mirror.cisp.com\n * centos-sclo-rh: mirror.cc.columbia.edu\n * centos-sclo-sclo: mirror.cisp.com\n * epel: mirror.umd.edu\n * extras: mirror.cisp.com\n * updates: mirror.cisp.com\nbase                                                       | 3.6 kB  00:00:00\ncentos-sclo-rh                                             | 3.0 kB  00:00:00\ncentos-sclo-sclo                                           | 2.9 kB  00:00:00\nepel                                                       | 5.3 kB  00:00:00\nextras                                                     | 3.4 kB  00:00:00\npgdg10                                                     | 3.6 kB  00:00:00\npgdg11                                                     | 3.6 kB  00:00:00\npgdg94                                                     | 3.6 kB  00:00:00\npgdg95                                                     | 3.6 kB  00:00:00\npgdg96                                                     | 3.6 kB  00:00:00\nupdates                                                    | 3.4 kB  00:00:00\n(1/7): epel/x86_64/updateinfo                              | 977 kB  00:00:00\n(2/7): pgdg11/7/x86_64/primary_db                          | 185 kB  00:00:00\n(3/7): pgdg96/7/x86_64/primary_db                          | 248 kB  00:00:00\n(4/7): pgdg94/7/x86_64/primary_db                          | 258 kB  00:00:00\n(5/7): pgdg10/7/x86_64/primary_db                          | 230 kB  00:00:01\n(6/7): pgdg95/7/x86_64/primary_db                          | 247 kB  00:00:01\n(7/7): epel/x86_64/primary_db                              | 6.7 MB  00:00:02\n1467 packages excluded due to repository priority protections\nResolving Dependencies\n--> Running transaction check\n---> Package pgbackrest.x86_64 0:2.14-1.rhel7 will be installed\n--> Processing Dependency: perl-XML-LibXML for package: pgbackrest-2.14-1.rhel7.x86_64\n--> Processing Dependency: perl-JSON-PP for package: pgbackrest-2.14-1.rhel7.x86_64\n--> Processing Dependency: perl-IO-Socket-SSL for package: pgbackrest-2.14-1.rhel7.x86_64\n--> Processing Dependency: perl-Digest-SHA for package: pgbackrest-2.14-1.rhel7.x86_64\n--> Processing Dependency: perl-DBD-Pg for package: pgbackrest-2.14-1.rhel7.x86_64\n--> Running transaction check\n---> Package perl-DBD-Pg.x86_64 0:2.19.3-4.el7 will be installed\n--> Processing Dependency: perl(DBI) >= 1.52 for package: perl-DBD-Pg-2.19.3-4.el7.x86_64\n--> Processing Dependency: perl(version) for package: perl-DBD-Pg-2.19.3-4.el7.x86_64\n---> Package perl-Digest-SHA.x86_64 1:5.85-4.el7 will be installed\n--> Processing Dependency: perl(Digest::base) for package: 1:perl-Digest-SHA-5.85-4.el7.x86_64\n---> Package perl-IO-Socket-SSL.noarch 0:1.94-7.el7 will be installed\n--> Processing Dependency: perl-Net-SSLeay >= 1.55-5 for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n--> Processing Dependency: perl(Net::SSLeay) >= 1.21 for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n--> Processing Dependency: perl(IO::Socket::IP) >= 0.20 for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n--> Processing Dependency: perl(Net::SSLeay) for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n--> Processing Dependency: perl(Net::LibIDN) for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n--> Processing Dependency: perl(Mozilla::CA) for package: perl-IO-Socket-SSL-1.94-7.el7.noarch\n---> Package perl-JSON-PP.noarch 0:2.27202-2.el7 will be installed\n--> Processing Dependency: perl(Data::Dumper) for package: perl-JSON-PP-2.27202-2.el7.noarch\n---> Package perl-XML-LibXML.x86_64 1:2.0018-5.el7 will be installed\n--> Processing Dependency: perl(XML::SAX::Exception) for package: 1:perl-XML-LibXML-2.0018-5.el7.x86_64\n--> Processing Dependency: perl(XML::SAX::DocumentLocator) for package: 1:perl-XML-LibXML-2.0018-5.el7.x86_64\n--> Processing Dependency: perl(XML::SAX::Base) for package: 1:perl-XML-LibXML-2.0018-5.el7.x86_64\n--> Processing Dependency: perl(XML::NamespaceSupport) for package: 1:perl-XML-LibXML-2.0018-5.el7.x86_64\n--> Running transaction check\n---> Package perl-DBI.x86_64 0:1.627-4.el7 will be installed\n--> Processing Dependency: perl(RPC::PlServer) >= 0.2001 for package: perl-DBI-1.627-4.el7.x86_64\n--> Processing Dependency: perl(RPC::PlClient) >= 0.2000 for package: perl-DBI-1.627-4.el7.x86_64\n---> Package perl-Data-Dumper.x86_64 0:2.145-3.el7 will be installed\n---> Package perl-Digest.noarch 0:1.17-245.el7 will be installed\n---> Package perl-IO-Socket-IP.noarch 0:0.21-5.el7 will be installed\n---> Package perl-Mozilla-CA.noarch 0:20130114-5.el7 will be installed\n---> Package perl-Net-LibIDN.x86_64 0:0.12-15.el7 will be installed\n---> Package perl-Net-SSLeay.x86_64 0:1.55-6.el7 will be installed\n---> Package perl-XML-NamespaceSupport.noarch 0:1.11-10.el7 will be installed\n---> Package perl-XML-SAX.noarch 0:0.99-9.el7 will be installed\n--> Processing Dependency: perl(LWP::UserAgent) for package: perl-XML-SAX-0.99-9.el7.noarch\n---> Package perl-XML-SAX-Base.noarch 0:1.08-7.el7 will be installed\n---> Package perl-version.x86_64 3:0.99.07-3.el7 will be installed\n--> Running transaction check\n---> Package perl-PlRPC.noarch 0:0.2020-14.el7 will be installed\n--> Processing Dependency: perl(Net::Daemon) >= 0.13 for package: perl-PlRPC-0.2020-14.el7.noarch\n--> Processing Dependency: perl(Net::Daemon::Test) for package: perl-PlRPC-0.2020-14.el7.noarch\n--> Processing Dependency: perl(Net::Daemon::Log) for package: perl-PlRPC-0.2020-14.el7.noarch\n--> Processing Dependency: perl(Compress::Zlib) for package: perl-PlRPC-0.2020-14.el7.noarch\n---> Package perl-libwww-perl.noarch 0:6.05-2.el7 will be installed\n--> Processing Dependency: perl(WWW::RobotRules) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(URI) >= 1.10 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(Net::HTTP) >= 6.04 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(LWP::MediaTypes) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Status) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Response) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Request::Common) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Request) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Negotiate) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Date) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Daemon) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTTP::Cookies) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(File::Listing) >= 6 for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(URI::Heuristic) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(URI::Escape) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTML::HeadParser) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(HTML::Entities) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(Encode::Locale) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Processing Dependency: perl(Digest::MD5) for package: perl-libwww-perl-6.05-2.el7.noarch\n--> Running transaction check\n---> Package perl-Digest-MD5.x86_64 0:2.52-3.el7 will be installed\n---> Package perl-Encode-Locale.noarch 0:1.03-5.el7 will be installed\n---> Package perl-File-Listing.noarch 0:6.04-7.el7 will be installed\n---> Package perl-HTML-Parser.x86_64 0:3.71-4.el7 will be installed\n--> Processing Dependency: perl(HTML::Tagset) >= 3 for package: perl-HTML-Parser-3.71-4.el7.x86_64\n---> Package perl-HTTP-Cookies.noarch 0:6.01-5.el7 will be installed\n---> Package perl-HTTP-Daemon.noarch 0:6.01-8.el7 will be installed\n---> Package perl-HTTP-Date.noarch 0:6.02-8.el7 will be installed\n--> Processing Dependency: perl(Time::Zone) for package: perl-HTTP-Date-6.02-8.el7.noarch\n---> Package perl-HTTP-Message.noarch 0:6.06-6.el7 will be installed\n--> Processing Dependency: perl(IO::HTML) for package: perl-HTTP-Message-6.06-6.el7.noarch\n--> Processing Dependency: perl(Compress::Raw::Zlib) for package: perl-HTTP-Message-6.06-6.el7.noarch\n---> Package perl-HTTP-Negotiate.noarch 0:6.01-5.el7 will be installed\n---> Package perl-IO-Compress.noarch 0:2.061-2.el7 will be installed\n--> Processing Dependency: perl(Compress::Raw::Bzip2) >= 2.061 for package: perl-IO-Compress-2.061-2.el7.noarch\n---> Package perl-LWP-MediaTypes.noarch 0:6.02-2.el7 will be installed\n--> Processing Dependency: mailcap for package: perl-LWP-MediaTypes-6.02-2.el7.noarch\n---> Package perl-Net-Daemon.noarch 0:0.48-5.el7 will be installed\n---> Package perl-Net-HTTP.noarch 0:6.06-2.el7 will be installed\n---> Package perl-URI.noarch 0:1.60-9.el7 will be installed\n--> Processing Dependency: perl(Business::ISBN) for package: perl-URI-1.60-9.el7.noarch\n---> Package perl-WWW-RobotRules.noarch 0:6.02-5.el7 will be installed\n--> Running transaction check\n---> Package mailcap.noarch 0:2.1.41-2.el7 will be installed\n---> Package perl-Business-ISBN.noarch 0:2.06-2.el7 will be installed\n--> Processing Dependency: perl(Business::ISBN::Data) >= 20120719.001 for package: perl-Business-ISBN-2.06-2.el7.noarch\n---> Package perl-Compress-Raw-Bzip2.x86_64 0:2.061-3.el7 will be installed\n---> Package perl-Compress-Raw-Zlib.x86_64 1:2.061-4.el7 will be installed\n---> Package perl-HTML-Tagset.noarch 0:3.20-15.el7 will be installed\n---> Package perl-IO-HTML.noarch 0:1.00-2.el7 will be installed\n---> Package perl-TimeDate.noarch 1:2.30-2.el7 will be installed\n--> Running transaction check\n---> Package perl-Business-ISBN-Data.noarch 0:20120719.001-2.el7 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n=============================================================================\n Package                     Arch     Version             Repository     Size\n=============================================================================\nInstalling:\n pgbackrest                  x86_64   2.14-1.rhel7        pgdg11        275 k\nInstalling for dependencies:\n mailcap                     noarch   2.1.41-2.el7        base           31 k\n perl-Business-ISBN          noarch   2.06-2.el7          base           25 k\n perl-Business-ISBN-Data     noarch   20120719.001-2.el7  base           24 k\n perl-Compress-Raw-Bzip2     x86_64   2.061-3.el7         base           32 k\n perl-Compress-Raw-Zlib      x86_64   1:2.061-4.el7       base           57 k\n perl-DBD-Pg                 x86_64   2.19.3-4.el7        base          195 k\n perl-DBI                    x86_64   1.627-4.el7         base          802 k\n perl-Data-Dumper            x86_64   2.145-3.el7         base           47 k\n perl-Digest                 noarch   1.17-245.el7        base           23 k\n perl-Digest-MD5             x86_64   2.52-3.el7          base           30 k\n perl-Digest-SHA             x86_64   1:5.85-4.el7        base           58 k\n perl-Encode-Locale          noarch   1.03-5.el7          base           16 k\n perl-File-Listing           noarch   6.04-7.el7          base           13 k\n perl-HTML-Parser            x86_64   3.71-4.el7          base          115 k\n perl-HTML-Tagset            noarch   3.20-15.el7         base           18 k\n perl-HTTP-Cookies           noarch   6.01-5.el7          base           26 k\n perl-HTTP-Daemon            noarch   6.01-8.el7          base           21 k\n perl-HTTP-Date              noarch   6.02-8.el7          base           14 k\n perl-HTTP-Message           noarch   6.06-6.el7          base           82 k\n perl-HTTP-Negotiate         noarch   6.01-5.el7          base           17 k\n perl-IO-Compress            noarch   2.061-2.el7         base          260 k\n perl-IO-HTML                noarch   1.00-2.el7          base           23 k\n perl-IO-Socket-IP           noarch   0.21-5.el7          base           36 k\n perl-IO-Socket-SSL          noarch   1.94-7.el7          base          115 k\n perl-JSON-PP                noarch   2.27202-2.el7       base           55 k\n perl-LWP-MediaTypes         noarch   6.02-2.el7          base           24 k\n perl-Mozilla-CA             noarch   20130114-5.el7      base           11 k\n perl-Net-Daemon             noarch   0.48-5.el7          base           51 k\n perl-Net-HTTP               noarch   6.06-2.el7          base           29 k\n perl-Net-LibIDN             x86_64   0.12-15.el7         base           28 k\n perl-Net-SSLeay             x86_64   1.55-6.el7          base          285 k\n perl-PlRPC                  noarch   0.2020-14.el7       base           36 k\n perl-TimeDate               noarch   1:2.30-2.el7        base           52 k\n perl-URI                    noarch   1.60-9.el7          base          106 k\n perl-WWW-RobotRules         noarch   6.02-5.el7          base           18 k\n perl-XML-LibXML             x86_64   1:2.0018-5.el7      base          373 k\n perl-XML-NamespaceSupport   noarch   1.11-10.el7         base           18 k\n perl-XML-SAX                noarch   0.99-9.el7          base           63 k\n perl-XML-SAX-Base           noarch   1.08-7.el7          base           32 k\n perl-libwww-perl            noarch   6.05-2.el7          base          205 k\n perl-version                x86_64   3:0.99.07-3.el7     base           84 k\n\nTransaction Summary\n=============================================================================\nInstall  1 Package (+41 Dependent packages)\n\nTotal download size: 3.7 M\nInstalled size: 9.5 M\nDownloading packages:\n(1/42): perl-Compress-Raw-Zlib-2.061-4.el7.x86_64.rpm      |  57 kB  00:00:00\n(2/42): perl-Business-ISBN-Data-20120719.001-2.el7.noarch.rpm |  24 kB  00:00:00\n(3/42): perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64.rpm     |  32 kB  00:00:00\n(4/42): perl-Data-Dumper-2.145-3.el7.x86_64.rpm            |  47 kB  00:00:00\n(5/42): perl-Business-ISBN-2.06-2.el7.noarch.rpm           |  25 kB  00:00:00\n(6/42): perl-Digest-1.17-245.el7.noarch.rpm                |  23 kB  00:00:00\n(7/42): perl-DBD-Pg-2.19.3-4.el7.x86_64.rpm                | 195 kB  00:00:00\n(8/42): perl-Encode-Locale-1.03-5.el7.noarch.rpm           |  16 kB  00:00:00\n(9/42): perl-Digest-SHA-5.85-4.el7.x86_64.rpm              |  58 kB  00:00:00\n(10/42): perl-Digest-MD5-2.52-3.el7.x86_64.rpm             |  30 kB  00:00:00\n(11/42): perl-HTML-Tagset-3.20-15.el7.noarch.rpm           |  18 kB  00:00:00\n(12/42): perl-HTML-Parser-3.71-4.el7.x86_64.rpm            | 115 kB  00:00:00\n(13/42): perl-HTTP-Daemon-6.01-8.el7.noarch.rpm            |  21 kB  00:00:00\n(14/42): perl-File-Listing-6.04-7.el7.noarch.rpm           |  13 kB  00:00:00\n(15/42): perl-HTTP-Date-6.02-8.el7.noarch.rpm              |  14 kB  00:00:00\n(16/42): perl-HTTP-Cookies-6.01-5.el7.noarch.rpm           |  26 kB  00:00:00\n(17/42): perl-HTTP-Negotiate-6.01-5.el7.noarch.rpm         |  17 kB  00:00:00\n(18/42): perl-IO-HTML-1.00-2.el7.noarch.rpm                |  23 kB  00:00:00\n(19/42): perl-IO-Socket-IP-0.21-5.el7.noarch.rpm           |  36 kB  00:00:00\n(20/42): perl-IO-Socket-SSL-1.94-7.el7.noarch.rpm          | 115 kB  00:00:00\n(21/42): perl-JSON-PP-2.27202-2.el7.noarch.rpm             |  55 kB  00:00:00\n(22/42): perl-HTTP-Message-6.06-6.el7.noarch.rpm           |  82 kB  00:00:00\n(23/42): perl-LWP-MediaTypes-6.02-2.el7.noarch.rpm         |  24 kB  00:00:00\n(24/42): perl-Net-Daemon-0.48-5.el7.noarch.rpm             |  51 kB  00:00:00\n(25/42): perl-Mozilla-CA-20130114-5.el7.noarch.rpm         |  11 kB  00:00:00\n(26/42): perl-Net-HTTP-6.06-2.el7.noarch.rpm               |  29 kB  00:00:00\n(27/42): perl-DBI-1.627-4.el7.x86_64.rpm                   | 802 kB  00:00:00\n(28/42): perl-Net-SSLeay-1.55-6.el7.x86_64.rpm             | 285 kB  00:00:00\n(29/42): perl-Net-LibIDN-0.12-15.el7.x86_64.rpm            |  28 kB  00:00:00\n(30/42): perl-PlRPC-0.2020-14.el7.noarch.rpm               |  36 kB  00:00:00\n(31/42): perl-IO-Compress-2.061-2.el7.noarch.rpm           | 260 kB  00:00:00\n(32/42): perl-URI-1.60-9.el7.noarch.rpm                    | 106 kB  00:00:00\n(33/42): perl-XML-NamespaceSupport-1.11-10.el7.noarch.rpm  |  18 kB  00:00:00\n(34/42): perl-WWW-RobotRules-6.02-5.el7.noarch.rpm         |  18 kB  00:00:00\n(35/42): perl-XML-SAX-0.99-9.el7.noarch.rpm                |  63 kB  00:00:00\n(36/42): perl-TimeDate-2.30-2.el7.noarch.rpm               |  52 kB  00:00:00\n(37/42): mailcap-2.1.41-2.el7.noarch.rpm                   |  31 kB  00:00:01\n(38/42): perl-XML-SAX-Base-1.08-7.el7.noarch.rpm           |  32 kB  00:00:00\n(39/42): perl-version-0.99.07-3.el7.x86_64.rpm             |  84 kB  00:00:00\n(40/42): perl-libwww-perl-6.05-2.el7.noarch.rpm            | 205 kB  00:00:00\n(41/42): perl-XML-LibXML-2.0018-5.el7.x86_64.rpm           | 373 kB  00:00:00\n(42/42): pgbackrest-2.14-1.rhel7.x86_64.rpm                | 275 kB  00:00:01\n-----------------------------------------------------------------------------\nTotal                                             1.3 MB/s | 3.7 MB  00:00:02\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : perl-Data-Dumper-2.145-3.el7.x86_64                       1/42\n  Installing : 1:perl-Compress-Raw-Zlib-2.061-4.el7.x86_64               2/42\n  Installing : perl-Digest-1.17-245.el7.noarch                           3/42\n  Installing : perl-XML-SAX-Base-1.08-7.el7.noarch                       4/42\n  Installing : perl-IO-Socket-IP-0.21-5.el7.noarch                       5/42\n  Installing : perl-Encode-Locale-1.03-5.el7.noarch                      6/42\n  Installing : perl-XML-NamespaceSupport-1.11-10.el7.noarch              7/42\n  Installing : perl-Digest-MD5-2.52-3.el7.x86_64                         8/42\n  Installing : 1:perl-Digest-SHA-5.85-4.el7.x86_64                       9/42\n  Installing : perl-JSON-PP-2.27202-2.el7.noarch                        10/42\n  Installing : perl-HTML-Tagset-3.20-15.el7.noarch                      11/42\n  Installing : perl-IO-HTML-1.00-2.el7.noarch                           12/42\n  Installing : 1:perl-TimeDate-2.30-2.el7.noarch                        13/42\n  Installing : perl-HTTP-Date-6.02-8.el7.noarch                         14/42\n  Installing : perl-File-Listing-6.04-7.el7.noarch                      15/42\n  Installing : perl-Business-ISBN-Data-20120719.001-2.el7.noarch        16/42\n  Installing : perl-Business-ISBN-2.06-2.el7.noarch                     17/42\n  Installing : perl-URI-1.60-9.el7.noarch                               18/42\n  Installing : perl-WWW-RobotRules-6.02-5.el7.noarch                    19/42\n  Installing : perl-Net-SSLeay-1.55-6.el7.x86_64                        20/42\n  Installing : 3:perl-version-0.99.07-3.el7.x86_64                      21/42\n  Installing : perl-Mozilla-CA-20130114-5.el7.noarch                    22/42\n  Installing : perl-Net-Daemon-0.48-5.el7.noarch                        23/42\n  Installing : perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64               24/42\n  Installing : perl-IO-Compress-2.061-2.el7.noarch                      25/42\n  Installing : perl-PlRPC-0.2020-14.el7.noarch                          26/42\n  Installing : perl-DBI-1.627-4.el7.x86_64                              27/42\n  Installing : perl-DBD-Pg-2.19.3-4.el7.x86_64                          28/42\n  Installing : perl-Net-LibIDN-0.12-15.el7.x86_64                       29/42\n  Installing : perl-IO-Socket-SSL-1.94-7.el7.noarch                     30/42\n  Installing : perl-Net-HTTP-6.06-2.el7.noarch                          31/42\n  Installing : mailcap-2.1.41-2.el7.noarch                              32/42\n  Installing : perl-LWP-MediaTypes-6.02-2.el7.noarch                    33/42\n  Installing : perl-HTTP-Message-6.06-6.el7.noarch                      34/42\n  Installing : perl-HTTP-Cookies-6.01-5.el7.noarch                      35/42\n  Installing : perl-HTML-Parser-3.71-4.el7.x86_64                       36/42\n  Installing : perl-HTTP-Negotiate-6.01-5.el7.noarch                    37/42\n  Installing : perl-HTTP-Daemon-6.01-8.el7.noarch                       38/42\n  Installing : perl-libwww-perl-6.05-2.el7.noarch                       39/42\n  Installing : perl-XML-SAX-0.99-9.el7.noarch                           40/42\n  Installing : 1:perl-XML-LibXML-2.0018-5.el7.x86_64                    41/42\n  Installing : pgbackrest-2.14-1.rhel7.x86_64                           42/42\n  Verifying  : perl-IO-Compress-2.061-2.el7.noarch                       1/42\n  Verifying  : perl-Business-ISBN-2.06-2.el7.noarch                      2/42\n  Verifying  : mailcap-2.1.41-2.el7.noarch                               3/42\n  Verifying  : perl-HTTP-Cookies-6.01-5.el7.noarch                       4/42\n  Verifying  : perl-JSON-PP-2.27202-2.el7.noarch                         5/42\n  Verifying  : perl-Net-LibIDN-0.12-15.el7.x86_64                        6/42\n  Verifying  : perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64                7/42\n  Verifying  : perl-HTML-Parser-3.71-4.el7.x86_64                        8/42\n  Verifying  : perl-Net-Daemon-0.48-5.el7.noarch                         9/42\n  Verifying  : perl-HTTP-Message-6.06-6.el7.noarch                      10/42\n  Verifying  : perl-Digest-MD5-2.52-3.el7.x86_64                        11/42\n  Verifying  : perl-HTTP-Date-6.02-8.el7.noarch                         12/42\n  Verifying  : perl-WWW-RobotRules-6.02-5.el7.noarch                    13/42\n  Verifying  : perl-XML-NamespaceSupport-1.11-10.el7.noarch             14/42\n  Verifying  : perl-IO-Socket-SSL-1.94-7.el7.noarch                     15/42\n  Verifying  : perl-Mozilla-CA-20130114-5.el7.noarch                    16/42\n  Verifying  : 3:perl-version-0.99.07-3.el7.x86_64                      17/42\n  Verifying  : perl-DBD-Pg-2.19.3-4.el7.x86_64                          18/42\n  Verifying  : perl-Encode-Locale-1.03-5.el7.noarch                     19/42\n  Verifying  : perl-Data-Dumper-2.145-3.el7.x86_64                      20/42\n  Verifying  : 1:perl-XML-LibXML-2.0018-5.el7.x86_64                    21/42\n  Verifying  : perl-IO-Socket-IP-0.21-5.el7.noarch                      22/42\n  Verifying  : perl-Net-SSLeay-1.55-6.el7.x86_64                        23/42\n  Verifying  : perl-HTTP-Negotiate-6.01-5.el7.noarch                    24/42\n  Verifying  : perl-Business-ISBN-Data-20120719.001-2.el7.noarch        25/42\n  Verifying  : 1:perl-Compress-Raw-Zlib-2.061-4.el7.x86_64              26/42\n  Verifying  : perl-libwww-perl-6.05-2.el7.noarch                       27/42\n  Verifying  : perl-HTTP-Daemon-6.01-8.el7.noarch                       28/42\n  Verifying  : perl-LWP-MediaTypes-6.02-2.el7.noarch                    29/42\n  Verifying  : perl-XML-SAX-0.99-9.el7.noarch                           30/42\n  Verifying  : perl-PlRPC-0.2020-14.el7.noarch                          31/42\n  Verifying  : perl-DBI-1.627-4.el7.x86_64                              32/42\n  Verifying  : perl-Net-HTTP-6.06-2.el7.noarch                          33/42\n  Verifying  : 1:perl-TimeDate-2.30-2.el7.noarch                        34/42\n  Verifying  : 1:perl-Digest-SHA-5.85-4.el7.x86_64                      35/42\n  Verifying  : perl-IO-HTML-1.00-2.el7.noarch                           36/42\n  Verifying  : perl-XML-SAX-Base-1.08-7.el7.noarch                      37/42\n  Verifying  : perl-Digest-1.17-245.el7.noarch                          38/42\n  Verifying  : perl-HTML-Tagset-3.20-15.el7.noarch                      39/42\n  Verifying  : pgbackrest-2.14-1.rhel7.x86_64                           40/42\n  Verifying  : perl-URI-1.60-9.el7.noarch                               41/42\n  Verifying  : perl-File-Listing-6.04-7.el7.noarch                      42/42\n\nInstalled:\n  pgbackrest.x86_64 0:2.14-1.rhel7\n\nDependency Installed:\n  mailcap.noarch 0:2.1.41-2.el7                                perl-Business-ISBN.noarch 0:2.06-2.el7\n  perl-Business-ISBN-Data.noarch 0:20120719.001-2.el7          perl-Compress-Raw-Bzip2.x86_64 0:2.061-3.el7\n  perl-Compress-Raw-Zlib.x86_64 1:2.061-4.el7                  perl-DBD-Pg.x86_64 0:2.19.3-4.el7\n  perl-DBI.x86_64 0:1.627-4.el7                                perl-Data-Dumper.x86_64 0:2.145-3.el7\n  perl-Digest.noarch 0:1.17-245.el7                            perl-Digest-MD5.x86_64 0:2.52-3.el7\n  perl-Digest-SHA.x86_64 1:5.85-4.el7                          perl-Encode-Locale.noarch 0:1.03-5.el7\n  perl-File-Listing.noarch 0:6.04-7.el7                        perl-HTML-Parser.x86_64 0:3.71-4.el7\n  perl-HTML-Tagset.noarch 0:3.20-15.el7                        perl-HTTP-Cookies.noarch 0:6.01-5.el7\n  perl-HTTP-Daemon.noarch 0:6.01-8.el7                         perl-HTTP-Date.noarch 0:6.02-8.el7\n  perl-HTTP-Message.noarch 0:6.06-6.el7                        perl-HTTP-Negotiate.noarch 0:6.01-5.el7\n  perl-IO-Compress.noarch 0:2.061-2.el7                        perl-IO-HTML.noarch 0:1.00-2.el7\n  perl-IO-Socket-IP.noarch 0:0.21-5.el7                        perl-IO-Socket-SSL.noarch 0:1.94-7.el7\n  perl-JSON-PP.noarch 0:2.27202-2.el7                          perl-LWP-MediaTypes.noarch 0:6.02-2.el7\n  perl-Mozilla-CA.noarch 0:20130114-5.el7                      perl-Net-Daemon.noarch 0:0.48-5.el7\n  perl-Net-HTTP.noarch 0:6.06-2.el7                            perl-Net-LibIDN.x86_64 0:0.12-15.el7\n  perl-Net-SSLeay.x86_64 0:1.55-6.el7                          perl-PlRPC.noarch 0:0.2020-14.el7\n  perl-TimeDate.noarch 1:2.30-2.el7                            perl-URI.noarch 0:1.60-9.el7\n  perl-WWW-RobotRules.noarch 0:6.02-5.el7                      perl-XML-LibXML.x86_64 1:2.0018-5.el7\n  perl-XML-NamespaceSupport.noarch 0:1.11-10.el7               perl-XML-SAX.noarch 0:0.99-9.el7\n  perl-XML-SAX-Base.noarch 0:1.08-7.el7                        perl-libwww-perl.noarch 0:6.05-2.el7\n  perl-version.x86_64 3:0.99.07-3.el7\n\nComplete!\nOnce installed, pgBackRest must be configured for things like stanza name, backup location, retention policy, logging, etc. Please consult the configuration guide.\nIf employing pgBackRest for your backup/recovery solution, ensure the repository, base backups, and WAL archives are stored on a reliable file system separate from the database server. Further, the external storage system where backups resided should have limited access to only those system administrators as necessary. Finally, as with any backup/recovery solution, stringent testing must be conducted. A backup is only good if it can be restored successfully.",
        "reference": "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSCv6|10,CSCv7|10.1,CSCv7|10.2,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,LEVEL|1NS,NESA|M5.2.3,NESA|T2.2.4",
        "see_also": "https://workbench.cisecurity.org/files/2407",
        "cmd": "su - @PG_SUPER_USER@ -c \"pgbackrest info\"",
        "expect": "MANUAL_REVIEW"
    }
}