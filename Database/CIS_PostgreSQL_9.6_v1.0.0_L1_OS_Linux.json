{
    "custom_item_1": {
        "description": "Linux found",
        "cmd": "uname -a",
        "expect": "Linux"
    },
    "custom_item_2": {
        "description": "1.1 Ensure packages are obtained from authorized repositories",
        "info": "When obtaining and installing software packages (typically via yum), it's imperative that packages are sourced only from valid and authorized repositories. For PostgreSQL, a short list of valid repositories would include CentOS (www.centos.org) and the official PostgreSQL website (yum.postgresql.org).\nRationale:\nBeing open source, PostgreSQL packages are widely available across the internet through RPM aggregators and providers. However, using invalid or unauthorized sources for packages can lead to implementing untested, defective, or malicious software.\nMany organizations choose to implement a local yum repository within their organization. Care must be taken to ensure that only valid and authorized packages are downloaded and installed into such local repositories.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Alter the configured repositories so they only include valid and authorized sources of packages.\nAs an example of adding an authorized repository, we will install the PGDG repository RPM from 'yum.postgresql.org':\n$ whoami\nroot\n$ rpm -ivh https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm\nRetrieving https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm\nwarning: /var/tmp/rpm-tmp.xU8FK1: Header V4 DSA/SHA1 Signature, key ID 442df0f8: NOKEY\nPreparing...         ########################################### [100%]\n   1:pgdg-centos96   ########################################### [100%]\nVerify the repository has been added and is enabled:\n$ whoami\nroot\n$ yum repolist all | grep enabled:\nbase                        CentOS-6 - Base                    enabled: 6,713\nextras                      CentOS-6 - Extras                  enabled:    31\npgdg96                      PostgreSQL 9.6 6 - x86_64          enabled:   536\nupdates                     CentOS-6 - Updates                 enabled:    96",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv6|2,CSCv7|2,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|1NS,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "yum repolist all | grep enabled",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_3": {
        "description": "1.2 Ensure Installation of Binary Packages",
        "info": "The PostgreSQL packages are installed on the Operating System from valid source.\nRationale:\nStandard Linux distributions, although possessing the requisite packages, often do not have PostgreSQL pre-installed. The installation process includes installing the binaries and the means to generate a data cluster too. Package installation should include both the server and client packages. Contribution modules are optional depending upon one's architectural requirements (they are recommended though).\nFrom a security perspective, it's imperative to verify the PostgreSQL binary packages are sourced from a valid Linux yum repository. The most common Linux repositories include CentOS base and PGDG base; however, it's up to the organization to validate. For a complete listing of all PostgreSQL binaries available via configured repositories inspect the output from yum provides postgres*.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the version of PostgreSQL installed is not 9.6.x, the packages may be uninstalled using this command:\n$ whoami\nroot\n$ yum remove $(rpm -qa|grep postgres)\nThe next recommendation '1.3 Ensure Installation of Community Packages' describes how to explicitly choose which version of PostgreSQL to install, regardless of Linux distribution association.\nImpact:\nIf the PostgreSQL version shipped as part of the default binary installation associated with your Linux distribution satisfies your requirements, this may be adequate for development and testing purposes. However, for production instances it's generally recommended to install the latest stable release of PostgreSQL.",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv6|2,CSCv7|2,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|1NS,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "rpm -qa|grep postgres",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_4": {
        "description": "1.3 Ensure Installation of Community Packages",
        "info": "Adding, and installing, the PostgreSQL community packages to the host's package repository.\nRationale:\nIt's an unfortunate reality that Linux distributions do not always have the most up-to-date versions of PostgreSQL. Disadvantages of older releases include: missing bug patches, no access to highly desirable contribution modules, no access to 3rd party projects that are complimentary to PostgreSQL, and no upgrade path migrating from one version of PostgreSQL to the next. The worst set of circumstances is to be limited to a version of the RDBMS that has reached its end-of-life.\nFrom a security perspective, it's imperative that Postgres Community Packages are only obtained from the official website https://yum.postgresql.org/. Being open source, the Postgres packages are widely available over the internet via myriad package aggregators and providers. Obtaining software from these unofficial sites risks installing defective, corrupt, or downright malicious versions of PostgreSQL.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following example blocks the outdated distro packages, adds the PGDG repository RPM for PostgreSQL version 9.6, and installs the client-server-contributions rpms to the host where you want to install the RDBMS:\n$ whoami\nroot\n$ vi /etc/yum.repos.d/CentOS-Base.repo\n[base]\nname=CentOS-$releasever - Base\nmirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo\n=os&infra=$infra\n#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nexclude=postgresql*  <-- add this line\n\n#released updates\n[updates]\nname=CentOS-$releasever - Updates\nmirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo\n=updates&infra=$infra\n#baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6\nexclude=postgresql*  <-- add this line\nUsing a web browser, go to http://yum.postgresql.org and navigate to the repo download link for your OS and version:\n$ whoami\nroot\n$ yum -y install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-6-x86_64/pgdg-centos96-9.6-3.noarch.rpm\nFinally, install the PostgreSQL packages:\n$ whoami\nroot\n$ yum -y groupinstall 'PostgreSQL Database Server 9.6 PGDG'\nLoaded plugins: fastestmirror\nSetting up Group Process\nLoading mirror speeds from cached hostfile\n * base: mirror.us.oneandone.net\n * extras: centos.mirrors.tds.net\n * updates: mirror.cisp.com\nbase                                                     | 3.7 kB     00:00\nextras                                                   | 3.4 kB     00:00\nupdates                                                  | 3.4 kB     00:00\nbase/group_gz                                            | 242 kB     00:00\npgdg96/group_gz                                          |  249 B     00:00\nResolving Dependencies\n--> Running transaction check\n---> Package postgresql96.x86_64 0:9.6.10-1PGDG.rhel6 will be installed\n---> Package postgresql96-contrib.x86_64 0:9.6.10-1PGDG.rhel6 will be installed\n--> Processing Dependency: libxslt.so.1(LIBXML2_1.0.22)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64\n--> Processing Dependency: libxslt.so.1(LIBXML2_1.0.18)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64\n--> Processing Dependency: libxslt.so.1(LIBXML2_1.0.11)(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64\n--> Processing Dependency: libxslt.so.1()(64bit) for package: postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64\n---> Package postgresql96-libs.x86_64 0:9.6.10-1PGDG.rhel6 will be installed\n---> Package postgresql96-server.x86_64 0:9.6.10-1PGDG.rhel6 will be installed\n--> Running transaction check\n---> Package libxslt.x86_64 0:1.1.26-2.el6_3.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package                  Arch       Version                   Repository  Size\n================================================================================\nInstalling:\n postgresql96             x86_64     9.6.10-1PGDG.rhel6        pgdg96     1.4 M\n postgresql96-contrib     x86_64     9.6.10-1PGDG.rhel6        pgdg96     492 k\n postgresql96-libs        x86_64     9.6.10-1PGDG.rhel6        pgdg96     289 k\n postgresql96-server      x86_64     9.6.10-1PGDG.rhel6        pgdg96     5.0 M\nInstalling for dependencies:\n libxslt                  x86_64     1.1.26-2.el6_3.1          base       452 k\n\nTransaction Summary\n================================================================================\nInstall       5 Package(s)\n\nTotal download size: 7.7 M\nInstalled size: 31 M\nDownloading Packages:\n(1/5): libxslt-1.1.26-2.el6_3.1.x86_64.rpm               | 452 kB     00:00\n(2/5): postgresql96-9.6.10-1PGDG.rhel6.x86_64.rpm        | 1.4 MB     00:01\n(3/5): postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64.rp | 492 kB     00:00\n(4/5): postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64.rpm   | 289 kB     00:00\n(5/5): postgresql96-server-9.6.10-1PGDG.rhel6.x86_64.rpm | 5.0 MB     00:00\n--------------------------------------------------------------------------------\nTotal                                           2.5 MB/s | 7.7 MB     00:03\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64                  1/5\n  Installing : postgresql96-9.6.10-1PGDG.rhel6.x86_64                       2/5\n  Installing : libxslt-1.1.26-2.el6_3.1.x86_64                              3/5\n  Installing : postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64               4/5\n  Installing : postgresql96-server-9.6.10-1PGDG.rhel6.x86_64                5/5\n  Verifying  : libxslt-1.1.26-2.el6_3.1.x86_64                              1/5\n  Verifying  : postgresql96-9.6.10-1PGDG.rhel6.x86_64                       2/5\n  Verifying  : postgresql96-libs-9.6.10-1PGDG.rhel6.x86_64                  3/5\n  Verifying  : postgresql96-server-9.6.10-1PGDG.rhel6.x86_64                4/5\n  Verifying  : postgresql96-contrib-9.6.10-1PGDG.rhel6.x86_64               5/5\n\nInstalled:\n  postgresql96.x86_64 0:9.6.10-1PGDG.rhel6\n  postgresql96-contrib.x86_64 0:9.6.10-1PGDG.rhel6\n  postgresql96-libs.x86_64 0:9.6.10-1PGDG.rhel6\n  postgresql96-server.x86_64 0:9.6.10-1PGDG.rhel6\n\nDependency Installed:\n  libxslt.x86_64 0:1.1.26-2.el6_3.1\n\nComplete!\nNote: The above-mentioned example is referenced as an illustration only. Package names and versions may differ.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv6|18.1,CSCv7|18.3,CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1NS,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "yum list installed postgres*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_5": {
        "description": "1.4 Ensure Service Runlevel Is Registered And Set Correctly",
        "info": "Confirm, and set if necessary, the PostgreSQL runlevel on SYSV operating systems.\nRationale:\nSetting the runlevel on a SYSV OS ensures the database service is active when a change of state occurs as in the case of a system startup, reboot, or an explicit change of runlevel by the Sys Admin.",
        "solution": "Irrespective of package source, PostgreSQL services can be identified because it typically includes the text string 'postgresql'. Correct installs automatically register the service although it may still be off. Multiple instances of PostgreSQL services often distinguish themselves using a version number. Unregistered services must be added before its runlevel can be administrated.\n$ whoami\nroot\n$ chkconfig --add postgresql-9.6 <-- registers if not already\n$ chkconfig --level 3 postgresql-9.6 on\n$ chkconfig --list | grep postgres\npostgresql-9.6 \t0:off\t1:off\t2:off\t3:on\t4:off\t5:off\t6:off",
        "reference": "800-171|3.13.1,800-171|3.13.2,800-53|SA-8,800-53r5|SA-8,CSCv6|18,CSCv7|18,CSF|PR.IP-2,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SA-8,ITSG-33|SA-8a.,LEVEL|1S,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|SS3,NIAv2|VL2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "service": "postgresql-9.5",
        "levels": "3"
    },
    "custom_item_6": {
        "description": "2.1 Ensure the file permissions mask is correct",
        "info": "Files are always created using a default set of permissions. File permissions can be restricted by applying a permissions mask called the umask. The postgres user account should use a umask of 077 to deny file access to all user accounts except the owner.\nRationale:\nThe Linux OS defaults the umask to 002, which means the owner and primary group can read and write the file, and other accounts are permitted to read the file. Not explicitly setting the umask to a value as restrictive as 077 allows other users to read, write, or even execute files and scripts created by the postgres user account. The alternative to using a umask is explicitly updating file permissions after file creation using the command line utility chmod (a manual and error prone process that is not advised).",
        "solution": "Depending upon the postgres user's environment, the umask is typically set in the initialization file .bash_profile, but may also be set in .profile or .bashrc. To set the umask, add the following to the appropriate profile file:\n$ whoami\npostgres\n$ cd ~\n$ ls -ld .{bash_profile,profile,bashrc}\nls: cannot access .profile: No such file or directory\nls: cannot access .bashrc: No such file or directory\n-rwx------. 1 postgres postgres 267 Aug 14 12:59 .bash_profile\n$ echo 'umask 077' >> .bash_profile\n$ source .bash_profile\n$ umask\n0077\nDefault Value:\n0022",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "grep -i \\\\'umask\\\\' /var/lib/pgsql/.bash_profile /var/lib/pgsql/.profile /var/lib/pgsql/.bashrc",
        "expect": "UMASK [0-7]+77"
    },
    "custom_item_7": {
        "description": "2.2 Ensure the PostgreSQL pg_wheel group membership is correct - /etc/group",
        "info": "The group pg_wheel is explicitly created on a host where the PostgreSQL server is installed. Membership in this group enables an ordinary user account to gain 'superuser' access to a database cluster by using the sudo command (See 'Ensure sudo is configured correctly' later in this benchmark). Only user accounts authorized to have superuser access should be members of the pg_wheel group.\nRationale:\nUsers with unauthorized membership in the pg_wheel group can assume the privileges of the owner of the PostgreSQL RDBMS and administer the database, as well as accessing scripts, files, and other executables they should not be able to access.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the pg_wheel group does not exist, use the following command to create it:\n$ whoami\nroot\n$ groupadd pg_wheel && getent group pg_wheel\npg_wheel:x:502:\nNote: that your system's group number may not be 502. That's OK.\nAdding the postgres user to the newly created group is done by issuing:\n$ whoami\nroot\n$ gpasswd -a postgres pg_wheel\nAdding user postgres to group pg_wheel\n$ # verify membership\n$ awk -F':' '/pg_wheel/{print $4}' /etc/group\npostgres\nRemoving a user account from the 'pg_wheel' group is achieved by executing the following command:\n$ whoami\nroot\n$ gpasswd -d pg_wheel postgres\nRemoving user postgres from group pg_wheel\n$ # verify the user was removed\n$ awk -F':' '/pg_wheel/{print $4}' /etc/group\n$",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "grep -i 'pg_wheel' /etc/group",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_8": {
        "description": "2.2 Ensure the PostgreSQL pg_wheel group membership is correct - /etc/passwd",
        "info": "The group pg_wheel is explicitly created on a host where the PostgreSQL server is installed. Membership in this group enables an ordinary user account to gain 'superuser' access to a database cluster by using the sudo command (See 'Ensure sudo is configured correctly' later in this benchmark). Only user accounts authorized to have superuser access should be members of the pg_wheel group.\nRationale:\nUsers with unauthorized membership in the pg_wheel group can assume the privileges of the owner of the PostgreSQL RDBMS and administer the database, as well as accessing scripts, files, and other executables they should not be able to access.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If the pg_wheel group does not exist, use the following command to create it:\n$ whoami\nroot\n$ groupadd pg_wheel && getent group pg_wheel\npg_wheel:x:502:\nNote: that your system's group number may not be 502. That's OK.\nAdding the postgres user to the newly created group is done by issuing:\n$ whoami\nroot\n$ gpasswd -a postgres pg_wheel\nAdding user postgres to group pg_wheel\n$ # verify membership\n$ awk -F':' '/pg_wheel/{print $4}' /etc/group\npostgres\nRemoving a user account from the 'pg_wheel' group is achieved by executing the following command:\n$ whoami\nroot\n$ gpasswd -d pg_wheel postgres\nRemoving user postgres from group pg_wheel\n$ # verify the user was removed\n$ awk -F':' '/pg_wheel/{print $4}' /etc/group\n$",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|14.4,CSCv7|14.6,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "grep -i 'pg_wheel' /etc/passwd",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_9": {
        "description": "4.1 Ensure sudo is configured correctly",
        "info": "It is common to have more than one authorized individual administering the PostgreSQL service at the Operating System level. It is also quite common to permit login privileges to individuals on a PostgreSQL host who otherwise are not authorized to access the server's data cluster and files. Administering the PostgreSQL data cluster, as opposed to its data, is to be accomplished via a localhost login of a regular UNIX user account. Access to the postgres superuser account is restricted in such a manner as to interdict unauthorized access. sudo satisfies the requirements by escalating ordinary user account privileges as the PostgreSQL RDBMS superuser.\nRationale:\nWithout sudo, there would not be capabilities to strictly control access to the superuser account and to securely and authoritatively audit its use.",
        "solution": "As superuser root, execute the command visudo to edit the /etc/sudoers file so the following line is present:\n%pg_wheel ALL= /bin/su - postgres\nThis grants any Operating System user that is a member of the pg_wheel group to use sudo to become the postgres user.\nEnsure that all Operating System user's that need such access are members of the group as detailed earlier in this benchmark.",
        "reference": "800-171|3.1.1,800-53|AC-2(9),800-53r5|AC-2(9),CN-L3|8.1.4.2(c),CSCv6|5.8,CSCv7|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NIAv2|AM16,PCI-DSSv3.2.1|8.5,PCI-DSSv4.0|8.2.2,PCI-DSSv4.0|8.2.3,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "file": "/etc/sudoers",
        "regex": "^pg_wheel",
        "expect": "^pg_wheel[\\\\s]+ALL=[\\\\s]+/bin/su[\\\\s]+-[\\\\s]+postgres"
    },
    "custom_item_10": {
        "description": "4.2 Ensure excessive administrative privileges are revoked",
        "info": "With respect to PostgreSQL administrative SQL commands, only superusers should have elevated privileges. PostgreSQL regular, or application, users should not possess the ability to create roles, create new databases, manage replication, or perform any other action deemed privileged . Typically, regular users should only be granted the minimal set of privileges commensurate with managing the application:\n DDL (create table, create view, create index, etc.)\n DML (select, insert, update, delete)\nFurther, it has become best practice to create separate roles for DDL and DML. Given an application called 'payroll', one would create the following users:\n payroll_owner\n payroll_user\nAny DDL privileges would be granted to the 'payroll_owner' account only, while DML privileges would be given to the 'payroll_user' account only. This prevents accidental creation/altering/dropping of database objects by application code that run as the 'payroll_user' account.\nRationale:\nBy not restricting global administrative commands to superusers only, regular users granted excessive privileges may execute administrative commands with unintended and undesirable results.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If any regular or application users have been granted excessive administrative rights, those privileges should be removed immediately via the PostgreSQL ALTER ROLE SQL command. Using the same example above, the following SQL statements revoke all unnecessary elevated administrative privileges from the regular user appuser:\n$ whoami\npostgres\n$ psql -c 'ALTER ROLE appuser NOSUPERUSER;'\nALTER ROLE\n$ psql -c 'ALTER ROLE appuser NOCREATEROLE;'\nALTER ROLE\n$ psql -c 'ALTER ROLE appuser NOCREATEDB;'\nALTER ROLE\n$ psql -c 'ALTER ROLE appuser NOREPLICATION;'\nALTER ROLE\n$ psql -c 'ALTER ROLE appuser NOBYPASSRLS;'\nALTER ROLE\n$ psql -c 'ALTER ROLE appuser NOINHERIT;'\nALTER ROLE\nVerify the appuser now passes your check by having no defined Attributes:\n$ whoami\npostgres\n$ psql -c '\\du appuser'\n          List of roles\nRole name | Attributes | Member of\n----------+------------+-----------\nappuser   |            | {}",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "su - @PG_SUPER_USER@ -c \"psql -c \\'\\\\du *\\'\"",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_11": {
        "description": "6.7 Ensure FIPS 140-2 OpenSSL Cryptography Is Used - fips_enabled",
        "info": "Install, configure, and use OpenSSL on a platform that has a NIST certified FIPS 140-2 installation of OpenSSL. This provides PostgreSQL instances the ability to generate and validate cryptographic hashes to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owner's requirements.\nRationale:\nFederal Information Processing Standard (FIPS) Publication 140-2 is a computer security standard developed by a U.S. Government and industry working group for validating the quality of cryptographic modules. Use of weak, or untested, encryption algorithms undermine the purposes of utilizing encryption to protect data. PostgreSQL uses OpenSSL for the underlying encryption layer.\nThe database and application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated. It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.\nFor detailed information, refer to NIST FIPS Publication 140-2, Security Requirements for Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant. The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A. Currently only Red Hat Enterprise Linux is certified as a FIPS 140-2 distribution of OpenSSL. For other operating systems, users must obtain or build their own FIPS 140-2 OpenSSL libraries.",
        "solution": "Configure OpenSSL to be FIPS compliant. PostgreSQL uses OpenSSL for cryptographic modules. To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL Documentation. Below is a general summary of the steps required:\n Install the dracut-fips package\n$ yum -y install dracut-fips\nLoaded plugins: fastestmirror\nSetting up Install Process\nLoading mirror speeds from cached hostfile\n * base: mirror.cisp.com\n * extras: mirror.den1.denvercolo.net\n * updates: mirror.math.princeton.edu\nResolving Dependencies\n--> Running transaction check\n---> Package dracut-fips.noarch 0:004-411.el6 will be installed\n--> Processing Dependency: hmaccalc for package: dracut-fips-004-411.el6.noarch\n--> Running transaction check\n---> Package hmaccalc.x86_64 0:0.9.12-2.el6 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package              Arch            Version               Repository     Size\n================================================================================\nInstalling:\n dracut-fips          noarch          004-411.el6           base           38 k\nInstalling for dependencies:\n hmaccalc             x86_64          0.9.12-2.el6          base           22 k\n\nTransaction Summary\n================================================================================\nInstall       2 Package(s)\n\nTotal download size: 60 k\nInstalled size: 108 k\nDownloading Packages:\n(1/2): dracut-fips-004-411.el6.noarch.rpm                |  38 kB     00:00\n(2/2): hmaccalc-0.9.12-2.el6.x86_64.rpm                  |  22 kB     00:00\n--------------------------------------------------------------------------------\nTotal                                           334 kB/s |  60 kB     00:00\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : hmaccalc-0.9.12-2.el6.x86_64                                 1/2\n  Installing : dracut-fips-004-411.el6.noarch                               2/2\n  Verifying  : hmaccalc-0.9.12-2.el6.x86_64                                 1/2\n  Verifying  : dracut-fips-004-411.el6.noarch                               2/2\n\nInstalled:\n  dracut-fips.noarch 0:004-411.el6\n\nDependency Installed:\n  hmaccalc.x86_64 0:0.9.12-2.el6\n\nComplete!\n Recreate the initramfs file\n$ dracut -f\n Modify the kernel command line of the current kernel in the /boot/grub/grub.conf file by adding the following option: fips=1\n Reboot the system for changes to take effect.\n Verify fips_enabled according to Audit Procedure above.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "cat /proc/sys/crypto/fips_enabled",
        "expect": "1"
    },
    "custom_item_12": {
        "description": "6.7 Ensure FIPS 140-2 OpenSSL Cryptography Is Used - openssl version",
        "info": "Install, configure, and use OpenSSL on a platform that has a NIST certified FIPS 140-2 installation of OpenSSL. This provides PostgreSQL instances the ability to generate and validate cryptographic hashes to protect unclassified information requiring confidentiality and cryptographic protection, in accordance with the data owner's requirements.\nRationale:\nFederal Information Processing Standard (FIPS) Publication 140-2 is a computer security standard developed by a U.S. Government and industry working group for validating the quality of cryptographic modules. Use of weak, or untested, encryption algorithms undermine the purposes of utilizing encryption to protect data. PostgreSQL uses OpenSSL for the underlying encryption layer.\nThe database and application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated. It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.\nFor detailed information, refer to NIST FIPS Publication 140-2, Security Requirements for Cryptographic Modules. Note that the product's cryptographic modules must be validated and certified by NIST as FIPS-compliant. The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A. Currently only Red Hat Enterprise Linux is certified as a FIPS 140-2 distribution of OpenSSL. For other operating systems, users must obtain or build their own FIPS 140-2 OpenSSL libraries.",
        "solution": "Configure OpenSSL to be FIPS compliant. PostgreSQL uses OpenSSL for cryptographic modules. To configure OpenSSL to be FIPS 140-2 compliant, see the official RHEL Documentation. Below is a general summary of the steps required:\n Install the dracut-fips package\n$ yum -y install dracut-fips\nLoaded plugins: fastestmirror\nSetting up Install Process\nLoading mirror speeds from cached hostfile\n * base: mirror.cisp.com\n * extras: mirror.den1.denvercolo.net\n * updates: mirror.math.princeton.edu\nResolving Dependencies\n--> Running transaction check\n---> Package dracut-fips.noarch 0:004-411.el6 will be installed\n--> Processing Dependency: hmaccalc for package: dracut-fips-004-411.el6.noarch\n--> Running transaction check\n---> Package hmaccalc.x86_64 0:0.9.12-2.el6 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package              Arch            Version               Repository     Size\n================================================================================\nInstalling:\n dracut-fips          noarch          004-411.el6           base           38 k\nInstalling for dependencies:\n hmaccalc             x86_64          0.9.12-2.el6          base           22 k\n\nTransaction Summary\n================================================================================\nInstall       2 Package(s)\n\nTotal download size: 60 k\nInstalled size: 108 k\nDownloading Packages:\n(1/2): dracut-fips-004-411.el6.noarch.rpm                |  38 kB     00:00\n(2/2): hmaccalc-0.9.12-2.el6.x86_64.rpm                  |  22 kB     00:00\n--------------------------------------------------------------------------------\nTotal                                           334 kB/s |  60 kB     00:00\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : hmaccalc-0.9.12-2.el6.x86_64                                 1/2\n  Installing : dracut-fips-004-411.el6.noarch                               2/2\n  Verifying  : hmaccalc-0.9.12-2.el6.x86_64                                 1/2\n  Verifying  : dracut-fips-004-411.el6.noarch                               2/2\n\nInstalled:\n  dracut-fips.noarch 0:004-411.el6\n\nDependency Installed:\n  hmaccalc.x86_64 0:0.9.12-2.el6\n\nComplete!\n Recreate the initramfs file\n$ dracut -f\n Modify the kernel command line of the current kernel in the /boot/grub/grub.conf file by adding the following option: fips=1\n Reboot the system for changes to take effect.\n Verify fips_enabled according to Audit Procedure above.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "openssl version",
        "expect": "fips"
    },
    "custom_item_13": {
        "description": "7.4 Ensure WAL archiving is configured and functional - archive_command",
        "info": "Write Ahead Log (WAL) Archiving, or Log Shipping, is the process of sending transaction log files from the PRIMARY host either to one or more STANDBY hosts or to be archived on a remote storage device for later use, e.g. PITR. There are several utilities that can copy WALs including, but not limited to, cp, scp, sftp, and rynsc. Basically, the server follows a set of runtime parameters which defines when the WAL should be copied using one of the aforementioned utilities.\nRationale:\nUnless the server has been correctly configured, one runs the risk of sending WALs in an unsecured, unencrypted fashion.",
        "solution": "Change parameters and restart the server as required.\nNote: SSH public keys must be generated and installed as per industry standards.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "file": "@PG_CONF_FILE@",
        "regex": "^archive_command",
        "expect": "^archive_command = \\'.*ssh"
    },
    "custom_item_14": {
        "description": "7.4 Ensure WAL archiving is configured and functional - archive_mode",
        "info": "Write Ahead Log (WAL) Archiving, or Log Shipping, is the process of sending transaction log files from the PRIMARY host either to one or more STANDBY hosts or to be archived on a remote storage device for later use, e.g. PITR. There are several utilities that can copy WALs including, but not limited to, cp, scp, sftp, and rynsc. Basically, the server follows a set of runtime parameters which defines when the WAL should be copied using one of the aforementioned utilities.\nRationale:\nUnless the server has been correctly configured, one runs the risk of sending WALs in an unsecured, unencrypted fashion.",
        "solution": "Change parameters and restart the server as required.\nNote: SSH public keys must be generated and installed as per industry standards.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|14.2,CSCv7|14.4,CSF|PR.DS-2,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,LEVEL|1S,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "file": "@PG_CONF_FILE@",
        "regex": "^archive_mode",
        "expect": "^archive_mode[\\\\s]+=[\\\\s]+on"
    },
    "custom_item_15": {
        "description": "8.3 Ensure the backup and restore tool, 'pgBackRest', is installed and configured",
        "info": "pgBackRest aims to be a simple, reliable backup and restore system that can seamlessly scale up to the largest databases and workloads. Instead of relying on traditional backup tools like tar and rsync, pgBackRest implements all backup features internally and uses a custom protocol for communicating with remote systems. Removing reliance on tar and rsync allows for better solutions to database-specific backup challenges. The custom remote protocol allows for more flexibility and limits the types of connections that are required to perform a backup which increases security.\nRationale:\nThe native PostgreSQL backup facility pg_dump provides adequate logical backup operations but does not provide for Point In Time Recovery (PITR). The PostgreSQL facility pg_basebackup performs physical backup of the database files and does provide for PITR, but it is constrained by single threading. Both of these methodologies are standard in the PostgreSQL ecosystem and appropriate for particular backup/recovery needs. pgBackRest offers another option with much more robust features and flexibility.\npgBackRest is open source software developed to perform efficient backups on PostgreSQL databases that measure in tens of terabytes and greater. It supports per file checksums, compression, partial/failed backup resume, high-performance parallel transfer, asynchronous archiving, tablespaces, expiration, full/differential/incremental, local/remote operation via SSH, hard-linking, restore, backup encryption, and more. pgBackRest is written in C and Perl and does not depend on rsync or tar but instead performs its own deltas which gives it maximum flexibility. Finally, pgBackRest provides an easy to use internal repository listing backup details accessible via the pgbackrest info command, as illustrated below.\n$ pgbackrest info\nstanza: proddb01\nstatus: ok\ndb (current)\n  wal archive min/max (9.6-1): 000000010000000000000012 / 000000010000000000000017\n        full backup: 20181002-153106F\n            timestamp start/stop: 2018-10-02 15:31:06 / 2018-10-02 15:31:49\n            wal start/stop: 000000010000000000000012 / 000000010000000000000012\n            database size: 29.4MB, backup size: 29.4MB\n            repository size: 3.4MB, repository backup size: 3.4MB\n        diff backup: 20181002-153106F_20181002-173109D\n            timestamp start/stop: 2018-10-02 17:31:09 / 2018-10-02 17:31:19\n            wal start/stop: 000000010000000000000015 / 000000010000000000000015\n            database size: 29.4MB, backup size: 2.6MB\n            repository size: 3.4MB, repository backup size: 346.8KB\n            backup reference list: 20181002-153106F\n        incr backup: 20181002-153106F_20181002-183114I\n            timestamp start/stop: 2018-10-02 18:31:14 / 2018-10-02 18:31:22\n            wal start/stop: 000000010000000000000017 / 000000010000000000000017\n            database size: 29.4MB, backup size: 8.2KB\n            repository size: 3.4MB, repository backup size: 519B\n            backup reference list: 20181002-153106F, 20181002-153106F_20181002-173109D\n            NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "pgBackRest is not installed nor configured for PostgreSQL by default, but instead is maintained as a GitHub project. Fortunately, it is a part of the PGDG repository and can be easily installed:\n$ whoami\nroot\n$ yum -y install pgbackrest.x86_64\nLoaded plugins: fastestmirror\nSetting up Install Process\nLoading mirror speeds from cached hostfile\n * base: centos.mirrors.tds.net\n * extras: mirror.cs.vt.edu\n * updates: mirror.cs.pitt.edu\nResolving Dependencies\n--> Running transaction check\n---> Package pgbackrest.x86_64 0:2.05-1.rhel6 will be installed\n--> Processing Dependency: perl-parent for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-XML-LibXML for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-Time-HiRes for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-JSON for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-IO-Socket-SSL for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-Digest-SHA for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Processing Dependency: perl-DBD-Pg for package: pgbackrest-2.05-1.rhel6.x86_64\n--> Running transaction check\n---> Package perl-DBD-Pg.x86_64 0:2.15.1-4.el6_3 will be installed\n--> Processing Dependency: perl(DBI) for package: perl-DBD-Pg-2.15.1-4.el6_3.x86_64\n---> Package perl-Digest-SHA.x86_64 1:5.47-144.el6 will be installed\n---> Package perl-IO-Socket-SSL.noarch 0:1.31-3.el6_8.2 will be installed\n--> Processing Dependency: perl-Net-SSLeay >= 1.35-10.el6_8.1 for package: perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch\n--> Processing Dependency: perl(Net::LibIDN) for package: perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch\n---> Package perl-JSON.noarch 0:2.15-5.el6 will be installed\n--> Processing Dependency: perl(LWP::UserAgent) for package: perl-JSON-2.15-5.el6.noarch\n--> Processing Dependency: perl(HTTP::Daemon) for package: perl-JSON-2.15-5.el6.noarch\n---> Package perl-Time-HiRes.x86_64 4:1.9721-144.el6 will be installed\n---> Package perl-XML-LibXML.x86_64 1:1.70-5.el6 will be installed\n--> Processing Dependency: perl(XML::SAX::Exception) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64\n--> Processing Dependency: perl(XML::SAX::DocumentLocator) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64\n--> Processing Dependency: perl(XML::SAX::Base) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64\n--> Processing Dependency: perl(XML::NamespaceSupport) for package: 1:perl-XML-LibXML-1.70-5.el6.x86_64\n---> Package perl-parent.x86_64 1:0.221-144.el6 will be installed\n--> Running transaction check\n---> Package perl-DBI.x86_64 0:1.609-4.el6 will be installed\n---> Package perl-Net-LibIDN.x86_64 0:0.12-3.el6 will be installed\n---> Package perl-Net-SSLeay.x86_64 0:1.35-10.el6_8.1 will be installed\n---> Package perl-XML-NamespaceSupport.noarch 0:1.10-3.el6 will be installed\n---> Package perl-XML-SAX.noarch 0:0.96-7.el6 will be installed\n---> Package perl-libwww-perl.noarch 0:5.833-5.el6 will be installed\n--> Processing Dependency: perl-HTML-Parser >= 3.33 for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: perl(URI::URL) for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: perl(URI::Heuristic) for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: perl(URI) for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: perl(HTML::Entities) for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: perl(Compress::Zlib) for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Processing Dependency: mailcap for package: perl-libwww-perl-5.833-5.el6.noarch\n--> Running transaction check\n---> Package mailcap.noarch 0:2.1.31-2.el6 will be installed\n---> Package perl-Compress-Zlib.x86_64 0:2.021-144.el6 will be installed\n--> Processing Dependency: perl(IO::Uncompress::Gunzip) >= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64\n--> Processing Dependency: perl(IO::Compress::Gzip::Constants) >= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64\n--> Processing Dependency: perl(IO::Compress::Gzip) >= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64\n--> Processing Dependency: perl(IO::Compress::Base::Common) >= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64\n--> Processing Dependency: perl(Compress::Raw::Zlib) >= 2.021 for package: perl-Compress-Zlib-2.021-144.el6.x86_64\n---> Package perl-HTML-Parser.x86_64 0:3.64-2.el6 will be installed\n--> Processing Dependency: perl(HTML::Tagset) >= 3.03 for package: perl-HTML-Parser-3.64-2.el6.x86_64\n--> Processing Dependency: perl(HTML::Tagset) for package: perl-HTML-Parser-3.64-2.el6.x86_64\n---> Package perl-URI.noarch 0:1.40-2.el6 will be installed\n--> Running transaction check\n---> Package perl-Compress-Raw-Zlib.x86_64 1:2.021-144.el6 will be installed\n---> Package perl-HTML-Tagset.noarch 0:3.20-4.el6 will be installed\n---> Package perl-IO-Compress-Base.x86_64 0:2.021-144.el6 will be installed\n---> Package perl-IO-Compress-Zlib.x86_64 0:2.021-144.el6 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n===========================================================================================================\n Package                             Arch             Version                       Repository        Size\n===========================================================================================================\nInstalling:\n pgbackrest                          x86_64           2.05-1.rhel6                  pgdg96           203 k\nInstalling for dependencies:\n mailcap                             noarch           2.1.31-2.el6                  base              27 k\n perl-Compress-Raw-Zlib              x86_64           1:2.021-144.el6               base              70 k\n perl-Compress-Zlib                  x86_64           2.021-144.el6                 base              46 k\n perl-DBD-Pg                         x86_64           2.15.1-4.el6_3                base             196 k\n perl-DBI                            x86_64           1.609-4.el6                   base             705 k\n perl-Digest-SHA                     x86_64           1:5.47-144.el6                base              65 k\n perl-HTML-Parser                    x86_64           3.64-2.el6                    base             109 k\n perl-HTML-Tagset                    noarch           3.20-4.el6                    base              17 k\n perl-IO-Compress-Base               x86_64           2.021-144.el6                 base              70 k\n perl-IO-Compress-Zlib               x86_64           2.021-144.el6                 base             136 k\n perl-IO-Socket-SSL                  noarch           1.31-3.el6_8.2                base              70 k\n perl-JSON                           noarch           2.15-5.el6                    base              97 k\n perl-Net-LibIDN                     x86_64           0.12-3.el6                    base              35 k\n perl-Net-SSLeay                     x86_64           1.35-10.el6_8.1               base             174 k\n perl-Time-HiRes                     x86_64           4:1.9721-144.el6              base              49 k\n perl-URI                            noarch           1.40-2.el6                    base             117 k\n perl-XML-LibXML                     x86_64           1:1.70-5.el6                  base             364 k\n perl-XML-NamespaceSupport           noarch           1.10-3.el6                    base              17 k\n perl-XML-SAX                        noarch           0.96-7.el6                    base              78 k\n perl-libwww-perl                    noarch           5.833-5.el6                   base             390 k\n perl-parent                         x86_64           1:0.221-144.el6               base              28 k\n\nTransaction Summary\n===========================================================================================================\nInstall      22 Package(s)\n\nTotal download size: 3.0 M\nInstalled size: 7.5 M\nDownloading Packages:\n(1/22): mailcap-2.1.31-2.el6.noarch.rpm                                             |  27 kB     00:00\n(2/22): perl-Compress-Raw-Zlib-2.021-144.el6.x86_64.rpm                             |  70 kB     00:00\n(3/22): perl-Compress-Zlib-2.021-144.el6.x86_64.rpm                                 |  46 kB     00:00\n(4/22): perl-DBD-Pg-2.15.1-4.el6_3.x86_64.rpm                                       | 196 kB     00:00\n(5/22): perl-DBI-1.609-4.el6.x86_64.rpm                                             | 705 kB     00:00\n(6/22): perl-Digest-SHA-5.47-144.el6.x86_64.rpm                                     |  65 kB     00:00\n(7/22): perl-HTML-Parser-3.64-2.el6.x86_64.rpm                                      | 109 kB     00:00\n(8/22): perl-HTML-Tagset-3.20-4.el6.noarch.rpm                                      |  17 kB     00:00\n(9/22): perl-IO-Compress-Base-2.021-144.el6.x86_64.rpm                              |  70 kB     00:00\n(10/22): perl-IO-Compress-Zlib-2.021-144.el6.x86_64.rpm                             | 136 kB     00:00\n(11/22): perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch.rpm                               |  70 kB     00:00\n(12/22): perl-JSON-2.15-5.el6.noarch.rpm                                            |  97 kB     00:00\n(13/22): perl-Net-LibIDN-0.12-3.el6.x86_64.rpm                                      |  35 kB     00:00\n(14/22): perl-Net-SSLeay-1.35-10.el6_8.1.x86_64.rpm                                 | 174 kB     00:00\n(15/22): perl-Time-HiRes-1.9721-144.el6.x86_64.rpm                                  |  49 kB     00:00\n(16/22): perl-URI-1.40-2.el6.noarch.rpm                                             | 117 kB     00:00\n(17/22): perl-XML-LibXML-1.70-5.el6.x86_64.rpm                                      | 364 kB     00:00\n(18/22): perl-XML-NamespaceSupport-1.10-3.el6.noarch.rpm                            |  17 kB     00:00\n(19/22): perl-XML-SAX-0.96-7.el6.noarch.rpm                                         |  78 kB     00:00\n(20/22): perl-libwww-perl-5.833-5.el6.noarch.rpm                                    | 390 kB     00:00\n(21/22): perl-parent-0.221-144.el6.x86_64.rpm                                       |  28 kB     00:00\n(22/22): pgbackrest-2.05-1.rhel6.x86_64.rpm                                         | 203 kB     00:00\n-----------------------------------------------------------------------------------------------------------\nTotal                                                                      1.1 MB/s | 3.0 MB     00:02\nRunning rpm_check_debug\nRunning Transaction Test\nTransaction Test Succeeded\nRunning Transaction\n  Installing : perl-IO-Compress-Base-2.021-144.el6.x86_64                                             1/22\n  Installing : 1:perl-Compress-Raw-Zlib-2.021-144.el6.x86_64                                          2/22\n  Installing : perl-XML-NamespaceSupport-1.10-3.el6.noarch                                            3/22\n  Installing : 1:perl-XML-LibXML-1.70-5.el6.x86_64                                                    4/22\n  Installing : perl-XML-SAX-0.96-7.el6.noarch                                                         5/22\n  Installing : perl-IO-Compress-Zlib-2.021-144.el6.x86_64                                             6/22\n  Installing : perl-Compress-Zlib-2.021-144.el6.x86_64                                                7/22\n  Installing : 1:perl-Digest-SHA-5.47-144.el6.x86_64                                                  8/22\n  Installing : 1:perl-parent-0.221-144.el6.x86_64                                                     9/22\n  Installing : perl-DBI-1.609-4.el6.x86_64                                                           10/22\n  Installing : perl-DBD-Pg-2.15.1-4.el6_3.x86_64                                                     11/22\n  Installing : perl-HTML-Tagset-3.20-4.el6.noarch                                                    12/22\n  Installing : perl-HTML-Parser-3.64-2.el6.x86_64                                                    13/22\n  Installing : perl-URI-1.40-2.el6.noarch                                                            14/22\n  Installing : perl-Net-LibIDN-0.12-3.el6.x86_64                                                     15/22\n  Installing : mailcap-2.1.31-2.el6.noarch                                                           16/22\n  Installing : perl-libwww-perl-5.833-5.el6.noarch                                                   17/22\n  Installing : perl-JSON-2.15-5.el6.noarch                                                           18/22\n  Installing : 4:perl-Time-HiRes-1.9721-144.el6.x86_64                                               19/22\n  Installing : perl-Net-SSLeay-1.35-10.el6_8.1.x86_64                                                20/22\n  Installing : perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch                                              21/22\n  Installing : pgbackrest-2.05-1.rhel6.x86_64                                                        22/22\n  Verifying  : perl-Compress-Zlib-2.021-144.el6.x86_64                                                1/22\n  Verifying  : perl-Net-SSLeay-1.35-10.el6_8.1.x86_64                                                 2/22\n  Verifying  : pgbackrest-2.05-1.rhel6.x86_64                                                         3/22\n  Verifying  : 4:perl-Time-HiRes-1.9721-144.el6.x86_64                                                4/22\n  Verifying  : mailcap-2.1.31-2.el6.noarch                                                            5/22\n  Verifying  : perl-Net-LibIDN-0.12-3.el6.x86_64                                                      6/22\n  Verifying  : perl-libwww-perl-5.833-5.el6.noarch                                                    7/22\n  Verifying  : perl-XML-NamespaceSupport-1.10-3.el6.noarch                                            8/22\n  Verifying  : perl-DBD-Pg-2.15.1-4.el6_3.x86_64                                                      9/22\n  Verifying  : perl-HTML-Parser-3.64-2.el6.x86_64                                                    10/22\n  Verifying  : 1:perl-XML-LibXML-1.70-5.el6.x86_64                                                   11/22\n  Verifying  : 1:perl-Compress-Raw-Zlib-2.021-144.el6.x86_64                                         12/22\n  Verifying  : perl-IO-Socket-SSL-1.31-3.el6_8.2.noarch                                              13/22\n  Verifying  : perl-URI-1.40-2.el6.noarch                                                            14/22\n  Verifying  : perl-IO-Compress-Base-2.021-144.el6.x86_64                                            15/22\n  Verifying  : perl-HTML-Tagset-3.20-4.el6.noarch                                                    16/22\n  Verifying  : perl-DBI-1.609-4.el6.x86_64                                                           17/22\n  Verifying  : perl-XML-SAX-0.96-7.el6.noarch                                                        18/22\n  Verifying  : 1:perl-parent-0.221-144.el6.x86_64                                                    19/22\n  Verifying  : 1:perl-Digest-SHA-5.47-144.el6.x86_64                                                 20/22\n  Verifying  : perl-IO-Compress-Zlib-2.021-144.el6.x86_64                                            21/22\n  Verifying  : perl-JSON-2.15-5.el6.noarch                                                           22/22\n\nInstalled:\n  pgbackrest.x86_64 0:2.05-1.rhel6\n\nDependency Installed:\n  mailcap.noarch 0:2.1.31-2.el6                       perl-Compress-Raw-Zlib.x86_64 1:2.021-144.el6\n  perl-Compress-Zlib.x86_64 0:2.021-144.el6           perl-DBD-Pg.x86_64 0:2.15.1-4.el6_3\n  perl-DBI.x86_64 0:1.609-4.el6                       perl-Digest-SHA.x86_64 1:5.47-144.el6\n  perl-HTML-Parser.x86_64 0:3.64-2.el6                perl-HTML-Tagset.noarch 0:3.20-4.el6\n  perl-IO-Compress-Base.x86_64 0:2.021-144.el6        perl-IO-Compress-Zlib.x86_64 0:2.021-144.el6\n  perl-IO-Socket-SSL.noarch 0:1.31-3.el6_8.2          perl-JSON.noarch 0:2.15-5.el6\n  perl-Net-LibIDN.x86_64 0:0.12-3.el6                 perl-Net-SSLeay.x86_64 0:1.35-10.el6_8.1\n  perl-Time-HiRes.x86_64 4:1.9721-144.el6             perl-URI.noarch 0:1.40-2.el6\n  perl-XML-LibXML.x86_64 1:1.70-5.el6                 perl-XML-NamespaceSupport.noarch 0:1.10-3.el6\n  perl-XML-SAX.noarch 0:0.96-7.el6                    perl-libwww-perl.noarch 0:5.833-5.el6\n  perl-parent.x86_64 1:0.221-144.el6\n\nComplete!\nOnce installed, pgBackRest must be configured for things like stanza name, backup location, retention policy, logging, etc. Please consult the configuration guide.\nIf employing pgBackRest for your backup/recovery solution, ensure the repository, base backups, and WAL archives are stored on a reliable file system separate from the database server. Further, the external storage system where backups resided should have limited access to only those system administrators as necessary. Finally, as with any backup/recovery solution, stringent testing must be conducted. A backup is only good if it can be restored successfully.",
        "reference": "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSCv6|10,CSCv7|10.1,CSCv7|10.2,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,LEVEL|1NS,NESA|M5.2.3,NESA|T2.2.4",
        "see_also": "https://workbench.cisecurity.org/files/2235",
        "cmd": "su - @PG_SUPER_USER@ -c \"pgbackrest info\"",
        "expect": "MANUAL_REVIEW"
    }
}