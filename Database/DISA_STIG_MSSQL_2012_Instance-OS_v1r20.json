{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Full-text Filter Daemon Launcher'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Full-text Filter Daemon Launcher (%)'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_3": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Full-text Filter Daemon Launcher'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@FULLTEXT_SVC_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Full-text Filter Daemon Launcher (%)'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_4": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server (%)'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_5": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_SVC_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server (%)'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_6": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Agent'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Agent (%)'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_7": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Agent'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_AGENT_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Agent (%)'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_8": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Analysis Services'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Analysis Services (%)'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_9": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Analysis Services'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_ANALYSIS_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Analysis Services (%)'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_10": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Browser'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Browser'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_11": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Browser'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_BROWSER_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Browser'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_12": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Distributed Replay Client'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Distributed Replay Client'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_13": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Distributed Replay Client'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_DRC_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Distributed Replay Client'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_14": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Distributed Replay Controller'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Distributed Replay Controller'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_15": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Distributed Replay Controller'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_DRCONT_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Distributed Replay Controller'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_16": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Integration Services 11.0'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Integration Services 11.0'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_17": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Integration Services 11.0'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_INT_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Integration Services 11.0'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_18": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server Reporting Services'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Reporting Services (%)'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_19": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server Reporting Services'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_RPT_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server Reporting Services (%)'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_20": {
        "description": "SQL2-00-008900 - SQL Server procs or svcs must run under dedicated OS accounts - 'SQL Server VSS Writer'",
        "value_data": "",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server VSS Writer'",
        "wmi_attribute": "DisplayName",
        "wmi_key": "DisplayName"
    },
    "custom_item_21": {
        "description": "SQL2-00-008900 - SQL Server processes or services must run under custom, dedicated OS or domain accounts - 'SQL Server VSS Writer'",
        "info": "Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action.\n\nThe concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS's settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.",
        "solution": "Configure the SQL Server services to use a custom, dedicated OS or domain account.",
        "reference": "800-171|3.1.4,800-171|3.4.2,800-53|AC-5c.,800-53|CM-6b.,800-53r5|AC-5c.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002220,CN-L3|8.1.10.6(d),CSF|PR.DS-5,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ITSG-33|AC-5c.,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-53422r4_rule,STIG-ID|SQL2-00-008900,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41047",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@SQL_VSS_ACCT@",
        "wmi_namespace": "root/cimv2",
        "wmi_request": "SELECT DisplayName,StartName FROM Win32_Service WHERE DisplayName like 'SQL Server VSS Writer'",
        "wmi_attribute": "StartName",
        "wmi_key": "DisplayName"
    },
    "custom_item_22": {
        "description": "SQL2-00-013600 - SQL Server must protect audit information from any type of unauthorized access.",
        "info": "If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\nSQL Server and third-party tools are examples of applications that are easily able to view and manipulate audit file data. Additionally, applications with user interfaces to audit records should not allow unfettered manipulation of, or access to, those records via any application. If an application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.\n\nThis requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, and limiting log data location.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.",
        "solution": "Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need 'Read & Execute' rather than 'Read' alone.)\n\nModify audit file permissions to meet the requirement to protect against unauthorized access.\n\nNavigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties.\nOn the Security tab, modify the security permissions to:\nAdministrator(read)\nUsers (none)\nAudit Administrator(Full Control)\nAuditors group (Read)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]\n\n\n-----\n\nNote 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\n\nNote 2:  Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'.  (What you have just typed in is the first 16 characters of the name.  At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53390r5_rule,STIG-ID|SQL2-00-013600,Vuln-ID|V-41016",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLLog",
        "file": "@MSSQL_LOG_DIR@"
    },
    "custom_item_23": {
        "description": "SQL2-00-014400 - SQL Server must protect the audit records generated as a result of remote access to privileged accounts and by the execution of privileged functions.",
        "info": "Protection of audit records and audit data is of critical importance. Care must be taken to ensure privileged users cannot circumvent audit protections put in place.\n\nAuditing might not be reliable when performed by an information system that the user being audited has privileged access to.\n\nThe privileged user could inhibit auditing or directly modify audit records. To prevent this from occurring, privileged access shall be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges.\n\nReducing the risk of audit compromises by privileged users can also be achieved, for example, by performing audit activity on a separate information system where the user in question has limited access, or by using storage media that cannot be modified (e.g., write-once recording devices).\n\nIf an attacker were to gain access to audit tools, they could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity.",
        "solution": "Modify audit file permissions to meet the requirement to protect against unauthorized access.\n\nNavigate to the audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties.\nOn the Security tab, modify the security permissions to:\nAdministrator(read)\nUsers (none)\nAudit Administrator(Full Control)\nAuditors group (Read)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]\n\n-----\n\nNote 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\n\nNote 2:  Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'.  (What you have just typed in is the first 16 characters of the name.  At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AU-9(4),800-53|CM-6b.,800-53r5|AU-9(4),800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-001351,CN-L3|8.1.4.3(d),CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|CM-6b.,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53391r4_rule,STIG-ID|SQL2-00-014400,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-41017",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLLog",
        "file": "@MSSQL_LOG_DIR@"
    },
    "custom_item_24": {
        "description": "SQL2-00-013700 - SQL Server must protect audit information from unauthorized modification.",
        "info": "If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized modification.\n\nThis requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions, and limiting log data locations.\n\nApplications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make decisions regarding the modification of audit data.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nModification of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.",
        "solution": "Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need 'Read & Execute' rather than 'Read' alone.)\n\nModify audit file permissions to meet the requirement to protect against unauthorized modification.\n\nNavigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties. On the Security tab, modify the security permissions to:\nAdministrator(read)\nUsers (none)\nAudit Administrator(Full Control)\nAuditors group (Read)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]\n\n-----\n\nNote 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\n\nNote 2:  Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'.  (What you have just typed in is the first 16 characters of the name.  At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|III,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53307r5_rule,STIG-ID|SQL2-00-013700,Vuln-ID|V-40953",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLLog",
        "file": "@MSSQL_LOG_DIR@"
    },
    "custom_item_25": {
        "description": "SQL2-00-013800 - SQL Server must protect audit information from unauthorized deletion.",
        "info": "If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design.\n\nSome commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained.\n\nApplications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make decisions regarding the deletion of audit data.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nDeletion of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.",
        "solution": "Modify audit file permissions to meet the requirement to protect against unauthorized deletion.\n\nNavigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties.\nOn the Security tab, modify the security permissions to:\nAdministrator(read)\nUsers (none)\nAudit Administrator(Full Control)\nAuditors group (Read)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]\n\n-----\n\nNote 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\n\nNote 2:  Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'.  (What you have just typed in is the first 16 characters of the name.  At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|III,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53306r4_rule,STIG-ID|SQL2-00-013800,Vuln-ID|V-40952",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLLog",
        "file": "@MSSQL_LOG_DIR@"
    },
    "custom_item_26": {
        "description": "SQL2-00-014700 - SQL Server must support the employment of automated mechanisms supporting the auditing of the enforcement actions.",
        "info": "Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals are allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nAccess restrictions for change also include software libraries.\n\nExamples of access restrictions include: physical access controls (such as locks and access cards), logical access controls (such as ACLs), automated auditing (logging) of logical access, workflow automation, media libraries, abstract layers (e.g., changes are implemented into a third-party interface rather than directly into the information system component), and change windows (e.g., changes occur only during specified times, making unauthorized changes outside the window easy to discover).\n\nThis requirement focuses on the auditing aspect of the protections.",
        "solution": "Navigate to Advanced Security Settings by selecting Properties > Security > Advanced > Auditing > Continue.\n\nWhere 'Everyone' is missing from the 'Name' column, click the Add button; type 'Everyone' in the object names box; click the OK button.  The Auditing Entry dialog opens.\n\nWhere 'Everyone' is in the 'Name' column, select that row and click on the Edit button.  The Auditing Entry dialog opens.\n\nIn the Auditing Entry dialog, set 'Apply onto' to 'This folder, subfolders and files'.\n\nIn the Auditing Entry dialog, select both the Successful and the Failed checkbox for each of the following access types, where not already selected:\n    Traverse folder/execute file\n    List folder/read data\n    Read attributes\n    Read extended attributes\n    Create files/write data\n    Create folders/append data\n    Write attributes\n    Write extended attributes\n    Delete\n    Read permissions\n\nClick OK, OK, OK, OK to save the new settings and exit the dialog boxes.",
        "reference": "800-171|3.4.5,800-53|CM-5(1),800-53r5|CM-5(1),CAT|II,CCI|CCI-001814,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-53304r3_rule,STIG-ID|SQL2-00-014700,Vuln-ID|V-40950",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLLog",
        "file": "@MSSQL_LOG_DIR@"
    },
    "custom_item_27": {
        "description": "SQL2-00-015800 - The OS must limit privileges to change SQL Server software resident within software libraries (including privileged programs) - 'binn'",
        "info": "When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.\n\nIf any user were allowed to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.  The DBMS software libraries contain the executables used by the DBMS to operate. Unauthorized access to the libraries can result in compromised installations. This may in turn jeopardize data stored in the DBMS and/or operation of the host system.\n\nAccordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nOf particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored.",
        "solution": "Navigate to the SQL Server software directory (\\binn) location. Right-click the folder, click Properties. On the Security tab, modify the security permissions, so that files and folders that are part of the SQL Server 2012 installation have at most the following privileges. Right-click each folder under the installation folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSYSTEM (Full Control)\nAdministrators (Full Control) [See Note 3]\nUsers (Read, List Folder Contents, Read & Execute)\nCreator Owner (Special Permissions - Full control - Subfolders and files only)\nAll Application Packages (Read & Execute) [Only as needed - see Note 4]\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Full Control) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nRepeat the above for the \\Install folder.\n\nNavigate to the ...\\Microsoft SQL Server\\110\\Shared folder. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSystem (Full Control)\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nLocal Administrators (Read)\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Write) [Notes 1, 2]\nUsers (Read, List Folder Contents, Read & Execute)\n[MsDtsServer110 (Read & Execute) is also permitted, if SSIS/DTS is in use.]\n[NT AUTHORITY\\NETWORK SERVICE (Read & Execute) may also be required for SQL Server Configuration Manager to operate.]\n\n-----\n\nNote 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\nNote 2: Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'. (What you have just typed in is the first 16 characters of the name. At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click 'OK'\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click 'OK'\n8) Click 'OK'\n9) Permission like a normal user from here\n\nNote 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.\n\nNote 4: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\\Microsoft SQL Server\\110\\ directory.)",
        "reference": "800-171|3.3.8,800-171|3.4.5,800-53|AU-9,800-53|CM-5(6),800-53r5|AU-9,800-53r5|CM-5(6),CAT|II,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001499,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|CM-5(6),NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.3,NESA|T3.6.4,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53298r8_rule,STIG-ID|SQL2-00-015800,Vuln-ID|V-40944",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLSoftware",
        "file": "@MSSQL_PROGRAM_DIR@\\MSSQL\\binn"
    },
    "custom_item_28": {
        "description": "SQL2-00-015800 - The OS must limit privileges to change SQL Server software resident within software libraries (including privileged programs) - 'Install'",
        "info": "When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.\n\nIf any user were allowed to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.  The DBMS software libraries contain the executables used by the DBMS to operate. Unauthorized access to the libraries can result in compromised installations. This may in turn jeopardize data stored in the DBMS and/or operation of the host system.\n\nAccordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nOf particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored.",
        "solution": "Navigate to the SQL Server software directory (\\binn) location. Right-click the folder, click Properties. On the Security tab, modify the security permissions, so that files and folders that are part of the SQL Server 2012 installation have at most the following privileges. Right-click each folder under the installation folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSYSTEM (Full Control)\nAdministrators (Full Control) [See Note 3]\nUsers (Read, List Folder Contents, Read & Execute)\nCreator Owner (Special Permissions - Full control - Subfolders and files only)\nAll Application Packages (Read & Execute) [Only as needed - see Note 4]\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Full Control) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nRepeat the above for the \\Install folder.\n\nNavigate to the ...\\Microsoft SQL Server\\110\\Shared folder. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSystem (Full Control)\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nLocal Administrators (Read)\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Write) [Notes 1, 2]\nUsers (Read, List Folder Contents, Read & Execute)\n[MsDtsServer110 (Read & Execute) is also permitted, if SSIS/DTS is in use.]\n[NT AUTHORITY\\NETWORK SERVICE (Read & Execute) may also be required for SQL Server Configuration Manager to operate.]\n\n-----\n\nNote 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\nNote 2: Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'. (What you have just typed in is the first 16 characters of the name. At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click 'OK'\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click 'OK'\n8) Click 'OK'\n9) Permission like a normal user from here\n\nNote 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.\n\nNote 4: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\\Microsoft SQL Server\\110\\ directory.)",
        "reference": "800-171|3.3.8,800-171|3.4.5,800-53|AU-9,800-53|CM-5(6),800-53r5|AU-9,800-53r5|CM-5(6),CAT|II,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001499,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|CM-5(6),NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.3,NESA|T3.6.4,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53298r8_rule,STIG-ID|SQL2-00-015800,Vuln-ID|V-40944",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLSoftware",
        "file": "@MSSQL_PROGRAM_DIR@\\MSSQL\\Install"
    },
    "custom_item_29": {
        "description": "SQL2-00-015800 - The OS must limit privileges to change SQL Server software resident within software libraries (including privileged programs) - '\\110\\Shared'",
        "info": "When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.\n\nIf any user were allowed to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.  The DBMS software libraries contain the executables used by the DBMS to operate. Unauthorized access to the libraries can result in compromised installations. This may in turn jeopardize data stored in the DBMS and/or operation of the host system.\n\nAccordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nOf particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored.",
        "solution": "Navigate to the SQL Server software directory (\\binn) location. Right-click the folder, click Properties. On the Security tab, modify the security permissions, so that files and folders that are part of the SQL Server 2012 installation have at most the following privileges. Right-click each folder under the installation folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSYSTEM (Full Control)\nAdministrators (Full Control) [See Note 3]\nUsers (Read, List Folder Contents, Read & Execute)\nCreator Owner (Special Permissions - Full control - Subfolders and files only)\nAll Application Packages (Read & Execute) [Only as needed - see Note 4]\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Full Control) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nRepeat the above for the \\Install folder.\n\nNavigate to the ...\\Microsoft SQL Server\\110\\Shared folder. On the Security tab, modify the security permissions, so that at most the following permissions are present:\nTrusted Installer (Full Control)\nCREATOR OWNER (Full Control)\nSystem (Full Control)\nSQL Server Service SID OR Service Account (Read & Execute) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nLocal Administrators (Read)\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Write) [Notes 1, 2]\nUsers (Read, List Folder Contents, Read & Execute)\n[MsDtsServer110 (Read & Execute) is also permitted, if SSIS/DTS is in use.]\n[NT AUTHORITY\\NETWORK SERVICE (Read & Execute) may also be required for SQL Server Configuration Manager to operate.]\n\n-----\n\nNote 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\nNote 2: Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'. (What you have just typed in is the first 16 characters of the name. At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click 'OK'\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click 'OK'\n8) Click 'OK'\n9) Permission like a normal user from here\n\nNote 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.\n\nNote 4: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\\Microsoft SQL Server\\110\\ directory.)",
        "reference": "800-171|3.3.8,800-171|3.4.5,800-53|AU-9,800-53|CM-5(6),800-53r5|AU-9,800-53r5|CM-5(6),CAT|II,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001499,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|CM-5(6),NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.3,NESA|T3.6.4,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-53298r8_rule,STIG-ID|SQL2-00-015800,Vuln-ID|V-40944",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLSoftware",
        "file": "C:\\Program Files\\Microsoft SQL Server\\110\\Shared"
    },
    "custom_item_30": {
        "description": "SQL2-00-016500 - SQL Server must have the SQL Server Data Tools (SSDT) software component removed from SQL Server if SSDT is unused.",
        "info": "Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled.\n\nApplications must adhere to the principles of least functionality by providing only essential capabilities.\n\nUnused and unnecessary DBMS components increase the attack vector for the DBMS by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced.\n\n\nSQL Server must have the SQL Server Data Tools (SSDT) software component removed from SQL Server if SSDT is unused.",
        "solution": "Document the requirement for SQL Server Data Tools to reside on this server.\n\nIf it is not required, using an account with System Administrator privileges, from Command Prompt, open control.exe.\n\nNavigate to Programs and Features. Remove the following entries in the 'Uninstall or change a program' window.\n\nMicrosoft SQL Server Data Tools - Database Projects - Web installer entry point\nPrerequisites for SSDT",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|I,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-53295r2_rule,STIG-ID|SQL2-00-016500,SWIFT-CSCv1|2.3,Vuln-ID|V-40941",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "HKCR\\Installer\\Products\\F65CBB3F2822464459F28A792781F103"
    },
    "custom_item_31": {
        "description": "SQL2-00-016600 - SQL Server must have the SQL Server Report Service removed if SSRS is unused",
        "value_data": "HKLM\\SYSTEM\\CurrentControlSet\\services\\ReportServer"
    },
    "custom_item_32": {
        "description": "SQL2-00-016700 - SQL Server must have the Integrated Services software removed if SSIS is unused",
        "value_data": "HKLM\\SYSTEM\\CurrentControlSet\\services\\MsDtsServer110"
    },
    "custom_item_33": {
        "description": "SQL2-00-016800 - SQL Server must have the SQL Server Analysis Service (SSAS) software component removed from SQL Server if SSAS is unused.",
        "value_data": "HKLM\\SYSTEM\\CurrentControlSet\\services\\MSSQLServerOLAPService"
    },
    "custom_item_34": {
        "description": "SQL2-00-020100 - SQL Server must protect the integrity of publicly available information and applications.",
        "info": "The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls. If SQL Server contains publicly available information, though not concerned with confidentiality, SQL Server OS must maintain the integrity of the data. If data available to the public is not protected from unauthorized modification or deletion, then the data cannot be trusted by those accessing it.\n\nThe user account associated with public access must not have access to the OS configuration information. Determine what publicly available user account is being used to access SQL Server and validate that the publicly available user account only has read access to the public data and nothing else.\n\nThe OS level 'Guests' role grants connection access to the server without granting any other privileges. SQL Server configuration settings are used to grant access to the publicly available information, but this control ensures that the OS only is granted connection access to the server.\n\nThis requirement is not intended to prevent the establishment of public-facing systems for the purpose of collecting data from the public.",
        "solution": "Using an account with System Administrator privileges, from a command prompt, type lusrmgr.msc, and press [ENTER].\nNavigate to Groups.\n\nLocate the additional group(s) from which the publicly available user account must be removed.\n\nRight click <'the group to modify' >> Properties >> 'Members:'\n\nRemove the publicly available user account from the group by clicking/highlighting the account and then clicking the 'Remove' button.\n\nRevoke any update permissions for a guest being used in the context of a guest account.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-53269r3_rule,STIG-ID|SQL2-00-020100,SWIFT-CSCv1|2.3,Vuln-ID|V-40915",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "@PUB_ACCT@",
        "group_name": "Guests"
    },
    "custom_item_35": {
        "description": "SQL2-00-025100 - The OS must limit privileges to the SQL Server Data Root directory and its subordinate directories and files.",
        "info": "Default database file locations should be protected from unauthorized access.  The system databases, essential to SQL Server operation, are typically located here.",
        "solution": "Navigate to the identified folder location(s). Right-click the folder, click Properties. On the Security tab, modify the security permissions so that files and folders have at most the permissions listed below. Right-click each folder under the identified folder(s), click Properties. On the Security tab, modify the security permissions so that at most the following permissions are present.\nCREATOR OWNER (Full Control)\nSystem (Full control)\nSQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]\nSystem Administrators (Full Control) [Note 3]\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2, 4]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Execute, Write) [Notes 1, 2]\n\n-----\n\nNote 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\nNote 2: Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'. (What you have just typed in is the first 16 characters of the name. At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here\n\nNote 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.\n\nNote 4: It may also be necessary to grant the SQL Server Agent permission to Delete the \\Log directory and its contents.",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-69105r5_rule,STIG-ID|SQL2-00-025100,Vuln-ID|V-54859",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLDataDir",
        "file": "@MSSQL_DATA_DIR@"
    },
    "custom_item_36": {
        "description": "SQL2-00-025200 - The OS must limit privileges to the SQL Server data directories and their subordinate directories and files.",
        "info": "Database files must be protected from unauthorized access.  Although default data locations are created at installation time, sites can, and will, use other directories for site-created database files to comply with best practices.",
        "solution": "Navigate to the identified folder location(s).  Right-click the folder, click Properties.  On the Security tab, modify the security permissions so that files and folders have at most the permissions listed below. Right-click each folder under the identified folder(s), click Properties. On the Security tab, modify the security permissions so that at most the following permissions are present.\nCREATOR OWNER (Full Control)\nSystem (Full control)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]\nSystem Administrators (Full Control)  [Note 3]\n\n\n-----\n\nNote 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\n\nNote 2:  Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'.  (What you have just typed in is the first 16 characters of the name.  At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click OK\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click OK\n8) Click OK\n9) Permission like a normal user from here\n\n\nNote 3:  In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-69125r3_rule,STIG-ID|SQL2-00-025200,Vuln-ID|V-54879",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLDataDir",
        "file": "@MSSQL_DB_DIR@"
    },
    "custom_item_37": {
        "description": "SQL2-00-025300 - The OS must limit privileges to the SQL Server backup directories and files.",
        "info": "Backups must be protected from unauthorized deletion and modification.  They must also be protected from unauthorized use in database restoration.",
        "solution": "Navigate to the SQL Server backup directory location.  Right-click the folder, click Properties.  On the Security tab, modify the security permissions, so that files and folders have at most the permissions listed below. Right-click each folder under the SQL Server backup folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present.\nCREATOR OWNER (Full Control)\nSystem (Full control)\nSQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]\nSQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]\nSQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]\nSystem Administrators (Full Control)  [Note 3]\nSQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read & Execute) [Notes 1, 2]\n\n\n-----\n\nNote 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx.\n\nNote 2: Tips for adding a service SID/virtual account to a folder's permission list.\n1) In Windows Explorer, right-click on the folder and select 'Properties.'\n2) Select the 'Security' tab\n3) Click 'Edit'\n4) Click 'Add'\n5) Click 'Locations'\n6) Select the computer name\n7) Search for the name\n7.a) SQL Server Service\n7.a.i) Type 'NT SERVICE\\MSSQL' and click 'Check Names'. (What you have just typed in is the first 16 characters of the name. At least one character must follow 'NT SERVICE\\'; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)\n7.a.ii) Select the 'MSSQL$' user and click 'OK'\n7.b) SQL Agent Service\n7.b.i) Type 'NT SERVICE\\SQL' and click 'Check Names'\n7.b.ii) Select the 'SQLAgent$' user and click 'OK'\n8) Click 'OK'\n9) Permission like a normal user from here\n\nNote 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MS_SQL_Server_Installation_2012,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-69127r4_rule,STIG-ID|SQL2-00-025300,Vuln-ID|V-54881",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_SQL_Server_2012_V1R20_STIG.zip",
        "value_data": "MSSQLDataDir",
        "file": "@MSSQL_DB_BU_DIR@"
    }
}