{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "5.3.1 Remove operating system related ESPs - sybsyesp.dll",
        "info": "Sybase ASE installs a number of powerful ESPs that allow interaction with the operating\nsystem. A common target for an attacker is the xp_cmdshell ESP, which executes a native\noperating system command on the host system running Sybase ASE.\n\nThe operating system user context under which the command executes is controlled by the\nxp_cmdshell context configuration parameter. Though by default, this is set to only\npermit execution by users with System Administration privileges at the operating system\nlevel, it should be noted that this is insufficient since an attacker who compromised an\naccount with the sa_role could reconfigure the configuration parameter so that\nxp_cmdshell executes commands under the user context that the database server itself is\nrunning as.\n\nBy default, execution of the xp_cmdshell ESP is restricted to users with the sa_role. It is\nrecommended that it is removed, along with the other operating system related ESPs;\nxp_freedll, xp_logevent (Windows only) and xp_enumgroups (Windows only).\n\nFurthermore the library that houses each of these ESPs, sybsyesp.dll (Windows) or\nsybsyesp.so (Unix), should be deleted from the file system to prevent them from being\nrecreated by an attacker.\n\nRationale:\n\nThe xp_cmdshell ESP provides a clear path for privilege escalation from the database to the\noperating system. An attacker could use this functionality in conjunction with a SQL\ninjection attack to gain a foothold on the database host using it as a launch pad to\ncompromise other systems. If this ESP is not used, it is prudent to therefore remove it.",
        "solution": "1. Connect to the ASE server with a user that has the sa_role and execute the\nfollowing statements:\n\nexec sp_dropextendedproc 'xp_cmdshell'\n\nexec sp_dropextendedproc 'xp_freedll'\n\nIn addition, the following statements should be executed on Windows systems:\n\nexec sp_dropextendedproc 'xp_logevent'\n\nexec sp_dropextendedproc 'xp_enumgroups'\n\nIf the above statements return Access is denied, stop the ASE server and repeat the\ncommand.\n\n2. On Windows systems, execute the following command from a command prompt to\ndelete sybsyesp.dll. It is prudent to keep a copy of the file offline in case it needs\nthe xp_cmdshell functionality needs to be restored.\n\ndel %SYBASE%\\%SYBASE_ASE%\\dll\\sybsyesp.dll\n\nOn Unix systems, execute the following command from a command shell (assuming\nthe SYBASE environment variables have been set):\n\nrm $SYBASE\\$SYBASE_ASE\\lib\\sybsyesp.so\n\nOn Unix systems it may be necessary to stop and restart the ASE server for the\nchanges to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "value_data": "@SYBASE_INSTALL_DIR@\\dll\\sybsyesp.dll"
    },
    "custom_item_3": {
        "description": "5.3.2 Remove mail related ESPs - sybmail.dll",
        "info": "On Windows systems, Sybase ASE installs a number of powerful ESPs that allow access to\nemail via the Adaptive Server inbox. These are xp_sendmail, xp_readmail, xp_deletemail,\nxp_findnextmsg, xp_startmail and xp_stopmail.\n\nBy default, execution of these ESPs is restricted to users with the sa_role. It is\nrecommended they are removed as a defense in depth measure if they are not in use.\nFurthermore the DLL that houses each of these ESPs, sybmail.dll, should be deleted from\nthe file system to prevent them from being recreated by an attacker.\n\nRationale:\n\nThe email ESPs provide an attacker with suitable privileges additional means of\ncommunicating with other systems on the network and exfiltrating data. Given that ESPs\nhave previously had a number of associated security flaws it is prudent to remove those\nthat are not in use.",
        "solution": "1. Connect to the ASE server with a user that has the sa_role and execute the\nfollowing query:\n\nexec sp_dropextendedproc 'xp_sendmail'\n\nexec sp_dropextendedproc 'xp_readmail'\n\nexec sp_dropextendedproc 'xp_deletemail'\n\nexec sp_dropextendedproc 'xp_findnextmsg'\n\nexec sp_dropextendedproc 'xp_startmail'\n\nexec sp_dropextendedproc 'xp_stopmail'\n\n2. From a command prompt execute the following command to delete sybsyesp.dll:\n\ndel %SYBASE%\\%SYBASE_ASE%\\dll\\sybmail.dll\n\n3. If the above statement returns Access is denied, stop the ASE server and repeat the\ncommand.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1612",
        "value_data": "@SYBASE_INSTALL_DIR@\\dll\\sybmail.dll"
    }
}