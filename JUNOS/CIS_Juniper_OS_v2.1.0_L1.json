{
    "custom_item_1": {
        "description": "1.1 Ensure Device is running Current Junos Software",
        "info": "All JUNOS Devices should run the current Recommended Release of JUNOS.\n\nRationale:\n\nAs with any software, the JUNOS Operating System installed on Juniper Devices may be subject to Bugs, Instabilities and Security Vulnerabilities discovered over time.\n\nJuniper periodically issues software patches for all Juniper Devices which are currently supported, and for which the operating organization has a valid support contract.\n\nAll JUNOS Devices in a production network should be kept up to date based on Security Advisories issued by the Juniper Networks Security Incident Response Team (SIRT).\n\nSIRT publishes non-urgent Security Bulletins on a predefined quarterly schedule, but may also issue out-of-cycle Security Advisories in response to more urgent events such as malicious exploitation of Zero Day vulnerabilities, as described in Juniper Knowledge Base Article KB16613.\n\nA list of Security Advisories can be viewed on the Juniper Knowledge Base here or as an RSS Feed here. No login is required, but additional information is available to users with a Juniper CSC or SSO account.\n\nIf you have a Login to the Juniper Customer Portal, you can Subscribe to Knowledge Base articles or to SIRT Security Advisories for your platform/s by going to the Manage My Subscriptions section. You can also subscribe the RSS Feed to be notified of new Security Advisories without any login being required.\n\nOrganizations which utilize the Junos Space central management platform can use Service Insight to get proactive notifications for SIRT Advisories and End of Life Notifications impacting their managed, supported systems.\n\nAll administrators responsible for management of Junos devices should ensure that they have a process to keep up to date on SIRT Security Advisories and apply necessary patches in a timely manner.\n\nFor new device deployments, Juniper provide a regularly update list of supported Junos Software called the Junos Software Versions - Suggested Releases to Consider and Evaluate (formally known as the JTAC Recommended Release).\n\nThe Suggested Release is specified for each currently supported platform in Juniper Knowledge Base Article KB21476 and is intended as a starting point to help customers select a Junos Software version that meets their deployment needs and can be readily supported by JTAC should assistance be required.\n\nThe Junos Software Versions - Suggested Releases to Consider and Evaluate Knowledge Base article is regularly updated by Juniper and typically reflects current Security Advisories at the time of posting, but it is strongly recommended that administrators using the Suggested Releases as a starting point should always check for any subsequent Security Advisories which may have been issued in the interim to select the best version to deploy.\n\nImpact:\n\nDuring updates JUNOS Devices reboot to load the new software. In some instances this may result in loss of service. Please refer to the documentation for your platform before attempting to update software.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Software patching procedures may vary between different platforms or organizations and can be accomplished using the CLI, the JWeb GUI, centrally through Junos Space or other management platforms.\nTo update a standalone JUNOS Device through the CLI, first upload the desired software image (downloaded from Juniper or your Support Partner) to the JUNOS Device in the /var/tmp/ folder.\nIn most cases an upgrade is performed with the following command, issued from Operational Mode:\n\nuser@host> request system software add /var/tmp/Whereis the filename of the JUNOS image provided by Juniper.\nNOTE - Updating JUNOS Software with this command will result in a reboot of the system and loss of service.\nIn platforms deployed with redundant Routing Engines, as Virtual Chassis or as HA Clusters, an In-Service Software Updates (or ISSU) may be supported. An ISSU update updates and reboots each node or RE separately, failing services on to the other node/RE prior to the reboot.\nTo perform an ISSU Update, on most platforms, issue the following command from Operational Mode:\n\nuser@host> request system software in-service-upgrade /var/tmp/NOTE - The specific procedure and prerequisites for ISSU varies by platform and deployment type. If some prerequisites (such as NSR or GRES) are not correctly configured a loss of service may still occur.\nPlease refer to the documentation for your platform and network enviroment before attempting to update software.\n\nDefault Value:\n\nJUNOS Devices do not always ship with the current JTAC Recommended Release or latest Software Patches installed.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|11.4,CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1M,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set version .+"
    },
    "custom_item_2": {
        "description": "1.2 Ensure End of Life JUNOS Devices are not used",
        "info": "EoL JUNOS Devices should never be used in production networks\n\nRationale:\n\nAs with most vendors, Juniper Networks only support individual versions of Software and Hardware for a certain period of time in order to allow resources to be spent developing new products, rather than supporting old ones and because new features and technologies may not be supportable on older hardware.\n\nJuniper will announce that support for a device, software version or platform is being discontinued by issuing an End of Life Notice for the product being retired. A typical EOL Notice will include details of:\n\nNotification Date - The official date that the EOLN was issued, all other timings are based on this date.\n\nLOD - the Last Order Date for the product - typically this is 180 days after the EOLN. After LOD, no new support services or contracts for the product can be purchased.\n\nLSV - the Last Software Version which will be supported for the product\n\nEOSE - the End of Software Engineering. After this date Juniper will not offer new bug fixes or software patches for the product. Typically this is 3 years after the EOLN.\n\nLRD - the Last Renewal Date. After this date, existing support contracts and services for the platform can no longer be renewed. Typically this is 4 years after the EOLN.\n\nEOS - the End of Support. Juniper will no longer provide any support or replacements for the platform. Typically this is 5 years after the EOLN.\n\nOnce a device has reached EOSE state, Juniper may no longer offer any patches, bug fixes or fixes for security vulnerabilities. This makes the device essentially unsupportable in a production environment, as any serious vulnerability discovered could not be patched.\n\nIt may not be practical in most cases to provide a work around without impacting services and it is rarely possible to instantly retire or replace affected platforms in response to a newly discovered vulnerability. This would leave networks vulnerable with no prospect of a timely fix.\n\nYou can confirm the current support status of your device by going to the Juniper Serial Number Entitlement Tool and entering the device Serial Number/s. Note, you may need to add columns to the default output to display EoL and EoS status.\n\nYou can also search End of Life Notices by platform or software version from the Juniper End of Life Products & Milestones page\n\nImpact:\n\nEOL Devices of any type present a significant risk to the security of the network.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Administrators should plan to retire all JUNOS Devices before they reach EOS/EOSE",
        "reference": "800-171|3.4.8,800-53|CM-7(5),800-53r5|CM-7(5),CSCv7|2.2,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set version .+"
    },
    "custom_item_3": {
        "description": "2.1 Ensure 'Protect RE' Firewall Filter is set for inbound traffic to the Routing Engine",
        "info": "Traffic to the Routing Engine should be filtered.\n\nRationale:\n\nJUNOS Devices can provide a wide range of services to the network and, as with any computer system, the more services that are offered and the more hosts to which they are available, the wider attack surface is offered to a potential attacker.\n\nTo help protect the Junos Device from attack a Firewall Filter should be applied to all inbound traffic, restricting the services available and the hosts trusted to connect to them. Filtering traffic also removes potential resource usage, processing unwanted traffic or unused services.\n\nOn Junos, Transit Traffic (traffic passing through the Junos Device) is processed by the Data Plane (often referred to as the PFE). Traffic destined to the Junos Device itself, such as SSH sessions, SNMP Polling or Routing Protocol updates, is known as Exception Traffic.\n\nException Traffic is passed to the Routing Engine, which is represented by the Loopback interface Lo0, for processing. By default traffic received on any interface to an address owned by the Junos Device will be passed to the RE and can connect to a service, such as SSH, if it is running.\n\nBy applying a Firewall Filter to inbound traffic on the Loopback interface, we can filter traffic to the RE arriving on any interface (whether a transit interface or a dedicated Out of Band Management Interface like fxp0). This Firewall Filter is commonly referred to as a 'Protect RE' filter and is often named as such, though does not have to be.\n\nFilters should be applied for every address family configured on the Junos Device. For example, a Router configured with both IPv4 (family inet) and IPv6 (family inet6) addresses on any interfaces should have inbound Firewall Filters applied to the Loopback interface for both address families.\n\nA full discussion of Firewall Filter design and evaluation is beyond the scope of this Benchmark, but is covered in more detail in Chapter 4 of the Juniper DayOne book Hardening Junos Devices 2nd Edition, available for free from the Juniper DayOne Tech Libary.\n\nAt a minimum a Firewall Filter should be applied which restricts management services to trusted hosts, while accepting all other traffic so as not to interfere with normal function of protocol updates and services. This is not a suitable approach in high security environments, where a default discard/deny should be used along with other restrictions covered in separate Level 2 Recommendations in this section.\n\nFor devices with multiple Loopback Interface Units configured in different Routing Instances, Logical Systems or similar, Firewall Filters should be applied inbound for all configured Loopback units.\n\nImpact:\n\nFirewall Filters should be carefully tested before implementation on production systems as incorrect configuration may prevent normal services functioning.\n\nIt is strongly recommended that changes to Firewall Filters are applied using commit confirmed so that changes will be automatically rolled back should they prevent the administrator from connecting to the Junos Device.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "A full discussion of Firewall Filters is beyond the scope of this Benchmark.\nIt is important to ensure that Firewall Filters include terms to match and accept all of your required Routing Protocols, Management Services and any other services used on your Junos Device. As noted elsewhere, it is strongly recommended that changes to Firewall Filters applied to the Loopback interface always be applied using commit confirmed so that the change will be automatically rolled back should the administrator lose connection after committing the change.\nTo create a IPv4 firewall filter enter the following command from the [edit firewall] hierarchy.\n\n[edit firewall]\nuser@host#edit family inet\n[edit firewall family inet]\nuser@host#edit filter[edit firewall family inet filter]\nuser@host#edit term[edit firewall family inet filterterm]\nuser@host#set fromuser@host#set thenAn IPv6 firewall filter, if required, can be configured under the family inet6 from the same hierarchy.\nThe following example filter allows SSH from the 192.168.1.0/24 network and OSPF from 10.0.0.0/8, while (implicitly) discarding all other traffic (without logging):\n\nfirewall {\n      family inet {\n            filter ProtectRE {\n                  term AllowOSPF {\n                        from {\n                             protocol ospf;\n                             source-address 10.0.0.0/8;\n                        }\n                        then {\n                             accept;\n                        }\n                  }\n                  term AllowSSH {\n                        from {\n                             protocol tcp;\n                             source-address 192.168.1.0/24;\n                             destination-port ssh;\n                        }\n                        then {\n                             accept;\n                             log;\n                             syslog;\n                        }\n                  }\n            }\n      }\n}\n\nOnce a suitable filter has been configured, it must be applied to the Loopback interface, using the following command from the [edit] hierarchy:\n\n[edit]\nuser@host#set interface lo0 unit 0 family inet filter inputIf additional Loopback Interface Units are configured (in other Routing Instances), the filter should also be applied to these.\nIf IPv6 filters are also required, the same command is used but applying to family inet6.\n\nDefault Value:\n\nNo firewall filters are configured by default.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|12.4,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set firewall .+"
    },
    "custom_item_4": {
        "description": "Check for dialer interfaces",
        "regex": "set interfaces dl[0-9]",
        "number_of_lines": "^([1-9]|[1-9][0-9]+)$"
    },
    "custom_item_5": {
        "description": "Check for no 3G/LTE dialer interfaces",
        "regex": ".*backup-options interface dl.*",
        "number_of_lines": "^0$"
    },
    "custom_item_6": {
        "description": "3.1.1 Ensure Caller ID is set",
        "info": "Caller restrictions MUST be used when Incoming calls are permitted.\n\nRationale:\n\nSome JUNOS routers support the use of a dial in modem connection for Telnet/SSH administration of the router from a remote connection over the telephone network.\n\nThis can provide a useful out of band management channel, allowing access to a customer router at a remote site when the primary circuit has failed for example, but also creates a new route for attack, allowing a malicious user to bypass firewalls and other defenses.\n\nEven when the phone number for the modem is kept secret, attackers may still discover it through war dialing, possibly narrowing targets by researching the number ranges used by your organization.\n\nTo limit the scope for such an attack, the dialer interface should be configured to check the incoming Caller ID for connection attempts, only allowing the connection to proceed when the caller is on a pre-configured list of approved numbers.",
        "solution": "If you have configured a dialer interface to accept incoming calls, you should restrict the allowable Caller ID by entering the following command under the [edit interfaces dln unit 0 dialer-options] hierarchy (where n is the dialer interface number);\n\n[edit interfaces dln unit 0 dialer-options]\nuser@host#set incoming-map callerUp to 15 caller numbers may be configured on a dialer interface, repeat the command above for each number you wish to add.",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces .+ incoming-map",
        "number_of_lines": "^([0-9]|1[0-5]+)$"
    },
    "custom_item_7": {
        "description": "3.1.2 Ensure access profile is set to use CHAP",
        "info": "CHAP Authentication MUST be used when Incoming calls are permitted.\n\nRationale:\n\nSome JUNOS routers support the use of a dial in modem connection for Telnet/SSH administration of the router from a remote connection over the telephone network.\n\nThis can provide a useful out of band management channel, allowing access to a customer router at a remote site when the primary circuit has failed for example, but also creates a new route for attack, allowing a malicious user to bypass firewalls and other defenses.\n\nEven when the phone number for the modem is kept secret, attackers may still discover it through war dialing, possibly narrowing targets by researching the number ranges used by your organization.\n\nTo limit the scope for such an attack, the dialer interface should be configured to use Challenge Handshake Authentication Protocol (CHAP) before allowing calls to connect. Using CHAP, a username and password can be configured for each user that needs to connect to the router via the modem. The password should not be the same as that used by to login to the routers CLI itself.",
        "solution": "If you have configured a dialer interface to accept incoming calls, you should configure CHAPS authentication using the following commands from the indicated hierarchy (where n is the interface number);\n\n[edit access]\nuser@host#set profileclientchap-secretuser@host#top\nuser@host#edit interface dlunit 0\n\n[edit interfaces dlunit 0]\nuser@host#set ppp-options chap access-profileRepeat the first command for each user that is required.",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces .+ chap .+ access-profile",
        "number_of_lines": "[0-9]+"
    },
    "custom_item_8": {
        "description": "3.3 Ensure unused interfaces are set to disable",
        "info": "Unused interfaces should be explicitly disabled.\n\nRationale:\n\nJUNOS routers can be installed with tens or even hundreds of physical interfaces of different types. To ensure that unused interfaces are not connected to networks, either accidently or by a malicious user seeking to bypass security measures, all unused interfaces should be explicitly disabled.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To disable an interface enter the following command from the [edit interfaces] hierarchy.\n\n[edit interfaces]\nuser@host#set disable\n\nDefault Value:\n\nInstalled physical interfaces are enabled by default on most platforms.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1M,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces .+"
    },
    "custom_item_9": {
        "description": "Check that no descriptions are set",
        "regex": "set interfaces .+ description",
        "number_of_lines": "^0$"
    },
    "custom_item_10": {
        "description": "3.4 Ensure interface description is set",
        "info": "All interfaces should have a description.\n\nRationale:\n\nJUNOS routers can be installed with tens or even hundreds of physical and logical interfaces of different types. To allow effective planning, troubleshooting and to avoid confusion & mistakes which may compromise your networks security, all interface units should have a description configured.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To configure an interface description enter the following command from the[edit interfaces unit ] hierarchy.\n\n[edit interfacesunit]\nuser@host#set descriptionDefault Value:\n\nDescriptions are not set by default.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CA-3,800-53|CA-9,800-53|CM-7b.,800-53r5|CA-3,800-53r5|CA-9,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv7|9,CSCv7|11.2,CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ITSG-33|CA-3,ITSG-33|CM-7a.,LEVEL|1A,NESA|M1.3.5,NESA|M1.3.6,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces .+"
    },
    "custom_item_11": {
        "description": "3.6 Ensure ICMP Redirects are set to disabled (on all untrusted IPv4 networks)",
        "info": "The Routing Engine should not send ICMP Redirect Messages.\n\nRationale:\n\nICMP Redirect Messages provide a method for a router to communicate routing information with a host and is intended for use when a router receives packets to forward to a destination to which the host should have a direct route. In a well designed, modern, network ICMP Redirects should not be needed or add any useful functionality.\n\nAn attacker may abuse this feature to obtain topology information about a target network and potentially identify weaknesses for later exploitation or to target the router and hosts with Denial of Service (DoS) or Man in the Middle (MITM) attacks.\n\nTo prevent this abuse, ICMP Redirect message generation should be disabled globally where it is not required as discussed in Recommendation 6.15.10 Ensure ICMP Redirects are Disabled for IPv4. Where this is not possible, ICMP Redirects can be disabled on a per Interface basis and should be disabled for all Untrusted networks, such as the Internet, or subnets where this functionality is not required.\n\nImpact:\n\nIn some networks, for instances where subnets populated by hosts include multiple non-redundant gateways, removing redirects may result in traffic being doubled on some gateways interfaces as traffic is received and then forwarded on the same port.",
        "solution": "To disable ICMP Redirect message generation on an untrusted network interface, issue the following command from the [edit interfaces] hierarchy;\n\n[edit interfaces]\nuser@host#setunitfamilyno-redirects\n\nDefault Value:\n\nBy default the ICMP Redirect messages are generated.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|12,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces @UNTRUSTED_INTERFACE_IPV4@[\\s]*",
        "expect": "no-redirects"
    },
    "custom_item_12": {
        "description": "Check for IPv6 configured on any interface",
        "regex": "set interfaces .+ inet6 address .+",
        "number_of_lines": "^([1-9]|[1-9][0-9])+$"
    },
    "custom_item_13": {
        "description": "3.7 Ensure ICMP Redirects are set to disabled (on all untrusted IPv6 networks)",
        "info": "The Routing Engine should not send ICMP Redirect Messages.\n\nRationale:\n\nICMP Redirect Messages provide a method for a router to communicate routing information with a host and is intended for use when a router receives packets to forward to a destination to which the host should have a direct route. In a well-designed, modern, network ICMP Redirects should not be needed or add any useful functionality.\n\nAn attacker may abuse this feature to obtain topology information about a target network and potentially identify weaknesses for later exploitation or to target the router and hosts with Denial of Service (DoS) or Man in the Middle (MITM) attacks.\n\nTo prevent this abuse, ICMP Redirect message generation should be disabled globally where it is not required as discussed in Recommendation 6.15.11 Ensure ICMP Redirects are Disabled for IPv6. Where this is not possible, ICMP Redirects can be disabled on a per Interface basis and should be disabled for all untrusted networks, such as the Internet, or subnets where this functionality is not required.\n\nImpact:\n\nIn some networks, for instances where subnets populated by hosts include multiple non-redundant gateways, removing redirects may result in traffic being doubled on some gateways interfaces as traffic is received and then forwarded on the same port.",
        "solution": "To disable ICMP Redirect message generation on an untrusted network interface, issue the following command from the [edit interfaces] hierarchy;\n\n[edit interfaces]\nuser@host#setunitfamilyno-redirects\n\nDefault Value:\n\nBy default the ICMP Redirect messages are generated.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|12,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces @UNTRUSTED_INTERFACE_IPV6@[\\s]*",
        "expect": "no-redirects"
    },
    "custom_item_14": {
        "description": "3.9 Ensure only one loopback address is set",
        "info": "Configure only one Loopback address per Routing Instance\n\nRationale:\n\nMultiple Loopback addresses create potential for abuse, mis-configuration and confusion. A maximum of one address per address family should be set on the system's loopback address in each Routing Instance.\n\nAlternative Loopback addresses should be configured with caution and, where they must be used, should be clearly documented.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To remove an additional loopback addresses enter the following command from the [edit interfaces] hierarchy for each address to be removed:\n\n[edit interfaces]\nuser@host#delete lo0 unitfamilyaddressDefault Value:\n\nNo Loopback Address is configured by default.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set interfaces lo[0-9]* .+ (family|address)"
    },
    "custom_item_15": {
        "description": "Check for BGP",
        "expect": "set protocols bgp .+"
    },
    "custom_item_16": {
        "description": "4.1.1 Ensure peer authentication is set to MD5",
        "info": "BGP Peers should be authenticated.\n\nRationale:\n\nWhere it is deployed, BGP routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers BGP neighbors may inject incorrect information into the route table resulting in DOS attack or loss of confidential data through a Man in the Middle attack.\n\nOn Juniper routers (as well as routers from other manufacturers such as Cisco or Brocade) it is possible to authenticate neighbors using an MD5 digest of elements of the TCP segment, creating a signature which can be verified without ever needing to transmit the password. This method is described in RFC 2385.",
        "solution": "If you have deployed BGP in your network you should authenticate all neighbors. Authentication can be configured at the Global, Group or Neighbor level, with more specific settings overriding less specific. For eBGP a different MD5 password should be configured for each neighbor or peer. For iBGP neighbors the same key may be used globally or different keys may be used by group or neighbor as appropriate to your infrastructure. To configure BGP Authentication at the globally enter the following command at the [edit protocols bgp] hierarchy:\n\n[edit protocols bgp]\nuser@host#set authentication-keyTo configure BGP Authentication at the group level enter the following command at the [edit protocols bgp] hierarchy:\n\n[edit protocols bgp]\nuser@host#set groupauthentication-keyFinally, to configure BGP Authentication at the neighbor level enter the following command at the [edit protocols bgp group] hierarchy:\n\n[edit protocols bgp group]\nuser@host#set neighborauthentication-keyRemember that more specific settings override less specific settings, so a key set at the neighbor level will be used even if keys are also set at the group and global levels.\n\nDefault Value:\n\nNo BGP routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols bgp .+",
        "expect": "set protocols bgp .+ authentication-key .+"
    },
    "custom_item_17": {
        "description": "4.1.3 Ensure EBGP peers are set to use GTSM",
        "info": "GTSM should be used with all EBGP peers.\n\nRationale:\n\nWhere it is deployed, External BGP routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic destined for external networks. An attacker may attempt to exhaust the routers CPU and memory resources by flooding a target router with fake routing updates, resulting in a DoS condition. Potentially an attack may also inject fake routing information into the route table.\n\nGeneral TTL Security Mechanism (GTSM) is defined in RFC5082 and takes advantage of the fact that routers normally peer with adjacent neighbors, i.e. with routers only 1 hop away. GTSM uses the Time to Live (TTL) field of routing update packets to determine whether or not the packet originated from an adjacent router, denying those which do not.\n\nJuniper routers effectively implement GTSM by default. Administrators can use the multihop command hierarchy to increase the maximum acceptable TTL for route updates, allowing updates from non adjacent peers. When peering with adjacent routers then multihop should not be configured, using the default to effectively configure GTSM with a TTL limit of 254 (or 1 hop). If your network requires peering with routers more than 1 hop away (non adjacent peers), multihop should be configured on a per peer or per group basis with the minimum possible value so as to limit the distance, in terms of networks, from which an attack can be launched.",
        "solution": "If you have deployed multihop in your network but do not have any peers more then 1 hop away, disable multihop with the following command from the [edit protocols bgp], [edit protocols bgp group] or [edit protocols bgp groupneighbor] depending at which level you have configured multihop;\n\n[edit protocols bgp]\nuser@host#delete multihop\n\nTo change the number of hops distance from which a route update can originate, enter the following command from the [edit protocols bgp group] to apply multihop to a group or [edit protocols bgp groupneighbor] to apply multihop to a single neighbor;\n\n[edit protocols bgp group]\nuser@host#set multihop ttlRemember that, in both cases, more specific settings override less specific ones. So if multihop is set to 5 at the neighbor level, but the default of 1 at the global level, the neighbor level setting will apply for communications with that peer.\n\nDefault Value:\n\nA TTL of 1 is used by default on eBGP sessions and a default TTL of 64 is used for iBGP.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols bgp .+ multihop",
        "number_of_lines": "^0$"
    },
    "custom_item_18": {
        "description": "4.1.5 Ensure Ingress Filtering is set for EBGP peers",
        "info": "Filter prefixes advertised to the router through eBGP.\n\nRationale:\n\nIn addition to filtering Bogon and Maritan routes JUNOS routers peering with eBGP neighbors should also apply Ingress Filtering to prevent the router processing bad updates sent from the neighbor router, either maliciously or by accident. At a minimum prefix filters should deny any prefix which belong to your own AS. Depending on your type of deployment you may also wish to block prefixes which are more specific than those issues by RIR's or limit ISP customers to advertising those prefixes which you have assigned to them.",
        "solution": "From the [edit policy-options] hierarchy, define a new policy by issuing the following commands:\n\n[edit policy-options]\nuser@host#edit policy-statementterm[edit policy-options policy-statementterm]\nuser@host# set from route-filter/-> reject\n\nNow apply the policy, either globally, to a group or to an individual peer as required by your environment.\n\n[edit protocols bgp]\nuser@host#set importDefault Value:\n\nNo Ingress Filtering is applies by default.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|12,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols bgp .+ import .+"
    },
    "custom_item_19": {
        "description": "Check for IS-IS",
        "expect": "set protocols isis .+"
    },
    "custom_item_20": {
        "description": "4.2.1 Ensure IS-IS neighbor authentication is set to MD5",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn Juniper routers (as well as routers from other manufacturers such as Cisco or Brocade) it is possible to authenticate neighbors using either Simple authentication or a Keyed Hash Based Message Authentication Check using an MD5 digest of elements in PDU combined with a sequence number to protect against Replay attacks and confirm authenticity.\n\nSimple authentication sends the configured password as clear-text and should never be used. MD5 HMAC based authentication sends only a one way hash in the packets, providing authentication without exposing sensitive date, so should be used instead.\n\nAuthentication is configured for each IS-IS Level. More fine grained authentication for Hello packets may also be set at the interface level.",
        "solution": "If you have deployed IS-IS in your network you should use MD5 authentication for all neighbors at each IS-IS Level configured.\nTo configure MD5 authentication and the secret key to be used, issue the following commands from the [edit protocols isis] hierarchy:\n\n[edit protocols isis]\nuser@host#set levelauthentication-type md5\nuser@host#set levelauthentication-keyDefault Value:\n\nNo IS-IS routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ authentication-(type|key) .+",
        "number_of_lines": "^2$"
    },
    "custom_item_21": {
        "description": "4.2.3 Ensure authentication check is not suppressed",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn JUNOS routers it is possible to suppress some authentication features to aid integration with other vendors IS-IS implementations. One of these interoperability features allows you to configure the router to generate authenticated packets, but not check the authentication of received packets. This leaves the router as vulnerable as it would be with no authentication enabled at all and should not be used in a production environment.",
        "solution": "If you have deployed IS-IS in your network and have disabled authentication checking, re-enable it by issuing the following command from the [edit protocols isis] hierarchy for each level at which it had been set:\n\n[edit protocols isis]\nuser@host#delete levelno-authentication-check\n\nDefault Value:\n\nNo IS-IS routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ no-authentication-check",
        "number_of_lines": "^0$"
    },
    "custom_item_22": {
        "description": "4.2.4 Ensure loose authentication check is not configured",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn JUNOS routers it is possible to suppress some authentication features to aid integration with other vendors IS-IS implementations. One of these interoperability features allows you to configure the router to accept both authenticated and unauthenticated IS-IS packets. This is to allow for transition period, where authentication is not yet configured across all devices in a network, but leaves the protocol open to exploitation and should not be left in place once the migration to an authentication method is complete.",
        "solution": "If you have deployed IS-IS in your network and have enabled loose authentication checking, re-enable it by issuing the following command from the [edit protocols isis] hierarchy:\n\n[edit protocols isis]\nuser@host#delete loose-authentication-check\n\nDefault Value:\n\nNo IS-IS routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ loose-authentication-check",
        "number_of_lines": "^0$"
    },
    "custom_item_23": {
        "description": "4.2.5 Ensure IS-IS Hello authentication check is not suppressed",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack. On JUNOS routers it is possible to suppress some authentication features to aid integration with other vendors IS-IS implementations.\n\nOne of these interoperability features allows you to configure the router to ignore authentication for Hello messages from other routers. This potentially leaves the router open to attack through Hello messages to the same extent as it would be were authentication not configured at all.",
        "solution": "If you have deployed IS-IS in your network and have disabled hello authentication checking, re-enable it by issuing the following command from the [edit protocols isis] hierarchy for each level at which it was configured:\n\n[edit protocols isis]\nuser@host#delete levelno-hello-authentication\n\nDefault Value:\n\nNo IS-IS routing is configured by default.\n\nHello Authentication is not suppressed by default when IS-IS is configured.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ no-hello-authentication",
        "number_of_lines": "^0$"
    },
    "custom_item_24": {
        "description": "4.2.6 Ensure PSNP authentication check is not set to suppressed",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn JUNOS routers it is possible to suppress some authentication features to aid integration with other vendors IS-IS implementations. One of these interoperability features allows you to configure the router to ignore authentication for Partial Sequence Number PDU (PSNP) messages from other routers. This potentially leaves the router open to attack through PSNP messages to the same extent as it would be were authentication not configured at all.",
        "solution": "If you have deployed IS-IS in your network and have disabled PSNP authentication checking, re-enable it by issuing the following command from the [edit protocols isis] hierarchy for each level at which it was set:\n\n[edit protocols isis]\nuser@host#delete levelno-psnp-authentication\n\nDefault Value:\n\nNo IS-IS routing is configured by default.\n\nPSNP Authentication is not suppressed by default when IS-IS is configured",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ no-psnp-authentication",
        "number_of_lines": "^0$"
    },
    "custom_item_25": {
        "description": "4.2.7 Ensure CSNP authentication check is not set to suppressed",
        "info": "IS-IS Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, IS-IS routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers IS-IS neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn JUNOS routers it is possible to suppress some authentication features to aid integration with other vendors IS-IS implementations. One of these interoperability features allows you to configure the router to ignore authentication for Complete Sequence Number PDU (CSNP) messages from other routers. This potentially leaves the router open to attack through CSNP messages to the same extent as it would be were authentication not configured at all.",
        "solution": "If you have deployed IS-IS in your network and have disabled CSNP authentication checking, re-enable it by issuing the following command from the [edit protocols isis] hierarchy for each level at which it was set:\n\n[edit protocols isis]\nuser@host#delete levelno-csnp-authentication\n\nDefault Value:\n\nNo IS-IS routing is configured by default.\n\nCSNP Authentication is not suppressed by default when IS-IS is configured.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols isis .+ no-csnp-authentication",
        "number_of_lines": "^0$"
    },
    "custom_item_26": {
        "description": "Check for OSPF",
        "expect": "set protocols ospf .+"
    },
    "custom_item_27": {
        "description": "4.3.1 Ensure OSPF authentication is set to MD5",
        "info": "OSPF Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, OSPF routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers OSPF neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn Juniper routers (as well as routers from other manufacturers such as Cisco or Brocade) it is possible to authenticate neighbors using an MD5 digest of elements in the update combined with a sequence number to protect against Replay attacks.\n\nAuthentication is configured on a per Interface basis when an interfaces is assigned to an OSPF area.",
        "solution": "To configure MD5 based authentication, first configure the authentication type at the [edit protocols ospf area] hierarchy (this step is not required on all versions of JUNOS):\n\n[edit protocols ospf area]\nuser@host#set authentication-type md5\n\nThe key must then be configured for any interfaces in the area\n\n[edit protocols ospf area]\nuser@host#set interfaceauthentication md5The parameter needs to be the same across all routers in the area and is there to provide a method for transitioning from old to new keys.\n\nDefault Value:\n\nNo OSPF routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols ospf .+",
        "expect": "set protocols ospf .+ authentication-type .+"
    },
    "custom_item_28": {
        "description": "Check for OSPFv3",
        "expect": "set protocols ospf3 .+"
    },
    "custom_item_29": {
        "description": "4.4.1 Ensure OSPFv3 authentication is set to IPSEC SA - ipsec-sa",
        "info": "OSPFv3 Neighbors should be strongly authenticated.\n\nRationale:\n\nWhere it is deployed, OSPFv3 routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network.\n\nAn attacker posing as one of the target routers OSPFv3 neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOSPFv3 does not support MD5 HMAC based authentication, instead relying on IPSEC Security Associations to authenticate neighbors. This provides more robust authentication mechanisms and for, optional, encryption of routing data in transit.\n\nA Manual IPSEC Security Association is formed between neighbors, using Authenticated Header (IP Protocol 51) with the strong SHA1-HMAC method to ensure that the updates were sent by trusted neighbors and were not changed in transit. Only AH is used to avoid the added overhead required to encrypt and decrypt the packets contents which ESP would entail. It is possible to use ESP in place of AH if encryption of routing information across an untrusted segment is required, but this can have a significant performance cost.\n\nIn 'dual stack' IPv4/IPv6 environments running both OSPFv2 for IPv4 routing and OSPFv3 for IPv6, it is common to use a single SA on a segment to provide authentication both protocols.\n\nNOTE - Although M, T and MX series devices normally require a Services PIC or DPC installed to provide IPSEC VPNs, no additional hardware is required for IPSEC SA based authentication of OSPF neighbors.",
        "solution": "To setup IPSEC SA based authentication, first configure a Security Association at the [edit security ipsec] hierarchy;\n\n[edit security ipsec]\nedit security-associationset descriptionset mode transport\nset manual direction bidirectional protocol ah\nset manual direction bidirectional algorithm hmac-sha1-96\nset manual direction bidirectional authentication keyThe SA must be bi-directional and must be configured with the same parameters on all neighbors reachable on the intended interface.\nNote that only Authenticated Header is configured in this example which provides mutual authentication but does not encrypt OSPFv3 protocol messages in transit.\nNext configure IPSEC SA based authentication for one or more interfaces which OSPF will be run over from the [edit protocols ospfv3] hierarchy;\n\n[edit protocols ospfv3]\nuser@host#set areainterfaceipsec-saDefault Value:\n\nNo OSPFv3 routing is configured by default",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols ospf3 .+ ipsec-sa .+",
        "number_of_lines": "^([1-9]|[1-9][0-9])+$"
    },
    "custom_item_30": {
        "description": "4.4.1 Ensure OSPFv3 authentication is set to IPSEC SA - md5",
        "info": "OSPFv3 Neighbors should be strongly authenticated.\n\nRationale:\n\nWhere it is deployed, OSPFv3 routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network.\n\nAn attacker posing as one of the target routers OSPFv3 neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOSPFv3 does not support MD5 HMAC based authentication, instead relying on IPSEC Security Associations to authenticate neighbors. This provides more robust authentication mechanisms and for, optional, encryption of routing data in transit.\n\nA Manual IPSEC Security Association is formed between neighbors, using Authenticated Header (IP Protocol 51) with the strong SHA1-HMAC method to ensure that the updates were sent by trusted neighbors and were not changed in transit. Only AH is used to avoid the added overhead required to encrypt and decrypt the packets contents which ESP would entail. It is possible to use ESP in place of AH if encryption of routing information across an untrusted segment is required, but this can have a significant performance cost.\n\nIn 'dual stack' IPv4/IPv6 environments running both OSPFv2 for IPv4 routing and OSPFv3 for IPv6, it is common to use a single SA on a segment to provide authentication both protocols.\n\nNOTE - Although M, T and MX series devices normally require a Services PIC or DPC installed to provide IPSEC VPNs, no additional hardware is required for IPSEC SA based authentication of OSPF neighbors.",
        "solution": "To setup IPSEC SA based authentication, first configure a Security Association at the [edit security ipsec] hierarchy;\n\n[edit security ipsec]\nedit security-associationset descriptionset mode transport\nset manual direction bidirectional protocol ah\nset manual direction bidirectional algorithm hmac-sha1-96\nset manual direction bidirectional authentication keyThe SA must be bi-directional and must be configured with the same parameters on all neighbors reachable on the intended interface.\nNote that only Authenticated Header is configured in this example which provides mutual authentication but does not encrypt OSPFv3 protocol messages in transit.\nNext configure IPSEC SA based authentication for one or more interfaces which OSPF will be run over from the [edit protocols ospfv3] hierarchy;\n\n[edit protocols ospfv3]\nuser@host#set areainterfaceipsec-saDefault Value:\n\nNo OSPFv3 routing is configured by default",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols ospf3 .+ md5 .+",
        "number_of_lines": "^0$"
    },
    "custom_item_31": {
        "description": "Check for RIP",
        "expect": "set protocols rip .+"
    },
    "custom_item_32": {
        "description": "4.5.1 Ensure RIP authentication is set to MD5",
        "info": "RIP Neighbors should be authenticated.\n\nRationale:\n\nWhere it is deployed, RIP routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network. An attacker posing as one of the target routers RIP neighbors may inject incorrect information into the route table resulting in DoS attack or loss of confidential data through a Man in the Middle attack.\n\nOn Juniper routers (as well as routers from other manufacturers such as Cisco or Brocade) it is possible to authenticate neighbors using an MD5 digest of elements in the update. RIP Authentication is defined in RFC2082.",
        "solution": "If you have deployed RIP in your network you should use MD5 authentication for all neighbors. To configure authentication enter the following command from the [edit protocols rip] hierarchy:\n\n[edit protocols rip]\nuser@host#set authentication-type md5\nuser@host#set authentication-keyDefault Value:\n\nNo RIP routing is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols rip authentication-(type|key) .+",
        "number_of_lines": "^2$"
    },
    "custom_item_33": {
        "description": "4.5.2 Ensure RIP is set to check for zero values in reserved fields",
        "info": "The router should check that fields that the RFC requires must be 0 are, in fact, 0.\n\nRationale:\n\nWhere it is deployed, RIP routing is vital for normal operation of an organization's network infrastructure. Correct route information is required for routers to correctly direct traffic through the network.\n\nThe RFCs relating to RIP define a number of reserved fields in the packet format for future use. Those fields not used in the protocol version used should be set to 0.\n\nIf a packet is received with reserved fields set to a value other than 0 then it is breaking the RFC standards and may be an attempt to attack the router. In almost all network environments there is no reason for such a packet to exist, so JUNOS's default behavior of ignoring them should be used.",
        "solution": "If you have deployed RIP in your network and disabled zero value checking of reserved fields, you should re-enable it by issuing the following command from the [edit protocols rip] hierarchy:\n\n[edit protocols rip]\nuser@host#set check-zero\n\nDefault Value:\n\nWhen RIP is used, check-zero is the default setting.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols rip .+",
        "expect": "set protocols rip check-zero"
    },
    "custom_item_34": {
        "description": "Check for LDP",
        "expect": "set protocols ldp .+"
    },
    "custom_item_35": {
        "description": "4.7.1 Ensure authentication is set to MD5",
        "info": "LDP peers should be authenticated.\n\nRationale:\n\nWhere it is deployed, LDP is vital for normal operation of an MPLS network. LDP is used to determine Label mapping and populate the routers Forwarding Information Base (FIB). An attacker posing as one of the target routers LDP peers may attempt to inject incorrect label information or exploit a vulnerability in the routers LDP implementation to cause an information disclosure or denial of service.\n\nOn Juniper routers (as well as routers from other manufacturers such as Cisco or Brocade) it is possible to authenticate LDP sessions using an MD5 digest of elements in LDP messages.\n\nLDP Session Authentication may be configured on a per session or per session-group basis. The Audit Procedure checks for both, however, the remediation procedure is only given for a session-group; as configuration at the session level is deprecated in current versions of JUNOS.",
        "solution": "If you have deployed LDP in your network you should use MD5 authentication for all neighbors.\nTo configure authentication for a session-group enter the following command from the [edit protocols ldp] hierarchy:\n\n[edit protocols ldp]\nuser@host#set session-groupauthentication-keyDefault Value:\n\nLDP is not configured by default.\n\nWhen LDP sessions are configured, MD5 is the default authentication method when an authentication-key is specified.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols ldp .+",
        "expect": "set protocols ldp .+ authentication-key .+"
    },
    "custom_item_36": {
        "description": "Check for MSDP",
        "expect": "set protocols msdp .+"
    },
    "custom_item_37": {
        "description": "4.8.1 Ensure authentication is set to MD5",
        "info": "MSDP Peers should be authenticated.\n\nRationale:\n\nWhen deployed MSDP it provides PIM-SM with information for routing Multicast traffic and is critical to operation of Multicast services on the network. If no authentication is used, an attacker may inject false information into the PIM-SM distribution tree, resulting in potential Denial of Service or Integrity compromise.\n\nMSDP packets can be authenticated using a Keyed Hash-based Message Authentication Code (HMAC) generated by hashing elements of the of the update packet combined with a shared secret using MD5.",
        "solution": "If you have deployed MSDP, authentication can be configured on a peer by peer basis, by issuing the following command from the [edit protocols msdp] hierarchy:\n\n[edit protocols msdp]\nuser@host#set peerauthentication-keyDefault Value:\n\nNo MSDP is configured by default.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols msdp .+",
        "expect": "set protocols msdp .+ authentication-key .+"
    },
    "custom_item_38": {
        "description": "4.10.1 Ensure ICMP Router Discovery is disabled",
        "info": "ICMP Router Discovery should not be used.\n\nRationale:\n\nICMP Router Discovery provides details of routers attached to a broadcast or multicast segment in response to Router Solicitation messages from hosts or in the form of a period Router Advertisement.\n\nThese messages may provide an attacker attached to the segment with a clearer picture of network environment and also increases the attack surface of the JUNOS device. As the feature is rarely used, ICMP Router Discovery should only be configured on networks where a specific requirement exists for its use.",
        "solution": "If you have configured ICMP Router Discovery and do not require it, you can disable it by issuing the following command from the [edit protocols router-discovery] hierarchy:\n\n[edit protocols router-discovery]\nuser@host#set disable\n\nDefault Value:\n\nICMP Router Discovery is disabled by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols router-discovery .+",
        "expect": "set protocols router-discovery disable"
    },
    "custom_item_39": {
        "description": "Check for RSVP",
        "expect": "set protocols rsvp .+"
    },
    "custom_item_40": {
        "description": "4.11.1 Ensure authentication is set to MD5",
        "info": "RSVP Peers should be authenticated.\n\nRationale:\n\nRSVP messages may be abused by an attacker to interfere with QoS and Traffic Engineering services, resulting in poor performance or Denial of Service, or seek to attack the target router directly using weaknesses in the RSVP implementation.\n\nTo protect against these types of attacks RSVP messages may be Authenticated using an MD5 hash of certain packet elements combined with a secret key (MD5 HMAC). RSVP authentication is supported in the two major variants described in the IETF Draft 'RSVP Cryptographic Authentication draft-ietf-rsvp-md5-03' and in RFC 2747. JUNOS automatically detects which variant to use on a neighbor by neighbor basis and not interaction is required from the administrator for multi-vendor support.\n\nRSVP Authentication is set on an interface by interface basis and should be configured for all interfaces where RSVP is used.",
        "solution": "If you have configured RSVP you can add authentication by issuing the following command from the [edit protocols rsvp] hierarchy:\n\n[edit protocols rsvp]\nuser@host#set interfaceauthentication-keyDefault Value:\n\nRSVP is not configured by default",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set protocols rsvp .+",
        "expect": "set protocols rsvp .+ authentication-key .+"
    },
    "custom_item_41": {
        "description": "Check for SNMP",
        "expect": "set snmp .+"
    },
    "custom_item_42": {
        "description": "5.1 Ensure Common SNMP Community Strings are NOT used",
        "info": "Do not use common / default community strings.\n\nRationale:\n\nSNMP can be used to read, and sometime write, sensitive information about your router and network environment.\n\nWhen using SNMP Versions 1 and 2C (SNMPv2c) a community string is used to identify and, to a limited degree, authenticate Management Stations. If an attacker knows or guesses the community string that is used they may be able gain access to the SNMP interface as if they were a valid administrator.\n\nTo reduce the risk of an attacker guessing your community strings you should not use the following well known, common strings which are used as defaults on many brands of router:\n\n'Public'\n\n'Private'\n\n'Admin'\n\n'Monitor'\n\n'Security'\n\nAny community used should be complex and should not match any of the passwords used elsewhere on the device or in your organization.",
        "solution": "If you have deployed SNMPv1 or SNMPv2c on your router using one of these strings, rename the community using the following command under the [edit snmp] hierarchy;\n\n[edit snmp]\nuser@host#rename communityto communityDefault Value:\n\nNo SNMP communities are set by default on most platforms.",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set snmp community",
        "not_expect": "(public|private|admin|monitor|security)"
    },
    "custom_item_43": {
        "description": "5.2 Ensure SNMPv1/2 are set to Read Only",
        "info": "Do not allow Read-Write SNMP access for versions below SNMPv3.\n\nRationale:\n\nSNMP can be used to read and write configuration information from a router using your Network Management Systems; however the inherently insecure design of the older SNMP V1, V2 and V2C standards, which do not use encryption to protect community strings, make their use for setting configuration an open invitation to an attacker.\n\nWhile, by default, a JUNOS router configured for SNMP Write access provides access only to Ping or Traceroute from the router, these still provide a potential source of information about your network or avenue for further attack so should not be permitted. Additional SNMP Management Information Base (MIB) views might be configured which, were Write access permitted, would allow an attacker to disable interfaces, change routing configuration or change anything else that you might do from the command line.\n\nIf an NMS is being used to configure routers via SNMP write access it should only do so via SNMPv3, which is significantly more secure.",
        "solution": "If you have deployed SNMP below Version 3 on your router with Read-Write access, delete the associated community using the following command under the [edit snmp] hierarchy;\n\n[edit snmp]\nuser@host#delete communityAlternatively you can set the communities authorization level to Read Only with the following command from the [edit snmp] hierarchy;\n\n[edit snmp]\nuser@host#set communityauthorization read-only\n\nDefault Value:\n\nNo SNMP communities are set by default on most platforms.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set snmp",
        "not_expect": "authorization read-write"
    },
    "custom_item_44": {
        "description": "5.3 Ensure a client list is set for SNMPv1/v2 communities",
        "info": "Limit clients to access SNMP.\n\nRationale:\n\nEven when limited to read only access, SNMP can provide an attacker with a wealth of information about your router and network topology.\n\nTo limit the potential for attacks against your routers SNMP service you should limit the IP addresses that are permitted to connect using a client-list. This ensure that individual community strings are used to authenticate only by the systems in the list, providing granular access control that should be applied in addition to any firewall filter.",
        "solution": "To configure a client list issue the following command under the [edit snmp] hierarchy;\n\n[edit snmp]\nuser@host#edit client-list[edit snmp client-list]\nuser@host#set default restrict\nuser@host#setuser@host#setrestrict #optionally add exceptions\nuser@host#up 1\n\n[edit snmp]\nuser@host#edit community[edit snmp community]\nuser@host#set client-list-nameThe set default restrict is covered in detail in the next recommendation.\nAdditional IP Addresses may be permitted by repeating the setcommand as needed.\nOptionally, addresses that you wish to deny from within a permitted range previously set can be configured with the setrestrict command.\nNote - Client-lists may also be defined directly under the [edit snmp communityclients] hierarchy for use within the specified community with the same effect, but for ease of management and audit, the first method is preferred.\n\nDefault Value:\n\nNo SNMP communities are set by default on most platforms.",
        "reference": "800-171|3.13.1,800-53|SC-3,800-53|SC-7(15),800-53r5|SC-3,800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|4.6,CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-3,ITSG-33|SC-3a.,ITSG-33|SC-7(15),LEVEL|1A,NESA|T3.4.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set snmp .+",
        "expect": "set snmp .+ client-list-name"
    },
    "custom_item_45": {
        "description": "5.4 Ensure 'Default Restrict' is set in all client lists",
        "info": "Limit clients to access SNMP.\n\nRationale:\n\nEven when limited to read only access, SNMP can provide an attacker with a wealth of information about your router and network topology.\n\nTo limit the potential for attacks against your routers SNMP service your client lists should be configured to deny any source address which is not explicitly permitted (by being added to the list).",
        "solution": "To configure a client list issue the following command under the [edit snmp client-list] hierarchy;\n\n[edit snmp client-list]\nuser@host#set default restrict\n\nNote - Client-lists may also be defined directly under the [edit snmp communityclients] hierarchy for use within the specified community with the same effect, but for ease of management and audit, the first method is preferred.\n\nDefault Value:\n\nNo SNMP communities are set by default on most platforms.",
        "reference": "800-53|SC-3,800-53r5|SC-3,CSCv7|4.6,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-3,ITSG-33|SC-3a.,LEVEL|1A,NESA|T3.4.1,NESA|T4.3.1,NESA|T4.3.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set snmp .+ default restrict",
        "number_of_lines": "^([1-9]|[0-9][0-9]+)+$"
    },
    "custom_item_46": {
        "description": "5.8 Ensure interface restrictions are set for SNMP",
        "info": "SNMP should only be configured on required interfaces.\n\nRationale:\n\nBy default the SNMP service will listen for incoming connections on all interfaces which have an IP Address configured, exposing SNMP to users on all networks through which the router is reachable.\n\nIn most cases the router should only be manageable over some of its interfaces; in particular a router providing connectivity to untrusted networks such as the Internet should only be manageable from trusted sources.",
        "solution": "To restrict SNMP to required interfaces issue the following command from the [edit snmp] hierarchy;\n\n[edit snmp]\nuser@host#set interfaceDefault Value:\n\nBy default SNMP, when configured, is accessible over all configured interfaces.",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set snmp interface .+",
        "number_of_lines": "^([1-9]|[1-9][0-9])$"
    },
    "custom_item_47": {
        "description": "6.1.1 Ensure Accounting Destination is configured",
        "info": "Where external Authentication, Authorization and Accounting services using either RADIUS or TACACS+ are used, accounting data should be sent to at least one AAA server destination.\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services.\n\nBoth protocols provide services to receive and record information about what users and processes on a router are doing.\n\nWhere RADIUS or TACACS+ are configured for AAA, at least one accounting RADIUS or TACACS+ server should be configured to record accounting data for the JUNOS device. Generally, it is recommended that more than one server is used to ensure resilience of this vital service.",
        "solution": "Configure one or more RADIUS or TACACS+ servers as Accounting Destinations use the following commands under the [edit system accounting destination] hierarchy; For RADIUS\n\n[edit system accounting destination]\nuser@host#set radius serversecretFor TACACS+\n\n[edit system accounting destination]\nuser@host#set tacplus serversecretDefault Value:\n\nAccounting is not configured by default.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-3,800-53|AU-9(2),800-53|AU-12,800-53r5|AU-3,800-53r5|AU-9(2),800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(b),CN-L3|8.1.4.3(c),CSCv7|6.2,CSCv7|6.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-3,ITSG-33|AU-9(2),ITSG-33|AU-12,LEVEL|1A,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS13e,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv3.2.1|10.5.3,PCI-DSSv3.2.1|10.5.4,PCI-DSSv4.0|10.2.2,PCI-DSSv4.0|10.3.3,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system accounting destination .+ server",
        "number_of_lines": "^([1-9]|[1-9][0-9]+)+$"
    },
    "custom_item_48": {
        "description": "6.1.2 Ensure Accounting of Logins",
        "info": "When External AAA is used, Login Events should be sent to configured accounting destinations.\n\nRationale:\n\nTo protect any asset, including a Juniper router, you have to have a record of who logged in or attempted to login as well as who made changes to the configuration and when.\n\nJUNOS can log these events to RADIUS and/or TACACS+ servers to allow reliable, centralized records to be kept for all of the devices in your network.",
        "solution": "Configure Accounting of Logins and Configuration Changes by entering the following commands under the [edit system accounting] hierarchy;\n\n[edit system accounting]\nuser@host#set events login\n\nDefault Value:\n\nExternal accounting is not configured by default",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system accounting .+",
        "expect": "set system accounting events login"
    },
    "custom_item_49": {
        "description": "6.1.3 Ensure Accounting of Configuration Changes",
        "info": "When External AAA is used Configuration Change events should be sent to configured accounting destinations.\n\nRationale:\n\nTo protect any asset, including a Juniper router, an audit trail of changes made to the devices configuration, when they were made and by whom is essential.\n\nJUNOS can log these events to RADIUS and/or TACACS+ servers to allow reliable, centralized records to be kept for all of the devices in your network.",
        "solution": "Configure Accounting of Logins and Configuration Changes by entering the following commands under the [edit system accounting] hierarchy;\n\n[edit system accounting]\nuser@host#set events change-log\n\nDefault Value:\n\nExternal accounting is not configured by default",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system accounting .+",
        "expect": "set system accounting events change-log"
    },
    "custom_item_50": {
        "description": "6.2.3 Ensure NO Plain Text Archive Sites are configured",
        "info": "The routers configuration MUST NOT be sent in plain text to the Archive Site.\n\nRationale:\n\nJUNOS routers can use a range of protocols for copying configuration files to Archive Sites including FTP, TFTP, NFS and SCP. Of these, only Secure Copy (SCP) provides encryption for the data in transit. Using FTP, FTP or NFS transfer files in plain text, allowing an attacker to copy the file from the network exposing sensitive data and possibly authentication information for both the router and the Archive Site.",
        "solution": "Archival is not configured by default. If plain text Archive Sites have been configured, they can be removed by issuing the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#delete archival configuration archive-siteArchive sites should be reconfigured using SCP.\n\nDefault Value:\n\nArchival is not configured by default.",
        "reference": "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSCv7|10.4,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,LEVEL|1A,NESA|M5.2.3,NESA|T2.2.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system archival .+",
        "not_expect": "(ftp|file|tftp)"
    },
    "custom_item_51": {
        "description": "6.3.1 Ensure external AAA is used",
        "info": "At least one external Authentication method should be specified.\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services. Both protocols provide services to authenticate users on routers, switches and other systems.\n\nJuniper routers support both RADIUS and TACACS+ authentication. JUNOS will use each of the configured protocols in order set under [edit system authentication-order] until the password is accepted or the end of the list is reached.\n\nIt is vital to understand the impact of this behavior and its relation to security. If the order is set as RADIUS then TACACS+, the router will attempt to authenticate a user's credentials first using the RADIUS server. If the RADIUS server cannot be reach or the login is denied the router will attempt to authenticate against TACACS+.\n\nSettings for RADIUS or TACACS+ servers themselves for Authentication are configured separately under the [edit system radius-server] or [edit system tacplus-server] hierarchies respectively.",
        "solution": "Configure at least one external Authentication method using the following commands under the [edit system] hierarchy; For RADIUS\n\n[edit system]\nuser@host#set authentication-order radius\n\nFor TACACS+\n\n[edit system]\nuser@host#set authentication-order tacplus\n\nFor RADIUS then TACACS+\n\n[edit system]\nuser@host#set authentication-order [radius, tacplus]\n\nFor TACACS+ then RADIUS\n\n[edit system]\nuser@host#set authentication-order [tacplus, radius]\n\nDefault Value:\n\nBy default all Juniper routers use local password authentication with accounts set under the [edit system login user] hierarchy.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system authentication-order .+",
        "expect": "(radius|tacplus)"
    },
    "custom_item_52": {
        "description": "6.3.2 Ensure Local Accounts can ONLY be used during loss of external AAA",
        "info": "Authentication using locally configured usernames and passwords should only be permitted when External AAA servers are down or cannot be reached.\n\nRationale:\n\nJuniper routers support local user accounts in addition to RADIUS and TACACS+ based authentication. JUNOS will use each of the configured protocols in order set under [edit system authentication-order] until the password is either accepted or the end of the list is reached.\n\nIt is vital to understand the impact of this behavior and its relation to security.\n\nIf the order is set as RADIUS then local password, the router will attempt to authenticate a user's credentials first using the RADIUS server. If the RADIUS server cannot be reach or the login is denied the router will attempt to authenticate against the user accounts configured in the [edit system login user] hierarchy.\n\nBecause local user accounts cannot be centrally audited and controlled they present a far greater risk when, for example, and account is compromised or an employee leaves the organization.\n\nBy removing local authentication from the authentication-order you prevent these accounts being used when RADIUS or TACACS+ reject an authentication attempt; however local accounts remain usable on occasions where all other authentication services cannot be reached such as during router maintenance or AAA server outages.",
        "solution": "Remove local user authentication from the authentication order by issuing the following command from the [edit system] hierarchy; [edit system]\n\nuser@host#delete authentication-order password\n\nThis command will leave other authentication methods (RADIUS or TACACS+) that are already configured under the authentication-order statement.\n\nDefault Value:\n\nBy default all Juniper routers use local password authentication with accounts set under the [edit system login user] hierarchy.",
        "reference": "800-171|3.1.1,800-171|3.5.1,800-53|AC-2,800-53|IA-2,800-53r5|AC-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(d),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16,CSCv7|16.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|1A,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system authentication-order",
        "not_expect": "password"
    },
    "custom_item_53": {
        "description": "6.4.1 Ensure Authentication is configured for Diagnostic Ports",
        "info": "An encrypted password should be set for access to the routers diagnostic ports.\n\nRationale:\n\nMost high end Juniper network devices contain Diagnostic Ports on one or more of the control boards installed in the system, such as FEB (Forwarding Engine Board) in M5 or M10 routers or SSB (System Switching Board) in M20 routers. These ports allow access to a range of diagnostic functions and could provide an attacker with physical access to the system a route to bypass other controls in order to compromise the router.\n\nBecause of this risk, it is possible to set a password for all Diagnostic Ports installed in the system. As with other similar items, the password is stored by JUNOS as a hash (in this case MD5) in the configuration file. Please note, only local authentication is supported for the Diagnostic Ports, which are intended for limited use only, often when the device is experience a serious outage where external AAA services may be unavailable.\n\nShould a system not contain any diagnostic ports, this item of configuration is ignored by the device.",
        "solution": "Configure a password for the diagnostic ports using one of the following commands under the [edit system] hierarchy; To enter a new password in plain text:\n\n[edit system]\nuser@host#set diag-port-authentication plain-text-password\n\nYou will be prompted to enter the new password, which JUNOS will then hash with MD5 before placing the command in the candidate configuration. To enter an existing password hash which you have taken from an existing configuration file, type the following :\n\n[edit system]\nuser@host#set diag-port-authentication encrypted-password ''\n\nDefault Value:\n\nBy default no password is configured for diagnostic ports",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system diag-port-authentication encrypted-password .+",
        "number_of_lines": "^[1-9]+$"
    },
    "custom_item_54": {
        "description": "6.4.2 Ensure Diagnostic Port Authentication uses a complex password",
        "info": "A complex password should be used to protect access to Diagnostic Port/s\n\nRationale:\n\nDue to the sensitivity of the routers Diagnostic Port/s a complex password should be employed to help prevent attackers employing 'brute force' or 'dictionary' attacks to gain access through these ports.\n\nPasswords are stored, automatically by JUNOS, as a MD5 hash in the configuration under the [edit system diag-port-authentication] hierarchy.\n\nA complex password should be employed which meets or exceeds the following requirements:\n\nDoes not contain Dictionary words, names, dates, phone numbers or addresses.\n\nIs at least 8 characters in length (longer is recommended).\n\nContains at least one each of upper & lower case letters, numbers and special characters.\n\nAvoids more than 4 digits or same case letters in a row.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a password for the diagnostic ports using one of the following commands under the [edit system] hierarchy; To enter a new password in plain text :\n\n[edit system]\nuser@host#set diag-port-authentication plain-text-password\n\nYou will be prompted to enter the new password, which JUNOS will then hash with MD5 before placing the command in the candidate configuration. To enter an existing password hash which you have taken from an existing configuration file, type the following :\n\n[edit system]\nuser@host#set diag-port-authentication encrypted-password ''",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|4.2,CSCv7|4.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system diag-port-authentication"
    },
    "custom_item_55": {
        "description": "6.5.3 Ensure ICMP Source-Quench is Set to Disabled",
        "info": "ICMP Source Quench messages should be ignored.\n\nRationale:\n\nICMP Source Quench messages are intended to allow a host to request that a peer with which it is communicating slows down the transmission of new data because the host is being overwhelmed.\n\nSeveral recorded vulnerabilities have shown how Source Quench messages may be abused by an attacker to create a DoS attack, causing the router to slow down transmission of data to one, several or all destinations. Due to these vulnerabilities, and the general ineffectiveness of Source Quench for congestion control, RFC6633 deprecated its use and ICMP Source Quench should be disabled.\n\nImpact:\n\nICMP Source Quench is deprecated and there is no valid reason for ICMP Source Quench to be present on a modern network.",
        "solution": "Configure the JUNOS Device to ignore ICMP source-quench messages by issuing the following command from the [edit system internet-options] hierarchy.\n\n[edit system internet-options]\nuser@host#set no-source-quench\n\nDefault Value:\n\nBy default the router does not ignore ICMP Source Quench messages.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system internet-options .+",
        "expect": "set system internet-options no-source-quench"
    },
    "custom_item_56": {
        "description": "6.5.4 Ensure TCP SYN/FIN is Set to Drop",
        "info": "TCP Segments which have both the SYN and FIN flags set should be dropped.\n\nRationale:\n\nTCP packets that have both SYN and FIN flags set are sometimes used by attackers to bypass Intrusion Detection Systems and Firewalls or to directly attack hosts on the target network. If patches are up-to-date then most systems are no longer vulnerable to this technique; however, there is no valid reason for a packet to contain both SYN and FIN flags, so such traffic is almost certainly malicious or the result of an error and should never be processed.\n\nImpact:\n\nThere is no valid reason for a TCP Segment to have both SYN and FIN flags set.",
        "solution": "Configure the router to drop TCP Segments containing both SYN and FIN flags by issuing the following command from the [edit system internet-options] hierarchy.\n\n[edit system internet-options]\nuser@host#set tcp-drop-synfin-set\n\nDefault Value:\n\nBy default JUNOS does not drop TCP packets with both TCP SYN and FIN flags set.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system internet-options .+",
        "expect": "set system internet-options tcp-drop-synfin-set"
    },
    "custom_item_57": {
        "description": "6.5.5 Ensure TCP RST is Set to Disabled",
        "info": "Connection attempts to a closed / non-listening port should not return a TCP RST\n\nRationale:\n\nAs with most Operating Systems, by default, when a client attempts to connect to a TCP port which is not being used by a service to listen for connections JUNOS will return a TCP RST message to inform the client that there is no service available on that port.\n\nThis behavior may aide an attacker who is performing port scanning to identify open services as part of a reconnaissance of the network or may allow Denial of Service (DoS) attack to be performed by placing unnecessary processing load on the Routing Engine.\n\nNo valid use exists for attempting to connect to non-listening ports on a router or other network device, so JUNOS should be configured to silently drop all packets (with any flags) sent to closed TCP ports without sending a TCP reset (RST). The client attempting to connect will timeout rather than getting instant feedback, reducing the load on the JUNOS device and increasing the time required for any port scanning.\n\nImpact:\n\nConnection attempts to closed/non-listening ports on the JUNOS Device will time out rather than receiving a TCP RST.",
        "solution": "To disable sending TCP RSTs to any connections to closed ports issue the following command from the [edit system internet-options] hierarchy.\n\n[edit system internet-options]\nuser@host#set no-tcp-reset drop-all-tcp\n\nDefault Value:\n\nBy default JUNOS sends TCP RSTs to connections made to non-listening ports.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system internet-options .+",
        "expect": "set system internet-options no-tcp-reset drop-all-tcp"
    },
    "custom_item_58": {
        "description": "6.6.1.1 Ensure Max 3 Failed Login Attempts",
        "info": "A maximum of 3 failed login attempts should be allowed before the session is disconnected.\n\nRationale:\n\nRemote administration protocols like Telnet and SSH are commonly targeted by Brute Force or Dictionary attacks where a malicious user attempts to guess a valid username/password combination in order to gain control of the router. To slow down the rate at which an attacker can attempt to guess passwords, sessions should be disconnected after no more than 3 failed login attempts (a lower value can be used if preferred).",
        "solution": "Configure the number of tried before disconnect using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login retry-options tries-before-disconnect\n\nDefault Value:\n\nFor most JUNOS version the default is to disconnect after 10 failed login attempts.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options tries-before-disconnect [1-3]"
    },
    "custom_item_59": {
        "description": "6.6.1.2 Ensure Max Login Backoff Threshold of 2",
        "info": "A maximum of 2 failed login should trigger a backoff.\n\nRationale:\n\nRemote administration protocols like Telnet and SSH are commonly targeted by Brute Force or Dictionary attacks where a malicious user attempts to guess a valid username/password combination in order to gain control of the router. To slow down the rate at which an attacker can attempt to guess passwords Juniper routers can initiate a backoff timer when a user login fails more times than a configured threshold. Once initiated the backoff will not allow a further login attempt by the user for a configured (see next recommendation) period of time called the backoff factor. After the next failed login attempt further logins will not be allowed for the 2x the backoff factor, then 3x and so on.",
        "solution": "Configure the backoff threshold using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login retry-options backoff-thresholdDefault Value:\n\nFor most JUNOS version the default is to backoff after 2 failed login attempts.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options backoff-threshold [1-2]"
    },
    "custom_item_60": {
        "description": "6.6.1.3 Ensure Minimum Backoff Factor of 5",
        "info": "A minimum of 5 seconds should be used for the backoff factor.\n\nRationale:\n\nRemote administration protocols like Telnet and SSH are commonly targeted by Brute Force or Dictionary attacks where a malicious user attempts to guess a valid username/password combination in order to gain control of the router. To slow down the rate at which an attacker can attempt to guess passwords Juniper routers can initiate a backoff timer when a user login fails more times than a configured threshold. Once initiated the backoff will not allow a further login attempt by the user for a configured (see next recommendation) period of time called the backoff factor. After the next failed login attempt further logins will not be allowed for the 2x the backoff factor, then 3x and so on.",
        "solution": "Configure the backoff threshold using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login retry-options backoff-factor\n\nDefault Value:\n\nFor most JUNOS version the default is to backoff factor of 5 seconds.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options backoff-factor ([5-9]|[1-9][0-9]+)"
    },
    "custom_item_61": {
        "description": "6.6.1.4 Ensure Minimum Session Time of at least 20 seconds",
        "info": "A Minimum Session Time should be set to at least 20 seconds.\n\nRationale:\n\nRemote administration protocols like Telnet and SSH are commonly targeted by Brute Force or Dictionary attacks where a malicious user attempts to guess a valid username/password combination in order to gain control of the router. To slow down the rate at which an attacker can attempt to guess passwords Juniper routers can enforce a minimum session time, preventing an attacker from attempting to circumvent the backoff timer through using multiple sessions.",
        "solution": "Configure the Minimum Session Time using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login retry-options minimum-time\n\nDefault Value:\n\nFor most JUNOS version the default is a Minimum Session Time of 20 seconds.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options minimum-time ([2-5][0-9]|60)"
    },
    "custom_item_62": {
        "description": "6.6.1.5 Ensure Lockout-period is set to at least 30 minutes",
        "info": "Users who have been disconnected due to bad login attempts should be locked out for 30 minutes.\n\nRationale:\n\nRemote administration protocols like Telnet and SSH are commonly targeted by Brute Force or Dictionary attacks where a malicious user attempts to guess a valid username/password combination in order to gain control of the router.\n\nTo slow down the rate at which an attacker can attempt to guess passwords accounts disconnected by the tries-before-disconnect option should be locked out for a period of 30 minutes.",
        "solution": "Configure the time users should be locked out using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login retry-options lockout-period 30\n\nDefault Value:\n\nBy default users who are disconnected for multiple failed login attempts are not locked out.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options lockout-period ([3-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-3][0-9]{4}|4[0-2][0-9]{3}|43[01][0-9]{2}|43200)"
    },
    "custom_item_63": {
        "description": "6.6.2 Ensure Login Class is set for all Users Accounts",
        "info": "All user accounts must have a class set.\n\nRationale:\n\nControlling the level of access which users are granted when logging into a router, helps protect against both malicious attacks and accidental misconfiguration of the router by less experienced staff.\n\nConfiguring user permissions on a user by user basis can quickly become unwieldy and difficult to manage, potentially leading to mistakes with a serious impact on the routers security. Instead, permissions should be assigned to classes to which individual users are linked in order to grant the appropriate level of access that corresponds with their job role.\n\nJUNOS provides 4 built in Login Classes:\n\nOperator (can perform operational commands like ping but cannot view or edit the configuration or reboot the device)\n\nread-only (can view configuration and perform some operational commands)\n\nsuper-user (can issue any command)\n\nunauthorized (can login, but cannot perform any actions except for logging out)\n\nIn addition to the built in classes, JUNOS allows administrators to configure Custom Login Classes and to permit or deny additional permissions through Vendor Specific Attributes used with External AAA Servers like RADIUS or TACACS+.\n\nBecause a user account, whether being used for a local user or used as a template for logins from External AAA, will be placed in the highly privileged 'super-user' class by default - it is essential that all user accounts be explicitly configured with the required login class, even when further restrictions are being applied through permit/deny commands by External AAA.",
        "solution": "Configure a class for a user account using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set userclassDefault Value:\n\nBy default all users are, in effect, members of the super-user class.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53|AC-3,800-53r5|AC-2,800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login user .+",
        "expect": "set system login user .+ class .+"
    },
    "custom_item_64": {
        "description": "6.6.3 Ensure Idle Timeout is set for all Login Classes",
        "info": "All login classes should have an idle timeout defined.\n\nRationale:\n\nControlling the level of access which users are granted when logging into a router, helps protect against both malicious attacks and accidental misconfiguration of the router by less experienced staff.\n\nLogin classes should be defined to grant permissions to user accounts, both local and remote, allowing permissions to be managed in a similar manner to User Groups on a Microsoft Windows system.\n\nAll login classes should have an Idle Timeout of no more than 15 minutes configured, so that unused sessions are automatically logged out after this time, limiting the scope for abuse of unattended sessions.\n\nNote - The built in Super-User Class does not have an Idle Timeout configured and, for this reason, should be used extremely sparingly if at all.",
        "solution": "Configure the Idle Timeout for a class using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set classidle-timeoutDefault Value:\n\nNo idle timeout is defined by default.",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-53|AC-2,800-53|AC-11,800-53r5|AC-2,800-53r5|AC-11,CN-L3|7.1.3.2(d),CN-L3|8.1.4.1(b),CSCv7|16,CSCv7|16.11,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2,ITSG-33|AC-11,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login class .+ idle-timeout",
        "expect": "set system login class .+ idle-timeout ([0-9]|1[0-5])"
    },
    "custom_item_65": {
        "description": "6.6.4 Ensure Custom Login Classes have Permissions Defined",
        "info": "All login classes should have permissions defined.\n\nRationale:\n\nControlling the level of access which users are granted when logging into a router, helps protect against both malicious attacks and accidental misconfiguration of the router by less experienced staff. Login classes should be defined to grant permissions to user accounts, both local and remote, allowing permissions to be managed in a similar manner to User Groups on a Microsoft Windows system.\n\nAll Custom Login classes should have one more permissions defined which will be applied to all users, local and remote, linked to the class.",
        "solution": "Configure the Permissions for a class using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set classpermissionsDefault Value:\n\nNo permissions are defined by default.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53|AC-3,800-53r5|AC-2,800-53r5|AC-3,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login class .+",
        "expect": "set system login class .+ permissions"
    },
    "custom_item_66": {
        "description": "6.6.5 Ensure all Custom Login Classes Forbid Shell Access",
        "info": "All login classes should deny Shell access.\n\nRationale:\n\nJUNOS runs on top of a heavily modified BSD Unix based operating system and users with certain permission sets will be able to start a Shell to interact with this underlying system directly. Once within a Unix Shell a user may execute scripts or applications and perform changes outside of the normal Authentication, Authorization and Accounting (AAA) mechanisms which protect the router when a user performs commands in JUNOS.\n\nAccess to the underlying Unix Shell is not required in normal operation for almost all deployments and the default position should be for this to be denied.\n\nIn the rare instances where it is required, access to the Shell should be restricted to a very small number of users, ideally only being granted on a case by case basis and removed when the task requiring access is complete.\n\nTo ensure all interaction with the router will need to be performed through JUNOS, all Custom Login Classes should have access to the shell explicitly denied.",
        "solution": "Deny Shell access for a class using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set classdeny-commands 'start shell'\n\nYou may also wish to deny other commands or groups of commands by using a list or Regular Expression as the deny-commands value, ensure that start shell is still included.\n\nDefault Value:\n\nShell access is not restricted by default.",
        "reference": "800-171|3.1.1,800-171|3.1.7,800-53|AC-2,800-53|AC-6(10),800-53r5|AC-2,800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.7,CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login .+ deny-commands",
        "expect": "set system login .+ deny-commands.*start shell.*"
    },
    "custom_item_67": {
        "description": "6.6.6 Ensure Predefined Login Classes are not used",
        "info": "All user accounts must have a class set, but the Predefined JUNOS Login Classes should be avoided.\n\nRationale:\n\nJUNOS routers ship with 4 Predefined Login Classes, these are:\n\nsuper-user\n\nread-only\n\noperator\n\nunauthorized\n\nThese classes provide basic configuration to allow organizations to get a router up and running, but do not provide fine grained control needed by all but very smallest organizations.\n\nThe built in classes also do not meet the other recommendations in this section. For example, the super-user class (which is the only built in class with read/write permissions) also has permission to start a Unix Shell and does not have an Idle Session Timeout.\n\nBecause of these limitations it is recommended that Custom Login Classes be defined following the principle of least privilege, where each class of users is granted only those permissions needed to complete their job role.\n\nAll of these class should meet the other requirements in this section and no users (either local or remote template users) should use the built-in accounts.\n\nImpact:\n\nCareful configuration of permissions following the least privilege principle is essential for secure and reliable management of the network.\n\nFor larger networks, creating and maintaining Login Classes on each individual device may become cumbersome and error prone - for these environments it is suggested you consider the Level 2 Recommendation 'Ensure Remote Login Class for Authorization through External AAA'.",
        "solution": "To create a new class you can issue the following commands from the [edit system login] hierarchy. In this example, we create a new class named 'noc' and allow them permissions to run show commands like show bgp summary, view the configuration and access the network with ping, SSH, traceroute and Telnet.\n\n[edit system login]\nuser@host#set class noc permissions [ view view-configuration network ]\n\n(this class should also have Idle timeouts and other options set in line with other recommendations in this section).\nTo change the class for a user account, use the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set userclassDefault Value:\n\nBy default all users are, in effect, members of the super-user class.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login class",
        "not_expect": "(superuser|super-user|read-only|operator|unauthorized)"
    },
    "custom_item_68": {
        "description": "6.6.8 Ensure login message is set",
        "info": "A login message should be displayed before a user logs into the router.\n\nRationale:\n\nPrior to a user logging into the router a legal notice should be displayed warning that they are connecting to a private system.\n\nThis legal notice may be necessary to protect your organizations rights to pursue legal action or to monitor users of the system. It might, in general:\n\nWarn that this is a private system\n\nTell unauthorized users that they should disconnect immediately\n\nInform users that activity is monitored/recorded and may be shared with 3rd parties or used in a criminal investigation\n\nMay reference applicable legislation\n\nMay specify that continuing to login constitutes agreement to an Acceptable Use policy or similar\n\nMay provide contact details for any queries\n\nNOTE The wording of the legal notice is normally defined as part of an organization's security policy. You should consult your organizations legal department or counsel to ensure the legality of the banner message and suitability for the country/s in which you operate.",
        "solution": "Configure a login message using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login message ''\n\nDefault Value:\n\nBy default no login message is set.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login message",
        "content": "@LOGIN_MESSAGE@"
    },
    "custom_item_69": {
        "description": "6.6.9 Ensure local passwords require multiple character sets",
        "info": "Passwords for local user accounts must be configured to require character set changes.\n\nRationale:\n\nWeak passwords on local user accounts present a serious threat to the security of any device, allowing malicious user access through simple dictionary or brute force attacks.\n\nFortunately JUNOS provides a mechanism for enforcing complexity requirements when new passwords are initially set in plain-text.\n\nSecure passwords should contain characters from number of different character sets (Upper case letters, Lower case letters, Numbers, Punctuation and Special Characters) and JUNOS should be configured to force passwords for local users to meet this requirement.",
        "solution": "Configure a password character set changes using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login password change-type character-set\n\nDefault Value:\n\nFor routers running JUNOS the default is change-type is character-set. For routers running JUNOS FIPS the default is set-transitions.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login password .+",
        "expect": "set system login password change-type character-sets"
    },
    "custom_item_70": {
        "description": "6.6.10 Ensure at least 4 set changes in local passwords",
        "info": "Passwords for local user accounts must be configured to require at least 4 character set changes.\n\nRationale:\n\nWeak passwords on local user accounts present a serious threat to the security of any device, allowing malicious user access through simple dictionary or brute force attacks.\n\nFortunately JUNOS provides a mechanism for enforcing complexity requirements when new passwords are initially set in plain-text.\n\nSecure passwords should contain characters from at least 4 different character sets (Upper case letters, Lower case letters, Numbers, Punctuation and Special Characters) and JUNOS should be configured to force users' passwords to meet this requirement.",
        "solution": "Configure the minimum character set changes using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login passwords minimum-changes 4\n\nDefault Value:\n\nFor routers running JUNOS the default is minimum changes is 1. For routers running JUNOS FIPS the default is 3.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-changes [4-9]"
    },
    "custom_item_71": {
        "description": "6.6.11 Ensure local passwords are at least 10 characters",
        "info": "Passwords for local user accounts must be configured to require at least 10 characters.\n\nRationale:\n\nWeak passwords on local user accounts present a serious threat to the security of the device, allowing malicious user access through simple dictionary or brute force attacks.\n\nFortunately JUNOS provides a mechanism for enforcing complexity requirements when new passwords are initially set in plain-text.\n\nSecure passwords should be required to contain at least 10 characters in line with the minimum enforced by JUNOS FIPS compliant versions.",
        "solution": "Configure the minimum characters for passwords using the following command under the [edit system] hierarchy:\n\n[edit system]\nuser@host#set login passwords minimum-length 8\n\nDefault Value:\n\nFor routers running JUNOS the default minimum-length is 6. For routers running JUNOS FIPS the default is 10.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-length ([8-9]|[1-9][0-9]+)"
    },
    "custom_item_72": {
        "description": "6.6.12 Ensure SHA512 is used to hash local passwords",
        "info": "Passwords should be hashed with a strong hashing algorithm.\n\nRationale:\n\nPasswords for locally configured users are stored in the JUNOS configuration file.\n\nBy applying a hashing algorithm to the password before storing it, JUNOS limits an attacker's ability to gain passwords from configuration backups or to escalate privileges when using a different account through the CLI.\n\nJUNOS hashes local passwords using MD5, or SHA1 for FIPS mode devices, by default. However, both are older algorithms and are widely considered to be weak for this type of usage.\n\nThe newer SHA-2 algorithm should be used with a 512bit digest wherever possible, however, some older but still supported JUNOS devices do not support this (see notes for more details).",
        "solution": "Confirm that your device supports SHA-2 with 512bit hashes by issuing the following command from the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set password format ?\n\nThe system should provide a range of options, such as in the example below which is for a system which does support SHA512:\n\n[edit system login]\nuser@host# set password format ?\nPossible completions:\n  md5                  Message Digest 5\n  sha1                 Secure Hash Algorithm 1\n  sha256               Secure Hash Algorithm 256 ($5$)\n  sha512               Secure Hash Algorithm 512 ($6$)\n[edit system login]\n\nConfigure password hashing using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set login password format sha512\n\nFor systems which do not support SHA-2 with 512bit hashes, configure SHA-1 using the following command under the [edit system login] hierarchy:\n\n[edit system login]\nuser@host#set login password format sha1\n\nNOTE - SHA1 hashing should only be configured on systems which do not support SHA512.\n\nDefault Value:\n\nFor routers running JUNOS the default format is MD5. For routers running JUNOS FIPS the default is SHA1.\n\nAdditional Information:\n\nSome currently supported platforms running the JTAC recommended release, such as some older SRX Branch devices (SRX100, 200, etc), do not support the SHA256 or SHA512 options.\n\nIf your JUNOS device does not support SHA512 or SHA256, the older SHA1 format should be used as a minimum.\n\nFor organizations with particular security concerns or where SHA1 does not meet regulatory/company policy requirements; it is recommended that you consider replacing these devices with newer equivalents which do support the stronger hashing algorithms, for example replacing an SRX200 with an SRX300 model.",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login password .+",
        "expect": "set system login password format (sha1|sha512)"
    },
    "custom_item_73": {
        "description": "6.6.13 Ensure SSH Key Authentication is not set for User Logins",
        "info": "SSH Key Based Authentication should not be used for User Logins\n\nRationale:\n\nDue to the sensitive nature of SSH, potentially allowing full management of the targeted device, protecting SSH access using strong authentication methods is essential to the security of the device.\n\nOne method which is supported in SSH for stronger authentication is the use of Public/Private Encryption Key Pairs in place of a more traditional login prompt for a Username and Password. Instead, an administrator uploads the user's Public key to the JUNOS (or other) device to be managed.\n\nWhen the user connects, they will use their Private key to encrypt some session specific data. The JUNOS device can verify the Users identity by decrypting that data using the Public key configured previously and comparing it to an expected result. If the results match, then the user must have access to the Private key, so is considered valid.\n\nUnfortunately using SSH Keys to authenticate User Logins to JUNOS devices introduce a number of security issues:\n\nPublic Keys may only be configured locally on each JUNOS device\n\nPublic Keys are used instead of centralized AAA using TACACS+ or RADIUS as covered in Recommendation 6.8.1 Ensure External AAA Server is set\n\nThe use of SSH Keys means only a single Authentication Factor (the keys) can be used, preventing the use of Multi Factor Authentication as covered in 6.6.14 Ensure Multi-Factor is used with External AAA\n\nJUNOS does not provide any method to automate rollover or locking of keys. If keys are compromised/lost, they must be changed on every JUNOS device on which they are configured.\n\nSome SSH implementation support the use of X.509 PKI Certificates for managing SSH Keys, but JUNOS does not.\n\nBecause of these limitations and the difficulty in auditing and managing SSH Keys on JUNOS devices, this method should not be used for Authentication of User logins or for the Root User.\n\nIn some instances, such as when using PyEZ or NETCONF based automation over SSH, it may be preferable to authenticate a limited number of automation services using SSH Keys, rather than 'hard coding' user details into scripts. Where this is the case, it is imperative to have strong key management procedures in use to control and audit access to the Private Keys used and a process to allow for rollover and revocation of compromised keys.\n\nImpact:\n\nCareful configuration of permissions following the least privilege principle is essential for secure and reliable management of the network.\n\nWhen configuring remote AAA, it is recommended that a local Emergency Access Account also be configured to allow management of the device in the event that AAA services are unavailable.",
        "solution": "For each User Login configured with SSH Key based Authentication, you can delete the SSH Key with the following command from the [edit system login] hierarchy:\n\n[edit system login]\nuser@host# delete userauthentication\n\nThe user can then be configured with a password locally or, inline with Recommendation 6.8.1 Ensure External AAA Server is set , leave the authentication method blank and allow the External AAA to control Authentication.\nAlternatively, you may wish to delete the local user account entirely using the following command:\n\n[edit system login]\nuser@host# delete userDefault Value:\n\nBy default, JUNOS does not use SSH Key based Authentication",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system login user .+ authentication .+",
        "not_expect": "(sshdsa|ssh-ecdsa|ssh-ed25519|ssh-rsa)"
    },
    "custom_item_74": {
        "description": "6.7.1 Ensure External NTP Servers are set",
        "info": "At least one, and preferably three or more, external NTP Servers should be configured\n\nRationale:\n\nKeeping time settings consistent across a network is vital if log data is to be meaningful and usable in understanding faults and security incidents. Consistent time settings are also fundamental to the operation of some network protocols and services such as IPSec, PKI and 802.1x which may be critical to many networks.\n\nTo ensure that the time on your JUNOS router is consistent with other devices in your network, at least one, and preferably three or more, NTP Servers external to the device should be configured.\n\nAlthough NTP provides for a Peer to Peer type implementation, where individual time servers are not specified and methods such as broadcast and multicast are utilized to synchronize time between hosts, in almost all real world cases a Server / Client model should be used for network devices - even if multicast or broadcast methods are used for other types of hosts. Using specified time sources allows you to better secure, monitor and manage your NTP implementation; simplifying debugging and allowing tighter control of NTP traffic.\n\nWhile a complete discussion of NTP Architecture is beyond the scope of this Benchmark, it is strongly recommended that careful attention be paid to resilience, accuracy and reliability of NTP time sources used within your network.\n\nHaving multiple NTP servers helps to ensure fault tolerance and also protects against mis-configured or compromised servers causing radical time changes, something an attacker may want to achieve to cover their tracks or conduct replay attacks.\n\nImpact:\n\nIf time is not synchronised between devices, log messages cannot readily be correlated to allow administrators to understand events on the network. In addition, many services such as IPSEC, PKI or 802.1x which rely on Encryption may not function correctly if time and date settings are not properly maintained.",
        "solution": "Configure at least one External NTP Server using the following commands under the [edit system] hierarchy;\n\n[edit system]\nuser@host#set ntp serverDefault Value:\n\nBy default Juniper routers do not have NTP servers configured and use locally managed time.",
        "reference": "800-171|3.3.7,800-53|AU-8,800-53r5|AU-8,CN-L3|8.1.4.3(b),CSCv7|6.1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system ntp server .+",
        "number_of_lines": "^([2-9]|[1-9][0-9]+)$"
    },
    "custom_item_75": {
        "description": "6.7.4 Ensure NTP uses version 4",
        "info": "Version 4 of the NTP protocol should be utilized.\n\nRationale:\n\nNTP is one of the oldest Internet Standard protocols and has been around for over 30 years. As with most protocols, during its lifetime, NTP has received numerous revisions and updates to ensure it remains reliable and secure to use in modern networks.\n\nThe current reference version of NTP is Version 4. Version 4 adds significant enhancements to the protocols security which means it is widely accepted as the defacto standard for secure implementation and should be used for all network devices.",
        "solution": "Configure each External NTP Server to use NTP Version 4 using the following commands under the [edit system ntp] hierarchy:\n\n[edit system ntp]\nuser@host#set serverversion 4\n\nDefault Value:\n\nBy default all Juniper routers use NTP Version 4 when a server is explicitly configured.",
        "reference": "800-171|3.3.7,800-53|AU-8,800-53r5|AU-8,CN-L3|8.1.4.3(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system ntp server .+ version 4",
        "number_of_lines": "^([2-9]|[1-9][0-9]+)$"
    },
    "custom_item_76": {
        "description": "6.8.1 Ensure External AAA Server is set",
        "info": "At least one external Authentication server should be configured.\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services.\n\nBoth protocols provide services to Authenticate users on routers, switches and other systems. Juniper devices support both RADIUS and TACACS+ Authentication and you should configure at least one External Authentication Server of either type as configured under [edit system authentication-order].\n\nFor resilience it is generally recommended to configure multiple AAA Servers, which can be of the same type (both TACACS+ or both RADIUS) or can be mixed (one RADIUS and one TACACS+) as required so long as both are configured in [edit system authentication-order].\n\nThe External AAA Servers used must support Multi-Factor/Two Factor Authentication (MFA/2FA) methods as discussed in Recommendation 6.6.14 Ensure Multi-Factor is used with External AAA.\n\nThe secure configuration of the External AAA Services for features such as account lockout, password aging, complexity or MFA support are beyond the scope of this Benchmark to test but are essential to the secure operation of your network environment.\n\nImpact:\n\nEnsure that External AAA Servers are tested prior to deploying in a live environment.\n\nIt is generally recommended to configure a single 'Rescue' or 'Emergency' account locally under the [edit system login] hierarchy to provide access in the event of a AAA failure or mis-configuration prior to deploying External AAA.",
        "solution": "Configure at least one External Authentication Server using the following commands under the [edit system] hierarchy; For RADIUS\n\n[edit system]\nuser@host#set radius-serversecretsource-addressFor TACACS+\n\n[edit system]\nuser@host#set tacplus-serversecretsource-addressNOTE - the source-address is generally set as the Loopback, but for some environments the Fxp0.0/out of band interface may be used, or another interface preferred.\n\nDefault Value:\n\nNo External AAA is used by default",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53|IA-5,800-53r5|IA-2,800-53r5|IA-5,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv7|16.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,LEVEL|1A,NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system (radius-server|tacplus-server)",
        "number_of_lines": "^([1-9]|[1-9][0-9]+)$"
    },
    "custom_item_77": {
        "description": "6.8.2 Ensure Share-Secret is set for External AAA Servers",
        "info": "External AAA Servers should be configured with a Shared Secret.\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services.\n\nBoth protocols provide services to authenticate users on routers, switches and other systems. Because these servers are being trusted to authenticate and authorized your administrative users, it is vital to ensure the identity of the RADIUS or TACACS+ server.\n\nEach configured External AAA Server must be configured with a Shared Secret to ensure mutual authentication of the Client (the JUNOS Device) and Server.\n\nImpact:\n\nEnsure that External AAA Servers are tested prior to deploying in a live environment.\n\nIt is generally recommended to configure a single 'Rescue' or 'Emergency' account locally under the [edit system login] hierarchy to provide access in the event of a AAA failure or mis-configuration prior to deploying External AAA.",
        "solution": "Configure a Shared Secret for all External Authentication Server using the following commands under the [edit system] hierarchy; For RADIUS Servers:\n\n[edit system]\nuser@host#set radius-serversecretFor TACACS+ Servers:\n\n[edit system]\nuser@host#set tacplus-serversecretDefault Value:\n\nNo External AAA is configured by default.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|1A,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system (radius-server|tacplus-server) .+ secret",
        "number_of_lines": "^([1-9]|[1-9][0-9]+)$"
    },
    "custom_item_78": {
        "description": "6.8.3 Ensure a Different Shared Secret is Set for each External AAA Server",
        "info": "External AAA Servers should be configured with a Shared Secret.\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services.\n\nBoth protocols provide services to Authenticate and Authorization of users on routers, switches and other systems. Because these servers are being trusted to authenticate your administrative users, it is vital to ensure the identity of the RADIUS or TACACS+ server. With both protocols this is achieved by using a Shared Secret.\n\nTo ensure resilience and that compromise of a single AAA Server does not result in all AAA Servers being compromised, it is recommended that a different Secret Key be used for each AAA Server. This way, any server suspected of compromise can be taken offline and the remaining servers can remain trusted to provide AAA services.\n\nBecause the Shared Secrets are stored as salted hashed values in the JUNOS configuration, it is not possible to readily audit this Recommendation from the JUNOS device, so this Recommendation is not Scored.\n\nImpact:\n\nEnsure that External AAA Servers are tested prior to deploying in a live environment.\n\nIt is generally recommended to configure a single 'Rescue' or 'Emergency' account locally under the [edit system login] hierarchy to provide access in the event of a AAA failure or mis-configuration prior to deploying External AAA.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a Shared Secret for all External Authentication Server using the following commands under the [edit system] hierarchy; For RADIUS\n\n[edit system]\nuser@host#set radius-serversecretsource-addressFor TACACS+\n\n[edit system]\nuser@host#set tacplus-serversecretsource-addressDefault Value:\n\nNo External AAA is configured by default.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|1M,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system (radius-server|tacplus-server)"
    },
    "custom_item_79": {
        "description": "Check for radius",
        "regex": "set system radius-options .+",
        "expect": "set system radius-options .+"
    },
    "custom_item_80": {
        "description": "6.8.4 Ensure MS-CHAPv2 RADIUS Authentication",
        "info": "MS-CHAPv2 should be used for RADIUS authentication if RADIUS Servers are configured\n\nRationale:\n\nRADIUS is a centralized Authentication, Authorization and Accounting (AAA) protocol providing services to authenticate users on routers, switches and other systems.\n\nBy default, JUNOS devices which are configured to use RADIUS for External AAA use the Password Authentication Protocol (PAP) for Authenticating users. PAP is an old standard, dating back to Dial-up Internet connections where interception was not considered viable; so PAP sends the user's password in plain-text (unencrypted) over the network to the RADIUS server, exposing the password to interception and misuse.\n\nAll current JUNOS devices support the use of the stronger MS-CHAPv2 (Microsoft Challenge Handshake Authentication Protocol, Version 2) standard for user Authentication, which is widely supported.\n\nWith CHAP, the password is never sent over the network. Instead a 'challenge' is encrypted by the RADIUS Server and sent to the JUNOS device, which decrypts the challenge using the configured Secret. The JUNOS device combines the the decrypted Challenge with the password provided by the user into a Hash, which is returned to the RADIUS Server which performs the same Hash of the Challenge and the users password to determine whether to permit or deny the request.\n\nUse of MS-CHAPv2 on JUNOS Devices also allows for users to change their password if the password has expired.\n\nWhere RADIUS Servers are configured for External AAA, it is recommended that MS-CHAPv2 be used instead of, the default, PAP standard for user Authentication.\n\nImpact:\n\nEnsure that External AAA Servers are tested prior to deploying in a live environment.\n\nIt is generally recommended to configure a single 'Rescue' or 'Emergency' account locally under the [edit system login] hierarchy to provide access in the event of a AAA failure or mis-configuration prior to deploying External AAA.",
        "solution": "Configure RADIUS to use MS-CHAPv2 Authentication using the following commands under the [edit system] hierarchy;\n\n[edit system]\nuser@host#set radius-options password-protocol mschap-v2\n\nDefault Value:\n\nNo External AAA is configured by default.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-2,800-53r5|IA-5,800-53r5|IA-5(1),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv7|16.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,ITSG-33|IA-5(1),LEVEL|1A,NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system radius-options password-protocol .+",
        "expect": "set system radius-options password-protocol .+ mschap-v2"
    },
    "custom_item_81": {
        "description": "6.8.5 Ensure Source-Address is set for External AAA Servers",
        "info": "The Source-Address should be set for each External AAA Server configured\n\nRationale:\n\nRADIUS and TACACS+ are centralized Authentication, Authorization and Accounting (AAA) services.\n\nBoth protocols provide services to Authenticate users on routers, switches and other systems. Juniper devices support both RADIUS and TACACS+ Authentication and you should configure at least one External Authentication Server of either type.\n\nFor resilience it is generally recommended to configure multiple AAA Servers, which can be of the same type (both TACACS+ or both RADIUS) or can be mixed (one RADIUS and one TACACS+) as required so long as both are configured in [edit system authentication-order].\n\nRADIUS and TACACS+ servers are sensitive systems and should typically be protected by Firewall Filters and ACLs on the RADIUS/TACACS+ Service restricting the Source Address of valid clients. To ensure that these restrictions can be correctly, and strictly, applied - it is important to ensure that the Juniper device always uses the same Source Address when sending packets to these services, irrespective of the route being used.\n\nTo do this you should explicitly set the Source Address used for each server (these can be different addresses for different individual servers if required). Typically either the Loopback Address (assigned to Lo0.0) or Out of Band Management address (assigned to FXP0.0) in the Default/Master Virtual Router instance should be used as the Source Address.\n\nImpact:\n\nEnsure that External AAA Servers are tested prior to deploying in a live environment.\n\nIt is generally recommended to configure a single 'Rescue' or 'Emergency' account locally under the [edit system login] hierarchy to provide access in the event of a AAA failure or mis-configuration prior to deploying External AAA.",
        "solution": "Configure at least one External Authentication Server using the following commands under the [edit system] hierarchy; For RADIUS\n\n[edit system]\nuser@host#set radius-serversecretsource-addressOr for TACACS+\n\n[edit system]\nuser@host#set tacplus-serversecretsource-addressDefault Value:\n\nNo External AAA is used by default",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53|IA-5,800-53r5|IA-2,800-53r5|IA-5,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|16.2,CSCv7|16.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,LEVEL|1A,NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system (radius|tacplus)-server .+ secret .+ source-address .+",
        "number_of_lines": "^([1-9]|[1-9][0-9]+)$"
    },
    "custom_item_82": {
        "description": "6.9.1 Ensure a complex Root Password is Set",
        "info": "A complex Root Password should be set for the system.\n\nRationale:\n\nDue to the importance of the Root user account, which has full control of the JUNOS system and underlying Unix OS, a complex password should be employed to help prevent attackers employing 'brute force' or 'dictionary' attacks to gain full control of the router. Passwords are stored, automatically by JUNOS, as a SHA1 hash in the configuration under the [edit system root-authentication] hierarchy.\n\nA complex password should be employed which meets or exceeds the following requirements:\n\nDoes not contain Dictionary words, names, dates, phone numbers or addresses.\n\nIs at least 8 characters in length.\n\nContains at least one each of upper & lower case letters, numbers and special characters.\n\nAvoids more than 4 digits or same case letters in a row.\n\nBecause Root Authentication must be set before JUNOS will permit the first configuration commit on a new JUNOS system, password complexity requirements covered in other Recommendations may not yet be configured and do not apply to passwords retrospectively. Therefore it is important to manually ensure that a complex password is used for the Root account.\n\nImpact:\n\nRoot Authentication must be set prior to JUNOS allowing the first commit on a new system. Ensure that, while the Root password is complex, it is safely stored in a Password Vault or remembered as it will be required for access to the system until other accounts are configured or to perform certain tasks.",
        "solution": "Root Authentication must be configured prior to the first commit on a new system. A Root password may be set from the CLI using either of the two methods below, from the [edit system] hierarchy.\nTo enter a new Root Password in plain text type:\n\n[edit system]\nuser@host#set root-authentication plain-text-password\n\nYou will be prompted to enter the new Password twice and, if the Passwords match, JUNOS will add a SHA1 hash of the Password to the configuration.\nAlternatively, if you are copying the configuration from an existing JUNOS system (using the same hashing algorithm) or template, you may apply an existing hash of the Root password:\n\n[edit system]\nuser@host#set root-authentication encrypted-password ''\n\nDefault Value:\n\nThe Root Authentication is blank by default, but must be set prior to JUNOS allowing the first configuration to be committed.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system root-authentication .+",
        "expect": "set system root-authentication encrypted-password .+"
    },
    "custom_item_83": {
        "description": "6.9.2 Ensure Root Password is Unique",
        "info": "The Root Password should be unique.\n\nRationale:\n\nDue to the rights associated with the Root user account it must be protected at all costs to prevent malicious users taking ownership of the router.\n\nUsing the same password for an individual User or other usage exposes the extremely privileged Root user account to abuse by that user and introduces the need to manually change the Root password should that user leave the organization.\n\nFurther risks are presented by the lower level hashing algorithm which may be used to protect other system passwords. On some JUNOS systems or External AAA platforms these utilize MD5, a demonstrably less secure protocol then SHA1 which used for the Root password. Theoretically an attacker could exploit the weaker hashing used on these lesser system passwords to recover the Root password.\n\nFinally, the Root password should not be reused on other systems, including other routers, and should be stored securely - such as using a Password Manager. If the Root Password was the same across all of the routers and other systems in your network, the compromise of one host could result in the compromise of all hosts.\n\nImpact:\n\nRoot Authentication must be set prior to JUNOS allowing the first commit on a new system. Ensure that, while the Root password is complex, it is safely stored in a Password Vault or remembered as it will be required for access to the system until other accounts are configured or to perform certain tasks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Users will generally be prompted to set the Root password during initial setup of the router, however, a password may be set from the CLI using either of the two methods below from the [edit system] hierarchy; To enter a new Root Password in plain text type:\n\n[edit system]\nuser@host#set root-authentication plain-text-password\n\nYou will be prompted to enter the new Password twice and, if the Passwords match, JUNOS will add a SHA1 hash of the Password to the configuration. If you already have a SHA1 hash of your Root Password (from an existing router configuration, for example), enter the following command:\n\n[edit system]\nuser@host#set root-authentication encrypted-password ''\n\nIf JWEB is installed on your router, the Root Password may also be changed through the Configuration > Quick Configuration > Setup page.\n\nDefault Value:\n\nThe Root Authentication is blank by default, but must be set prior to JUNOS allowing the first configuration to be committed.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1M,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system root-authentication .+"
    },
    "custom_item_84": {
        "description": "6.9.3 Ensure SSH Key Authentication is not set for Root Login",
        "info": "SSH Key Based Authentication should not be used for Root Login\n\nRationale:\n\nDue to the sensitive nature of SSH, potentially allowing full management of the targeted device, protecting SSH access using strong authentication methods is essential to the security of the device.\n\nOne method which is supported in SSH for stronger authentication is the use of Public/Private Encryption Key Pairs in place of a more traditional login prompt for a Username and Password. Instead, an administrator uploads the user's Public key to the JUNOS (or other) device to be managed.\n\nWhen the user connects, they will use their Private key to encrypt some session specific data. The JUNOS device can verify the Users identity by decrypting that data using the Public key configured previously and comparing it to an expected result. If the results match, then the user must have access to the Private key, so is considered valid.\n\nUnfortunately using SSH Keys to authenticate User Logins to JUNOS devices introduce a number of security issues:\n\nPublic Keys may only be configured locally on each JUNOS device\n\nPublic Keys are used instead of centralized AAA using TACACS+ or RADIUS as covered in Recommendation 6.8.1 Ensure External AAA Server is set\n\nThe use of SSH Keys means only a single Authentication Factor (the keys) can be used, preventing the use of Multi Factor Authentication as covered in 6.6.14 Ensure Multi-Factor is used with External AAA\n\nJUNOS does not provide any method to automate rollover or locking of keys. If keys are compromised/lost, they must be changed on every JUNOS device on which they are configured.\n\nSome SSH implementation support the use of X.509 PKI Certificates for managing SSH Keys, but JUNOS does not.\n\nBecause of these limitations and the difficulty in auditing and managing SSH Keys on JUNOS devices, this method should not be used for Authentication of User logins or for the Root User, which is configured separately under the [edit system root-authentication] configuration hierarchy.",
        "solution": "If SSH Key based Authentication is configured for the Root Authentication, remove it using the following command from the [edit system] hierarchy:\n\n[edit system]\nuser@host# delete root-authentication\n\nTo set a new Root Password in plain text type:\n\n[edit system]\nuser@host#set root-authentication plain-text-password\n\nYou will be prompted to enter the new Password twice and, if the Passwords match, JUNOS will add a hash of the Password to the configuration.\nIf you already have a hash of your Root Password (from an existing router configuration, for example), enter the following command:\n\n[edit system]\nuser@host#set root-authentication encrypted-password ''\n\nNote - Hashes use SHA1 by default, but may use other hashing mechanisms depending on the device configuration - ensure the device you are copying from is configured to use the same hashing method.\nIf JWEB is installed on your router, the Root Password may also be changed through the Configuration > Quick Configuration > Setup page.\n\nDefault Value:\n\nThe Root account does not have any authentication set by default, but at least one root-authentication method must be configured during initial configuration before JUNOS will allow the configuration to be committed.",
        "reference": "800-171|3.1.1,800-171|3.5.1,800-171|3.5.3,800-53|AC-2,800-53|IA-2,800-53|IA-2(1),800-53r5|AC-2,800-53r5|IA-2,800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|7.1.3.2(d),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv7|4,CSCv7|11.5,CSCv7|16.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(1),LEVEL|1A,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM28,NIAv2|AM36,NIAv2|NS5j,NIAv2|SS14e,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system root-authentication .+",
        "not_expect": "ssh-"
    },
    "custom_item_85": {
        "description": "6.10.1.1 Ensure SSH Service is Configured if Remote CLI is Required",
        "info": "SSH should be utilized for remote console sessions to Juniper routers.\n\nRationale:\n\nSSH provides administrators with a remote console session on the router in a similar fashion to Telnet. Unlike Telnet, SSH encrypts all data as it transits the network and ensures the identity of the remote host.\n\nBecause of this extra protection, all remote console sessions should use SSH.\n\nIf Remote CLI or services which use SSH for transport, like Secure Copy (SCP) or NETCONF, are required SSH should be disabled.\n\nImpact:\n\nDisabling SSH may result in loss of remote management of the device and also impact other services, like NETCONF, which use SSH for transport.",
        "solution": "To enable SSH access issue the following command from the [edit system] hierarchy:\n\n[edit system]\nuser@host#set services ssh\n\nWhere SSH is used, all other Recommendations in this section should be considered.\nIf SSH is currently configured but is not required it should be disabled using the following command from the [edit system] hierarchy:\n\n[edit system]\nuser@host#delete services ssh\n\nDefault Value:\n\nFor most platforms SSH access is enabled by default.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1M,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "expect": "set system services ssh"
    },
    "custom_item_86": {
        "description": "6.10.1.2 Ensure SSH is Restricted to Version 2",
        "info": "Remote console connections should only use SSH Version 2.\n\nRationale:\n\nSSH Version 1 has been subject to a number of serious vulnerabilities and is no longer considered to be a secure protocol, resulting in the adoption of SSH Version 2 as an Internet Standard in 2006. Juniper routers support both versions, but due to the weakness of SSH Version 1 only the later standard should be used.",
        "solution": "To restrict SSH to Version 2 only, issue the following command from the [edit system service ssh] hierarchy:\n\n[edit system services ssh]\nuser@host#set protocol-version v2\n\nDefault Value:\n\nVersion 2 should be the default on all current platforms.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh protocol-version v2"
    },
    "custom_item_87": {
        "description": "6.10.1.3 Ensure SSH Connection Limit is Set",
        "info": "SSH connections should be limited.\n\nRationale:\n\nSSH is a common management protocol, so is often targeted by attackers trying to gain access to routers or execute Denial of Service (DoS) attacks.\n\nTo limit the effectiveness of DoS and Brute Force attacks targeting the JUNOS device using the SSH service the maximum number of concurrent connections should be limited. Any sessions attempted once this limit is reached will be rejected. A maximum limit of 10 concurrent sessions is recommended for most environments.",
        "solution": "To restrict concurrent SSH connections, issue the following command from the [edit system services ssh] hierarchy:\n\n[edit system services ssh]\nuser@host#set connection-limitNOTE - On some platforms the maximum configuration connection limit may be significantly lower than 10, for example, on an SRX110 the connection limit can be set to a value between 1 and 3.\n\nDefault Value:\n\nUp to 75 concurrent sessions are accepted by default on most current platforms.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh connection-limit ([1-9]|10)$"
    },
    "custom_item_88": {
        "description": "6.10.1.4 Ensure SSH Rate Limit is Configured",
        "info": "SSH connections should be limited.\n\nRationale:\n\nSSH is a common management protocol, so is often targeted by attackers trying to gain access to routers or execute Denial of Service (DoS) attacks.\n\nTo limit the effectiveness of DoS and Brute Force attacks targeting the JUNOS Device using the SSH service, rate limiting should be used to restrict the maximum number of new connections per second.\n\nAny sessions attempted once this limit is reached will be rejected. A maximum limit 4 new sessions per second is recommended for most environments.",
        "solution": "To restrict concurrent SSH connections, issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#set services ssh rate-limitDefault Value:\n\nUp to 150 new sessions per second are accepted by default on most current platforms.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh rate-limit [1-4]$"
    },
    "custom_item_89": {
        "description": "6.10.1.5 Ensure Remote Root-Login is denied via SSH",
        "info": "Prevent remote access to the Root user account on the device.\n\nRationale:\n\nDuring normal operation, remote access to the Root user should not be required.\n\nBecause the Root user account has full access to the router and underlying BSD OS it is an extremely valuable target for attackers and must be protected from remote exploitation.\n\nBy disabling remote access to the Root user account we ensure that physical access to the console port is required in order to gain this level of access.\n\nRoot access only needs to be disabled for SSH connections, as it is never allowed over a Telnet or other remote access session.",
        "solution": "To disable remote access to the Root account issue the following command from the [edit system services ssh] hierarchy:\n\n[edit system services ssh]\nuser@host#set root-login deny\n\nDefault Value:\n\nBy default, if SSH is enabled, remote login with the Root account is permitted.",
        "reference": "800-171|3.1.1,800-171|3.5.3,800-53|AC-2,800-53|IA-2(1),800-53r5|AC-2,800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(d),CSCv7|4,CSCv7|11.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM28,NIAv2|AM36,NIAv2|NS5j,NIAv2|SS14e,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh root-login deny"
    },
    "custom_item_90": {
        "description": "6.10.1.6 Ensure Strong Ciphers are set for SSH",
        "info": "SSH should be configured with strong ciphers\n\nRationale:\n\nSSH (Secure Shell) is the defacto standard protocol used for remote administration of network devices and Unix servers, providing an encrypted and authenticated alternative to Telnet. However, this ubiquity and requirement to support a wide range of clients and deployment scenarios, as well as SSH's age, mean SSH needs to support a variety of Ciphers of varying strengths.\n\nBy default, for the widest range of client compatibility, JUNOS supports SSH Ciphers using older Encryption Algorithms such as Blowfish or RC4 which are no longer considered suitable for use to protect sensitive services like SSH.\n\nSSH is a vital tool for administering most JUNOS devices, providing privileged access and potentially transporting sensitive information including passwords. It is recommended that SSH sessions be protected by restricting JUNOS to using stronger Ciphers based on 3DES and AES only.",
        "solution": "To remove a single insecure cipher, issue the following command from the [edit system services ssh] hierarchy;\n\n[edit system services ssh]\nuser@host#delete ciphersIf multiple insecure Ciphers were set, it will generally be easier to delete all the Cipher restrictions with the following command:\n\n[edit system services ssh]\nuser@host#delete ciphers\n\nOnce all insecure Ciphers have been removed, add one or more stronger Ciphers (in this example all stronger Ciphers available on most JUNOS devices are set in a single command)\n\n[edit system services ssh]\nuser@host#set ciphers [ 3des-cbc aes128-cbc aes128-ctr aes128-gcm@openssh.com aes192-cbc aes192-ctr aes256-cbc aes256-ctr aes256-gcm@openssh.com ]\n\nNote - note all of the Ciphers in the example above are supported on all JUNOS devices.\nIn many cases the GCM mode AES ciphers may be unavailable, a shorter list of Ciphers may be set with the following command for these systems:\n\n[edit system services ssh]\nuser@host#set ciphers [ 3des-cbc aes128-cbc aes128-ctr aes192-cbc aes192-ctr aes256-cbc aes256-ctr  ]\n\nFinally, single Ciphers or a smaller selection of these more secure Ciphers may be selected on the user's discretion.\n\n[edit system services ssh]\nuser@host#set ciphersDefault Value:\n\nFor most platforms SSH access is enabled by default but ciphers are not restricted.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh ciphers .+",
        "expect": "aes|3des"
    },
    "custom_item_91": {
        "description": "6.10.1.8 Ensure Strong MACs are set for SSH",
        "info": "SSH should be configured with strong message authentication algorithms.\n\nRationale:\n\nSSH (Secure Shell) is the defacto standard protocol used for remote administration of network devices and Unix servers, providing an encrypted and authenticated alternative to Telnet. However, this ubiquity and requirement to support a wide range of clients and deployment scenarios, as well as SSH's age, mean SSH needs to support a variety of Ciphers of varying strengths.\n\nBy default, for the widest range of client compatibility, JUNOS supports SSH Message Authentication using older algorithms and methods designed with performance rather than security in mind such as HMAC-MD5 or UMAC-128.\n\nSSH is a vital tool for administering most JUNOS devices, providing privileged access and potentially transporting sensitive information including passwords. It is recommended that SSH sessions be protected by restricting JUNOS to using stronger Message Authentication Code (MAC) methods based on the more modern SHA2 algorithm.",
        "solution": "To remove a single insecure MAC method, issue the following command from the [edit system services ssh] hierarchy;\n\n[edit system services ssh]\nuser@host#delete macsIf multiple insecure MAC methods were set, it will generally be easier to delete all the MAC method restrictions with the following command:\n\n[edit system services ssh]\nuser@host#delete macs\n\nOnce all insecure MAC methods have been removed, add one or more stronger MACS (in this example all stronger MACS available on most JUNOS devices are set in a single command)\n\n[edit system services ssh]\nuser@host#set macs [ hmac-sha2-256 hmac-sha2-256-etm@openssh.com hmac-sha2-512 hmac-sha2-512-etm@openssh.com ]\n\nFinally, single MAC methods or a smaller selection of these more secure MACs may be selected on the users discretion.\n\n[edit system services ssh]\nuser@host#set macsDefault Value:\n\nFor most platforms SSH access is enabled by default but macs are not restricted.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh macs .+",
        "expect": "sha2"
    },
    "custom_item_92": {
        "description": "6.10.1.9 Ensure Strong Key Exchange Methods are set for SSH",
        "info": "SSH should be configured with strong key exchange algorithms.\n\nRationale:\n\nSSH (Secure Shell) is the defacto standard protocol used for remote administration of network devices and Unix servers, providing an encrypted and authenticated alternative to Telnet. However, this ubiquity and requirement to support a wide range of clients and deployment scenarios, as well as SSH's age, mean SSH needs to support a variety of Ciphers of varying strengths.\n\nBy default, for the widest range of client compatibility, JUNOS supports SSH Key Exchange using older algorithms and methods such as Diffie-Hellman Group 1 with SHA1.\n\nSSH is a vital tool for administering most JUNOS devices, providing privileged access and potentially transporting sensitive information including passwords. It is recommended that SSH sessions be protected by restricting JUNOS to using stronger Key Exchange methods based on Diffie-Hellman using stronger Elliptic Curve or SHA2 algorithms.",
        "solution": "To remove a single insecure Key Exchange method, issue the following command from the [edit system services ssh] hierarchy;\n\n[edit system services ssh]\nuser@host# delete key-exchangeIf multiple insecure Key Exchange methods were set, it will generally be easier to delete all the Key Exchange method restrictions with the following command:\n\n[edit system services ssh]\nuser@host# delete key-exchange\n\nOnce all insecure methods have been removed, add one or more stronger Key Exchange methods (in this example all stronger methods available on most JUNOS devices are set in a single command)\n\n[edit system services ssh]\nuser@host# set key-exchange [ curve25519-sha256 ecdh-sha2-nistp256 ecdh-sha2-nistp384 ecdh-sha2-nistp521 group-exchange-sha2 ]\n\nFinally, single Key Exchange methods or a smaller selection of these more secure methods may be selected on the user's discretion.\n\n[edit system services ssh]\nuser@host# set key-exchangeDefault Value:\n\nFor most platforms SSH access is enabled by default but key exchange methods are not restricted.\n\nOn FIPS releases the curve25519-sha256, dh-group1-sha1, group-exchange-sha & group-exchange-sha2 methods are not supported.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh key-exchange .+",
        "expect": "sha2|ecdh|curve"
    },
    "custom_item_93": {
        "description": "6.10.1.11 Ensure Strong Key Signing Algorithms are set for SSH",
        "info": "SSH should be configured with strong key signing algorithms\n\nRationale:\n\nSSH (Secure Shell) is the defacto standard protocol used for remote administration of network devices and Unix servers, providing an encrypted and authenticated alternative to Telnet. However, this ubiquity and requirement to support a wide range of clients and deployment scenarios, as well as SSH's age, mean SSH needs to support a variety of Ciphers of varying strengths.\n\nBy default, for the widest range of client compatibility, JUNOS supports SSH Key Signing methods using older algorithms and methods such as 1024 bit DSA keys.\n\nSSH is a vital tool for administering most JUNOS devices, providing privileged access and potentially transporting sensitive information including passwords. It is recommended that SSH sessions be protected by restricting JUNOS to using stronger Key Signing methods based on RSA or Elliptic Curve algorithms, while weaker signing methods are explicitly disabled.",
        "solution": "To explicitly disable DSA signatures, type the following command at the [edit system services ssh] hierarchy:\n\n[edit system services ssh]\nuser@host#set hostkey-algorithm no-ssh-dss\n\nEnable one or more stronger ciphers using the following commands:\n\n[edit system services ssh]\nuser@host#set hostkey-algorithm ssh-ecdsa\nuser@host#set hostkey-algorithm ssh-ed25519\nuser@host#set hostkey-algorithm ssh-rsa\n\nDefault Value:\n\nFor most platforms SSH-ECDSA, SSH-ED25519, SSH-DSS (1024 bit DSA keys) and SSH-RSA are permitted by default.\n\nSSH-DSS is not supported on JUNOS in FIPS Mode, so cannot be enabled in FIPS mode.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh hostkey-algorithm no-ssh-dss"
    },
    "custom_item_94": {
        "description": "Check for web-management",
        "regex": "set system services .+",
        "expect": "set system services web-management"
    },
    "custom_item_95": {
        "description": "6.10.2.1 Ensure Web-Management is not Set to HTTP",
        "info": "Network devices should not be managed using unencrypted HTTP sessions\n\nRationale:\n\nJWeb can be configured to provide a Web GUI over either HTTP or HTTPS.\n\nHTTP transmits all data (including passwords) in clear text over the network and provides no assurance of the identity of the hosts involved.\n\nBecause of this HTTP should never be used for sensitive tasks such as managing network devices or entering login credentials and HTTP Web-Management should be disabled.\n\nImpact:\n\nEnsure that management using HTTPS or other secure methods is configured and working before disabling HTTP access. Otherwise you may be unable to connect back to the device for management.",
        "solution": "To disable HTTP access issue the following command from the [edit system services web-management] hierarchy:\n\n[edit system services web-management]\nuser@host#delete http\n\nDefault Value:\n\nVaries by platform.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services web-management .+",
        "not_expect": "set system services web-management http( |$)"
    },
    "custom_item_96": {
        "description": "6.10.2.2 Ensure Web-Management is Set to use HTTPS",
        "info": "JWeb should only be accessed using HTTPS\n\nRationale:\n\nJWeb can be configured to provide a Web GUI over either HTTP or HTTPS.\n\nHTTP transmits all data (including passwords) in clear text over the network and provides no assurance of the identity of the hosts involved.\n\nBecause of this HTTP should never be used for sensitive tasks such as managing network devices or entering login credentials and HTTPS should be configured for Web-Management instead.\n\nImpact:\n\nEnsure an alternative method to manage the JUNOS device is configured and working prior to changing the Certificate used for HTTPS to ensure continued access in the event of any errors.",
        "solution": "To enable HTTPS access using the System Generated 'Self Signed' Certificate, issue the following command from the [edit system service web-management] hierarchy;\n\n[edit system services web-management]\nuser@host#set https system-generated-certificate\n\nAlternatively, you may which to use a Local Certificate which is stored in the device's Configuration File:\n\n[edit system services web-management]\nuser@host#set https local-certificateshould match an X.509 Certificate loaded under the [edit security certificates] hierarchy as shown below:\n\n[edit security certificates]\nuser@host# setload-key-fileWhereis either the name and path of a local Certificate and Key Pair file, or the URL from which the file can be fetched.\nNote - This method leaves the Certificate and Private Key as part of the devices Configuration file, potentially exposing them. This is not the preferred method to configure a certificate in most instances.\nFinally, you can configure JUNOS to use a PKI-Certificate:\n\n[edit system services web-management]\nuser@host#set https pki-local-certificateWhereis an X.509 Certificate which has already been loaded to the JUNOS device's local PKI store.\n\nDefault Value:\n\nVaries by platform. For some Branch and SME focused devices, like the SRX300 or EX2300, JWeb is enabled by default. For most larger Enterprise and SP devices JWeb is disabled by default.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services web-management .+",
        "expect": "set system services web-management https system-generated-certificate"
    },
    "custom_item_97": {
        "description": "6.10.2.4 Ensure Idle Timeout is Set for Web-Management",
        "info": "Idle JWeb sessions should be timed out after 15 minutes.\n\nRationale:\n\nIf JWeb Management sessions are left unattended it may be possible for an attacker to use the session to take control of the JUNOS device.\n\nTo prevent this, or at least limit the scope of such an attack, an idle timeout should be set to end sessions where no activity has occurred for a defined period of time.\n\nThe Payment Card Industry Data Security Standard (PCI DSS) recommends that administrative sessions should be timed out if left idle for 15 minutes.",
        "solution": "To enable Idle Timeouts for JWeb issue the following command from the [edit system services web-management] hierarchy:\n\n[edit system services web-management]\nuser@host#set session idle-timeoutDefault Value:\n\nDepends on platform, JWEB is installed on J-Series by default and optional on all other platforms. No idle timeout is set by default.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services web-management .+",
        "expect": "set system services web-management session idle-timeout ([1-9]|1[0-5])"
    },
    "custom_item_98": {
        "description": "6.10.2.5 Ensure Session Limited is Set for Web-Management",
        "info": "Concurrent Web-Management sessions should be limited\n\nRationale:\n\nJUNOS Devices can be managed through a powerful Web Management GUI called JWeb.\n\nOperating the JWeb, or any other, management service uses resources on the device's Routing Engine (RE). An attacker may attempt to initialize a large number of management sessions concurrently in order to exhaust resources and achieve a Denial of Service (DoS) attack.\n\nTo prevent this the maximum number of concurrent JWeb sessions should be set at 5 or less.",
        "solution": "To enable Session limits for JWeb issue the following command from the [edit system services web-management] hierarchy;\n\n[edit system services web-management]\nuser@host#set session-limit 5\n\nDefault Value:\n\nVaries by platform. For some Branch and SME focused devices, like the SRX300 or EX2300, JWeb is enabled by default. For most larger Enterprise and SP devices JWeb is disabled by default.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services web-management .+",
        "expect": "set system services web-management session session-limit ([1-5])"
    },
    "custom_item_99": {
        "description": "6.10.2.6 Ensure Web-Management Interface Restriction is Set",
        "info": "JWeb access should be restricted to trusted networks\n\nRationale:\n\nBy default, when configured, the JWeb service will listen for incoming connections on all interfaces which have an IP Address configured, exposing JWeb to users on all networks through which the device is reachable.\n\nBecause control of Network Systems can have a serious impact on the security of your environment, the JUNOS device should only be manageable over some of its interfaces; in particular a JUNOS device providing connectivity to untrusted networks such as the Internet should only be manageable from trusted sources.\n\nThis can be accomplished by limiting the interfaces on which the JWeb HTTPS service operates and this restriction should be applied on all JUNOS devices. Firewall Filters or Security Policy (SRX) should also be used to further restrict management to authorized sources (see Recommendations in Section 2 - Firewall for further details).\n\nImpact:\n\nEnsure that JWeb Management is operational and reachable using the selected interfaces before applying interface restrictions in a production environment.",
        "solution": "To apply JWEB Interface restrictions issue the following commands from the [edit system services web-management https] hierarchy:\nTo set a single Interface:\n\n[edit system services web-management https]\nuser@host#set interfaceOr to set multiple Interfaces:\n\n[edit system services web-management https]\nuser@host#set interface []\n\nDefault Value:\n\nVaries by platform. For some Branch and SME focused devices, like the SRX300 or EX2300, JWeb is enabled by default. For most larger Enterprise and SP devices JWeb is disabled by default.\n\nWhen configured, by default JWeb listens on all interfaces for Web Management sessions.",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSCv7|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services web-management .+",
        "expect": "set system services web-management .+ interface .+"
    },
    "custom_item_100": {
        "description": "Check for XNM/JunoScript",
        "regex": "set system services xnm.+",
        "expect": "set system services xnm.+"
    },
    "custom_item_101": {
        "description": "6.10.3.1 Ensure XNM-Clear-Text Service is Not Set",
        "info": "Cleartext Management Services should be disabled.\n\nRationale:\n\nJUNOScript Clients can access the router using a variety of transport modes including Clear-Text, Telnet, SSH and SSL.\n\nWhen Clear-Text is used the JUNOScript Client connects to the JUNOS Device on port TCP/3221.\n\nAs the name suggests Authentication information, commands and router configuration are all transported across the network in Clear (unencrypted) Text form, making it trivial for an attacker to steal login credentials, learn configuration or hijack the session to execute their own commands.\n\nBecause of this, Clear Text mode should never be used to manage JUNOS Devices.\n\nImpact:\n\nEnsure that JUNOSCript Clients using the Clear Text interface are not being used to manage the JUNOS Device before disabling the service in a production environment.",
        "solution": "The XNM-Clear-Text service is not enabled by default, however if it has been configured on your router it can by disabled by issuing the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#delete services xnm-clear-text\n\nDefault Value:\n\nThe XNM-Clear-Text Service is disabled by default and cannot be enabled on JUNOS FIPS Mode.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "xnm-clear-text"
    },
    "custom_item_102": {
        "description": "Check for XNM/JunoScript",
        "regex": "set system services xnm-ssl",
        "expect": "set system services xnm-ssl"
    },
    "custom_item_103": {
        "description": "6.10.3.4 Ensure XNM-SSL SSLv3 Support is Not Set",
        "info": "If the XNM-SSL service is configured, SSLv3 should not be enabled.\n\nRationale:\n\nJUNOScript can be configured to use SSL/TLS transport to prevent the exposure of sensitive data and authentication details on the network. If configured the XNM-SSL service will provide services on port TCP/3220.\n\nSecure Sockets Layer version 3 (SSLv3) is an old standard for securing communication, which has proved vulnerable to a number of systemic weaknesses and is now considered unsuitable for use for securing sensitive sessions, such as those used by JUNOScript. SSLv3 has been replaced by the Transport Layer Security (TLS) standard.\n\nAlthough support for SSLv3 has been disabled by in most JUNOS Releases, it is still possible to enable support for SSLv3 using a hidden configuration command in some currently supported versions of JUNOS.\n\nBecause this would enable a significantly weaker standard, it is strongly recommended that SSLv3 Support should never be enabled.\n\nImpact:\n\nIf a JUNOScript client does not support the newer TLS standard, it will be unable to connect to the JUNOS Device.",
        "solution": "XNM-SSL SSLv3 Support can be disabled by issuing the following command from the [edit system services xnm-ssl] hierarchy;\n\n[edit system services xnm-ssl]\nuser@host#delete sslv3-support\n\nDefault Value:\n\nThe XNM-SSL Service is disabled by default.\n\nSSLv3 was disabled by default in Junos OS 13.2R8, 13.3R6, 14.1R5, 14.2R3 (depending on platform). Support for the SSLv3-support command was removed in JUNOS Version 15.1",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services xnm-ssl .+",
        "not_expect": "set system services xnm-ssl sslv3-support"
    },
    "custom_item_104": {
        "description": "Check for NETCONF",
        "regex": "set system services netconf",
        "expect": "set system services netconf"
    },
    "custom_item_105": {
        "description": "6.10.4.1 Ensure NETCONF Rate Limit is Set",
        "info": "If the NETCONF service is configured, the Rate Limit should be set.\n\nRationale:\n\nNETCONF can be configured to use SSH transport to allow remote access while preventing the exposure of sensitive data and authentication details on the network. If configured, the NETCONF-over-SSH service will provide services on port TCP/830.\n\nAn attacker may attempt to open a large number of sessions to the NETCONF-over-SSH service to exhaust the routers resources or an authorized user may do so accidently, especially given that the service is designed to allow an automation interface to JUNOS.\n\nTo limit the impact of any such incident, the rate of new connections to the NETCONF service should explicitly limited. Rate Limits are set in terms of the number of new connection attempts per minute. Established connections do not count towards this count. A relatively low value of 60 (the equivalent of one attempt per second, sustained over a minute) is recommended, but may not be appropriate for all environments so it is left to the administrator's discretion.\n\nImpact:\n\nIf the Rate Limit is exceeded, new connection attempts will be rejected until the new connection rate drops below the configured limit.",
        "solution": "The NETCONF-over-SSH Rate Limit can be configured by issuing the following command from the [edit system services netconf] hierarchy;\n\n[edit system services netconf]\nuser@host#set ssh rate-limitWhere is the desired Rate Limit measured in New Connection Attempts per Minute.\n\nDefault Value:\n\nThe NETCONF-over-SSH Service is disabled by default. When it is first configured the default Rate Limit is 150 connection attempts per second.",
        "reference": "800-171|3.1.7,800-171|3.5.3,800-53|AC-6(10),800-53|IA-2(1),800-53r5|AC-6(10),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.7,CSCv7|11.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|AC-6,ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM36,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services netconf .+",
        "expect": "set system services netconf ssh rate-limit @NETCONF_RATE_LIMIT@"
    },
    "custom_item_106": {
        "description": "6.10.4.2 Ensure NETCONF Connection Limit is Set",
        "info": "If the NETCONF service is configured, the Connection Limit should be set.\n\nRationale:\n\nNETCONF can be configured to use SSH transport to allow remote access while preventing the exposure of sensitive data and authentication details on the network. If configured, the NETCONF-over-SSH service will provide services on port TCP/830.\n\nAn attacker may attempt to open a large number of sessions to the NETCONF-over-SSH service to exhaust the routers resources or an authorized user may do so accidently, especially given that the service is designed to allow an automation interface to JUNOS.\n\nTo limit the impact of any such incident, the number of concurrent connections to the NETCONF service should explicitly limited.\n\nA relatively low value of 10 is recommended, but may not be appropriate for all environments so it is left to the administrator's discretion.\n\nImpact:\n\nIf the connection limit has been reached, additional NETCONF-over-SSH sessions will be rejected until an existing session has ended.",
        "solution": "The NETCONF-over-SSH Connection Limit can be configured by issuing the following command from the [edit system services netconf] hierarchy;\n\n[edit system services netconf]\nuser@host#set ssh connection-limitWhereis the desired Connection Limit.\n\nDefault Value:\n\nThe NETCONF-over-SSH Service is disabled by default. When it is first configured the default Connection Limit is 75.",
        "reference": "800-171|3.1.7,800-171|3.5.3,800-53|AC-6(10),800-53|IA-2(1),800-53r5|AC-6(10),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.7,CSCv7|11.5,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|AC-6,ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM36,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services netconf .+",
        "expect": "set system services netconf ssh connection-limit @NETCONF_CONNECTION_LIMIT@"
    },
    "custom_item_107": {
        "description": "Check for REST",
        "regex": "set system services rest",
        "expect": "set system services rest"
    },
    "custom_item_108": {
        "description": "6.10.5.1 Ensure REST is Not Set to HTTP",
        "info": "Network devices should not be managed using unencrypted HTTP sessions\n\nRationale:\n\nThe JUNOS REST API can be configured for access using either HTTP or HTTPS for connections.\n\nHTTP transmits all data (including passwords) in clear text over the network and provides no assurance of the identity of the hosts involved.\n\nBecause of this HTTP should never be used for sensitive tasks such as managing network devices or entering login credentials; so REST HTTP should always be disabled.\n\nImpact:\n\nManagement of the device through REST HTTP will be lost - ensure that other management options are configured and working before disabling this service on production systems.",
        "solution": "To disable REST HTTP, enter the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# delete http\n\nDefault Value:\n\nBy default the REST API is disabled.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "not_expect": "set system services rest http( |$)"
    },
    "custom_item_109": {
        "description": "6.10.5.2 Ensure REST is Set to HTTPS",
        "info": "The REST API should only be accessed using HTTPS\n\nRationale:\n\nThe JUNOS REST API can be configured for access using either HTTP or HTTPS for connections.\n\nHTTP transmits all data (including passwords) in clear text over the network and provides no assurance of the identity of the hosts involved.\n\nBecause of this HTTP should never be used for sensitive tasks such as managing network devices or entering login credentials and HTTPS transport used whenever the REST API is configured.\n\nWhen configuring HTTPS, a Server Certificate in the Device's PKI Store is required. This can be either a 'Self Signed Certificate' or a Certificate issued by a configured/supported Certificate Authority (including internal CAs). A Certificate issues from a CA is preferred.",
        "solution": "To configure REST over HTTPS, enter the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# set https server-certificateWhereis the name of a Certificate which has already been loaded to the devices PKI Store.\nTo create a new Public/Private Key Pair in the devices PKI Store and generate Certificate Signing Request issue the following commands from Operational Mode:\n\nuser@host> request security pki generate-key-pair certificate-idtypesizeuser@host> request security pki generate-certificate-request certificate-iddomain-namesubjectWhere:is the Name that will be used for this Certificate throughout configurationis the Encryption Algorithm to be used (this should be either RSA or ECC)is the number of Bits used for the keys (use at least 2048bits for RSA or 256bits for ECC)is the FQDN which will be used to manage the device andis the Distinguished Name used to identify this device and certificate.\nOptionally, fields for email address, the device's IP Address and output Filename for the PKCS#10 CSR which will be generated can be included.\nThe CSR should then be submitted to the Certificate Authority for review and signing.\nOnce the CA returns the Certificate it can be uploaded to the JUNOS device and imported with the following command from Operational Mode:\n\nuser@host> request security pki local-certificate load certificate-idfilenameAlternatively, a 'Self Signed' Certificate can be generated using the Public/Private Key Pair previously generated with the following command:\n\nuser@host> request security pki local-certificate generate-self-signed certificate-idUse of Self Signed Certificates is not recommended in secure environments.\n\nDefault Value:\n\nBy default the REST API is disabled.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "expect": "set system services rest https server-certificate .+"
    },
    "custom_item_110": {
        "description": "6.10.5.5 Ensure REST HTTPS Cipher List is Set",
        "info": "The REST API should only be accessed using HTTPS with secure Cipher Suites.\n\nRationale:\n\nThe JUNOS REST API can be configured for access using either HTTP or HTTPS for connections.\n\nWhen configured to use HTTPS, the device supports a wide range of Cipher Suites which define the Encryption, Hashing and Key Exchange methods and algorithms. By default, in the interests of compatibility, this includes support for a number of older, weaker algorithms such as RC4 Encryption or MD5 Hashing, which are no longer considered suitable for protecting sensitive data or device management.\n\nTo ensure that these weaker algorithms and methods are not used, the REST API HTTPS Service should be configured to use only Cipher Suites which do not include RC4 or 3DES for Data Encryption and MD5 or SHA1 for Hashing.\n\nImpact:\n\nREST API Management may be lost if the Network Management System or Hosts do not support the secure Cipher Suites.",
        "solution": "To restrict the Cipher Suites used REST over HTTPS, enter the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# set https cipher-list [ rsa-with-aes-128-cbc-SHA256 rsa-with-aes-256-cbc-SHA256 dhe-rsa-with-aes-128-cbc-SHA256 dhe-rsa-with-aes-256-cbc-SHA256 rsa-with-aes-128-gcm-SHA256 rsa-with-aes-256-gcm-SHA384 dhe-rsa-with-aes-128-gcm-SHA256 dhe-rsa-with-aes-256-gcm-SHA384 ecdhe-rsa-with-aes-128-cbc-SHA256 ecdhe-rsa-with-aes-256-cbc-SHA384 ecdhe-rsa-with-aes-128-gcm-SHA256 ecdhe-rsa-with-aes-256-gcm-SHA384 ]\n\nNo all Cipher Suites are required to meet this recommendation. A shorter list, or individual Cipher Suites, may be configured using the same command.\nSome JUNOS Devices do not support all of the above Cipher Suite (most notably, AES in Galois Counter Mode support is not universal), unsupported Cipher Suites can be skipped.\n\nDefault Value:\n\nBy default the REST API is disabled. When the REST API HTTPS Service is enabled, all Cipher Suites (including those with RC4 and insecure ciphers) are accepted, except for JUNOS FIPS mode, which supports only rsa-with-aes-256-gcm-SHA384, dhe-rsa-with-aes-128-gcm-SHA256, dhe-rsa-with-aes-256-gcm-SHA384, ecdhe-rsa-with-aes-128-gcm and ecdhe-rsa-with-aes-256-gcm.",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|11.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest https cipher-list .+",
        "not_expect": "(rc4|3des|md5|sha)"
    },
    "custom_item_111": {
        "description": "6.10.5.7 Ensure REST API Explorer is Not Set",
        "info": "The REST API Explorer should be disabled\n\nRationale:\n\nWhen enabled, the JUNOS REST API can provide a Web GUI interface known as the REST API Explorer to allow developers to learn the API or test RPC calls.\n\nThe API Explorer is not designed for use in production environments and adds an unnecessary additional attack surface which could be exploited to compromise the JUNOS Device.\n\nBecause it is an unneeded service, intended for use only in development environments, the API Explorer should be disabled on all production systems.\n\nImpact:\n\nThe REST API Explorer should only be used in Development or Lab environments, it is not required in order to support normal REST API functionality.",
        "solution": "To disable the REST API Explorer, issue the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# delete enable-explorer\n\nThis will disable the API Explorer for both HTTP and HTTPS access.\n\nDefault Value:\n\nThe REST API is disabled by default. If REST is enabled, the API Explorer is disabled by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "not_expect": "set system services rest enable-explorer"
    },
    "custom_item_112": {
        "description": "6.10.5.8 Ensure REST Allowed Sources is Set",
        "info": "REST API Clients should be restricted to allowed sources.\n\nRationale:\n\nThe REST API service allows remote scripts or users to connect to a JUNOS Device and execute RPC commands to operate and configure the device, potentially granting full control if connecting using a privileged account.\n\nTo protect the REST API from unauthorized use, access should be restricted to specific Network Management Systems using the allowed-sources option to add a whitelist of one or more individual IP Addresses.\n\nImpact:\n\nHosts which are not included in the Allowed Sources whitelist will no longer be permitted to access the REST API.",
        "solution": "To add an IP Address to the REST API Allowed Sources whitelist, enter the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# set control allowed-sourcesWhereis a single host IP Address.\nTo add multiple addresses to the Allowed Sources whitelist, enter the following command:\n\n[edit system services rest]\nuser@host# set control allowed-sources []\n\nTo remove a single address from the current list (for example, if the host is no longer used for Network Management) enter the following command:\n\n[edit system services rest]\nuser@host# delete control allowed-sourcesDefault Value:\n\nBy default the REST API is disabled.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "expect": "set system services rest control allowed-sources .+"
    },
    "custom_item_113": {
        "description": "6.10.5.9 Ensure REST Connection Limit is Set",
        "info": "If the REST API service is configured, the Connection Limit should be set.\n\nRationale:\n\nThe REST API may be accessed remotely, using either HTTP (though this is not recommended) or HTTPS.\n\nAn attacker may attempt to open a large number of sessions to the REST API service to exhaust the routers resources or an authorized user may do so accidently, especially given that the service is designed to allow an automation interface to JUNOS.\n\nTo limit the impact of any such incident, the number of concurrent connections to the REST API service should explicitly limited.\n\nA relatively low value of 10 is recommended, but may not be appropriate for all environments so it is left to the administrator's discretion.\n\nImpact:\n\nIf the connection limit has been reached, additional REST API sessions will be rejected until an existing session has ended.",
        "solution": "To enable a REST API Connection Limit, enter the following command at the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# set control connection-limitWhereis the desired Connection Limit.\n\nDefault Value:\n\nThe REST API Service is disabled by default. When enabled, the default Connection Limit for most platforms is 64.",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.7,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "expect": "set system services rest control connection-limit @REST_CONNECTION_LIMIT@"
    },
    "custom_item_114": {
        "description": "6.10.5.10 Ensure REST Service Address is Set",
        "info": "The REST API Service Address should be set.\n\nRationale:\n\nThe REST API service allows remote scripts or users to connect to a JUNOS Device and execute RPC commands to operate and configure the device, potentially granting full control if connecting using a privileged account.\n\nTo protect the REST API from unauthorized use, access should be restricted to specific network management segments.\n\nBy default, when enabled, the REST API listens on port TCP/3000 (for HTTP) or TCP/3443 (for HTTPS) on all IP Addresses configured on the JUNOS Device. The addresses option can be configured with one or more IP Addresses to restrict the REST API to listening only on these addresses.\n\nIn general, this would be the IP Address used for the devices' Out of Band Management interface (such as fxp0) where possible.\n\nImpact:\n\nHosts will be unable to connect to the REST API HTTPS Service on any addresses which are not configured.",
        "solution": "To restrict the IP Address/es on which the REST API will listen, enter the following command from the [edit system services rest] hierarchy:\n\n[edit system services rest]\nuser@host# set https addressesWhereis a single IP Address configured on one of the JUNOS Device's interfaces.\nTo add multiple addresses, enter the following command:\n\n[edit system services rest]\nuser@host# set https addresses []\n\nTo remove a single address from the current list enter the following command:\n\n[edit system services rest]\nuser@host# delete https addressesDefault Value:\n\nBy default the REST API is disabled. When enabled, the REST API HTTPS Service listens on all configured IP Addresses.",
        "reference": "800-171|3.1.7,800-171|3.4.2,800-53|AC-6(10),800-53|CM-6,800-53r5|AC-6(10),800-53r5|CM-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.7,CSCv7|11,CSF|PR.AC-4,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,ITSG-33|CM-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services rest .+",
        "expect": "set system services rest https addresses .+"
    },
    "custom_item_115": {
        "description": "6.10.6 Ensure Telnet is Not Set",
        "info": "Cleartext Management Services should be disabled.\n\nRationale:\n\nTelnet is a remote management protocol that allows users to connect to the command line of a JUNOS router or other device.\n\nBecause Telnet transmits all data (including passwords) in cleartext (unencrypted) over the network and provides no assurance of the identity of the hosts involved, it can allow an attacker to gain sensitive configuration, password and other data and is also vulnerable to session hijacking and injection attacks.\n\nThis makes Telnet and other unencrypted management applications completely unsuitable for managing network devices and Telnet should be disabled.\n\nImpact:\n\nEnsure administrative access via SSH or other secure method is configured and working before disabling Telnet in a production environment to ensure that administrative access is not lost.",
        "solution": "To disable Telnet access issue the following command from the [edit system telnet] hierarchy;\n\n[edit system services]\nuser@host# delete telnet\n\nDefault Value:\n\nTelnet is disable by default on most current platforms. Telnet cannot be configured on JUNOS in FIPS Mode.",
        "reference": "800-171|3.5.3,800-171|3.14.6,800-171|3.14.7,800-53|IA-2(1),800-53|SI-4,800-53r5|IA-2(1),800-53r5|SI-4,CN-L3|7.1.2.7(b),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSCv7|11.5,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "set system services telnet"
    },
    "custom_item_116": {
        "description": "6.10.7 Ensure Reverse Telnet is Not Set",
        "info": "Cleartext Management Services should be disabled.\n\nRationale:\n\nTelnet is a remote management protocol that allows users to connect to the command line of a JUNOS router or other device.\n\nBecause Telnet transmits all data (including passwords) in cleartext (unencrypted) over the network and provides no assurance of the identity of the hosts involved, it can allow an attacker to gain sensitive configuration, password and other data and is also vulnerable to session hijacking and injection attacks.\n\nThis makes Telnet and other unencrypted management applications completely unsuitable for managing network devices and Telnet should be disabled.\n\nReverse Telnet is a service that can be configured on JUNOS devices, allowing a user to connect via the auxiliary port to the CLI of another device by establishing a Telnet session, on port 2900/TCP by default. Because Telnet is used as the underlying protocol, Reverse Telnet is subject to the same risks and this service should be disabled.\n\nImpact:\n\nEnsure that alternate administrative access using a secure protocol such as SSH or Reverse SSH is provisioned and tested before removing this service in a production environment.",
        "solution": "To disable Reverse Telnet access issue the following command from the [edit system service] hierarchy;\n\n[edit system services]\nuser@host#delete reverse telnet\n\nDefault Value:\n\nReverse Telnet is disabled by default.",
        "reference": "800-171|3.5.3,800-171|3.14.6,800-171|3.14.7,800-53|IA-2(1),800-53|SI-4,800-53r5|IA-2(1),800-53r5|SI-4,CN-L3|7.1.2.7(b),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSCv7|11.5,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.AC-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "set system services reverse telnet"
    },
    "custom_item_117": {
        "description": "6.10.8 Ensure FTP Service is Not Set",
        "info": "FTP should be disabled.\n\nRationale:\n\nFile Transfer Protocol (FTP) can be used for loading and exporting configuration from a Juniper device, which can run an FTP Server Service to support these functions.\n\nFTP transfers data in plaintext and should be avoided, with the Secure Copy functions of SSH used instead.\n\nIn addition, the FTP service allows files to be read from and written to the devices file system, presenting a risk if misused.\n\nThe FTP Service should be disabled on all JUNOS devices and users should avoid using FTP in operational mode commands.\n\nImpact:\n\nEnsure no processes or support systems rely on FTP file transfers from the JUNOS device and migrate any such transfers to a secure alternative prior to disabling FTP in a production environment.",
        "solution": "To disable the FTP service, issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#delete services ftp\n\nDefault Value:\n\nFTP is enabled on most platforms by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "set system services ftp"
    },
    "custom_item_118": {
        "description": "6.10.9 Ensure Finger Service is Not Set",
        "info": "The Finger service should be disabled.\n\nRationale:\n\nFinger is a simple TCP service dating back to the early 1970's that provides information on users logged into a system to other users on the network.\n\nWhile this was a useful feature in the early days of the Internet, providing information about a router to unauthenticated users is not quite so desirable in today's Internet and presents a serious threat to the security of a JUNOS network device.\n\nThe finger daemon itself has suffered from numerous vulnerabilities across many platforms and, as with any unneeded service, should be disabled for this reason also.",
        "solution": "The Finger service is not enabled by default, however if it has been configured on your router it can by disabled by issuing the following command from the [edit system services] hierarchy;\n\n[edit system services]\nuser@host#delete finger\n\nDefault Value:\n\nFinger is disabled on most versions of JUNOS by default. The service cannot be used on FIPS versions of JUNOS.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.14.6,800-171|3.14.7,800-53|CM-7b.,800-53|SI-4,800-53r5|CM-7b.,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9,CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|CM-7a.,ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "set system services finger"
    },
    "custom_item_119": {
        "description": "6.10.10 Ensure Unused DHCP Service is Not Set",
        "info": "The DHCP Server should be disabled when not required.\n\nRationale:\n\nWhen hardening any computer system for security, it is important to disable or uninstall any application that is not required. The same rule applies to routers and other network devices.\n\nJUNOS devices are able to operate as a Dynamic Host Configuration Protocol (DHCP) server, providing IP Address and other information to client systems on connected networks. DHCP Services are configured either under the [edit system services dhcp] (using the Legacy DHCPD process) or [edit system services dhcp-local-server] (using the newer Extended JDHCPD process) hierarchies.\n\nIn most larger environments, DHCP services will be provided by separate DHCP Servers rather than JUNOS Routers, Switches or Firewalls - although these may still be used in smaller networks or Branch Offices. On some JUNOS platforms the DHCP Service is configured by default, but it is recommended that it is disabled if it is not required.\n\nImpact:\n\nEnsure that DHCP Services are not required before disabling them.",
        "solution": "To disable DHCP services which are not required, issue the one of the following command from the [edit system services] configuration hierarchy:\nFor DHCP configured with the Legacy DHCPD process:\n\n[edit system services]\nuser@host#delete dhcp\n\nOr, for DHCP configured with the Enhanced JDHCPD process:\n\n[edit system services]\nuser@host#delete dhcp-local-server\n\nDefault Value:\n\nVaries by platform. Some Branch/SME focused devices ship with DHCP services configured by default, while most Service Provider or Larger Enterprise devices have DHCP disabled by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system services .+",
        "not_expect": "set system services dhcp"
    },
    "custom_item_120": {
        "description": "6.11.1 Ensure Auxiliary Port is Set to Disabled",
        "info": "The Auxiliary Port should be disabled when not required.\n\nRationale:\n\nThe Auxiliary Port on a Juniper Device is used to connect Modems and other devices to allow remote administration of the router when other connectivity is not possible.\n\nConnections to the Auxiliary Port are treated in a very similar fashion to local Console Port connections.\n\nAlthough this is a useful function, in most deployments the Auxiliary Port is not utilized at all and so should be disabled, which is the default in all current Junos versions, to prevent potential abuse.\n\nImpact:\n\nThe Auxiliary port will not be available.",
        "solution": "To disable the Auxiliary Port, issue the following command from the [edit system ports] hierarchy;\n\n[edit system ports]\nuser@host#set auxiliary disable\n\nDefault Value:\n\nThe Auxiliary port is disabled by default on most current platforms.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system ports auxiliary .+",
        "expect": "set system ports auxiliary disable"
    },
    "custom_item_121": {
        "description": "6.11.5 Ensure Log-out-on-disconnect is Set for Console",
        "info": "Console sessions should be logged out as soon as the console cable is unplugged from the routers console port.\n\nRationale:\n\nAdministrators often use a console port to configure JUNOS Devices when they have physical access to the device.\n\nWhen the administrator unplugs the cable from the console port, their session may be left logged in; allowing the next person who connects to the console port to access the router with the privileges and audit trail of the original administrator.\n\nTo prevent this, the JUNOS Devices should be configured to automatically log out console port sessions as soon as the cable is disconnected.",
        "solution": "To log console sessions out when the console cable is unplugged, issue the following command from the [edit system ports console] hierarchy;\n\n[edit system ports console]\nuser@host#set log-out-on-disconnect\n\nDefault Value:\n\nBy default, console sessions continue after the console cable is unplugged.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system ports console .+",
        "expect": "set system ports console log-out-on-disconnect"
    },
    "custom_item_122": {
        "description": "6.12.1 Ensure External SYSLOG Host is Set with Any Facility and Informational Severity",
        "info": "Logging data must be sent to at least one external SYSLOG server.\n\nRationale:\n\nLog information from a JUNOS Device can be vital in detecting an attack and to allow incidents to be analyzed, investigated and (where appropriate) prosecuted. SYSLOG information is also helpful in diagnosing and resolving non-security related operational issues on the network.\n\nBecause of this, one of the first tasks an attacker will attempt to accomplish after gaining access to a Network Device is to alter or delete logs to cover their tracks.\n\nTo prevent an attacker or a fault denying you access to log data, it is vital to send logs to at least one External Logging and/or SIEM (Security Incident and Event Manager) Server. JUNOS Devices use the industry standard SYSLOG protocol for this.\n\nSYSLOG entries are generated by a range of sources on a JUNOS Device, such as authorization which reports Authentication and Authorization events or PFE for events encountered by the Packet Forwarding Engine. Each of these sources are referred to as a Facility.\n\nIn addition to indicating what facility generated a log message, JUNOS SYSLOG also indicates and allows the administrator to filter based on the Severity Level for each message. There are eight possible levels, which are as follows:\n\nEmergency (0)\n\nAlert (1)\n\nCritical (2)\n\nError (3)\n\nWarning (4)\n\nNotice (5)\n\nInformational (6)\n\nAny (7) (called Debug on many SYSLOG systems)\n\nEach increase in level represents an increase in the detail and number of log messages created. Each level includes the messages from all preceding levels, so Critical includes all messages from both the Alert and Emergency levels.\n\nTo ensure that vital messages about the Health and Security of the JUNOS Device are not missed, or lost should an attacker delete local logs, at least one External SYSLOG or SIEM Server should be configured to receive log messages from any Facility and at least info Severity.\n\nImpact:\n\nNetwork Devices, particularly Firewalls, can generate a significant volumes of log data, it is essential that the target SYSLOG server is suitably resourced to handle the expected volume of messages and it is strongly recommended that robust archiving and retention processes be employed.",
        "solution": "SYSLOG data is recorded locally by default, you can configure external SYSLOG servers by issuing the following command from the [edit system syslog] hierarchy;\n\n[edit system syslog]\nuser@host#set hostanyWhere:is the IP Address or Fully Qualified Domain Name of the Remote Syslog Servershould be either any or info\n\nSome SYSLOG or SIEM Servers may require additional configuration items such as explicit-priority or structured-data options to be configured.\nIt is possible to filter SYSLOG messages to be forwarded to the host using a match or match-string condition. This should not be set for the device's the Remote SYSLOG Host/s configured in meeting this Recommendation.\n\nDefault Value:\n\nLog messages are not sent to remote hosts by default, but are stored locally in files in the /var/log/ folder.",
        "reference": "800-171|3.3.8,800-53|AU-9(2),800-53r5|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSCv7|6.5,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(2),LEVEL|1A,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.2.1|10.5.3,PCI-DSSv3.2.1|10.5.4,PCI-DSSv4.0|10.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system syslog host",
        "number_of_lines": "^([1-9]|[0-9][0-9]+)$"
    },
    "custom_item_123": {
        "description": "6.12.3 Ensure Local Logging is Set for Firewall Events",
        "info": "Logging data for Firewall Events should be saved to a local file.\n\nRationale:\n\nThe JUNOS Device's built in Firewall (configured under [edit firewall] and discussed in more detail elsewhere in this Benchmark) can be the first line of defense, so the logging it produces can be vital in responding to a security incident as well as a useful tool for diagnosing faults relating to the Firewall.\n\nA local SYSLOG file should be configured to record all firewall related events.\n\nImpact:\n\nLogging of Firewall events may record a large volume of messages. You may wish to specify the size of files to be recorded, the number of zipped older files the JUNOS Devices should keep and automatic archiving settings to appropriate values for the device and environment you are using. Details of the related commands are linked in the References section.",
        "solution": "To configure a local SYSLOG file for Firewall events, issue the following command from the [edit system syslog] hierarchy;\n\n[edit system syslog]\nuser@host#set filefirewall any\n\nWhereis the file, in the default /var/log/ folder, that should be used to log these messages. You may, for example, choose to call the file firewall, in which case it can be read with the show log firewall command.\n\nDefault Value:\n\nSYSLOG for Firewall events is not sent to a separate file by default.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system syslog .+",
        "expect": "set system syslog file .+ firewall any"
    },
    "custom_item_124": {
        "description": "6.12.4 Ensure Local Logging is Set for Authentication and Authorization Events",
        "info": "Logging data for Authentication and Authorization events should be saved to a local file.\n\nRationale:\n\nAuthentication and Authorization events are generated whenever a user logs in to the router or performs an action which requires Authorization, such as making a change.\n\nThis information can provide a record of activity on the JUNOS Device when responding to both Security Incidents and Operational Issues.\n\nA local SYSLOG file should be configured to record all Authentication and Authorization related events, which are both generated by the authorization facility.\n\nImpact:\n\nAuthentication and Authorization events will be logged to the configured file in the JUNOS Device's /var/log/ folder. You may wish to specify the size of files to be recorded, the number of zipped older files the JUNOS Devices should keep and automatic archiving settings to appropriate values for the device and environment you are using. Details of the related commands are linked in the References section.",
        "solution": "To configure a local SYSLOG file for Auth events, issue the following command from the [edit system syslog] hierarchy;\n\n[edit system syslog]\nuser@host#set fileauthorization any\n\nDefault Value:\n\nAuthorization events at Info level are logged to the /var/log/messages file by default on most JUNOS systems, but the additional events from the any level are not recorded by default.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system syslog .+",
        "expect": "set system syslog file .+ authorization any"
    },
    "custom_item_125": {
        "description": "6.12.5 Ensure Local Logging is Set for Interactive-Commands",
        "info": "Logging data for Interactive Commands should be saved to a local file.\n\nRationale:\n\nWhen responding to a security incident or fault, a record of all of the commands issued on the JUNOS Devices, either through the CLI or through management APIs such as JUNOScript or NETCONF, can provide vital clues.\n\nA local SYSLOG file should be configured to record all interactive-commands issued on the JUNOS Device, along with details of the user who issued them and when. Having this data available locally, as well as on remote SYSLOG or SIEM Servers, can aide Incident Responders and enable a faster resolution to both Security and Operational related issues.\n\nImpact:\n\nEvents detailing Interactive Commands will be logged to the configured file in the JUNOS Device's /var/log/ folder. You may wish to specify the size of files to be recorded, the number of zipped older files the JUNOS Devices should keep and automatic archiving settings to appropriate values for the device and environment you are using. Details of the related commands are linked in the References section.",
        "solution": "To configure a local SYSLOG file for Interactive Commands, issue the following command from the [edit system syslog] hierarchy;\n\n[edit system syslog]\nuser@host#set fileinteractive-commands any\n\nWhereis the file, in the default /var/log/ folder, that should be used to log these messages. You may, for example, choose to call the file interactive-commands, in which case it can be read with the show log interactive-commands command.\n\nDefault Value:\n\nMessages from the interactive-commands facility are logged to the /var/log/interactive-commands file at the info Severity Level, by default on most JUNOS platforms (though this may vary by platform and version).",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system syslog .+",
        "expect": "set system syslog file .+ interactive-commands any"
    },
    "custom_item_126": {
        "description": "6.12.6 Ensure Local Logging is Set to Messages File",
        "info": "Logging data should be saved locally to the default messages file.\n\nRationale:\n\nAs part of the factory-default configuration, all JUNOS devices are configured to log SYSLOG events from several Facilities to a standard /var/log/messages file.\n\nThe exact logging for this file may vary slightly by platform, but will always include critical messages from any facility and authorization messages at info level.\n\nWhen responding to a Security Incident, it is not uncommon for additional external resources or JTAC support to be engaged. Removing logging to this standard location may slow down and hamper Incident Responders, particularly those who may not be familiar with organization specific standards, as they look for expected logs in this file, either manually or using automated/scripting tools.\n\nThe fact that the /var/log/messages file is missing may also be interpreted by Incident Responders as being a part of the intrusion or incident, resulting in further time being lost investigating something which is not, in this case, related to the incident.\n\nFor these reasons, the default logging to the /var/log/messages file should always be left in place on all JUNOS Devices, with any additional details or levels logged to other files as required.\n\nImpact:\n\nThe default local logging to the /var/log/messages file will be used.",
        "solution": "To configure a local SYSLOG messages file, issue the following commands from the [edit system syslog] hierarchy;\n\n[edit system syslog]\nuser@host#set file messages any critical\n\n[edit system syslog]\nuser@host#set file messages authorization info\n\nOn some JUNOS platforms, the factory-default configuration may include additional elements to be logged to the /var/log/messages file.\nYou can confirm what the factory-default settings for SYSLOG are on your JUNOS Device by issuing the following commands from a new configuration mode session - which does not have any outstanding changes.\nFirst, confirm that there are no pending changes:\n\n[edit]\nuser@host# show | compare\n\nIf any difference were highlighted do not proceed with the next set of commands until you have either rolled back or committed the outstanding changes.\nNext load the factory-default configuration (do not commit this configuration):\n\n[edit]\nuser@host# load factory-default\n\nNow we can compare the factory-default configuration to your current Active Configuration (rollback 0):\n\n[edit]\nuser@host# edit system syslog file messages\n\n[edit system syslog file messages]\nuser@host# show | compare\n\nFinally, roll the Candidate Configuration back to the current Active Configuration and quit from Configuration Mode:\n\n[edit system syslog file messages]\nuser@host# top\n\n[edit]\nuser@host# rollback 0\nload complete\n\n[edit]\nuser@host# quit\n\nAny logging which was missing from the current Active Configuration should be added to restore the original configuration.\n\nDefault Value:\n\nMessages from any Facility at critical Severity and from the authorization Facility at info Severity are logged to the /var/log/messages file on all JUNOS Devices. Some devices may have additional logging to this file by default.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system syslog file messages (any critical|authorization info)",
        "number_of_lines": "^2$"
    },
    "custom_item_127": {
        "description": "6.13 Ensure Autoinstallation is Set to Disabled",
        "info": "Autoinstallation should be disabled.\n\nRationale:\n\nThe Autoinstallation feature allows the JUNOS Device to automatically download and apply configuration from an FTP, TFTP or HTTP server on boot, having obtained IP Address details via DHCP or BOOTP.\n\nAutoinstallation provides an extremely useful function for rapid deployment of large numbers of devices, however Autoinstallation provides no method to authenticate the identity of the Installation Servers or validity of the supplied configuration files.\n\nThis may allow an attacker to change the device's configuration at boot (or after forcing a reboot through a DoS attack) by impersonating the DHCP, FTP, TFTP or HTTP servers or by carrying out session hijacking. This would be a multistage attack, as Autoinstallation should only be used if the device does not find an existing configuration locally - so the attacker would also need to have been able to disrupt the configuration or boot process through some other vector, but this may be viable for an attacker who already has some foothold on the device to escalate their privileges.\n\nIf successful the attacker would have gained complete control over the JUNOS Device.\n\nBecause all of the protocols used by Autoinstallation transfer data in plain text, it is trivial for an attacker to intercept the traffic and obtain a complete copy of the configuration, possibly containing authentication details to both the device and Operational Support Services.\n\nAutoinstallation is useful during deployments of large number of devices, but due to these limitations should only be used in a tightly controlled, isolated, build environment where the authenticity of servers and configuration can be assured and snooping on sensitive details can be eliminated. Autoinstallation should never be used over untrusted or public networks, such as over the Internet.\n\nMany JUNOS Devices have Autoinstallation enabled by default to support large deployments using the feature, but Autoinstallation should be disabled on all devices once deployed to production.\n\nImpact:\n\nThis should have no impact on production systems, as Autoinstallation should only be used when no non-factory-default configuration is present on the JUNOS Device at boot.",
        "solution": "To disable Autoinstallation issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#delete autoinstallation\n\nDefault Value:\n\nThe Autoinstallation service is enabled by default on many JUNOS Devices.",
        "reference": "800-171|3.4.2,800-171|3.14.6,800-171|3.14.7,800-53|CM-6,800-53|SI-4,800-53r5|CM-6,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv6|11,CSCv7|9.2,CSCv7|11,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|CM-6,ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system .+",
        "not_expect": "set system autoinstallation"
    },
    "custom_item_128": {
        "description": "6.16 Ensure Ping Record Route is Set to Disabled",
        "info": "The Routing Engine should ignore Echo Requests with the Record Route option set.\n\nRationale:\n\nWhen the Record Route Option is set on an Echo Request (ping), the hosts processing the packet should record their Interface addresses and a Timestamp on the response packet as it traverses the network (up to 9 hops) allowing the host that made the request to see the path that the response takes through the network, including discovering details of Provider Edge (PE) switches in MPLS VPN services and Loopback Interfaces.\n\nAttackers may use Echo Requests with the Record Route option set during recognizance of a network to obtain details of the networks topology,\n\nThe Record Route Option is considered to be largely deprecated, with no valid uses expected in almost all production networks; therefore, the JUNOS Device should be configured not to to include these details when responding to Echo Requests with the Record Route Option set.\n\nImpact:\n\nICMP Echo Requests (pings) with the Record Route Option set will still receive a response (unless blocked elsewhere), but the JUNOS Device will not return the additional Route and Interface details.",
        "solution": "To disable reporting of Interface details in responses to Echo Requests with the Record Route option set, issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#set no-ping-record-route\n\nDefault Value:\n\nBy default the Routing Engine responds to Echo Requests with the Record Route option set, adding the receiving interfaces IP address to the header of the packet.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system .+",
        "expect": "set system no-ping-record-route"
    },
    "custom_item_129": {
        "description": "6.17 Ensure Ping Timestamps are Set to Disabled",
        "info": "The Routing Engine should not return Timestamp information to Ping Requests\n\nRationale:\n\nWhen the Timestamp Request option is set in a Echo Request (ping) packet, a host generally responds with its current system time when the ping is received.\n\nAttackers may use Echo Requests with the Timestamp option set during recognizance of a network to obtain details of the configuration and state.\n\nThe use of these options is largely deprecated, with no valid usage in almost all modern networks; therefore, the JUNOS Device should be configured not to return the Timestamp in ICMP Echo Responses.\n\nImpact:\n\nICMP Echo Requests (pings) with the Request Timestamp Option set will still receive a response (unless blocked elsewhere), but the JUNOS Device will not return the additional Timestamp information.",
        "solution": "To ignore Echo Requests with the Timestamp Request option set, issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#set no-ping-time-stamp\n\nDefault Value:\n\nBy default the Routing Engine responds to Echo Requests with the Timestamp Request option set, including the current system time of the router.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system .+",
        "expect": "set system no-ping-time-stamp"
    },
    "custom_item_130": {
        "description": "6.19 Ensure Hostname is Not Set to Device Make or Model",
        "info": "The device make and model should not appear in the hostname.\n\nRationale:\n\nThe first step in any attack is reconnaissance. An attacker will attempt to learn about the target network, its hosts and network devices.\n\nA key piece of information for an attacker is what type of device he/she is attacking. By using the routers Model number, type, manufacturer or software version as part of its hostname, we give an attacker this valuable piece of information with no effort or risk of exposure. This is particularly true where the hostname is used in DNS.\n\nThis should not be interpreted as recommending 'security through obscurity' as a valid approach - rather that, as defenders, we would rather an attacker be required to perform more active reconnaissance to gather information about the target network - so that Intrusion Prevention Systems, Firewalls, Honeypots and other Security solutions are given a greater opportunity to detect and defend against the activity.\n\nImpact:\n\nThe hostname will appear in the CLI prompt, in SNMP information and in log messages.",
        "solution": "To configure the hostname, issue the following command from the [edit system] hierarchy;\n\n[edit system]\nuser@host#set host-nameThe hostname should not include any indication of the make or model of the device.\n\nDefault Value:\n\nVaries by platform.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system host-name .+",
        "not_expect": "([Jj]uniper|[Jj][Uu][Nn]|[Aa][Cc][Xx]|[Ee][Xx]|[Mm][Xx]|[Nn][Ff][Xx]|[Pp][Tt][Xx]|[Qq][Ff][Xx]|[Ss][Rr][Xx])"
    },
    "custom_item_131": {
        "description": "6.21 Ensure ICMP Redirects are Disabled for IPv4",
        "info": "The Routing Engine should not send ICMP Redirect Messages.\n\nRationale:\n\nICMP Redirect Messages provide a method for a router to communicate routing information with a host and is intended for use when a router receives packets to forward to a destination to which the host should have a direct route. In a well designed, modern, network ICMP Redirects should not be needed or add any useful functionality.\n\nAn attacker may abuse this feature to obtain topology information about a target network and potentially identify weaknesses for later exploitation or to target the router or hosts with a Denial of Service (DoS) or Man in the Middle (MITM) attacks.\n\nTo prevent this abuse, ICMP Redirect message generation should be disabled globally where it is not required.\n\nImpact:\n\nIn some networks, for instances where subnets populated by hosts include multiple non-redundant gateways, removing redirects may result in traffic being doubled on some gateways interfaces as traffic is received and then forwarded on the same port.",
        "solution": "To disable ICMP redirects globally for IPv4, issue the following command from the [edit system] heirachy:\n\n[edit system]\nuser@host# set no-redirects\n\nDefault Value:\n\nJUNOS devices send ICMP Redirect messages by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system .+",
        "expect": "set system no-redirects"
    },
    "custom_item_132": {
        "description": "family inet6 found",
        "expect": "set .* family inet6",
        "min_occurrences": "1"
    },
    "custom_item_133": {
        "description": "6.22 Ensure ICMP Redirects are Disabled for IPv6",
        "info": "The Routing Engine should not send ICMP Redirect Messages.\n\nRationale:\n\nICMP Redirect Messages provide a method for a router to communicate routing information with a host and is intended for use when a router receives packets to forward to a destination to which the host should have a direct route. In a well designed, modern, network ICMP Redirects should not be needed or add any useful functionality.\n\nAn attacker may abuse this feature to obtain topology information about a target network and potentially identify weaknesses for later exploitation or to target the router or hosts with a Denial of Service (DoS) or Man in the Middle (MITM) attacks.\n\nTo prevent this abuse, ICMP Redirect message generation should be disabled globally where it is not required.\n\nImpact:\n\nIn some networks, for instances where subnets populated by hosts include multiple non-redundant gateways, removing redirects may result in traffic being doubled on some gateways interfaces as traffic is received and then forwarded on the same port.",
        "solution": "To disable ICMP redirects globally for IPv6, issue the following command from the [edit system] hierarchy:\n\n[edit system]\nuser@host# set no-redirects-ipv6\n\nDefault Value:\n\nJUNOS devices send ICMP Redirect messages by default.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|9.2,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system no-redirects",
        "expect": "set system no-redirects-ipv6"
    },
    "custom_item_134": {
        "description": "6.23 Ensure Password is Set for PIC-Console-Authentication",
        "info": "Connections to the PIC Console should require a password.\n\nRationale:\n\nMany JUNOS Devices (including M, MX & T Series Routers, PTX Series and High End SRXs) utilize Physical Interface Cards to provide interface flexibility.\n\nSome PICs include additional Console Ports for performing advanced diagnostics on the Packet Forwarding Engine (PFE) with physical access to the device. An attacker, who was able to gain access to this normally unauthenticated port, may be able to impact the device or seek to escalate their privileges, bypassing normal authentication mechanisms.\n\nTo prevent this, pic-console-authentication should be configured using a secure password which is not the same as that used by any user or the Root account.\n\nImpact:\n\nThe configured password will be required before accessing the PIC Console to perform diagnostics.",
        "solution": "To set a password for access to the PIC Console, issue the following command from the [edit system] hierarchy:\n\n[edit system]\nuser@host# set pic-console-authentication plain-text-password\n\nThe JUNOS Device will prompt you to enter a new password, which must meet the complexity requirements configured under [edit system login], as shown below:\n\n[edit system]\nuser@host# set pic-console-authentication plain-text-password\nNew password:\nRetype new password:\n\nDefault Value:\n\nNo authentication is required to access the PIC Console by default.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|11,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3069",
        "regex": "set system pic-console-authentication .+",
        "expect": "set system pic-console-authentication .+"
    }
}