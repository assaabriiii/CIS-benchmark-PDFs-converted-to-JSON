{
    "custom_item_1": {
        "description": "JUSX-IP-000010 - The Juniper Networks SRX Series Gateway IDPS must install updates for predefined signature objects, applications signatures, IDPS policy templates, and device software when new releases are available in accordance with organizational configuration management policy and procedures.",
        "info": "Failing to update malicious code protection mechanisms, including application software files, signature definitions, and vendor-provided rules, leaves the system vulnerable to exploitation by recently developed attack methods and programs.\n\nThe IDPS is a key malicious code protection mechanism in the enclave infrastructure. To ensure this protection is responsive to changes in malicious code threats, IDPS components must be updated, including application software files, anti-virus signatures, detection heuristics, vendor-provided rules, and vendor-provided signatures.\n\nUpdates must be installed in accordance with the CCB procedures for the local organization. However, at a minimum:\n\n1. Updates designated as critical security updates by the vendor must be installed immediately.\n\n2. Updates for predefined signature objects, applications signatures, IDPS policy templates, and device software must be installed immediately.\n\n3. Updates for application software are installed in accordance with the CCB procedures.\n\n4. Prior to automatically installing updates, either manual or automated integrity and authentication checking is required, at a minimum, for application software updates.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Since DoD does not allow the management port of security devices to be connected directly to the Internet, the required security package must be uploaded using the Juniper SRX offline process.\n\nDirections are available in the document 'How to perform offline IDP and Application signature database update in SRX' on the Juniper Networks support site. DoD network policy requires a local file repository be used to automate the update for network devices.\n\nBefore uploading updates, the IDP administrator must verify the updates are approved by the site's CCB procedures and are authorized for installation. Once all files have been downloaded and approved, install the security package on SRX from root.\n\nRequest security idp security-package install source-path /var/db/idpd/sec-download",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3b.,800-53r5|SI-3b.,CAT|I,CCI|CCI-001240,CN-L3|7.1.3.6(a),CSF|DE.CM-4,CSF|DE.DP-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3b.,NESA|T3.4.1,NIAv2|GS8a,PCI-DSSv3.2.1|5.2,PCI-DSSv4.0|5.3.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-80499r1_rule,STIG-ID|JUSX-IP-000010,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-66009",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show security idp security-package-version",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_2": {
        "description": "JUSX-IP-000001 - The Juniper Networks SRX Series Gateway IDPS must provide audit record generation capability for detecting events based on implementation of policy filters, rules, and signatures.",
        "info": "Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.\n\nWhile auditing and logging are closely related, they are not the same. Logging is recording data about events that take place in a system, while auditing is the use of log records to identify security-relevant information such as system or user accesses. In short, log records are audited to establish an accurate history. Without logging, it would be impossible to establish an audit trail.\n\nThe Juniper SRX with IDP-enabled policies has the capability to capture and log detected security violations and potential security violations.",
        "solution": "A Routing Engine configuration option allows the enabling and disabling of IDP alarms.\n\nBy default, the IDP attack event triggers the current logs without raising any alarms. When the option is set and the system is configured appropriately, the IDP logs on the Packet Forwarding Engine will be forwarded to Routing Engine, which then parses the IDP attack logs and raises IDP alarms as necessary.\n\nTo enable an IDP alarm, use the set security alarms potential-violation idp command.\n\nTo turn on logging, you must first turn on notification to log attacks:\nset security idp idp-policy recommended rulebase-ips rule-1 then notification log-attacks\n\nConfigure Syslog (adding to the firewall stanza).\nsyslog {\n file IDP_Log {\n any any;\n match RT_IDP;",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-80867r1_rule,STIG-ID|JUSX-IP-000001,SWIFT-CSCv1|6.4,Vuln-ID|V-66377",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security alarms .+",
        "expect": "set security alarms potential-violation idp"
    },
    "custom_item_3": {
        "description": "idp active-policy",
        "regex": "set security idp active-policy .+",
        "expect": "set security idp active-policy .+"
    },
    "custom_item_4": {
        "description": "security policies idp",
        "regex": "set security policies from-zone .+",
        "expect": "set security policies from-zone .+ to-zone .+ policy .+ then permit application-services idp"
    },
    "custom_item_5": {
        "description": "idp active-policy",
        "regex": "set security idp active-policy .+",
        "expect": "set security idp active-policy .+"
    },
    "custom_item_6": {
        "description": "security policies idp",
        "regex": "set security policies from-zone .+",
        "expect": "set security policies from-zone .+ to-zone .+ policy .+ then permit application-services idp"
    },
    "custom_item_7": {
        "description": "JUSX-IP-000004 - The Juniper Networks SRX Series Gateway IDPS must provide audit record generation with a configurable severity and escalation level capability.",
        "info": "Without the capability to generate audit records with a severity code it is difficult to track and handle detection events.\n\nWhile auditing and logging are closely related, they are not the same. Logging is recording data about events that take place in a system, while auditing is the use of log records to identify security-relevant information such as system or user accesses. In short, log records are audited to establish an accurate history. Without logging, it would be impossible to establish an audit trail.\n\nThe IDPS must have the capability to collect and log the severity associated with the policy, rule, or signature. IDPS products often have either pre-configured and/or a configurable method for associating an impact indicator or severity code with signatures and rules, at a minimum.",
        "solution": "Example configuration to set the severity level on the IDP rules:\n\nDefine an attack as match criteria.\n[edit security idp idp-policy base-policy rulebase-ips rule R1]\nset match attacks predefined-attack-groups 'TELNET-Critical'\n\nSpecify an action for the rule.\n[edit security idp idp-policy base-policy rulebase-ips rule R1]\nset then action drop-connection\n\nSpecify notification and logging options for the rule.\n[edit security idp idp-policy base-policy rulebase-ips rule R1]\nset then notification log-attacks alert\n\nSet the severity level for the rule.\n\n[edit security idp idp-policy base-policy rulebase-ips rule R1]\n\nset then severity critical",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-80877r1_rule,STIG-ID|JUSX-IP-000004,SWIFT-CSCv1|6.4,Vuln-ID|V-66387",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp idp-policy .+ rulebase-ips rule .+ then .+",
        "expect": "set security idp idp-policy .+ rulebase-ips rule .+ then severity .+"
    },
    "custom_item_8": {
        "description": "JUSX-IP-000005 - The Juniper Networks SRX Series Gateway IDPS must block outbound traffic containing known and unknown DoS attacks by ensuring that rules are applied to outbound communications traffic.",
        "info": "The IDPS must include protection against DoS attacks that originate from inside the enclave which can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave.\n\nInstallation of IDPS detection and prevention components (i.e., sensors) at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.\n\nTo comply with this requirement, the IDPS must inspect outbound traffic for indications of known and unknown DoS attacks. Sensor log capacity management along with techniques which prevent the logging of redundant information during an attack also guard against DoS attacks. This requirement is used in conjunction with other requirements which require configuration of security policies, signatures, rules, and anomaly detection techniques and are applicable to both inbound and outbound traffic.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To enable IDP services on outbound traffic on the device, first create a security policy for the traffic flowing in one direction, then specify the action to be taken on traffic that matches conditions specified in the policy.\n\n[edit security policies from-zoneto-zonepolicy idp-app-policy-1]\nset match source-address any destination-address any application any\n\n[edit security policies from-zoneto-zone untrusted-zone-name> policy]\nset then permit application-services idp",
        "reference": "800-53|SC-5(2),800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-80885r1_rule,STIG-ID|JUSX-IP-000005,SWIFT-CSCv1|6.4,Vuln-ID|V-66395",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies from-zone .+ to-zone .+ policy .+ then permit application-services idp",
        "expect": "^Manual Review Required$"
    },
    "custom_item_9": {
        "description": "JUSX-IP-000006 - The Juniper Networks SRX Series Gateway IDPS must block outbound traffic containing known and unknown DoS attacks by ensuring that signature-based objects are applied to outbound communications traffic.",
        "info": "The IDPS must include protection against DoS attacks that originate from inside the enclave which can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave.\n\nTo perform signature-based attacks on the Juniper SRX IDPS device, create a signature-based attack object.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Specify a name for the attack. Specify common properties for the attack. Specify the attack type and context. Specify the attack direction and the shellcode flag. Set the protocol and its fields. Specify the protocol binding and ports. Specify the direction.\n\n[edit]\nedit security idp custom-attack sig1\nset severity major\nset recommended-action drop-packet\nset time-binding scope source count 10\nset attack-type signature context packet\nset attack-type signatureset attack-type signature protocol ip ttl value 128 match equal\nset attack-type signature protocol-binding tcp minimum-port 50 maximum-port 100\nset attack-type signature direction any",
        "reference": "800-53|SC-5(2),800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-80889r1_rule,STIG-ID|JUSX-IP-000006,SWIFT-CSCv1|6.4,Vuln-ID|V-66399",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp custom-attack .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_10": {
        "description": "JUSX-IP-000007 - The Juniper Networks SRX Series Gateway IDPS must block outbound traffic containing known and unknown DoS attacks by ensuring that anomaly-based attack objects are applied to outbound communications traffic.",
        "info": "The IDPS must include protection against DoS attacks that originate from inside the enclave which can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave.\n\nTo perform anomaly-based attacks on the Juniper SRX IDPS device, create an anomaly-based attack object.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Create a protocol anomaly-based attack object:\n\nSpecify a name for the attack.\n[edit]\nsecurity idp custom-attack anomaly1\n\nSpecify common properties for the attack.\n[edit security idp custom-attack anomaly1]\nset severity info\nset time-binding scope peer count 2\n\nSpecify the attack type and test condition.\n[edit]\nsecurity idp custom-attack anomaly1\nset attack-type anomaly test OPTIONS_UNSUPPORTED\n\nSpecify other properties for the anomaly attack.\n[edit]\nsecurity idp custom-attack anomaly1\nset attack-type anomaly service TCP\nu set attack-type anomaly direction any\nattack-type anomaly shellcode spark",
        "reference": "800-53|SC-5(2),800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-80891r1_rule,STIG-ID|JUSX-IP-000007,SWIFT-CSCv1|6.4,Vuln-ID|V-66401",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp custom-attack .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_11": {
        "description": "JUSX-IP-000008 - The Juniper Networks SRX Series Gateway IDPS must detect, at a minimum, mobile code that is unsigned or exhibiting unusual behavior, has not undergone a risk assessment, or is prohibited for use based on a risk assessment.",
        "info": "Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient. Examples of mobile code include JavaScript, VBScript, Java applets, ActiveX controls, Flash animations, Shockwave videos, and macros embedded within Microsoft Office documents. Mobile code can be exploited to attack a host. It can be sent as an email attachment or embedded in other file formats not traditionally associated with executable code.\n\nWhile the IDPS cannot replace the anti-virus and host-based IDS (HIDS) protection installed on the network's endpoints, vendor or locally created sensor rules can be implemented, which provide preemptive defense against both known and zero-day vulnerabilities. Many of the protections may provide defenses before vulnerabilities are discovered and rules or blacklist updates are distributed by anti-virus or malicious code solution vendors.\n\nTo monitor for and detect known prohibited mobile code or approved mobile code that violates permitted usage requirements, the IDPS must implement policy filters, rules, signatures, and anomaly analysis.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Specify a name for the attack. Specify common properties for the attack. Specify the attack type and context. Specify the attack direction and the shellcode flag. Set the protocol and its fields. Specify the protocol binding and ports. Specify the direction.\n\n[edit]\nedit security idp custom-attackset severity major\nset recommended-action drop-packet\nset time-binding scope source count 10\nset attack-type signature context packet\nset attack-type signature shellcode intel\nset attack-type signature protocol ip ttl value 128 match equal\nset attack-type signature protocol-binding tcp minimum-port 50 maximum-port 100\nset attack-type signature direction any",
        "reference": "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001166,CSF|DE.CM-5,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-80893r1_rule,STIG-ID|JUSX-IP-000008,Vuln-ID|V-66403",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp custom-attack .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_12": {
        "description": "JUSX-IP-000009 - The Juniper Networks SRX Series Gateway IDPS must block any prohibited mobile code at the enclave boundary when it is detected.",
        "info": "Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient. Examples of mobile code include JavaScript, VBScript, Java applets, ActiveX controls, Flash animations, Shockwave videos, and macros embedded within Microsoft Office documents. Mobile code can be exploited to attack a host. It can be sent as an email attachment or embedded in other file formats not traditionally associated with executable code.\n\nWhile the IDPS cannot replace the anti-virus and host-based IDS (HIDS) protection installed on the network's endpoints, vendor or locally created sensor rules can be implemented, which provide preemptive defense against both known and zero-day vulnerabilities. Many of the protections may provide defenses before vulnerabilities are discovered and rules or blacklist updates are distributed by anti-virus or malicious code solution vendors.\n\nTo block known prohibited mobile code or approved mobile code that violates permitted usage requirements, the IDPS must implement policy filters, rules, signatures, and anomaly analysis.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To enable IDP services to drop traffic when there is a detection event on a zone based on the IDP policy:\n\nOnce the IDP policy is configured, IDP must be enabled on a security policy in order for IDP inspection to be performed.\n\nKeep in mind that IDP inspection will only be performed on the traffic matching the security policies where IDP is enabled.\n\nTo enable IDP on a security policy, enter the following command:\n\nset security policies from-zoneto-zonepolicythen permit application-services idp",
        "reference": "800-171|3.13.13,800-53|SC-18(1),800-53r5|SC-18(1),CAT|II,CCI|CCI-001662,CSF|DE.CM-5,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(1),NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,Rule-ID|SV-80895r1_rule,STIG-ID|JUSX-IP-000009,Vuln-ID|V-66405",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies from-zone .+ to-zone .+ policy .+ then permit application-services idp",
        "expect": "^Manual Review Required$"
    },
    "custom_item_13": {
        "description": "JUSX-IP-000017 - The Juniper Networks SRX Series Gateway IDPS must protect against or limit the effects of known and unknown types of Denial of Service (DoS) attacks by employing rate-based attack prevention behavior analysis.",
        "info": "If the network does not provide safeguards against DoS attack, network resources will be unavailable to users.\n\nInstallation of IDPS detection and prevention components (i.e., sensors) at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.\n\nDetection components that use rate-based behavior analysis can detect attacks when signatures for the attack do not exist or are not installed. These attacks include zero-day attacks which are new attacks for which vendors have not yet developed signatures. Rate-based behavior analysis can detect sophisticated, Distributed DoS (DDoS) attacks by correlating traffic information from multiple network segments or components.\n\nThe Juniper SRX must be configured with screens using the Firewall STIG, but must also be configured for anomaly-based protection using various locally developed anomaly-based attack objects.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Create a protocol anomaly-based attack object:\n\nSpecify a name for the attack.\n[edit]\nsecurity idp custom-attack anomaly1\n\nSpecify common properties for the attack.\n[edit security idp custom-attack anomaly1]\nset severity info\nset time-binding scope peer count 2\n\nSpecify the attack type and test condition.\n[edit]\nsecurity idp custom-attack anomaly1set attack-type anomaly test OPTIONS_UNSUPPORTED\n\nSpecify other properties for the anomaly attack.\n[edit]\nsecurity idp custom-attack anomaly1]\nset attack-type anomaly service TCP\nu set attack-type anomaly direction any\nattack-type anomaly shellcode spark",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-80909r1_rule,STIG-ID|JUSX-IP-000017,Vuln-ID|V-66419",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp custom-attack .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_14": {
        "description": "JUSX-IP-000018 - The Juniper Networks SRX Series Gateway IDPS must protect against or limit the effects of known and unknown types of Denial of Service (DoS) attacks by employing anomaly-based detection.",
        "info": "If the network does not provide safeguards against DoS attack, network resources will be unavailable to users.\n\nInstallation of IDPS components (i.e., sensors) at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks.\n\nDetection components that use pattern recognition pre-processors can detect attacks when signatures for the attack do not exist or are not installed. These attacks include zero-day attacks which are new attacks for which vendors have not yet developed signatures.\n\nThis requirement applies to the communications traffic functionality of the IDPS as it pertains to handling communications traffic, rather than to the IDPS device itself. The Juniper SRX must be configured with screens using the Firewall STIG, but must also be configured for anomaly-based protection using various locally developed anomaly-based attack objects.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Create a protocol anomaly-based attack object:\n\nSpecify a name for the attack.\n[edit]\nsecurity idp custom-attack anomaly1\n\nSpecify common properties for the attack.\n[edit security idp custom-attack anomaly1]\nset severity info\nset time-binding scope peer count 2\n\nSpecify the attack type and test condition.\n[edit]\nsecurity idp custom-attack anomaly1set attack-type anomaly test OPTIONS_UNSUPPORTED\n\nSpecify other properties for the anomaly attack.\n[edit]\nsecurity idp custom-attack anomaly1]\nset attack-type anomaly service TCP\nu set attack-type anomaly direction any\nattack-type anomaly shellcode spark",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-80911r2_rule,STIG-ID|JUSX-IP-000018,Vuln-ID|V-66421",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp custom-attack .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_15": {
        "description": "JUSX-IP-000023 - The IDPS must send an alert to, at a minimum, the ISSO and ISSM when intrusion detection events are detected that indicate a compromise or potential for compromise.",
        "info": "Without an alert, security personnel may be unaware of intrusion detection incidents that require immediate action and this delay may result in the loss or compromise of information.\n\nIn accordance with CCI-001242, the IDPS is a real-time intrusion detection system. These systems must generate an alert when detection events from real-time monitoring occur. Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The IDPS must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel. The Juniper SRX IDPS can be configured for email alerts.",
        "solution": "Create a custom rule that identifies the Junos application which is prohibited on the network.\n\nAdd the option 'alert' onto the rule to send an alert when that rule is invoked. Alerts should be sent only on critical and other site-selected items to prevent an excess of alerts.\n\n[edit]\nset security idp idp-policy recommended rulebase-ips rule-1 then notification log-attacks alert",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-80915r1_rule,STIG-ID|JUSX-IP-000023,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-66425",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks .+",
        "expect": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks alert"
    },
    "custom_item_16": {
        "description": "JUSX-IP-000025 - The IDPS must send an alert to, at a minimum, the ISSO and ISSM when DoS incidents are detected.",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action and this delay may result in the loss or compromise of information.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event Categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category I, II, IV, and VII detection events) will require an alert when an event is detected.\n\nAlerts messages must include a severity level indicator or code as an indicator of the criticality of the incident. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The IDPS must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel. The Juniper SRX IDPS can be configured for email alerts.",
        "solution": "Configure alerts for IDP attack by using the [edit security alarms potential-violation] command.\n\nAdd the option 'alert' onto the rule to send an alert when that rule is invoked. Alerts should be sent only on critical and other site-selected items to prevent an excess of alerts.\n\n[edit]\nset security idp idp-policy recommended rulebase-ips rule-1 then notification log-attacks alert",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-80919r1_rule,STIG-ID|JUSX-IP-000025,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-66429",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks .+",
        "expect": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks alert"
    },
    "custom_item_17": {
        "description": "security-package url",
        "regex": "set security idp security-package url .+",
        "expect": "set security idp security-package url .+"
    },
    "custom_item_18": {
        "description": "security-package automatic interval",
        "regex": "set security idp security-package automatic interval .+",
        "expect": "set security idp security-package automatic interval .+"
    },
    "custom_item_19": {
        "description": "security-package automatic enable",
        "regex": "set security idp security-package automatic .+",
        "expect": "set security idp security-package automatic enable"
    },
    "custom_item_20": {
        "description": "JUSX-IP-000027 - The Juniper Networks SRX Series Gateway IDPS must perform real-time monitoring of files from external sources at network entry/exit points.",
        "info": "Real-time monitoring of files from external sources at network entry/exit points helps to detect covert malicious code before it is downloaded to or executed by internal and external endpoints. Using malicious code, such as viruses, worms, Trojan horses, and spyware, an attacker may gain access to sensitive data and systems.\n\nIDPSs innately meet this requirement for real-time scanning for malicious code when properly configured to meet the requirements of this STIG. However, most products perform communications traffic inspection at the packet level.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a dynamic custom attack group which includes attack objects for malicious code monitoring of files. There are many ways to accomplish this; thus, the following is only an example:\n\n[edit]\nsecurity idp dynamic-attack-group Malicious-Activity\nset category values [ SHELLCODE VIRUS WORMS SPYWARE TROJAN]",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.1.,800-53r5|SI-3c.1.,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.a.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-80923r1_rule,STIG-ID|JUSX-IP-000027,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-66433",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp dynamic-attack-group .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_21": {
        "description": "JUSX-IP-000028 - The Juniper Networks SRX Series Gateway IDPS must drop packets or disconnect the connection when malicious code is detected.",
        "info": "Configuring the IDPS to discard and/or redirect based on local organizational incident handling procedures minimizes the impact of this code on the network.\n\nOnce an attack object in the IPS policy is matched, the SRX can execute an action on that specific session, along with actions on future sessions. The ability to execute an action on that particular session is known as an IDPS action. IDPS actions can be one of the following: No-Action, Drop-Packet, Drop-Connection, Close-Client, Close-Server, Close-Client-and-Server, DSCP-Marking, Recommended, or Ignore. IP actions are actions that can be enforced on future sessions. These actions include IP-Close, IP-Block, and IP-Notify",
        "solution": "This requirement can be met through a custom rule within a policy or drop action option on the zone configuration to which the policy is applied. The following is an example of the command that can be added to the IDP policy. The policy is called Malicious-Activity and the rule is called R1 in this example.\n\n[edit]\nset security idp idp-policy Malicious-Activity rulebase-ips rule R1 then action drop-connection",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.2.,800-53r5|SI-3c.2.,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.b.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-80925r1_rule,STIG-ID|JUSX-IP-000028,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-66435",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp idp-policy .+ rulebase-ips rule .+ then action drop",
        "expect": "set security idp idp-policy .+ rulebase-ips rule .+ then action drop"
    },
    "custom_item_22": {
        "description": "JUSX-IP-000029 - The Juniper Networks SRX Series Gateway IDPS must send an immediate alert to, at a minimum, the Security Control Auditor (SCA) when malicious code is detected.",
        "info": "Without an alert, security personnel may be unaware of an impending failure of the audit capability, and the ability to perform forensic analysis and detect rate-based and other anomalies will be impeded.\n\nThe IDPS generates an immediate (within seconds) alert which notifies designated personnel of the incident. Sending a message to an unattended log or console does not meet this requirement since that will not be seen immediately. These messages should include a severity level indicator or code as an indicator of the criticality of the incident.",
        "solution": "This requirement can be met using an alert. Alerts must be enabled and configured and then added to the IDP policy rulebase command as an option. The following is an example of the command that can be added to the IDP policy. The policy is called Malicious-Activity and the rule is called R1 in this example.\n\n[edit]\nset security idp idp-policy Malicious-Activity rulebase-ips rule R1 then notification log-attacks alert",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3c.2.,800-53r5|SI-3c.2.,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSF|DE.CM-4,CSF|DE.DP-3,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3c.b.,NESA|T3.4.1,NIAv2|NS24,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.3.2,PCI-DSSv4.0|5.3.3,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,Rule-ID|SV-80927r1_rule,STIG-ID|JUSX-IP-000029,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-66437",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks .+",
        "expect": "set security idp idp-policy .+ rulebase-ips .+ then notification log-attacks alert"
    },
    "custom_item_23": {
        "description": "JUSX-IP-000030 - The Juniper Networks SRX Series Gateway IDPS must have only active Juniper Networks licenses.",
        "info": "If the IDP or UTM licenses are allowed to lapse, the Juniper SRX IDPS can still inspect traffic and continue to use the outdated signature database for rules, objects, and dynamic groups. However, updates to the signature database cannot be downloaded from Juniper Networks. This puts the network at risk since the updates are used to addresses new CERT and IAVM vulnerabilities.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update the expired licenses immediately following the procedures on the vendor website.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-80929r1_rule,STIG-ID|JUSX-IP-000030,SWIFT-CSCv1|2.3,Vuln-ID|V-66439",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show system license",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_24": {
        "description": "JUSX-IP-000031 - The Juniper Networks SRX Series Gateway IDPS must either forward the traffic from inbound connections to be more deeply inspected for malicious code and Layer 7 threats, or the Antivirus and Unified Threat Management (UTM) license must be installed, active, and policies and rules configured.",
        "info": "UTM is an industry term that was coined to define Layer 7 protection against client-side threats. This does not include IPS (which also has protection against server-to-client attacks) but rather technologies such as network-based antivirus protection, URL filtering, antispam solutions, and content filtering. IPS is primarily focused on network-based attacks on protocols, and is stream based, meaning that it processes traffic inline without modifying it as a stream. This works great from a performance perspective to detect attacks against services and applications. UTM, on the other hand, is meant more for protecting against files that are transmitted on top of the network streams. Although IPS might be more geared for detecting an overflow of the parser of the network stream, it isn't as well geared for detecting threats within files. That is, it certainly can detect such file-based attacks, but attackers can go to great lengths to encode, encrypt, and obfuscate files to perform some malicious action-and it is very difficult to detect these attacks in Stream mode.",
        "solution": "Configure at least one policy for the UTM and AV policy using the commands and options for the [edit security utm] hierarchy.\n\nIf the UTM and AV licenses are not installed, IDPS must be installed in the architecture so that traffic is forwarded for deeper AV and UTM inspection. This can be accomplished by using a zone stanza to direct the traffic to an interface or IP destination address.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_IDPS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-80931r1_rule,STIG-ID|JUSX-IP-000031,SWIFT-CSCv1|2.3,Vuln-ID|V-66441",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security utm .+",
        "expect": "set security utm .+"
    }
}