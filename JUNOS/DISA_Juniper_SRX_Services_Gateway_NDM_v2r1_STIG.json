{
    "custom_item_1": {
        "description": "JUSX-DM-000001 - The Juniper SRX Services Gateway must limit the number of concurrent sessions to a maximum of 10 or less for remote access using SSH.",
        "info": "The connection-limit command limits the total number of concurrent SSH sessions. To help thwart brute force authentication attacks, the connection limit should be as restrictive as operationally practical\n\nJuniper Networks recommends the best practice of setting 10 (or less) for the connection-limit.\n\nThis configuration will permit up to 10 users to log in to the device simultaneously, but an attempt to log an 11th user into the device will fail. The attempt will remain in a waiting state until a session is terminated and made available.",
        "solution": "Configure the SSH protocol to limit connection and sessions per connection.\n\n[edit]\nset system services ssh connection-limit 10\nset system services ssh max-sessions-per-connection 1",
        "reference": "800-53|AC-10,800-53r5|AC-10,CAT|III,CCI|CCI-000054,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-223180r513235_rule,STIG-ID|JUSX-DM-000001,STIG-Legacy|SV-81039,STIG-Legacy|V-66549,Vuln-ID|V-223180",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services ssh",
        "expect": "set system services ssh connection-limit @SSH_CONNECTION_LIMIT@"
    },
    "custom_item_2": {
        "description": "JUSX-DM-000007 - The Juniper SRX Services Gateway must automatically terminate a network administrator session after organization-defined conditions or trigger events requiring session disconnect.",
        "info": "Automatic session termination addresses the termination of administrator-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect).\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use. These conditions will vary across environments and network device types.\n\nThe Juniper SRX can be configured to limit login times or to logout users after a certain time period if desired by the organization. These setting are configured as options on the login class to which they apply.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To configure user access on specific days of the week for a specified duration, include the allowed-days, access-start, and access-end statements. The following is an example of a configuration for a class which would automatically log out users. Consult the Juniper SRX documentation for other options.\n\n[edit system login]\nclass class-name allowed-days [ days-of-the-week ];\nclass class-name access-start HH:MM;\nclass class-name access-end HH:MM;",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.4.2,800-53|AU-12a.,800-53|CM-6b.,800-53r5|AU-12a.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000169,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,ITSG-33|CM-6b.,NESA|T3.2.1,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-229014r518220_rule,STIG-ID|JUSX-DM-000007,STIG-Legacy|SV-80947,STIG-Legacy|V-66457,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.4,Vuln-ID|V-229014",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set sysytem login class .+ (allowed-days|access-start|access-end)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_3": {
        "description": "JUSX-DM-000015 - For local accounts created on the device, the Juniper SRX Services Gateway must automatically generate log records for account creation events.",
        "info": "Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.\n\nAn AAA server is required for account management in accordance with CCI-000370. Only a single account of last resort is permitted on the local device. However, since it is still possible for administrators to create local accounts either maliciously or to support mission needs, the SRX must be configured to log account management events.\n\nTo log local account management events, ensure at least one external syslog server is configured to log facility any or facility change-log, and severity info or severity any.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-223181r513238_rule,STIG-ID|JUSX-DM-000015,STIG-Legacy|SV-80949,STIG-Legacy|V-66459,TBA-FIISB|36.2.3,Vuln-ID|V-223181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_4": {
        "description": "JUSX-DM-000016 - For local accounts created on the device, the Juniper SRX Services Gateway must automatically generate log records for account modification events.",
        "info": "Upon gaining access to a network device, an attacker will often first attempt to modify existing accounts to increase/decrease privileges. Notification of account modification events help to mitigate this risk. Auditing account modification events provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.\n\nAn AAA server is required for account management in accordance with CCI-000370. Only a single account of last resort is permitted on the local device. However, since it is still possible for administrators to create local accounts either maliciously or to support mission needs, the SRX must be configured to log account management events.\n\nTo log local account management events, ensure at least one external syslog server is configured to log facility any or facility change-log, and severity info or severity any.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-223182r513241_rule,STIG-ID|JUSX-DM-000016,STIG-Legacy|SV-80951,STIG-Legacy|V-66461,TBA-FIISB|36.2.3,Vuln-ID|V-223182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_5": {
        "description": "JUSX-DM-000017 - For local accounts created on the device, the Juniper SRX Services Gateway must automatically generate log records for account disabling events.",
        "info": "When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized, active accounts remain enabled and available for use when required. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.\n\nAn AAA server is required for account management in accordance with CCI-000370. Only a single account of last resort is permitted on the local device. However, since it is still possible for administrators to create local accounts either maliciously or to support mission needs, the SRX must be configured to log account management events.\n\nTo log local account management events, ensure at least one external syslog server is configured to log facility any or facility change-log, and severity info or severity any.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001404,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-223183r513244_rule,STIG-ID|JUSX-DM-000017,STIG-Legacy|SV-80953,STIG-Legacy|V-66463,TBA-FIISB|36.2.3,Vuln-ID|V-223183",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_6": {
        "description": "JUSX-DM-000018 - For local accounts created on the device, the Juniper SRX Services Gateway must automatically generate log records for account removal events.",
        "info": "Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.\n\nAn AAA server is required for account management in accordance with CCI-000370. Only a single account of last resort is permitted on the local device. However, since it is still possible for administrators to create local accounts either maliciously or to support mission needs, the SRX must be configured to log account management events.\n\nTo log local account management events, ensure at least one external syslog server is configured to log facility any or facility change-log, and severity info or severity any.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-223184r513247_rule,STIG-ID|JUSX-DM-000018,STIG-Legacy|SV-80955,STIG-Legacy|V-66465,TBA-FIISB|36.2.3,Vuln-ID|V-223184",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_7": {
        "description": "syslog users change-log",
        "regex": "set system syslog users .+",
        "expect": "set system syslog users \\* change-log (info|any)"
    },
    "custom_item_8": {
        "description": "syslog host any any",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_9": {
        "description": "syslog file change-log",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file account-actions change-log any any"
    },
    "custom_item_10": {
        "description": "syslog users change-log",
        "regex": "set system syslog users .+",
        "expect": "set system syslog users \\* change-log (info|any)"
    },
    "custom_item_11": {
        "description": "syslog host any any",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_12": {
        "description": "syslog file change-log",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file account-actions change-log any any"
    },
    "custom_item_13": {
        "description": "syslog users change-log",
        "regex": "set system syslog users .+",
        "expect": "set system syslog users \\* change-log (info|any)"
    },
    "custom_item_14": {
        "description": "syslog host any any",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_15": {
        "description": "syslog file change-log",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file account-actions change-log any any"
    },
    "custom_item_16": {
        "description": "syslog users change-log",
        "regex": "set system syslog users .+",
        "expect": "set system syslog users \\* change-log (info|any)"
    },
    "custom_item_17": {
        "description": "syslog host any any",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_18": {
        "description": "syslog file change-log",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file account-actions change-log any any"
    },
    "custom_item_19": {
        "description": "JUSX-DM-000023 - The Juniper SRX Services Gateway must automatically generate a log event when accounts are enabled.",
        "info": "Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail which documents the creation of application user accounts and notifies administrators and Information System Security Officers (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.\n\nAccounts can be disabled by configuring the account with the build-in login class 'unauthorized'. When the command is reissued with a different login class, the account is enabled.",
        "solution": "The following commands configure the device to immediately display a message to any currently logged on administrator's console when changes are made to the configuration.\n\n[edit]\nset system syslog hostany any\nset system syslog file account-actions change-log any any",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-002130,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-223185r513250_rule,STIG-ID|JUSX-DM-000023,STIG-Legacy|SV-80959,STIG-Legacy|V-66469,TBA-FIISB|36.2.3,Vuln-ID|V-223185",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file account-actions change-log any any"
    },
    "custom_item_20": {
        "description": "JUSX-DM-000024 - The Juniper SRX Services Gateway must generate an immediate alert message to the management console for account enabling actions.",
        "info": "In order to detect and respond to events that affect network administrator accessibility and device processing, network devices must audit account enabling actions and, as required, notify the appropriate individuals so they can investigate the event.\n\nAlerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\nAccounts can be disabled by configuring the account with the built-in login class 'unauthorized'. When the command is reissued with a different login class, the account is enabled.",
        "solution": "The following commands configure the device to immediately display a message to any currently logged on administrator's console when changes are made to the configuration. This is an example method. Alerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\n[edit]\nset system syslog users * change-log",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53|SI-13(4)(b),800-53r5|CM-6b.,800-53r5|SI-13(4)(b),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|SI-13(4)(b),NESA|T3.2.1,Rule-ID|SV-229019r518235_rule,STIG-ID|JUSX-DM-000024,STIG-Legacy|SV-80961,STIG-Legacy|V-66471,SWIFT-CSCv1|2.3,TBA-FIISB|39.1,Vuln-ID|V-229019",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog users .+",
        "expect": "set system syslog users \\* change-log (info|any)"
    },
    "custom_item_21": {
        "description": "JUSX-DM-000025 - The Juniper SRX Services Gateway must enforce the assigned privilege level for each administrator and authorizations for access to all commands by assigning a login class to all AAA-authenticated users.",
        "info": "To mitigate the risk of unauthorized privileged access to the device, administrators must be assigned only the privileges needed to perform the tasked assigned to their roles.\n\nAlthough use of an AAA server is required for non-local access for device management, the SRX must also be configured to implement the corresponding privileges upon user login. Each externally authenticated user is assigned a template that maps to a configured login class.\n\nAAA servers are usually configured to send a Vendor Specific Attribute (VSA) to the Juniper SRX. The device uses this information to determine the login class to assign to the authenticated user. Unless a VSA is returned from the AAA server, externally-authenticated users are mapped to the 'remote' user by default. Remote user is a special default account in Junos OS. If this default account, or another designated remote user account, is not configured, then only externally-authenticated users with a returned VSA of a local template account are permitted login. If the remote user is configured, all externally-authenticated users without a returned VSA default to the remote user account's configured login class. All externally-authenticated users with a returned VSA inherit the login class configured for each respective template account.\n\nJunos OS provides four built-in login classes: super-user (all permissions), operator (limited permissions), read-only (no change permissions), and unauthorized (prohibits login). Because these classes are not configurable by the system administrator, they should not be used except for the unauthorized class which may be used for the remote user to deterministically prohibit logins from externally-authenticated users without a returned VSA. Therefore, all template user accounts, and the local account of last resort, should use custom, user-defined, login classes.\n\nExternally-authenticated users maintain two account names in Junos OS: the user and login names. The user name is the local template account name and the login name is the authenticated user's external account name. Junos OS links the names to determine permissions, based upon login class, but uses the external account name for logging. Doing so permits multiple, individually-authenticated users, to be mapped to the same template account, and therefore enforce uniform permissions for each group of administrators, while also attributing any logged changes to the appropriate individual user.\n\nTemplate accounts are differentiated from local accounts by the presence of an authentication stanza; only the local account of last resort should have an authentication stanza."
    },
    "custom_item_22": {
        "description": "JUSX-DM-000029 - The Juniper SRX Services Gateway must generate a log event when privileged commands are executed.",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nAll commands executed on the Juniper SRX are privileged commands. Thus, this requirement is configured using the same syslog command as CCI-000172.",
        "solution": "Along with the other commands that constitute a complete DoD syslog configuration, the following command must be ensure privileged commands are sent to the Syslog Server.\n\n[edit]\nset system syslog hostany any",
        "reference": "800-171|3.1.7,800-53|AC-6(9),800-53r5|AC-6(9),CAT|III,CCI|CCI-002234,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.12.4.3,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-223187r513256_rule,STIG-ID|JUSX-DM-000029,STIG-Legacy|SV-81041,STIG-Legacy|V-66551,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-223187",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_23": {
        "description": "JUSX-DM-000030 - For local accounts created on the device, the Juniper SRX Services Gateway must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.",
        "info": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.\n\nJuniper SRX is unable to comply with the 15-minute time period part of this control.",
        "solution": "Configure the number of unsuccessful logon attempts for all login account, globally.\n\n[edit]\nset system login retry-options tries-before-disconnect 3",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|III,CCI|CCI-000044,CN-L3|8.1.4.1(b),DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-223188r513259_rule,STIG-ID|JUSX-DM-000030,STIG-Legacy|SV-81043,STIG-Legacy|V-66553,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-223188",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login retry-options .+",
        "expect": "set system login retry-options tries-before-disconnect 3$"
    },
    "custom_item_24": {
        "description": "JUSX-DM-000032 - The Juniper SRX Services Gateway must display the Standard Mandatory DoD Notice and Consent Banner before granting access.",
        "info": "Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.\n\nThe Standard Mandatory DoD Notice and Consent Banner must be displayed before the user has been authenticated.",
        "solution": "To configure a system login message, include the message statement at the [edit] hierarchy level.\nThis is the approved verbiage for applications that can accommodate banners of 1300 characters:\n\n[edit]\nset system login message 'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\by using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\\n\\n'\n\nOR\n\n[edit]\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\nset system login message 'I've read & consent to terms in IS user agreem't>\\n\\n'\n\nNote: Use \\n to insert a line between paragraphs where needed.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|III,CCI|CCI-000048,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-223189r513262_rule,STIG-ID|JUSX-DM-000032,STIG-Legacy|SV-81045,STIG-Legacy|V-66555,TBA-FIISB|45.2.4,Vuln-ID|V-223189",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login message",
        "content": "@BANNER_MESSAGE@"
    },
    "custom_item_25": {
        "description": "JUSX-DM-000039 - The Juniper SRX Services Gateway must allow only the ISSM (or administrators/roles appointed by the ISSM) to select which auditable events are to be generated and forwarded to the syslog and/or local logs.",
        "info": "Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nThe primary audit log permissions are set on the Syslog server, not the Juniper SRX. However, it is a best practice to also keep local logs for troubleshooting and backup. These logs are subject to access control requirements.\n\nThis configuration is a two-step process. Part of the configuration must be performed on the AAA server. After a user successfully logs on, the AAA sever passes the template or role of the user to the Juniper SRX. Each AAA template or role is mapped to a login class on the Juniper SRX.\n\nOn the Juniper SRX, the class name, audit-admin, is recommended as a best practice because it follows the naming convention used in NIAP testing and is self-documenting.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the Juniper SRX to allow only the ISSM user account (or administrators/roles appointed by the ISSM) to select which auditable events are to be audited. To ensure this is the case, each ISSM-appointed role on the AAA must be configured for least privilege using the following stanzas for each role.\n\nFor audit-admin role:\n\n[edit]\nset system login class audit-admin permissions [ security trace maintenance ]\nset system login class audit-admin allow-commands '^clear (log|security log)'\nset system login class audit-admin deny-commands '^clear (security alarms|system login lockout)|^file (copy|delete|rename)|^request (security|system set-encryption-key)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell'\nset system login class audit-admin security-role audit-administrator\nset system login user audit-officer class audit-admin\n\nFor the crypto admin role:\n\n[edit]\nset system login class crypto-admin permissions [ admin-control configure maintenance security-control system-control trace ]\nset system login class crypto-admin allow-commands '^request system set-encryption-key'\nset system login class crypto-admin deny-commands '^clear (log|security alarms|security log|system login lockout)|^file (copy|delete|rename)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell'\nset system login class crypto-admin allow-configuration-regexps 'security (ike|ipsec) (policy|proposal)' 'security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)' 'system fips self-test after-key-generation'\nset system login class crypto-admin security-role crypto-administrator\n\nFor the security-admin role:\n\n[edit]\nset system login class security-admin permissions all\nset system login class security-admin deny-commands '^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key)|^rollback|^start shell'\nset system login class security-admin deny-configuration-regexps 'security alarms potential-violation idp' 'security (ike|ipsec) (policy|proposal)' 'security ipsec ^vpn$ .* manual (authentication| encryption|protocol|spi)' 'security log cache' 'security log exclude .* event-id IDP_.*' 'system fips self-test after-key- generation'\nset system login class security-admin security-role security-administrator\n\nFor the ids-admin role:\n\n[edit]\nset system login class ids-admin permissions [ configure maintenance security-control trace ]\nset system login class ids-admin allow-configuration-regexps 'security alarms potential-violation idp' 'security log exclude .* event-id IDP_.*'\nset system login class ids-admin deny-commands '^clear log|^(clear|show) security alarms (alarm-id|all|newer-than|older- than|process|severity)|^(clear|show) security alarms alarm-type (authentication|cryptographic-self-test|decryption-failures|encryption-failures| ike-phase1-failures|ike-phase2-failures|key-generation-self-test| non-cryptographic-self-test|policy|replay-attacks)|^file (copy|delete|rename)|^request (security|system set-encryption-key)|^rollback|^set date|^show security (dynamic-policies|match-policies|policies)|^start shell'\nset system login class ids-admin deny-configuration-regexps 'security alarms potential-violation (authentication|cryptographic-self-test|decryption-failures|encryption-failures|ike-phase1-failures|ike-phase2-failures|key-generation-self-test|non-cryptographic-self-test|policy|replay-attacks)'\nset system login class ids-admin security-role ids-admin\n\nFor the crypto-officer class:\n\n[edit]\nset system login user crypto-officer class crypto-admin\nset system login user security-officer class security-admin\nset system login user ids-officer class ids-admin",
        "reference": "800-171|3.1.1,800-171|3.4.2,800-53|AC-2(4),800-53|CM-6b.,800-53r5|AC-2(4),800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CCI|CCI-001684,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-229021r518241_rule,STIG-ID|JUSX-DM-000039,STIG-Legacy|SV-81047,STIG-Legacy|V-66557,SWIFT-CSCv1|2.3,TBA-FIISB|36.2.3,Vuln-ID|V-229021",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login class .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_26": {
        "description": "JUSX-DM-000040 - The Juniper SRX Services Gateway must generate log records when successful attempts to configure the device and use commands occur.",
        "info": "Without generating log records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nWhile the Juniper SRX inherently has the capability to generate log records, by default only the high facility levels are captured by default to local files.\n\nEnsure at least one Syslog server and local files are configured to support requirements. However, the Syslog itself must also be configured to filter event records so it is not overwhelmed. A best practice when configuring the external Syslog server is to add similar log-prefixes to the log file names to help and researching of central Syslog server. Another best practice is to add a match condition to limit the recorded events to those containing the regular expression (REGEX).",
        "solution": "The following example commands configure Syslog and local backup files to capture DoD-defined auditable events.\n\n[edit]\nset system syslog user * any emergency\nset system syslog hostany any\nset system syslog hostsource-addressset system syslog hostlog-prefixset system syslog file messages any info\nset system syslog file messages authorization none\nset system syslog file messages interactive-commands none\nset system syslog file messages daemon none\nset system syslog file User-Auth authorization any\nset system syslog file interactive-commands interactive-commands any\nset system syslog file processes daemon any\nset system syslog file account-actions change-log any any\nset file account-actions match 'system login user'\nset system syslog console any any",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223191r513265_rule,STIG-ID|JUSX-DM-000040,STIG-Legacy|SV-81049,STIG-Legacy|V-66559,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223191",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog (host|file) .+",
        "expect": "set system syslog (host|file) .+ any any",
        "number_of_lines": "^2$"
    },
    "custom_item_27": {
        "description": "JUSX-DM-000041 - The Juniper SRX Services Gateway must generate log records when changes are made to administrator privileges.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223192r513268_rule,STIG-ID|JUSX-DM-000041,STIG-Legacy|SV-81051,STIG-Legacy|V-66561,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223192",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_28": {
        "description": "JUSX-DM-000042 - The Juniper SRX Services Gateway must generate log records when administrator privileges are deleted.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "Configure at least one external syslog host is configured to log facility change-log or any, and severity info or any.\n\n[edit system syslog]\nset hostany-OR-\n\n[edit]\nset hostchange-log",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223193r513271_rule,STIG-ID|JUSX-DM-000042,STIG-Legacy|SV-81053,STIG-Legacy|V-66563,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223193",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ (any|change-log) (info|any)"
    },
    "custom_item_29": {
        "description": "JUSX-DM-000043 - The Juniper SRX Services Gateway must generate log records when logon events occur.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "Configure at least one external syslog host to log facility any and severity info or any.\n\n[edit system syslog]\nset hostany",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223194r513274_rule,STIG-ID|JUSX-DM-000043,STIG-Legacy|SV-81055,STIG-Legacy|V-66565,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223194",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any (info|any)"
    },
    "custom_item_30": {
        "description": "JUSX-DM-000044 - The Juniper SRX Services Gateway must generate log records when privileged commands are executed.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "Configure at least one external syslog host to log facility any and severity info or any. There are multiple ways to accomplish this, the following is an example.\n\n[edit system syslog]\nset hostany any",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223195r513277_rule,STIG-ID|JUSX-DM-000044,STIG-Legacy|SV-81057,STIG-Legacy|V-66567,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223195",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_31": {
        "description": "JUSX-DM-000046 - The Juniper SRX Services Gateway must generate log records when concurrent logons from different workstations occur.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "Configure at least one external syslog host to log facility any and severity info or any. There are multiple ways to accomplish this, the following is an example.\n\n[edit system syslog]\nset hostany any",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223196r513280_rule,STIG-ID|JUSX-DM-000046,STIG-Legacy|SV-81059,STIG-Legacy|V-66569,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-223196",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog host .+",
        "expect": "set system syslog host .+ any any"
    },
    "custom_item_32": {
        "description": "JUSX-DM-000055 - The Juniper SRX Services Gateway must generate log records containing the full-text recording of privileged commands.",
        "info": "Reconstruction of harmful events or forensic analysis is not possible if log records do not contain enough information.\n\nOrganizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.\n\nWhile the Juniper SRX inherently has the capability to generate log records, by default only the high facility levels are captured and only to local files.\n\nEnsure at least one Syslog server and local files are configured to support requirements. However, the Syslog itself must also be configured to filter event records so it is not overwhelmed. A best practice when configuring the external Syslog server is to add similar log-prefixes to the log file names to help and researching of central Syslog server. Another best practice is to add a match condition to limit the recorded events to those containing the regular expression (REGEX).",
        "solution": "The following commands configure syslog to record any use of any command, including privileged commands. Configure Syslog and local backup files to capture DoD-defined auditable events.\n\n[edit]\nset system syslog user * any emergency\nset system syslog hostany any\nset system syslog hostsource-addressset system syslog hostlog-prefixset system syslog file messages any info\nset system syslog file messages authorization none\nset system syslog file messages interactive-commands none\nset system syslog file messages daemon none\nset system syslog file User-Auth authorization any\n\nset system syslog file interactive-commands interactive-commands any\nset system syslog file processes daemon any\nset system syslog file account-actions change-log any any\nset file account-actions match 'system login user'\nset system syslog console any any",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3(1),800-53r5|AU-3(1),CAT|III,CCI|CCI-000135,CN-L3|7.1.3.3(b),CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223197r513283_rule,STIG-ID|JUSX-DM-000055,STIG-Legacy|SV-81061,STIG-Legacy|V-66571,SWIFT-CSCv1|6.4,Vuln-ID|V-223197",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog (host|file) .+",
        "expect": "set system syslog (host|file) .+ any any",
        "number_of_lines": "^2$"
    },
    "custom_item_33": {
        "description": "JUSX-DM-000056 - For local log files, the Juniper SRX Services Gateway must allocate log storage capacity in accordance with organization-defined log record storage requirements so that the log files do not grow to a size that causes operational issues.",
        "info": "In order to ensure network devices have a sufficient storage capacity in which to write the logs, they need to be able to allocate audit record storage capacity. The task of allocating audit record storage capacity is usually performed during initial device setup if it is modifiable.\n\nThe amount allocated for the organization-defined audit record storage requirement will depend on the amount of storage available on the network device, the anticipated volume of logs, and how long the logs are kept on the device. Since the Syslog is the primary audit log, the local log is not essential to keep archived for lengthy periods, thus the allocated space on the device should be low.",
        "solution": "Enter the following commands in the [edit system syslog] hierarchy.\n\n[edit system syslog]\nset fileany any archive sizefile",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223198r513286_rule,STIG-ID|JUSX-DM-000056,STIG-Legacy|SV-80967,STIG-Legacy|V-66477,Vuln-ID|V-223198",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog file .+",
        "expect": "set system syslog file .+ any any archive size .+ file .+"
    },
    "custom_item_34": {
        "description": "JUSX-DM-000059 - The Juniper SRX Services Gateway must generate an immediate system alert message to the management console when a log processing failure is detected.",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process logs as required. Without an immediate alert for critical system issues, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.\n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages at information technology speed (i.e., the time from event detection to alert occurs in seconds or less). Automated alerts can be conveyed in a variety of ways, including, for example, telephonically, via electronic mail, via text message, or via websites.\n\nAlerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\nLog processing failures include software/hardware errors, failures in the log capturing mechanisms, and log storage capacity being reached or exceeded.\n\nWhile this requirement also applies to the configuration of the event monitoring system (e.g., Syslog, Security Information and Event Management [SIEM], or SNMP servers), the Juniper SRX can also be configured to generate a message to the administrator console or send via email for immediate messages.\n\nSyslog and SNMP trap events with a facility of 'daemon' pertaining to errors encountered by system processes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following commands configure syslog to immediately display any emergency level or daemon alert events to the management console. The message will display on any currently logged on administrator's console. This is an example method. Alerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\n[edit]\nset system syslog user * any emergency\nset system syslog user * daemon alert\nset system syslog user * daemon critical",
        "reference": "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|II,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223199r513289_rule,STIG-ID|JUSX-DM-000059,STIG-Legacy|SV-80969,STIG-Legacy|V-66479,Vuln-ID|V-223199",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog .+ (emergency|alert|critical)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_35": {
        "description": "JUSX-DM-000060 - For local logging, the Juniper SRX Services Gateway must generate a message to the system management console when a log processing failure occurs.",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process logs as required. Without this alert, the security personnel may be unaware of an impending failure of the log capability and system operation may be adversely affected.\n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages at information technology speed (i.e., the time from event detection to alert occurs in seconds or less). Automated alerts can be conveyed in a variety of ways, including, for example, telephonically, via electronic mail, via text message, or via websites.\n\nLog processing failures include software/hardware errors, failures in the log capturing mechanisms, and log storage capacity being reached or exceeded.\n\nWhile this requirement also applies to the event monitoring system (e.g., Syslog, Security Information and Event Management [SIEM], or SNMP servers), the Juniper SRX must also be configured to generate a message to the administrator console.\n\nSyslog and SNMP trap events with a facility of 'daemon' pertain to errors encountered by system processes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following commands configure syslog to immediately display any emergency level or daemon alert events to the management console. The message will display on any currently logged on administrator's console.\n\n[edit]\nset system syslog user * any emergency\nset system syslog user * daemon alert\nset system syslog user * daemon critical",
        "reference": "800-171|3.1.1,800-171|3.4.2,800-53|AC-2(4),800-53|CM-6b.,800-53r5|AC-2(4),800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CCI|CCI-001685,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-229022r518244_rule,STIG-ID|JUSX-DM-000060,STIG-Legacy|SV-81063,STIG-Legacy|V-66573,SWIFT-CSCv1|2.3,TBA-FIISB|36.2.3,Vuln-ID|V-229022",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog .+ (emergency|alert|critical)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_36": {
        "description": "JUSX-DM-000061 - In the event that communications with the events server is lost, the Juniper SRX Services Gateway must continue to queue log records locally.",
        "info": "It is critical that when the network device is at risk of failing to process logs as required, it take action to mitigate the failure. Log processing failures include: software/hardware errors; failures in the log capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to log failure depend upon the nature of the failure mode.\n\nSince availability is an overriding concern given the role of the Juniper SRX in the enterprise, the system must not be configured to shut down in the event of a log processing failure. The system will be configured to log events to local files, which will provide a log backup. If communication with the Syslog server is lost or the server fails, the network device must continue to queue log records locally. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local log data with the collection server.\n\nA best practice is to add log-prefixes to the log file names to help in researching the events and filters to prevent log overload. Another best practice is to add a match condition to limit the recorded events to those containing the regular expression (REGEX). Thus, the Juniper SRX will inherently and continuously capture events to local files to guard against the loss of connectivity to the primary and secondary events server.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following example commands configure local backup files to capture DoD-defined auditable events.\n\n[edit]\nset system syslog file messages any info\nset system syslog file messages authorization none\nset system syslog file messages interactive-commands none\nset system syslog file messages daemon none\nset system syslog file User-Auth authorization any\nset system syslog file interactive-commands interactive-commands any\nset system syslog file processes daemon any\nset system syslog file account-actions change-log any any\nset file account-actions match system login user\nset system syslog console any any",
        "reference": "800-171|3.1.1,800-171|3.4.2,800-53|AC-2(4),800-53|CM-6b.,800-53r5|AC-2(4),800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-001686,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-229023r518247_rule,STIG-ID|JUSX-DM-000061,STIG-Legacy|SV-80971,STIG-Legacy|V-66481,SWIFT-CSCv1|2.3,TBA-FIISB|36.2.3,Vuln-ID|V-229023",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set (system syslog|file) .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_37": {
        "description": "JUSX-DM-000065 - The Juniper SRX Services Gateway must record time stamps for log records using Coordinated Universal Time (UTC).",
        "info": "If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis. UTC is normally used in DoD; however, Greenwich Mean Time (GMT) may be used if needed for mission requirements.",
        "solution": "The following command sets the time zone to UTC.\n\n[edit]\nset system time-zone UTC",
        "reference": "800-171|3.3.7,800-53|AU-8b.,800-53r5|AU-8b.,CAT|II,CCI|CCI-001890,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,NESA|T3.6.7,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-223201r513292_rule,STIG-ID|JUSX-DM-000065,STIG-Legacy|SV-80973,STIG-Legacy|V-66483,TBA-FIISB|37.4,Vuln-ID|V-223201",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system time-zone .+",
        "expect": "set system time-zone UTC"
    },
    "custom_item_38": {
        "description": "JUSX-DM-000077 - The Juniper SRX Services Gateway must implement logon roles to ensure only authorized roles are allowed to install software and updates.",
        "info": "Allowing anyone to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. This requirement applies to code changes and upgrades for all network devices.\n\nFor example audit admins and the account of last resort are not allowed to perform this task.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the Juniper SRX to allow only the ISSM user account (or administrators/roles appointed by the ISSM) to select which auditable events are to be audited. To ensure this is the case, each ISSM-appointed role on the AAA must be configured for least privilege using the following stanzas for each role.\n\n[edit]\nshow system login\n\nUse the delete command or retype the command to remove the permission 'Maintenance' or 'request system software add' from any class that is not authorized to upgrade software on the device. An explicitly Deny for the command 'request system software add' can also be used if some Maintenance commands are permitted.",
        "reference": "800-171|3.4.9,800-53|CM-11(2),800-53r5|CM-11(2),CAT|II,CCI|CCI-001812,CSF|DE.CM-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,QCSC-v1|8.2.1,Rule-ID|SV-223202r513295_rule,STIG-ID|JUSX-DM-000077,STIG-Legacy|SV-80975,STIG-Legacy|V-66485,SWIFT-CSCv1|5.1,Vuln-ID|V-223202",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login class .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_39": {
        "description": "Check for loopback interface",
        "regex": "set interfaces lo.+",
        "expect": "set interfaces lo.+"
    },
    "custom_item_40": {
        "description": "JUSX-DM-000084 - If the loopback interface is used, the Juniper SRX Services Gateway must protect the loopback interface with firewall filters for known attacks that may exploit this interface.",
        "info": "The loopback interface is a logical interface and has no physical port. Since the interface and addresses ranges are well-known, this port must be filtered to protect the Juniper SRX from attacks.",
        "solution": "If the loopback interface is used, configure firewall filters. The following is an example of configuring a loopback address with filters on the device. It shows the format of both IPv4 and IPv6 addresses being applied to the interface. The first two commands show firewall filters being applied to the interface.\n\n[edit]\nset f lo0 unit 0 family inet filter input protect_re\nset interfaces lo0 unit 0 family inet6 filter input protect_re-v6\nset interfaces lo0 unit 0 family inet address 1.1.1.250/32\nset interfaces lo0 unit 0 family inet6 address 2100::250/128",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-223203r513298_rule,STIG-ID|JUSX-DM-000084,STIG-Legacy|SV-80505,STIG-Legacy|V-66015,SWIFT-CSCv1|2.3,Vuln-ID|V-223203",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set interfaces lo.+",
        "expect": "set interfaces lo.+ family inet6? filter input .+"
    },
    "custom_item_41": {
        "description": "JUSX-DM-000087 - The Juniper SRX Services Gateway must have the number of rollbacks set to 5 or more.",
        "info": "Backup of the configuration files allows recovery in case of corruption, misconfiguration, or catastrophic failure. The maximum number of rollbacks for the SRX is 50 while the default is 5 which is recommended as a best practice. Increasing this backup configuration number will result in increased disk usage and increase the number of files to manage. Organizations should not set the value to zero.",
        "solution": "To configure number of backup configurations to be stored in the configuration partition enter the following command at the configuration hierarchy.\n\n[edit]\nset system max-configuration-rollbacks",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-223204r513301_rule,STIG-ID|JUSX-DM-000087,STIG-Legacy|SV-81085,STIG-Legacy|V-66595,SWIFT-CSCv1|2.3,Vuln-ID|V-223204",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system max-configuration-rollbacks .+",
        "expect": "set system max-configuration-rollbacks ([5-9]|[1-9][0-9]|100)\\s*$"
    },
    "custom_item_42": {
        "description": "Verify primary NTP Server os configured",
        "regex": "set system ntp server .+",
        "expect": "set system ntp server @PRIMARY_NTP_SERVER@ (key [12] )?prefer"
    },
    "custom_item_43": {
        "description": "Verify secondary NTP Server os configured",
        "regex": "set system ntp server .+",
        "expect": "set system ntp server @SECONDARY_NTP_SERVER@( key [12])?"
    },
    "custom_item_44": {
        "description": "JUSX-DM-000095 - The Juniper SRX Services Gateway must be configured to use an authentication server to centrally manage authentication and logon settings for remote and nonlocal access.",
        "info": "Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is a particularly important protection against the insider threat. Audit records for administrator accounts access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\nThe Juniper SRX supports three methods of user authentication: local password authentication, Remote Authentication Dial-In User Service (RADIUS), and Terminal Access Controller Access Control System Plus (TACACS+). RADIUS and TACACS+ are remote access methods used for management of the Juniper SRX. The local password method will be configured for use only for the account of last resort.\n\nTo completely set up AAA authentication, create a user template account (the default name is remote) and specify a system authentication server and an authentication order. See CCI-000213 for more details. The remote user template is not a logon account. Once the AAA server option is configured, any remote or nonlocal access attempts are redirected to the AAA server. Since individual user accounts are not defined on the SRX, the authentication server must be used to manage individual account settings.",
        "solution": "Configure the Juniper SRX to support the use of AAA services to centrally manage user authentication and logon settings. To completely set up AAA authentication, use a user template account (the default name is remote) and specify a system authentication server and an authentication order.\n\n[edit]\nset system tacplus-server addressport 1812 secretor\n\n[edit]\nset system radius-server addressport 1812 secretNote: DoD policy is that redundant AAA servers are required to mitigate the risk of a failure of the primary AAA device. Also see CCI-000213 for  further details.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-223206r539624_rule,STIG-ID|JUSX-DM-000095,STIG-Legacy|SV-80979,STIG-Legacy|V-66489,SWIFT-CSCv1|2.3,Vuln-ID|V-223206",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system (tacplus|radius)-server .+",
        "expect": "set system (tacplus|radius)-server @PRIMARY_RADIUS_SERVER@ .+"
    },
    "custom_item_45": {
        "description": "JUSX-DM-000096 - The Juniper SRX Services Gateway must be configured to use an authentication server to centrally apply authentication and logon settings for remote and nonlocal access for device management.",
        "info": "Centralized application (e.g., TACACS+, RADIUS) of authentication settings increases the security of remote and nonlocal access methods. This control is a particularly important protection against the insider threat. Audit records for administrator accounts access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\nThis requirement references identification and authentication and does not prevent the configuration of privileges using the remote template account (CCI-000213).",
        "solution": "Configure the Juniper SRX to support the use of AAA services to centrally apply user authentication and logon settings.\n\n[edit]\nset system tacplus-server addressport 1812 secretor\n\n[edit]\nset system radius-server addressport 1812 secret",
        "reference": "800-171|3.1.11,800-171|3.4.2,800-53|AC-12,800-53|CM-6b.,800-53r5|AC-12,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,ITSG-33|CM-6b.,NESA|T3.2.1,NIAv2|NS49,Rule-ID|SV-229024r518250_rule,STIG-ID|JUSX-DM-000096,STIG-Legacy|SV-80981,STIG-Legacy|V-66491,SWIFT-CSCv1|2.3,Vuln-ID|V-229024",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system (tacplus|radius)-server .+",
        "expect": "set system (tacplus|radius)-server @PRIMARY_RADIUS_SERVER@ .+"
    },
    "custom_item_46": {
        "description": "JUSX-DM-000097 - The Juniper SRX Services Gateway must be configured to use a centralized authentication server to authenticate privileged users for remote and nonlocal access for device management.",
        "info": "Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is a particularly important protection against the insider threat. Audit records for administrator accounts access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\nThe Juniper SRX supports three methods of user authentication: local password authentication, Remote Authentication Dial-In User Service (RADIUS), and Terminal Access Controller Access Control System Plus (TACACS+). RADIUS and TACACS+ are remote access methods used for management of the Juniper SRX. The local password method will be configured for use only for the account of last resort; however, it will not be used for remote and nonlocal access or this will result in a CAT 1 finding (CCI-000765).\n\nThis requirement references identification and authentication and does not prevent the configuration of privileges using the remote template account (CCI-000213).",
        "solution": "Configure the Juniper SRX to forward logon requests to a RADIUS or TACACS+. Remove local users configured on the device (CCI-000213) so the AAA server cannot default to using a local account.\n\n[edit]\nset system tacplus-server addressport 1812 secretor\n\n[edit]\nset system radius-server addressport 1812 secretNote: DoD policy is that redundant AAA servers are required to mitigate the risk of a failure of the primary AAA device.",
        "reference": "800-171|3.1.1,800-171|3.4.2,800-53|AC-2(4),800-53|CM-6b.,800-53r5|AC-2(4),800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CCI|CCI-002132,CN-L3|7.1.3.2(d),CN-L3|8.1.10.6(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-229025r518253_rule,STIG-ID|JUSX-DM-000097,STIG-Legacy|SV-80939,STIG-Legacy|V-66449,SWIFT-CSCv1|2.3,TBA-FIISB|36.2.3,Vuln-ID|V-229025",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system (tacplus|radius)-server .+",
        "expect": "set system (tacplus|radius)-server @PRIMARY_RADIUS_SERVER@ .+"
    },
    "custom_item_47": {
        "description": "Verify the authentication order is configured to use the authentication servers",
        "regex": "set system authentication-order .+",
        "expect": "set system authentication-order (radius|tacplus)"
    },
    "custom_item_48": {
        "description": "Verify the authentication order is not configured to use password",
        "regex": "set system authentication-order .+",
        "not_expect": "set system authentication-order password"
    },
    "custom_item_49": {
        "description": "JUSX-DM-000099 - The Juniper SRX Services Gateway must detect the addition of components and issue a priority 1 alert to the ISSM and SA, at a minimum.",
        "info": "The network device must automatically detect the installation of unauthorized software or hardware onto the device itself. Monitoring may be accomplished on an ongoing basis or by periodic monitoring. Automated mechanisms can be implemented within the network device and/or in another separate information system or device. If the addition of unauthorized components or devices is not automatically detected, then such components or devices could be used for malicious purposes, such as transferring sensitive data to removable media for compromise.\n\nAlerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update the SNMP configuration with the following device trap settings. This is an example method. Alerts must be sent immediately to the designated individuals (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system).\n\nset snmp v3 notify-filter device-traps oid jnxChassisTraps include\nset snmp v3 notify-filter device-traps oid jnxChassisOKTraps include\nset snmp v3 notify-filter device-traps oid system include\nset snmp v3 notify-filter device-traps oid .1 include\nset snmp v3 notify-filter device-traps oid",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|III,CCI|CCI-000366,CCI|CCI-000372,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-229027r518259_rule,STIG-ID|JUSX-DM-000099,STIG-Legacy|SV-81089,STIG-Legacy|V-66599,SWIFT-CSCv1|2.3,Vuln-ID|V-229027",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set snmp v3 notify-filter .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_50": {
        "description": "JUSX-DM-000105 - The Juniper SRX Services Gateway must use DoD-approved PKI rather than proprietary or self-signed device certificates.",
        "info": "To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs.\n\nThe SRX generates a key-pair and a CSR. The CSR is sent to the approved CA, who signs it and returns it as a certificate. That certificate is then installed.\n\nThe process to obtain a device PKI certificate requires the generation of a Certificate Signing Request (CSR), submission of the CSR to a CA, approval of the request by an RA, and retrieval of the issued certificate from the CA.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Generate a new key-pair from a DoD-approved certificate issuer. Sites must consult the PKI/PKI pages on the http://iase.disa.mil/ website for procedures for NIPRNet and SIPRNet.\n\nRSA:\nrequest security pki generate-key-pair certificate-idtype rsa size <512 | 1024 | 2048 | 4096>\n\nECDSA:\nrequest security pki generate-key-pair certificate-idtype ecdsa size <256 | 384>\n\nGenerate a CSR from RSA key-pair using the following command and options.\n\nrequest security generate-certificate-request certificate-iddigestdomainemailip-addresssubject 'CN=,DC=,DC=,O=,OU=,\nL=,ST=,C=' filenameGenerate a CSR from ECDSA key-pair use the following command and options.\n\nrequest security generate-certificate-request certificate-iddigestdomainemailip-addresssubject 'CN=,DC=,DC=,O=,OU=,\nL=,ST=,C=' filenameIf no filename is specified, the CSR is displayed on the standard out (terminal)\n\nAfter receiving the approved certificate from the CA, enter the following command and options to upload the certificate.\n\nrequest security pki local-certificate certificate-idfilenameFrom the operational mode of the hierarchy:\n\nset security certificates local new load-key-file /var/tmp/new.pem\n\nType the following command to load the X.509 certificate into the certificate store in operations mode.\n\n>request security pki local-certificate load certificate-idfilenameFor this example, assume the transferred the X.509 certificate called 'device-cert.crt' to the /var/tmp directory on the SRXD. The following command will load the device-cert.crt certificate file and associate it with the public/private keypair named 'device-keypair' generated in a previous step.\n\n>request security pki local-certificate load certificate-id device-keypair filename /var/tmp/device-cert.crt",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53|SC-17,800-53r5|CM-6b.,800-53r5|SC-17,CAT|II,CCI|CCI-000366,CCI|CCI-001159,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|SC-17,ITSG-33|SC-17a.,NESA|T3.2.1,NESA|T7.4.2,NIAv2|CY5a,NIAv2|CY10,NIAv2|CY12,NIAv2|SS25,Rule-ID|SV-223207r513310_rule,STIG-ID|JUSX-DM-000105,STIG-Legacy|SV-80983,STIG-Legacy|V-66493,SWIFT-CSCv1|2.3,Vuln-ID|V-223207",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show security pki local-certificate",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_51": {
        "description": "JUSX-DM-000106 - The Juniper SRX Services Gateway must generate an alarm or send an alert message to the management console when a component failure is detected.",
        "info": "Component (e.g., chassis, file storage, file corruption) failure may cause the system to become unavailable, which could result in mission failure since the network would be operating without a critical security traffic inspection or access function.\n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages at information technology speed (i.e., the time from event detection to alert occurs in seconds or less). Automated alerts can be conveyed in a variety of ways, including, for example, telephonically, via electronic mail, via text message, or via websites.\n\nWhile this requirement also applies to the event monitoring system (e.g., Syslog, Security Information and Event Management [SIEM], or SNMP servers), the Juniper SRX must also be configured to generate a message to the administrator console.\n\nSyslog and SNMP trap events with a facility of 'daemon' pertain to errors encountered by system processes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following commands configure syslog to immediately display any emergency level or daemon alert events to the management console. The message will display on any currently logged on administrator's console.\n\n[edit]\nset system syslog user * any emergency\nset system syslog user * daemon critical\nset system syslog user * daemon alert",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53|CM-6(1),800-53r5|CM-6b.,800-53r5|CM-6(1),CAT|II,CCI|CCI-000366,CCI|CCI-000372,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-6(1),NESA|T3.2.1,NIAv2|NS5f,Rule-ID|SV-229028r518262_rule,STIG-ID|JUSX-DM-000106,STIG-Legacy|SV-80985,STIG-Legacy|V-66495,SWIFT-CSCv1|2.3,Vuln-ID|V-229028",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog .+ (emergency|alert|critical)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_52": {
        "description": "JUSX-DM-000108 - The Juniper SRX Services Gateway must be configured to prohibit the use of unnecessary and/or nonsecure functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.",
        "info": "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nThe control plane is responsible for operating most of the system services on the SRX. The control plane is responsible not only for acting as the interface for the administrator operating the device, but also for controlling the operation of the chassis, pushing the configuration to the data plane, and operating the daemons that provide functionality to the system. The control plane operates the Junos OS, which is a FreeBSD variant.\n\nThe Juniper SRX control plane services include, but are not limited to, the following: Management Daemon (MGD), Routing Protocol Daemon (RPD) (e.g., RIP, OSPF, IS-IS, BGP, PIM, IPv6 counterparts), User interfaces (SSH, J-Web, NetConf), File system interfaces (SCP), Syslogd (DNS, DHCP, NTP, ICMP, ARP/ND, SNMP), Chassisd, JSRPD (HA clustering).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Ensure functions, ports, protocols, and services identified on the PPSM CAL are not used for system services configuration.\n\n[edit]\nshow system services\n\nCompare the services that are enabled, including the port, services, protocols, and functions.\n\nConsult the Juniper knowledge base and configuration guides to determine the commands for disabling each port, protocol, service, or function that is not in compliance with the PPSM CAL and vulnerability assessments.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223208r513313_rule,STIG-ID|JUSX-DM-000108,STIG-Legacy|SV-80987,STIG-Legacy|V-66497,SWIFT-CSCv1|2.3,Vuln-ID|V-223208",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_53": {
        "description": "telnet service is disabled",
        "regex": "set system services .+",
        "not_expect": "set system services telnet"
    },
    "custom_item_54": {
        "description": "ftp service is disabled",
        "regex": "set system services .+",
        "not_expect": "set system services ftp"
    },
    "custom_item_55": {
        "description": "snmp v1 is disabled",
        "regex": "snmp .+",
        "not_expect": "snmp v1"
    },
    "custom_item_56": {
        "description": "snmp v2c is disabled",
        "regex": "snmp .+",
        "not_expect": "snmp v2c"
    },
    "custom_item_57": {
        "description": "snmp v2c is disabled",
        "regex": "set system services ssh .+",
        "not_expect": "set system services ssh protocol-version v1"
    },
    "custom_item_58": {
        "description": "Verify authentication-key is set correctly",
        "regex": "set system ntp authentication-key .+",
        "expect": "set system ntp authentication-key [0-9]+ type (md5|sha1|sha256)",
        "min_occurrences": "2"
    },
    "custom_item_59": {
        "description": "Verify the trusted key is set correctly",
        "regex": "set system ntp trusted-key .+",
        "expect": "set system ntp trusted-key [0-9]+",
        "min_occurrences": "2"
    },
    "custom_item_60": {
        "description": "snmp stanza exists",
        "regex": "set snmp .+",
        "expect": "set snmp .+"
    },
    "custom_item_61": {
        "description": "JUSX-DM-000111 - If SNMP is enabled, the Juniper SRX Services Gateway must use and securely configure SNMPv3.",
        "info": "To prevent non-secure protocol communications with the organization's local SNMPv3 services, the SNMP client on the Juniper SRX must be configured for proper identification and strong cryptographically-based protocol for authentication.\n\nSNMPv3 defines a user-based security model (USM), and a view-based access control model (VACM). SNMPv3 USM provides data integrity, data origin authentication, message replay protection, and protection against disclosure of the message payload. SNMPv3 VACM provides access control to determine whether a specific type of access (read or write) to the management information is allowed.\n\nThe Junos operating system allows the use of SNMPv3 to monitor or query the device for management purposes. Junos does not allow SNMPv3, of any type, to be used to make configuration changes to the device. SNMPv3 is disabled by default and must be enabled for use. SNMPv3 is the DoD-preferred method for monitoring the device securely. If SNMPv3 is not being used, it must be disabled. The following commands will configure SNMPv3. The Junos operating system allows the use of FIPS approved protocols for both authentication (SHA1) and for privacy (AES128). These protocols should be used to ensure secure management connections.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Enable and configure SNMPv3 and configure a trap and community string.\n\n[edit]\nset snmp locationset snmp v3 usm local-engine userprivacy-AES128\nset snmp v3 vacm security-to-group security-model usm security-namegroupset snmp v3 vacm access groupdefault-context-prefix security-model usm\nsecurity-level privacy read-view all\nset snmp v3 vacm access groupdefault-context-prefix security-model usm\nsecurity-level privacy notify-view all\nset snmp v3 target-addresstag-listset snmp v3 target-addresstarget-parametersset snmp v3 target-parametersparameters message-processing-model v3\nset snmp v3 target-parametersparameters security-model usm\nset snmp v3 target-parametersparameters security-level privacy\nset snmp v3 target-parametersparameters security-nameset snmp v3 target-parametersnotify-filter device-traps\nset snmp v3 notifytype trap\nset snmp v3 notifytagset snmp v3 notify-filter device-traps oid jnxChassisTraps include\nset snmp v3 notify-filter device-traps oid jnxChassisOKTraps include\nset snmp v3 notify-filter device-traps oid system include\nset snmp v3 notify-filter device-traps oid .1 include\nset snmp v3 notify-filter device-traps oid snmpMIBObjects include\nset snmp engine-id use-mac-address\nset snmp view all oid .1 include\nset snmp view all oid system include\nset snmp view all oid jnxBoxAnatomy include\nset snmp view all oid snmpMIBObjects include",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|I,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223211r513322_rule,STIG-ID|JUSX-DM-000111,STIG-Legacy|SV-80941,STIG-Legacy|V-66451,SWIFT-CSCv1|2.3,Vuln-ID|V-223211",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set snmp .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_62": {
        "description": "JUSX-DM-000112 - The Juniper SRX Services Gateway must ensure SSH is disabled for root user logon to prevent remote access using the root account.",
        "info": "Since the identity of the root account is well-known for systems based upon Linux or UNIX and this account does not have a setting to limit access attempts, there is risk of a brute force attack on the password. Root access would give superuser access to an attacker. Preventing attackers from remotely accessing management functions using root account mitigates the risk that unauthorized individuals or processes may gain superuser access to information or privileges.\n\nA separate account should be used for access and then the administrator can sudo to root when necessary.",
        "solution": "From the configuration mode, enter the following commands to disable root-login using SSH.\n\n[edit]\nset system services ssh root-login deny",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223212r513325_rule,STIG-ID|JUSX-DM-000112,STIG-Legacy|SV-80993,STIG-Legacy|V-66503,SWIFT-CSCv1|2.3,Vuln-ID|V-223212",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh root-login deny"
    },
    "custom_item_63": {
        "description": "JUSX-DM-000113 - The Juniper SRX Services Gateway must ensure access to start a UNIX-level shell is restricted to only the root account.",
        "info": "Restricting the privilege to create a UNIX-level shell limits access to this powerful function. System administrators, regardless of their other permissions, will need to also know the root password for this access, thus limiting the possibility of malicious or accidental circumvention of security controls.",
        "solution": "For each login class, add the following command to the stanza.\n\n[edit]\nset system login classdeny-commands '(start shell)'",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223213r513328_rule,STIG-ID|JUSX-DM-000113,STIG-Legacy|SV-80997,STIG-Legacy|V-66507,SWIFT-CSCv1|2.3,Vuln-ID|V-223213",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login class .+",
        "expect": "set system login class .+ deny-commands.+start shell"
    },
    "custom_item_64": {
        "description": "JUSX-DM-000114 - The Juniper SRX Services Gateway must ensure TCP forwarding is disabled for SSH to prevent unauthorized access.",
        "info": "Use this configuration option to prevent a user from creating an SSH tunnel over a CLI session to the Juniper SRX via SSH. This type of tunnel could be used to forward TCP traffic, bypassing any firewall filters or ACLs, allowing unauthorized access.",
        "solution": "From the configuration mode, enter the following commands to disable TCP forwarding for the SSH protocol.\n\n[edit]\nset system services ssh no-tcp-forwarding",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223214r513331_rule,STIG-ID|JUSX-DM-000114,STIG-Legacy|SV-80999,STIG-Legacy|V-66509,SWIFT-CSCv1|2.3,Vuln-ID|V-223214",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh no-tcp-forwarding"
    },
    "custom_item_65": {
        "description": "JUSX-DM-000115 - The Juniper SRX Services Gateway must be configured with only one local user account to be used as the account of last resort.",
        "info": "Without centralized management, credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible.\n\nLocal accounts are configured using the local password authentication method which does not meet the multifactor authentication criteria. The account of last resort is a group authenticator which does not provide nonrepudiation, thus must be used only rare cases where the device must be accessed using the local console and an individual authenticator is not possible, including when network access is not available.",
        "solution": "If more than one account has an authentication stanza, and it is not documented, delete the authentication stanza (if the account is a template account) or the entire account (if the account is unauthorized or no longer needed).\n\nTo delete a template account:\n\n[edit]\ndelete system login userauthentication\ncommit\n\nTo delete an unneeded or unauthorized account:\n\n[edit]\ndelete system login user",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223215r513334_rule,STIG-ID|JUSX-DM-000115,STIG-Legacy|SV-81001,STIG-Legacy|V-66511,SWIFT-CSCv1|2.3,Vuln-ID|V-223215",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login user .+ authentication .+",
        "expect": "set system login user .+ authentication .+",
        "max_occurrences": "1"
    },
    "custom_item_66": {
        "description": "ssh macs hmac-sha2-512",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha2-512"
    },
    "custom_item_67": {
        "description": "ssh macs hmac-sha2-256",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha2-256"
    },
    "custom_item_68": {
        "description": "ssh macs hmac-sha2-512",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha1"
    },
    "custom_item_69": {
        "description": "ssh macs hmac-sha2-256",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha1-96"
    },
    "custom_item_70": {
        "description": "JUSX-DM-000128 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce a minimum 15-character password length.",
        "info": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.\n\nCompliance with this requirement also prevents the system from being configured with default or no passwords.",
        "solution": "Set the global password option for all accounts created on the Juniper SRX.\n\n[edit]\nset system login password minimum-length 15\n\nNote: This setting only enforces the minimum character password length for newly created passwords. The password of the existing account must be changed if it is not already complaint.\n\nTo set or change the root user password, in configuration mode enter the following command.\n\n[edit]\nset system root-authentication plain-text-password\n\nWhen prompted, enter the password for the root user.\nRetype new password to confirm\n\nTo set or change the account of last resort, in configuration mode enter the following command.\n\n[edit]\nset system login userplain-text-password\n\nWhen prompted, enter the password for the root user.\nRetype new password to confirm",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223217r513340_rule,STIG-ID|JUSX-DM-000128,STIG-Legacy|SV-81005,STIG-Legacy|V-66515,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223217",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-length (1[5-9]|[2-9][0-9])$"
    },
    "custom_item_71": {
        "description": "JUSX-DM-000129 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce password complexity by setting the password change type to character sets.",
        "info": "Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nThe password change-type command specifies whether a minimum number of character-sets or a minimum number of character-set transitions are enforced. The DoD requires this setting be set to character-sets.",
        "solution": "Configure the default local password to enforce password complexity by setting the password change type to character sets\n\n[edit]\nset system login password change-type character-sets",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223218r513343_rule,STIG-ID|JUSX-DM-000129,STIG-Legacy|SV-81007,STIG-Legacy|V-66517,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223218",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password change-type character-sets"
    },
    "custom_item_72": {
        "description": "JUSX-DM-000130 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce password complexity by requiring at least one upper-case character be used.",
        "info": "Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.",
        "solution": "Configure the default local password to enforce password complexity by requiring at least one upper-case character be used.\n\n[edit]\nset system login password minimum-upper-cases 1",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223219r513346_rule,STIG-ID|JUSX-DM-000130,STIG-Legacy|SV-81009,STIG-Legacy|V-66519,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223219",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-upper-cases [1-9][0-9]*"
    },
    "custom_item_73": {
        "description": "JUSX-DM-000131 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce password complexity by requiring at least one lower-case character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.",
        "solution": "Configure the default local password to enforce password complexity by requiring at least one lower-case character be used.\n\n[edit]\nset system login password minimum-lower-cases 1",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223220r513349_rule,STIG-ID|JUSX-DM-000131,STIG-Legacy|SV-81011,STIG-Legacy|V-66521,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223220",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-lower-cases [1-9][0-9]*"
    },
    "custom_item_74": {
        "description": "JUSX-DM-000132 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce password complexity by requiring at least one numeric character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.",
        "solution": "Configure the default local password to enforce password complexity by requiring at least one numeric character be used.\n\n[edit]\nset system login password minimum -numerics to 1",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223221r513352_rule,STIG-ID|JUSX-DM-000132,STIG-Legacy|SV-81013,STIG-Legacy|V-66523,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-numerics [1-9][0-9]*"
    },
    "custom_item_75": {
        "description": "JUSX-DM-000133 - For local accounts using password authentication (i.e., the root account and the account of last resort), the Juniper SRX Services Gateway must enforce password complexity by requiring at least one special character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.",
        "solution": "Configure the default local password to enforce password complexity by requiring at least one special character be used.\n\n[edit]\nset system login password minimum-punctuations 1",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223222r513355_rule,STIG-ID|JUSX-DM-000133,STIG-Legacy|SV-81015,STIG-Legacy|V-66525,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-223222",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password minimum-punctuations [1-9][0-9]*"
    },
    "custom_item_76": {
        "description": "JUSX-DM-000136 - For local accounts using password authentication (i.e., the root account and the account of last resort) the Juniper SRX Services Gateway must use the SHA1 or later protocol for password authentication.",
        "info": "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\nThe password format command is an optional command that specifies the hash algorithm used for authenticating passwords. The options are MD5, SHA1, or DES. SHA1 is recommended because it is a FIPS-approved algorithm and provides stronger security.",
        "solution": "Enter the configuration mode on the Juniper SRX, set the password option for the local user account of last resort using the following command.\n\n[edit]\nset system login password format sha1",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|II,CCI|CCI-000197,CSF|PR.AC-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-223223r513358_rule,STIG-ID|JUSX-DM-000136,STIG-Legacy|SV-81017,STIG-Legacy|V-66527,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-223223",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login password .+",
        "expect": "set system login password format (sha1|sha-256|sha-512)"
    },
    "custom_item_77": {
        "description": "JUSX-DM-000146 - For nonlocal maintenance sessions using SNMP, the Juniper SRX Services Gateway must use and securely configure SNMPv3 with SHA to protect the integrity of maintenance and diagnostic communications.",
        "info": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.\n\nThe Juniper SRX allows the use of SNMP to monitor or query the device in support of diagnostics information. SNMP cannot be used to make configuration changes; however, it is a valuable diagnostic tool. SNMP is disabled by default and must be enabled for use. SNMPv3 is the DoD-required version, but must be configured to be used securely.",
        "solution": "Configure snmp to use version 3 with SHA authentication.\n\n[edit]\nset snmp v3 usm local-engine userauthentication-sha",
        "reference": "800-171|3.7.5,800-53|MA-4(6),800-53r5|MA-4(6),CAT|I,CCI|CCI-002890,CSF|PR.MA-2,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-223224r513361_rule,STIG-ID|JUSX-DM-000146,STIG-Legacy|SV-80943,STIG-Legacy|V-66453,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-223224",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set snmp v3 usm local-engine user .+",
        "expect": "set snmp v3 usm local-engine user .+ authentication-sha"
    },
    "custom_item_78": {
        "description": "ssh macs hmac-sha2-512",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha2-512"
    },
    "custom_item_79": {
        "description": "ssh macs hmac-sha2-256",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha2-256"
    },
    "custom_item_80": {
        "description": "ssh macs hmac-sha2-512",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha1"
    },
    "custom_item_81": {
        "description": "ssh macs hmac-sha2-256",
        "regex": "set system services ssh macs .+",
        "expect": "set system services ssh macs hmac-sha1-96"
    },
    "custom_item_82": {
        "description": "system services ssh protocol-version",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh protocol-version v2"
    },
    "custom_item_83": {
        "description": "snmp stanza exists",
        "regex": "set snmp .+",
        "expect": "set snmp .+"
    },
    "custom_item_84": {
        "description": "JUSX-DM-000149 - For nonlocal maintenance sessions using SNMP, the Juniper SRX Services Gateway must securely configure SNMPv3 with privacy options to protect the confidentiality of maintenance and diagnostic communications for nonlocal maintenance sessions.",
        "info": "Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.\n\nTo protect the confidentiality of nonlocal maintenance sessions, SNMPv3 with AES encryption to must be configured to provide confidentiality. The Juniper SRX allows the use of SNMPv3 to monitor or query the device in support of diagnostics information. SNMP cannot be used to make configuration changes; however, it is a valuable diagnostic tool. SNMP is disabled by default and must be enabled for use. SNMPv3 is the DoD-required version, but must be configured to be used securely.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure SNMP to use version 3 with privacy options. The following is an example.\n\n[edit]\nset snmp locationset snmp v3 usm local-engine userprivacy-AES128\nset snmp v3 vacm security-to-group security-model usm security-namegroupset snmp v3 vacm access groupdefault-context-prefix security-model usm\nsecurity-level privacy read-view all\nset snmp v3 vacm access groupdefault-context-prefix security-model usm\nsecurity-level privacy notify-view all",
        "reference": "800-171|3.7.5,800-53|MA-4(6),800-53r5|MA-4(6),CAT|I,CCI|CCI-003123,CSF|PR.MA-2,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-223226r513367_rule,STIG-ID|JUSX-DM-000149,STIG-Legacy|SV-80945,STIG-Legacy|V-66455,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-223226",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set snmp .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_85": {
        "description": "ssh ciphers aes256-ctr",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes256-ctr"
    },
    "custom_item_86": {
        "description": "ssh ciphers aes192-ctr",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes192-ctr"
    },
    "custom_item_87": {
        "description": "ssh ciphers aes128-ctr",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes128-ctr"
    },
    "custom_item_88": {
        "description": "ssh ciphers aes256-cbc",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes256-cbc"
    },
    "custom_item_89": {
        "description": "ssh ciphers aes192-cbc",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes192-cbc"
    },
    "custom_item_90": {
        "description": "ssh ciphers aes128-cbc",
        "regex": "set system services ssh ciphers .+",
        "expect": "set system services ssh ciphers aes128-cbc"
    },
    "custom_item_91": {
        "description": "ssh key-exchange ecdh-sha2-nistp521",
        "regex": "set system services ssh key-exchange .+",
        "expect": "set system services ssh key-exchange ecdh-sha2-nistp521"
    },
    "custom_item_92": {
        "description": "ssh key-exchange ecdh-sha2-nistp384",
        "regex": "set system services ssh key-exchange .+",
        "expect": "set system services ssh key-exchange ecdh-sha2-nistp384"
    },
    "custom_item_93": {
        "description": "ssh key-exchange ecdh-sha2-nistp256",
        "regex": "set system services ssh key-exchange .+",
        "expect": "set system services ssh key-exchange ecdh-sha2-nistp256"
    },
    "custom_item_94": {
        "description": "ssh key-exchange dh-group14-sha1",
        "regex": "set system services ssh key-exchange .+",
        "expect": "set system services ssh key-exchange dh-group14-sha1"
    },
    "custom_item_95": {
        "description": "ssh key-exchange group-exchange-sha2",
        "regex": "set system services ssh key-exchange .+",
        "expect": "set system services ssh key-exchange group-exchange-sha2"
    },
    "custom_item_96": {
        "description": "ssh protocol-version",
        "regex": "set system services ssh .+",
        "expect": "set system services ssh protocol-version v2"
    },
    "custom_item_97": {
        "description": "JUSX-DM-000152 - For nonlocal maintenance sessions, the Juniper SRX Services Gateway must ensure only zones where management functionality is desired have host-inbound-traffic system-services configured.",
        "info": "Add a firewall filter to protect the management interface. Note: The dedicated management interface (if present), and an interface placed in the functional zone management, will not participate in routing network traffic. It will only support device management traffic.\n\nThe host-inbound-traffic feature of the SRX is an additional layer of security for system services. This function can be configured on either a per zone or a per interface basis within each individual security zone. By default, a security zone has all system services disabled, which means that it will not accept any inbound management or protocol requests on the control plane without explicitly enabling the service at either the interface or zone in the security zone stanzas.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove host-inbound-traffic systems-services option from zones not authorized for management traffic.\n\nRemove unauthorized protocols (e.g., HTTP, HTTPS) from management zones that are configured to allow host-inbound-traffic system-services.",
        "reference": "800-171|3.7.5,800-53|MA-4(6),800-53r5|MA-4(6),CAT|II,CCI|CCI-003123,CSF|PR.MA-2,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-223228r513373_rule,STIG-ID|JUSX-DM-000152,STIG-Legacy|SV-81023,STIG-Legacy|V-66533,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-223228",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show security zones functional-zone management",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_98": {
        "description": "ssh client-alive-count-max",
        "regex": "set system services ssh client-alive-count-max .+",
        "expect": "set system services ssh client-alive-count-max [0-9]+"
    },
    "custom_item_99": {
        "description": "ssh client-alive-interval",
        "regex": "set system services ssh client-alive-interval .+",
        "expect": "set system services ssh client-alive-interval [0-9]+"
    },
    "custom_item_100": {
        "description": "JUSX-DM-000154 - The Juniper SRX Services Gateway must terminate the console session when the serial cable connected to the console port is unplugged.",
        "info": "If a device management session or connection remains open after management is completed, it may be hijacked by an attacker and used to compromise or damage the network device.",
        "solution": "Configure this setting by entering the following commands in configuration mode.\n\n[edit]\nsystem ports console set log-out-on-disconnect",
        "reference": "800-171|3.7.5,800-53|MA-4e.,800-53r5|MA-4e.,CAT|III,CCI|CCI-000879,CSF|PR.MA-2,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-223230r513379_rule,STIG-ID|JUSX-DM-000154,STIG-Legacy|SV-81091,STIG-Legacy|V-66601,TBA-FIISB|45.2.3,Vuln-ID|V-223230",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system ports console .+",
        "expect": "set system ports console log-out-on-disconnect"
    },
    "custom_item_101": {
        "description": "JUSX-DM-000156 - The Juniper SRX Services Gateway must terminate a device management session after 10 minutes of inactivity, except to fulfill documented and validated mission requirements.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session. Quickly terminating an idle session also frees up resources.\n\nThis requirement does not mean that the device terminates all sessions or network access; it only ends the inactive session.\n\nUser accounts, including the account of last resort must be assigned to a login class. Configure all login classes with an idle timeout value. Pre-defined classes do not support configurations, therefore should not be used for DoD implementations. The root account cannot be assigned to a login-class which is why it is critical that this account be secured in accordance with DoD policy.",
        "solution": "Configure all login classes with an idle timeout value.\n\n[edit]\nset system login-classidle-timeout 10\n\nAll users must be set to a login-class; however, to ensure that the CLI is set to a default timeout value, enter the following in operational mode:\n\nset cli idle-timeout 10",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-223231r539622_rule,STIG-ID|JUSX-DM-000156,STIG-Legacy|SV-81027,STIG-Legacy|V-66537,SWIFT-CSCv1|2.6,Vuln-ID|V-223231",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login[ -]class .+ idle-timeout",
        "expect": "set system login[ -]class .+ idle-timeout 10\\s*$"
    },
    "custom_item_102": {
        "description": "ssh client-alive-count-max",
        "regex": "set system services ssh client-alive-count-max .+",
        "expect": "set system services ssh client-alive-count-max [0-9]+"
    },
    "custom_item_103": {
        "description": "ssh client-alive-interval",
        "regex": "set system services ssh client-alive-interval .+",
        "expect": "set system services ssh client-alive-interval [0-9]+"
    },
    "custom_item_104": {
        "description": "system no-redirects",
        "regex": "set system no-redirects",
        "expect": "set system no-redirects"
    },
    "custom_item_105": {
        "description": "system no-ping-record-route",
        "regex": "set system no-ping-record-route",
        "expect": "set system no-ping-record-route"
    },
    "custom_item_106": {
        "description": "system no-ping-time-stamp",
        "regex": "set system no-ping-time-stamp",
        "expect": "set system no-ping-time-stamp"
    },
    "custom_item_107": {
        "description": "icmpv4-rate-limit packet-rate",
        "regex": "set system internet-options icmpv4-rate-limit packet-rate [0-9]+",
        "expect": "set system internet-options icmpv4-rate-limit packet-rate [0-9]+"
    },
    "custom_item_108": {
        "description": "icmpv6-rate-limit packet-rate 50",
        "regex": "set system internet-options icmpv6-rate-limit packet-rate [0-9]+",
        "expect": "set system internet-options icmpv6-rate-limit packet-rate [0-9]+"
    },
    "custom_item_109": {
        "description": "no-ipip-path-mtu-discovery",
        "regex": "set system internet-options no-ipip-path-mtu-discovery",
        "expect": "set system internet-options no-ipip-path-mtu-discovery"
    },
    "custom_item_110": {
        "description": "no-source-quench",
        "regex": "set system internet-options no-source-quench",
        "expect": "set system internet-options no-source-quench"
    },
    "custom_item_111": {
        "description": "tcp-drop-synfin-set",
        "regex": "set system internet-options tcp-drop-synfin-set",
        "expect": "set system internet-options tcp-drop-synfin-set"
    },
    "custom_item_112": {
        "description": "no-ipv6-path-mtu-discovery",
        "regex": "set system internet-options no-ipv6-path-mtu-discovery",
        "expect": "set system internet-options no-ipv6-path-mtu-discovery"
    },
    "custom_item_113": {
        "description": "no-tcp-reset drop-all-tcp",
        "regex": "set system internet-options no-tcp-reset drop-all-tcp",
        "expect": "set system internet-options no-tcp-reset drop-all-tcp"
    },
    "custom_item_114": {
        "description": "JUSX-DM-000163 - The Juniper SRX Services Gateway must limit the number of sessions per minute to an organization-defined number for SSH to protect remote access management from unauthorized access.",
        "info": "The rate-limit command limits the number of SSH session attempts allowed per minute which helps limit an attacker's ability to perform DoS attacks. The rate limit should be as restrictive as operationally practical.\n\nJuniper Networks recommends a best practice of 4 for the rate limit, however the limit should be as restrictive as operationally practical.\n\nUser connections that exceed the rate-limit will be closed immediately after the connection is initiated. They will not be in a waiting state.",
        "solution": "Configure the SSH protocol with a rate limit.\n\n[edit]\nset system services ssh rate-limit 4\n\nNote: Juniper Networks recommends a best practice of 4 for the rate limit; however, the limit should be as restrictive as operationally practical.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-223234r513391_rule,STIG-ID|JUSX-DM-000163,STIG-Legacy|SV-81033,STIG-Legacy|V-66543,Vuln-ID|V-223234",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services ssh rate-limit",
        "expect": "set system services ssh rate-limit @SSH_RATE_LIMIT@\\s*$"
    },
    "custom_item_115": {
        "description": "JUSX-DM-000164 - The Juniper SRX Services Gateway must implement service redundancy to protect against or limit the effects of common types of Denial of Service (DoS) attacks on the device itself.",
        "info": "Service redundancy, may reduce the susceptibility to some DoS attacks.\n\nOrganizations must consider the need for service redundancy in accordance with DoD policy. If service redundancy is required then this technical control is applicable.\n\nThe Juniper SRX can configure your system to monitor the health of the interfaces belonging to a redundancy group.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Interfaces can be monitored by a redundancy group for automatic failover to another node. Assign a weight to the interface to be monitored.\n\nThis configuration is an extremely complex configuration. Consult the vendor documentation.\n\nSet the chassis cluster node ID and cluster ID.\nConfigure the chassis cluster management interface.\nConfigure the chassis cluster fabric.\nConfigure the chassis cluster redundancy group\nSpecify the interface to be monitored by a redundancy group.\n\nSpecify the interface to be monitored by a redundancy group. Example:\n[edit]\nset chassis cluster redundancy-group 1 interface-monitor ge-6/0/2 weight 255",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|III,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-223235r513394_rule,STIG-ID|JUSX-DM-000164,STIG-Legacy|SV-81093,STIG-Legacy|V-66603,Vuln-ID|V-223235",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show chassis cluster interfaces",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_116": {
        "description": "JUSX-DM-000165 - The Juniper SRX Services Gateway must reveal log messages or management console alerts only to the ISSO, ISSM, and SA roles).",
        "info": "Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state. Additionally, sensitive account information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nAlthough, based on policy, administrator accounts must be created on the AAA server, thus this requirement addresses the creation of unauthorized accounts on the Juniper SRX itself. This does not negate the need to address this requirement on the AAA server and the event monitoring server (e.g., Syslog, Security Information and Event Management [SIEM], or SNMP servers).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure login classes and permissions and assign only authorized users to each class.\n\n[edit]\nshow system login\n\nIf any classes  are mapped to the audit-admin, security-admin, or system-admin login templates, delete the command from the class by typing delete in front of the command or retyping the command with the permission removed from the list.\n\nExample configuration:\nset system login class audit-admin allow-commands '(show log *)|(clear log *)|(monitor\nlog *)'\nset system login class audit-admin allow-configuration '(system syslog)'\nset system login class emergency permissions all\nset system login class emergency login-alarms\nset system login class security-admin login-alarms\nset system login class system-admin login-alarms",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-53|CM-6b.,800-53|CM-8(3)(a),800-53r5|CM-6b.,800-53r5|CM-8(3)(a),CAT|II,CCI|CCI-000366,CCI|CCI-000416,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CN-L3|8.1.10.6(d),CSF|DE.CM-7,CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,ITSG-33|CM-8(3)(a),NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-229029r518265_rule,STIG-ID|JUSX-DM-000165,STIG-Legacy|SV-81035,STIG-Legacy|V-66545,SWIFT-CSCv1|2.3,Vuln-ID|V-229029",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system login class .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_117": {
        "description": "JUSX-DM-000166 - The Juniper SRX Services Gateway must be configured to use Junos 12.1 X46 or later to meet the minimum required version for DoD.",
        "info": "Earlier versions of Junos may have reached the end of life cycle support by the vendor. Junos 12.1X46 is not a UC APL certified version, while 12.1X46 is UC APL Certified. The SRX with Junos 12.1X46 has been NIAP certified as a firewall and VPN. Junos 12.1X46 contains a number of enhancements, particularly related to IPv6, that are relevant to the STIG.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Follow the manufacturer's instructions for upgrading the Junos version. Software updates must be from an approved site and follow approved DoD procedures and verification processes in accordance with site testing procedures.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-223236r513397_rule,STIG-ID|JUSX-DM-000166,STIG-Legacy|SV-81037,STIG-Legacy|V-66547,SWIFT-CSCv1|2.3,Vuln-ID|V-223236",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set version .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_118": {
        "description": "JUSX-DM-000167 - For nonlocal maintenance sessions, the Juniper SRX Services Gateway must explicitly deny the use of J-Web.",
        "info": "If unsecured functions (lacking FIPS-validated cryptographic mechanisms) are used for management sessions, the contents of those sessions are susceptible to manipulation, potentially allowing alteration and hijacking.\n\nJ-Web (configured using the system services web-management option) does not meet the DoD requirement for management tools. It also does not work with all Juniper SRX hardware. By default, the web interface is disabled; however, it is easily enabled.",
        "solution": "Remove the web-management service.\n\n[edit]\ndelete system services web-management",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|I,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-223237r513400_rule,STIG-ID|JUSX-DM-000167,STIG-Legacy|SV-81095,STIG-Legacy|V-66605,SWIFT-CSCv1|2.3,Vuln-ID|V-223237",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services .+",
        "not_expect": "set system services web-management"
    }
}