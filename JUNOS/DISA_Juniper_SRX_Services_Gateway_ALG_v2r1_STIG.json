{
    "custom_item_1": {
        "description": "JUSX-AG-000019 - For User Role Firewalls, the Juniper SRX Services Gateway Firewall must employ user attribute-based security policies to enforce approved authorizations for logical access to information and system resources.",
        "info": "Successful authentication must not automatically give an entity access to an asset or security boundary. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.\n\nAuthorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset.\n\nThe Juniper Technical Library, Understanding User Role Firewalls, explains this Juniper SRX functionality in detail. This function integrates user-based firewall policies. Administrators can permit or restrict network access of employees, contractors, partners, and other users based on the roles they are assigned. User role firewalls enable greater threat mitigation, provide more informative forensic resources, improve record archiving for regulatory compliance, and enhance routine access provisioning. User role firewalls are more feasible with sites that do not have production workload and are used for employees to access network resources as opposed to large-scale datacenter environments.\n\nUser role firewalls trigger two actions, retrieval of user and/or role information associated with the traffic, and determine the action to take based on six match criteria within the context of the zone pair.\n\nThe source-identity field distinguishes a user role firewall from other types of firewalls. If the source identity is specified in any policy for a particular zone pair, it is a user role firewall. The user and role information must be retrieved before policy lookup occurs. If the source identity is not specified in any policy, user and role lookup is not required.\n\nTo retrieve user and role information, authentication tables are searched for an entry with an IP address corresponding to the traffic. If an entry is found, the user is classified as an authenticated user. If not found, the user is classified as an unauthenticated user.\n\nThe username and roles associated with an authenticated user are retrieved for policy matching. Both the authentication classification and the retrieved user and role information are used to match the source-identity field.\n\nCharacteristics of the traffic are matched to the policy specifications. Within the zone context, the first policy that matches the user or role and the five standard match criteria determines the action to be applied to the traffic.'\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure attribute-based security policies to enforce approved authorizations for logical access to information and system resources using the following commands.\n\nTo configure redirection from the SRX Series device to the Access Control Service, from configuration mode, configure the UAC profile for the captive portal.\n\n[edit]\nset services unified-access-control captive-portalredirect-traffic unauthenticated\n\nConfigure the redirection URL for the Access Control Service or a default URL for the captive portal.\n\n[edit]\nset services unified-access-control captive-portal acs-device redirect-url https://%ic-url%/?target=%dest-url%&enforcer=%enforcer-id%\n\nThis policy specifies the default target and enforcer variables to be used by the Access Control Service to direct the user back after authentication. This ensures that changes to system specifications will not affect configuration results.\n\nConfigure a user role firewall policy that redirects HTTP traffic from zone trust to zone untrust if the source-identity is unauthenticated-user. The captive portal profile name is specified as the action to be taken for traffic matching this policy. The following is an example only since there the actual policy is dependent on the architecture of the organization's network.\n\n[edit]\nset security policies from-zone trust to-zone untrust policy user-role-fw1 match source-address any\nset security policies from-zone trust to-zone untrust policy user-role-fw1 match destination-address any\nset security policies from-zone trust to-zone untrust policy user-role-fw1 match application http\nset security policies from-zone trust to-zone untrust policy user-role-fw1 match source-identity unauthenticated-user\nset security policies from-zone trust to-zone untrust policy user-role-fw1 then permit app",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214518r557389_rule,STIG-ID|JUSX-AG-000019,STIG-Legacy|SV-80493,STIG-Legacy|V-66003,TBA-FIISB|31.1,Vuln-ID|V-214518",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies from-zone .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_2": {
        "description": "JUSX-AG-000036 - The Juniper SRX Services Gateway must generate log records when firewall filters, security screens and security policies are invoked and the traffic is denied or restricted.",
        "info": "Without generating log records that log usage of objects by subjects and other objects, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.\n\nSecurity objects are data objects which are controlled by security policy and bound to security attributes.\n\nBy default, the Juniper SRX will not forward traffic unless it is explicitly permitted via security policy. Logging for Firewall security-related sources such as screens and security policies must be configured separately. To ensure firewall filters, security screens and security policies send events to a Syslog server and local logs, security logging must be configured one each firewall term.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Include the log and/or syslog action in all term to log packets matching each firewall term to ensure the term results are recorded in the firewall log and Syslog. To get traffic logs from permitted sessions, add 'then log session-close' to each policy. To get traffic logs from denied sessions, add 'then log session-init' to the policy.\n\nFirewall filter:\n[edit]\nset firewall familyfiltertermthen log\n\nExamples:\nset firewall family inet filter protect_re term tcp-connection then syslog\nset firewall family inet filter protect_re term tcp-connection then log\nset firewall family inet filter ingress-filter-v4 term deny-dscp then log\nset firewall family inet filter ingress-filter-v4 term deny-dscp then syslog\n\nSecurity policy and security screens:\nset security policies from-zoneto-zonepolicythen log\n\nExample:\nset security policies from-zone untrust to-zone trust policy default-deny then log",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214519r557389_rule,STIG-ID|JUSX-AG-000036,STIG-Legacy|SV-80793,STIG-Legacy|V-66303,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-214519",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set firewall family inet6? filter .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_3": {
        "description": "JUSX-AG-000037 - The Juniper SRX Services Gateway Firewall must generate audit records when unsuccessful attempts to access security zones occur.",
        "info": "Without generating log records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one.\n\nAccess for different security levels maintains separation between resources (particularly stored data) of different security domains.\n\nThe Juniper SRX Firewall implements security zones which are configured with different security policies based on risk and trust levels.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Include the log and/or syslog action in all zone configurations to log attempts to access zones. To get traffic logs from permitted sessions, add 'then log session-close' to the policy. To get traffic logs from denied sessions, add 'then log session-init' to the policy.\n\nset security policies from-zoneto-zonepolicythen log\n\nExample:\nset security policies from-zone untrust to-zone trust policy default-deny then log",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214520r557389_rule,STIG-ID|JUSX-AG-000037,STIG-Legacy|SV-80795,STIG-Legacy|V-66305,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-214520",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies from-zone .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_4": {
        "description": "JUSX-AG-000057 - The Juniper SRX Services Gateway Firewall must be configured to support centralized management and configuration of the audit log.",
        "info": "Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe DoD requires centralized management of all network component audit record content. Network components requiring centralized audit log management must have the capability to support centralized management. The content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Ensure at least one Syslog server and local files are configured to support requirements. However, the Syslog itself must also be configured to filter event records so it is not overwhelmed. A best practice when configuring the external Syslog server is to add similar log-prefixes to the log file names to help and researching of central Syslog server. Another best practice is to add a match condition to limit the recorded events to those containing the regular expression (REGEX). This requirement does not apply to audit logs generated on behalf of the device itself (management).\n\nWhile the Juniper SRX inherently has the capability to generate log records, by default only the high facility levels are captured and only to local files.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Logging for security-related sources such as screens and security policies must be configured separately.\n\nThe following example specifies that security log messages in structured-data format (syslog format) are sent from the source(e.g., the SRX's loopback or other interface IP address) to an external syslog server.\n\n[edit]\nset security log cache\nset security log format syslog\nset security log source-addressset security log streamhostTo get traffic logs from permitted sessions, add 'then log session-close' to the policy.\nTo get traffic logs from denied sessions, add 'then log session-init' to the policy. Enable Logging on Security Policies:\n\n[edit]\nset security policies from-zoneto-zonepolicythen logExample to log session init and session close events:\nset security policies from-zone trust to-zone untrust policy default-permit then log session-init\nset security policies from-zone trust to-zone untrust policy default-permit then log session-close",
        "reference": "800-171|3.3.1,800-53|AU-3(2),800-53r5|PL-9,CAT|II,CCI|CCI-001844,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(2),NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214521r557389_rule,STIG-ID|JUSX-AG-000057,STIG-Legacy|SV-80797,STIG-Legacy|V-66307,SWIFT-CSCv1|6.4,Vuln-ID|V-214521",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security log .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_5": {
        "description": "JUSX-AG-000063 - In the event that communications with the Syslog server is lost, the Juniper SRX Services Gateway must continue to queue traffic log records locally.",
        "info": "It is critical that when the network element is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include: software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.\n\nSince availability is an overriding concern given the role of the Juniper SRX in the enterprise, the system must not be configured to shut down in the event of a log processing failure. The system will be configured to log events to local files which will provide a log backup. If communication with the syslog server is lost or the server fails, the network device must continue to queue log records locally. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local log data with the collection server.\n\nBy default, both traffic log and system log events are sent to a local log file named messages. You can create a separate log file that contains only traffic log messages so that you do not need to filter for traffic log messages. This makes it easier to track usage patterns or troubleshoot issues for a specific policy.\n\nA best practice is to add log-prefixes to the log file names to help in researching the events and filters to prevent log overload. Another best practice is to add a match condition to limit the recorded events to those containing the regular expression (REGEX).",
        "solution": "The following example commands configure local backup files to capture DoD-defined auditable events.\n\n[edit]\nset system syslog fileany info\nset system syslog filematch 'RT_FLOW_SESSION '\n\nExample:\nset system syslog filematch 'RT_FLOW_SESSION '",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214522r557389_rule,STIG-ID|JUSX-AG-000063,STIG-Legacy|SV-80799,STIG-Legacy|V-66309,Vuln-ID|V-214522",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system syslog file .+ match .+",
        "expect": "set system syslog file .+ match RT_FLOW_SESSION"
    },
    "custom_item_6": {
        "description": "JUSX-AG-000083 - The Juniper SRX Services Gateway Firewall must disable or remove unnecessary network services and functions that are not used as part of its role in the architecture.",
        "info": "Network devices are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the SRX. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nServices that may be related security-related, but based on the role of the device in the architecture do not need to be installed. For example, the Juniper SRX can have an Antivirus, Web filter, IDS, or ALG license. However, if these functions are not part of the documented role of the SRX in the enterprise or branch architecture, then these the software and licenses should not be installed on the device. This mitigates the risk of exploitation of unconfigured services or services that are not kept updated with security fixes. If left unsecured, these services may provide a threat vector.\n\nOnly remove unauthorized services. This control is not intended to restrict the use of Juniper SRX devices with multiple authorized roles.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove unnecessary services and functions. From operational mode, display the licenses available to be deleted; enter the following commands.\n\nrequest system license delete license-identifier-list ?\nrequest system license deleteNote: Only remove unauthorized services. This control is not intended to restrict the use of Juniper SRX devices with multiple authorized roles.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214523r557389_rule,STIG-ID|JUSX-AG-000083,STIG-Legacy|SV-80801,STIG-Legacy|V-66311,SWIFT-CSCv1|2.3,Vuln-ID|V-214523",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "cmd": "show system license",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_7": {
        "description": "JUSX-AG-000084 - The Juniper SRX Services Gateway Firewall must not be configured as an NTP server since providing this network service is unrelated to the role as a firewall.",
        "info": "Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the SRX. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nThe Juniper SRX is a highly configurable platform that can fulfil many roles in the Enterprise or Branch architecture depending on the model installed. Some services are employed for management services; however, these services can often also be provided as a network service on the data plane. Examples of these services are NTP, DNS, and DHCP. Also, as a Next Generation Firewall (NGFW) and Unified Threat Management (UTM) device, the SRX integrate functions which have been traditionally separated.\n\nThe SRX may integrate related content filtering, security services, and analysis services and tools (e.g., IPS, proxy, malware inspection, black/white lists). Depending on licenses purchased, gateways may also include email scanning, decryption, caching, VPN, and DLP services. However, services and capabilities which are unrelated to this primary functionality must not be installed (e.g., DNS, email server, FTP server, or web server).",
        "solution": "Delete NTP options from zones and interface commands. Re-enter the set security zone command without the 'ntp' attribute. The exact command entered depends how the zone is configured with the authorized attributes, services, and options.\n\nExamples:\n\n[edit]\nset security zones security-zoneinterfaceshost-inbound-traffic",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214524r557389_rule,STIG-ID|JUSX-AG-000084,STIG-Legacy|SV-80803,STIG-Legacy|V-66313,SWIFT-CSCv1|2.3,Vuln-ID|V-214524",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security zones security-zone .+ interfaces .+ host-inbound-traffic .+",
        "not_expect": "set security zones security-zone .+ interfaces .+ host-inbound-traffic .+ ntp"
    },
    "custom_item_8": {
        "description": "JUSX-AG-000085 - The Juniper SRX Services Gateway Firewall must not be configured as a DNS proxy since providing this network service is unrelated to the role as a Firewall.",
        "info": "Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the SRX. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nThe Juniper SRX is a highly configurable platform that can fulfil many roles in the Enterprise or Branch architecture depending on the model installed. Some services are employed for management services; however, these services can often also be provided as a network service on the data plane. Examples of these services are NTP, DNS, and DHCP. Also, as a Next Generation Firewall (NGFW) and Unified Threat Management (UTM) device, the SRX integrate functions which have been traditionally separated.\n\nThe SRX may integrate related content filtering, security services, and analysis services and tools (e.g., IPS, proxy, malware inspection, black/white lists). Depending on licenses purchased, gateways may also include email scanning, decryption, caching, VPN, and DLP services. However, services and capabilities which are unrelated to this primary functionality must not be installed (e.g., DNS, email server, FTP server, or web server).",
        "solution": "First, remove the DNS stanza. Then re-enter the set security zones and interfaces command without the 'dns' attribute. The exact command entered depends how the zone is configured with the authorized attributes, services, and options.\n\nExamples:\n\n[edit]\ndelete system services dns\nset security zones security-zoneinterfaceshost-inbound-traffic",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214525r557389_rule,STIG-ID|JUSX-AG-000085,STIG-Legacy|SV-80805,STIG-Legacy|V-66315,SWIFT-CSCv1|2.3,Vuln-ID|V-214525",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services .+",
        "not_expect": "set system services dns"
    },
    "custom_item_9": {
        "description": "JUSX-AG-000086 - The Juniper SRX Services Gateway Firewall must not be configured as a DHCP server since providing this network service is unrelated to the role as a Firewall.",
        "info": "Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the SRX. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nThe Juniper SRX is a highly configurable platform that can fulfil many roles in the Enterprise or Branch architecture depending on the model installed. Some services are employed for management services; however, these services can often also be provided as a network service on the data plane. Examples of these services are NTP, DNS, and DHCP. Also, as a Next Generation Firewall (NGFW) and Unified Threat Management (UTM) device, the SRX integrate functions which have been traditionally separated.\n\nThe SRX may integrate related content filtering, security services, and analysis services and tools (e.g., IPS, proxy, malware inspection, black/white lists). Depending on licenses purchased, gateways may also include email scanning, decryption, caching, VPN, and DLP services. However, services and capabilities which are unrelated to this primary functionality must not be installed (e.g., DNS, email server, FTP server, or web server).",
        "solution": "First, remove the DHCP stanza. Then re-enter the set security zones and interfaces command without the 'dhcp' attribute. The exact command entered depends how the zone is configured with the authorized attributes, services, and options.\n\nExamples:\n\n[edit]\ndelete system services dhcp\nset security zones security-zoneinterfaceshost-inbound-traffic",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214526r557389_rule,STIG-ID|JUSX-AG-000086,STIG-Legacy|SV-80807,STIG-Legacy|V-66317,SWIFT-CSCv1|2.3,Vuln-ID|V-214526",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set system services .+",
        "not_expect": "set system services dhcp"
    },
    "custom_item_10": {
        "description": "JUSX-AG-000087 - The Juniper SRX Services Gateway Firewall must be configured to prohibit or restrict the use of unauthorized functions, ports, protocols, and/or services, as defined in the PPSM CAL, vulnerability assessments.",
        "info": "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types); organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nDoD continually assesses the ports, protocols, and services that can be used for network communications. Some ports, protocols or services have known exploits or security weaknesses. Network traffic using these ports, protocols, and services must be prohibited or restricted in accordance with DoD policy. The PPSM CAL and vulnerability assessments provide an authoritative source for ports, protocols, and services that are unauthorized or restricted across boundaries on DoD networks.\n\nThe Juniper SRX must be configured to prevent or restrict the use of prohibited ports, protocols, and services throughout the network by filtering the network traffic and disallowing or redirecting traffic as necessary. Default and updated policy filters from the vendors will disallow older version of protocols and applications and will address most known non-secure ports, protocols, and/or services.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Ensure functions, ports, protocols, and services identified on the PPSM CAL are not used for system services configuration.\n\n[edit]\nshow security services\n\nCompare the services which are enabled, including the port, services, protocols and functions.\n\nConsult the Juniper knowledge base and configuration guides to determine the commands for disabling each port, protocol, service or function that is not in compliance with the PPSM CAL and vulnerability assessments.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-214527r557389_rule,STIG-ID|JUSX-AG-000087,STIG-Legacy|SV-80809,STIG-Legacy|V-66319,SWIFT-CSCv1|2.3,Vuln-ID|V-214527",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_11": {
        "description": "JUSX-AG-000105 - The Juniper SRX Services Gateway Firewall must terminate all communications sessions associated with user traffic after 15 minutes or less of inactivity.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nThis control does not imply that the device terminates all sessions or network access; it only ends the inactive session.\n\nSince many of the inactivity timeouts pre-defined by Junos OS are set to 1800 seconds, an explicit custom setting of 900 must be set for each application used by the DoD implementation. Since a timeout cannot be set directly on the predefined applications, the timeout must be set on the any firewall rule that uses a pre-defined application (i.e., an application that begins with junos-), otherwise the default pre-defined timeout will be used.",
        "solution": "Add or update the session inactivity timeout for communications sessions to 900 seconds or less.\n\nExamples:\n[edit]\nset applications applicationterm 1 protocol udp inactivity-timeout 900\nset applications application junos-http inactivity-timeout 900\n\nOr\n\nCreate a service that matches any TCP/UDP:\n[edit]\nset applications application TCP-ALL source-port 1-65535 destination-port 1-65535 protocol tcp inactivity-timeout 900\n\nNote: When pre-defined applications are used in firewall policies, the timeout value must be set in the policy stanza.",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-214528r557389_rule,STIG-ID|JUSX-AG-000105,STIG-Legacy|SV-80811,STIG-Legacy|V-66321,SWIFT-CSCv1|2.6,Vuln-ID|V-214528",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set applications application .+ inactivity-timeout .+",
        "expect": "set applications application .+ inactivity-timeout ([1-9]|[1-9][0-9]|[1-8][0-9]{2}|900)\\s*$"
    },
    "custom_item_12": {
        "description": "JUSX-AG-000120 - The Juniper SRX Services Gateway Firewall providing content filtering must protect against known and unknown types of Denial of Service (DoS) attacks by implementing statistics-based screens.",
        "info": "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users. Installation of content filtering gateways and application layer firewalls at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.\n\nJuniper SRX Firewall DoS protections can be configured by either using a Screen or within the global flow options. Screens, also known as IDS-options, block various layer 3 and 4 attacks. Screen objects are configured with various screen-specific options and then assigned to a zone. The Juniper SRX can be configured with Screens to protect against the following statistics-based DoS attacks: IP sweeps, port scans, and flood attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following example commands configure security screens under a profile named untrust-screen. Screen options, with configurable thresholds may be customized to minimize/prevent operational impact on traffic performance.\n\n[edit]\nset security screen ids-optionBased on 800-53 requirements and vendor recommendations, the following DoS screens are required, at a minimum, for use in DoD configurations.\n\nset security screen ids-option untrust-screen icmp ip-sweep threshold 1000\nset security screen ids-option untrust-screen tcp port-scan threshold 1000\nset security screen ids-option untrust-screen tcp syn-flood alarm-threshold 1000\nset security screen ids-option untrust-screen tcp syn-flood attack-threshold 1100\nset security screen ids-option untrust-screen tcp syn-flood source-threshold 100\nset security screen ids-option untrust-screen tcp syn-flood destination-threshold 2048\nset security screen ids-option untrust-screen tcp syn-flood timeout 20\nset security screen ids-option untrust-screen udp flood threshold 5000\nset security screen ids-option untrust-screen udp udp-sweep threshold 1000\n\nTo enable screen protection, the screen profile must be associated with individual security zones using the following command. Recommend assigning 'untrust-screen' profile name to the default zone named 'untrust'.\n\n[edit]\nset security zone security-zonescreenExample: set security zones security-zone untrust screen untrust-screen",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|I,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-214529r559708_rule,STIG-ID|JUSX-AG-000120,STIG-Legacy|SV-80813,STIG-Legacy|V-66323,Vuln-ID|V-214529",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security screen .+|set security zone security-zone .+ screen .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_13": {
        "description": "JUSX-AG-000122 - The Juniper SRX Services Gateway Firewall must protect against known types of Denial of Service (DoS) attacks by implementing signature-based screens.",
        "info": "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users. Installation of content filtering gateways and application layer firewalls at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks.\n\nJuniper SRX Firewall DoS protections can be configured by either using a Screen or within the global flow options. Screens, also known as IDS-options, block various layer 3 and 4 attacks. Screen objects are configured with various screen-specific options and then assigned to a zone. The Juniper SRX can be configured with Screens to protect against the following signature-based DoS attacks: ICMP based attacks such as ping of death, IP based attacks such as IP spoofing and teardrop, and TCP based attacks such as TCP headers and land.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "The following example commands configure security screens under a profile named untrust-screen. Screen options with configurable thresholds may be customized to minimize/prevent operational impact on traffic performance.\n\n[edit]\nset security screen ids-optionBased on 800-53 requirements and vendor recommendations, the following signature-based screens are required, at a minimum, for use in DoD configurations.\n\nset security screen ids-option untrust-screen icmp ping-death\nset security screen ids-option untrust-screen ip bad-option\nset security screen ids-option untrust-screen ip record-route-option\nset security screen ids-option untrust-screen ip timestamp-option\nset security screen ids-option untrust-screen ip security-option\nset security screen ids-option untrust-screen ip stream-option\nset security screen ids-option untrust-screen ip spoofing\nset security screen ids-option untrust-screen ip source-route-option\nset security screen ids-option untrust-screen ip unknown-protocol\nset security screen ids-option untrust-screen ip tear-drop\nset security screen ids-option untrust-screen ip ipv6-extension-header hop-by-hop-header\njumbo-payload-option\nset security screen ids-option untrust-screen ip ipv6-extension-header hop-by-hop-header\nrouter-alert-option\nset security screen ids-option untrust-screen ip ipv6-extension-header hop-by-hop-header\nquick-start-option\nset security screen ids-option untrust-screen ip ipv6-extension-header routing-header\nset security screen ids-option untrust-screen ip ipv6-extension-header fragment-header\nset security screen ids-option untrust-screen ip ipv6-extension-header no-next-header\nset security screen ids-option untrust-screen ip ipv6-extension-header shim6-header\nset security screen ids-option untrust-screen ip ipv6-extension-header mobility-header\nset security screen ids-option untrust-screen ip ipv6-malformed-header\nset security screen ids-option untrust-screen tcp syn-fin\nset security screen ids-option untrust-screen tcp fin-no-ack\nset security screen ids-option untrust-screen tcp tcp-no-flag\nset security screen ids-option untrust-screen tcp syn-frag\nset security screen ids-option untrust-screen tcp land\n\nTo enable screen protection, the screen profile must be associated with individual security zones using the following command. Recommend assigning 'untrust-screen' profile name to the default zone named 'untrust'.\n\n[edit]\nset security zone security-zonescreenExample: set security zones security-zone untrust screen untrust-screen",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|I,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-214531r557389_rule,STIG-ID|JUSX-AG-000122,STIG-Legacy|SV-80817,STIG-Legacy|V-66327,Vuln-ID|V-214531",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security screen .+|set security zone security-zone .+ screen .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_14": {
        "description": "JUSX-AG-000124 - The Juniper SRX Services Gateway Firewall must block outbound traffic containing known and unknown DoS attacks to protect against the use of internal information systems to launch any Denial of Service (DoS) attacks against other networks or endpoints.",
        "info": "DoS attacks can take multiple forms but have the common objective of overloading or blocking a network or host to deny or seriously degrade performance. If the network does not provide safeguards against DoS attack, network resources will be unavailable to users. The Juniper SRX must include protection against DoS attacks that originate from inside the enclave, which can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave. These attacks can be simple 'floods' of traffic to saturate circuits or devices, malware that consumes CPU and memory on a device or causes it to crash, or a configuration issue that disables or impairs the proper function of a device. For example, an accidental or deliberate misconfiguration of a routing table can misdirect traffic for multiple networks.\n\nThe Juniper SRX Firewall uses Screens and Security Policies to detect known DoS attacks with known attack vectors. However, these Screens and policies must be applied to outbound traffic using zones and interface stanzas.\n\nTraffic exits the Juniper SRX by way of interfaces. Security zones are configured for one or more interfaces with the same security requirements for filtering data packets. A security zone implements a security policy for one or multiple network segments. These policies must be applied to inbound traffic as it crosses both the network perimeter and as it crosses internal security domain boundaries.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To enable screen protection, the screen profile must be associated with individual security zones using the following command. Recommend assigning 'untrust-screen' profile name.\n\nApply screen to each outbound interface example:\n\nset security zones security-zone untrust interfacesset security zones security-zone trust screen untrust-screen",
        "reference": "800-53|SC-5(1),800-53r5|SC-5(1),CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(1),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-214532r557389_rule,STIG-ID|JUSX-AG-000124,STIG-Legacy|SV-80819,STIG-Legacy|V-66329,Vuln-ID|V-214532",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security zones security-zone .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_15": {
        "description": "JUSX-AG-000126 - The Juniper SRX Services Gateway Firewall must only allow inbound communications from organization-defined authorized sources routed to organization-defined authorized destinations.",
        "info": "Unrestricted traffic may contain malicious traffic which poses a threat to an enclave or to other connected networks. Additionally, unrestricted traffic may transit a network, which uses bandwidth and other resources.\n\nTraffic enters the Juniper SRX by way of interfaces. Security zones are configured for one or more interfaces with the same security requirements for filtering data packets. A security zone implements a security policy for one or multiple network segments. These policies must be applied to inbound traffic as it crosses the network perimeter and as it crosses internal security domain boundaries.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a security policy or screen to each outbound zone to implement continuous monitoring. The following commands configure a security zone called 'untrust' that can be used to apply security policy for inbound interfaces that are connected to untrusted networks. This example assumes that interfaces ge-0/0/1 and ge-0/0/2 are connected to untrusted and trusted network segments.\n\nApply security policy a zone example:\n\nset security zones security-zone untrust interfaces ge-0/0/1.0\nset security zones security-zone trust interfaces ge-0/0/2.0\nset security policies from-zone trust to-zone untrust policy default-deny match destination-address any\nset security policies from-zone trust to-zone untrust policy default-deny then deny",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CAT|II,CCI|CCI-002403,CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-214533r557389_rule,STIG-ID|JUSX-AG-000126,STIG-Legacy|SV-80821,STIG-Legacy|V-66331,TBA-FIISB|31.3,Vuln-ID|V-214533",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security (policies|zones) .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_16": {
        "description": "JUSX-AG-000128 - The Juniper SRX Services Gateway Firewall must deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception).",
        "info": "A deny-all, permit-by-exception network communications traffic policy ensures that only those connections which are essential and approved are allowed.\n\nAs a managed interface, the ALG must block all inbound and outbound network communications traffic to the application being managed and controlled unless a policy filter is installed to explicitly allow the traffic. The allow policy filters must comply with the site's security policy. A deny all, permit by exception network communications traffic policy ensures that only those connections which are essential and approved, are allowed.\n\nBy default, Junos denies all traffic through an SRX Series device using an implicit default security policy exists that denies all packets. Organizations must configure security policies that permits or redirects traffic in compliance with DoD policies and best practices. Sites must not change the factory-default security policies.",
        "solution": "By default, the SRX device will not forward traffic unless it is explicitly permitted via security policy. If the default-policy has been changed, then this must be corrected using the set security policies default-policy command.",
        "reference": "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),800-53r5|SC-7(5),CAT|II,CCI|CCI-001109,CN-L3|7.1.2.2(c),CSF|PR.PT-4,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(5),NESA|T4.5.4,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-214535r557389_rule,STIG-ID|JUSX-AG-000128,STIG-Legacy|SV-80825,STIG-Legacy|V-66335,TBA-FIISB|43.1,Vuln-ID|V-214535",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set security policies default-policy .+",
        "expect": "set security policies default-policy deny-all"
    },
    "custom_item_17": {
        "description": "JUSX-AG-000132 - The Juniper SRX Services Gateway Firewall must configure ICMP to meet DoD requirements.",
        "info": "Providing too much information in error messages risks compromising the data and security of the application and system.\n\nOrganizations carefully consider the structure/content of error messages. The required information within error messages will vary based on the protocol and error condition. Information that could be exploited by adversaries includes ICMP messages that reveal the use of firewalls or access-control lists.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure ICMP to meet DoD requirements. The following is an example which uses the filter name 'protect_re' as the filter name with pre-configured address books (source-prefix-lists).\n\n[edit]\nset firewall family inet filter protect_re term permit-icmp from source-prefix-list ssh-addresses\nset firewall family inet filter protect_re term permit-icmp from source-prefix-list bgp-addresses\nset firewall family inet filter protect_re term permit-icmp from source-prefix-list loopback-addresses\nset firewall family inet filter protect_re term permit-icmp from source-prefix-list local-addresses\nset firewall family inet filter protect_re term permit-icmp from source-prefix-list ixiav4\nset firewall family inet filter protect_re term permit-icmp from icmp-type echo-request\nset firewall family inet filter protect_re term permit-icmp from icmp-type echo-reply\nset firewall family inet filter protect_re term permit-icmp then log\nset firewall family inet filter protect_re term permit-icmp then syslog\nset firewall family inet filter protect_re term permit-icmp then accept\nset firewall family inet6 filter protect_re-v6 term permit-ar from icmp-type neighboradvertisement\nset firewall family inet6 filter protect_re-v6 term permit-ar from icmp-type neighborsolicit\nset firewall family inet6 filter ingress-v6 term permit-ar from icmp-type neighboradvertisement\nset firewall family inet6 filter ingress-v6 term permit-ar from icmp-type neighborsolicit\nset firewall family inet6 filter ingress-v6 term permit-ar from icmp-type 134\nset firewall family inet6 filter ingress-v6 term permit-ar then accept\nset firewall family inet6 filter egress-v6 term permit-lr from icmp-type neighboradvertisement\nset firewall family inet6 filter egress-v6 term permit-lr from icmp-type neighbor-solicit\nset firewall family inet6 filter egress-v6 term permit-lr from icmp-type 134\nset firewall family inet6 filter egress-v6 term permit-lr then accept",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,CAT|II,CCI|CCI-001312,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,Rule-ID|SV-214536r557389_rule,STIG-ID|JUSX-AG-000132,STIG-Legacy|SV-80827,STIG-Legacy|V-66337,Vuln-ID|V-214536",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "set firewall family inet6? .+",
        "expect": "^Manual Review Required$"
    },
    "custom_item_18": {
        "description": "JUSX-AG-000144 - The Juniper SRX Services Gateway Firewall must continuously monitor all inbound communications traffic for unusual/unauthorized activities or conditions.",
        "info": "If inbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.\n\nThe Juniper SRX is a highly scalable system which, by default, provides stateful or stateless continuous monitoring when placed in the architecture at either the perimeter or internal boundaries.\n\nUnusual/unauthorized activities or conditions may include unusual use of unusual protocols or ports and attempted communications from trusted zones to external addresses.\n\nInterfaces with identical security requirements can be grouped together into a single security zone. By default, once a security policy is applied to a zone, the Juniper SRX continuously monitors the associated zone for unusual/unauthorized activities or conditions based on the firewall filter or screen associated with that zone.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a security policy or screen to each inbound zone to implement continuous monitoring. The following commands configure a security zone called 'untrust' that can be used to apply security policy for inbound interfaces that are connected to untrusted networks. This example assumes that interfaces ge-0/0/1 and ge-0/0/2 are connected to untrusted and trusted network segments.\n\nApply policy or screen to a zone example:\n\nset security zones security-zone untrust interfaces ge-0/0/1.0\nset security zones security-zone trust interfaces ge-0/0/2.0\nset security zones security-zone untrust screen untrust-screen\nset security policies from-zone untrust to-zone trust policy default-deny match destination-address any\nset security policies from-zone untrust to-zone trust policy default-deny then deny",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CAT|I,CCI|CCI-002661,CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-214537r557389_rule,STIG-ID|JUSX-AG-000144,STIG-Legacy|SV-80829,STIG-Legacy|V-66339,SWIFT-CSCv1|6.5,Vuln-ID|V-214537",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security zones security-zone .+|set security policies from-zone .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_19": {
        "description": "JUSX-AG-000145 - The Juniper SRX Services Gateway Firewall must continuously monitor outbound communications traffic for unusual/unauthorized activities or conditions.",
        "info": "If outbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.\n\nThe Juniper SRX is a highly scalable system which can provide stateful or stateless continuous monitoring when placed in the architecture at either the perimeter or internal boundaries. Unusual/unauthorized activities or conditions may include unusual use of unusual protocols or ports and attempted communications from trusted zones to external addresses.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure a security policy or screen to each outbound zone to implement continuous monitoring. The following commands configure a security zone called 'untrust' that can be used to apply security policy for inbound interfaces that are connected to untrusted networks. This example assumes that interfaces ge-0/0/1 and ge-0/0/2 are connected to untrusted and trusted network segments.\n\nApply policy or screen to a zone example:\n\nset security zones security-zone untrust interfaces ge-0/0/1.0\nset security zones security-zone trust interfaces ge-0/0/2.0\nset security zones security-zone untrust screen untrust-screen\nset security policies from-zone trust to-zone untrust policy default-deny match destination-address any\nset security policies from-zone trust to-zone untrust policy default-deny then deny",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CAT|I,CCI|CCI-002662,CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-214538r557389_rule,STIG-ID|JUSX-AG-000145,STIG-Legacy|SV-80831,STIG-Legacy|V-66341,SWIFT-CSCv1|6.5,Vuln-ID|V-214538",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security zones security-zone .+|set security policies from-zone .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_20": {
        "description": "JUSX-AG-000146 - The Juniper SRX Services Gateway Firewall must generate an alert to, at a minimum, the ISSO and ISSM when unusual/unauthorized activities or conditions are detected during continuous monitoring of communications traffic as it traverses inbound or outbound  across internal security boundaries.",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action and this delay may result in the loss or compromise of information.\n\nSince these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nIn accordance with CCI-001242, the ALG which provides content inspection services is a real-time intrusion detection system. These systems must generate an alert when detection events from real-time monitoring occur as required by CCI-2262 and CCI-2261. Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel. Alerts must be sent immediately to designated individuals. Alerts may be sent via NMS, SIEM, Syslog configuration, SNMP trap or notice, or manned console message.\n\nUnusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the Juniper SRX to generate and send a notification or log message immediately that can be forwarded via an event monitoring system (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system). The NSM, Syslog, or SNMP server must then be configured to send the message.\n\nThe following example configures the zone security policy to include the log and/or syslog action in all terms to log packets matching each firewall term to ensure the term results are recorded in the firewall log and Syslog. To get traffic logs from permitted sessions, add 'then log session-close' to each policy. To get traffic logs from denied sessions, add 'then log session-init' to the policy.\n\nSecurity policy and security screens:\nset security policies from-zoneto-zonepolicythen log\n\nExample:\nset security policies from-zone untrust to-zone trust policy default-deny then log session-init",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-214539r557389_rule,STIG-ID|JUSX-AG-000146,STIG-Legacy|SV-80833,STIG-Legacy|V-66343,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-214539",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security zones security-zone .+|set security policies from-zone .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_21": {
        "description": "JUSX-AG-000147 - The Juniper SRX Services Gateway Firewall must generate an alert that can be forwarded to, at a minimum, the ISSO and ISSM when threats identified by authoritative sources are detected.",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) which require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise.\n\nSince these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel. Alerts must be sent immediately to designated individuals. Alerts may be sent via NMS, SIEM, Syslog configuration, SNMP trap or notice, or manned console message.\n\nAuthoritative sources include USSTRATCOM warning and tactical directives/orders including Fragmentary Order (FRAGO), Communications Tasking Orders (CTOs), IA Vulnerability Notices, Network Defense Tasking Message (NDTM), DOD GIG Tasking Message (DGTM), and Operations Order (OPORD).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the Juniper SRX to generate and send a notification or log message that can be forwarded via an event monitoring system (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system). The NSM, Syslog, or SNMP server must then be configured to send the message.\n\nThe following example configures the zone security policy to include the log and/or syslog action in all terms to log packets matching each firewall term to ensure the term results are recorded in the firewall log and Syslog. To get traffic logs from permitted sessions, add 'then log session-close' to each policy. To get traffic logs from denied sessions, add 'then log session-init' to the policy.\n\nSecurity policy and security screens:\nset security policies from-zoneto-zonepolicythen log\n\nExample:\nset security policies from-zone untrust to-zone trust policy default-deny then log session-init",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-214540r557389_rule,STIG-ID|JUSX-AG-000147,STIG-Legacy|SV-80835,STIG-Legacy|V-66345,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-214540",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security zones security-zone .+|set security policies from-zone .+)",
        "expect": "^Manual Review Required$"
    },
    "custom_item_22": {
        "description": "JUSX-AG-000150 - The Juniper SRX Services Gateway Firewall must generate an alert that can be forwarded to, at a minimum, the ISSO and ISSM when DoS incidents are detected.",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) which require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise.\n\nSince these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event Categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the Juniper SRX to generate for DoS attacks detected in CCI-002385. DoS attacks are detected using screens. The alert sends a notification or log message that can be forwarded via an event monitoring system (e.g., via Syslog configuration, SNMP trap, manned console message, or other events monitoring system). The NSM, Syslog, or SNMP server must then be configured to send the message.\n\nThe following example configures the zone security policy to include the log and/or syslog action in all terms to log packets matching each firewall term to ensure the term results are recorded in the firewall log and Syslog. To get traffic logs from permitted sessions, add 'then log session-close' to each policy. To get traffic logs from denied sessions, add 'then log session-init' to the policy.\n\nApply policy or screen to a zone example:\n\nset security zones security-zone trust interfaces ge-0/0/2.0\nset security zones security-zone untrust screen untrust-screen\nset security policies from-zone untrust to-zone trust policy default-deny then log session-init",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Juniper_SRX_SG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-214541r557389_rule,STIG-ID|JUSX-AG-000150,STIG-Legacy|SV-80837,STIG-Legacy|V-66347,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-214541",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Juniper_SRX_SG_Y22M10_STIG.zip",
        "regex": "(set security zones security-zone .+|set security policies from-zone .+)",
        "expect": "^Manual Review Required$"
    }
}