{
    "custom_item_1": {
        "description": "Tomcat found",
        "cmd": "java -cp @LIB_DIR@/catalina.jar org.apache.catalina.util.ServerInfo | /bin/egrep 'version'",
        "expect": "@WEBSERVER_NAME@"
    },
    "custom_item_2": {
        "system": "Linux",
        "description": "2.5 Disable client-facing stack traces (check for defined exception type)",
        "info": "Debugging information, such as that found in call stacks, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced.",
        "solution": "Perform the following to prevent Tomcat from providing debug information to the requestor during runtime errors:\n        1. Create a web page that contains the logic or message you wish to invoke when\n        encountering a runtime error. For example purposes, assume this page is located at\n        /error.jsp.\n        2. Add a child element,, to theelement, in the\n        $CATALINA_HOME/conf/web.xml file.\n        3. Add a child element,, to theelement. Set the value of\n        theelement to java.lang.Throwable.\n        4. Add a child element,, to theelement. Set the value of theelement to the location of page created in #1.\n        The resulting entry will look as follows:java.lang.Throwable/error.jsp",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/web.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_3": {
        "system": "Linux",
        "description": "2.6 Turn off TRACE (check server.xml)",
        "info": "Diagnostic information, such as that found in the response to a TRACE request, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced.",
        "solution": "Perform the following to prevent Tomcat from accepting a TRACE request:\n            1. Set the allowTrace attributes to each Connector specified in $CATALINA_HOME/conf/server.xml to false.Alternatively, ensure the allowTrace attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent.",
        "reference": "800-53|SI-11,800-53r5|SI-11,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "2.6 Turn off TRACE (check web.xml config files)",
        "info": "Diagnostic information, such as that found in the response to a TRACE request, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced.",
        "solution": "Perform the following to prevent Tomcat from accepting a TRACE request:\n            1. Set the allowTrace attributes to each Connector specified in $CATALINA_HOME/conf/server.xml to false.Alternatively, ensure the allowTrace attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent.",
        "reference": "800-53|SI-11,800-53r5|SI-11,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "$(which find) @CATALINA_HOME@ -name web.xml -exec bash -c 'if test -f {}; then $(which cat) {} | $(which egrep) -q \"^[\\\\\\s\\\\\\t]*[Gg][Ee][Tt][Tt][Rr][Aa][Cc][Ee]<\\\\\\/servlet-name>\"; if test $? -lt 1; then echo {};fi; fi' \\\\;",
        "expect": ""
    },
    "custom_item_5": {
        "system": "Linux",
        "description": "3.1 Set a nondeterministic Shutdown command value.",
        "info": "Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. It is recommended that a nondeterministic value be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml.",
        "solution": "Update the shutdown attribute in $CATALINA_HOME/conf/server.xml as follows:Note: NONDETERMINISTICVALUE should be replaced with a sequence of random characters.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_6": {
        "system": "Linux",
        "description": "4.1 Restrict access to $CATALINA_HOME",
        "info": "$CATALINA_HOME is the environment variable which holds the path to the root Tomcat directory. It is important to protect access to this in order to protect the Tomcat binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is also recommended that the permissions on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
        "solution": "Perform the following to establish the recommended state:\n            1. Set the ownership of the $CATALINA_HOME to tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world\n            3. Remove write permissions for the group.\n            # chown tomcat_admin.tomcat $CATALINA_HOME\n            # chmod g-w,o-rwx $CATALINA_HOME",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CATALINA_HOME@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_7": {
        "system": "Linux",
        "description": "4.2 Restrict access to $CATALINA_BASE",
        "info": "$CATALINA_BASE is the environment variable that specifies the base directory which most relative paths are resolved. $CATALINA_BASE is usually used when there are multiple instances of Tomcat running. It is important to protect access to this in order to protect the Tomcat-related binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the permissions on $CATALINA_BASE prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).\n\n          Note: Nessus is configured to use the CATALINA_HOME variable value as the location of $CATALINA_BASE. If you are running multiple instances of Tomcat on this host, it may be necessary to run multiple scans in order to confirm proper configuration.",
        "solution": "Perform the following to establish the recommended state:\n            1. Set the ownership of the $CATALINA_BASE to tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world\n            3. Remove write permissions for the group.\n            # chown tomcat_admin.tomcat $CATALINA_BASE\n            # chmod g-w,o-rwx $CATALINA_BASE",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CATALINA_HOME@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_8": {
        "system": "Linux",
        "description": "4.3 Restrict access to Tomcat configuration directory",
        "info": "The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat configuration files. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
        "solution": "Perform the following to restrict access to Tomcat configuration files:\n            1. Set the ownership of the $CATALINA_HOME/conf to tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf\n            # chmod g-w,o-rwx $CATALINA_HOME/conf",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_9": {
        "system": "Linux",
        "description": "4.4 Restrict access to Tomcat logs directory",
        "info": "The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx).",
        "solution": "Perform the following to restrict access to Tomcat log files:\n        1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat.\n        2. Remove read, write, and execute permissions for the world\n        # chown tomcat_admin:tomcat# chmod o-rwx",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@LOG_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "007",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_10": {
        "system": "Linux",
        "description": "4.5 Restrict access to Tomcat temp directory",
        "info": "The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist temporary information to disk. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx).",
        "solution": "Perform the following to restrict access to Tomcat temp directory:\n        1. Set the ownership of the $CATALINA_HOME/temp to tomcat_admin:tomcat.\n        2. Remove read, write, and execute permissions for the world\n        # chown tomcat_admin:tomcat $CATALINA_HOME/temp\n        # chmod o-rwx $CATALINA_HOME/temp",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@TEMP_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "007",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_11": {
        "system": "Linux",
        "description": "4.6 Restrict access to Tomcat binaries directory",
        "info": "The Tomcat $CATALINA_HOME/bin/ directory contains executables that are part of the Tomcat run-time. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
        "solution": "Perform the following to restrict access to Tomcat bin directory:\n        1. Set the ownership of the $CATALINA_HOME/bin to tomcat_admin:tomcat.\n        2. Remove read, write, and execute permissions for the world\n        # chown tomcat_admin:tomcat $CATALINA_HOME/bin\n        # chmod g-w,o-rwx $CATALINA_HOME/bin",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_12": {
        "system": "Linux",
        "description": "4.7 Restrict access to Tomcat web application directory",
        "info": "The Tomcat $CATALINA_HOME/webapps directory contains web applications that are deployed through Tomcat. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on $CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
        "solution": "Perform the following to restrict access to Tomcat webapps directory:\n            1. Set the ownership of the $CATALINA_HOME/webapps to tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/webapps\n            # chmod g-w,o-rwx $CATALINA_HOME/webapps",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_13": {
        "system": "Linux",
        "description": "4.8 Restrict access to Tomcat catalina.policy",
        "info": "The catalina.policy file is used to configure security policies for Tomcat. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to $CATALINA_HOME/conf/catalina.policy.\n            1. Set the owner and group owner of the contents of\n            $CATALINA_HOME/conf/catalina.policy to tomcat_admin and tomcat, respectively.\n            # chmod 770 $CATALINA_HOME/conf/catalina.policy\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.policy",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/catalina.policy",
        "owner": "@TOMCAT_OWNER@",
        "mask": "007",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_14": {
        "system": "Linux",
        "description": "4.9 Restrict access to Tomcat catalina.properties",
        "info": "catalina.properties is a Java properties files that contains settings for Tomcat including class loader information, security package lists, and performance properties. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to catalina.properties:\n            1. Set the ownership of the $CATALINA_HOME/conf/catalina.properties to\n            tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.properties\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/catalina.properties",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/catalina.properties",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_15": {
        "system": "Linux",
        "description": "4.10 Restrict access to Tomcat context.xml",
        "info": "The context.xml file is loaded by all web applications and sets certain configuration options. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to context.xml:\n            1. Set the ownership of the $CATALINA_HOME/conf/context.xml to\n            tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/context.xml\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/context.xml",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/context.xml",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_16": {
        "system": "Linux",
        "description": "4.11 Restrict access to Tomcat logging.properties",
        "info": "logging.properties is a Tomcat files that specifies the logging configuration. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to logging.properties:\n            1. Set the ownership of the $CATALINA_HOME/conf/logging.properties to\n            tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/logging.properties\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/logging.properties",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_17": {
        "system": "Linux",
        "description": "4.12 Restrict access to Tomcat server.xml",
        "info": "server.xml contains Tomcat servlet definitions and configurations. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to server.xml:\n            1. Set the ownership of the $CATALINA_HOME/conf/server.xml to\n            tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/server.xml\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/server.xml",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_18": {
        "system": "Linux",
        "description": "4.13 Restrict access to Tomcat tomcat-users.xml",
        "info": "tomcat-users.xml contains authentication information for Tomcat applications. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to tomcat-users.xml:\n            1. Set the ownership of the $CATALINA_HOME/conf/tomcat-users.xml to\n            tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/tomcat-users.xml\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/tomcat-users.xml",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/tomcat-users.xml",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_19": {
        "system": "Linux",
        "description": "4.14 Restrict access to Tomcat web.xml",
        "info": "web.xml is a Tomcat configuration file that stores application configuration settings. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
        "solution": "Perform the following to restrict access to web.xml:\n            1. Set the ownership of the $CATALINA_HOME/conf/web.xml to tomcat_admin:tomcat.\n            2. Remove read, write, and execute permissions for the world.\n            3. Remove write permissions for the group.\n            # chown tomcat_admin:tomcat $CATALINA_HOME/conf/web.xml\n            # chmod g-w,o-rwx $CATALINA_HOME/conf/web.xml",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/web.xml",
        "owner": "@TOMCAT_OWNER@",
        "mask": "027",
        "file_type": "f",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_20": {
        "system": "Linux",
        "description": "6.2 Ensure SSLEnabled is set to True for Sensitive Connectors(verify SSLEnabled is set to true)",
        "info": "The SSLEnabled setting determines if SSL is enabled for a specific Connector. It is   recommended that SSL be utilized for any Connector that sends or receives sensitive information, such as authentication credentials or personal information.",
        "solution": "In server.xml, set the SSLEnabled attribute to true for each Connector that sends or receives sensitive information.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_21": {
        "system": "Linux",
        "description": "6.3 Ensure scheme is set accurately",
        "info": "The scheme attribute is used to indicate to callers of request.getScheme() which scheme is in use by the Connector. Ensure the scheme attribute is set to http for Connectors operating over HTTP. Ensure the scheme attribute is set to https for Connectors operating of HTTPS.",
        "solution": "In server.xml, set the Connector's scheme attribute to http for Connectors operating over HTTP. Set the Connector's scheme attribute to https for Connectors operating of HTTPS.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_22": {
        "system": "Linux",
        "description": "6.4 Ensure secure is set to true only for SSL-enabled Connectors (verify secure is set to true)",
        "info": "The secure attribute is used to convey Connector security status to applications operating over the Connector. This is typically achieved by calling request.isSecure(). Ensure the secure attribute is only set to true for Connectors operating with the SSLEnabled attribute set to true.",
        "solution": "For each Connector defined in server.xml, set the secure attribute to true for those Connectors having SSLEnabled set to true. Set the secure attribute set to false for those Connectors having SSLEnabled set to false",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_23": {
        "system": "Linux",
        "description": "6.5 Ensure sslProtocol is set to TLS for Secure Connectors (verify sslProtocol is set to TLS)",
        "info": "The sslProtocol setting determines which protocol Tomcat will use to protect traffic. It is recommended that sslProtocol attribute be set to TLS.",
        "solution": "In server.xml, set the sslProtocol attribute to 'TLS' for Connectors having SSLEnabled set to true.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_24": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if org.apache.juli.FileHandler exists in web application)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/@WEBAPP_NAME@/WEB-INF/classes/logging.properties",
        "regex": "handlers[\\\\s]*=[\\\\s]*.*org\\.apache\\.juli\\.FileHandler",
        "expect": "handlers[\\\\s]*=[\\\\s]*.*org\\.apache\\.juli\\.FileHandler"
    },
    "custom_item_25": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if org.apache.juli.FileHandler logging is enabled in web application)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/@WEBAPP_NAME@/WEB-INF/classes/logging.properties",
        "regex": "org\\.apache\\.juli\\.FileHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)",
        "expect": "org\\.apache\\.juli\\.FileHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)"
    },
    "custom_item_26": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if java.util.logging.ConsoleHandler exists in web application)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/@WEBAPP_NAME@/WEB-INF/classes/logging.properties",
        "regex": "handlers[\\\\s]*=[\\\\s]*.*java\\.util\\.logging\\.ConsoleHandler",
        "expect": "handlers[\\\\s]*=[\\\\s]*.*java\\.util\\.logging\\.ConsoleHandler"
    },
    "custom_item_27": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if java.util.logging.ConsoleHandler logging is enabled in web application)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/@WEBAPP_NAME@/WEB-INF/classes/logging.properties",
        "regex": "java\\.util\\.logging\\.ConsoleHandler\\.level\\\\s=\\\\s(@LOGGING_LEVEL@)",
        "expect": "java\\.util\\.logging\\.ConsoleHandler\\.level\\\\s=\\\\s(@LOGGING_LEVEL@)"
    },
    "custom_item_28": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if org.apache.juli.FileHandler exists in default)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "handlers[\\\\s]*=[\\\\s]*.*org\\.apache\\.juli\\.FileHandler",
        "expect": "handlers[\\\\s]*=[\\\\s]*.*org\\.apache\\.juli\\.FileHandler"
    },
    "custom_item_29": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if org.apache.juli.FileHandler logging is enabled in default)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "org\\.apache\\.juli\\.FileHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)",
        "expect": "org\\.apache\\.juli\\.FileHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)"
    },
    "custom_item_30": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if java.util.logging.ConsoleHandler exists inin default)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "handlers[\\\\s]*=[\\\\s]*.*java\\.util\\.logging\\.ConsoleHandler",
        "expect": "handlers[\\\\s]*=[\\\\s]*.*java\\.util\\.logging\\.ConsoleHandler"
    },
    "custom_item_31": {
        "system": "Linux",
        "description": "7.2 Specify file handler in logging.properties (check if java.util.logging.ConsoleHandler logging is enabled in default)",
        "info": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
        "solution": "Add the following entries to your logging.properties file if they do not exist.\n                handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\n            Ensure logging is not off and set the logging level to the desired level such as:\n                org.apache.juli.FileHandler.level=FINEST",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "java\\.util\\.logging\\.ConsoleHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)",
        "expect": "java\\.util\\.logging\\.ConsoleHandler\\.level[\\\\s]*=[\\\\s]*(@LOGGING_LEVEL@)"
    },
    "custom_item_32": {
        "system": "Linux",
        "description": "10.20 Use the logEffectiveWebXml and metadata-complete settings for deploying applications in production",
        "info": "Both Fragments and annotations give rise to security concerns. web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, ), web-fragment.xml as well as classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to log the effective web.xml, when an application starts, and the effective web.xml is the result of taking the main web.xml for your application merging in all the fragments applying all the annotations. By logging that you are able to review it, and see if that is in fact what you actually want.\n\n          NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.",
        "solution": "1. Set the metadata-complete value in the web.xml in each of applications to true, the web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, ...), web-fragment.xml as well as classes located in WEB-INF/classes. If set to true, all of these will be ignored and web.xml is the only metadata considered.\n\n          NOTE: The metadata-complete option is not enough to disable all of annotation scanning. If there is a ServletContainerInitializer with a @HandlesTypes annotation, Tomcat has to scan your application for classes that use annotations or interfaces specified in that annotation.\n\n          2. Set the logEffectiveWebXml value in the context.xml in each of applications to true.",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "/bin/df @CATALINA_HOME@ @WEBAPP_DIR@ | /bin/sed 1,1d | /usr/bin/sort -u | /usr/bin/wc -l",
        "file": "@BINARY_DIR@/catalina.sh",
        "owner": "@TOMCAT_OWNER@",
        "mask": "077",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@",
        "regex": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\"",
        "expect": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\"",
        "xsl_stmt": ""
    },
    "custom_item_33": {
        "system": "Linux",
        "description": "7.4 Ensure directory in context.xml is a secure location - permissions",
        "info": "The directory attribute tells Tomcat where to store logs. It is recommended that the location pointed to by the directory attribute is secured.",
        "solution": "1. Add the following statement into the $CATALINA_BASE\\webapps\\\\META-INF\\context.xml file if it does not already exist.2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx.\n                # chown tomcat_admin:tomcat $CATALINA_HOME/logs\n                # chmod o-rwx $CATALINA_HOME/logs",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@LOG_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "007",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_34": {
        "system": "Linux",
        "description": "10.20 Use the logEffectiveWebXml and metadata-complete settings for deploying applications in production",
        "info": "Both Fragments and annotations give rise to security concerns. web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, ), web-fragment.xml as well as classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to log the effective web.xml, when an application starts, and the effective web.xml is the result of taking the main web.xml for your application merging in all the fragments applying all the annotations. By logging that you are able to review it, and see if that is in fact what you actually want.\n\n          NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.",
        "solution": "1. Set the metadata-complete value in the web.xml in each of applications to true, the web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, ...), web-fragment.xml as well as classes located in WEB-INF/classes. If set to true, all of these will be ignored and web.xml is the only metadata considered.\n\n          NOTE: The metadata-complete option is not enough to disable all of annotation scanning. If there is a ServletContainerInitializer with a @HandlesTypes annotation, Tomcat has to scan your application for classes that use annotations or interfaces specified in that annotation.\n\n          2. Set the logEffectiveWebXml value in the context.xml in each of applications to true.",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "/bin/df @CATALINA_HOME@ @WEBAPP_DIR@ | /bin/sed 1,1d | /usr/bin/sort -u | /usr/bin/wc -l",
        "file": "@BINARY_DIR@/catalina.sh",
        "regex": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\"",
        "expect": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\"",
        "owner": "@TOMCAT_OWNER@",
        "mask": "077",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@",
        "xsl_stmt": ""
    },
    "custom_item_35": {
        "system": "Linux",
        "description": "7.6 Ensure directory in logging.properties is a secure location (check log directory location)",
        "info": "The directory attribute tells Tomcat where to store logs. The directory value should be a secure location with restricted access.",
        "solution": "Perform the following:\n            1. Add the following properties into your logging.properties file if they do not exist.org.apache.juli.FileHandler.directory=.org.apache.juli.FileHandler.prefix=2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx.\n                # chown tomcat_admin:tomcat# chmod o-rwx",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "@WEBAPP_NAME@\\.org\\.apache\\.juli\\.FileHandler\\.directory[\\\\s]*=[\\\\s]*@LOG_DIR@",
        "expect": "@WEBAPP_NAME@\\.org\\.apache\\.juli\\.FileHandler\\.directory[\\\\s]*=[\\\\s]*@LOG_DIR@"
    },
    "custom_item_36": {
        "system": "Linux",
        "description": "7.6 Ensure directory in logging.properties is a secure location (check prefix application name)",
        "info": "The directory attribute tells Tomcat where to store logs. The directory value should be a secure location with restricted access.",
        "solution": "Perform the following:\n            1. Add the following properties into your logging.properties file if they do not exist.org.apache.juli.FileHandler.directory=.org.apache.juli.FileHandler.prefix=2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx.\n                # chown tomcat_admin:tomcat# chmod o-rwx",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/logging.properties",
        "regex": "@WEBAPP_NAME@\\.org\\.apache\\.juli\\.FileHandler\\.prefix[\\\\s]*=[\\\\s]*@WEBAPP_NAME@",
        "expect": "@WEBAPP_NAME@\\.org\\.apache\\.juli\\.FileHandler\\.prefix[\\\\s]*=[\\\\s]*@WEBAPP_NAME@"
    },
    "custom_item_37": {
        "system": "Linux",
        "description": "7.6 Ensure directory in logging.properties is a secure location (check application log directory is secure)",
        "info": "The directory attribute tells Tomcat where to store logs. The directory value should be a secure location with restricted access.",
        "solution": "Perform the following:\n            1. Add the following properties into your logging.properties file if they do not exist.org.apache.juli.FileHandler.directory=.org.apache.juli.FileHandler.prefix=2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx.\n                # chown tomcat_admin:tomcat# chmod o-rwx",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@LOG_DIR@",
        "owner": "@TOMCAT_OWNER@",
        "mask": "077",
        "file_type": "d",
        "group": "@TOMCAT_GROUP@"
    },
    "custom_item_38": {
        "system": "Linux",
        "description": "8.1 Restrict runtime access to sensitive packages",
        "info": "package.access grants or revokes access to listed packages during runtime. It is recommended that application access to certain packages be restricted.\n\n          NOTE: Nessus did not perform this check as it requires a manual review of the outputted packages that have access. Review the reported packages to ensure only required packages are enabled.",
        "solution": "Edit $CATALINA_BASE/conf/catalina.properties by adding allowed packages to the package.access list.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "/bin/egrep 'package\\.access[\\s\\t]*=[\\s\\t]*(.*)' @CONFIG_DIR@/catalina.properties",
        "expect": ""
    },
    "custom_item_39": {
        "system": "Linux",
        "description": "9.1 Starting Tomcat with Security Manager",
        "info": "Configure application to run in a sandbox using the Security Manager. The Security Manager restrict what classes Tomcat can access thus protecting your server from mistakes, Trojans, and malicious code.\n\n          NOTE: This check looks at the $CATALINA_HOME/bin/startup.sh script to determine if -security is enabled when Tomcat is started. If your startup script is located in a different location, adjust this check to account for this.",
        "solution": "The security policies implemented by the Java SecurityManager are configured in the $CATALINA_HOME/conf/catalina.policy file. Once you have configured the catalina.policy file for use with a SecurityManager, Tomcat can be started with a SecurityManager in place by using the --security option:\n                $ $CATALINA_HOME/bin/catalina.sh start -security",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@/startup.sh",
        "regex": "\\-security",
        "expect": "\\-security"
    },
    "custom_item_40": {
        "system": "Linux",
        "description": "10.1 Ensure Web content directory is on a separate partition from the Tomcat system files (verify Web content directory)",
        "info": "The web document directory is where the files which are served to the end user reside. In the past, directory traversal exploits have allowed malicious users to play havoc on a web server including executing code, uploading files, and reading sensitive data. Even if you do not have any directory traversal exploits in your server or code at this time, that doesn't mean they won't be introduced in the future. Moving your web document directory onto a different partition will prevent these kinds of attacks from doing more damage to other part of the file system.",
        "solution": "Move the web content files to a separate partition from the tomcat system files and update your configuration.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1M,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "/bin/df @CATALINA_HOME@ @WEBAPP_DIR@ | /bin/sed 1,1d | /usr/bin/sort -u | /usr/bin/wc -l",
        "expect": "2"
    },
    "custom_item_41": {
        "system": "Linux",
        "description": "10.4 Force SSL when accessing the manager application",
        "info": "Use the transport-guarantee attribute to ensure SSL protection when accessing the manager application.",
        "solution": "Set $CATALINA_HOME/webapps/manager/WEB-INF/web.xml:CONFIDENTIAL",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/manager/WEB-INF/web.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_42": {
        "system": "Linux",
        "description": "10.6 Enable strict servlet Compliance",
        "info": "The STRICT_SERVLET_COMPLIANCE influences Tomcat's behavior in several subtle ways. See the References below for the complete list. It is recommended that STRICT_SERVLET_COMPLIANCE is set to true.",
        "solution": "Start Tomcat with strict compliance enabled. Add the following to your startup script:\n            -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@/catalina.sh",
        "regex": "-Dorg\\.apache\\.catalina\\.STRICT_SERVLET_COMPLIANCE[\\\\s]*=[\\\\s]*[Tt][Rr][Uu][Ee]",
        "expect": "-Dorg\\.apache\\.catalina\\.STRICT_SERVLET_COMPLIANCE[\\\\s]*=[\\\\s]*[Tt][Rr][Uu][Ee]"
    },
    "custom_item_43": {
        "system": "Linux",
        "description": "10.7 Turn off session facade recycling",
        "info": "The RECYCLE_FACADES can specify if a new facade will be created for each request. If a new facade is not created there is a potential for information leakage from other sessions.",
        "solution": "Start Tomcat with RECYCLE_FACADES set to true. Add the following to your startup script:\n            -Dorg.apache.catalina.connector.RECYCLE_FACADES=true",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@/catalina.sh",
        "regex": "-Dorg\\.apache\\.catalina\\.connector\\.RECYCLE_FACADES[\\\\s]*=[\\\\s]*[Tt][Rr][Uu][Ee]",
        "expect": "-Dorg\\.apache\\.catalina\\.connector\\.RECYCLE_FACADES[\\\\s]*=[\\\\s]*[Tt][Rr][Uu][Ee]"
    },
    "custom_item_44": {
        "system": "Linux",
        "description": "10.14 Do not allow symbolic linking",
        "info": "Symbolic links allow one application to include the libraries from another. This allows for re-use of code but also allows for potential security issues when applications include libraries from other applications they should not have access to.",
        "solution": "In all context.xml, set the allowLinking attribute to false.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/context.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_45": {
        "system": "Linux",
        "description": "10.15 Do not run applications as privileged",
        "info": "Setting the privileged attribute for an application changes the class loader to the Server class loader instead of the Shared class loader.",
        "solution": "In all context.xml, set the privileged attribute to false unless it is required like the manager application:",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/context.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_46": {
        "system": "Linux",
        "description": "10.16 Do not allow cross context requests",
        "info": "Setting crossContext to true allows for an application to call ServletConext.getContext to return a dispatcher for another application.",
        "solution": "In all context.xml, set the crossContext attribute to false:",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/context.xml",
        "xsl_stmt": "",
        "regex": "PASS",
        "expect": "PASS"
    },
    "custom_item_47": {
        "system": "Linux",
        "description": "10.18 Enable memory leak listener (verify present)",
        "info": "The JRE Memory Leak Prevention Listener provides work-arounds for known places where the Java Runtime environment uses the context class loader to load a singleton as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The work-around is to initialise these singletons when this listener starts as Tomcat's common class loader is the context class loader at that time. It also provides work-arounds for known issues that can result in locked JAR files.",
        "solution": "Uncomment the JRE Memory Leak Prevention Listener in $CATALINA_HOME/conf/server.xml",
        "reference": "800-53|SI-16,800-53r5|SI-16,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_48": {
        "system": "Linux",
        "description": "10.19 Setting Security Lifecycle Listener (check for config component)",
        "info": "The Security Lifecycle Listener performs a number of security checks when Tomcat starts and prevents Tomcat from starting if they fail.",
        "solution": "To enable it uncomment the listener in $CATALINA_BASE/conf/server.xml. If the operating system supports umask then the line in $CATALINA_HOME/bin/catalina.sh that obtains the umask also needs to be uncommented.\n\n          Within Server elements add:\n            - checkedOsUsers: A comma separated list of OS users that must not be used to start Tomcat. If not specified, the default value of root is used.\n            - minimumUmask: The least restrictive umask that must be configured before Tomcat will start. If not specified, the default value of 0007 is used.",
        "reference": "800-53|SI-10(3),800-53r5|SI-10(3),CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|1S,NESA|T7.3.1,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_49": {
        "system": "Linux",
        "description": "10.19 Setting Security Lifecycle Listener (check for umask uncommented in startup)",
        "info": "The Security Lifecycle Listener performs a number of security checks when Tomcat starts and prevents Tomcat from starting if they fail.",
        "solution": "To enable it uncomment the listener in $CATALINA_BASE/conf/server.xml. If the operating system supports umask then the line in $CATALINA_HOME/bin/catalina.sh that obtains the umask also needs to be uncommented.\n\n          Within Server elements add:\n            - checkedOsUsers: A comma separated list of OS users that must not be used to start Tomcat. If not specified, the default value of root is used.\n            - minimumUmask: The least restrictive umask that must be configured before Tomcat will start. If not specified, the default value of 0007 is used.",
        "reference": "800-171|3.1.1,800-53|AC-3(4)(d),800-53r5|AC-3(4)(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(4),LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@/catalina.sh",
        "regex": "^\\s*#\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=.*\"",
        "expect": "^\\s*#\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=.*\""
    },
    "custom_item_50": {
        "system": "Linux",
        "description": "10.19 Setting Security Lifecycle Listener (check for umask present in startup)",
        "info": "The Security Lifecycle Listener performs a number of security checks when Tomcat starts and prevents Tomcat from starting if they fail.",
        "solution": "To enable it uncomment the listener in $CATALINA_BASE/conf/server.xml. If the operating system supports umask then the line in $CATALINA_HOME/bin/catalina.sh that obtains the umask also needs to be uncommented.\n\n          Within Server elements add:\n            - checkedOsUsers: A comma separated list of OS users that must not be used to start Tomcat. If not specified, the default value of root is used.\n            - minimumUmask: The least restrictive umask that must be configured before Tomcat will start. If not specified, the default value of 0007 is used.",
        "reference": "800-171|3.1.1,800-53|AC-3(4)(d),800-53r5|AC-3(4)(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(4),LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@BINARY_DIR@/catalina.sh",
        "regex": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\"",
        "expect": "^\\s*JAVA_OPTS=\"\\$JAVA_OPTS -Dorg\\.apache\\.catalina\\.security\\.SecurityListener\\.UMASK=\\d{3,4}\""
    }
}