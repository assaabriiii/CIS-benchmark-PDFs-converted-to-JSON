{
    "custom_item_1": {
        "description": "MacOS 11 is installed",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_2": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Files to Not Contain Access Control Lists",
        "info": "The audit log files _MUST_ not contain access control lists (ACLs).\n\nThis rule ensures that audit information and audit files are configured to be readable and writable only by system administrators, thereby preventing unauthorized access, modification, and deletion of files.",
        "solution": "[source,bash]\n----\n/bin/chmod -RN $(/usr/bin/awk -F: '/^dir/{print $2}' /etc/security/audit_control)\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53|SI-11,800-53|SI-11b.,800-53r5|AU-9,800-53r5|SI-11,800-53r5|SI-11b.,CCE|CCE-85251-7,CCI|CCI-000162,CCI|CCI-001314,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|SI-11,ITSG-33|SI-11c.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-000030",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -le $(/usr/bin/awk -F: '/^dir/{print $2}' /etc/security/audit_control) | /usr/bin/awk '{print $1}' | /usr/bin/grep -c \":\"",
        "expect": "0"
    },
    "custom_item_3": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Folder to Not Contain Access Control Lists",
        "info": "The audit log folder _MUST_ not contain access control lists (ACLs).\n\nAudit logs contain sensitive data about the system and users. This rule ensures that the audit service is configured to create log folders that are readable and writable only by system administrators in order to prevent normal users from reading audit logs.",
        "solution": "[source,bash]\n----\n/bin/chmod -N $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85252-5,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-000031",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -lde $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $1}' | /usr/bin/grep -c \":\"",
        "expect": "0"
    },
    "custom_item_4": {
        "system": "Darwin",
        "description": "Big Sur - Enable Security Auditing",
        "info": "The information system _MUST_ be configured to generate audit records.\n\nAudit records establish what types of events have occurred, when they occurred, and which users were involved. These records aid an organization in their efforts to establish, correlate, and investigate the events leading up to an outage or attack.\n\nThe content required to be captured in an audit record varies based on the impact level of an organization's system. Content that may be necessary to satisfy this requirement includes, for example, time stamps, source addresses, destination addresses, user identifiers, event descriptions, success/fail indications, filenames involved, and access or flow control rules invoked.\n\nThe information system initiates session audits at system start-up.\n\nNOTE: Security auditing is enabled by default on macOS.",
        "solution": "[source,bash]\n----\n/bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist\n----",
        "reference": "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.3.7,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(4),800-53|AU-3,800-53|AU-3(1),800-53|AU-8,800-53|AU-8a.,800-53|AU-8b.,800-53|AU-12,800-53|AU-12(1),800-53|AU-12(3),800-53|AU-14(1),800-53|CM-5(1),800-53|MA-4(1),800-53r5|AC-2(4),800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-8,800-53r5|AU-8a.,800-53r5|AU-8b.,800-53r5|AU-12,800-53r5|AU-12(1),800-53r5|AU-12(3),800-53r5|AU-14(1),800-53r5|CM-5(1),800-53r5|MA-4(1),CCE|CCE-85254-1,CCI|CCI-000130,CCI|CCI-000131,CCI|CCI-000132,CCI|CCI-000133,CCI|CCI-000134,CCI|CCI-000135,CCI|CCI-000159,CCI|CCI-001464,CCI|CCI-001487,CCI|CCI-001889,CCI|CCI-001890,CCI|CCI-001914,CCI|CCI-002130,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-8,ITSG-33|AU-8a.,ITSG-33|AU-12,ITSG-33|AU-12(1),ITSG-33|AU-14,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.7,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001003,SWIFT-CSCv1|6.4,TBA-FIISB|36.2.3,TBA-FIISB|37.4,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c com.apple.auditd",
        "expect": "1"
    },
    "custom_item_5": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Shut Down Upon Audit Failure",
        "info": "The audit service _MUST_ be configured to shut down the computer if it is unable to audit system events.\n\nOnce audit failure occurs, user and system activity are no longer recorded, and malicious activity could go undetected. Audit processing failures can occur due to software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.",
        "solution": "[source,bash]\n----\n/usr/bin/sed -i.bak 's/^policy.*/policy: ahlt,argv/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-171|3.3.4,800-53|AU-5,800-53|AU-5b.,800-53r5|AU-5,800-53r5|AU-5b.,CCE|CCE-85257-4,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5,ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001010",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^policy/ {print $NF}' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'ahlt'",
        "expect": "1"
    },
    "custom_item_6": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Files Group to Wheel",
        "info": "Audit log files _MUST_ have the group set to wheel.\n\nThe audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.",
        "solution": "[source,bash]\n----\n/usr/bin/chgrp -R wheel $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')/*\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85258-2,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001014",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$4} END {print s}'",
        "expect": "0"
    },
    "custom_item_7": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Files to Mode 440 or Less Permissive",
        "info": "The audit service _MUST_ be configured to create log files that are readable only by the root user and group wheel. To achieve this, audit log files _MUST_ be configured to mode 440 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.",
        "solution": "[source,bash]\n----\n/bin/chmod 440 $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')/*\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85259-0,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001016",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -l $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '",
        "expect": "0"
    },
    "custom_item_8": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Files to be Owned by Root",
        "info": "Audit log files _MUST_ be owned by root.\n\nThe audit service _MUST_ be configured to create log files with the correct ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.",
        "solution": "[source,bash]\n----\n/usr/sbin/chown -R root $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')/*\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85260-8,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001012",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$3} END {print s}'",
        "expect": "0"
    },
    "custom_item_9": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Authorization and Authentication Events",
        "info": "The auditing system _MUST_ be configured to flag authorization and authentication (aa) events.\n\nAuthentication events contain information about the identity of a user, server, or client. Authorization events contain information about permissions, rights, and rules. If audit records do not include aa events, it is difficult to identify incidents and to correlate incidents to subsequent events.\n\nAudit records can be generated from various components within the information system (e.g., via a module or policy filter).",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*[^-]aa\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(12),800-53|AU-2,800-53|AU-12,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1),800-53r5|AC-2(12),800-53r5|AU-2,800-53r5|AU-12,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1),CCE|CCE-85261-6,CCI|CCI-000172,CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-2,ITSG-33|AU-2,ITSG-33|AU-12,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.3.1,NESA|M5.5.1,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM8,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001044,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'aa'",
        "expect": "1"
    },
    "custom_item_10": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Administrative Action Events",
        "info": "The auditing system _MUST_ be configured to flag administrative action (ad) events.\n\nAdministrative action events include changes made to the system (e.g. modifying authentication policies). If audit records do not include ad events, it is difficult to identify incidents and to correlate incidents to subsequent events.\n\nAudit records can be generated from various components within the information system (e.g., via a module or policy filter).\n\nThe information system audits the execution of privileged functions.\n\nNOTE: We recommend changing the line \"43127:AUE_MAC_SYSCALL:mac_syscall(2):ad\" to \"43127:AUE_MAC_SYSCALL:mac_syscall(2):zz\" in the file /etc/security/audit_event. This will prevent sandbox violations from being audited by the ad flag.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*[^-]ad\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.1.7,800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(4),800-53|AC-2(12),800-53|AC-6(9),800-53|AU-2,800-53|AU-12,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1),800-53|MA-4(1)(a),800-53r5|AC-2(4),800-53r5|AC-2(12),800-53r5|AC-6(9),800-53r5|AU-2,800-53r5|AU-12,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1),800-53r5|MA-4(1)(a),CCE|CCE-85262-4,CCI|CCI-000018,CCI|CCI-000172,CCI|CCI-001403,CCI|CCI-001404,CCI|CCI-001405,CCI|CCI-002234,CCI|CCI-002884,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.2(d),CN-L3|8.1.4.3(a),CN-L3|8.1.10.6(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.3,ITSG-33|AC-2,ITSG-33|AC-2(4),ITSG-33|AC-6,ITSG-33|AU-2,ITSG-33|AU-12,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.3.1,NESA|M5.5.1,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM7,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM23f,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM8,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001001,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|36.2.3,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'ad'",
        "expect": "1"
    },
    "custom_item_11": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Failed Program Execution on the System",
        "info": "The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed program execute (-ex) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using program execution restrictions (e.g., denying users access to execute certain processes).\n\nThis configuration ensures that audit lists include events in which program execution has failed.\nWithout auditing the enforcement of program execution, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*-ex\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-ex/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-53|AC-2(12),800-53|AU-2,800-53|AU-12,800-53|CM-5(1),800-53r5|AC-2(12),800-53r5|AU-2,800-53r5|AU-12,800-53r5|CM-5(1),CCE|CCE-85263-2,CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|AU-2,ITSG-33|AU-12,ITSG-33|CM-5(1),NESA|M1.2.2,NESA|M5.3.1,NESA|M5.5.1,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-ex'",
        "expect": "1"
    },
    "custom_item_12": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Failed Change of Object Attributes",
        "info": "The audit system _MUST_ be configured to record enforcement actions of failed attempts to modify file attributes (fm).\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to modify a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*-fm\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fm/' /etc/security/audit_control;/usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(12),800-53|AU-2,800-53|AU-9,800-53|AU-12,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1),800-53r5|AC-2(12),800-53r5|AU-2,800-53r5|AU-9,800-53r5|AU-12,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1),CCE|CCE-85264-0,CCI|CCI-000172,CCI|CCI-001814,CN-L3|7.1.2.3(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AU-2,ITSG-33|AU-9,ITSG-33|AU-12,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.3.1,NESA|M5.5.1,NESA|M5.5.2,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NESA|T8.2.9,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fm'",
        "expect": "1"
    },
    "custom_item_13": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Failed Read Actions on the System",
        "info": "The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file read (-fr) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying access to a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to read a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*-fr\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fr/' /etc/security/audit_control;/usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(12),800-53|AU-2,800-53|AU-9,800-53|AU-12,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1),800-53r5|AC-2(12),800-53r5|AU-2,800-53r5|AU-9,800-53r5|AU-12,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1),CCE|CCE-85265-7,CCI|CCI-000172,CCI|CCI-001814,CN-L3|7.1.2.3(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AU-2,ITSG-33|AU-9,ITSG-33|AU-12,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.3.1,NESA|M5.5.1,NESA|M5.5.2,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NESA|T8.2.9,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fr'",
        "expect": "1"
    },
    "custom_item_14": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Failed Write Actions on the System",
        "info": "The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file write (-fw) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying users access to edit a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to change a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*-fw\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fw/' /etc/security/audit_control;/usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(12),800-53|AU-2,800-53|AU-9,800-53|AU-12,800-53|CM-5(1),800-53|MA-4(1),800-53r5|AC-2(12),800-53r5|AU-2,800-53r5|AU-9,800-53r5|AU-12,800-53r5|CM-5(1),800-53r5|MA-4(1),CCE|CCE-85266-5,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AU-2,ITSG-33|AU-9,ITSG-33|AU-12,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.3.1,NESA|M5.5.1,NESA|M5.5.2,NESA|T2.3.4,NESA|T3.6.4,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NESA|T8.2.9,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001020,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fw'",
        "expect": "1"
    },
    "custom_item_15": {
        "system": "Darwin",
        "description": "Big Sur - Configure System to Audit All Log In and Log Out Events",
        "info": "The audit system _MUST_ be configured to record all attempts to log in and out of the system (lo).\n\nFrequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing both successful and unsuccessful attempts to switch to another user account (by way of monitoring login and logout events) mitigates this risk.\n\nThe information system monitors login and logout events.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -qE \"^flags.*[^-]lo\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-171|3.1.2,800-171|3.1.12,800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AC-2(12),800-53|AC-17(1),800-53|AU-2,800-53|AU-12,800-53|AU-12c.,800-53|MA-4(1),800-53r5|AC-2(12),800-53r5|AC-17(1),800-53r5|AU-2,800-53r5|AU-12,800-53r5|AU-12c.,800-53r5|MA-4(1),CCE|CCE-85267-3,CCI|CCI-000067,CCI|CCI-000172,CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.MA-2,CSF|PR.PT-1,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-2,ITSG-33|AC-17(1),ITSG-33|AU-2,ITSG-33|AU-12,ITSG-33|AU-12c.,ITSG-33|MA-4(1),NESA|M1.2.2,NESA|M5.3.1,NESA|M5.5.1,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.4.4,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM28,NIAv2|NS5j,NIAv2|SM8,NIAv2|SS14e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-001002,SWIFT-CSCv1|2.6,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'lo'",
        "expect": "1"
    },
    "custom_item_16": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Folders to Mode 700 or Less Permissive",
        "info": "The audit log folder _MUST_ be configured to mode 700 or less permissive so that only the root user is able to read, write, and execute changes to folders.\n\nBecause audit logs contain sensitive data about the system and users, the audit service _MUST_ be configured to mode 700 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.",
        "solution": "[source,bash]\n----\n/bin/chmod 700 $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85270-7,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001017",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/stat -f %A $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')",
        "expect": "700"
    },
    "custom_item_17": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Folders Group to Wheel",
        "info": "Audit log files _MUST_ have the group set to wheel.\n\nThe audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.",
        "solution": "[source,bash]\n----\n/usr/bin/chgrp wheel $(/usr/bin/awk -F : '/^dir/{print $2}' /etc/security/audit_control)\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85268-1,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001015",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $4}'",
        "expect": "0"
    },
    "custom_item_18": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Log Folders to be Owned by Root",
        "info": "Audit log files _MUST_ be owned by root.\n\nThe audit service _MUST_ be configured to create log files with the correct ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.",
        "solution": "[source,bash]\n----\n/usr/sbin/chown root $(/usr/bin/awk -F : '/^dir/{print $2}' /etc/security/audit_control)\n----",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CCE|CCE-85269-9,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001013",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $3}'",
        "expect": "0"
    },
    "custom_item_19": {
        "system": "Darwin",
        "description": "Big Sur - Configure Audit Retention to a Minimum of Seven Days",
        "info": "The audit service _MUST_ be configured to require records be kept for seven days or longer before deletion, unless the system uses a central audit record storage facility.\n\nWhen \"expire-after\" is set to \"7d\", the audit service will not delete audit logs until the log data is at least seven days old.",
        "solution": "[source,bash]\n----\n/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/sbin/audit -s\n----",
        "reference": "800-53|AU-4,800-53|AU-11,800-53r5|AU-4,800-53r5|AU-11,CCE|CCE-85272-3,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.3.1,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-001029",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control",
        "expect": "7d"
    },
    "custom_item_20": {
        "system": "Darwin",
        "description": "Big Sur - Enforce Multifactor Authentication for Login",
        "info": "The system _MUST_ be configured to enforce multifactor authentication.\n\nAll users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nNOTE: /etc/pam.d/login will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "[source,bash]\n----\n/bin/cat > /etc/pam.d/login << LOGIN_END\n# login: auth account password session\nauth        sufficient    pam_smartcard.so\nauth        optional      pam_krb5.so use_kcminit\nauth        optional      pam_ntlm.so try_first_pass\nauth        optional      pam_mount.so try_first_pass\nauth        required      pam_opendirectory.so try_first_pass\nauth        required      pam_deny.so\naccount     required      pam_nologin.so\naccount     required      pam_opendirectory.so\npassword    required      pam_opendirectory.so\nsession     required      pam_launchd.so\nsession     required      pam_uwtmp.so\nsession     optional      pam_mount.so\nLOGIN_END\n\n\n/bin/chmod 644 /etc/pam.d/login\n/usr/sbin/chown root:wheel /etc/pam.d/login\n----",
        "reference": "800-171|3.4.2,800-171|3.5.3,800-171|3.5.4,800-53|CM-6b.,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(8),800-53r5|CM-6b.,800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(3),800-53r5|IA-2(4),800-53r5|IA-2(8),800-53r5|IA-5(11),CCE|CCE-85274-9,CCI|CCI-000366,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003050,SWIFT-CSCv1|1.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_deny.so)' /etc/pam.d/login",
        "expect": "2"
    },
    "custom_item_21": {
        "system": "Darwin",
        "description": "Big Sur - Enforce Multifactor Authentication for Privilege Escalation Through the sudo Command",
        "info": "The system _MUST_ be configured to enforce multifactor authentication when the sudo command is used to elevate privilege.\n\nAll users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nNOTE: /etc/pam.d/sudo will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "[source,bash]\n----\n\n/bin/cat > /etc/pam.d/sudo << SUDO_END\n# sudo: auth account password session\nauth        sufficient    pam_smartcard.so\nauth        required      pam_opendirectory.so\nauth        required      pam_deny.so\naccount     required      pam_permit.so\npassword    required      pam_deny.so\nsession     required      pam_permit.so\nSUDO_END\n\n/bin/chmod 444 /etc/pam.d/sudo\n/usr/sbin/chown root:wheel /etc/pam.d/sudo\n----",
        "reference": "800-171|3.4.2,800-171|3.5.3,800-171|3.5.4,800-53|CM-6b.,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(8),800-53r5|CM-6b.,800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(3),800-53r5|IA-2(4),800-53r5|IA-2(8),800-53r5|IA-5(11),CCE|CCE-85276-4,CCI|CCI-000366,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003052,SWIFT-CSCv1|1.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_deny.so)' /etc/pam.d/sudo",
        "expect": "2"
    },
    "custom_item_22": {
        "system": "Darwin",
        "description": "Big Sur - Enforce Multifactor Authentication for the su Command",
        "info": "The system _MUST_ be configured such that, when the su command is used, multifactor authentication is enforced.\n\nAll users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nNOTE: /etc/pam.d/su will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "[source,bash]\n----\n/bin/cat > /etc/pam.d/su << SU_END\n# su: auth account password session\nauth        sufficient    pam_smartcard.so\nauth        required      pam_rootok.so\nauth        required      pam_group.so no_warn group=admin,wheel ruser root_only fail_safe\naccount     required      pam_permit.so\naccount     required      pam_opendirectory.so no_check_shell\npassword    required      pam_opendirectory.so\nsession     required      pam_launchd.so\nSU_END\n\n# Fix new file ownership and permissions\n/bin/chmod 644 /etc/pam.d/su\n/usr/sbin/chown root:wheel /etc/pam.d/su\n----",
        "reference": "800-171|3.4.2,800-171|3.5.3,800-171|3.5.4,800-53|CM-6b.,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(8),800-53r5|CM-6b.,800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(3),800-53r5|IA-2(4),800-53r5|IA-2(8),800-53r5|IA-5(11),CCE|CCE-85275-6,CCI|CCI-000366,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T3.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003051,SWIFT-CSCv1|1.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_rootok.so)' /etc/pam.d/su",
        "expect": "2"
    },
    "custom_item_23": {
        "system": "Darwin",
        "description": "Big Sur - Allow Smartcard Authentication",
        "info": "Smartcard authentication _MUST_ be allowed.\n\nThe use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWhen enabled, the smartcard can be used for login, authorization, and screen saver unlocking.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.security.smartcard:\n  allowSmartCard:\n    True",
        "reference": "800-171|3.5.1,800-171|3.5.3,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(12),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(12),800-53r5|IA-5(11),CCE|CCE-85277-2,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowSmartCard = 1'",
        "expect": "1"
    },
    "custom_item_24": {
        "system": "Darwin",
        "description": "Big Sur - Enforce Smartcard Authentication",
        "info": "Smartcard authentication _MUST_ be enforced.\n\nThe use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWhen enforceSmartCard is set to \"true\", the smartcard must be used for login, authorization, and unlocking the screensaver.\n\nCAUTION: enforceSmartCard will apply to the whole system. No users will be able to login with their password unless the profile is removed or a user is exempt from smartcard enforcement.\n\nNOTE: enforceSmartcard requires allowSmartcard to be set to true in order to work.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.security.smartcard:\n  enforceSmartCard:\n    True",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.3,800-171|3.5.4,800-53|IA-2,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(6),800-53|IA-2(8),800-53|IA-2(12),800-53|IA-5(2),800-53|IA-5(2)(c),800-53r5|IA-2,800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(3),800-53r5|IA-2(4),800-53r5|IA-2(6),800-53r5|IA-2(8),800-53r5|IA-2(11),800-53r5|IA-2(12),800-53r5|IA-5(2),800-53r5|IA-5(2)(c),800-53r5|IA-5(11),CCE|CCE-85280-6,CCI|CCI-000187,CCI|CCI-000767,CCI|CCI-000768,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(6),ITSG-33|IA-2(8),ITSG-33|IA-5(2),ITSG-33|IA-5(2)(c),NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003020,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'enforceSmartCard = 1'",
        "expect": "1"
    },
    "custom_item_25": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Address Book",
        "info": "The macOS built-in Contacts.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data, and, therefore, automated contact synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudAddressBook:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85282-2,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002014,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudAddressBook = 0'",
        "expect": "1"
    },
    "custom_item_26": {
        "system": "Darwin",
        "description": "Big Sur - Disable the System Preference Pane for Apple ID",
        "info": "The system preference pane for Apple ID _MUST_ be disabled.\n\nDisabling the system preference pane prevents login to Apple ID and iCloud.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.systempreferences:\n  DisabledPreferencePanes:\n    com.apple.preferences.AppleIDPrefPane",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7(1),800-53|CM-7(5)(b),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),CCE|CCE-85283-0,CCI|CCI-001774,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002031,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'com.apple.preferences.AppleID'",
        "expect": "1"
    },
    "custom_item_27": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Bookmarks",
        "info": "The macOS built-in Safari.app bookmark synchronization via the iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated bookmark synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudBookmarks:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85284-8,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002042,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudBookmarks = 0'",
        "expect": "1"
    },
    "custom_item_28": {
        "system": "Darwin",
        "description": "Big Sur - Disable the iCloud Calendar Services",
        "info": "The macOS built-in Calendar.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudCalendar:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85285-5,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002012,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudCalendar = 0'",
        "expect": "1"
    },
    "custom_item_29": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Document Sync",
        "info": "The macOS built-in iCloud document synchronization service _MUST_ be disabled to prevent organizational data from being synchronized to personal or non-approved storage.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated document synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudDocumentSync:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85286-3,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002041,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudDocumentSync = 0'",
        "expect": "1"
    },
    "custom_item_30": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Keychain Sync",
        "info": "The macOS system's ability to automatically synchronize a user's passwords to their iCloud account _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, password management and synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudKeychainSync:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85287-1,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002040,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudKeychainSync = 0'",
        "expect": "1"
    },
    "custom_item_31": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Mail",
        "info": "The macOS built-in Mail.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated mail synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudMail:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85288-9,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002015,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudMail = 0'",
        "expect": "1"
    },
    "custom_item_32": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Notes",
        "info": "The macOS built-in Notes.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated Notes synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudNotes:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85289-7,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002016,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudNotes = 0'",
        "expect": "1"
    },
    "custom_item_33": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Photo Library",
        "info": "The macOS built-in Photos.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated photo synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudPhotoLibrary:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85290-5,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002043,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudPhotoLibrary = 0'",
        "expect": "1"
    },
    "custom_item_34": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Reminders",
        "info": "The macOS built-in Reminders.app connection to Apple's iCloud service _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated reminders synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudReminders:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85291-3,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002013,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudReminders = 0'",
        "expect": "1"
    },
    "custom_item_35": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Desktop and Document Folder Sync",
        "info": "The macOS system's ability to automatically synchronize a user's desktop and documents folder to their iCloud Drive _MUST_ be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated file synchronization _MUST_ be controlled by an organization approved service.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowCloudDesktopAndDocuments:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|AC-20,800-53|AC-20(1),800-53|CM-7,800-53|CM-7(1),800-53|SC-7(10),800-53r5|AC-20,800-53r5|AC-20(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7(10),CCE|CCE-85292-1,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|AC-20(1),ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|M4.2.2,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowCloudDesktopAndDocuments = 0'",
        "expect": "1"
    },
    "custom_item_36": {
        "system": "Darwin",
        "description": "Big Sur - Disable AirDrop",
        "info": "AirDrop _MUST_ be disabled to prevent file transfers to or from unauthorized devices.\nAirDrop allows users to share and receive files from other nearby Apple devices.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowAirDrop:\n    False",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.1.16,800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53r5|AC-3,800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),CCE|CCE-85293-9,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002009,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowAirDrop = 0'",
        "expect": "1"
    },
    "custom_item_37": {
        "system": "Darwin",
        "description": "Big Sur - Disable Apple ID Setup during Setup Assistant",
        "info": "The prompt for Apple ID setup during Setup Assistant _MUST_ be disabled.\n\nmacOS will automatically prompt new users to set up an Apple ID while they are going through Setup Assistant if this is not disabled, misleading new users to think they need to create Apple ID accounts upon their first login.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.SetupAssistant.managed:\n  SkipCloudSetup:\n    True",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-20,800-53|CM-7a.,800-53r5|AC-20,800-53r5|CM-7a.,CCE|CCE-85296-2,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,ITSG-33|CM-7a.,NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002035,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'SkipCloudSetup = 1'",
        "expect": "1"
    },
    "custom_item_38": {
        "system": "Darwin",
        "description": "Big Sur - Enable Authenticated Root",
        "info": "Authenticated Root _MUST_ be enabled.\n\nWhen Authenticated Root is enabled the macOS is booted from a signed volume that is cryptographically protected to prevent tampering with the system volume.\n\nNOTE: Authenticated Root is enabled by default on macOS systems.",
        "solution": "[source,bash]\n----\n/usr/bin/csrutil authenticated-root enable\n----\nNOTE: To re-enable \"Authenticated Root\", boot the affected system into \"Recovery\" mode, launch \"Terminal\" from the \"Utilities\" menu, and run the command.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.5,800-171|3.7.5,800-53|AC-3,800-53|CM-5,800-53|MA-4(1),800-53|SC-34,800-53|SI-7,800-53|SI-7(6),800-53r5|AC-3,800-53r5|CM-5,800-53r5|MA-4(1),800-53r5|SC-34,800-53r5|SI-7,800-53r5|SI-7(6),CCE|CCE-85298-8,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|CM-5,ITSG-33|MA-4(1),ITSG-33|SC-34,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|T2.3.4,NESA|T3.2.3,NESA|T3.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.3,NIAv2|AM3,NIAv2|SS29,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|13.2,SWIFT-CSCv1|6.2,SWIFT-CSCv1|6.4,TBA-FIISB|31.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/csrutil authenticated-root | /usr/bin/grep -c 'enabled'",
        "expect": "1"
    },
    "custom_item_39": {
        "system": "Darwin",
        "description": "Big Sur - Disable Bonjour Multicast",
        "info": "Bonjour multicast advertising _MUST_ be disabled to prevent the system from broadcasting its presence and available services over network interfaces.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mDNSResponder:\n  NoMulticastAdvertisements:\n    True",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),CCE|CCE-85299-6,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,STIG-ID|APPL-11-002005,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'NoMulticastAdvertisements = 1'",
        "expect": "1"
    },
    "custom_item_40": {
        "system": "Darwin",
        "description": "Big Sur - Disable Calendar.app",
        "info": "The macOS built-in Calendar.app _MUST_ be disabled as this application can establish a connection to non-approved services. This rule is in place to prevent inadvertent data transfers.\n\n[IMPORTANT]\n====\nSome organizations allow the use of the built-in Calendar.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Mail.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.\n====",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess.new:\n  familyControlsEnabled:\n    True\n  pathBlackList:\n    /Applications/Calendar.app",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),CCE|CCE-85300-2,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002023,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -A 20 familyControlsEnabled | /usr/bin/grep -c \"/Applications/Calendar.app\"",
        "expect": "1"
    },
    "custom_item_41": {
        "system": "Darwin",
        "description": "Big Sur - Disable FaceTime.app",
        "info": "The macOS built-in FaceTime.app _MUST_ be disabled.\n\nThe FaceTime.app establishes a connection to Apple's iCloud service, even when security controls have been put in place to disable iCloud access.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess.new:\n  familyControlsEnabled:\n    True\n  pathBlackList:\n    /Applications/FaceTime.app",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),CCE|CCE-85308-5,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002010,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -A 20 familyControlsEnabled | /usr/bin/grep -c \"/Applications/FaceTime.app\"",
        "expect": "1"
    },
    "custom_item_42": {
        "system": "Darwin",
        "description": "Big Sur - Disable FileVault Automatic Login",
        "info": "If FileVault is enabled, automatic login _MUST_ be disabled, so that both FileVault and login window authentication are required.\n\nThe default behavior of macOS when FileVault is enabled is to automatically log in to the computer once successfully passing your FileVault credentials.\n\nNOTE: DisableFDEAutoLogin does not have to be set on Apple Silicon based macOS systems that are smartcard enforced as smartcards are available at pre-boot.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.loginwindow:\n  DisableFDEAutoLogin:\n    True",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.5.2,800-53|AC-2(11),800-53|AC-3,800-53|IA-5(13),800-53r5|AC-2(11),800-53r5|AC-3,800-53r5|IA-5(13),CCE|CCE-85310-1,CCI|CCI-002143,CN-L3|8.1.4.1(b),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|IA-5,NESA|T4.2.1,NESA|T5.2.3,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-000033,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'DisableFDEAutoLogin = 1'",
        "expect": "1"
    },
    "custom_item_43": {
        "system": "Darwin",
        "description": "Big Sur - Enable Firewall Logging",
        "info": "Firewall logging _MUST_ be enabled.\n\nFirewall logging ensures that malicious network activity will be logged to the system.\n\nNOTE: The firewall data is logged to Apple's Unified Logging with the subsystem com.apple.alf and the data is marked as private.",
        "solution": "[source,bash]\n----\n/usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on\n----",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AU-12,800-53|SC-7,800-53r5|AU-12,800-53r5|SC-7,CCE|CCE-85313-5,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.13.1.3,ITSG-33|AU-12,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|43.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getloggingmode | /usr/bin/grep -c \"Log mode is on\"",
        "expect": "1"
    },
    "custom_item_44": {
        "system": "Darwin",
        "description": "Big Sur - Disable Handoff",
        "info": "Handoff _MUST_ be disabled.\n\nHandoff allows you to continue working on a document or project when the user switches from one Apple device to another. Disabling Handoff prevents data transfers to unauthorized devices.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowActivityContinuation:\n    False",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-20,800-53|CM-7,800-53|CM-7(1),800-53r5|AC-3,800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85321-8,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowActivityContinuation = 0'",
        "expect": "1"
    },
    "custom_item_45": {
        "system": "Darwin",
        "description": "Big Sur - Disable the Built-in Web Server",
        "info": "The built-in web server is a non-essential service built into macOS and _MUST_ be disabled.\n\nNOTE: The built in web server service is disabled at startup by default macOS.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/org.apache.httpd\n----",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-17,800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7a.,CCE|CCE-85323-4,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002008,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"org.apache.httpd\" => true'",
        "expect": "1"
    },
    "custom_item_46": {
        "system": "Darwin",
        "description": "Big Sur - Disable iCloud Storage Setup during Setup Assistant",
        "info": "The prompt to set up iCloud storage services during Setup Assistant _MUST_ be disabled.\n\nThe default behavior of macOS is to prompt new users to set up storage in iCloud. Disabling the iCloud storage setup prompt provides organizations more control over the storage of their data.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.SetupAssistant.managed:\n  SkipiCloudStorageSetup:\n    True",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-20,800-53|CM-7a.,800-53r5|AC-20,800-53r5|CM-7a.,CCE|CCE-85324-2,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,ITSG-33|CM-7a.,NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002037,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'SkipiCloudStorageSetup = 1'",
        "expect": "1"
    },
    "custom_item_47": {
        "system": "Darwin",
        "description": "Big Sur - Disable the Internet Accounts System Preference Pane",
        "info": "The Internet Accounts System Preference pane _MUST_ be disabled to prevent the addition of unauthorized internet accounts.\n\n[IMPORTANT]\n====\nSome organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.\n====",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.systempreferences:\n  DisabledPreferencePanes:\n    com.apple.preferences.internetaccounts",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|AC-20,800-53|CM-7a.,800-53|CM-7(5),800-53|CM-7(5)(b),800-53r5|AC-20,800-53r5|CM-7a.,800-53r5|CM-7(5),800-53r5|CM-7(5)(b),CCE|CCE-85328-3,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002032,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'com.apple.preferences.internetaccounts'",
        "expect": "1"
    },
    "custom_item_48": {
        "system": "Darwin",
        "description": "Big Sur - Disable Infrared (IR) support",
        "info": "Infrared (IR) support _MUST_ be disabled to prevent users from controlling the system with IR devices.\n\nBy default, if IR is enabled, the system will accept IR control from any remote device.\n\nNOTE: This is applicable only to models of Mac Mini systems earlier than Mac Mini8,1.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.ManagedClient.preferences:\n  com.apple.driver.AppleIRController:\n    DeviceEnabled\n      False",
        "reference": "800-171|3.1.16,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|CM-6b.,800-53|CM-7,800-53|CM-7(1),800-53r5|AC-18,800-53r5|CM-6b.,800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85329-1,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|CM-6b.,ITSG-33|CM-7,ITSG-33|CM-7(1),NESA|T3.2.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'DeviceEnabled = 0'",
        "expect": "1"
    },
    "custom_item_49": {
        "system": "Darwin",
        "description": "Big Sur - Disable Mail App",
        "info": "The macOS built-in Mail.app _MUST_ be disabled.\n\nThe Mail.app contains functionality that can establish connections to Apple's iCloud, even when security controls to disable iCloud access have been put in place.\n\n[IMPORTANT]\n====\nSome organizations allow the use of the built-in Mail.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Mail.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.\n====",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess.new:\n  familyControlsEnabled:\n    True\n  pathBlackList:\n    /Applications/Mail.app",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),CCE|CCE-85336-6,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002019,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -A 20 familyControlsEnabled | /usr/bin/grep -c \"/Applications/Mail.app\"",
        "expect": "1"
    },
    "custom_item_50": {
        "system": "Darwin",
        "description": "Big Sur - Enforce Enrollment in Mobile Device Management",
        "info": "You _MUST_ enroll your Mac in a Mobile Device Management (MDM) software.\n\nUser Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager (ASM) is required to manage certain security settings. Currently these include:\n\n* Allowed Kernel Extensions\n* Allowed Approved System Extensions\n* Privacy Preferences Policy Control Payload\n* ExtensibleSingleSignOn\n* FDEFileVault\n\nIn macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were previously locked behind ABM:\n\n* Activation Lock Bypass\n* Access to Bootstrap Tokens\n* Scheduling Software Updates\n* Query list and delete local users",
        "solution": "Ensure that system is enrolled via UAMDM.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-53|CM-2,800-53|CM-6,800-53r5|CM-2,800-53r5|CM-6,CCE|CCE-85338-2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-2,ITSG-33|CM-6,NESA|T3.2.5,NESA|T7.5.1,NIAv2|SS16,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep -c \"Yes (User Approved)\"",
        "expect": "1"
    },
    "custom_item_51": {
        "system": "Darwin",
        "description": "Big Sur - Disable Messages App",
        "info": "The macOS built-in Messages.app _MUST_ be disabled.\n\nThe Messages.app establishes a connection to Apple's iCloud service, even when security controls to disable iCloud access have been put in place.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess.new:\n  familyControlsEnabled:\n    True\n  pathBlackList:\n    /Applications/Messages.app",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),CCE|CCE-85339-0,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002011,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -A 20 familyControlsEnabled | /usr/bin/grep -c \"/Applications/Messages.app\"",
        "expect": "1"
    },
    "custom_item_52": {
        "system": "Darwin",
        "description": "Big Sur - Disable Network File System Service",
        "info": "Support for Network File Systems (NFS) services is non-essential and, therefore, _MUST_ be disabled.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.apple.nfsd\n----\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-17,800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7a.,CCE|CCE-85342-4,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002003,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.nfsd\" => true'",
        "expect": "1"
    },
    "custom_item_53": {
        "system": "Darwin",
        "description": "Big Sur - Disable Password Autofill",
        "info": "Password Autofill _MUST_ be disabled.\n\nmacOS allows users to save passwords and use the Password Autofill feature in Safari and compatible apps. To protect against malicious users gaining access to the system, this feature _MUST_ be disabled to prevent users from being prompted to save passwords in applications.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowPasswordAutoFill:\n    False",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.5.1,800-171|3.5.2,800-53|CM-7,800-53|CM-7(1),800-53|IA-5,800-53|IA-5(13),800-53|IA-11,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|IA-5,800-53r5|IA-5(13),800-53r5|IA-11,CCE|CCE-85351-5,CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|IA-5,NESA|T5.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowPasswordAutoFill = 0'",
        "expect": "1"
    },
    "custom_item_54": {
        "system": "Darwin",
        "description": "Big Sur - Disable Proximity Based Password Sharing Requests",
        "info": "Proximity based password sharing requests _MUST_ be disabled.\n\nThe default behavior of macOS is to allow users to request passwords from other known devices (macOS and iOS). This feature _MUST_ be disabled to prevent passwords from being shared.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowPasswordProximityRequests:\n    False",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CCE|CCE-85352-3,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowPasswordProximityRequests = 0'",
        "expect": "1"
    },
    "custom_item_55": {
        "system": "Darwin",
        "description": "Big Sur - Disable Password Sharing",
        "info": "Password Sharing _MUST_ be disabled.\n\nThe default behavior of macOS is to allow users to share a password over Airdrop between other macOS and iOS devices. This feature _MUST_ be disabled to prevent passwords from being shared.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowPasswordSharing:\n    False",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CCE|CCE-85353-1,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowPasswordSharing = 0'",
        "expect": "1"
    },
    "custom_item_56": {
        "system": "Darwin",
        "description": "Big Sur - Disable Wi-Fi Interface",
        "info": "The macOS system must be configured with Wi-Fi support software disabled if not connected to an authorized trusted network.\n\nAllowing devices and users to connect to or from the system without first authenticating them allows untrusted access and can lead to a compromise or attack. Since wireless communications can be intercepted  it is necessary to use encryption to protect the confidentiality of information in transit.Wireless technologies include  for example  microwave  packet radio (UHF/VHF)  802.11x  and Bluetooth. Wireless networks use authentication protocols (e.g.  EAP/TLS  PEAP)  which provide credential protection and mutual authentication.\n\nNOTE: If the system requires Wi-Fi to connect to an authorized network, this is not applicable.\n\nNOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.",
        "solution": "To disable Wi-Fi on a macOS system, run the following command.\n[source,bash]\n----\n/usr/sbin/networksetup -setnetworkserviceenabled \"Wi-Fi\" off\n----",
        "reference": "800-171|3.1.3,800-171|3.1.16,800-171|3.1.17,800-53|AC-4,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53r5|AC-4,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),CCE|CCE-85473-7,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.2,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,STIG-ID|APPL-11-000008,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.openssh.sshd\" => true'",
        "expect": "1",
        "regex": "0",
        "plist_item": "PrefKeyServicesEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_57": {
        "system": "Darwin",
        "description": "Big Sur - Disable Root Login",
        "info": "To assure individual accountability and prevent unauthorized access, logging in as root at the login window _MUST_ be disabled.\n\nThe macOS system _MUST_ require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users _MUST_ never log in directly as root.",
        "solution": "[source,bash]\n----\n/usr/bin/dscl . -create /Users/root UserShell /usr/bin/false\n----",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53|IA-2(5),800-53|IA-5,800-53r5|IA-2,800-53r5|IA-2(5),800-53r5|IA-5,CCE|CCE-85374-7,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),ITSG-33|IA-5,NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/dscl . -read /Users/root UserShell 2>&1 | /usr/bin/grep -c \"/usr/bin/false\"",
        "expect": "1"
    },
    "custom_item_58": {
        "system": "Darwin",
        "description": "Big Sur - Ensure System Integrity Protection is Enabled",
        "info": "System Integrity Protection (SIP) _MUST_ be enabled.\n\nSIP is vital to protecting the integrity of the system as it prevents malicious users and software from making unauthorized and/or unintended modifications to protected files and folders; ensures the presence of an audit record generation capability for defined auditable events for all operating system components; protects audit tools from unauthorized access, modification, and deletion; restricts the root user account and limits the actions that the root user can perform on protected parts of the macOS; and prevents non-privileged users from granting other users direct access to the contents of their home directories and folders.\n\nNOTE: SIP is enabled by default in macOS.",
        "solution": "[source,bash]\n----\n/usr/bin/csrutil enable\n----\nNOTE: To reenable \"System Integrity Protection\", boot the affected system into \"Recovery\" mode, launch \"Terminal\" from the \"Utilities\" menu, and run the command.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171|3.3.8,800-171|3.4.5,800-171|3.13.4,800-171|3.14.1,800-53|AC-3,800-53|AU-6(4),800-53|AU-7,800-53|AU-7a.,800-53|AU-7b.,800-53|AU-7(1),800-53|AU-9,800-53|AU-9(3),800-53|AU-12a.,800-53|CM-5,800-53|CM-5(6),800-53|SC-4,800-53|SI-2,800-53|SI-7,800-53r5|AC-3,800-53r5|AU-6(4),800-53r5|AU-7,800-53r5|AU-7a.,800-53r5|AU-7b.,800-53r5|AU-7(1),800-53r5|AU-9,800-53r5|AU-9(3),800-53r5|AU-12a.,800-53r5|CM-5,800-53r5|CM-5(6),800-53r5|SC-4,800-53r5|SI-2,800-53r5|SI-7,CCE|CCE-85378-8,CCI|CCI-000154,CCI|CCI-000158,CCI|CCI-000169,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001499,CCI|CCI-001875,CCI|CCI-001876,CCI|CCI-001877,CCI|CCI-001878,CCI|CCI-001879,CCI|CCI-001880,CCI|CCI-001881,CCI|CCI-001882,CN-L3|7.1.2.3(c),CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(c),CN-L3|8.1.4.3(d),CN-L3|8.1.4.4(e),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|DE.DP-4,CSF|ID.RA-1,CSF|PR.AC-4,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.IP-12,CSF|PR.PT-1,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-3,ITSG-33|AU-6(4),ITSG-33|AU-7,ITSG-33|AU-7(1),ITSG-33|AU-9,ITSG-33|AU-9(3),ITSG-33|AU-12a.,ITSG-33|CM-5,ITSG-33|CM-5(6),ITSG-33|SC-4,ITSG-33|SC-4a.,ITSG-33|SI-2,ITSG-33|SI-7,ITSG-33|SI-7a.,NESA|M5.2.3,NESA|M5.2.5,NESA|M5.5.2,NESA|T3.2.3,NESA|T3.4.1,NESA|T3.6.3,NESA|T3.6.4,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.2,NESA|T7.3.3,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.7.1,NESA|T8.2.9,NIAv2|AM3,NIAv2|PR9,NIAv2|SM5,NIAv2|SM6,NIAv2|SS29,PCI-DSSv3.2.1|6.2,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,STIG-ID|APPL-11-005001,SWIFT-CSCv1|2.2,SWIFT-CSCv1|6.4,TBA-FIISB|31.1,TBA-FIISB|37.3.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/csrutil status | /usr/bin/grep -c 'System Integrity Protection status: enabled.'",
        "expect": "1"
    },
    "custom_item_59": {
        "system": "Darwin",
        "description": "Big Sur - Disable Siri Setup during Setup Assistant",
        "info": "The prompt for Siri during Setup Assistant _MUST_ be disabled.\n\nOrganizations _MUST_ apply organization-wide configuration settings. The macOS Siri Assistant Setup prompt guides new users through enabling their own specific Siri settings; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing Siri settings with the potential to override organization-wide settings.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.SetupAssistant.managed:\n  SkipSiriSetup:\n    True",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),CCE|CCE-85379-6,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,STIG-ID|APPL-11-002039,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'SkipSiriSetup = 1'",
        "expect": "1"
    },
    "custom_item_60": {
        "system": "Darwin",
        "description": "Big Sur - Limit SSH to FIPS 140 Validated Ciphers",
        "info": "SSH _MUST_ be configured to limit the ciphers to algorithms that are FIPS 140 validated.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meet federal requirements.\n\nOperating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.\n\nNOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -q '^Ciphers' /etc/ssh/ssh_config && /usr/bin/sed -i.bak  's/.^Ciphers.*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/ssh_config || /bin/echo 'Ciphers aes256-ctr,aes192-ctr,aes128-ctr' >> /etc/ssh/ssh_config\n----",
        "reference": "800-171|3.1.13,800-171|3.13.8,800-171|3.13.11,800-53|AC-17(2),800-53|IA-7,800-53|SC-8(1),800-53|SC-13,800-53r5|AC-17(2),800-53r5|IA-7,800-53r5|SC-8(1),800-53r5|SC-13,CCE|CCE-85382-0,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|SC-8(1),ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T5.4.2,NESA|T7.4.1,NIAv2|AM37,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5d,NIAv2|NS5e,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,TBA-FIISB|29.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/grep -c \"^Ciphers aes256-ctr,aes192-ctr,aes128-ctr\" /etc/ssh/ssh_config",
        "expect": "1"
    },
    "custom_item_61": {
        "system": "Darwin",
        "description": "Big Sur - Limit SSH to FIPS 140 Validated Message Authentication Code Algorithms",
        "info": "SSH _MUST_ be configured to limit the Message Authentication Codes (MACs) to algorithms that are FIPS 140 validated.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets federal requirements.\n\nOperating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.\n\nNOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "[source,bash]\n----\n/usr/bin/grep -q '^MACs' /etc/ssh/ssh_config && /usr/bin/sed -i.bak  's/.*MACs.*/MACs hmac-sha2-256,hmac-sha2-512/' /etc/ssh/ssh_config || /bin/echo 'MACs hmac-sha2-256,hmac-sha2-512' >> /etc/ssh/ssh_config\n----",
        "reference": "800-171|3.1.13,800-171|3.1.18,800-171|3.7.5,800-171|3.13.8,800-171|3.13.11,800-53|AC-17(2),800-53|AC-19b.,800-53|IA-7,800-53|MA-4(6),800-53|SC-8(1),800-53|SC-13,800-53r5|AC-17(2),800-53r5|AC-19b.,800-53r5|IA-7,800-53r5|MA-4(6),800-53r5|SC-8(1),800-53r5|SC-13,CCE|CCE-85383-8,CCI|CCI-000068,CCI|CCI-000087,CCI|CCI-000803,CCI|CCI-002890,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.MA-2,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|AC-19b.,ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|MA-4(6),ITSG-33|SC-8(1),ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T2.3.4,NESA|T5.1.1,NESA|T5.4.2,NESA|T5.4.3,NESA|T5.4.4,NESA|T5.7.1,NESA|T7.4.1,NIAv2|AM37,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5d,NIAv2|NS5e,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,STIG-ID|APPL-11-000055,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,TBA-FIISB|29.1,TBA-FIISB|45.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/grep -c \"^MACs hmac-sha2-256,hmac-sha2-512\" /etc/ssh/ssh_config",
        "expect": "1"
    },
    "custom_item_62": {
        "system": "Darwin",
        "description": "Big Sur - Disable Trivial File Tansfer Protocol Service",
        "info": "If the system does not require Trivial File Tansfer Protocol (TFTP), support it is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling TFTP helps prevent the unauthorized connection of devices and the unauthorized transfer of information.\n\nNOTE: TFTP service is disabled at startup by default macOS.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.apple.tftpd\n----\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.5.2,800-171|3.5.10,800-53|AC-3,800-53|AC-17,800-53|IA-5(1),800-53|IA-5(1)(c),800-53r5|AC-3,800-53r5|AC-17,800-53r5|IA-5(1),800-53r5|IA-5(1)(c),CCE|CCE-85391-1,CCI|CCI-000197,CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(c),NESA|T4.2.1,NESA|T5.2.3,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|CY6,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002038,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.tftpd\" => true'",
        "expect": "1"
    },
    "custom_item_63": {
        "system": "Darwin",
        "description": "Big Sur - Disable TouchID Prompt during Setup Assistant",
        "info": "The prompt for TouchID during Setup Assistant _MUST_ be disabled.\n\nmacOS prompts new users through enabling TouchID during Setup Assistant; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing to enable TouchID to override organization-wide settings.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.SetupAssistant.managed:\n  SkipTouchIDSetup:\n    True",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CCE|CCE-85393-7,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'SkipTouchIDSetup = 1'",
        "expect": "1"
    },
    "custom_item_64": {
        "system": "Darwin",
        "description": "Big Sur - Disable Login to Other User's Active and Locked Sessions",
        "info": "The ability to log in to another user's active or locked session _MUST_ be disabled.\n\nmacOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active andlocked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.",
        "solution": "[source,bash]\n----\n/usr/bin/security authorizationdb write system.login.screensaver \"use-login-window-ui\"\n----",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53|IA-2(5),800-53r5|IA-2,800-53r5|IA-2(5),CCE|CCE-85395-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/security authorizationdb read system.login.screensaver 2>&1 | /usr/bin/grep -c 'use-login-window-ui'",
        "expect": "1"
    },
    "custom_item_65": {
        "system": "Darwin",
        "description": "Big Sur - Disable Unix-to-Unix Copy Protocol Service",
        "info": "The system _MUST_ not have the Unix-to-Unix Copy Protocol (UUCP) service active.\n\nUUCP, a set of programs that enable the sending of files between different UNIX systems as well as sending commands to be executed on another system, is not essential and _MUST_ be disabled in order to prevent the unauthorized connection of devices, transfer of information, and tunneling.\n\nNOTE: UUCP service is disabled at startup by default macOS.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.apple.uucp\n----\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-17,800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7a.,CCE|CCE-85397-8,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002006,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.uucp\" => true'",
        "expect": "1"
    },
    "custom_item_66": {
        "system": "Darwin",
        "description": "Big Sur - Restrict Maximum Password Lifetime to 60 Days",
        "info": "The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 60 days.\n\nThis rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  maxPINAgeInDays:\n    60",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(d),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(d),CCE|CCE-85400-0,CCI|CCI-000199,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003008,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/awk -F \" = \" '/maxPINAgeInDays/{sub(/;.*/,\"\");print $2}'",
        "expect": "60"
    },
    "custom_item_67": {
        "system": "Darwin",
        "description": "Big Sur - Disable Accounts after 35 Days of Inactivity",
        "info": "The macOS _MUST_ be configured to disable accounts after 35 days of inactivity.\n\nThis rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.",
        "solution": "This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to disable an inactive user after 35 days, edit the current password policy to contain the followingwithin the \"policyCategoryAuthentication\":\n\n[source,xml]\n----policyContentpolicyAttributeLastAuthenticationTime > policyAttributeCurrentTime - (policyAttributeInactiveDays * 24 * 60 * 60)policyIdentifierInactive AccountpolicyParameterspolicyAttributeInactiveDays35----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNOTE: See the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.1.1,800-171|3.5.5,800-171|3.5.6,800-53|AC-2(3),800-53|IA-4,800-53|IA-4e.,800-53r5|AC-2(3),800-53r5|IA-4,800-53r5|IA-4e.,CCE|CCE-85401-8,CCI|CCI-000795,CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),ITSG-33|IA-4,ITSG-33|IA-4e.,NIAv2|AM26,PCI-DSSv3.2.1|8.1.4,PCI-DSSv4.0|8.2.6,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5,TBA-FIISB|36.2.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/pwpolicy getaccountpolicies | /usr/bin/grep -v \"Getting global account policies\" | /usr/bin/xmllint --xpath '/plist/dict/array/dict/dict[key=\"policyAttributeInactiveDays\"]/integer' - | /usr/bin/awk -F '[<>]' '{print $3}'",
        "expect": "35"
    },
    "custom_item_68": {
        "system": "Darwin",
        "description": "Big Sur - Limit Consecutive Failed Login Attempts to Three",
        "info": "The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of three. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.\n\nThis rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  maxFailedAttempts:\n    3",
        "reference": "800-171|3.1.8,800-53|AC-7,800-53|AC-7b.,800-53r5|AC-7,800-53r5|AC-7b.,CCE|CCE-85402-6,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7,ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,STIG-ID|APPL-11-000022,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'maxFailedAttempts = 3'",
        "expect": "1"
    },
    "custom_item_69": {
        "system": "Darwin",
        "description": "Big Sur - Set Account Lockout Time to 15 Minutes",
        "info": "The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.\n\nThis rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  minutesUntilFailedLoginReset:\n    15",
        "reference": "800-171|3.1.8,800-53|AC-7,800-53|AC-7b.,800-53r5|AC-7,800-53r5|AC-7b.,CCE|CCE-85403-4,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7,ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,STIG-ID|APPL-11-000022,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'minutesUntilFailedLoginReset = 15'",
        "expect": "1"
    },
    "custom_item_70": {
        "system": "Darwin",
        "description": "Big Sur - Require Passwords Contain a Minimum of One Numeric Character",
        "info": "The macOS _MUST_ be configured to require at least one numeric character be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  requireAlphanumeric:\n    True",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(a),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(a),CCE|CCE-85404-2,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003007,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c \"requireAlphanumeric = 1;\"",
        "expect": "1"
    },
    "custom_item_71": {
        "system": "Darwin",
        "description": "Big Sur - Prohibit Password Reuse for a Minimum of Five Generations",
        "info": "The macOS _MUST_ be configured to enforce a password history of at least five previous passwords when a password is created.\n\nThis rule ensures that users are  not allowed to re-use a password that was used in any of the five previous password generations.\n\nLimiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  pinHistory:\n    5",
        "reference": "800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5(1),800-53|IA-5(1)(e),800-53r5|IA-5(1),800-53r5|IA-5(1)(e),CCE|CCE-85407-5,CCI|CCI-000200,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003009,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/awk '/pinHistory/{sub(/;.*/,\"\");print $3}'",
        "expect": "5"
    },
    "custom_item_72": {
        "system": "Darwin",
        "description": "Big Sur - Require Passwords Contain a Minimum of One Lowercase Character",
        "info": "The macOS _MUST_ be configured to require at least one lower-case character be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to require at least 1 lowercase letter, edit the current password policy to contain the followingwithin the \"policyCategoryPasswordContent\":\n\n[source,xml]\n----policyContentpolicyAttributePassword matches '(.*[a-z].*){1,}+'policyIdentifierMust have at least 1 lowercase letterpolicyParametersminimumAlphaCharactersLowerCase1----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNOTE: See the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(a),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(a),CCE|CCE-85408-3,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/pwpolicy getaccountpolicies | /usr/bin/grep -v \"Getting global account policies\" | /usr/bin/xmllint --xpath '/plist/dict/array/dict/dict[key=\"minimumAlphaCharactersLowerCase\"]/integer' - | /usr/bin/awk -F '[<>]' '{print $3}'",
        "expect": "1"
    },
    "custom_item_73": {
        "system": "Darwin",
        "description": "Big Sur - Require a Minimum Password Length of 15 Characters",
        "info": "The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  minLength:\n    15",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(a),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(a),CCE|CCE-85409-1,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003010,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'minLength = 15'",
        "expect": "1"
    },
    "custom_item_74": {
        "system": "Darwin",
        "description": "Big Sur - Set Minimum Password Lifetime to 24 Hours",
        "info": "The macOS _MUST_ be configured to enforce a minimum password lifetime limit of 24 hours.\n\nThis rule discourages users from cycling through their previous passwords to get back to a preferred one.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to require a minimum password lifetime, edit the current password policy to contain the followingwithin the \"policyCategoryPasswordContent\":\n\n[source,xml]\n----policyContentpolicyAttributeLastPasswordChangeTime < policyAttributeCurrentTime - (policyAttributeMinimumLifetimeHours * 60 * 60)policyIdentifierMinimum Password LifetimepolicyParameterspolicyAttributeMinimumLifetimeHours24----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNOTE: See the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CCE|CCE-85410-9,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/pwpolicy getaccountpolicies | /usr/bin/grep -v \"Getting global account policies\" | /usr/bin/xmllint --xpath '/plist/dict/array/dict/dict[key=\"policyAttributeMinimumLifetimeHours\"]/integer' - | /usr/bin/awk -F '[<>]' '{print $3}'",
        "expect": "24"
    },
    "custom_item_75": {
        "system": "Darwin",
        "description": "Big Sur - Prohibit Repeating, Ascending, and Descending Character Sequences",
        "info": "The macOS _MUST_ be configured to prohibit the use of repeating, ascending, and descending character sequences when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  allowSimple:\n    False",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53r5|IA-5,800-53r5|IA-5(1),CCE|CCE-85412-5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,ITSG-33|IA-5(1),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowSimple = 0'",
        "expect": "1"
    },
    "custom_item_76": {
        "system": "Darwin",
        "description": "Big Sur - Require Passwords Contain a Minimum of One Special Character",
        "info": "The macOS _MUST_ be configured to require at least one special character be used when a password is created.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.mobiledevice.passwordpolicy:\n  minComplexChars:\n    1",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(a),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(a),CCE|CCE-85413-3,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-003011,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/awk '/minComplexChars/{sub(/;.*/,\"\");print $3}'",
        "expect": "1"
    },
    "custom_item_77": {
        "system": "Darwin",
        "description": "Big Sur - Require Passwords Contain a Minimum of One Uppercase Character",
        "info": "The macOS _MUST_ be configured to require at least one uppercase character be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.",
        "solution": "This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to require at least 1 lowercase letter, edit the current password policy to contain the followingwithin the \"policyCategoryPasswordContent\":\n\n[source,xml]\n----policyContentpolicyAttributePassword matches '(.*[A-Z].*){1,}+'policyIdentifierMust have at least 1 uppercase letterpolicyParametersminimumAlphaCharactersUpperCase1----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNOTE: See the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-171|3.5.10,800-53|IA-5,800-53|IA-5(1),800-53|IA-5(1)(a),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|IA-5(1)(a),CCE|CCE-85415-8,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/pwpolicy getaccountpolicies | /usr/bin/grep -v \"Getting global account policies\" | /usr/bin/xmllint --xpath '/plist/dict/array/dict/dict[key=\"minimumAlphaCharactersUpperCase\"]/integer' - | /usr/bin/awk -F '[<>]' '{print $3}'",
        "expect": "1"
    },
    "custom_item_78": {
        "system": "Darwin",
        "description": "Big Sur - Disable Unattended or Automatic Logon to the System",
        "info": "Automatic logon _MUST_ be disabled.\n\nWhen automatic logons are enabled, the default user account is automatically logged on at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer and find it already logged in. Disabling automatic logons mitigates this risk.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.loginwindow:\n  com.apple.login.mcx.DisableAutoLoginClient:\n    True",
        "reference": "800-171|3.4.2,800-171|3.5.1,800-171|3.5.2,800-53|CM-6b.,800-53|IA-2,800-53|IA-5(13),800-53r5|CM-6b.,800-53r5|IA-2,800-53r5|IA-5(13),CCE|CCE-85419-0,CCI|CCI-000366,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.10.6(d),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5,NESA|T2.3.8,NESA|T3.2.1,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002066,SWIFT-CSCv1|2.3,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c '\"com.apple.login.mcx.DisableAutoLoginClient\" = 1'",
        "expect": "1"
    },
    "custom_item_79": {
        "description": "Big Sur - Disable Bluetooth Sharing",
        "info": "Bluetooth Sharing _MUST_ be disabled.\n\nBluetooth Sharing allows users to wirelessly transmit files between the macOS and Bluetooth-enabled devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files via Bluetooth Sharing. When Bluetooth Sharing is disabled, this risk is mitigated.\n\n[NOTE]\n====\nThe check and fix are for the currently logged in user. To get the currently logged in user, run the following.\n[source,bash]\n----\nCURRENT_USER=$( scutil <<< \"show State:/Users/ConsoleUser\" | awk '/Name :/ && ! /loginwindow/ { print $3 }' )\n----\n====",
        "solution": "[source,bash]\n----\n/usr/bin/sudo -u \"$CURRENT_USER\" /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false\n----",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.1.16,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-18(4),800-53|CM-7,800-53|CM-7(1),800-53r5|AC-3,800-53r5|AC-18(4),800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85421-6,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-18(4),ITSG-33|CM-7,ITSG-33|CM-7(1),NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "regex": "0",
        "plist_item": "PrefKeyServicesEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_80": {
        "system": "Darwin",
        "description": "Big Sur - Disable Content Caching Service",
        "info": "Content caching _MUST_ be disabled.\n\nContent caching is a macOS service that helps reduce Internet data usage and speed up software installation on Mac computers. It is not recommended for devices furnished to employees to act as a caching server.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowContentCaching:\n    False",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7(1),800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85422-4,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|CM-7(1),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowContentCaching = 0'",
        "expect": "1"
    },
    "custom_item_81": {
        "system": "Darwin",
        "description": "Big Sur - Disable Sending Diagnostic and Usage Data to Apple",
        "info": "The ability to submit diagnostic data to Apple _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of diagnostic and usage information will mitigate the risk of unwanted data being sent to Apple.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.SubmitDiagInfo:\n  AutoSubmit:\n    False\ncom.apple.applicationaccess:\n  allowDiagnosticSubmission:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|AC-20,800-53|CM-7b.,800-53|SC-7(10),800-53|SI-11,800-53r5|AC-20,800-53r5|CM-7b.,800-53r5|SC-7(10),800-53r5|SI-11,CCE|CCE-85423-2,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|CM-7a.,ITSG-33|SC-7(10),ITSG-33|SI-11,NESA|M1.3.5,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002021,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '(allowDiagnosticSubmission = 0|AutoSubmit = 0)'",
        "expect": "2"
    },
    "custom_item_82": {
        "system": "Darwin",
        "description": "Big Sur - Disable Find My Service",
        "info": "The Find My service _MUST_ be disabled.\n\nA Mobile Device Management (MDM) solution _MUST_ be used to carry out remote locking and wiping instead of Apple's Find My service.\n\nApple's Find My service uses a personal AppleID for authentication. Organizations should rely on MDM solutions, which have much more secure authentication requirements, to perform remote lock and remote wipe.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.applicationaccess:\n  allowFindMyDevice:\n    False\n  allowFindMyFriends:\n    False\ncom.apple.icloud.managed:\n  DisableFMMiCloudSetting:\n    True",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-20,800-53|CM-7,800-53|CM-7(1),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85426-5,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7(1),NESA|M1.3.5,NESA|T1.2.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '(allowFindMyDevice = 0|allowFindMyFriends = 0|DisableFMMiCloudSetting = 1)'",
        "expect": "3"
    },
    "custom_item_83": {
        "system": "Darwin",
        "description": "Big Sur - Enable macOS Application Firewall",
        "info": "The macOS Application Firewall is the built-in firewall that comes with macOS, and it _MUST_ be enabled.\n\nWhen the macOS Application Firewall is enabled, the flow of information within the information system and between interconnected systems will be controlled by approved authorizations.",
        "solution": "[source,bash]\n----\n/usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on\n----",
        "reference": "800-171|3.1.3,800-171|3.1.5,800-171|3.1.18,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|AC-4,800-53|AC-6(1),800-53|AC-19,800-53|CM-6b.,800-53|CM-7,800-53|CM-7(1),800-53|SC-7,800-53|SC-7(12),800-53r5|AC-4,800-53r5|AC-6(1),800-53r5|AC-19,800-53r5|CM-6b.,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7,800-53r5|SC-7(12),CCE|CCE-85427-3,CCI|CCI-000366,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|DE.AE-1,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-4,ITSG-33|AC-6(1),ITSG-33|AC-19,ITSG-33|CM-6b.,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7,ITSG-33|SC-7(12),NESA|T3.2.1,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.4.6,NESA|T5.5.4,NESA|T5.6.1,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.4,NIAv2|AM31,NIAv2|AM38,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS13d,NIAv2|SS15a,NIAv2|SS23,NIAv2|SS26,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,NIAv2|VL3b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|1.4,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|1.5.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,STIG-ID|APPL-11-005050,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|43.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate | /usr/bin/grep -c \"Firewall is enabled\"",
        "expect": "1"
    },
    "custom_item_84": {
        "system": "Darwin",
        "description": "Big Sur - Enable Firewall Stealth Mode",
        "info": "Firewall Stealth Mode _MUST_ be enabled.\n\nWhen stealth mode is enabled, the Mac will not respond to any probing requests, and only requests from authorized applications will still be authorized.\n\n[IMPORTANT]\n====\nEnabling firewall stealth mode may prevent certain remote mechanisms used for maintenance and compliance scanning from properly functioning. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting not to enable stealth mode.\n====",
        "solution": "[source,bash]\n----\n/usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on\n----",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-6b.,800-53|CM-7,800-53|CM-7(1),800-53|SC-7,800-53|SC-7(16),800-53r5|CM-6b.,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7,800-53r5|SC-7(16),CCE|CCE-85428-1,CCI|CCI-000366,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7,ITSG-33|SC-7(16),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS8d,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|1.3.7,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|1.4.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-005050,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode | /usr/bin/grep -c \"Stealth mode enabled\"",
        "expect": "1"
    },
    "custom_item_85": {
        "system": "Darwin",
        "description": "Big Sur - Disable Guest Access to Shared SMB Folders",
        "info": "Guest access to shared Server Message Block (SMB) folders _MUST_ be disabled.\n\nTurning off guest access prevents anonymous users from accessing files shared via SMB.",
        "solution": "[source,bash]\n----\n/usr/sbin/sysadminctl -smbGuestAccess off\n----",
        "reference": "800-171|3.1.1,800-171|3.5.1,800-171|3.5.2,800-53|AC-2,800-53|AC-2(9),800-53r5|AC-2,800-53r5|AC-2(9),CCE|CCE-85319-2,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM16,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|8.5,PCI-DSSv4.0|8.2.2,PCI-DSSv4.0|8.2.3,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess",
        "expect": "0"
    },
    "custom_item_86": {
        "system": "Darwin",
        "description": "Big Sur - Disable the Guest Account",
        "info": "Guest access _MUST_ be disabled.\n\nTurning off guest access prevents anonymous users from accessing files.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.MCX:\n  DisableGuestAccount:\n    True",
        "reference": "800-171|3.1.1,800-171|3.4.5,800-171|3.5.1,800-171|3.5.2,800-53|AC-2,800-53|AC-2(9),800-53|CM-5(1),800-53r5|AC-2,800-53r5|AC-2(9),800-53r5|CM-5(1),CCE|CCE-85320-0,CCI|CCI-001813,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM16,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|8.5,PCI-DSSv4.0|8.2.2,PCI-DSSv4.0|8.2.3,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,STIG-ID|APPL-11-002063",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'DisableGuestAccount = 1'",
        "expect": "1"
    },
    "custom_item_87": {
        "system": "Darwin",
        "description": "Big Sur - Disable Sending Siri and Dictation Information to Apple",
        "info": "The ability for Apple to store and review audio of your Siri and Dictation interactions _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of Siri and Dictation information will mitigate the risk of unwanted data being sent to Apple.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.assistant.support:\n  Siri Data Sharing Opt-In Status:\n    2",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|AC-20,800-53|CM-7,800-53|CM-7(1),800-53|SC-7(10),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7(10),CCE|CCE-85432-3,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c '\"Siri Data Sharing Opt-In Status\" = 2;'",
        "expect": "1"
    },
    "custom_item_88": {
        "system": "Darwin",
        "description": "Big Sur - Disable Internet Sharing",
        "info": "If the system does not require Internet sharing, support for it is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling Internet sharing helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.MCX:\n  forceInternetSharingOff:\n    True",
        "reference": "800-171|3.1.3,800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-53|AC-4,800-53|AC-20,800-53|CM-7a.,800-53r5|AC-4,800-53r5|AC-20,800-53r5|CM-7a.,CCE|CCE-85433-1,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,ITSG-33|AC-20,ITSG-33|CM-7a.,NESA|M1.3.5,NESA|T1.2.3,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS15a,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,STIG-ID|APPL-11-002007,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.4,SWIFT-CSCv1|2.5",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'forceInternetSharingOff = 1'",
        "expect": "1"
    },
    "custom_item_89": {
        "system": "Darwin",
        "description": "Big Sur - Disable Location Services",
        "info": "Location Services _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities.  Disabling Location Services helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "[source,bash]\n----\n/usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false; /bin/launchctl kickstart -k system/com.apple.locationd\n----",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|SC-7(10),800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|SC-7(10),CCE|CCE-85434-9,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002004,SWIFT-CSCv1|2.3,TBA-FIISB|33.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/defaults read /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd.plist LocationServicesEnabled",
        "expect": "0"
    },
    "custom_item_90": {
        "system": "Darwin",
        "description": "Big Sur - Configure Login Window to Prompt for Username and Password",
        "info": "The login window _MUST_ be configured to prompt all users for both a username and a password.\n\nBy default, the system displays a list of known users on the login window, which can make it easier for a malicious user to gain access to someone else's account. Requiring users to type in both their username and password mitigates the risk of unauthorized users gaining access to the information system.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.loginwindow:\n  SHOWFULLNAME:\n    True",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-53|IA-2,800-53r5|IA-2,CCE|CCE-85435-6,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'SHOWFULLNAME = 1'",
        "expect": "1"
    },
    "custom_item_91": {
        "system": "Darwin",
        "description": "Big Sur - Disable Media Sharing",
        "info": "Media sharing _MUST_ be disabled.\n\nWhen Media Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling Media Sharing helps prevent the unauthorized connection of devices and the unauthorized transfer of information. Disabling Media Sharing mitigates this risk.\n\nNOTE: The Media Sharing preference panel will still allow \"Home Sharing\" and \"Share media with guests\" to be checked but the service will not be enabled.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.preferences.sharing.SharingPrefsExtension:\n  homeSharingUIStatus:\n    0\n  legacySharingUIStatus:\n    0\n  mediaSharingUIStatus:\n    0",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-53|AC-3,800-53|AC-17,800-53r5|AC-3,800-53r5|AC-17,CCE|CCE-85436-4,CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '(homeSharingUIStatus = 0|legacySharingUIStatus = 0|mediaSharingUIStatus = 0)'",
        "expect": "3"
    },
    "custom_item_92": {
        "system": "Darwin",
        "description": "Big Sur - Disable Password Hints",
        "info": "Password hints _MUST_ be disabled.\n\nPassword hints leak information about passwords that are currently in use and can lead to loss of confidentiality.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.loginwindow:\n  RetriesUntilHint:\n    0",
        "reference": "800-171|3.4.2,800-171|3.5.11,800-53|CM-6b.,800-53|IA-6,800-53r5|CM-6b.,800-53r5|IA-6,CCE|CCE-85437-2,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|CM-6b.,ITSG-33|IA-6,ITSG-33|IA-6a.,NESA|T3.2.1,NESA|T5.5.1,QCSC-v1|13.2,STIG-ID|APPL-11-003012,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'RetriesUntilHint = 0'",
        "expect": "1"
    },
    "custom_item_93": {
        "system": "Darwin",
        "description": "Big Sur - Disable Personalized Advertising",
        "info": "Ad tracking and targeted ads _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling ad tracking ensures that applications and advertisers are unable to track users' interests and deliver targeted advertisements.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.AdLib:\n  allowApplePersonalizedAdvertising:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|AC-20,800-53|CM-7,800-53|CM-7(1),800-53|SC-7(10),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7(10),CCE|CCE-85438-0,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'allowApplePersonalizedAdvertising = 0;'",
        "expect": "1"
    },
    "custom_item_94": {
        "system": "Darwin",
        "description": "Big Sur - Disable Power Nap",
        "info": "Power Nap _MUST_ be disabled.\n\nPower Nap allows your Mac to perform actions while a Mac is asleep. This can interfere with USB power and may cause devices to stop functioning until a reboot and must therefore be disabled on all applicable systems.\n\nThe following Macs support Power Nap:\n\n* MacBook (Early 2015 and later)\n* MacBook Air (Late 2010 and later)\n* MacBook Pro (all models with Retina display)\n* Mac mini (Late 2012 and later)\n* iMac (Late 2012 and later)\n* Mac Pro (Late 2013 and later)",
        "solution": "[source,bash]\n----\n/usr/bin/pmset -a powernap 0\n----",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7(1),800-53r5|CM-7,800-53r5|CM-7(1),CCE|CCE-85439-8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|CM-7(1),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/pmset -g custom | /usr/bin/awk '/powernap/ { sum+=$2 } END {print sum}'",
        "expect": "0"
    },
    "custom_item_95": {
        "system": "Darwin",
        "description": "Big Sur - Disable Remote Apple Events",
        "info": "If the system does not require Remote Apple Events, support for Apple Remote Events is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling Remote Apple Events helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "[source,bash]\n----\n/usr/sbin/systemsetup -setremoteappleevents off\n/bin/launchctl disable system/com.apple.AEServer\n----\nNOTE: Systemsetup with -setremoteappleevents flag will fail unless you grant Full Disk Access to systemsetup or it's parent process. Requires UAMDM.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-17,800-53|CM-7b.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7b.,CCE|CCE-85440-6,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(b),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002022,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.AEServer\" => true'",
        "expect": "1"
    },
    "custom_item_96": {
        "system": "Darwin",
        "description": "Big Sur - Disable Screen Sharing and Apple Remote Desktop",
        "info": "Support for both Screen Sharing and Apple Remote Desktop (ARD) is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities. Disabling screen sharing and ARD helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.apple.screensharing\n----\nNOTE - This will apply to the whole system",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.2,800-53|AC-3,800-53|AC-17,800-53|CM-6b.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-6b.,CCE|CCE-85441-4,CCI|CCI-000366,CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-6b.,NESA|T3.2.1,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002050,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.screensharing\" => true'",
        "expect": "1"
    },
    "custom_item_97": {
        "system": "Darwin",
        "description": "Big Sur - Disable Siri",
        "info": "Support for Siri is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities.",
        "solution": "This is implemented by a Configuration Profile.\n\nmobileconfig profile info:\n\ncom.apple.ironwood.support:\n  Ironwood Allowed:\n    False",
        "reference": "800-171|3.1.20,800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-171|3.13.1,800-53|AC-20,800-53|CM-7,800-53|CM-7a.,800-53|CM-7(1),800-53|CM-7(5)(b),800-53|SC-7(10),800-53r5|AC-20,800-53r5|CM-7,800-53r5|CM-7a.,800-53r5|CM-7(1),800-53r5|CM-7(5)(b),800-53r5|SC-7(10),CCE|CCE-85445-5,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|ID.AM-4,CSF|PR.AC-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|AC-20,ITSG-33|CM-7,ITSG-33|CM-7a.,ITSG-33|CM-7(1),ITSG-33|SC-7(10),NESA|M1.3.5,NESA|T1.2.3,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.3.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,STIG-ID|APPL-11-002020,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.5,TBA-FIISB|33.1,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -c '\"Ironwood Allowed\" = 0'",
        "expect": "1"
    },
    "custom_item_98": {
        "system": "Darwin",
        "description": "Big Sur - Disable Server Message Block Sharing",
        "info": "Support for Server Message Block (SMB) file sharing is non-essential and _MUST_ be disabled.\n\nThe information system _MUST_ be configured to provide only essential capabilities.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.apple.smbd\n----\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-17,800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7a.,CCE|CCE-85446-3,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-002001,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,TBA-FIISB|31.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.smbd\" => true'",
        "expect": "1"
    },
    "custom_item_99": {
        "system": "Darwin",
        "description": "Big Sur - Disable SSH Server for Remote Access Sessions",
        "info": "SSH service _MUST_ be disabled for remote access.\n\nRemote access sessions _MUST_ use FIPS validated encrypted methods to protect unauthorized individuals from gaining access.",
        "solution": "[source,bash]\n----\n/bin/launchctl disable system/com.openssh.sshd\n----",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-171|3.4.6,800-171|3.4.7,800-171|3.5.4,800-53|AC-3,800-53|AC-17,800-53|CM-7,800-53|CM-7(1),800-53|IA-2(8),800-53r5|AC-3,800-53r5|AC-17,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|IA-2(8),800-53r5|IA-2(9),CCE|CCE-85447-1,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(c),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(i),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-17,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T4.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM18,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,STIG-ID|APPL-11-000011,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.2,TBA-FIISB|31.1,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://github.com/usnistgov/macos_security",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.openssh.sshd\" => true'",
        "expect": "1"
    }
}