{
    "custom_item_1": {
        "system": "AIX",
        "description": "2.2 Verify world writable directories provide unlink() protection",
        "info": "The system is audited to verify world writable directories provide unlink() protection to file owners.\n\nRationale:\n\nAn audit should be performed on the system to search for the presence of world writable directories. Directories should only be world writable when absolutely necessary, and only with the so-called SVTX bit set. This protects users files from being deleted or renamed.\n\nImpact:\n\nWorld writable directories exist on UNIX systems (e.g., /tmp, /var/tmp). These directories are needed for normal operations. To protect the files created in the directories the 'links to the inode' (ie, filename) need to be protected so that others may not accidentally, or maliciously - remove or modify the filename.",
        "solution": "Review the local mounted JFS/JFS2 filesystems using the following command to find all world writable directories missing the SVTX bit:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type d -perm -o+w ! ! -perm -1000 -ls\n\nIf a directory must retain world writable access, ensure that SVTX bit is set so that users can only remove the filenames they own:\n\nchmod o+t ${dir}\n\nNOTE: This will leave existing modes while adding the SVTX (also known as sticky bit) to the directory. The documented meaning of the flag for directories is:\nSets the link permission to directories.\n\nOtherwise, remove world-write permission - without modifying the other mode bits:\n\nchmod o-w ${dir}\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "name": "find_world_writeable_directories",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_2": {
        "system": "AIX",
        "description": "2.5 Ensure all files and directories are owned by a user (uid) and assigned to a group (gid) - gid",
        "info": "Sometimes when administrators delete users or groups from the system they neglect to remove all files owned by those users or groups.\n\nRationale:\n\nA new user who is assigned the deleted user's user ID or group ID may then end up 'owning' these files, and thus have more access on the system than was intended.",
        "solution": "Review the currently mounted filesystems:\n\nmount\n\nUn-mount all non-local filesystems and cdrom media:\n\nunmountIf there are non-local filesystems which cannot be un-mounted, use the following command to find all un-owned files and directories on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) \\( -type d -o -type f \\) \\( -nouser -o -nogroup \\) -ls\n\nIf all non-local filesystems have been un-mounted:\n\nfind / \\( -type d -o -type f \\) \\( -nouser -o -nogroup \\) -ls\n\nNOTE: An un-owned file or directory is referred to via the GID or UID as it cannot be translated to a user or group name in /etc/group or /etc/passwd. This is typically caused by removing users or groups from the system.\nRemediate the un-owned file and directory list:\n\nchownchgrpDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "name": "find_orphan_files",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_3": {
        "system": "AIX",
        "description": "4.1.2 All user id's must be unique",
        "info": "All users should have a unique UID. In particular the only user on the system to have a UID of 0 should be the root user.\n\nRationale:\n\nThe only user with a UID of 0 on the system must be the root user. Any account with a UID of 0 has super user privileges on the system and is effectively root. All access to the root account should be via su or sudo to provide an audit trail. All other users must also have a unique UID to ensure that file and directory security is not compromised.",
        "solution": "Examine the user IDs of all configured users:\n\ncut -d: -f 3 /etc/passwd |sort -n |uniq -d\n\nIf a number, or numbers are returned from the command above, these are UID values which are not unique within the /etc/passwd file. Determine the effected username/s:\n\ncut -f '1 3' -d : /etc/passwd |grep ':$'\n\nNOTE: Any user names returned should either be deleted or have the UID changed\nTo remove:\n\nrmuserTo change the UID:\n\nchuser id=Default Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16.6,CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "name": "passwd_duplicate_uid"
    },
    "custom_item_4": {
        "system": "AIX",
        "description": "4.1.3 All group id's must be unique",
        "info": "All groups should have a unique GID on the system.\n\nRationale:\n\nAll groups should have an individual and unique GID. If GID numbers are shared this could lead to undesirable file and directory access.",
        "solution": "Ensure that all group IDs are unique:\n\ncut -d: -f 3 /etc/group |sort -n | uniq -d\n\nIf a number, or numbers are returned from the command above, these are GID which are not unique within the /etc/group file. Determine the effected group names:\n\ncut -f '1 3' -d : /etc/group |grep ':$'\n\nNOTE: Any group names returned should either be deleted or have the UID changed\nTo remove:\n\nrmgroupTo change the UID:\n\nchgroup id=Default Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|16.6,CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "name": "group_duplicate_gid"
    },
    "custom_item_5": {
        "system": "AIX",
        "description": "3.7.1.1 Ensure all directories in root PATH deny write access to all",
        "info": "To secure the root users executable PATH, all directories must not be group and world writable.\n\nRationale:\n\nThere should not be group or world writable directories in the root user's executable path. This may allow an attacker to gain super user access by forcing an administrator operating as root to execute a Trojan horse program.",
        "solution": "Search and report on group or world writable directories in root's PATH. The command must be run as the root user. The script below traverses up each individual directory PATH, ensuring that all directories are not group/world writable and that they are owned by root or the bin user:\n\necho '/:${PATH}' | tr ':' '\\n' | grep '^/' | sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nprint 'Checking ${DIR}'\nwhile [[ -d ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(d???????w? *) ]] && print ' WARNING ${DIR} is world writable' || print ' ${DIR} is not world writable'\n[[ '$(ls -ld ${DIR})' = @(d????w???? *) ]] && print ' WARNING ${DIR} is group writable' || print ' ${DIR} is not group writable'\n[[ '$(ls -ld ${DIR} |awk '{print $3}')' != @(root|bin) ]] && print ' WARNING ${DIR} is not owned by root or bin'\nDIR=${DIR%/*}\ndone\ndone\n\nNOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable are marked with 'WARNING'\nTo manually change permissions on the directories:\nTo remove group writable access:\n\nchmod g-wTo remove world writable access:\n\nchmod o-wTo remove both group and world writable access:\n\nchmod go-wTo change the owner of a directory:\n\nchownTo fully automate the PATH directory permission changes execute the following code as the root user:\n\necho '/:${PATH}' | tr ':' '\\n' | grep '^/' | sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nwhile [[ -d ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(d???????w? *) ]] && chmod o-w ${DIR} && print 'Removing world write from ${DIR}'\n[[ '$(ls -ld ${DIR})' = @(d????w???? *) ]] && chmod g-w ${DIR} && print 'Removing group write from ${DIR}'\nDIR=${DIR%/*}\ndone\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "name": "writeable_dirs_in_root_path_variable",
        "mask": "022"
    },
    "custom_item_6": {
        "description": "AIX Version 7, Release 1 or greater, found",
        "cmd": "/usr/bin/oslevel",
        "expect": "^[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_7": {
        "system": "AIX",
        "description": "2.4 Ensure there are no 'other' writable objects",
        "info": "The system is audited for world writable files.\n\nRationale:\n\nAn audit should be performed on the system to search for the presence of world writable files. Files should only be world writable when absolutely necessary.",
        "solution": "Review the currently mounted local filesystems using the following to find all world writable files on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type f -perm -o+w -ls\n\nRemedy any files in the list, e.g., chmod o-w {filename}\n\nDocument any files, and motivate why they are world writeable, and also add documentation re: when/why this exception ceases.\n\nDefault Value:\n\nN/A\n\n\n\n\nAdditional Information:\n\nReversion:\n\nTo reinstate world writable permission:\n\nchmod o+w",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type f -perm -o+w -ls | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_8": {
        "system": "AIX",
        "description": "3.1.2.1 Disable ntalk/talk/write - inetd",
        "info": "The recommendation is to block talk and write. This allows connected users to chat within terminal sessions.\n\nRationale:\n\nThe recommendation is to block attempts to use the write or talk commands. This improves the security of the tty device.\n\nHowever, there are two exceptions:\n\nThe super user can write to anyone\n\nIf you are logged in as the same user who has turned the messages off, you can write to the super user",
        "solution": "Disable talk and write.\n\nrmitab writesrv\n/usr/sbin/chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p 'udp'\n/usr/sbin/chsubserver -r inetd -C /etc/inetd.conf -d  -v 'talk' -p 'udp'\nfor daemon in /usr/sbin/talkd /usr/sbin/writesrv; do\n chmod a-rwx ${daemon}\n trustchk -u ${daemon} mode\ndone\n\nDefault Value:\n\nntalk and writesrv are enabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep -c talk",
        "expect": "0"
    },
    "custom_item_9": {
        "system": "AIX",
        "description": "3.1.2.1 Disable ntalk/talk/write - writesrv",
        "info": "The recommendation is to block talk and write. This allows connected users to chat within terminal sessions.\n\nRationale:\n\nThe recommendation is to block attempts to use the write or talk commands. This improves the security of the tty device.\n\nHowever, there are two exceptions:\n\nThe super user can write to anyone\n\nIf you are logged in as the same user who has turned the messages off, you can write to the super user",
        "solution": "Disable talk and write.\n\nrmitab writesrv\n/usr/sbin/chsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p 'udp'\n/usr/sbin/chsubserver -r inetd -C /etc/inetd.conf -d  -v 'talk' -p 'udp'\nfor daemon in /usr/sbin/talkd /usr/sbin/writesrv; do\n chmod a-rwx ${daemon}\n trustchk -u ${daemon} mode\ndone\n\nDefault Value:\n\nntalk and writesrv are enabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s writesrv | /usr/bin/grep -c active",
        "expect": "0"
    },
    "custom_item_10": {
        "system": "AIX",
        "description": "3.4.5 /etc/security/login.cfg - pwd_algorithm",
        "info": "Defines the loadable password algorithm used when storing user passwords.\n\nRationale:\n\nA development since AIX 5.1 was the ability to use different password algorithms as defined in /etc/security/pwdalg.cfg. The traditional UNIX password algorithm is crypt, which is a one-way hash function supporting only 8 character passwords. The use of brute force password guessing attacks means that crypt no longer provides an appropriate level of security and so other encryption mechanisms are recommended.\n\nThe recommendation of this benchmark is to set the password algorithm to ssha512. This algorithm supports long passwords, up to 255 characters in length and allows passphrases including the use of the extended ASCII table and the space character. Any passwords already set using crypt will be recognized. When the password is reset the new password hash algorithm will be used to encrypt the password.\n\nImpact:\n\nEnsure that all running applications support SHA512 password encyption",
        "solution": "In the file /etc/security/login.cfg set the usw stanza attribute pwd_algorithm to ssha512:\n\nchsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha512\n\nDefault Value:\n\ncrypt\n\nAdditional Information:\n\nConsider looking for passwords encrypted using crypt and set the ADMCHG flag to initiate a password change at next login.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "expect": "^usw[\\\\s]+pwd_algorithm[\\\\s]*=[\\\\s]*ssha512[\\\\s]*$"
    },
    "custom_item_11": {
        "system": "AIX",
        "description": "6.1.1 Configuring syslog - local logging - *.info/auth.none in /etc/syslog.conf",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked daemon,bin,sys,adm,uucp,nobody,lpd,lp,invscout,ipsec,nuucp,sshd | /usr/bin/grep -v account_locked=true | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "file": "/etc/syslog.conf",
        "content": "@LOGIN_HERALD_TEXT@",
        "regex": "^[\\\\*][\\\\.]info;auth[\\\\.]none\t",
        "expect": "^[\\\\*][\\\\.]info;auth[\\\\.]none\t+/var/adm/syslog[\\\\s]+rotate[\\\\s]+time[\\\\s]+1w[\\\\s]+files[\\\\s]+4[\\\\s]*$",
        "timeout": "@FIND_TIMEOUT@",
        "owner": "root",
        "mask": "137",
        "name": "writeable_dirs_in_root_path_variable",
        "MEDIUMdescription": "3.6.3.2 FTPD: Display acceptable usage policy during login",
        "group": "system",
        "MEDIUMsystem": "AIX",
        "NOsystem": "AIX",
        "YESsystem": "AIX"
    },
    "custom_item_12": {
        "system": "AIX",
        "description": "3.6.1.3 OpenSSH - Banner - banner text",
        "info": "The recommendation is to edit the /etc/ssh/sshd_config file and configure a path to a login herald message.\n\nThe Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.\n\nRationale:\n\nBanners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.",
        "solution": "Create an SSH banner file:\n\nprintf 'Unauthorized use of this system is prohibited.\\n'' > /etc/ssh/ssh_banner\n\nNOTE: The content of the banner file can reflect any internal acceptable usage policy standards\n\nEdit the /etc/ssh/sshd_config file and customize the Banner parameter\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#Banner /some/path\n\nWith:\n\nBanner /etc/ssh/ssh_banner\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 5\nstartsrc -s sshd\n\nDefault Value:\n\nNo banner is configured",
        "reference": "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,LEVEL|1A,NESA|M1.3.6,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/ssh_banner",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_13": {
        "system": "AIX",
        "description": "3.6.1.3 OpenSSH - Banner - banner path",
        "info": "The recommendation is to edit the /etc/ssh/sshd_config file and configure a path to a login herald message.\n\nThe Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.\n\nRationale:\n\nBanners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.",
        "solution": "Create an SSH banner file:\n\nprintf 'Unauthorized use of this system is prohibited.\\n'' > /etc/ssh/ssh_banner\n\nNOTE: The content of the banner file can reflect any internal acceptable usage policy standards\n\nEdit the /etc/ssh/sshd_config file and customize the Banner parameter\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#Banner /some/path\n\nWith:\n\nBanner /etc/ssh/ssh_banner\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 5\nstartsrc -s sshd\n\nDefault Value:\n\nNo banner is configured",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1A,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)Banner(?-i)[\\\\s]+\\/etc\\/ssh\\/ssh_banner[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)Banner(?-i)[\\\\s]+\\/etc\\/ssh\\/ssh_banner[\\\\s]*$"
    },
    "custom_item_14": {
        "system": "AIX",
        "description": "3.6.1.4 Ensure SSH IgnoreRhosts is enabled",
        "info": "The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication.\n\nRationale:\n\nA user can logon to a remote system without authenticating themselves if .rhosts or .shosts files exist in the remote home directory and if the client machine name and user name are present in these files. This method is fundamentally insecure as the local system can be exploited by IP, DNS (Domain Name Server) and routing spoofing attacks. Additionally, this authentication method relies on the integrity of the client machine. These weaknesses have been known and exploited for a long time. Since this authentication method is not secure, it must be disabled.",
        "solution": "Edit the /etc/ssh/sshd_config file to disable the .shosts and .rhosts authentication parameter:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#IgnoreRhosts yes\n\nWith:\n\nIgnoreRhosts yes\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nIgnoreRhosts yes",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)IgnoreRhosts(?-i)[\\\\s]+yes[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)IgnoreRhosts(?-i)[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_15": {
        "system": "AIX",
        "description": "3.6.1.5 Ensure SSH PermitEmptyPasswords is disabled",
        "info": "The recommendation is to edit the /etc/ssh/sshd_config file to ensure that the SSH daemon does not authenticate users with a null password.\n\nRationale:\n\nIf password authentication is used and an account has an empty password, the SSH server must be configured to disallow access to the account. Permitting empty passwords could create an easy path of access for hackers to enter the system.",
        "solution": "Edit the /etc/ssh/sshd_config file to disable the acceptance null passwords:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#PermitEmptyPasswords no\n\nWith:\n\nPermitEmptyPasswords no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nPermitEmptyPasswords no",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|16.3,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)PermitEmptyPasswords(?-i)[\\\\s]+no[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)PermitEmptyPasswords(?-i)[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_16": {
        "system": "AIX",
        "description": "3.6.1.6 Configuring SSH - disallow host based authentication",
        "info": "The recommendation is to edit the /etc/ssh/sshd_config file to ensure that host-based authentication is disallowed.\n\nRationale:\n\nUsing host-based authentication, any user on a trusted host can log into another host on which this feature is enabled. Since this feature depends only on system authentication and not on user authentication, it must be disabled.",
        "solution": "Edit the /etc/ssh/sshd_config file to ensure that host based authentication is disallowed:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#HostbasedAuthentication no\n\nWith:\n\nHostbasedAuthentication no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nHostbasedAuthentication no\n\nAdditional Information:\n\nReversion:\n\nRevert to the default setting for the HostBasedAuthentication parameter:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\nHostbasedAuthentication no\n\nWith:\n\n# HostbasedAuthentication no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\n\nstartsrc -s sshd",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|16.3,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)HostbasedAuthentication(?-i)[\\\\s]+no[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)HostbasedAuthentication(?-i)[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_17": {
        "system": "AIX",
        "description": "3.6.1.7 Configuring SSH - removal of .shosts files",
        "info": "The recommendation is to remove any existing .shosts files from all user home directories.\n\nRationale:\n\nThe existence of .shosts files in a user home directory, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method, these files, if they exist, should be removed.",
        "solution": "List out all of the existing .shost files:\n\nfind / -name '.shosts' -print\n\nReview the list of .shost files and remove them individually, or all at once:\nIndividually:\n\nrmAll at once:\n\nfind / -name '.shosts' -exec rm {} \\;\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nAny deleted files would need to be restored from a backup.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/find / -name \".shosts\" -print | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_18": {
        "system": "AIX",
        "description": "3.6.1.8 Configuring SSH - removal of /etc/shosts.equiv",
        "info": "The recommendation is to remove the /etc/shosts.equiv file.\n\nRationale:\n\nThe existence of a /etc/shosts.equiv file, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method these files, if they exist, should be removed.",
        "solution": "Review the content of the /etc/shosts.equiv file:\n\ncat /etc/shosts.equiv\n\nIf the file exists:\n\nrm /etc/shosts.equiv\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nThe /etc/shosts.equiv file would need to be restored from a backup.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/ls /etc/shosts.equiv | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_19": {
        "system": "AIX",
        "description": "3.6.1.9 Configuring SSH - set LogLevel to INFO or VERBOSE",
        "info": "The INFO parameter specifices that record login and logout activity will be logged.\n\nRationale:\n\nSSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.",
        "solution": "Edit the /etc/ssh/sshd_config:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nLogLevel INFO\n\nor\n\nLogLevel VERBOSE\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 5\nstartsrc -s sshd\n\nAdditional Information:\n\nTo resolve accountability for who is logging in as root using publickey authentication together with LogLevel INFO remember that AIX syslog must also be configured to provide .info level for the facility chosen (default is auth).\n\nFor example: auth.info /var/log/syslog/auth.log rotate size 1m files 4\n\nProperly configured provides the following syslog information showing the fingerprint of the key used to access an account:\n\nJun 25 09:26:41 x071 auth|security:info sshd[8323282]: Accepted publickey for michael from 192.168.129.11 port 54278 ssh2: RSA SHA256:dRHxa5CGr5HCdC89suwYIBtAT8lyogz4SErSxTq0JXk\n\nJun 25 09:26:52 x071 auth|security:info sshd[8847396]: Accepted publickey for root from 192.168.129.11 port 54279 ssh2: RSA SHA256:dRHxa5CGr5HCdC89suwYIBtAT8lyogz4SErSxTq0JXk\n\nJun 25 09:26:53 x071 auth|security:info sshd[9044142]: Accepted publickey for root from 192.168.129.11 port 54280 ssh2: RSA SHA256:dRHxa5CGr5HCdC89suwYIBtAT8lyogz4SErSxTq0JXk",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)LogLevel(?-i)[\\\\s]+",
        "expect": "^[\\\\s]*(?i)LogLevel(?-i)[\\\\s]+(INFO|VERBOSE)[\\\\s]*$"
    },
    "custom_item_20": {
        "system": "AIX",
        "description": "3.6.1.10 OpenSSH - configure sftp-server",
        "info": "The sftp-server is started by the sshd server after authentication has been completed successfully. The process runs with the euid of the authenticated user.\n\nRationale:\n\nSSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.\n\nLike sshd (see Recommendation: OpenSSH: LogLevel) the sftp-server needs to be configured with syslog information. Additionally, the umask value needs specification.",
        "solution": "Edit the /etc/ssh/sshd_config:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nSubsystem sftp /usr/sbin/sftp-server -u 027 -f AUTH -l VERBOSE\n\nor\n\nSubsystem sftp /usr/sbin/sftp-server -u 027 -f AUTH -l DEBUG\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 5\nstartsrc -s sshd",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)Subsystem(?-i)[\\\\s]+sftp[\\\\s]+\\/usr\\/sbin\\/sftp-server[\\\\s]+-u[\\\\s]+027[\\\\s]+-f[\\\\s]+AUTH[\\\\s]+-l[\\\\s]+(VERBOSE|DEBUG)[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)Subsystem(?-i)[\\\\s]+sftp[\\\\s]+\\/usr\\/sbin\\/sftp-server[\\\\s]+-u[\\\\s]+027[\\\\s]+-f[\\\\s]+AUTH[\\\\s]+-l[\\\\s]+(VERBOSE|DEBUG)[\\\\s]*$"
    },
    "custom_item_21": {
        "system": "AIX",
        "description": "3.6.1.11 OpenSSH: Ensure MaxAuthTries is set to 4 or less",
        "info": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.\n\nRationale:\n\nSetting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.",
        "solution": "Edit the/etc/ssh/sshd_config file to set the parameter as follows::\n\nMaxAuthTries 4\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,LEVEL|1A,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)MaxAuthTries(?-i)",
        "expect": "^[\\\\s]*(?i)MaxAuthTries(?-i)[\\\\s]+[1-4][\\\\s]*$"
    },
    "custom_item_22": {
        "system": "AIX",
        "description": "3.6.1.12 OpenSSH: Ensure only strong ciphers are used",
        "info": "This variable limits the types of ciphers that SSH can use during communication.\n\nRationale:\n\nBased on research conducted at various institutions, it was determined that the symmetric portion of the SSH Transport Protocol (as described in RFC 4253) has security weaknesses that allowed recovery of up to 32 bits of plaintext from a block of ciphertext that was encrypted with the Cipher Block Chaining (CBD) method. From that research, new Counter mode algorithms (as described in RFC4344) were designed that are not vulnerable to these types of attacks and these algorithms are now recommended for standard use.",
        "solution": "Edit the /etc/ssh/sshd_config file and add/modify the Ciphers line to contain a comma separated list of the site approved ciphers.\nExample\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)Ciphers(?-i)[\\\\s]",
        "expect": "^[\\\\s]*(?i)Ciphers(?-i)[\\\\s]+(,?aes128-ctr|,?aes192-ctr|,?aes256-ctr){3}[\\\\s]*$"
    },
    "custom_item_23": {
        "system": "AIX",
        "description": "3.6.1.13 Ignore user-provided environment variables",
        "info": "The PermitUserEnvironment option allows users to present environment options to the ssh daemon.\n\nRationale:\n\nPermitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing trojan'd programs)",
        "solution": "Edit the/etc/ssh/sshd_config file:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nPermitUserEnvironment no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)PermitUserEnvironment(?-i)[\\\\s]+yes[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)PermitUserEnvironment(?-i)[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_24": {
        "system": "AIX",
        "description": "3.6.1.14 OpenSSH: Regulate access to server",
        "info": "There are several options available to regulate access to a server via OpenSSH. At least of the following options needs to be leveraged:\n\nAllowUsers: The AllowUsers variable specifies which users may ssh into the system. The list is user names separated by spaces. Numeric userIDs are not recognized with this variable. Access can be narrowed to restrict user access from a specific host using the form user@host.\n\nAllowGroups: The AllowGroups variable specifies groups of users who are permitted to ssh into the system. The list is group names separated by spaces. Numeric groupIDs are not recognized with this variable.\n\nDenyUsers: The DenyUsers variable specifies specific users who may not ssh into the system. The list is user names separated by spaces. Numeric userIDs are not recognized with this variable. Access can be narrowed to restrict user access from a specific host using the form user@host.\n\nDenyGroups: The DenyGroups variable specifies groups of users who are not permitted to ssh into the system. The list is group names separated by spaces. Numeric groupIDs are not recognized with this variable.\n\nRationale:\n\nRestricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.",
        "solution": "Edit the /etc/ssh/sshd_config file to set one (or more) of the following parameters:\n\nAllowUsersAllowGroupsDenyUsersDenyGroupsRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nAll users from any host are permitted.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)(Allow|Deny)(Users|Groups)(?-i)[\\\\s]+[a-z0-9@\\\\*\\\\?]{2,}([\\\\s]+[a-z0-9@\\\\*\\\\?]{2,})*[\\\\s]*$",
        "expect": "^[\\\\s]*(?i)(Allow|Deny)(Users|Groups)(?-i)[\\\\s]+[a-z0-9@\\\\*\\\\?]{2,}([\\\\s]+[a-z0-9@\\\\*\\\\?]{2,})*[\\\\s]*$"
    },
    "custom_item_25": {
        "system": "AIX",
        "description": "3.6.2.1 /etc/mail/sendmail.cf - SmtpGreetingMessage",
        "info": "The recommendation is to change the default sendmail greeting string to not display the sendmail version and other related information.\n\nRationale:\n\nThe sendmail deamon has a history of security vulnerabilities. The recommendation is to change the default sendmail greeting string so as not to display the sendmail version and other related information, which can be used by an attacker for fingerprinting purposes.",
        "solution": "Create a backup copy of /etc/mail/sendmail.cf:\n\ncp -p /etc/mail/sendmail.cf /etc/mail/sendmail.cf.pre_cis\n\nEdit:\n\nvi /etc/mail/sendmail.cf\n\nReplace:\n\nO SmtpGreetingMessage=$j Sendmail $b\n\nWith:\n\nO SmtpGreetingMessage=mailerready\n\nDefault Value:\n\nSmtpGreetingMessage=$j Sendmail $b\n\n\n\n\nAdditional Information:\n\nReversion:\n\nCopy back the original /etc/sendmail.cf file:\n\ncp -p /etc/mail/sendmail.cf.pre_cis /etc/mail/sendmail.cf",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/mail/sendmail.cf",
        "regex": "SmtpGreetingMessage",
        "expect": "^[\\\\s]*O[\\\\s]+SmtpGreetingMessage[\\\\s]*=[\\\\s]*mailerready[\\\\s]*$"
    },
    "custom_item_26": {
        "system": "AIX",
        "description": "3.6.2.2 /etc/mail/sendmail.cf - permissions and ownership",
        "info": "The recommended permissions and ownership for /etc/mail/sendmail.cf are applied.\n\nRationale:\n\nThe /etc/mail/sendmail.cf file is used by the sendmail daemon to determine its default configuration. This file must be protected from unauthorized access and modifications.",
        "solution": "Set the recommended permissions and ownership on /etc/mail/sendmail.cf:\n\nchmod u=rw,g=r,o= /etc/mail/sendmail.cf\nchown root /etc/mail/sendmail.cf\n\nDefault Value:\n\n-rw-r--r-- root system sendmail.cf",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/mail/sendmail.cf",
        "owner": "root",
        "mask": "137"
    },
    "custom_item_27": {
        "system": "AIX",
        "description": "3.6.2.3 /var/spool/mqueue - permissions and ownership",
        "info": "The recommended permissions and ownership for the /var/spool/mqueue directory are applied.\n\nRationale:\n\nThe sendmail daemon generally stores its queued mail in the /var/spool/mqueue directory. Queued messages are the messages that have not yet reached their final destination. To ensure the integrity of the messages during storage, the mail queue directory must be secured from unauthorized access.\n\nNOTE: It is possible to specify an alternate spool directory in the /etc/mail/sendmail.cf file via the QueueDirectory parameter.",
        "solution": "Set the recommended permissions and ownership on /var/spool/mqueue:\n\nchmod u=rwx,go= /var/spool/mqueue\nchown root /var/spool/mqueue\n\nDefault Value:\n\ndrwxrwx---    root     system          /var/spool/mqueue",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/spool/mqueue",
        "owner": "root",
        "mask": "077"
    },
    "custom_item_28": {
        "system": "AIX",
        "description": "3.7.1.2 Home directory must deny write to all except owner",
        "info": "All user home directories must not have group write or world writable access.\n\nRationale:\n\nGroup or world-writable user home directories may enable malicious users to steal or modify data, or to gain other user's system privileges. Disabling read and execute access for users, who are not members of the same group, allows for appropriate use of discretionary access control by each user.\n\nImpact:\n\nShould have minimal impact as the default already excludes group and other (world) write access. If many different groups are used (i.e., more than 'staff') there may be some impact if users in different groups are used to sharing files via there home directories.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/bin/cat /etc/passwd | /usr/bin/awk -F: '($7 != \"/sbin/nologin\" && $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do if [ ! -d \"$dir\" ]; then /usr/bin/echo \"The home directory ($dir) of user $user does not exist.\"; else for file in $dir/.[A-Za-z0-9]*; do if [ ! -h \"$file\" -a -f \"$file\" ]; then fileperm=`ls -ld $file | cut -f1 -d\" \"`; if [ `/usr/bin/echo $fileperm | cut -c6` != \"-\" ]; then /usr/bin/echo \"Group Write permission set on file $file\"; fi; if [ `/usr/bin/echo $fileperm | cut -c9` != \"-\" ]; then /usr/bin/echo \"Other Write permission set on file $file\"; fi; fi; done; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"Pass - No home configuration files found with group or other permissions\"; else print}'",
        "expect": "Pass - No home configuration files found with group or other permissions"
    },
    "custom_item_29": {
        "system": "AIX",
        "description": "4.1.1 All accounts must have a hashed password",
        "info": "All (unlocked) accounts on the server must have a password.\n\nFor this recommendation we look at the so-called files registery - as we cannot reliably review the entries kept in a centralized authentication system such as LDAP or Kerberos.\n\nRationale:\n\nAn account password is a secret code word that must be entered to gain access to the account. If an account exists that has a blank password, multiple users may access the account without authentication and leave a weak audit trail. An attacker may gain unauthorized system access or perform malicious actions, which then cannot be attributed to any specific individual.\n\nImpact:\n\nIf no password hash is available and a locked account gets unlocked then the account is available without any verification aka authentication.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/pwdck -n ALL 2>&1 | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_30": {
        "system": "AIX",
        "description": "4.2.1 histexpire",
        "info": "Defines the period of time in weeks that a user will not be able to reuse a password.\n\nRationale:\n\nIn setting the histexpire attribute, it ensures that a user cannot reuse a password within a set period of time.",
        "solution": "In /etc/security/user, set the default user stanza histexpire attribute to be greater than or equal to 26:\n\nchsec -f /etc/security/user -s default -a histexpire=26\n\nThis means that a user will not be able to reuse any password set in the last 26 weeks.\n\nDefault Value:\n\nNot set",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a histexpire",
        "expect": "^[\\\\s]*default[\\\\s]+histexpire[\\\\s]*=[\\\\s]*@HISTEXPIRE@[\\\\s]*$"
    },
    "custom_item_31": {
        "system": "AIX",
        "description": "4.2.2 histsize",
        "info": "Defines the number of previous passwords that a user may not reuse.\n\nRationale:\n\nIn setting the histsize attribute, it enforces a minimum number of previous passwords a user cannot reuse.",
        "solution": "In /etc/security/user, set the default user stanza histsize attribute to be (greater than or) equal to 20:\n\nchsec -f /etc/security/user -s default -a histsize=20\n\nThis means that a user may not reuse any of the previous 20 passwords.\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a histsize",
        "expect": "^default[\\\\s]+histsize[\\\\s]*=[\\\\s]*@HISTSIZE@[\\\\s]*$"
    },
    "custom_item_32": {
        "system": "AIX",
        "description": "3.4.3 loginretries",
        "info": "Defines the number of attempts a user has to login to the system before their account is disabled.\n\nRationale:\n\nIn setting the loginretries attribute, this ensures that a user can have a pre-defined number of attempts to get their password right, prior to locking the account.\n\nImpact:\n\nThe setting chosen here (5) is a group consensus as secure enough. However, a local site-policy may have a more strict requirement for all, or some systems.\n\nWhile the audit and artifact currently test for exactly 5 - the actual recommendation is: greater than 0 (zero) AND (less than or equal to 5 (five) or greater than 0 (zero) AND not greater than 5 (five)",
        "solution": "In /etc/security/user, set the default stanza loginretries attribute to 5:\n\nchsec -f /etc/security/user -s default -a loginretries=5\n\nThis means that a user will have 5 attempts to enter the correct password. This does not apply to the root user, which has its own stanza entry disabling this feature.\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.8,800-171|3.1.18,800-53|AC-7,800-53|AC-19,800-53r5|AC-7,800-53r5|AC-19,CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.10,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-7,ITSG-33|AC-19,LEVEL|1A,NIAv2|AM24,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a loginretries",
        "expect": "^[\\\\s]*default[\\\\s]+loginretries[\\\\s]*=[\\\\s]*[1-5][\\\\s]*$"
    },
    "custom_item_33": {
        "system": "AIX",
        "description": "4.2.3 maxage",
        "info": "Defines the maximum number of weeks that a password is valid.\n\nRationale:\n\nThe maxage attribute enforces regular password changes. We recommend this to be 13 or less, but not 0 which disables this setting.\n\nImpact:\n\nHistorically, this recommendation has been to set maxage=13. In recent years several communities (e.g., Windows, DoD) have concluded that too frequent forced password changes leads to both weaker passwords and weaker/bad password discipline.\n\nAn initial proposal to increase the maxage to 52 is not unnamimous within the AIX community - so the recommendation, for now, remains at 13.\n\nLocal Policy may decide to follow the other communities and set this value as 52.\n\nDue to this lack of consensus this control is being set at Level 2.\n\nThe value chosen by an organization is to maintain overall password quality and secrecy.",
        "solution": "In /etc/security/user, set the default user stanza maxage attribute to a number greater than 0 but less than or equal to 13:\n\nchsec -f /etc/security/user -s default -a maxage=13\n\nThis means that a user password must be changed 13 weeks after being set. If 0 is set then this effectively disables password ageing.\n\nDefault Value:\n\nmaxage=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxage",
        "expect": "^[\\\\s]*default[\\\\s]+maxage[\\\\s]*=[\\\\s]*([1-9]|1[0-3])[\\\\s]*$"
    },
    "custom_item_34": {
        "system": "AIX",
        "description": "4.2.4 maxexpired",
        "info": "Defines the number of weeks after maxage, that a password can be reset by the user.\n\nRationale:\n\nThe maxexpired attribute limits the number of weeks after password expiry that a password may be changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza maxexpired attribute to 4:\n\nchsec -f /etc/security/user -s default -a maxexpired=4\n\nThis means that a user can reset their password up to 4 weeks after it has expired. After this an administrative user would need to reset the password.\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.1,800-53|AC-2(3),800-53r5|AC-2(3),CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv7|16.9,CSCv8|5.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),LEVEL|1A,NIAv2|AM26,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxexpired",
        "expect": "^[\\\\s]*default[\\\\s]+maxexpired[\\\\s]*=[\\\\s]*([1-4])[\\\\s]*$"
    },
    "custom_item_35": {
        "system": "AIX",
        "description": "4.2.5 maxrepeats",
        "info": "Defines the maximum number of times a character may appear in a password.\n\nRationale:\n\nIn setting the maxrepeats attribute, it enforces a maximum number of character repeats within a password.",
        "solution": "In/etc/security/user, set the default user stanza maxrepeats attribute to 4:\n\nchsec -f /etc/security/user -s default -a maxrepeats=4\n\nThis means that a user may not use the same character more than four (4) times in a password.\nThis value has been increased from two (2) - in parallel with the increase in minlen from eight (8) to fourteen (14).\n\nDefault Value:\n\nmaxrepeats=8",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxrepeats",
        "expect": "^[\\\\s]*default[\\\\s]+maxrepeats[\\\\s]*=[\\\\s]*([1-4])[\\\\s]*$"
    },
    "custom_item_36": {
        "system": "AIX",
        "description": "4.2.6 minage",
        "info": "Defines the minimum number of weeks before a password can be changed.\n\nRationale:\n\nThe minage attribute prohibits users changing their password until a set number of weeks have passed.\n\nImpact:\n\nThe AIX community prefers to rely on the AIX attribute histexpire rather than a historical minage value.\n\nHistorically, the minage attribute has been used to prevent a user from write a script to spool through histsize passwords, and then return to the same password as before. The attribute histexpire overrides histsize. Therefore, there is no need to force a user to request assistance from system administrators in order to reset a poorly chosen password, or in the case of special accounts that policy states passwords are meant for 'one time use'.\n\nAgain, since AIX has a different way to prevent scripted password re-cycling, the need for minage is not longer warranted.",
        "solution": "In/etc/security/user, set the default user stanza minage attribute to 1:\n\nchsec -f /etc/security/user -s default -a minage=1\n\nThis means that a user can change their password at any time.\n\nDefault Value:\n\nminage=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minage",
        "expect": "^[\\\\s]*default[\\\\s]+minage[\\\\s]*=[\\\\s]*@MINAGE@[\\\\s]*$"
    },
    "custom_item_37": {
        "system": "AIX",
        "description": "4.2.7 minalpha",
        "info": "Defines the minimum number of alphabetic characters in a password.\n\nRationale:\n\nIn setting the minalpha attribute, it ensures that passwords have a minimum number of alphabetic characters.",
        "solution": "In /etc/security/user, set the default user stanza minalpha attribute to be greater than or equal to 2:\n\nchsec -f /etc/security/user -s default -a minalpha=2\n\nThis means that there must be at least 2 alphabetic characters within a password.\n\nDefault Value:\n\nminalpha=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minalpha",
        "expect": "^[\\\\s]*default[\\\\s]+minalpha[\\\\s]*=[\\\\s]*@MINALPHA@[\\\\s]*$"
    },
    "custom_item_38": {
        "system": "AIX",
        "description": "4.2.8 mindiff",
        "info": "Defines the minimum number of characters that are required in a new password which were not in the old password.\n\nRationale:\n\nThe mindiff attribute ensures that users are not able to reuse the same or similar passwords.",
        "solution": "In /etc/security/user, set the default user stanza mindiff attribute to be greater than or equal to 4:\n\nchsec -f /etc/security/user -s default -a mindiff=4\n\nThis means that when a user password is set it needs to comprise of at least 4 characters not present in the previous password.\n\nDefault Value:\n\nmindiff=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a mindiff",
        "expect": "^[\\\\s]*default[\\\\s]+mindiff[\\\\s]*=[\\\\s]*([4-9]|[1-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_39": {
        "system": "AIX",
        "description": "4.2.9 mindigit",
        "info": "Defines the minimum number of digits in a password.\n\nRationale:\n\nIn setting the mindigit attribute, the password must contain a digit when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza mindigit attribute to 1:\n\nchsec -f /etc/security/user -s default -a mindigit=1\n\nThis means that there must be at least 1 digit within a password.\n\nDefault Value:\n\ndefault mindigit=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a mindigit",
        "expect": "^[\\\\s]*default[\\\\s]+mindigit[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_40": {
        "system": "AIX",
        "description": "4.2.10 minlen",
        "info": "Defines the minimum length of a password.\n\nRationale:\n\nIn setting the minlen attribute, it ensures that passwords meet the required length criteria.",
        "solution": "In /etc/security/user, set the default user stanza minlen attribute to be greater than or equal to 14:\n\nchsec -f /etc/security/user -s default -a minlen=14\n\nThis means that all user passwords must be at least 14 characters in length.\nNOTE: To support a password length greater than 8 characters the default algorithm must be changed. If the command above returns an error (3004-692 Error changing 'minlen' to '14' : Value is invalid.) the recommendation 3.1.15 /etc/security/login.cfg - pwd_algorithm needs to be completed first.\n\nDefault Value:\n\ndefault minlen=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minlen",
        "expect": "^[\\\\s]*default[\\\\s]+minlen[\\\\s]*=[\\\\s]*(1[4-9]|[2-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_41": {
        "system": "AIX",
        "description": "4.2.11 minloweralpha",
        "info": "Defines the minimum number of lower case alphabetic characters in a password.\n\nRationale:\n\nIn setting the minloweralpha attribute, the password must contain a lower case alphabetic character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minloweralpha attribute to 1:\n\nchsec -f /etc/security/user -s default -a minloweralpha=1\n\nThis means that there must be at least 1 lower case alphabetic character within a password.\n\nDefault Value:\n\ndefault minloweralpha=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minloweralpha",
        "expect": "^[\\\\s]*default[\\\\s]+minloweralpha[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_42": {
        "system": "AIX",
        "description": "4.2.12 minother",
        "info": "Defines the number of characters within a password which must be non-alphabetic.\n\nRationale:\n\nIn setting the minother attribute, it increases password complexity by enforcing the use of non-alphabetic characters in every user password.",
        "solution": "In /etc/security/user, set the default user stanza minother attribute to be greater than or equal to 2:\n\nchsec -f /etc/security/user -s default -a minother=2\n\nThis means that there must be at least 2 non-alphabetic characters within a password.\n\nDefault Value:\n\ndefault minother=2",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minother",
        "expect": "^[\\\\s]*default[\\\\s]+minother[\\\\s]*=[\\\\s]*@MINOTHER@[\\\\s]*$"
    },
    "custom_item_43": {
        "system": "AIX",
        "description": "4.2.13 minspecialchar",
        "info": "Defines the minimum number of special characters in a password.\n\nRationale:\n\nIn setting the minspecialchar attribute, the password must contain a special character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minspecialchar attribute to 1:\n\nchsec -f /etc/security/user -s default -a minspecialchar=1\n\nThis means that there must be at least 1 special character within a password.\n\nDefault Value:\n\ndefault minspecialchar=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minspecialchar",
        "expect": "^[\\\\s]*default[\\\\s]+minspecialchar[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_44": {
        "system": "AIX",
        "description": "4.2.14 minupperalpha",
        "info": "Defines the minimum number of upper case alphabetic characters in a password.\n\nRationale:\n\nIn setting the minupperalpha attribute, the password must contain an upper case alphabetic character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minupperalpha attribute to 1:\n\nchsec -f /etc/security/user -s default -a minupperalpha=1\n\nThis means that there must be at least 1 upper case alphabetic character within a password.\n\nDefault Value:\n\ndefault minupperalpha=1",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minupperalpha",
        "expect": "^[\\\\s]*default[\\\\s]+minupperalpha[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_45": {
        "system": "AIX",
        "description": "4.3.1 adm",
        "info": "This change locks and disables login access for the adm user account.\n\nRationale:\n\nThis change disables direct local and remote login to the adm user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the adm user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to adm user:\n\nchuser account_locked=true login=false rlogin=false adm\n\nDefault Value:\n\naccount_locked=false rlogin=true login=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin adm",
        "expect": "^[\\\\s]*adm[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_46": {
        "system": "AIX",
        "description": "4.3.2 bin",
        "info": "This change locks and disables login access for the bin user account.\n\nRationale:\n\nThis change disables direct local and remote login to the bin user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the bin user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable bin user access:\n\nchuser account_locked=true login=false rlogin=false bin\n\nDefault Value:\n\naccount_locked=false rlogin=true login=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin bin",
        "expect": "^[\\\\s]*bin[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_47": {
        "system": "AIX",
        "description": "4.3.3 daemon",
        "info": "This change locks and disables login access for the daemon user account.\n\nRationale:\n\nThis change disables direct local and remote login to the daemon user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the daemon user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable daemon user access:\n\nchuser account_locked=true login=false rlogin=false daemon\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.5.2,800-171|3.7.5,800-53|CM-7,800-53|IA-5,800-53|MA-4,800-53r5|CM-7,800-53r5|IA-5,800-53r5|MA-4,CSCv8|4.6,CSCv8|4.7,CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7,ITSG-33|IA-5,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.2.3,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin daemon",
        "expect": "^[\\\\s]*daemon[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_48": {
        "system": "AIX",
        "description": "4.3.4 guest",
        "info": "This change locks and disables login access for the guest user account.\n\nRationale:\n\nThis change disables direct local and remote login to the guest user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the guest user directly. All users should be given unique logon ids to ensure traceability and accountability.\n\nImpact:\n\nHistorically the guest user account was to provide access to unknown users, i.e., the user identity was not important.\n\nToday the guest account should not be used. The numeric userid is reserved by the OS.\n\nAll authorized users should be given specific logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to guest user:\n\nchuser account_locked=true login=false rlogin=false guest\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin guest",
        "expect": "^[\\\\s]*guest[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_49": {
        "system": "AIX",
        "description": "4.3.5 lpd",
        "info": "This change locks and disables login access for the lpd user account.\n\nRationale:\n\nThis change disables direct local and remote login to the lpd user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the lpd user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to lpd user:\n\nchuser account_locked=true login=false rlogin=false lpd\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin lpd",
        "expect": "^[\\\\s]*lpd[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_50": {
        "system": "AIX",
        "description": "4.3.6 nobody",
        "info": "This change locks and disables login access for the nobody user account.\n\nRationale:\n\nThis change disables direct local and remote login to the nobody user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the nobody user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable nobody user access:\n\nchuser account_locked=true login=false rlogin=false nobody\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin nobody",
        "expect": "^[\\\\s]*nobody[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_51": {
        "system": "AIX",
        "description": "4.3.7 nuucp",
        "info": "This change locks and disables login access for the nuucp user account.\n\nRationale:\n\nThis change disables direct local and remote login to the nuucp user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the nuucp user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to nuucp user::\n\nchuser account_locked=true login=false rlogin=false nuucp\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin nuucp",
        "expect": "^[\\\\s]*nuucp[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_52": {
        "system": "AIX",
        "description": "4.3.8 sys",
        "info": "This change locks and disables login access for the sys user account.\n\nRationale:\n\nThis change disables direct local and remote login to the sys user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the sys user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to sys user:\n\nchuser account_locked=true login=false rlogin=false sys\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin sys",
        "expect": "^[\\\\s]*sys[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_53": {
        "system": "AIX",
        "description": "3.1.5.31 uucp",
        "info": "This entry starts the uucp service when required. This service facilitates file copying between networked servers.\n\nRationale:\n\nThe uucp (UNIX to UNIX Copy Program), service allows users to copy files between networked machines. Unless an application or process requires UUCP this should be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'uucp' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]uucp\" | wc -l",
        "expect": "0"
    },
    "custom_item_54": {
        "system": "AIX",
        "description": "3.6.3.3 FTPD: Disable root access to ftp",
        "info": "This change adds the root user to the /etc/ftpusers file, which disables ftp for root.\n\nRationale:\n\nThis change ensures that direct root ftp access is disabled. As detailed previously, ftp as a service should be disabled. If the service has to be enabled then this change must be implemented to ensure that remote root file transfer access is not enabled.",
        "solution": "Add root to the /etc/ftpusers file:\n\necho 'root' >> /etc/ftpusers\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ftpusers",
        "regex": "^root$",
        "expect": "^root$"
    },
    "custom_item_55": {
        "description": "Verify FTP is running",
        "cmd": "/usr/bin/lssrc -a | /usr/bin/grep -i ftpd",
        "expect": "active"
    },
    "custom_item_56": {
        "system": "AIX",
        "description": "3.6.3.2 FTPD: Display acceptable usage policy during login",
        "info": "Set an ftp login banner which displays the acceptable usage policy.\n\nRationale:\n\nThe message in banner.msg is displayed for FTP logins. Banners display necessary warnings to users trying to gain unauthorized access to the system and are required for legal purposes. The recommendation is to set the banner as:\n\n'Authorized uses only. All activity will be monitored and reported'.\n\nThe content may be changed to reflect any corporate AUP.",
        "solution": "Ensure that the bos.msg.en_US.net.tcp.client fileset is installed:\n\nlslpp -L 'bos.msg.en_US.net.tcp.client'\n\nNOTE: If the fileset is not installed, install it from the AIX media or another software repository. The fileset should reflect the language used on the server.\nOnce installed set the ftp AUP banner:\n\ndspcat -g /usr/lib/nls/msg/en_US/ftpd.cat > /tmp/ftpd.tmp\nsed 's/\\'\\%s FTP server (\\%s) ready.\\'/\\'\\%s Authorized uses only. All activity may be monitored and reported\\'/' /tmp/ftpd.tmp > /tmp/ftpd.msg\ngencat /usr/lib/nls/msg/en_US/ftpd.cat /tmp/ftpd.msg\nrm /tmp/ftpd.tmp /tmp/ftpd.msg\n\nDefault Value:\n\n%s FTP server (%s) ready.\n\nAdditional Information:\n\nAnother way to install a banner is to create /etc/ftpaccess.ctl with the following contents:\n\nherald: /etc/ftp_banner\n\nThen create the file /etc/ftp_banner and write something to it. The banner appears before authentication:\n\nprint 'Authorized uses only. All activity may be monitored and reported.' >/etc/ftp_banner\n\nchmod a-wx /etc/ftp_banner\n\nftp localhost\n\nConnected to loopback. 220-Authorized uses only. All activity may be monitored and reported. 220 aix71tl5sp3 FTP server (Version 4.2 Fri Apr 6 19:34:30 CDT 2018) ready. Name (localhost:root):",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1A,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/dspcat /usr/lib/nls/msg/en_US/ftpd.cat 1 9 | awk '{ print } END { if (NR==0) print \"blank\" }'",
        "expect": "^[\\\\s]*%s[\\\\s]+Authorized[\\\\s]+uses[\\\\s]+only[\\\\.][\\\\s]+All[\\\\s]+activity[\\\\s]+may[\\\\s]+be[\\\\s]+monitored[\\\\s]+and[\\\\s]+reported"
    },
    "custom_item_57": {
        "system": "AIX",
        "description": "3.6.3.1 FTPD: Prevent world access and group write to files",
        "info": "The umask of the ftp service should be set to at least 027 in order to prevent the FTP daemon process from creating world-accessible, group-writeable files by default.\n\nRationale:\n\nThe umask of the ftp service should be set to at least 027 in order to prevent the FTP daemon process from creating world-accessible and group-writeable files by default. These files could then be transferred over the network which could result in compromise of the critical information.",
        "solution": "Set the default umask of the ftp daemon:\n\n[[ $(grep -c '^ftp[[:blank:]]' /etc/inetd.conf) -gt 0 ]] && chsubserver -c -v ftp -p tcp 'ftpd -l -u 027' && refresh -s inetd || RC=0'\n\nNOTE: The umask above restricts write permissions for both group and other. All access for other is removed.\n\nDefault Value:\n\n/usr/sbin/ftpd ftpd -l",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/usr/sbin/ftpd",
        "mask": "027"
    },
    "custom_item_58": {
        "system": "AIX",
        "description": "4.3.10 Ensure System Accounts cannot access system using ftp.",
        "info": "If ftp is active on the system, the file /etc/ftpusers is a deny list used by ftp daemon containing a list of users who are not allowed to access the system via ftp.\n\nRationale:\n\nThe /etc/ftpusers file contains a list of users who are not allowed to access the system via ftp. All users with a UID less than 200 should typically be added into the file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "List all users with a UID less than 200 to the /etc/ftpusers file:\n\nlsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do\nif [ 'lsuser -f $NAME | grep id | cut -f2 -d=' -lt 200 ] > /dev/null 2>&1; then\necho 'Would add $NAME to /etc/ftpusers'\nfi\ndone\n\nNOTE: Review the list of users\nAdd all relevant users with a UID of less that 200 to the /etc/ftpusers file:\n\nlsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do\nif [ 'lsuser -f $NAME | grep id | cut -f2 -d=' -lt 200 ] > /dev/null 2>&1; then\necho $NAME >> /etc/ftpusers\nfi\ndone\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/ftpusers and leave only the root entry:\n\nvi /etc/ftpusers",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/cat /etc/ftpusers",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_59": {
        "system": "AIX",
        "description": "3.7.1.3 /audit",
        "info": "The /audit directory holds the output produced from the audit subsystem.\n\nRationale:\n\nThe /audit directory stores the audit output files. This directory must have adequate access controls to prevent unauthorized access.",
        "solution": "Ensure correct ownership and permissions are in place for /audit:\n\nchown root:audit /audit\nchmod u=rwx,g=rx,o= /audit\nchmod -R u=rw,g=r,o= /audit/*\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/audit",
        "owner": "root",
        "mask": "027",
        "group": "audit"
    },
    "custom_item_60": {
        "system": "AIX",
        "description": "3.7.1.4 /etc/security",
        "info": "This /etc/security directory contains the user and group configuration files and the encrypted passwords.\n\nRationale:\n\nThe /etc/security directory contains sensitive files such as /etc/security/passwd, /etc/security/group. It must be secured from unauthorized access and modifications.",
        "solution": "Remove world read, write and execute access and group write access from /etc/security:\n\nchown -R root:security /etc/security\nchmod u=rwx,g=rx,o= /etc/security\nchmod -R go-w,o-rx /etc/security\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/security",
        "owner": "root",
        "mask": "027",
        "group": "security"
    },
    "custom_item_61": {
        "system": "AIX",
        "description": "5.4 Adding authorized users in at.allow",
        "info": "The /var/adm/cron/at.allow file defines which users on the system are able to schedule jobs via at.\n\nRationale:\n\nThe /var/adm/cron/at.allow file defines which users are able to schedule jobs via at. Review the current at files and add any relevant users to the /var/adm/cron/at.allow file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review the current at files:\n\nls -l /var/spool/cron/atjobs\ncat /var/spool/cron/atjobs/*\n\nNOTE: Review the list of at schedules and remove any files which should not be there, or have no content\nAdd the recommended system users to the at.allow list:\n\necho 'adm' >> /var/adm/cron/at.allow\necho 'sys' >> /var/adm/cron/at.allow\n\nAdd any other users who require permissions to use the at scheduler:\n\necho>> /var/adm/cron/at.allow\n\nNOTE: Whereis the username.\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1M,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/cat /var/adm/cron/at.allow",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_62": {
        "system": "AIX",
        "description": "5.6 Adding authorised users in cron.allow",
        "info": "The /var/adm/cron/cron.allow file defines which users on the system are able to schedule jobs via cron.\n\nRationale:\n\nThe /var/adm/cron/cron.allow file defines which users are able to schedule jobs via cron. Review the current cron files and add any relevant users to the /var/adm/cron/cron.allow file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review the current cron files:\n\nls -l /var/spool/cron/crontabs/\ncat /var/spool/cron/crontabs/*\n\nNOTE: Review the list of cron schedules and remove any files which should not be there, or have no content.\nAdd the recommended system users to the cron.allow list:\n\necho 'sys' >> /var/adm/cron/cron.allow\necho 'adm' >> /var/adm/cron/cron.allow\n\nAdd any other users who require permissions to use the cron scheduler:\n\necho>> /var/adm/cron/cron.allow\n\nNOTE: Whereis the username.\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/cat /var/adm/cron/cron.allow",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_63": {
        "system": "AIX",
        "description": "3.1.1.1 Disable writesrv",
        "info": "The recommendation is to disable writesrv. This allows users to chat using the system write facility on a terminal.\n\nRationale:\n\nwritesrv allows users to chat using the system write facility on a terminal. The recommendation is that this service must be disabled.",
        "solution": "Identify if writesrv is enabled:\n\nlsitab writesrv | wc -l\n\nIf the command output != '0' stop the service and remove the entry from /etc/inittab\n\nrmitab writesrv\nstopsrc -s writesrv\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nRe-add the writesrv startup line to /etc/inittab:\n\nmkitab 'writesrv:2:wait:/usr/bin/startsrc -swritesrv'",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s writesrv | /usr/bin/grep -v inoperative | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_64": {
        "system": "AIX",
        "description": "3.1.1.4 qdaemon",
        "info": "This is the printing scheduling daemon that manages the submission of print jobs to piobe.\n\nRationale:\n\nIf there is not a requirement to support local or remote printing, remove the qdaemon entry from/etc/inittab.",
        "solution": "In /etc/inittab, remove the qdaemon entry:\n\nrmitab qdaemon\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsitab qdaemon | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_65": {
        "system": "AIX",
        "description": "3.1.1.6 cas_agent",
        "info": "The /etc/inittab entry labeled cas_agent starts an agent that communicates with FSM and/or IBM Director. The agent is started by the SRC subsystem and is installed by the fileset cas.agent.\n\nRationale:\n\nThe products this agent communicates with are depreciated - no longer supported by IBM as POWER platform systems management software. While harmless when running the agent may trigger a security alert due to the way it initializes with FSM (System Director).",
        "solution": "The following command will deinstall the cas.agent fileset and also any filesets installed that depend on cas.agent (e.g., if artex.base.agent is also installed):\n\nlslpp -L cas.agent  >/dev/null 2>&1 && installp -ug cas.agent\n\nDefault Value:\n\n:on: if agent is installed.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lslpp -L cas.agent",
        "expect": "cas.agent[\\\\s]*not[\\\\s]*installed."
    },
    "custom_item_66": {
        "system": "AIX",
        "description": "3.1.2.9 inetd - aka Super Daemon - aka Super Daemon",
        "info": "When none of services run and managed by inetd are required then disable the inetd daemon itself.\n\nThis is the preferred state.\n\nRationale:\n\nWhen no inetd managed services are required there is no need to start the daemon at boot time.\n\nAn administrator can manually start the inetd service post-IPL, should any of the inetd supported services are/become required.\n\nImpact:\n\nWhen an inetd service is required this service is permitted. Be sure to review the section Inetd (aka Super Daemon) Services later in the document.",
        "solution": "Review any active inetd services:\n\nrefresh -s inetd\nlssrc -ls inetd\n\nNOTE: If there are active services and the services are required, do not disable inetd. Skip to the next section and consider the implementation of TCP Wrappers to secure access to these active services. If the active services are not required disable them via the chsubserver command.\nDisable inetd if there are no active services:\n\nchrctcp -d inetd\nstopsrc -s inetd\n\nDefault Value:\n\nEnabled\n\nAdditional Information:\n\nReversion:\n\nComment in inetd startup in /etc/rc.tcpip:\n\nchrctcp -a inetd",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/rc.tcpip",
        "regex": "^[#]+start[\\\\s]+\\/usr\\/sbin\\/inetd[\\\\s]*\"\\\\$src_running\"[\\\\s]*$",
        "expect": "^[#]+start[\\\\s]+\\/usr\\/sbin\\/inetd[\\\\s]*\"\\\\$src_running\"[\\\\s]*$"
    },
    "custom_item_67": {
        "system": "AIX",
        "description": "3.1.2.18 timed",
        "info": "This entry starts the timed daemon at system startup. This is the old, read obsolete, UNIX time service.\n\nRationale:\n\nThe timed daemon is the old UNIX time service. Disable this service.\n\nIf time synchronization is required in your environment use xntp.",
        "solution": "In /etc/rc.tcpip, comment out the timed entry:\n\nchrctcp -d timed\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/rc.tcpip",
        "regex": "^[#]+start[\\\\s]+\\/usr\\/sbin\\/timed[\\\\s]*\"\\\\$src_running\"[\\\\s]*$",
        "expect": "^[#]+start[\\\\s]+\\/usr\\/sbin\\/timed[\\\\s]*\"\\\\$src_running\"[\\\\s]*$"
    },
    "custom_item_68": {
        "system": "AIX",
        "description": "3.1.4.5 NFS - no root access via NFS exports",
        "info": "The superuser (euid==0) should not be able to modify file system objects as a client of an NFS server. Thus, for each NFS export, ensure that the anon aka root_squash option is set to -2 or -1.\n\nRationale:\n\nEach NFS export on the server should have the anon=-2 option set. With this (default) value root (euid==0) is seen as the account nobody. When anon=0 the remote root user has root access on the NFS mount.\n\nBy ensuring the export option anon=-2 when a client process with euid==0 attempts to access (read, write, or delete) the NFS mount the server substitutes the UID to the server's nobody account. This means that the root user on the client cannot access or change files that only root on the server can access or change.\n\nMany NFS servers call this root_squash. On AIX is is called anon. To be consistent with other benchmark terminalogy CIS recommends that root_squash is set on all exported filesystems.\n\nOn AIX the default value of any exported filesystem or directory for anon is -2. Thus, when anon is not set it's effective value is -2. Any other value has to be explicitly set.\n\nAs a more secure option you can set the option to anon=-1. This setting is accepted because it disables anonymous access. By default, secure NFS accepts non-secure requests as anonymous.\n\nNOTE: The root user on the client can still use su to become any other user (change the euid) and access and change that users files, assuming that the same user exists on the NFS server and owns files and/or directories in the NFS export.",
        "solution": "To change this value for all failing NFS exported filesystems:\n\nlsnfsexp | grep -v 'anon=-1' | grep anon= | while read fs rest; do\n chnfsexp -d ${fs} -a -2\ndone\n\nThe command chnfsexp re-exports the file or directory with the new settings active.\n\nDefault Value:\n\n(blank) which is seen as -2 (nobody) effective setting root_squash by default.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "cmd": "/usr/sbin/lsnfsexp -l | /usr/bin/egrep -v \"anon=-1\" | /usr/bin/grep \"anon=\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_69": {
        "system": "AIX",
        "description": "3.1.5.1 bootps",
        "info": "This entry starts the command /usr/sbin/bootpd when required. This service is used to provide boot partition data for a network boot. It uses the same UDP port as DHCP server dhcpsd.\n\nThe recommendation is to disable this service UNLESS you are operating a NIM server. When using NIM bootps as a service is accepted, but the preference would be to configure a DHCP server with the equivalent information.\n\nRationale:\n\nThe bootpd command implements an Internet Boot Protocol server.",
        "solution": "In /etc/inetd.conf, comment out the bootps entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'bootps' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep bootps | wc -l",
        "expect": "0"
    },
    "custom_item_70": {
        "system": "AIX",
        "description": "3.1.5.2 chargen",
        "info": "This entry starts the chargen service when required. This service is used to test the integrity of TCP/IP packets arriving at the destination.\n\nRationale:\n\nThis chargen service is a character generator service and is used for testing the integrity of TCP/IP packets arriving at the destination. An attacker may spoof packets between machines running the chargen service and thus provide an opportunity for DoS attacks. You must disable this service unless you are testing your network.",
        "solution": "In /etc/inetd.conf, comment out the chargen entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep chargen | wc -l",
        "expect": "0"
    },
    "custom_item_71": {
        "system": "AIX",
        "description": "3.1.5.3 comsat",
        "info": "This entry starts the comsat service.\n\nThe comsat daemon receives messages on a datagram port associated with the biff service specification.\n\nThe recommendation is to leave this service disabled.\n\nRationale:\n\nThe comsat daemon is the server that receives reports of incoming mail and notifies users if they have enabled this service with the biff command. Started by the inetd daemon, the comsat daemon is not meant to be used at the command line.",
        "solution": "In /etc/inetd.conf, comment out the comsat entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'comsat' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep comsat | wc -l",
        "expect": "0"
    },
    "custom_item_72": {
        "system": "AIX",
        "description": "3.1.5.4 daytime",
        "info": "The service should be disabled as it can leave the system vulnerable to DoS ping attacks.\n\nThis entry starts the daytime service when required. This provides the current date and time to other servers on a network.\n\nRationale:\n\nThis daytime service is a defunct time service, typically used for testing purposes only.",
        "solution": "In /etc/inetd.conf, comment out the daytime entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p tcp\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep daytime | wc -l",
        "expect": "0"
    },
    "custom_item_73": {
        "system": "AIX",
        "description": "3.1.5.5 discard",
        "info": "This entry starts the discard service when required. This service is used as a debugging tool by setting up a listening socket which ignores the data it receives.\n\nRationale:\n\nThe discard service is used as a debugging and measurement tool. It sets up a listening socket and ignores data that it receives. This is a /dev/null service and is obsolete. This can be used in DoS attacks and therefore, must be disabled.",
        "solution": "In /etc/inetd.conf, comment out the discard entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep discard | wc -l",
        "expect": "0"
    },
    "custom_item_74": {
        "system": "AIX",
        "description": "3.1.5.6 echo",
        "info": "This entry starts the echo service when required. This service sends back data received by it on a specified port.\n\nRationale:\n\nThe echo service sends back data received by it on a specified port. This can be misused by an attacker to launch DoS attacks or Smurf attacks by initiating a data storm and causing network congestion. The service is used for testing purposes and therefore must be disabled if not required.",
        "solution": "In /etc/inetd.conf, comment out the echo entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p tcp\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep echo | wc -l",
        "expect": "0"
    },
    "custom_item_75": {
        "system": "AIX",
        "description": "3.1.5.7 exec",
        "info": "The recommendation is that rexecd is disabled. This service can be performed securely using OpenSSH.\n\nThis entry starts the rexecd daemon when required. This daemon executes a command from a remote system once the connection has been authenticated.\n\nRationale:\n\nThe exec service is used to execute a command sent from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the rexecd daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "In /etc/inetd.conf, comment out the exec entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'exec' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep exec | wc -l",
        "expect": "0"
    },
    "custom_item_76": {
        "system": "AIX",
        "description": "3.1.5.8 finger",
        "info": "This entry starts the fingerd daemon.\n\nRationale:\n\nThe fingerd daemon provides the server function for the finger command. This allows users to view real-time pertinent user login information on other remote systems. This service should be disabled as it may provide an attacker with a valid user list to target.",
        "solution": "In /etc/inetd.conf, comment out the finger entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'finger' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep finger | wc -l",
        "expect": "0"
    },
    "custom_item_77": {
        "system": "AIX",
        "description": "3.1.5.9 ftp",
        "info": "This entry starts the ftpd daemon when required. This service is used for transferring files from/to a remote machine.\n\nThe recommendation is that ftp is disabled and sftp is used as a replacement file and directory copying mechanism.\n\nRationale:\n\nThis ftp service is used to transfer files from or to a remote machine. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the ftpd daemon should be disabled.",
        "solution": "In /etc/inetd.conf, comment out the ftp entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'ftp' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nUncommented",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep ftp | wc -l",
        "expect": "0"
    },
    "custom_item_78": {
        "system": "AIX",
        "description": "3.1.5.10 imap2",
        "info": "This entry starts the imap2 service when required.\n\nRationale:\n\nThe imap2 service orInternet Message Access Protocol (IMAP) supports the IMAP4 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required.",
        "solution": "In /etc/inetd.conf, comment out the imap2 entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'imap2' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep imap2 | wc -l",
        "expect": "0"
    },
    "custom_item_79": {
        "system": "AIX",
        "description": "3.1.5.11 instsrv",
        "info": "This entry starts the instsrv service when required. This service should be disabled.\n\nRationale:\n\nThe instsrv service is part of the Network Installation Tools, used for servicing servers running AIX 3.2.",
        "solution": "In /etc/inetd.conf, comment out the instsrv entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'instsrv' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep instsrv | wc -l",
        "expect": "0"
    },
    "custom_item_80": {
        "system": "AIX",
        "description": "3.1.5.12 klogin",
        "info": "This entry starts the klogin service when required. This is a kerberized login service, which provides a higher degree of security over traditional rlogin and telnet.\n\nRationale:\n\nThe klogin service offers a higher degree of security than traditional rlogin or telnet by eliminating most clear-text password exchanges on the network. However, it is still not as secure as SSH, which encrypts all traffic. If you use klogin to login to a system, the password is not sent in clear text; however, if you su to another user, that password exchange is open to detection from network-sniffing programs. The recommendation is to utilize SSH wherever possible instead of klogin.\n\nIf the klogin service is used, you must use the latest kerberos version available and make sure that all the latest patches are installed.",
        "solution": "In /etc/inetd.conf, comment out the klogin entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'klogin' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep klogin | wc -l",
        "expect": "0"
    },
    "custom_item_81": {
        "system": "AIX",
        "description": "3.1.5.13 kshell",
        "info": "This entry starts the kshell service when required. This is a kerberized remote shell service, which provides a higher degree of security over traditional rsh.\n\nRationale:\n\nThe kshell service offers a higher degree of security than traditional rsh services. However, it still does not use encrypted communications. The recommendation is to utilize SSH wherever possible instead of kshell.\n\nIf the kshell service is used, you should use the latest kerberos version available and must make sure that all the latest patches are installed.",
        "solution": "In /etc/inetd.conf, comment out the kshell entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'kshell' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep kshell | wc -l",
        "expect": "0"
    },
    "custom_item_82": {
        "system": "AIX",
        "description": "3.1.5.14 login",
        "info": "This entry starts the rlogin daemon when required. This service authenticates remote user logins.\n\nRationale:\n\nThis login service is used to authenticate a remote user connection when logging in via the rlogin command. The username and password are passed over the network in clear text and therefore insecurely. Unless required the rlogin daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "In /etc/inetd.conf, comment out the login entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'login' -p tcp6\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nUncommented",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep rlogin | wc -l",
        "expect": "0"
    },
    "custom_item_83": {
        "system": "AIX",
        "description": "3.1.5.15 netstat",
        "info": "This entry executes the command netstat -f inet. This service is displays active IP connections on a server.\n\nThe recommendation is to leave this disabled.\n\nRationale:\n\nThe netstat command symbolically displays the contents of various network-related data structures for active connections.\n\nThis interface requests a report of statistics or address control blocks to those items specified by the inet aka AF_INET (ipv4) address family.",
        "solution": "In /etc/inetd.conf, comment out the netstat entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'netstat' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep netstat | wc -l",
        "expect": "0"
    },
    "custom_item_84": {
        "system": "AIX",
        "description": "3.1.5.16 ntalk",
        "info": "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.\n\nRationale:\n\nThis ntalk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the ntalk service will be disabled.",
        "solution": "In /etc/inetd.conf, comment out the ntalk entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep ntalk | wc -l",
        "expect": "0"
    },
    "custom_item_85": {
        "system": "AIX",
        "description": "3.1.5.17 pcnfsd",
        "info": "This entry starts the pcnfsd daemon when required. This service is an authentication and printing program, which uses NFS to provide file transfer services.\n\nRationale:\n\nThe pcnfsd service is an authentication and printing program, which uses NFS to provide file transfer services. This service is vulnerable and exploitable and permits the machine to be compromised both locally and remotely. If PC NFS clients are required within the environment, Samba is recommended as an alternative software solution. The pcnfsd daemon predates Microsoft's release of SMB specifications. This service should therefore be disabled.",
        "solution": "In /etc/inetd.conf, comment out the pcnfsd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'pcnfsd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep pcnfsd | wc -l",
        "expect": "0"
    },
    "custom_item_86": {
        "system": "AIX",
        "description": "3.1.5.18 pop3",
        "info": "This entry starts the pop3 service when required.\n\nRationale:\n\nThe pop3 service provides a pop3 server. It supports the pop3 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required.",
        "solution": "In /etc/inetd.conf, comment out the pop3 entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'pop3' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/inetd.conf",
        "regex": "^[#]+pop3[\\\\s]+stream[\\\\s]+tcp[\\\\s]+nowait[\\\\s]+root[\\\\s]+\\/usr\\/sbin\\/pop3d[\\\\s]+pop3d[\\\\s]*$",
        "expect": "^[#]+pop3[\\\\s]+stream[\\\\s]+tcp[\\\\s]+nowait[\\\\s]+root[\\\\s]+\\/usr\\/sbin\\/pop3d[\\\\s]+pop3d[\\\\s]*$"
    },
    "custom_item_87": {
        "system": "AIX",
        "description": "3.1.5.19 rexd",
        "info": "This entry starts the rxed service when required.\n\nThis service should be disabled if it is not required.\n\nRationale:\n\nThe rexd daemon executes programs for remote machines when a client issues a request to execute a program on a remote machine. The inetd daemon starts the rexd daemon from the /etc/inetd.conf file.\n\nNon-interactive programs use standard file descriptors connected directly to TCP connections. Interactive programs use pseudo-terminals, similar to the login sessions provided by the rlogin command. The rexd daemon can use the network file system (NFS) to mount the file systems specified in the remote execution request. Diagnostic messages are normally printed on the console and returned to the requester.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rexd' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rexd\" | wc -l",
        "expect": "0"
    },
    "custom_item_88": {
        "system": "AIX",
        "description": "3.1.5.20 rquotad",
        "info": "This entry starts the rquotad service when required. This allows NFS clients to enforce disk quotas on locally mounted filesystems.\n\nRationale:\n\nThe rquotad service allows NFS clients to enforce disk quotas on file systems that are mounted on the local system. This service should be disabled if it is not required.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf and if running, refresh inetd:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rquotad' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rquotad\" | wc -l",
        "expect": "0"
    },
    "custom_item_89": {
        "system": "AIX",
        "description": "3.1.5.21 rstatd",
        "info": "This entry starts the rstatd daemon. This service is used to provide kernel statistics and other monitorable parameters such as CPU usage, system uptime, network usage etc.\n\nThis service should be disabled if not explicitly required by performance monitoring software to collect statistics.\n\nRationale:\n\nThe rstatd service is used to provide kernel statistics and other monitorable parameters pertinent to the system such as: CPU usage, system uptime, network usage etc.\n\nAn attacker may use this information in a DoS attack.",
        "solution": "In /etc/inetd.conf, comment out the rstatd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'rstatd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep rstatd | wc -l",
        "expect": "0"
    },
    "custom_item_90": {
        "system": "AIX",
        "description": "3.1.5.22 rusersd",
        "info": "This entry starts the rsusersd daemon when required. This service provides a list of current users active on a system.\n\nRationale:\n\nThe rusersd service runs as root and provides a list of current users active on a system. An attacker may use this service to learn valid account names on the system. This is not an essential service and should be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rusersd' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rusersd\" | wc -l",
        "expect": "0"
    },
    "custom_item_91": {
        "system": "AIX",
        "description": "3.1.5.23 rwalld",
        "info": "This entry starts the rwalld daemon when required. This service allows remote users to broadcast system wide messages.\n\nRationale:\n\nThe rwalld service allows remote users to broadcast system wide messages. The service runs as root and should be disabled unless absolutely necessary.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rwalld' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rwalld\" | wc -l",
        "expect": "0"
    },
    "custom_item_92": {
        "system": "AIX",
        "description": "3.1.5.24 shell",
        "info": "This entry starts the rshd daemon when required. This daemon executes a command from a remote system.\n\nRationale:\n\nThis shell service is used to execute a command from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the rshd daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'shell' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]shell\" | wc -l",
        "expect": "0"
    },
    "custom_item_93": {
        "system": "AIX",
        "description": "3.1.5.25 sprayd",
        "info": "This entry starts the sprayd daemon when required. This service is used as a tool to generate UDP packets for testing and diagnosing network problems.\n\nRationale:\n\nThe sprayd service is used as a tool to generate UDP packets for testing and diagnosing network problems.\n\nThe service must be disabled if not explicitly required for network performance testing purposes as it can be used as a (Distributed) Denial of Service ((D)DoS) attack.",
        "solution": "In /etc/inetd.conf, comment out the sprayd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'sprayd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep sprayd | wc -l",
        "expect": "0"
    },
    "custom_item_94": {
        "system": "AIX",
        "description": "3.1.5.26 xmquery",
        "info": "This entry starts the xmquery daemon when required. ...\n\nRationale:\n\nThis xmquery service provides near real-time network-based data monitoring and local recording from a given node.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'xmquery' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]xmquery\" | wc -l",
        "expect": "0"
    },
    "custom_item_95": {
        "system": "AIX",
        "description": "3.1.5.27 talk",
        "info": "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.\n\nRationale:\n\nThis talk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the talk service will be disabled",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'talk' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]talk\" | wc -l",
        "expect": "0"
    },
    "custom_item_96": {
        "system": "AIX",
        "description": "3.1.5.28 telnet",
        "info": "The recommendation is that telnet is disabled and OpenSSH is used as a replacement mechanism.\n\nThis entry starts the telnetd daemon when required. This provides a protocol for command line access from a remote machine.\n\nRationale:\n\nThe telnet protocol passes username and password in clear text over the network in clear text and therefore insecurely.\n\nThis telnet service is used to service remote user connections. Historically, telnet was the most commonly used remote access method for UNIX servers. This has been replaced by OpenSSH (or no remote CLI access).\n\nUnless required the telnetd daemon should be disabled.\n\nImpact:\n\nWhen OpenSSH is not available other steps should be examined, e.g., a bastion hosted environment where OpenSSH is used to get to the bastion host and then telnet from bastion to telnet-only server.",
        "solution": "In /etc/inetd.conf, comment out the telnet entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'telnet' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep telnet | wc -l",
        "expect": "0"
    },
    "custom_item_97": {
        "system": "AIX",
        "description": "3.1.5.29 tftp",
        "info": "This entry starts the tftp service when required.\n\nRationale:\n\nThe tftp service allows remote systems to download or upload files to the tftp server without any authentication. It is therefore a service that should not run, unless needed. One of the main reasons for requiring this service to be activated is if the host is a NIM master. However, the service can be enabled and then disabled once a NIM operation has completed, rather than left running permanently.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'tftp' -p 'udp6'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]tftp\" | wc -l",
        "expect": "0"
    },
    "custom_item_98": {
        "system": "AIX",
        "description": "3.1.5.30 time",
        "info": "This entry starts the time service when required. This service can be used to synchronize system clocks.\n\nRationale:\n\nThe time service is an obsolete process used to synchronize system clocks at boot time. This has been superseded by NTP, which should be use if time synchronization is necessary. Unless required the time service will be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'tcp'\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]time\" | wc -l",
        "expect": "0"
    },
    "custom_item_99": {
        "system": "AIX",
        "description": "4.3.9 uucp",
        "info": "This change locks and disables login access for the uucp user account.\n\nRationale:\n\nThis change disables direct local and remote login to the uucp user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the uucp user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to uucp user:\n\nchuser account_locked=true login=false rlogin=false uucp\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|4.6,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin uucp",
        "expect": "^[\\\\s]*uucp[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*$"
    },
    "custom_item_100": {
        "system": "AIX",
        "description": "3.1.4.2 NFS - enable both nosuid and nodev options on NFS client mounts - nosuid",
        "info": "Disable suid/sgid program execution and/or access to system devices via permissions set on any mounted NFS filesystem.\n\nRationale:\n\nSetting the nosuid and nodev options means that files on the NFS server cannot be used to gain privileged access on the client.\n\nThis hampers a malicious user from creating an attack vector on the server and then log onto an NFS client as a standard user and use the suid/sgid program to effectively become another user (especially root) on that client.\n\nThe nodev options blocks malicious/accidental (raw) access to system devices (e.g., /dev/kmem, /dev/rhdisk0). Access to devices is not exclusive to the /dev directory. Device access is so-called special-files that are defined as a Major, Minor device id's.",
        "solution": "For each NFS mount, disable suid programs and device access. List the current NFS mounts:\n\nlsnfsmnt -l | /usr/bin/egrep -v '^Name' | /usr/bin/grep -v 'nosuid' | while read remote local host rest; do\n chnfsmnt -d ${remote} -f ${local} -h ${host} -y -z\ndone\n\nlsnfsmnt -l | /usr/bin/egrep -v '^Name' | /usr/bin/grep -v 'nodev' | while read remote local host rest; do\n chnfsmnt -d ${remote} -f ${local} -h ${host} -y -z\ndone\n\nNOTE: The NFS mount needs is re-mounted automatically by chnfsmnt.\nNOTE: The second loop might not do anything as both loops set both nosuid (-y) and nodev (-z)\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsnfsmnt -l | /usr/bin/egrep -v \"^Name\" | /usr/bin/grep -v \"nosuid\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_101": {
        "system": "AIX",
        "description": "3.1.4.2 NFS - enable both nosuid and nodev options on NFS client mounts - nodev",
        "info": "Disable suid/sgid program execution and/or access to system devices via permissions set on any mounted NFS filesystem.\n\nRationale:\n\nSetting the nosuid and nodev options means that files on the NFS server cannot be used to gain privileged access on the client.\n\nThis hampers a malicious user from creating an attack vector on the server and then log onto an NFS client as a standard user and use the suid/sgid program to effectively become another user (especially root) on that client.\n\nThe nodev options blocks malicious/accidental (raw) access to system devices (e.g., /dev/kmem, /dev/rhdisk0). Access to devices is not exclusive to the /dev directory. Device access is so-called special-files that are defined as a Major, Minor device id's.",
        "solution": "For each NFS mount, disable suid programs and device access. List the current NFS mounts:\n\nlsnfsmnt -l | /usr/bin/egrep -v '^Name' | /usr/bin/grep -v 'nosuid' | while read remote local host rest; do\n chnfsmnt -d ${remote} -f ${local} -h ${host} -y -z\ndone\n\nlsnfsmnt -l | /usr/bin/egrep -v '^Name' | /usr/bin/grep -v 'nodev' | while read remote local host rest; do\n chnfsmnt -d ${remote} -f ${local} -h ${host} -y -z\ndone\n\nNOTE: The NFS mount needs is re-mounted automatically by chnfsmnt.\nNOTE: The second loop might not do anything as both loops set both nosuid (-y) and nodev (-z)\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsnfsmnt -l | /usr/bin/egrep -v \"^Name\" | /usr/bin/grep -v \"nodev\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_102": {
        "system": "AIX",
        "description": "3.1.4.3 NFS - localhost removal - localhost removal",
        "info": "Remove any reference to localhost or localhost aliases from /etc/exports.\n\nRationale:\n\nIf the RPC portmapper has proxy forwarding enabled, which is a default setting in many vendor versions. You must not export your local filesytems back to the localhost, either by name or to the alias localhost, and you must not export to any netgroups of which your host is a member. If proxy forwarding is enabled, an attacker may carefully craft NFS packets and send them to the portmapper, which in turn, forwards them to the NFS server. As the packets come from the portmapper process, which runs as root, they appear to be coming from a trusted system. This configuration may allow anyone to alter and delete files at will.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove any reference to localhost or localhost aliases in /etc/exports: Review the content of /etc/exports and check for localhost or localhost aliases:\n\ncat /etc/exports\n\nNOTE: If instances of localhost or localhost aliases are found, edit the file and remove them. Create a copy of /etc/exports:\n\ncp -p /etc/exports /etc/exports.pre_cis\n\nEdit the file:\n\nvi /etc/exports\n\nEdit the relevant NFS exports to remove the localhost access, for example:\n\n/nfsexport sec=sys,rw,access=localhost:testserver\n\nIf /etc/exports is updated, as localhost references have been removed, update the current NFS export options:\n\nexportfs -a\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/cat /etc/exports",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_103": {
        "system": "AIX",
        "description": "3.3.1 bcastping",
        "info": "The bcastping parameter determines whether the system responds to ICMP echo packets sent to the broadcast address.\n\nRationale:\n\nThe bcastping parameter will be set to 0. This means that the system will not respond to ICMP packets sent to the broadcast address. By default, when this is enabled the system is susceptible to smurf attacks, where a hacker utilizes this tool to send a small number of ICMP echo packets. These packets can generate huge numbers of ICMP echo replies and seriously affect the performance of the targeted host and network. This parameter will be disabled to ensure protection from this type of attack.",
        "solution": "In /etc/tunables/nextboot, add the bcastping entry:\n\nno -p -o bcastping=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"bcastping\"",
        "expect": "^[\\\\s]*bcastping[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_104": {
        "system": "AIX",
        "description": "3.3.2 clean_partial_conns",
        "info": "The clean_partial_conns parameter determines whether or not the system is open to SYN attacks. This parameter, when enabled, clears down connections in the SYN RECEIVED state after a set period of time. This attempts to stop DoS attacks when a hacker may flood a system with SYN flag set packets.\n\nRationale:\n\nThe clean_partial_conns parameter will be set to 1, to clear down pending SYN received connections after a set period of time.",
        "solution": "In /etc/tunables/nextboot, add the clean_partial_conns entry:\n\nno -p -o clean_partial_conns=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"clean_partial_conns\"",
        "expect": "^[\\\\s]*clean_partial_conns[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_105": {
        "system": "AIX",
        "description": "3.3.3 directed_broadcast",
        "info": "The directed_broadcast parameter determines whether or not the system allows a directed broadcast to a network gateway.\n\nRationale:\n\nThe directed_broadcast parameter will be set to 0, to prevent directed broadcasts being sent network gateways. This would prevent a redirected packet from reaching a remote network.",
        "solution": "In /etc/tunables/nextboot, add the directed_broadcast entry:\n\nno -p -o directed_broadcast=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(9),800-53r5|SC-7(9),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(9),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"directed_broadcast\"",
        "expect": "^[\\\\s]*directed_broadcast[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_106": {
        "system": "AIX",
        "description": "3.3.4 icmpaddressmask",
        "info": "The icmpaddressmask parameter determines whether the system responds to an ICMP address mask ping.\n\nRationale:\n\nThe icmpaddressmask parameter will be set to 0, This means that the system will not respond to ICMP address mask request pings. By default, when this is enabled the system is susceptible to source routing attacks. This is typically a feature performed by a device such as a network router and should not be enabled within the operating system.",
        "solution": "In /etc/tunables/nextboot, add the icmpaddressmask entry:\n\nno -p -o icmpaddressmask=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"icmpaddressmask\"",
        "expect": "^[\\\\s]*icmpaddressmask[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_107": {
        "system": "AIX",
        "description": "3.3.5 ipforwarding",
        "info": "The ipforwarding parameter determines whether or not the system forwards TCP/IP packets.\n\nRationale:\n\nThe ipforwarding parameter will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device.",
        "solution": "In /etc/tunables/nextboot, add the ipforwarding entry:\n\nno -p -o ipforwarding=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipforwarding\"",
        "expect": "^[\\\\s]*ipforwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_108": {
        "system": "AIX",
        "description": "3.3.6 ipignoreredirects",
        "info": "The ipignoreredirects parameter determines whether or not the system will process IP redirects.\n\nRationale:\n\nThe ipignoreredirects will be set to 1, to prevent IP re-directs being processed by the system.",
        "solution": "In /etc/tunables/nextboot, add the ipignoreredirects entry:\n\nno -p -o ipignoreredirects=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipignoreredirects\"",
        "expect": "^[\\\\s]*ipignoreredirects[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_109": {
        "system": "AIX",
        "description": "3.3.7 ipsendredirects",
        "info": "The ipsendredirects parameter determines whether or not the system forwards re-directed TCP/IP packets.\n\nRationale:\n\nThe ipsendredirects parameter will be set to 0, to ensure that redirected packets do not reach remote networks.",
        "solution": "In /etc/tunables/nextboot, add the ipsendredirects entry:\n\nno -p -o ipsendredirects=0\n\nThis makes the change permanent by adding the entry into/etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipsendredirects\"",
        "expect": "^[\\\\s]*ipsendredirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_110": {
        "system": "AIX",
        "description": "3.3.8 ipsrcrouteforward",
        "info": "The ipsrcrouteforward parameter determines whether or not the system forwards IPV4 source-routed packets.\n\nRationale:\n\nThe ipsrcrouteforward will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcrouteforward entry:\n\nno -p -o ipsrcrouteforward=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipsrcrouteforward\"",
        "expect": "^[\\\\s]*ipsrcrouteforward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_111": {
        "system": "AIX",
        "description": "3.3.9 ipsrcrouterecv",
        "info": "The ipsrcrouterecv parameter determines whether the system accepts source routed packets.\n\nRationale:\n\nThe ipsrcrouterecv parameter will be set to 0, This means that the system will not accept source routed packets. By default, when this is enabled the system is susceptible to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcrouterecv entry:\n\nno -p -o ipsrcrouterecv=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipsrcrouterecv\"",
        "expect": "^[\\\\s]*ipsrcrouterecv[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_112": {
        "system": "AIX",
        "description": "3.3.10 ipsrcroutesend",
        "info": "The ipsrcroutesend parameter determines whether or not the system can send source-routed packets.\n\nRationale:\n\nThe ipsrcroutesend parameter will be set to 0, to ensure that any local applications cannot send source routed packets.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcroutesend entry:\n\nno -p -o ipsrcroutesend=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ipsrcroutesend\"",
        "expect": "^[\\\\s]*ipsrcroutesend[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_113": {
        "system": "AIX",
        "description": "3.3.11 ip6srcrouteforward",
        "info": "The ip6srcrouteforward parameter determines whether or not the system forwards IPV6 source-routed packets.\n\nRationale:\n\nThe ip6srcrouteforward parameter will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall.",
        "solution": "In /etc/tunables/nextboot, add the ip6srcrouteforward entry:\n\nno -p -o ip6srcrouteforward=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"ip6srcrouteforward\"",
        "expect": "^[\\\\s]*ip6srcrouteforward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_114": {
        "system": "AIX",
        "description": "3.3.12 nfs_use_reserved_ports - portcheck",
        "info": "The portcheck and nfs_use_reserved_ports parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).\n\nRationale:\n\nThe portcheck and nfs_use_reserved_ports parameters will both be set to 1. This value means that NFS client requests that do not originate from the privileged ports range (ports less than 1024) will be ignored by the local system.",
        "solution": "In /etc/tunables/nextboot, add the portcheck and nfs_use_reserved_ports entries:\n\nnfso -p -o portcheck=1\nnfso -p -o nfs_use_reserved_ports=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/nfso -a | /usr/bin/grep \"portcheck\"",
        "expect": "^[\\\\s]*portcheck[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_115": {
        "system": "AIX",
        "description": "3.3.12 nfs_use_reserved_ports - nfs_use_reserved_ports",
        "info": "The portcheck and nfs_use_reserved_ports parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).\n\nRationale:\n\nThe portcheck and nfs_use_reserved_ports parameters will both be set to 1. This value means that NFS client requests that do not originate from the privileged ports range (ports less than 1024) will be ignored by the local system.",
        "solution": "In /etc/tunables/nextboot, add the portcheck and nfs_use_reserved_ports entries:\n\nnfso -p -o portcheck=1\nnfso -p -o nfs_use_reserved_ports=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|1A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/nfso -a | /usr/bin/grep \"nfs_use_reserved_ports\"",
        "expect": "^[\\\\s]*nfs_use_reserved_ports[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_116": {
        "system": "AIX",
        "description": "3.3.13 nonlocsrcroute",
        "info": "The nonlocsrcroute parameter determines whether the system allows source routed packets to be addressed to hosts outside of the LAN.\n\nRationale:\n\nThe nonlocsrcroute parameter will be set to 0. This means that the system will not allow source routed packets to be addressed to hosts outside of the LAN. By default, when this is enabled the system is susceptible to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the nonlocsrcroute entry:\n\nno -p -o nonlocsrcroute=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"nonlocsrcroute\"",
        "expect": "^[\\\\s]*nonlocsrcroute[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_117": {
        "system": "AIX",
        "description": "3.3.14 sockthresh",
        "info": "The sockthresh parameter value determines what percentage of the total memory allocated to networking, set via thewall, can be used for sockets.\n\nRationale:\n\nThe sockthresh parameterwill be set to 60. This means that 60% of network memory can be used to service new socket connections, the remaining 40% is reserved for existing sockets. This ensures a quality of service for existing connections.",
        "solution": "In /etc/tunables/nextboot, add the sockthresh entry:\n\nno -p -o sockthresh=60\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"sockthresh\"",
        "expect": "^[\\\\s]*sockthresh[\\\\s]*=[\\\\s]*60[\\\\s]*$"
    },
    "custom_item_118": {
        "system": "AIX",
        "description": "3.3.15 tcp_pmtu_discover",
        "info": "The tcp_pmtu_discover parameter controls whether TCP MTU discovery is enabled.\n\nRationale:\n\nThe tcp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When tcp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the tcp_pmtu_discover entry:\n\nno -p -o tcp_pmtu_discover=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"tcp_pmtu_discover\"",
        "expect": "^[\\\\s]*tcp_pmtu_discover[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_119": {
        "system": "AIX",
        "description": "3.3.16 tcp_tcpsecure",
        "info": "The tcp_tcpsecure parameter value determines if the system is protected from three specific TCP vulnerabilities: The values are ORed together. If all three values are to be set the value to set is: 1|2|4 (or 7).\n\nFake SYN - This is used to terminate an established connection. A tcp_tcpsecure bit-value of 1 protects the system from this vulnerability.\n\nFake RST - As above, this is used to terminate an established connection. A tcp_tcpsecure bit-value of 2 protects the system from this vulnerability.\n\nFake data - A hacker may inject fake data into an established connection. A tcp_tcpsecure bit-value of 4 protects the system from this vulnerability.\n\nRationale:\n\nThe tcp_tcpsecure parameter should be set to 7. This means that the system will be protected from TCP connection reset and data integrity attacks.",
        "solution": "In /etc/tunables/nextboot, add the tcp_tcpsecure entry:\n\nno -p -o tcp_tcpsecure=7\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot.\n\nDefault Value:\n\ntcp_tcpsecure = 0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -o tcp_tcpsecure",
        "expect": "^[\\\\s]*tcp_tcpsecure[\\\\s]*=[\\\\s]*7[\\\\s]*$"
    },
    "custom_item_120": {
        "system": "AIX",
        "description": "3.3.17 udp_pmtu_discover",
        "info": "The udp_pmtu_discover parameter controls whether MTU discovery is enabled.\n\nRationale:\n\nThe udp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When udp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the udp_pmtu_discover entry:\n\nno -p -o udp_pmtu_discover=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep \"udp_pmtu_discover\"",
        "expect": "^[\\\\s]*udp_pmtu_discover[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_121": {
        "system": "AIX",
        "description": "2.3 Ensure default user umask is 027 or more restrictive",
        "info": "The user file-creation mode mask (umask) is used to determine the file permission for newly created directories and files. In AIX, the default permissions for any newly created directory is 0755 (rwxr-xr-x), and for any newly created file it is 0644 (rw-r--r--). The umask modifies the default AIX permissions by restricting (masking) these permissions. The umask is not simply subtracted, but is processed bitwise. Bits set in the umask are cleared in the resulting file mode.\n\nRationale:\n\nSetting a very secure default value for umask ensures that users make a conscious choice about their file permissions. A default umask setting of 077 causes files and directories created by users to not be readable by any other user on the system. A umask of 027 would make files and directories readable by users in the same Unix group, while a umask of 022 would make files readable by every user on the system.",
        "solution": "Add the umask attribute to the default user stanza in /etc/security/user:\n\nchsec -f /etc/security/user -s default -a umask=027\n\nDefault Value:\n\numask=022",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a umask",
        "expect": "^[\\\\s]*default[\\\\s]+umask[\\\\s]*=[\\\\s]*[0-2][0-7][\\\\s]*$"
    },
    "custom_item_122": {
        "description": "Verify CDE is installed.",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_123": {
        "system": "AIX",
        "description": "3.2.5 CDE - sgid/suid binary lockdown - /usr/dt/bin/dtaction",
        "info": "CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys.\n\nRationale:\n\nCDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys. It is recommended that the CDE binaries have the suid/sgid removed.",
        "solution": "Remove the suid/sgid from the following CDE binaries:\n\nchmod ug-s /usr/dt/bin/dtaction\nchmod ug-s /usr/dt/bin/dtappgather\nchmod ug-s /usr/dt/bin/dtprintinfo\nchmod ug-s /usr/dt/bin/dtsession\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/usr/dt/bin/dtaction",
        "mask": "6000"
    },
    "custom_item_124": {
        "system": "AIX",
        "description": "3.2.5 CDE - sgid/suid binary lockdown - /usr/dt/bin/dtappgather",
        "info": "CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys.\n\nRationale:\n\nCDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys. It is recommended that the CDE binaries have the suid/sgid removed.",
        "solution": "Remove the suid/sgid from the following CDE binaries:\n\nchmod ug-s /usr/dt/bin/dtaction\nchmod ug-s /usr/dt/bin/dtappgather\nchmod ug-s /usr/dt/bin/dtprintinfo\nchmod ug-s /usr/dt/bin/dtsession\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/usr/dt/bin/dtappgather",
        "mask": "6000"
    },
    "custom_item_125": {
        "system": "AIX",
        "description": "3.2.5 CDE - sgid/suid binary lockdown - /usr/dt/bin/dtprintinfo",
        "info": "CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys.\n\nRationale:\n\nCDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys. It is recommended that the CDE binaries have the suid/sgid removed.",
        "solution": "Remove the suid/sgid from the following CDE binaries:\n\nchmod ug-s /usr/dt/bin/dtaction\nchmod ug-s /usr/dt/bin/dtappgather\nchmod ug-s /usr/dt/bin/dtprintinfo\nchmod ug-s /usr/dt/bin/dtsession\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/usr/dt/bin/dtprintinfo",
        "mask": "6000"
    },
    "custom_item_126": {
        "system": "AIX",
        "description": "3.2.5 CDE - sgid/suid binary lockdown - /usr/dt/bin/dtsession",
        "info": "CDE buffer overflow vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys.\n\nRationale:\n\nCDE has been associated with major security risks, most of which are buffer overflow vulnerabilities. These vulnerabilities may be exploited by a local user to obtain root privilege via suid/sgid programs owned by root:bin or root:sys. It is recommended that the CDE binaries have the suid/sgid removed.",
        "solution": "Remove the suid/sgid from the following CDE binaries:\n\nchmod ug-s /usr/dt/bin/dtaction\nchmod ug-s /usr/dt/bin/dtappgather\nchmod ug-s /usr/dt/bin/dtprintinfo\nchmod ug-s /usr/dt/bin/dtsession\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/usr/dt/bin/dtsession",
        "mask": "6000"
    },
    "custom_item_127": {
        "system": "AIX",
        "description": "3.2.7 CDE - screensaver lock - dtsession*saverTimeout",
        "info": "The default timeout is 30 minutes of keyboard and mouse inactivity before a password protected screensaver is invoked by the CDE session manager.\n\nRationale:\n\nThe default timeout of 30 minutes prior to a password protected screensaver being invoked is too long. The recommendation is to set this to 10 minutes to protect from unauthorized access on unattended systems.",
        "solution": "Set the default timeout parameters dtsession*saverTimeout: and dtsession*lockTimeout:\n\nfor file in /usr/dt/config/*/sys.resources; do\n   dir='dirname $file | sed -e s/usr/etc/'\n   mkdir -p $dir\n   echo 'dtsession*saverTimeout: 10' >> $dir/sys.resources\n   echo 'dtsession*lockTimeout: 10' >> $dir/sys.resources\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.8,800-171|3.1.10,800-171|3.1.11,800-171|3.1.18,800-53|AC-2(5),800-53|AC-7,800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53|AC-19,800-53r5|AC-2(5),800-53r5|AC-7,800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,800-53r5|AC-19,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv8|4.3,CSCv8|4.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-7,ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,ITSG-33|AC-19,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|36.2.4,TBA-FIISB|37.1.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*dtsession[\\\\*]saverTimeout:",
        "expect": "^[\\\\s]*dtsession[\\\\*]saverTimeout:[\\\\s]+([1-9]|10)[\\\\s]*$"
    },
    "custom_item_128": {
        "system": "AIX",
        "description": "3.2.7 CDE - screensaver lock - dtsession*lockTimeout",
        "info": "The default timeout is 30 minutes of keyboard and mouse inactivity before a password protected screensaver is invoked by the CDE session manager.\n\nRationale:\n\nThe default timeout of 30 minutes prior to a password protected screensaver being invoked is too long. The recommendation is to set this to 10 minutes to protect from unauthorized access on unattended systems.",
        "solution": "Set the default timeout parameters dtsession*saverTimeout: and dtsession*lockTimeout:\n\nfor file in /usr/dt/config/*/sys.resources; do\n   dir='dirname $file | sed -e s/usr/etc/'\n   mkdir -p $dir\n   echo 'dtsession*saverTimeout: 10' >> $dir/sys.resources\n   echo 'dtsession*lockTimeout: 10' >> $dir/sys.resources\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.8,800-171|3.1.10,800-171|3.1.11,800-171|3.1.18,800-53|AC-2(5),800-53|AC-7,800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53|AC-19,800-53r5|AC-2(5),800-53r5|AC-7,800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,800-53r5|AC-19,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv8|4.3,CSCv8|4.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-7,ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,ITSG-33|AC-19,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM24,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|36.2.4,TBA-FIISB|37.1.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*dtsession[\\\\*]lockTimeout:",
        "expect": "^[\\\\s]*dtsession[\\\\*]lockTimeout:[\\\\s]+([1-9]|10)[\\\\s]*$"
    },
    "custom_item_129": {
        "system": "AIX",
        "description": "3.2.8 CDE - login screen hostname masking - dtlogin.greeting.labelString",
        "info": "The Dtlogin*greeting.labelString parameter is the message displayed in the first dialogue box on the CDE login screen. This is where the username is entered.\n\nThe Dtlogin*greeting.persLabelString is the message displayed in the second dialogue box on the CDE login screen. This is where the password is entered.\n\nRationale:\n\nPotential hackers may gain access to valuable information such as the hostname and the version of the operating system from the default AIX login screen. This information would assist hackers in choosing the exploitation methods to break into the system. For security reasons, change the login screen default messages.",
        "solution": "Copy the files from /usr/dt/config/*/Xresources to /etc/dt/config/*/Xresources and add the Dtlogin*greeting.labelString and Dtlogin*greeting.persLabelString parameters to all copied Xresources files:\n\nfor file in /usr/dt/config/*/Xresources; do\n  dir='dirname $file | sed s/usr/etc/'\n  mkdir -p $dir\n  if [ ! -f $dir/Xresources ]; then\n    cp $file $dir/Xresources\n  fi\n  WARN='Authorized uses only. All activity may be monitored and reported.'\n  echo 'Dtlogin*greeting.labelString: $WARN' >> $dir/Xresources\n  echo 'Dtlogin*greeting.persLabelString: $WARN' >> $dir/Xresources\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1A,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]labelString:",
        "expect": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]labelString:[\\\\s]+Authorized[\\\\s]+uses[\\\\s]+only[\\\\.][\\\\s]+All[\\\\s]+activity[\\\\s]+may[\\\\s]+be[\\\\s]+monitored[\\\\s]+and[\\\\s]+reported[\\\\.][\\\\s]*$"
    },
    "custom_item_130": {
        "system": "AIX",
        "description": "3.2.8 CDE - login screen hostname masking - dtlogin.greeting.persLabelString",
        "info": "The Dtlogin*greeting.labelString parameter is the message displayed in the first dialogue box on the CDE login screen. This is where the username is entered.\n\nThe Dtlogin*greeting.persLabelString is the message displayed in the second dialogue box on the CDE login screen. This is where the password is entered.\n\nRationale:\n\nPotential hackers may gain access to valuable information such as the hostname and the version of the operating system from the default AIX login screen. This information would assist hackers in choosing the exploitation methods to break into the system. For security reasons, change the login screen default messages.",
        "solution": "Copy the files from /usr/dt/config/*/Xresources to /etc/dt/config/*/Xresources and add the Dtlogin*greeting.labelString and Dtlogin*greeting.persLabelString parameters to all copied Xresources files:\n\nfor file in /usr/dt/config/*/Xresources; do\n  dir='dirname $file | sed s/usr/etc/'\n  mkdir -p $dir\n  if [ ! -f $dir/Xresources ]; then\n    cp $file $dir/Xresources\n  fi\n  WARN='Authorized uses only. All activity may be monitored and reported.'\n  echo 'Dtlogin*greeting.labelString: $WARN' >> $dir/Xresources\n  echo 'Dtlogin*greeting.persLabelString: $WARN' >> $dir/Xresources\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1A,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]persLabelString:",
        "expect": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]persLabelString:[\\\\s]+Authorized[\\\\s]+uses[\\\\s]+only[\\\\.][\\\\s]+All[\\\\s]+activity[\\\\s]+may[\\\\s]+be[\\\\s]+monitored[\\\\s]+and[\\\\s]+reported[\\\\.][\\\\s]*$"
    },
    "custom_item_131": {
        "system": "AIX",
        "description": "3.2.9 CDE - /etc/dt/config/Xconfig permissions and ownership - /etc/dt/config/Xconfig permissions and ownership",
        "info": "The /etc/dt/config/Xconfig file is used to customize CDE DT login attributes. Ensure this file is owned by root:bin and permissions prevent group and other from writing to the file.\n\nRationale:\n\nThe /etc/dt/config/Xconfig file can be used to customize CDE DT login attributes. The default file, /usr/dt/config/Xconfig, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Check to see if the /etc/dt/config/Xconfig exists:\n\nls -l /etc/dt/config/Xconfig\n\nApply the appropriate ownership and permissions to /etc/dt/config/Xconfig:\n\nchown root:bin /etc/dt/config/Xconfig\nchmod go-w /etc/dt/config/Xconfig\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/Xconfig",
        "owner": "root",
        "mask": "333",
        "group": "bin"
    },
    "custom_item_132": {
        "system": "AIX",
        "description": "3.2.10 CDE - /etc/dt/config/Xservers permissions and ownership - permissions and ownership",
        "info": "The /etc/dt/config/Xservers contains entries to start the Xserver on the local display. Ensure this file is owned by root:bin and prevents group and other from writing to it.\n\nRationale:\n\nThe /etc/dt/config/Xservers contains entries to start the Xserver on the local display. The default file, /usr/dt/config/Xservers, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Check to see if the /etc/dt/config/Xservers exists:\n\nls -l /etc/dt/config/Xservers\n\nIf it exists ensure that it is explicitly defined in /etc/dt/config/Xconfig:\n\nvi /etc/dt/config/Xconfig\n\nReplace:\n\nDtlogin*servers:               Xservers\n\nWith:\n\nDtlogin*servers: /etc/dt/config/Xservers\n\nApply the appropriate ownership and permissions to /etc/dt/config/Xservers:\n\nchown root:bin /etc/dt/config/Xservers\nchmod go-w /etc/dt/config/Xservers\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/Xservers",
        "owner": "root",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_133": {
        "system": "AIX",
        "description": "3.2.10 CDE - /etc/dt/config/Xservers permissions and ownership - explicit definition",
        "info": "The /etc/dt/config/Xservers contains entries to start the Xserver on the local display. Ensure this file is owned by root:bin and prevents group and other from writing to it.\n\nRationale:\n\nThe /etc/dt/config/Xservers contains entries to start the Xserver on the local display. The default file, /usr/dt/config/Xservers, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Check to see if the /etc/dt/config/Xservers exists:\n\nls -l /etc/dt/config/Xservers\n\nIf it exists ensure that it is explicitly defined in /etc/dt/config/Xconfig:\n\nvi /etc/dt/config/Xconfig\n\nReplace:\n\nDtlogin*servers:               Xservers\n\nWith:\n\nDtlogin*servers: /etc/dt/config/Xservers\n\nApply the appropriate ownership and permissions to /etc/dt/config/Xservers:\n\nchown root:bin /etc/dt/config/Xservers\nchmod go-w /etc/dt/config/Xservers\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/Xconfig",
        "regex": "^[\\\\s]*Dtlogin[\\\\.]servers:",
        "expect": "^[\\\\s]*Dtlogin[\\\\.]servers:[\\\\s]+/etc/dt/config/Xservers[\\\\s]*$"
    },
    "custom_item_134": {
        "system": "AIX",
        "description": "3.2.11 CDE - /etc/dt/config/*/Xresources permissions and ownership - /etc/dt/config/*/Xresources permissions and ownership",
        "info": "The /etc/dt/config/*/Xresources file contains appearance and behavior resources for the Dtlogin login screen.\n\nRationale:\n\nThe /etc/dt/config/*/Xresources file defines the customization of the Dtlogin screen. The default file, /usr/dt/config/*/Xresources, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Set the appropriate permissions and ownership on all Xresources files:\n\nchown root:sys /etc/dt/config/*/Xresources\nchmod u=rw,go=r /etc/dt/config/*/Xresources\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/dt/config/*/Xresources",
        "owner": "root",
        "mask": "133",
        "group": "sys"
    },
    "custom_item_135": {
        "system": "AIX",
        "description": "3.4.1 /etc/security/login.cfg - logintimeout - logintimeout",
        "info": "Defines the number of seconds during which the password must be typed at login.\n\nRationale:\n\nIn setting the logintimeout attribute, a password must be entered within a specified time period.",
        "solution": "In /etc/security/login.cfg, set the usw stanza logintimeout attribute to 30 or less:\n\nchsec -f /etc/security/login.cfg -s usw -a logintimeout=30\n\nThis means that a user will have 30 seconds, from prompting, in which to type in their password.\n\nDefault Value:\n\n60",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s usw -a logintimeout",
        "expect": "^usw[\\\\s]+logintimeout[\\\\s]*=[\\\\s]*([1-9]|[12][0-9]|30)[\\\\s]*$"
    },
    "custom_item_136": {
        "system": "AIX",
        "description": "3.4.2 /etc/security/login.cfg - logindelay - logindelay",
        "info": "Defines the number of seconds delay between each failed login attempt. This works as a multiplier, so if the parameter is set to 10, after the first failed login it would delay for 10 seconds, after the second failed login 20 seconds etc.\n\nRationale:\n\nIn setting the logindelay attribute, this implements a delay multiplier in-between unsuccessful login attempts.",
        "solution": "In /etc/security/login.cfg, set the default stanza logindelay attribute to 10 or greater:\n\nchsec -f /etc/security/login.cfg -s default -a logindelay=10\n\nThis means that a user will have to wait 10 seconds before being able to re-enter their password. During subsequent attempts this delay will increase as a multiplier of (the number of failed login attempts * logindelay)\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,LEVEL|1A,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s default -a logindelay",
        "expect": "^default[\\\\s]+logindelay[\\\\s]*=[\\\\s]*[1-9][0-9]+[\\\\s]*$"
    },
    "custom_item_137": {
        "system": "AIX",
        "description": "3.4.4 herald (logon message) - logon message",
        "info": "This change adds a default herald to /etc/security/login.cfg.\n\nRationale:\n\nThis change puts into place a suggested login herald to replace the default entry. A herald should not provide any information about the operating system or version. Instead, it should detail a company standard acceptable use policy.\n\nThis suggestion for a herald should be tailored to reflect your corporate standard policy.",
        "solution": "Add a default login herald to /etc/security/login.cfg:\n\nchsec -f /etc/security/login.cfg -s default -a herald='Unauthorized use of this system is prohibited.\\\\nlogin:'\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,LEVEL|1A,NESA|M1.3.6,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/security/login.cfg",
        "content": "@LOGIN_HERALD_TEXT@"
    },
    "custom_item_138": {
        "system": "AIX",
        "description": "3.7.1.5 /etc/security/audit",
        "info": "The /etc/security/audit directory contains the system audit configuration files.\n\nRationale:\n\nThe /etc/security/audit directory stores the audit configuration files. This directory must have adequate access controls to prevent unauthorized access.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/security/audit:\n\nchown -R root:audit /etc/security/audit\nchmod u=rwx,g=rx,o= /etc/security/audit\nchmod -R u=rw,g=r,o= /etc/security/audit/*\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/security/audit",
        "owner": "root",
        "mask": "027",
        "group": "audit"
    },
    "custom_item_139": {
        "system": "AIX",
        "description": "3.7.1.6 /var/adm/ras",
        "info": "The /var/adm/ras directory contains log files which contain sensitive information such as login times and IP addresses.\n\nRationale:\n\nThe log files in the /var/adm/ras directory can contain sensitive information such as login times and IP addresses, which may be altered by an attacker when removing traces of system access. All files in this directory must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write access from all files in /var/adm/ras:\n\nchmod o-rw /var/adm/ras/*\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/find /var/adm/ras/* -type f -perm -0004 -depth -print | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_140": {
        "system": "AIX",
        "description": "3.7.1.7 /var/adm/sa",
        "info": "The /var/adm/sa directory holds the performance data produced by the sar utility.\n\nRationale:\n\nThe /var/adm/sa directory contains the report files produced by the sar utility. This directory must be secured from unauthorized access.",
        "solution": "Set the recommended ownership and permissions on /var/adm/sa:\n\nchown adm:adm /var/adm/sa\nchmod u=rwx,go=rx /var/adm/sa\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/sa",
        "owner": "adm",
        "mask": "022",
        "group": "adm"
    },
    "custom_item_141": {
        "system": "AIX",
        "description": "3.7.1.8 /var/spool/cron/crontabs",
        "info": "The /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system.\n\nRationale:\n\nThe /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system. Crontab files present a security problem because they are run by the cron daemon, which runs with super user rights. Allowing other users to have read/write permissions on these files may allow them to escalate their privileges. To negate this risk, the directory and all the files that it contains must be secured.",
        "solution": "Apply the appropriate permissions to /var/spool/cron/crontabs:\n\nchmod -R o= /var/spool/cron/crontabs\nchmod ug=rwx,o= /var/spool/cron/crontabs\nchgrp -R cron /var/spool/cron/crontabs\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/spool/cron/crontabs",
        "mask": "007",
        "group": "cron"
    },
    "custom_item_142": {
        "system": "AIX",
        "description": "3.7.2.1 crontab entries - owned by userid - owned by userid",
        "info": "This script checks the permissions of all the root crontab entries, to ensure that they are owned and writable by the root user only.\n\nRationale:\n\nAll root crontab entries must be owned and writable by the root user only. If a script had group or world writable access, it could be replaced or edited with malicious content, which would then subsequently run on the system with root authority.",
        "solution": "Ensure that all root crontab entries are owned and writable by root only.\nThe script below traverses up each individual directory path, ensuring that all directories are not group/world writable and that they are owned by the root or bin user:\n\ncrontab -l |egrep -v '^#' |awk '{print $6}' |grep '^/' |sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nwhile [[ -a ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(????????w? *) ]] && print ' WARNING ${DIR} is world writable'\n[[ '$(ls -ld ${DIR})' = @(?????w???? *) ]] && print ' WARNING ${DIR} is group writable'\n[[ '$(ls -ld ${DIR} |awk '{print $3}')' != @(root|bin) ]] && print ' WARNING ${DIR} is not owned by root or bin'\nDIR=${DIR%/*}\ndone\ndone\n\nNOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable or not owned by root are marked with 'WARNING'\nTo manually change permissions on the files or directories:\nTo remove group writable access:\n\nchmod g-wTo remove world writable access:\n\nchmod o-wTo remove both group and world writable access:\n\nchmod go-wTo change the owner of a file or directory:\n\nchownDefault Value:\n\nN/A\n\nAdditional Information:\n\nDefault AIX Security Expert policy values:\n\nHigh Level policy Permissions checked\n\nMedium Level policy Permissions checked\n\nLow Level policy Permissions checked",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/crontab -l | /usr/bin/egrep -v '^#' | /usr/bin/awk '{print $6}' | /usr/bin/grep \"^/\" | /usr/bin/sort -u | while read DIR; do DIR=${DIR:-$(pwd)}; while [[ -a ${DIR} ]]; do [[ \"$(ls -ld ${DIR})\" = @(????????w? *) ]] && print \" WARNING ${DIR} is world writable\"; [[ \"$(ls -ld ${DIR})\" = @(?????w???? *) ]] && print \" WARNING ${DIR} is group writable\"; [[ \"$(ls -ld ${DIR} |awk '{print $3}')\" != @(root|bin) ]] && print \" WARNING ${DIR} is not owned by root or bin\"; DIR=${DIR%/*}; done; done | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'",
        "expect": "^none$"
    },
    "custom_item_143": {
        "system": "AIX",
        "description": "3.7.2.2 Home directory configuration files",
        "info": "The user configuration files in each home directory e.g. $HOME/.profile, must not be group or world writable.\n\nRationale:\n\nGroup or world-writable user configuration files may enable malicious users to steal or modify other user's data, or to gain elevated privileges.",
        "solution": "Search and remediate any user configuration files which have group or world writable access:\n\nlsuser -a home ALL |cut -f2 -d= |egrep -v '^/$|/etc|/bin|/var|/usr|/usr/sys' |while read homedir;\ndo\nif [[ -d ${homedir} ]];\nthen\necho 'Removing 'go-w' from all user confguration files in '${homedir}''\nls -a ${homedir} |egrep '^\\.[a-z]' |while read file;\ndo\nif [[ -f '${homedir}/${file}' ]];\nthen\necho 'Running 'chmod go-w' on '${homedir}/${file}''\nchmod go-w '${homedir}/${file}'\nfi\ndone\nelse\necho 'ERROR - no home directory for '${homedir}''\nfi\ndone\n\nNOTE: The permission change is automatically applied\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/bin/cat /etc/passwd | /usr/bin/awk -F: '($7 != \"/sbin/nologin\" && $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do if [ ! -d \"$dir\" ]; then /usr/bin/echo \"The home directory ($dir) of user $user does not exist.\"; else for file in $dir/.[A-Za-z0-9]*; do if [ ! -h \"$file\" -a -f \"$file\" ]; then fileperm=`ls -ld $file | cut -f1 -d\" \"`; if [ `/usr/bin/echo $fileperm | cut -c6` != \"-\" ]; then /usr/bin/echo \"Group Write permission set on file $file\"; fi; if [ `/usr/bin/echo $fileperm | cut -c9` != \"-\" ]; then /usr/bin/echo \"Other Write permission set on file $file\"; fi; fi; done; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"Pass - No home configuration files found with group or other permissions\"; else print}'",
        "expect": "Pass - No home configuration files found with group or other permissions"
    },
    "custom_item_144": {
        "system": "AIX",
        "description": "3.7.2.3 /smit.log",
        "info": "The /smit.log file maintains a history of all smit commands run as root.\n\nRationale:\n\nThe /smit.log file may contain sensitive information regarding system configuration, which may be of interest to an attacker. This log file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write access to /smit.log:\n\nchmod o-rw /smit.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/smit.log",
        "mask": "117"
    },
    "custom_item_145": {
        "system": "AIX",
        "description": "3.7.2.4 /etc/group",
        "info": "The /etc/group file contains a list of the groups defined within the system.\n\nRationale:\n\nThe /etc/group file defines basic group attributes. Since the file contains sensitive information, it must be properly secured.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/group:\n\nchown root:security /etc/group\nchmod u=rw,go=r /etc/group\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/group",
        "owner": "root",
        "mask": "133",
        "group": "security"
    },
    "custom_item_146": {
        "system": "AIX",
        "description": "3.7.2.5 /etc/inetd.conf",
        "info": "The recommended permissions and ownership for /etc/inetd.conf are applied.\n\nRationale:\n\nThe /etc/inetd.conf file contains the list of services that inetd controls and determines their current status i.e. active or disabled. This file must be protected from unauthorized access and modifications to ensure that the services disabled in this benchmark remain locked down.",
        "solution": "Set the recommended permissions and ownership to /etc/inetd.conf:\n\nchmod u=rw,go=r /etc/inetd.conf\nchown root:system /etc/inetd.conf\ntrustchk -u /etc/inetd.conf mode=644\n\nDefault Value:\n\n664, root:system",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/inetd.conf",
        "owner": "root",
        "mask": "133",
        "group": "system"
    },
    "custom_item_147": {
        "system": "AIX",
        "description": "3.7.2.6 /etc/motd",
        "info": "The /etc/motd file contains the message of the day, shown after successful initial login.\n\nRationale:\n\nThe /etc/motd file contains the message of the day, shown after successful initial login. The file should only be editable by its owner.",
        "solution": "Apply the appropriate permissions to /etc/motd:\n\nchown bin:bin /etc/motd\nchmod u=rw,go=r /etc/motd\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/motd",
        "owner": "bin",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_148": {
        "system": "AIX",
        "description": "3.7.2.7 /etc/passwd",
        "info": "The /etc/passwd file contains a list of the users defined within the system.\n\nRationale:\n\nThe /etc/passwd file defines all users within the system. Since the file contains sensitive information, it must be properly secured.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/passwd:\n\nchown root:security /etc/passwd\nchmod u=rw,go=r /etc/passwd\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/passwd",
        "owner": "root",
        "mask": "133",
        "group": "security"
    },
    "custom_item_149": {
        "system": "AIX",
        "description": "3.7.2.8 /etc/ssh/ssh_config",
        "info": "The /etc/ssh/ssh_config file defines SSH client behavior.\n\nRationale:\n\nThe /etc/ssh/ssh_config file is the system-wide client configuration file for OpenSSH, which allows you to set options that modify the operation of the client programs. The recommended value is not to provide any writable access rights for any user other than root.",
        "solution": "Change the permissions of the /etc/ssh/ssh_config file to ensure that only the owner can read and write to the file:\n\nchmod 644 /etc/ssh/ssh_config\n\nDefault Value:\n\n640\n\nAdditional Information:\n\nUsing the octal mode to (re)set the mode will also disable any ACL's that might have been set.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/ssh_config",
        "mask": "133"
    },
    "custom_item_150": {
        "system": "AIX",
        "description": "3.7.2.9 /etc/ssh/sshd_config",
        "info": "The /etc/ssh/sshd_config file defines SSH server behavior.\n\nRationale:\n\nThe SSH daemon reads the configuration information from this file and includes the authentication mode and cryptographic levels to use during SSH communication.\n\nImpact:\n\nSome organizations feel all configuration information for OpenSSH server must be confidential - and many other benchmarks recommend exclusive root access to the file /etc/ssh/sshd_config. This configuration will work UNLESS sftp access is required by non-root users.\n\nNon-root users (when mode is octal 0600) cannot load_server_config and the connection closes even though authentication succeeded.\n\nJun 25 14:42:45 x071 auth|security:info sshd[12255378]: Accepted password for michael from 192.168.129.65 port 32810 ssh2\n\nJun 25 14:42:45 x071 auth|security:info sftp-server[7077962]: session opened for local user michael from [192.168.129.65]\n\nJun 25 14:42:45 x071 auth|security:debug sftp-server[7077962]: debug2: load_server_config: filename /etc/ssh/sshd_config\n\nJun 25 14:42:45 x071 auth|security:info sshd[8847468]: Received disconnect from 192.168.129.65 port 32810:11: disconnected by user\n\nJun 25 14:42:45 x071 auth|security:info sshd[8847468]: Disconnected from user michael 192.168.129.65 port 32810\n\nThis is what is needed for the sftp-server to start:\n\nJun 25 14:45:10 x071 auth|security:info sshd[7077994]: Accepted password for michael from 192.168.129.65 port 32812 ssh2\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: session opened for local user michael from [192.168.129.65]\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: load_server_config: filename /etc/ssh/sshd_config\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: load_server_config: done config len = 288\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: parse_server_config: config /etc/ssh/sshd_config len 288\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:34 setting SyslogFacility AUTH\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:36 setting LogLevel INFO\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:114 setting Banner /etc/banner\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:117 setting Subsystem sftp\\t/usr/sbin/sftp-server -l DEBUG3 -f AUTH\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: received client version 3\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: request 0: realpath\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: realpath '.'\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug1: request 0: sent names count 1\n\nThe recommendation is to stay with the default file mode (octal 0644) unless site policy requires octal 0600 AND it is acceptable that sftp will not function.\n\nChoosing octal 0600 is considered a Level 2 recommendation",
        "solution": "Change the permissions of the /etc/ssh/sshd_config file to ensure all accounts can read the file but only the owner (root) can modify it:\n\nchmod u=rw,go=r /etc/ssh/sshd_config\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/ssh/sshd_config",
        "mask": "133"
    },
    "custom_item_151": {
        "system": "AIX",
        "description": "3.7.2.10 /var/adm/cron/at.allow",
        "info": "The /var/adm/cron/at.allow file contains a list of users who can schedule jobs via the at command.\n\nRationale:\n\nThe /var/adm/cron/at.allow file controls which users can schedule jobs via the at command. Only the root user should have permissions to create, edit, or delete this file.",
        "solution": "Apply the appropriate permissions to /var/adm/cron/at.allow:\n\nchown root:sys /var/adm/cron/at.allow\nchmod u=r,go= /var/adm/cron/at.allow\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/cron/at.allow",
        "owner": "root",
        "mask": "377",
        "group": "sys"
    },
    "custom_item_152": {
        "system": "AIX",
        "description": "3.7.2.11 /var/adm/cron/cron.allow",
        "info": "The /var/adm/cron/cron.allow file contains a list of users who can schedule jobs via the cron command.\n\nRationale:\n\nThe /var/adm/cron/cron.allow file controls which users can schedule jobs via cron. Only the root user should have permissions to create, edit, or delete this file.",
        "solution": "Apply the appropriate permissions to /var/adm/cron/cron.allow:\n\nchown root:sys /var/adm/cron/cron.allow\nchmod u=r,go= /var/adm/cron/cron.allow\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/cron/cron.allow",
        "owner": "root",
        "mask": "377",
        "group": "sys"
    },
    "custom_item_153": {
        "system": "AIX",
        "description": "3.7.2.12 /var/ct/RMstart.log",
        "info": "The /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured.\n\nRationale:\n\nRMC provides a single monitoring and management infrastructure for both RSCT peer domains and management domains. Its generalized framework is used by cluster management tools to monitor, query, modify, and control cluster resources, /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured.",
        "solution": "Remove world read and write from /var/ct/RMstart.log:\n\nchmod o-rw /var/ct/RMstart.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/ct/RMstart.log",
        "mask": "137"
    },
    "custom_item_154": {
        "system": "AIX",
        "description": "3.7.2.13 /var/adm/cron/log",
        "info": "The /var/adm/cron/log file contains a log of all cron jobs run on the system.\n\nRationale:\n\nThe /var/adm/cron/log, records all cron jobs run on the system. The file permissions must ensure that it is accessible only to its owner and group.",
        "solution": "Remove world read and write access to /var/adm/cron/log:\n\nchmod o-rw /var/adm/cron/log\nchown bin.cron /var/adm/cron/log\n\nDefault Value:\n\n660",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/cron/log",
        "mask": "117"
    },
    "custom_item_155": {
        "system": "AIX",
        "description": "3.7.2.14 /var/tmp/dpid2.log",
        "info": "The /var/tmp/dpid2.log is the logfile used by dpid2 daemon, and contains SNMP information.\n\nRationale:\n\nThe /var/tmp/dpid2.log logfile is used by the dpid2 daemon and can contain sensitive SNMP information. This file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write from /var/tmp/dpid2.log:\n\nchmod o-rw /var/tmp/dpid2.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/tmp/dpid2.log",
        "mask": "137"
    },
    "custom_item_156": {
        "system": "AIX",
        "description": "3.7.2.15 /var/tmp/hostmibd.log",
        "info": "The /var/tmp/hostmibd.log is the logfile used by hostmibd daemon, and contains network and machine related information.\n\nRationale:\n\nThe /var/tmp/hostmibd.log log file can contain network and machine related statistics logged by the daemon. This file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write from /var/tmp/hostmibd.log:\n\nchmod o-rw /var/tmp/hostmibd.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/tmp/hostmibd.log",
        "mask": "137"
    },
    "custom_item_157": {
        "system": "AIX",
        "description": "3.7.2.16 /var/tmp/snmpd.log",
        "info": "The /var/tmp/snmpd.log is the logfile used by snmpd daemon, and contains network and machine related information.\n\nRationale:\n\nThe /var/tmp/snmpd.log logfile contains sensitive information through which an attacker can find out about the SNMP deployment architecture in your network. This log file must be secured from unauthorized access.",
        "solution": "Remove world read and write from /var/tmp/snmpd.log:\n\nchmod o-rw /var/tmp/snmpd.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/tmp/snmpd.log",
        "mask": "137"
    },
    "custom_item_158": {
        "system": "AIX",
        "description": "3.9 Ensure root access is controlled - rlogin",
        "info": "Restricts access to root via su to members of a specific group.\n\nRationale:\n\nSetting the sugroups attribute to system ensures that only members of the system group are able to su root. This makes it more difficult for an attacker to use a stolen root password as the attacker first has to get access to a system user ID.\n\nImpact:\n\nIn this recommendation we specify the group system in order to leave this recommendation as a Level 1, IG1 recommendation.\n\nFurther, as IG1 recommendation - we permit the attribute login to be true, to permit direct root login using an HMC.\n\nA higher level of security would create a new group - specific for su to root and that group name would be used in the specification.\n\nThus, the Remediation procedure below specifies system as the correct group name. This is merely an initial solution.\n\nIn any case, sugroups should not equal ALL.",
        "solution": "In /etc/security/user, set the root stanza sugroups attribute to system:\n\nchuser login=true rlogin=false su=true sugroups=system root\n\nDefault Value:\n\nroot login=true rlogin=true sugroups=ALL su=true",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a login rlogin su root",
        "expect": "^[\\\\s]*root[\\\\s]+login[\\\\s]*=[\\\\s]*true[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]+su[\\\\s]*=[\\\\s]*true[\\\\s]*$"
    },
    "custom_item_159": {
        "system": "AIX",
        "description": "3.9 Ensure root access is controlled - sugroups",
        "info": "Restricts access to root via su to members of a specific group.\n\nRationale:\n\nSetting the sugroups attribute to system ensures that only members of the system group are able to su root. This makes it more difficult for an attacker to use a stolen root password as the attacker first has to get access to a system user ID.\n\nImpact:\n\nIn this recommendation we specify the group system in order to leave this recommendation as a Level 1, IG1 recommendation.\n\nFurther, as IG1 recommendation - we permit the attribute login to be true, to permit direct root login using an HMC.\n\nA higher level of security would create a new group - specific for su to root and that group name would be used in the specification.\n\nThus, the Remediation procedure below specifies system as the correct group name. This is merely an initial solution.\n\nIn any case, sugroups should not equal ALL.",
        "solution": "In /etc/security/user, set the root stanza sugroups attribute to system:\n\nchuser login=true rlogin=false su=true sugroups=system root\n\nDefault Value:\n\nroot login=true rlogin=true sugroups=ALL su=true",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a sugroups root",
        "expect": "^[\\\\s]*root[\\\\s]+sugroups[\\\\s]*=[\\\\s]*(?!.*(ALL).*$)"
    },
    "custom_item_160": {
        "system": "AIX",
        "description": "3.10 Disable core dumps - lssec",
        "info": "This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.\n\nRationale:\n\nThe creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker.\n\nThe commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits.",
        "solution": "Change the default user stanza attributes core and core_hard in /etc/security/limits and then set the fullcore kernel parameter to false:\n\nchsec -f /etc/security/limits -s default -a core=0 -a core_hard=0\nchdev -l sys0 -a fullcore=false\n\nDefault Value:\n\nCore dumps enabled",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/lssec -f /etc/security/limits -s default -a core -a core_hard",
        "expect": "^[\\\\s]*default[\\\\s]+core[\\\\s]*=[\\\\s]*0[\\\\s]+core_hard[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_161": {
        "system": "AIX",
        "description": "3.10 Disable core dumps - lsattr",
        "info": "This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.\n\nRationale:\n\nThe creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker.\n\nThe commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits.",
        "solution": "Change the default user stanza attributes core and core_hard in /etc/security/limits and then set the fullcore kernel parameter to false:\n\nchsec -f /etc/security/limits -s default -a core=0 -a core_hard=0\nchdev -l sys0 -a fullcore=false\n\nDefault Value:\n\nCore dumps enabled",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsattr -El sys0 -a fullcore",
        "expect": "^[\\\\s]*fullcore[\\\\s]+false[\\\\s]+Enable[\\\\s]+full[\\\\s]+CORE[\\\\s]+dump[\\\\s]+True[\\\\s]*$"
    },
    "custom_item_162": {
        "system": "AIX",
        "description": "3.11 Remove current working directory from default /etc/environment PATH",
        "info": "This change removes any '.' or '::' entries from /etc/environment. If a '.' or '::' is present the current working directory is included in the default search path.\n\nRationale:\n\nAny '.' and '::' will be removed from /etc/environment. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.",
        "solution": "Examine PATH in /etc/environment to see if it contains any '.' or '::' entries:\n\ngrep '^PATH=' /etc/environment |awk '/((:[ \\t]*:)|(:[ \\t]*$)|(^[\\t]*:)|(^.:)|(:.$)|(:.:))/'\n\nIf the command above yields output, remove the '.' and '::' entries from:\n\nvi /etc/environment\n\nDefault Value:\n\nDot present",
        "reference": "800-171|3.4.7,800-53|CM-7(2),800-53r5|CM-7(2),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(2),LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/grep \"^PATH=\" /etc/environment | /usr/bin/awk '/((:[ \\\\t]*:)|(:[ \\\\t]*$)|(^[ \\\\t]*:)|(^.:)|(:.$)|(:.:))/' | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_163": {
        "system": "AIX",
        "description": "3.12 Remove current working directory from root's PATH",
        "info": "This change removes any '.' or '::' entries from the root PATH. If a '.' or '::' is present the current working directory is included in the search path.\n\nRationale:\n\nAny '.' and '::' will be removed from the root PATH. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.",
        "solution": "Examine root's PATH to see if it contains any '.' or '::' entries:\n\nsu - root -c 'echo ${PATH}' |awk '/((:[ \\t]*:)|(:[ \\t]*$)|(^[ \\t]*:)|(^.:)|(:.$)|(:.:))/'\n\nIf the command above yields output, remove the '.' and '::' entries from the relevant initialization files. The files to examine are dependant on the root users shell definition in /etc/passwd. Once the file or files have been identified remove the '.' and '::' from the PATH variable\n\nviDefault Value:\n\nDot not present",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/bin/su - root -c \"echo ${PATH}\" 2>&1 | /usr/bin/awk '/((:[ \\\\t]*:)|(:[ \\\\t]*$)|(^[ \\\\t]*:)|(^.:)|(:.$)|(:.:))/' | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*pass:?[\\\\s]*\\\\**$"
    },
    "custom_item_164": {
        "system": "AIX",
        "description": "3.13 Lock historical users",
        "info": "Lock OS administrative accounts to further enhance security.\n\nRationale:\n\nLock administrative user accounts. Generic OS administrative user accounts are targeted by hackers in an attempt to gain unauthorized access to a server.",
        "solution": "Lock standard accounts using chuser:\n\nACCOUNTS=daemon,bin,sys,adm,uucp,nobody,lpd,lp,invscout,ipsec,nuucp,sshd\nlsuser -a account_locked ${ACCOUNTS} | grep -v account_locked=true | while read account attributes; do\n  chuser account_locked=true ${account}\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|16.8,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "cmd": "/usr/sbin/lsuser -a account_locked daemon,bin,sys,adm,uucp,nobody,lpd,lp,invscout,ipsec,nuucp,sshd | /usr/bin/grep -v account_locked=true | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_165": {
        "system": "AIX",
        "description": "3.14 Configuration: /etc/motd",
        "info": "Create a /etc/motd file which displays, post initial logon, a statutory warning message.\n\nRationale:\n\nThe creation of a /etc/motd file which contains a statutory warning message could aid in the prosecution of offenders guilty of unauthorized system access. The /etc/motd is displayed after successful logins from the console, SSH and other system access protocols.",
        "solution": "Create a /etc/motd file:\n\ntouch /etc/motd\nchmod u=rw,go=r /etc/motd\nchown bin:bin /etc/motd\n\nBelow is a sample banner:\n\n*************************************************************************** '\nNOTICE TO USERS\nThis computer system is the private property of its owner, whether individual, corporate or government. It is for authorized use only. Users (authorized or unauthorized) have no explicit or implicit expectation of privacy. Any or all uses of this system and all files on this system may be intercepted, monitored, recorded, copied, audited, inspected, and disclosed to your employer, to authorized site, government, and law enforcement personnel, as well as authorized officials of government agencies, both domestic and foreign. By using this system, the user consents to such interception, monitoring,recording, copying, auditing, inspection, and disclosure at the discretion of such personnel or officials. Unauthorized or improper use of this system may result in civil and criminal penalties and administrative or disciplinary action, as appropriate. By continuing to use this system you indicate your awareness of and consent to these terms and conditions of use. LOG OFF IMMEDIATELY if you do not agree to the conditions stated in this warning.\n****************************************************************************\n\nNOTE: Replace 'its owner' with the relevant company name\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/motd",
        "owner": "bin",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_166": {
        "system": "AIX",
        "description": "3.4.6 Unattended terminal session timeout is 900 seconds (or less) - TMOUT",
        "info": "TMOUT and TIMEOUT are environmental setting that activate the timeout of a shell. The value is in seconds.\n\nTMOUT=n - Sets the shell timeout to n seconds. A setting of TMOUT=0, or unset TMOUT disables the automatic session timeout.\n\nreadonly TMOUT- Both export and lock TMOUT environmental variable to it's present value, preventing unwanted modification during run-time.\n\nRationale:\n\nAll systems are vulnerable if terminals are left logged in and unattended. The most serious problem occurs when a system manager leaves a terminal unattended that has been enabled with root authority. In general, users should log out anytime they leave their terminals.\n\nYou can force a terminal to log out after a period of inactivity by setting the TMOUT and TIMEOUT parameters in the /etc/profile file. The TMOUT parameter works in the ksh (Korn) shell, and the TIMEOUT parameter works in the bsh (Bourne) shell.\n\nImpact:\n\nThis recommendation is set at Level 2 (using readonly).\n\nThe recommendation - at Level 1, would use export instead.",
        "solution": "Review /etc/profile to verify that TMOUT is configured to:\n\ninclude a timeout of no more than 900 seconds\n\nto be readonly\n\nverify readonly statement is the last statement\n\n/usr/bin/egrep -n -e 'TMOUT|TIMEOUT' /etc/profile\n\nThis should return something similar to:\n\n40:# TMOUT=120\n41:TMOUT=900\n42:TIMEOUT=900\n43:readonly TMOUT TIMEOUT\n\nIf either setting is missing, and/or the readonly statement, add these to /etc/profile.\n\nDefault Value:\n\nTMOUT=0",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1M,LEVEL|2M,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*TMOUT",
        "expect": "^[\\\\s]*TMOUT[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]|[1-8][0-9]{2}|900)[\\\\s]*$"
    },
    "custom_item_167": {
        "system": "AIX",
        "description": "3.4.6 Unattended terminal session timeout is 900 seconds (or less) - TIMEOUT",
        "info": "TMOUT and TIMEOUT are environmental setting that activate the timeout of a shell. The value is in seconds.\n\nTMOUT=n - Sets the shell timeout to n seconds. A setting of TMOUT=0, or unset TMOUT disables the automatic session timeout.\n\nreadonly TMOUT- Both export and lock TMOUT environmental variable to it's present value, preventing unwanted modification during run-time.\n\nRationale:\n\nAll systems are vulnerable if terminals are left logged in and unattended. The most serious problem occurs when a system manager leaves a terminal unattended that has been enabled with root authority. In general, users should log out anytime they leave their terminals.\n\nYou can force a terminal to log out after a period of inactivity by setting the TMOUT and TIMEOUT parameters in the /etc/profile file. The TMOUT parameter works in the ksh (Korn) shell, and the TIMEOUT parameter works in the bsh (Bourne) shell.\n\nImpact:\n\nThis recommendation is set at Level 2 (using readonly).\n\nThe recommendation - at Level 1, would use export instead.",
        "solution": "Review /etc/profile to verify that TMOUT is configured to:\n\ninclude a timeout of no more than 900 seconds\n\nto be readonly\n\nverify readonly statement is the last statement\n\n/usr/bin/egrep -n -e 'TMOUT|TIMEOUT' /etc/profile\n\nThis should return something similar to:\n\n40:# TMOUT=120\n41:TMOUT=900\n42:TIMEOUT=900\n43:readonly TMOUT TIMEOUT\n\nIf either setting is missing, and/or the readonly statement, add these to /etc/profile.\n\nDefault Value:\n\nTMOUT=0",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1M,LEVEL|2M,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*TIMEOUT",
        "expect": "^[\\\\s]*TIMEOUT[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]|[1-8][0-9]{2}|900)[\\\\s]*$"
    },
    "custom_item_168": {
        "system": "AIX",
        "description": "3.4.6 Unattended terminal session timeout is 900 seconds (or less) - readonly",
        "info": "TMOUT and TIMEOUT are environmental setting that activate the timeout of a shell. The value is in seconds.\n\nTMOUT=n - Sets the shell timeout to n seconds. A setting of TMOUT=0, or unset TMOUT disables the automatic session timeout.\n\nreadonly TMOUT- Both export and lock TMOUT environmental variable to it's present value, preventing unwanted modification during run-time.\n\nRationale:\n\nAll systems are vulnerable if terminals are left logged in and unattended. The most serious problem occurs when a system manager leaves a terminal unattended that has been enabled with root authority. In general, users should log out anytime they leave their terminals.\n\nYou can force a terminal to log out after a period of inactivity by setting the TMOUT and TIMEOUT parameters in the /etc/profile file. The TMOUT parameter works in the ksh (Korn) shell, and the TIMEOUT parameter works in the bsh (Bourne) shell.\n\nImpact:\n\nThis recommendation is set at Level 2 (using readonly).\n\nThe recommendation - at Level 1, would use export instead.",
        "solution": "Review /etc/profile to verify that TMOUT is configured to:\n\ninclude a timeout of no more than 900 seconds\n\nto be readonly\n\nverify readonly statement is the last statement\n\n/usr/bin/egrep -n -e 'TMOUT|TIMEOUT' /etc/profile\n\nThis should return something similar to:\n\n40:# TMOUT=120\n41:TMOUT=900\n42:TIMEOUT=900\n43:readonly TMOUT TIMEOUT\n\nIf either setting is missing, and/or the readonly statement, add these to /etc/profile.\n\nDefault Value:\n\nTMOUT=0",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1M,LEVEL|2M,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]+TIMEOUT[\\\\s]*$",
        "expect": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]+TIMEOUT[\\\\s]*$"
    },
    "custom_item_169": {
        "system": "AIX",
        "description": "6.1.1 Configuring syslog - local logging - /var/adm/authlog",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/authlog",
        "owner": "root",
        "mask": "177",
        "group": "system"
    },
    "custom_item_170": {
        "system": "AIX",
        "description": "6.1.1 Configuring syslog - local logging - /var/adm/syslog",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/var/adm/syslog",
        "mask": "137"
    },
    "custom_item_171": {
        "system": "AIX",
        "description": "6.1.1 Configuring syslog - local logging - auth.info in /etc/syslog.conf",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/syslog.conf",
        "regex": "^auth[\\\\.]info\t",
        "expect": "^auth[\\\\.]info\t+/var/adm/authlog[\\\\s]+rotate[\\\\s]+time[\\\\s]+1w[\\\\s]+files[\\\\s]+4[\\\\s]*$"
    },
    "custom_item_172": {
        "system": "AIX",
        "description": "6.1.1 Configuring syslog - local logging - *.info/auth.none in /etc/syslog.conf",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1M,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4119",
        "file": "/etc/syslog.conf",
        "regex": "^[\\\\*][\\\\.]info;auth[\\\\.]none\t",
        "expect": "^[\\\\*][\\\\.]info;auth[\\\\.]none\t+/var/adm/syslog[\\\\s]+rotate[\\\\s]+time[\\\\s]+1w[\\\\s]+files[\\\\s]+4[\\\\s]*$"
    }
}