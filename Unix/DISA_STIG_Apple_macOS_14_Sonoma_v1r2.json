{
    "custom_item_1": {
        "description": "MacOS 14 is installed",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_2": {
        "description": "APPL-14-000001 - The macOS system must prevent Apple Watch from terminating a session lock.",
        "info": "Disabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using authorized identification and authentication procedures.",
        "solution": "Configure the macOS system to prevent Apple Watch from terminating a session lock by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259418r940876_rule,STIG-ID|APPL-14-000001,Vuln-ID|V-259418",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowAutoUnlock",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_3": {
        "description": "APPL-14-000002 - The macOS system must enforce screen saver password.",
        "info": "Users must authenticate when unlocking the screen saver.\n\nThe screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.",
        "solution": "Configure the macOS system to prompt users to enter a password to unlock the screen saver by installing the \"com.apple.screensaver\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259419r940879_rule,STIG-ID|APPL-14-000002,Vuln-ID|V-259419",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "askForPassword",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_4": {
        "description": "APPL-14-000003 - The macOS system must enforce session lock no more than five seconds after screen saver is started.",
        "info": "A screen saver must be enabled and the system must be configured to require a password to unlock once the screensaver has been on for a maximum of five seconds.\n\nAn unattended system with an excessive grace period is vulnerable to a malicious user.",
        "solution": "Configure the macOS system to initiate a session lock within five seconds of the screen saver starting by installing the \"com.apple.screensaver\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259420r940882_rule,STIG-ID|APPL-14-000003,Vuln-ID|V-259420",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^[0-5]$",
        "payload_key": "askForPasswordDelay",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_5": {
        "description": "APPL-14-000005 - The macOS system must configure user session lock when a smart token is removed.",
        "info": "The screen lock must be configured to initiate automatically when the smart token is removed from the system.\n\nSession locks are temporary actions taken when users stop work and move away from the immediate vicinity of the information system but do not want to log out because of the temporary nature of their absence. While a session lock is not an acceptable substitute for logging out of an information system for longer periods of time, they prevent a malicious user from accessing the information system when a user has removed their smart token.",
        "solution": "Configure the macOS system to lock the user session when a smart token is removed by installing the \"com.apple.security.smartcard\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000058,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259421r940885_rule,STIG-ID|APPL-14-000005,Vuln-ID|V-259421",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^1$",
        "payload_key": "tokenRemovalAction",
        "payload_type": "com.apple.security.smartcard"
    },
    "custom_item_6": {
        "description": "APPL-14-000007 - The macOS system must disable hot corners.",
        "info": "Hot corners must be disabled.\n\nThe information system conceals, via the session lock, information previously visible on the display with a publicly viewable image. Although hot corners can be used to initiate a session lock or to launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.",
        "solution": "Configure the macOS system to disable hot corners by installing the \"com.apple.ManagedClient.preferences\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259422r940888_rule,STIG-ID|APPL-14-000007,Vuln-ID|V-259422",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '\"wvous-bl-corner\" = 0|\"wvous-br-corner\" = 0|\"wvous-tl-corner\" = 0|\"wvous-tr-corner\" = 0'",
        "expect": "^4$"
    },
    "custom_item_7": {
        "description": "APPL-14-000009 - The macOS system must prevent AdminHostInfo from being available at LoginWindow.",
        "info": "The system must be configured to not display sensitive information at the LoginWindow. The key AdminHostInfo when configured will allow the HostName, IP Address, and operating system version and build to be displayed.",
        "solution": "Configure the macOS system to prevent AdminHostInfo from being available at LoginWindow by installing the \"com.apple.loginwindow\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259423r940891_rule,STIG-ID|APPL-14-000009,Vuln-ID|V-259423",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "AdminHostInfo",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_8": {
        "description": "APPL-14-000014 - The macOS system must enforce time synchronization.",
        "info": "Time synchronization must be enforced on all networked systems.\n\nThis rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nSatisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144",
        "solution": "Configure the macOS system to enforce time synchronization by installing the \"com.apple.timed\" configuration profile.",
        "reference": "800-171|3.3.7,800-53|AU-8(1)(a),800-53|AU-8(1)(b),800-53r5|SC-45(1),CAT|II,CCI|CCI-001891,CCI|CCI-002046,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259425r940897_rule,STIG-ID|APPL-14-000014,TBA-FIISB|37.4,Vuln-ID|V-259425",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "TMAutomaticTimeOnlyEnabled",
        "payload_type": "com.apple.timed"
    },
    "custom_item_9": {
        "description": "APPL-14-000016 - The macOS system must be integrated into a directory services infrastructure.",
        "info": "A directory service infrastructure enables centralized user and rights management, as well as centralized control over computer and user configurations. Integrating the macOS systems used throughout an organization into a directory services infrastructure ensures more administrator oversight and security than allowing distinct user account databases to exist on each separate system.",
        "solution": "Configure the macOS system to integrate into an existing directory services infrastructure.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259427r940903_rule,STIG-ID|APPL-14-000016,SWIFT-CSCv1|2.3,Vuln-ID|V-259427",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/dscl localhost -list . | /usr/bin/grep -qvE '(Contact|Search|Local|^$)'; /bin/echo $?",
        "expect": "^0$"
    },
    "custom_item_10": {
        "description": "APPL-14-000022 - The macOS system must limit consecutive failed log on attempts to three.",
        "info": "The macOS must be configured to limit the number of failed log on attempts to a maximum of three. When the maximum number of failed attempts is reached, the account must be locked for a period of time after.\n\nThis rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.\n\nSatisfies: SRG-OS-000021-GPOS-00005,SRG-OS-000329-GPOS-00128",
        "solution": "Configure the macOS system to limit consecutive failed log on attempts to three by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile or by a directory service.",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53|AC-7b.,800-53r5|AC-7a.,800-53r5|AC-7b.,CAT|II,CCI|CCI-000044,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-259428r940906_rule,STIG-ID|APPL-14-000022,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-259428",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyAttributeMaximumFailedAuthentications\"]/following-sibling::integer[1]/text()' -",
        "expect": "^@MAXIMUM_FAILED_AUTHENTICATIONS@$"
    },
    "custom_item_11": {
        "description": "APPL-14-000023 - The macOS system must display the Standard Mandatory DOD Notice and Consent Banner at remote log on.",
        "info": "Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006,SRG-OS-000024-GPOS-00007",
        "solution": "Configure the macOS system to display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system by creating a text file containing the required DOD text.\n\nName the file \"banner\" and place it in \"/etc/\".",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53r5|AC-8a.,800-53r5|AC-8b.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-259429r940909_rule,STIG-ID|APPL-14-000023,TBA-FIISB|45.2.4,Vuln-ID|V-259429",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "file": "/etc/banner",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_12": {
        "description": "APPL-14-000024 - The macOS system must enforce SSH to display the Standard Mandatory DOD Notice and Consent Banner.",
        "info": "Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000023-GPOS-00006,SRG-OS-000024-GPOS-00007",
        "solution": "Configure the macOS system to display the contents of \"/etc/banner\" before granting access to the system by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nbanner /etc/banner",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53r5|AC-8a.,800-53r5|AC-8b.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-259430r940912_rule,STIG-ID|APPL-14-000024,TBA-FIISB|45.2.4,Vuln-ID|V-259430",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -c \"^banner /etc/banner\"",
        "expect": "^1$"
    },
    "custom_item_13": {
        "description": "Banner Text",
        "file": "/Library/Security/PolicyBanner.rtfd",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_14": {
        "description": "File Permissions",
        "file": "/Library/Security/PolicyBanner.rtfd",
        "mask": "133"
    },
    "custom_item_15": {
        "description": "APPL-14-000030 - The macOS system must configure audit log files to not contain access control lists.",
        "info": "The audit log files must not contain access control lists (ACLs).\n\nThis rule ensures that audit information and audit files are configured to be readable and writable only by system administrators, thereby preventing unauthorized access, modification, and deletion of files.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system without ACLs applied to log files with the following command:\n\n/bin/chmod -RN /var/audit",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259432r940918_rule,STIG-ID|APPL-14-000030,Vuln-ID|V-259432",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -le $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $2}' | /usr/bin/grep -c \":\"",
        "expect": "^0$"
    },
    "custom_item_16": {
        "description": "APPL-14-000031 - The macOS system must configure audit log folders to not contain access control lists.",
        "info": "The audit log folder must not contain access control lists (ACLs).\n\nAudit logs contain sensitive data about the system and users. This rule ensures that the audit service is configured to create log folders that are readable and writable only by system administrators in order to prevent normal users from reading audit logs.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system without ACLs applied to log folders with the following command:\n\n/bin/chmod -N /var/audit",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259433r940921_rule,STIG-ID|APPL-14-000031,Vuln-ID|V-259433",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -lde /var/audit | /usr/bin/awk '{print $1}' | /usr/bin/grep -c \":\"",
        "expect": "^0$"
    },
    "custom_item_17": {
        "description": "APPL-14-000033 - The macOS system must disable FileVault automatic log on.",
        "info": "If FileVault is enabled, automatic log on must be disabled, so that both FileVault and login window authentication are required.\n\nThe default behavior of macOS when FileVault is enabled is to automatically log on to the computer once successfully passing user's FileVault credentials.\n\nNote: DisableFDEAutoLogin does not have to be set on Apple Silicon-based macOS systems that are smartcard enforced, as smartcards are available at preboot.",
        "solution": "Configure the macOS system to disable filevault automatic login by installing the \"com.apple.loginwindow\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the configuration profile.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259434r940924_rule,STIG-ID|APPL-14-000033,TBA-FIISB|31.1,Vuln-ID|V-259434",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "DisableFDEAutoLogin",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_18": {
        "description": "APPL-14-000051 - The macOS system must configure SSHD ClientAliveInterval to 900.",
        "info": "If SSHD is enabled, then it must be configured with the Client Alive Interval set to 900.\n\nSets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client.\n\nThis setting works in conjunction with ClientAliveCountMax to determine the termination of the connection after the threshold has been reached.\n\nNote: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "Configure the macOS system to set the SSHD ClientAliveInterval to 900 with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'clientaliveinterval 900' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"clientaliveinterval 900\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-259435r940927_rule,STIG-ID|APPL-14-000051,SWIFT-CSCv1|2.6,Vuln-ID|V-259435",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'",
        "expect": "^900$"
    },
    "custom_item_19": {
        "description": "APPL-14-000052 - The macOS system must configure SSHD ClientAliveCountMax to 1.",
        "info": "If SSHD is enabled it must be configured with the Client Alive Maximum Count set to 1.\n\nThis will set the number of client alive messages which may be sent without the SSH server receiving any messages back from the client. If this threshold is reached while client alive messages are being sent, the SSH server will disconnect the client, terminating the session. The client alive messages are sent through the encrypted channel and therefore will not be spoofable. The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.\n\nNote: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "Configure the macOS system to set the SSHD ClientAliveCountMax to 1 with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'clientalivecountmax 1' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"clientalivecountmax 1\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-259436r940930_rule,STIG-ID|APPL-14-000052,SWIFT-CSCv1|2.6,Vuln-ID|V-259436",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'",
        "expect": "^1$"
    },
    "custom_item_20": {
        "description": "APPL-14-000053 - The macOS system must set Login Grace Time to 30.",
        "info": "If SSHD is enabled, then it must be configured to wait only 30 seconds before timing out logon attempts.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "Configure the macOS system to set Login Grace Time to 30 with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'logingracetime 30' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"logingracetime 30\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-259437r940933_rule,STIG-ID|APPL-14-000053,SWIFT-CSCv1|2.6,Vuln-ID|V-259437",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'",
        "expect": "^30$"
    },
    "custom_item_21": {
        "description": "HostKeyAlgorithms",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com'",
        "expect": "^1$"
    },
    "custom_item_22": {
        "description": "CASignatureAlgorithms",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'CASignatureAlgorithms ecdsa-sha2-nistp256'",
        "expect": "^1$"
    },
    "custom_item_23": {
        "description": "HostbasedAcceptedAlgorithms",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com'",
        "expect": "^1$"
    },
    "custom_item_24": {
        "description": "KexAlgorithms",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'KexAlgorithms ecdh-sha2-nistp256'",
        "expect": "^1$"
    },
    "custom_item_25": {
        "description": "MACs",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'MACs hmac-sha2-256'",
        "expect": "^1$"
    },
    "custom_item_26": {
        "description": "PubkeyAcceptedAlgorithms",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com'",
        "expect": "^1$"
    },
    "custom_item_27": {
        "description": "Ciphers",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Eic 'Ciphers aes128-gcm@openssh.com'",
        "expect": "^1$"
    },
    "custom_item_28": {
        "description": "HostKeyAlgorithms",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "expect": "^[\\\\s]*HostKeyAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_29": {
        "description": "MACs",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*MACs hmac-sha2-256[\\\\s]*$",
        "expect": "^[\\\\s]*MACs hmac-sha2-256[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_30": {
        "description": "KexAlgorithms",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*KexAlgorithms ecdh-sha2-nistp256[\\\\s]*$",
        "expect": "^[\\\\s]*KexAlgorithms ecdh-sha2-nistp256[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_31": {
        "description": "PubkeyAcceptedAlgorithms",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "expect": "^[\\\\s]*PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_32": {
        "description": "Ciphers",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*Ciphers aes128-gcm@openssh.com[\\\\s]*$",
        "expect": "^[\\\\s]*Ciphers aes128-gcm@openssh.com[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_33": {
        "description": "HostbasedAcceptedAlgorithms",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "expect": "^[\\\\s]*HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_34": {
        "description": "CASignatureAlgorithms",
        "file": "/etc/ssh/ssh_config /etc/ssh/ssh_config.d/*.conf",
        "regex": "^[\\\\s]*CASignatureAlgorithms ecdsa-sha2-nistp256[\\\\s]*$",
        "expect": "^[\\\\s]*CASignatureAlgorithms ecdsa-sha2-nistp256[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_35": {
        "description": "APPL-14-000060 - The macOS system must set account lockout time to 15 minutes.",
        "info": "The macOS must be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.\n\nThis rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.\n\nSatisfies: SRG-OS-000021-GPOS-00005,SRG-OS-000329-GPOS-00128",
        "solution": "Configure the macOS system to set account lockout time to 15 minutes by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile or by a directory service.",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53|AC-7b.,800-53r5|AC-7a.,800-53r5|AC-7b.,CAT|II,CCI|CCI-000044,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-259440r940942_rule,STIG-ID|APPL-14-000060,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-259440",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"autoEnableInSeconds\"]/following-sibling::integer[1]/text()' -",
        "expect": "^@ACCOUNT_LOCKOUT_TIME@$"
    },
    "custom_item_36": {
        "description": "APPL-14-000070 - The macOS system must enforce screen saver timeout.",
        "info": "The screen saver timeout must be set to 900 seconds or a shorter length of time.\n\nThis rule ensures that a full session lock is triggered within no more than 900 seconds of inactivity.",
        "solution": "Configure the macOS system to initiate the screen saver after 15 minutes of inactivity by installing the \"com.apple.screensaver\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259441r940945_rule,STIG-ID|APPL-14-000070,Vuln-ID|V-259441",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^(900|[1-8][0-9][0-9]|[1-9][0-9]|[0-9])$",
        "payload_key": "idleTime",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_37": {
        "description": "APPL-14-000080 - The macOS system must enable SSH server for remote access sessions.",
        "info": "Remote access sessions must use encrypted methods to protect unauthorized individuals from gaining access.\n\nSatisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000113-GPOS-00058,SRG-OS-000425-GPOS-00189,SRG-OS-000426-GPOS-00190",
        "solution": "Configure the macOS system to enable SSH server for remote access sessions with the following command:\n\n/bin/launchctl enable system/com.openssh.sshd",
        "reference": "800-171|3.1.1,800-171|3.5.4,800-171|3.13.8,800-53|AC-3,800-53|IA-2(9),800-53|SC-8(2),800-53r5|AC-3,800-53r5|IA-2(8),800-53r5|SC-8(2),CAT|II,CCI|CCI-000213,CCI|CCI-001942,CCI|CCI-002420,CCI|CCI-002422,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(f),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|IA-2(9),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T2.3.8,NESA|T4.2.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.3.3,NESA|T7.4.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|AM18,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,NIAv2|SS29,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-259442r940948_rule,STIG-ID|APPL-14-000080,SWIFT-CSCv1|2.1,SWIFT-CSCv1|4.2,TBA-FIISB|31.1,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259442",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.openssh.sshd\" => enabled'",
        "expect": "^1$"
    },
    "custom_item_38": {
        "description": "APPL-14-000090 - The macOS system must disable logon to other user's active and locked sessions.",
        "info": "The ability to log in to another user's active or locked session must be disabled.\n\nmacOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.\n\nNote: Configuring this setting will disable TouchID from unlocking the screensaver.",
        "solution": "Configure the macOS system to disable login to other user's active and locked sessions with the following command:\n\n/usr/bin/security authorizationdb write system.login.screensaver \"authenticate-session-owner\"",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53|IA-2(5),800-53r5|IA-2,800-53r5|IA-2(5),CAT|II,CCI|CCI-000764,CCI|CCI-000770,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259443r943108_rule,STIG-ID|APPL-14-000090,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259443",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/security authorizationdb read system.login.screensaver 2>&1 | /usr/bin/grep -c 'authenticate-session-owner'",
        "expect": "^1$"
    },
    "custom_item_39": {
        "description": "APPL-14-000100 - The macOS system must disable root logon.",
        "info": "To ensure individual accountability and prevent unauthorized access, logging in as root at the login window must be disabled.\n\nThe macOS system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users must never log in directly as root.\n\nSatisfies: SRG-OS-000104-GPOS-00051,SRG-OS-000109-GPOS-00056,SRG-OS-000364-GPOS-00151",
        "solution": "Configure the macOS system to disable root login with the following command:\n\n/usr/bin/dscl . -create /Users/root UserShell /usr/bin/false",
        "reference": "800-171|3.4.5,800-171|3.5.1,800-53|CM-5(1),800-53|IA-2,800-53|IA-2(5),800-53r5|CM-5(1),800-53r5|IA-2,800-53r5|IA-2(5),CAT|II,CCI|CCI-000764,CCI|CCI-000770,CCI|CCI-001813,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-5(1),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.1.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|13.2,Rule-ID|SV-259444r940954_rule,STIG-ID|APPL-14-000100,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259444",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/dscl . -read /Users/root UserShell 2>&1 | /usr/bin/grep -c \"/usr/bin/false\"",
        "expect": "^1$"
    },
    "custom_item_40": {
        "description": "APPL-14-000110 - The macOS system must configure SSH ServerAliveInterval option set to 900.",
        "info": "SSH must be configured with an Active Server Alive Maximum Count set to 900.\n\nSetting the Active Server Alive Maximum Count to 900 will log users out after a 900-second interval of inactivity.\n\nNote: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "Configure the macOS system to set the SSH ServerAliveInterval option set to 900 with the following command:\n\nfor u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do\n  config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2>&1 | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\\r')\n  configarray=( ${(f)config} )\n  for c in $configarray; do\n    /usr/bin/sudo -u $u /usr/bin/grep -q '^ServerAliveInterval' \"$c\" && /usr/bin/sed -i '' 's/.*ServerAliveInterval.*/ServerAliveInterval 900/' \"$c\" || /bin/echo 'ServerAliveInterval 900' >> \"$c\"\n  done\ndone",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-259445r940957_rule,STIG-ID|APPL-14-000110,SWIFT-CSCv1|2.6,Vuln-ID|V-259445",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "#!/bin/bash\n{\nret=\"pass\"\nfor u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do\n  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -T -G . | /usr/bin/grep -c \"^serveraliveinterval 900\")\n  if [[ \"$sshCheck\" == \"0\" ]]; then\n    ret=\"fail\"\n    break\n  fi\ndone\n/bin/echo $ret\n}",
        "expect": "^pass$"
    },
    "custom_item_41": {
        "description": "APPL-14-000120 - The macOS system must configure SSHD Channel Timeout to 900.",
        "info": "If SSHD is enabled it must be configured with session Channel Timeout set to 900.\n\nThis will set the time out when the session is inactive.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000163-GPOS-00072,SRG-OS-000279-GPOS-00109",
        "solution": "Configure the macOS system to set the SSHD Channel Timeout to 900 with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'channeltimeout session:*=900' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"channeltimeout session:*=900\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.1.11,800-171|3.13.9,800-53|AC-12,800-53|SC-10,800-53r5|AC-12,800-53r5|SC-10,CAT|II,CCI|CCI-001133,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,NIAv2|NS49,Rule-ID|SV-259446r940960_rule,STIG-ID|APPL-14-000120,SWIFT-CSCv1|2.6,Vuln-ID|V-259446",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk -F \"=\" '/channeltimeout session:*/{print $2}'",
        "expect": "^900$"
    },
    "custom_item_42": {
        "description": "APPL-14-000130 - The macOS system must configure SSHD unused connection timeout to 900.",
        "info": "If SSHD is enabled, it must be configured with unused connection timeout set to 900.\n\nThis will set the timeout when there are no open channels within a session.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000163-GPOS-00072,SRG-OS-000279-GPOS-00109",
        "solution": "Configure the macOS system to set the SSHD unused connection timeout to 900 with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'unusedconnectionetimeout 900' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"unusedconnectionetimeout 900\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.1.11,800-171|3.13.9,800-53|AC-12,800-53|SC-10,800-53r5|AC-12,800-53r5|SC-10,CAT|II,CCI|CCI-001133,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,NIAv2|NS49,Rule-ID|SV-259447r940963_rule,STIG-ID|APPL-14-000130,SWIFT-CSCv1|2.6,Vuln-ID|V-259447",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectiontimeout/{print $2}'",
        "expect": "^900$"
    },
    "custom_item_43": {
        "description": "APPL-14-000140 - The macOS system must set SSH Active Server Alive Maximum to 0.",
        "info": "SSH must be configured with an Active Server Alive Maximum Count set to 0. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.\n\nNote: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.",
        "solution": "Configure the macOS system to set SSH Active Server Alive Maximum to 0 with the following command:\n\nfor u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do\n  config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2>&1 | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\\r')\n  configarray=( ${(f)config} )\n  for c in $configarray; do\n    /usr/bin/sudo -u $u /usr/bin/grep -q '^ServerAliveCountMax' \"$c\" && /usr/bin/sed -i '' 's/.*ServerAliveCountMax.*/ServerAliveCountMax 0/' \"$c\" || /bin/echo 'ServerAliveCountMax 0' >> \"$c\"\n  done\ndone",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-259448r940966_rule,STIG-ID|APPL-14-000140,SWIFT-CSCv1|2.6,Vuln-ID|V-259448",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "#!/bin/bash\n{\nret=\"pass\"\nfor u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do\n  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -T -G . | /usr/bin/grep -c \"^serveralivecountmax 0\")\n  if [[ \"$sshCheck\" == \"0\" ]]; then\n    ret=\"fail\"\n    break\n  fi\ndone\n/bin/echo $ret\n}",
        "expect": "^pass$"
    },
    "custom_item_44": {
        "description": "APPL-14-000160 - The macOS system must enforce auto logout after 86400 seconds of inactivity.",
        "info": "Auto logout must be configured to automatically terminate a user session and log out the after 86400 seconds of inactivity.\n\nNote: The maximum that macOS can be configured for autologoff is 86400 seconds.\n\n[IMPORTANT]\n====\nThe automatic logout may cause disruptions to an organization's workflow and/or loss of data. Information system security officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting to disable the automatic logout setting.\n====",
        "solution": "Configure the macOS system to enforce auto logout after 86400 seconds of inactivity by installing the \"com.apple.GlobalPreferences\" configuration profile.",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CAT|II,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-259449r940969_rule,STIG-ID|APPL-14-000160,Vuln-ID|V-259449",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^86400$",
        "payload_key": "com.apple.autologout.AutoLogOutDelay",
        "payload_type": ".GlobalPreferences"
    },
    "custom_item_45": {
        "description": "APPL-14-000170 - The macOS system must be configured to use an authorized time server.",
        "info": "Approved time servers must be the only servers configured for use.\n\nThis rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nAn authoritative time server is synchronized with redundant United States Naval Observatory (USNO) time servers as designated for the appropriate DOD network.\n\nSatisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144",
        "solution": "Configure the macOS system to use an authorized time server by installing the \"com.apple.MCX\" configuration profile.",
        "reference": "800-171|3.3.7,800-53|AU-8(1)(a),800-53|AU-8(1)(b),800-53r5|SC-45(1),CAT|II,CCI|CCI-001891,CCI|CCI-002046,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259450r940972_rule,STIG-ID|APPL-14-000170,TBA-FIISB|37.4,Vuln-ID|V-259450",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "@NTP_SERVER@",
        "payload_key": "timeServer",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_46": {
        "description": "APPL-14-000180 - The macOS system must enable time synchronization daemon.",
        "info": "The macOS time synchronization daemon (timed) must be enabled for proper time synchronization to an authorized time server.\n\nNote: The time synchronization daemon is enabled by default on macOS.\n\nSatisfies: SRG-OS-000355-GPOS-00143,SRG-OS-000356-GPOS-00144",
        "solution": "Configure the macOS system to enable time synchronization daemon with the following command:\n\n/bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.timed.plist",
        "reference": "800-171|3.3.7,800-53|AU-8(1)(a),800-53|AU-8(1)(b),800-53r5|SC-45(1),CAT|II,CCI|CCI-001891,CCI|CCI-002046,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259451r940975_rule,STIG-ID|APPL-14-000180,TBA-FIISB|37.4,Vuln-ID|V-259451",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c com.apple.timed",
        "expect": "^1$"
    },
    "custom_item_47": {
        "description": "APPL-14-001001 - The macOS system must be configured to audit all administrative action events.",
        "info": "Administrative action events include changes made to the system (e.g., modifying authentication policies). If audit records do not include \"ad\" events, it is difficult to identify incidents and to correlate incidents to subsequent events. Audit records can be generated from various components within the information system (e.g., via a module or policy filter).\n\nAdministrative and privileged access, including administrative use of the command line tools \"kextload\" and \"kextunload\" and changes to configuration settings, are logged by way of the \"ad\" flag.\n\nSatisfies: SRG-OS-000004-GPOS-00004,SRG-OS-000239-GPOS-00089,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000327-GPOS-00127,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000476-GPOS-00221",
        "solution": "Configure the macOS system to audit privileged access with the following command:\n\n/usr/bin/grep -qE \"^flags.*[^-]ad\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.",
        "reference": "800-171|3.1.1,800-171|3.1.7,800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-171|3.7.5,800-53|AC-2(4),800-53|AC-6(9),800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1)(a),800-53r5|AC-2(4),800-53r5|AC-6(9),800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000018,CCI|CCI-000172,CCI|CCI-001403,CCI|CCI-001404,CCI|CCI-001405,CCI|CCI-001814,CCI|CCI-002234,CCI|CCI-002884,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.2(d),CN-L3|8.1.4.3(a),CN-L3|8.1.10.6(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.3,ITSG-33|AC-2(4),ITSG-33|AC-6,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,NIAv2|AM23f,NIAv2|SM8,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-259452r940978_rule,STIG-ID|APPL-14-001001,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|36.2.3,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-259452",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'ad'",
        "expect": "^1$"
    },
    "custom_item_48": {
        "description": "APPL-14-001002 - The macOS system must be configured to audit all log on and log out events.",
        "info": "The audit system must be configured to record all attempts to log in and out of the system (lo).\n\nFrequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing both successful and unsuccessful attempts to switch to another user account (by way of monitoring log on and log out events) mitigates this risk.\n\nThe information system monitors log on and log out events.\n\nSatisfies: SRG-OS-000032-GPOS-00013,SRG-OS-000064-GPOS-00033,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000472-GPOS-00217,SRG-OS-000473-GPOS-00218",
        "solution": "Configure the macOS system to audit all log on and log out events with the following command:\n\n/usr/bin/grep -qE \"^flags.*[^-]lo\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.",
        "reference": "800-171|3.1.12,800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AC-17(1),800-53|AU-12c.,800-53|MA-4(1)(a),800-53r5|AC-17(1),800-53r5|AU-12c.,800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000067,CCI|CCI-000172,CCI|CCI-002884,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-3,CSF|PR.MA-2,CSF|PR.PT-1,CSF|PR.PT-4,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),ITSG-33|AU-12c.,ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.4.4,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259453r940981_rule,STIG-ID|APPL-14-001002,SWIFT-CSCv1|2.6,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-259453",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '^lo'",
        "expect": "^1$"
    },
    "custom_item_49": {
        "description": "/etc/security/audit_control",
        "file": "/etc/security/audit_control"
    },
    "custom_item_50": {
        "description": "launchctl",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c com.apple.auditd",
        "expect": "^1$"
    },
    "custom_item_51": {
        "description": "APPL-14-001010 - The macOS system must configure system to shut down upon audit failure.",
        "info": "The audit service must be configured to shut down the computer if it is unable to audit system events.\n\nOnce audit failure occurs, user and system activity are no longer recorded, and malicious activity could go undetected. Audit processing failures can occur due to software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows:\n\n(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.",
        "solution": "Configure the macOS system to shut down upon audit failure with the following command:\n\n/usr/bin/sed -i.bak 's/^policy.*/policy: ahlt,argv/' /etc/security/audit_control; /usr/sbin/audit -s",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259455r940987_rule,STIG-ID|APPL-14-001010,Vuln-ID|V-259455",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^policy/ {print $NF}' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'ahlt'",
        "expect": "^1$"
    },
    "custom_item_52": {
        "description": "APPL-14-001012 - The macOS system must configure audit log files to be owned by root.",
        "info": "Audit log files must be owned by root.\n\nThe audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log files owned by root with the following command:\n\n/usr/sbin/chown -R root /var/audit/*",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259456r940990_rule,STIG-ID|APPL-14-001012,Vuln-ID|V-259456",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$3} END {print s}'",
        "expect": "^0$"
    },
    "custom_item_53": {
        "description": "APPL-14-001013 - The macOS system must configure audit log folders to be owned by root.",
        "info": "Audit log folders must be owned by root.\n\nThe audit service must be configured to create log folders with the correct ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log folders are set to only be readable and writable by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log folders owned by root with the following command:\n\n/usr/sbin/chown root /var/audit",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259457r940993_rule,STIG-ID|APPL-14-001013,Vuln-ID|V-259457",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $3}' | /usr/bin/awk 'BEGIN {f=0} { if ($NF != 0) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'",
        "expect": "^Pass$"
    },
    "custom_item_54": {
        "description": "APPL-14-001014 - The macOS system must configure audit log files group to wheel.",
        "info": "Audit log files must have the group set to wheel.\n\nThe audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log files group-owned by wheel with the following command:\n\n/usr/bin/chgrp -R wheel /var/audit/*",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259458r940996_rule,STIG-ID|APPL-14-001014,Vuln-ID|V-259458",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$4} END {print s}'",
        "expect": "^0$"
    },
    "custom_item_55": {
        "description": "APPL-14-001015 - The macOS system must configure audit log folders group to wheel.",
        "info": "Audit log folders must have the group set to wheel.\n\nThe audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log folders group-owned by wheel with the following command:\n\n/usr/bin/chgrp wheel /var/audit",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259459r940999_rule,STIG-ID|APPL-14-001015,Vuln-ID|V-259459",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $4}' | /usr/bin/awk 'BEGIN {f=0} { if ($NF != 0) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'",
        "expect": "^Pass$"
    },
    "custom_item_56": {
        "description": "APPL-14-001016 - The macOS system must configure audit log files to mode 440 or less permissive.",
        "info": "The audit service must be configured to create log files that are readable only by the root user and group wheel. To achieve this, audit log files must be configured to mode 440 or less permissive; thereby preventing normal users from reading, modifying, or deleting audit logs.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log files set to mode 440 with the following command:\n\n/bin/chmod 440 /var/audit/*",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259460r941002_rule,STIG-ID|APPL-14-001016,Vuln-ID|V-259460",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -l $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '",
        "expect": "^0$"
    },
    "custom_item_57": {
        "description": "APPL-14-001017 - The macOS system must configure audit log folders to mode 700 or less permissive.",
        "info": "The audit log folder must be configured to mode 700 or less permissive so that only the root user is able to read, write, and execute changes to folders.\n\nBecause audit logs contain sensitive data about the system and users, the audit service must be configured to mode 700 or less permissive; thereby preventing normal users from reading, modifying, or deleting audit logs.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with audit log folders set to mode 700 with the following command:\n\n/bin/chmod 700 /var/audit",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259461r941005_rule,STIG-ID|APPL-14-001017,Vuln-ID|V-259461",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/stat -f %A $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk 'BEGIN {f=0} { if ($NF !~ /[0-7]00/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'",
        "expect": "^Pass$"
    },
    "custom_item_58": {
        "description": "APPL-14-001020 - The macOS system must be configured to audit all deletions of object attributes.",
        "info": "The audit system must be configured to record enforcement actions of attempts to delete file attributes (fd).\n\n***Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to delete a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000064-GPOS-00033,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212",
        "solution": "Configure the macOS system to audit all deletions of object attributes with the following command:\n\n/usr/bin/grep -qE \"^flags.*-fd\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fd/' /etc/security/audit_control;/usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-171|3.4.5,800-171|3.7.5,800-53|AU-9,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1)(a),800-53r5|AU-9,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000172,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001814,CCI|CCI-002884,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M5.2.3,NESA|M5.5.2,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259462r941008_rule,STIG-ID|APPL-14-001020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-259462",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fd'",
        "expect": "^1$"
    },
    "custom_item_59": {
        "description": "APPL-14-001021 - The macOS system must be configured to audit all changes of object attributes.",
        "info": "The audit system must be configured to record enforcement actions of attempts to modify file attributes (fm).\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., modifications to a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions attempts to modify a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000064-GPOS-00033,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099,SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212",
        "solution": "Configure the macOS system to audit all changes of object attributes with the following command:\n\n/usr/bin/grep -qE \"^flags.*fm\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control;/usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-171|3.4.5,800-171|3.7.5,800-53|AU-9,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1)(a),800-53r5|AU-9,800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000172,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001814,CCI|CCI-002884,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|M5.2.3,NESA|M5.5.2,NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259463r941011_rule,STIG-ID|APPL-14-001021,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-259463",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '^fm'",
        "expect": "^1$"
    },
    "custom_item_60": {
        "description": "APPL-14-001022 - The macOS system must be configured to audit all failed read actions on the system.",
        "info": "The audit system must be configured to record enforcement actions of access restrictions, including failed file read (-fr) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying access to a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to read a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.\n\nSatisfies: SRG-OS-000463-GPOS-00207,SRG-OS-000057-GPOS-00027,SRG-OS-000465-GPOS-00209,SRG-OS-000474-GPOS-00219",
        "solution": "Configure the macOS system to audit all failed read actions on the system with the following command:\n\n/usr/bin/grep -qE \"^flags.*-fr\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fr/' /etc/security/audit_control;/usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12c.,800-53r5|AU-9,800-53r5|AU-12c.,CAT|II,CCI|CCI-000162,CCI|CCI-000172,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12c.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259464r941014_rule,STIG-ID|APPL-14-001022,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-259464",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fr'",
        "expect": "^1$"
    },
    "custom_item_61": {
        "description": "APPL-14-001023 - The macOS system must be configured to audit all failed write actions on the system.",
        "info": "The audit system must be configured to record enforcement actions of access restrictions, including failed file write (-fw) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying users access to edit a file by applying file permissions).\n\nThis configuration ensures that audit lists include events in which enforcement actions prevent attempts to change a file.\n\nWithout auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.\n\nSatisfies: SRG-OS-000463-GPOS-00207,SRG-OS-000057-GPOS-00027,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212",
        "solution": "Configure the macOS system to audit all failed write actions on the system with the following command:\n\n/usr/bin/grep -qE \"^flags.*-fw\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fw/' /etc/security/audit_control;/usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12c.,800-53r5|AU-9,800-53r5|AU-12c.,CAT|II,CCI|CCI-000162,CCI|CCI-000172,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12c.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.2,NESA|T3.6.4,NESA|T3.6.5,NESA|T3.6.6,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259465r941017_rule,STIG-ID|APPL-14-001023,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-259465",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-fw'",
        "expect": "^1$"
    },
    "custom_item_62": {
        "description": "APPL-14-001024 - The macOS system must be configured to audit all failed program execution on the system.",
        "info": "The audit system must be configured to record enforcement actions of access restrictions, including failed program execute (-ex) attempts.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using program execution restrictions (e.g., denying users access to execute certain processes).\n\nThis configuration ensures that audit lists include events in which program execution has failed.\n\nWithout auditing the enforcement of program execution, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.\n\nSatisfies: SRG-OS-000463-GPOS-00207,SRG-OS-000365-GPOS-00152,SRG-OS-000458-GPOS-00203,SRG-OS-000465-GPOS-00209",
        "solution": "Configure the macOS system to audit all failed program execution on the system with the following command:\n\n/usr/bin/grep -qE \"^flags.*-ex\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-ex/' /etc/security/audit_control; /usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-53|AU-12c.,800-53|CM-5(1),800-53r5|AU-12c.,800-53r5|CM-5(1),CAT|II,CCI|CCI-000172,CCI|CCI-001814,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,ITSG-33|CM-5(1),NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259466r941020_rule,STIG-ID|APPL-14-001024,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-259466",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec '\\\\-ex'",
        "expect": "^1$"
    },
    "custom_item_63": {
        "description": "APPL-14-001029 - The macOS system must configure audit retention to seven days.",
        "info": "The audit service must be configured to require records be kept for an organizational defined value before deletion, unless the system uses a central audit record storage facility.\n\nWhen \"expire-after\" is set to \"7d\", the audit service will not delete audit logs until the log data criteria is met.",
        "solution": "Configure the macOS system to set audit retention to seven days with the following command:\n\n/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/sbin/audit -s",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|III,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259467r941023_rule,STIG-ID|APPL-14-001029,Vuln-ID|V-259467",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control",
        "expect": "^7d$"
    },
    "custom_item_64": {
        "description": "APPL-14-001030 - The macOS system must configure audit capacity warning.",
        "info": "The audit service must be configured to notify the system administrator when the amount of free disk space remaining reaches an organization defined value.\n\nThis rule ensures that the system administrator is notified in advance that action is required to free up more disk space for audit logs.\n\nSatisfies: SRG-OS-000046-GPOS-00022,SRG-OS-000343-GPOS-00134",
        "solution": "Configure the macOS system to require a minimum of 25 percent free disk space for audit record storage with the following command:\n\n/usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/sbin/audit -s",
        "reference": "800-171|3.3.4,800-53|AU-5a.,800-53|AU-5(1),800-53r5|AU-5a.,800-53r5|AU-5(1),CAT|II,CCI|CCI-000139,CCI|CCI-001855,CN-L3|7.1.3.3(e),CN-L3|7.1.3.7(e),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5a.,ITSG-33|AU-5(1),NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259468r941026_rule,STIG-ID|APPL-14-001030,TBA-FIISB|37.3.2,Vuln-ID|V-259468",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control",
        "expect": "^25$"
    },
    "custom_item_65": {
        "description": "APPL-14-001031 - The macOS system must configure audit failure notification.",
        "info": "The audit service must be configured to immediately print messages to the console or email administrator users when an auditing failure occurs.\n\nIt is critical for the appropriate personnel to be made aware immediately if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of a potentially harmful failure in the auditing system's capability, and system operation may be adversely affected.\n\nSatisfies: SRG-OS-000047-GPOS-00023,SRG-OS-000344-GPOS-00135",
        "solution": "Configure the macOS system to produce audit failure notification with the following command:\n\n/usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/sbin/audit -s",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53|AU-5(2),800-53r5|AU-5b.,800-53r5|AU-5(2),CAT|II,CCI|CCI-000140,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259469r941029_rule,STIG-ID|APPL-14-001031,Vuln-ID|V-259469",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/grep -c \"logger -s -p\" /etc/security/audit_warn",
        "expect": "^1$"
    },
    "custom_item_66": {
        "description": "APPL-14-001044 - The macOS system must configure system to audit all authorization and authentication events.",
        "info": "The auditing system must be configured to flag authorization and authentication (aa) events.\n\nAuthentication events contain information about the identity of a user, server, or client. Authorization events contain information about permissions, rights, and rules. If audit records do not include aa events, it is difficult to identify incidents and to correlate incidents to subsequent events.\n\nAudit records can be generated from various components within the information system (e.g., via a module or policy filter).\n\nSatisfies: SRG-OS-000365-GPOS-00152,SRG-OS-000392-GPOS-00172,SRG-OS-000458-GPOS-00203,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000475-GPOS-00220,SRG-OS-000477-GPOS-00222",
        "solution": "Configure the macOS system to audit logon events with the following command:\n\n/usr/bin/grep -qE \"^flags.*[^-]aa\" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/sbin/audit -s",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-171|3.7.5,800-53|AU-12c.,800-53|CM-5(1),800-53|MA-4(1)(a),800-53r5|AU-12c.,800-53r5|CM-5(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000172,CCI|CCI-001814,CCI|CCI-002884,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,ITSG-33|CM-5(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259470r941032_rule,STIG-ID|APPL-14-001044,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-259470",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\\\\n' | /usr/bin/grep -Ec 'aa'",
        "expect": "^1$"
    },
    "custom_item_67": {
        "description": "APPL-14-001060 - The macOS system must set smart card certificate trust to moderate.",
        "info": "The macOS system must be configured to block access to users who are no longer authorized (i.e., users with revoked certificates).\n\nTo prevent the use of untrusted certificates, the certificates on a smart card must meet the following criteria: its issuer has a system-trusted certificate, the certificate is not expired, its \"valid-after\" date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) checking.\n\nBy setting the smart card certificate trust level to moderate, the system will execute a soft revocation, i.e., if the OCSP/CRL server is unreachable, authentication will still succeed.\n\nNote: Before applying this setting, refer to the smart card supplemental guidance.\n\nSatisfies: SRG-OS-000066-GPOS-00034,SRG-OS-000377-GPOS-00162,SRG-OS-000384-GPOS-00167,SRG-OS-000403-GPOS-00182",
        "solution": "Configure the macOS system to check the revocation status of user certificates by installing the \"com.apple.security.smartcard\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the configuration profile.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.13.15,800-53|IA-2(12),800-53|IA-5(2)(a),800-53|IA-5(2)(d),800-53|SC-23(5),800-53r5|IA-2(12),800-53r5|IA-5(2)(a),800-53r5|IA-5(2)(d),800-53r5|SC-23(5),CAT|II,CCI|CCI-000185,CCI|CCI-001954,CCI|CCI-001991,CCI|CCI-002470,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-5(2),ITSG-33|IA-5(2)(a),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259471r941035_rule,STIG-ID|APPL-14-001060,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259471",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^2$",
        "payload_key": "checkCertificateTrust",
        "payload_type": "com.apple.security.smartcard"
    },
    "custom_item_68": {
        "description": "APPL-14-001100 - The macOS system must disable root logon for SSH.",
        "info": "If SSH is enabled to ensure individual accountability and prevent unauthorized access, logging in as root via SSH must be disabled.\n\nThe macOS system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users must never log in directly as root.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000109-GPOS-00056,SRG-OS-000364-GPOS-00151",
        "solution": "Configure the macOS system to disable root login for SSH with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\n\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\n\n/usr/bin/grep -qxF 'permitrootlogin no' \"${include_dir}01-mscp-sshd.conf\" 2>/dev/null || echo \"permitrootlogin no\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.4.5,800-171|3.5.1,800-53|CM-5(1),800-53|IA-2(5),800-53r5|CM-5(1),800-53r5|IA-2(5),CAT|II,CCI|CCI-000770,CCI|CCI-001813,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-5(1),ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.1.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|13.2,Rule-ID|SV-259472r941038_rule,STIG-ID|APPL-14-001100,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259472",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/awk '/permitrootlogin/{print $2}'",
        "expect": "^no$"
    },
    "custom_item_69": {
        "description": "APPL-14-001110 - The macOS system must configure audit_control group to wheel.",
        "info": "/etc/security/audit_control must have the group set to wheel.\n\nThe audit service must be configured with the correct group ownership to prevent normal users from manipulation audit log configurations.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with the audit_control group to wheel with the following command:\n\n/usr/bin/chgrp wheel /etc/security/audit_control",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12b.,800-53r5|AU-9,800-53r5|AU-12b.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000171,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12b.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259473r941041_rule,STIG-ID|APPL-14-001110,SWIFT-CSCv1|6.4,Vuln-ID|V-259473",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $4}'",
        "expect": "^0$"
    },
    "custom_item_70": {
        "description": "APPL-14-001120 - The macOS system must configure audit_control owner to root.",
        "info": "/etc/security/audit_control must have the owner set to root.\n\nThe audit service must be configured with the correct ownership to prevent normal users from manipulation audit log configurations.\n\nAudit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with the audit_control owner to root with the following command:\n\n/usr/sbin/chown root /etc/security/audit_control",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12b.,800-53r5|AU-9,800-53r5|AU-12b.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000171,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12b.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259474r941044_rule,STIG-ID|APPL-14-001120,SWIFT-CSCv1|6.4,Vuln-ID|V-259474",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $3}'",
        "expect": "^0$"
    },
    "custom_item_71": {
        "description": "APPL-14-001130 - The macOS system must configure audit_control to mode 440 or less permissive.",
        "info": "/etc/security/audit_control must be configured so that it is readable only by the root user and group wheel.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system with the audit_control to mode 440 with the following command:\n\n/bin/chmod 440 /etc/security/audit_control",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12b.,800-53r5|AU-9,800-53r5|AU-12b.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000171,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12b.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259475r941047_rule,STIG-ID|APPL-14-001130,SWIFT-CSCv1|6.4,Vuln-ID|V-259475",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -l /etc/security/audit_control | /usr/bin/awk '!/-r--[r-]-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/xargs",
        "expect": "^0$"
    },
    "custom_item_72": {
        "description": "APPL-14-001140 - The macOS system must configure audit_control to not contain access control lists.",
        "info": "/etc/security/audit_control must not contain Access Control Lists (ACLs).\n\n/etc/security/audit_control contains sensitive configuration data about the audit service. This rule ensures that the audit service is configured to be readable and writable only by system administrators in order to prevent normal users from manipulating audit logs.\n\nSatisfies: SRG-OS-000057-GPOS-00027,SRG-OS-000058-GPOS-00028,SRG-OS-000059-GPOS-00029,SRG-OS-000063-GPOS-00032,SRG-OS-000256-GPOS-00097,SRG-OS-000257-GPOS-00098,SRG-OS-000258-GPOS-00099",
        "solution": "Configure the macOS system without ACLs applied to audit_control with the following command:\n\n/bin/chmod -N /etc/security/audit_control",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.8,800-53|AU-9,800-53|AU-12b.,800-53r5|AU-9,800-53r5|AU-12b.,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CCI|CCI-000171,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|AU-12b.,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259476r941050_rule,STIG-ID|APPL-14-001140,SWIFT-CSCv1|6.4,Vuln-ID|V-259476",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/ls -le /etc/security/audit_control | /usr/bin/awk '{print $1}' | /usr/bin/grep -c \":\"",
        "expect": "^0$"
    },
    "custom_item_73": {
        "description": "APPL-14-001150 - The macOS system must disable password authentication for SSH.",
        "info": "If remote logon through SSH is enabled, password-based authentication must be disabled for user logon.\n\nAll users must go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nNote: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000067-GPOS-00035,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000125-GPOS-00065,SRG-OS-000375-GPOS-00160",
        "solution": "Configure the macOS system to disable password authentication for SSH with the following command:\n\ninclude_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')\nif [[ -z $include_dir ]]; then\n  /usr/bin/sed -i.bk \"1s/.*/Include \\/etc\\/ssh\\/sshd_config.d\\/\\*/\" /etc/ssh/sshd_config\nfi\necho \"passwordauthentication no\" >> \"${include_dir}01-mscp-sshd.conf\"\necho \"kbdinteractiveauthentication no\" >> \"${include_dir}01-mscp-sshd.conf\"\n\nfor file in $(ls ${include_dir}); do\n  if [[ \"$file\" == \"100-macos.conf\" ]]; then\n      continue\n  fi\n  if [[ \"$file\" == \"01-mscp-sshd.conf\" ]]; then\n      break\n  fi\n  /bin/mv ${include_dir}${file} ${include_dir}20-${file}\ndone",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.3,800-171|3.5.4,800-171|3.7.5,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53|IA-2(11),800-53|IA-5(2)(b),800-53|MA-4c.,800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(6),800-53r5|IA-2(8),800-53r5|IA-5(2)(b),800-53r5|MA-4c.,CAT|I,CCI|CCI-000186,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-000877,CCI|CCI-001941,CCI|CCI-001948,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(d),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.MA-2,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),ITSG-33|IA-2(100),ITSG-33|IA-5(2)(b),ITSG-33|MA-4c.,NESA|T2.3.4,NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,PCI-DSSv3.2.1|8.3,PCI-DSSv3.2.1|8.3.1,PCI-DSSv3.2.1|8.3.2,PCI-DSSv4.0|8.4.1,PCI-DSSv4.0|8.4.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259477r941053_rule,STIG-ID|APPL-14-001150,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|45.2.3,Vuln-ID|V-259477",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/sshd -G | /usr/bin/grep -Ec '^(passwordauthentication\\\\s+no|kbdinteractiveauthentication\\\\s+no)'",
        "expect": "^2$"
    },
    "custom_item_74": {
        "description": "APPL-14-002001 - The macOS system must disable Server Message Block sharing.",
        "info": "Support for Server Message Block (SMB) file sharing is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities.",
        "solution": "Configure the macOS system to disable Server Message Block sharing with the following command:\n\n/bin/launchctl disable system/com.apple.smbd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259478r941056_rule,STIG-ID|APPL-14-002001,TBA-FIISB|31.1,Vuln-ID|V-259478",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.smbd\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_75": {
        "description": "APPL-14-002003 - The macOS system must disable Network File System service.",
        "info": "Support for Network File Systems (NFS) services is nonessential and, therefore, must be disabled.",
        "solution": "Configure the macOS system to disable network file system service with the following command:\n\n/bin/launchctl disable system/com.apple.nfsd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259479r941059_rule,STIG-ID|APPL-14-002003,TBA-FIISB|31.1,Vuln-ID|V-259479",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.nfsd\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_76": {
        "description": "APPL-14-002004 - The macOS system must disable Location Services.",
        "info": "The information system must be configured to provide only essential capabilities. Disabling Location Services helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "Configure the macOS system to disable Location Services with the following command:\n\n/usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false; /bin/launchctl kickstart -k system/com.apple.locationd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259480r941062_rule,STIG-ID|APPL-14-002004,SWIFT-CSCv1|2.3,Vuln-ID|V-259480",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false"
    },
    "custom_item_77": {
        "description": "APPL-14-002005 - The macOS system must disable Bonjour multicast.",
        "info": "Bonjour multicast advertising must be disabled to prevent the system from broadcasting its presence and available services over network interfaces.",
        "solution": "Configure the macOS system to disable Bonjour multicast by installing the \"com.apple.mDNSResponder\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259481r941065_rule,STIG-ID|APPL-14-002005,SWIFT-CSCv1|2.3,Vuln-ID|V-259481",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "NoMulticastAdvertisements",
        "payload_type": "com.apple.mDNSResponder"
    },
    "custom_item_78": {
        "description": "APPL-14-002006 - The macOS system must disable Unix-to-Unix Copy Protocol service.",
        "info": "The system must not have the Unix-to-Unix Copy Protocol (UUCP) service active.\n\nUUCP, a set of programs that enable the sending of files between different Unix systems as well as sending commands to be executed on another system, is not essential and must be disabled in order to prevent the unauthorized connection of devices, transfer of information, and tunneling.\n\nNote: UUCP service is disabled at startup by default macOS.",
        "solution": "Configure the macOS system to disable Unix-to-Unix copy protocol service with the following command:\n\n/bin/launchctl disable system/com.apple.uucp\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259482r941068_rule,STIG-ID|APPL-14-002006,TBA-FIISB|31.1,Vuln-ID|V-259482",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.uucp\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_79": {
        "description": "APPL-14-002007 - The macOS system must disable Internet Sharing.",
        "info": "If the system does not require Internet Sharing, support for it is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling Internet sharing helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "Configure the macOS system to disable Internet Sharing by installing the \"com.apple.MCX\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259483r941071_rule,STIG-ID|APPL-14-002007,SWIFT-CSCv1|2.3,Vuln-ID|V-259483",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "forceInternetSharingOff",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_80": {
        "description": "APPL-14-002008 - The macOS system must disable the built-in web server.",
        "info": "The built-in web server is a nonessential service built into macOS and must be disabled.\n\nNote: The built in web server service is disabled at startup by default macOS.",
        "solution": "Configure the macOS system to disable the built-in web server with the following command:\n\n/bin/launchctl disable system/org.apache.httpd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259484r941074_rule,STIG-ID|APPL-14-002008,TBA-FIISB|31.1,Vuln-ID|V-259484",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"org.apache.httpd\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_81": {
        "description": "APPL-14-002009 - The macOS system must disable AirDrop.",
        "info": "AirDrop must be disabled to prevent file transfers to or from unauthorized devices. AirDrop allows users to share and receive files from other nearby Apple devices.\n\nSatisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118",
        "solution": "Configure the macOS system to disable AirDrop by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.1.1,800-171|3.1.17,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-18(1),800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-18(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000213,CCI|CCI-000381,CCI|CCI-001443,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-18(1),ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259485r941077_rule,STIG-ID|APPL-14-002009,SWIFT-CSCv1|2.3,TBA-FIISB|31.1,Vuln-ID|V-259485",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowAirDrop",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_82": {
        "description": "familyControlsEnabled",
        "expect": "true",
        "payload_key": "familyControlsEnabled",
        "payload_type": "com.apple.applicationaccess.new"
    },
    "custom_item_83": {
        "description": "pathBlackList",
        "expect": "/Applications/FaceTime.app",
        "payload_key": "pathBlackList",
        "payload_type": "com.apple.applicationaccess.new"
    },
    "custom_item_84": {
        "description": "APPL-14-002012 - The macOS system must disable the iCloud Calendar services.",
        "info": "The macOS built-in Calendar.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Calendar services by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259487r941083_rule,STIG-ID|APPL-14-002012,SWIFT-CSCv1|2.3,Vuln-ID|V-259487",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudCalendar",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_85": {
        "description": "APPL-14-002013 - The macOS system must disable iCloud Reminders.",
        "info": "The macOS built-in Reminders.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated reminders synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Reminders by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259488r941086_rule,STIG-ID|APPL-14-002013,SWIFT-CSCv1|2.3,Vuln-ID|V-259488",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudReminders",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_86": {
        "description": "APPL-14-002014 - The macOS system must disable iCloud Address Book.",
        "info": "The macOS built-in Contacts.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data, and, therefore, automated contact synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Address Book by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259489r941089_rule,STIG-ID|APPL-14-002014,SWIFT-CSCv1|2.3,Vuln-ID|V-259489",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudAddressBook",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_87": {
        "description": "APPL-14-002015 - The macOS system must disable iCloud Mail.",
        "info": "The macOS built-in Mail.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated mail synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Mail by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259490r941092_rule,STIG-ID|APPL-14-002015,SWIFT-CSCv1|2.3,Vuln-ID|V-259490",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudMail",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_88": {
        "description": "APPL-14-002016 - The macOS system must disable iCloud Notes.",
        "info": "The macOS built-in Notes.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated Notes synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Notes by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259491r941095_rule,STIG-ID|APPL-14-002016,SWIFT-CSCv1|2.3,Vuln-ID|V-259491",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudNotes",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_89": {
        "description": "APPL-14-002017 - The macOS system must disable the camera.",
        "info": "macOS must be configured to disable the camera.",
        "solution": "Configure the macOS system to disable the camera by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259492r941098_rule,STIG-ID|APPL-14-002017,SWIFT-CSCv1|2.3,Vuln-ID|V-259492",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCamera",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_90": {
        "description": "APPL-14-002020 - The macOS system must disable Siri.",
        "info": "Support for Siri is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities.",
        "solution": "Configure the macOS system to disable Siri by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259493r941101_rule,STIG-ID|APPL-14-002020,SWIFT-CSCv1|2.3,Vuln-ID|V-259493",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowAssistant",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_91": {
        "description": "AutoSubmit",
        "expect": "false",
        "payload_key": "AutoSubmit",
        "payload_type": "com.apple.SubmitDiagInfo"
    },
    "custom_item_92": {
        "description": "allowDiagnosticSubmission",
        "expect": "false",
        "payload_key": "allowDiagnosticSubmission",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_93": {
        "description": "APPL-14-002022 - The macOS system must disable Remote Apple Events.",
        "info": "If the system does not require Remote Apple Events, support for Apple Remote Events is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling Remote Apple Events helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.\n\nSatisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000096-GPOS-00050",
        "solution": "Configure the macOS system to disable Remote Apple Events with the following commands:\n\n/usr/sbin/systemsetup -setremoteappleevents off\n/bin/launchctl disable system/com.apple.AEServer\n\nNote: Systemsetup with -setremoteappleevents flag will fail unless Full Disk Access to systemsetup or its parent process is granted. This requires supervision.",
        "reference": "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|CM-7b.,800-53r5|AC-3,800-53r5|CM-7b.,CAT|II,CCI|CCI-000213,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(b),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259495r941107_rule,STIG-ID|APPL-14-002022,SWIFT-CSCv1|2.3,TBA-FIISB|31.1,Vuln-ID|V-259495",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.AEServer\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_94": {
        "description": "APPL-14-002035 - The macOS system must disable Apple ID setup during Setup Assistant.",
        "info": "The prompt for Apple ID setup during Setup Assistant must be disabled.\n\nmacOS will automatically prompt new users to set up an Apple ID while they are going through Setup Assistant if this is not disabled, misleading new users to think they need to create Apple ID accounts upon their first log on.",
        "solution": "Configure the macOS system to disable Apple ID setup during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259496r941110_rule,STIG-ID|APPL-14-002035,SWIFT-CSCv1|2.3,Vuln-ID|V-259496",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipCloudSetup",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_95": {
        "description": "APPL-14-002036 - The macOS system must disable Privacy Setup services during Setup Assistant.",
        "info": "The prompt for Privacy Setup services during Setup Assistant must be disabled.\n\nOrganizations must apply organizationwide configuration settings. The macOS Privacy Setup services prompt guides new users through enabling their own specific privacy settings; this is not essential and, therefore, must be disabled to prevent against the risk of individuals electing privacy settings with the potential to override organizationwide settings.",
        "solution": "Configure the macOS system to disable Privacy Setup services during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259497r941113_rule,STIG-ID|APPL-14-002036,SWIFT-CSCv1|2.3,Vuln-ID|V-259497",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipPrivacySetup",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_96": {
        "description": "APPL-14-002037 - The macOS system must disable iCloud Storage Setup during Setup Assistant.",
        "info": "The prompt to set up iCloud storage services during Setup Assistant must be disabled.\n\nThe default behavior of macOS is to prompt new users to set up storage in iCloud. Disabling the iCloud storage setup prompt provides organizations more control over the storage of their data.",
        "solution": "Configure the macOS system to disable iCloud Storage Setup during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259498r941116_rule,STIG-ID|APPL-14-002037,SWIFT-CSCv1|2.3,Vuln-ID|V-259498",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipiCloudStorageSetup",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_97": {
        "description": "APPL-14-002038 - The macOS system must disable Trivial File Transfer Protocol service.",
        "info": "If the system does not require Trivial File Transfer Protocol (TFTP), support it is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling TFTP helps prevent the unauthorized connection of devices and the unauthorized transfer of information.\n\nNote: TFTP service is disabled at startup by default macOS.\n\nSatisfies: SRG-OS-000074-GPOS-00042,SRG-OS-000080-GPOS-00048",
        "solution": "Configure the macOS system to disable trivial file transfer protocol service with the following command:\n\n/bin/launchctl disable system/com.apple.tftpd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.1,800-171|3.5.10,800-53|AC-3,800-53|IA-5(1)(c),800-53r5|AC-3,800-53r5|IA-5(1)(c),CAT|I,CCI|CCI-000197,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|IA-5(1)(c),NESA|T4.2.1,NESA|T5.2.3,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|CY6,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259499r941119_rule,STIG-ID|APPL-14-002038,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,TBA-FIISB|31.1,Vuln-ID|V-259499",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.tftpd\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_98": {
        "description": "APPL-14-002039 - The macOS system must disable Siri Setup during Setup Assistant.",
        "info": "The prompt for Siri during Setup Assistant must be disabled.\n\nOrganizations must apply organizationwide configuration settings. The macOS Siri Assistant Setup prompt guides new users through enabling their own specific Siri settings; this is not essential and, therefore, must be disabled to prevent against the risk of individuals electing Siri settings with the potential to override organizationwide settings.",
        "solution": "Configure the macOS system to disable Siri Setup during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259500r941122_rule,STIG-ID|APPL-14-002039,SWIFT-CSCv1|2.3,Vuln-ID|V-259500",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipSiriSetup",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_99": {
        "description": "APPL-14-002040 - The macOS system must disable iCloud Keychain synchronization.",
        "info": "The macOS system's ability to automatically synchronize a user's passwords to their iCloud account must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, password management and synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Keychain synchronization by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259501r941125_rule,STIG-ID|APPL-14-002040,SWIFT-CSCv1|2.3,Vuln-ID|V-259501",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudKeychainSync",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_100": {
        "description": "APPL-14-002041 - The macOS system must disable iCloud Document synchronization.",
        "info": "The macOS built-in iCloud document synchronization service must be disabled to prevent organizational data from being synchronized to personal or nonapproved storage.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated document synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Document synchronization by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259502r941128_rule,STIG-ID|APPL-14-002041,SWIFT-CSCv1|2.3,Vuln-ID|V-259502",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudDocumentSync",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_101": {
        "description": "APPL-14-002042 - The macOS system must disable iCloud Bookmarks.",
        "info": "The macOS built-in Safari.app bookmark synchronization via the iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated bookmark synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Bookmarks by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259503r941131_rule,STIG-ID|APPL-14-002042,SWIFT-CSCv1|2.3,Vuln-ID|V-259503",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudBookmarks",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_102": {
        "description": "APPL-14-002043 - The macOS system must disable iCloud Photo Library.",
        "info": "The macOS built-in Photos.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated photo synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable the iCloud Photo Library by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259504r941134_rule,STIG-ID|APPL-14-002043,SWIFT-CSCv1|2.3,Vuln-ID|V-259504",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudPhotoLibrary",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_103": {
        "description": "APPL-14-002050 - The macOS system must disable Screen Sharing and Apple Remote Desktop.",
        "info": "Support for both Screen Sharing and Apple Remote Desktop (ARD) is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling screen sharing and ARD helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.",
        "solution": "Configure the macOS system to disable Screen Sharing and Apple Remote Desktop with the following command:\n\n/bin/launchctl disable system/com.apple.screensharing\n\nThe system may need to be restarted for the update to take effect.\nNote: This will apply to the whole system.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259505r941137_rule,STIG-ID|APPL-14-002050,TBA-FIISB|31.1,Vuln-ID|V-259505",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -c '\"com.apple.screensharing\" => disabled'",
        "expect": "^1$"
    },
    "custom_item_104": {
        "description": "APPL-14-002051 - The macOS system must disable the TouchID System Settings pane.",
        "info": "The System Settings pane for TouchID must be disabled.\n\nDisabling the System Settings pane prevents the users from configuring TouchID.",
        "solution": "Configure the macOS system to disable the TouchID System Settings pane by installing the \"com.apple.systempreferences\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259506r941140_rule,STIG-ID|APPL-14-002051,SWIFT-CSCv1|2.3,Vuln-ID|V-259506",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()=\"DisabledSystemSettings\"]/following-sibling::*[1]' - | /usr/bin/grep -c \"com.apple.Touch-ID-Settings.extension\"",
        "expect": "^1$"
    },
    "custom_item_105": {
        "description": "APPL-14-002052 - The macOS system must disable the System Settings pane for Wallet and Apple Pay.",
        "info": "The System Settings pane for Wallet and Apple Pay must be disabled.\n\nDisabling the System Settings pane prevents the users from configuring Wallet and Apple Pay.",
        "solution": "Configure the macOS system to disable the System Settings pane for Wallet and Apple Pay by installing the \"com.apple.systempreferences\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259507r941143_rule,STIG-ID|APPL-14-002052,SWIFT-CSCv1|2.3,Vuln-ID|V-259507",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()=\"DisabledSystemSettings\"]/following-sibling::*[1]' - | /usr/bin/grep -c \"com.apple.WalletSettingsExtension\"",
        "expect": "^1$"
    },
    "custom_item_106": {
        "description": "APPL-14-002053 - The macOS system must disable the system settings pane for Siri.",
        "info": "The System Settings pane for Siri must be hidden.\n\nHiding the System Settings pane prevents the users from configuring Siri.",
        "solution": "Configure the macOS system to disable the system settings pane for Siri by installing the \"com.apple.systempreferences\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259508r941146_rule,STIG-ID|APPL-14-002053,SWIFT-CSCv1|2.3,Vuln-ID|V-259508",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()=\"DisabledSystemSettings\"]/following-sibling::*[1]' - | /usr/bin/grep -c com.apple.Siri-Settings.extension",
        "expect": "^1$"
    },
    "custom_item_107": {
        "description": "APPL-14-002060 - The macOS system must apply gatekeeper settings to block applications from unidentified developers.",
        "info": "The information system implements cryptographic mechanisms to authenticate software prior to installation.\n\nGatekeeper settings must be configured correctly to only allow the system to run applications downloaded from the Mac App Store or applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS to verify that the application has not been modified by a malicious third party.",
        "solution": "Configure the macOS system to apply gatekeeper settings to block applications from unidentified developers with the following command:\n\n/usr/sbin/spctl --global-enable; /usr/sbin/spctl --enable",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|I,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-259509r941149_rule,STIG-ID|APPL-14-002060,Vuln-ID|V-259509",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/spctl --status --verbose | /usr/bin/grep -c \"developer id enabled\"",
        "expect": "^1$"
    },
    "custom_item_108": {
        "description": "APPL-14-002062 - The macOS system must disable Bluetooth when no approved device is connected.",
        "info": "The macOS system must be configured to disable Bluetooth unless an approved device is connected.\n\n[IMPORTANT]\n====\nInformation system security officers (ISSOs) may make the risk-based decision not to disable Bluetooth to maintain necessary functionality, but they are advised to first fully weigh the potential risks posed to their organization.\n====\n\nSatisfies: SRG-OS-000423-GPOS-00187,SRG-OS-000481-GPOS-00481",
        "solution": "Configure the macOS system to disable Bluetooth by installing the \"com.apple.MCXBluetooth\" configuration profiles.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|I,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259510r941152_rule,STIG-ID|APPL-14-002062,Vuln-ID|V-259510",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "DisableBluetooth",
        "payload_type": "com.apple.MCXBluetooth"
    },
    "custom_item_109": {
        "description": "EnableGuestAccount",
        "expect": "false",
        "payload_key": "EnableGuestAccount",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_110": {
        "description": "DisableGuestAccount",
        "expect": "true",
        "payload_key": "DisableGuestAccount",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_111": {
        "description": "APPL-14-002064 - The macOS system must enable Gatekeeper.",
        "info": "Gatekeeper must be enabled.\n\nGatekeeper is a security feature that ensures applications are digitally signed by an Apple-issued certificate before they are permitted to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.\n\nAdministrator users will still have the option to override these settings on a case-by-case basis.",
        "solution": "Configure the macOS system to enable gatekeeper with the following command:\n\n/usr/sbin/spctl --global-enable",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|I,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-259512r941158_rule,STIG-ID|APPL-14-002064,Vuln-ID|V-259512",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/spctl --status | /usr/bin/grep -c \"assessments enabled\"",
        "expect": "^1$"
    },
    "custom_item_112": {
        "description": "APPL-14-002066 - The macOS system must disable unattended or automatic log on to the system.",
        "info": "Automatic logon must be disabled.\n\nWhen automatic logons are enabled, the default user account is automatically logged on at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer and find it already logged in. Disabling automatic logons mitigates this risk.",
        "solution": "Configure the macOS system to disable unattended or automatic logon to the system by installing the \"com.apple.loginwindow\" configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259513r941161_rule,STIG-ID|APPL-14-002066,SWIFT-CSCv1|2.3,Vuln-ID|V-259513",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "com.apple.login.mcx.DisableAutoLoginClient",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_113": {
        "description": "APPL-14-002068 - The macOS system must secure user's home folders.",
        "info": "The system must be configured to prevent access to other user's home folders.\n\nThe default behavior of macOS is to allow all valid users access to the top level of every other user's home folder while restricting access only to the Apple default folders within.",
        "solution": "Configure the macOS system to set the appropriate permissions for each user on the system with the following command:\n\nIFS=$'\\n'\nfor userDirs in $( /usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \\( -perm 700 -o -perm 711 \\) | /usr/bin/grep -v \"Shared\" | /usr/bin/grep -v \"Guest\" ); do\n  /bin/chmod og-rwx \"$userDirs\"\ndone\nunset IFS",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259514r941164_rule,STIG-ID|APPL-14-002068,SWIFT-CSCv1|2.3,Vuln-ID|V-259514",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \\\\( -perm 700 -o -perm 711 \\\\) | /usr/bin/grep -v \"Shared\" | /usr/bin/grep -v \"Guest\" | /usr/bin/wc -l | /usr/bin/xargs",
        "expect": "^0$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_114": {
        "description": "APPL-14-002069 - The macOS system must require administrator privileges to modify systemwide settings.",
        "info": "The system must be configured to require an administrator password in order to modify the systemwide preferences in System Settings.\n\nSome Preference Panes in System Settings contain settings that affect the entire system. Requiring a password to unlock these systemwide settings reduces the risk of a nonauthorized user modifying system configurations.",
        "solution": "Configure the macOS system to require administrator privileges to modify systemwide settings with the following command:\n\nauthDBs=(\"system.preferences\" \"system.preferences.energysaver\" \"system.preferences.network\" \"system.preferences.printing\" \"system.preferences.sharing\" \"system.preferences.softwareupdate\" \"system.preferences.startupdisk\" \"system.preferences.timemachine\")\n\nfor section in ${authDBs[@]}; do\n/usr/bin/security -q authorizationdb read \"$section\" > \"/tmp/$section.plist\"\nkey_value=$(/usr/libexec/PlistBuddy -c \"Print :shared\" \"/tmp/$section.plist\" 2>&1)\nif [[ \"$key_value\" == *\"Does Not Exist\"* ]]; then\n  /usr/libexec/PlistBuddy -c \"Add :shared bool false\" \"/tmp/$section.plist\"\nelse\n  /usr/libexec/PlistBuddy -c \"Set :shared false\" \"/tmp/$section.plist\"\nfi\n  /usr/bin/security -q authorizationdb write \"$section\" < \"/tmp/$section.plist\"\ndone",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CAT|I,CCI|CCI-002235,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-259515r941167_rule,STIG-ID|APPL-14-002069,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-259515",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "#!/bin/bash\n{\nauthDBs=(\"system.preferences\" \"system.preferences.energysaver\" \"system.preferences.network\" \"system.preferences.printing\" \"system.preferences.sharing\" \"system.preferences.softwareupdate\" \"system.preferences.startupdisk\" \"system.preferences.timemachine\")\nresult=\"1\"\nfor section in ${authDBs[@]}; do\n  if [[ $(/usr/bin/security -q authorizationdb read \"$section\" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), \"shared\")]/following-sibling::*[1])' -) != \"false\" ]]; then\n    result=\"0\"\n  fi\ndone\necho $result\n}",
        "expect": "^1$"
    },
    "custom_item_115": {
        "description": "APPL-14-002080 - The macOS system must disable Airplay Receiver.",
        "info": "Airplay Receiver allows users to send content from another Apple device to be displayed on the screen as it is being played from another device.\n\nSupport for Airplay Receiver is nonessential and must be disabled.\n\nThe information system must be configured to provide only essential capabilities.\n\nSatisfies: SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118",
        "solution": "Configure the macOS system to disable Airplay Receiver by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.1.17,800-171|3.4.6,800-171|3.4.7,800-53|AC-18(1),800-53|CM-7a.,800-53r5|AC-18(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CCI|CCI-001443,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18(1),ITSG-33|CM-7a.,NESA|T5.4.2,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,Rule-ID|SV-259516r941170_rule,STIG-ID|APPL-14-002080,SWIFT-CSCv1|2.3,Vuln-ID|V-259516",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowAirPlayIncomingRequests",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_116": {
        "description": "APPL-14-002090 - The macOS system must disable TouchID for unlocking the device.",
        "info": "TouchID enables the ability to unlock a macOS system with a user's fingerprint.\n\nTouchID must be disabled for \"Unlocking your Mac\" on all macOS devices that are capable of using TouchID.\n\nThe system must remain locked until the user establishes access using an authorized identification and authentication method.",
        "solution": "Configure the macOS system to disable TouchID for unlocking the device by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-259517r941173_rule,STIG-ID|APPL-14-002090,Vuln-ID|V-259517",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowFingerprintForUnlock",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_117": {
        "description": "legacySharingUIStatus",
        "expect": "^0$",
        "payload_key": "legacySharingUIStatus",
        "payload_type": "com.apple.preferences.sharing.SharingPrefsExtension"
    },
    "custom_item_118": {
        "description": "mediaSharingUIStatus",
        "expect": "^0$",
        "payload_key": "mediaSharingUIStatus",
        "payload_type": "com.apple.preferences.sharing.SharingPrefsExtension"
    },
    "custom_item_119": {
        "description": "homeSharingUIStatus",
        "expect": "^0$",
        "payload_key": "homeSharingUIStatus",
        "payload_type": "com.apple.preferences.sharing.SharingPrefsExtension"
    },
    "custom_item_120": {
        "description": "APPL-14-002110 - The macOS system must disable Bluetooth sharing.",
        "info": "Bluetooth Sharing must be disabled.\n\nBluetooth Sharing allows users to wirelessly transmit files between the macOS and Bluetooth-enabled devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files via Bluetooth Sharing. When Bluetooth Sharing is disabled, this risk is mitigated.\n\n[NOTE]\n====\nThe check and fix are for the currently logged on user. To get the currently logged on user, run the following.\n[source,bash]\n----\nCURRENT_USER=$( /usr/sbin/scutil <<< \"show State:/Users/ConsoleUser\" | /usr/bin/awk '/Name :/ && ! /loginwindow/ { print $3 }' )\n----\n====\n\nSatisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049",
        "solution": "Configure the macOS system to disable Bluetooth sharing with the following command:\n\n/usr/bin/sudo -u \"$CURRENT_USER\" /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false",
        "reference": "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|CM-7a.,800-53r5|AC-3,800-53r5|CM-7a.,CAT|II,CCI|CCI-000213,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259519r941179_rule,STIG-ID|APPL-14-002110,SWIFT-CSCv1|2.3,TBA-FIISB|31.1,Vuln-ID|V-259519",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "regex": "0$",
        "plist_item": "PrefKeyServicesEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_121": {
        "description": "APPL-14-002120 - The macOS system must disable AppleID and Internet Account modifications.",
        "info": "The system must disable account modification.\n\nAccount modification includes adding additional or modifying internet accounts in Apple Mail, Calendar, Contacts, in the Internet Account System Setting Pane, or the AppleID System Setting Pane.\n\nThis prevents the addition of unauthorized accounts.\n\n[IMPORTANT]\n====\nSome organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information system security officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.\n====",
        "solution": "Configure the macOS system to disable account modification by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259520r941182_rule,STIG-ID|APPL-14-002120,SWIFT-CSCv1|2.3,Vuln-ID|V-259520",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowAccountModification",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_122": {
        "description": "APPL-14-002130 - The macOS system must disable CD/DVD Sharing.",
        "info": "CD/DVD Sharing must be disabled.",
        "solution": "Configure the macOS system to disable CD/DVD Sharing with the following command:\n\n/bin/launchctl unload /System/Library/LaunchDaemons/com.apple.ODSAgent.plist",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259521r941185_rule,STIG-ID|APPL-14-002130,SWIFT-CSCv1|2.3,Vuln-ID|V-259521",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pgrep -q ODSAgent; /bin/echo $?",
        "expect": "^1$"
    },
    "custom_item_123": {
        "description": "APPL-14-002140 - The macOS system must disable content caching service.",
        "info": "Content caching must be disabled.\n\nContent caching is a macOS service that helps reduce internet data usage and speed up software installation on Mac computers. It is not recommended for devices furnished to employees to act as a caching server.",
        "solution": "Configure the macOS system to disable content caching service by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259522r941188_rule,STIG-ID|APPL-14-002140,SWIFT-CSCv1|2.3,Vuln-ID|V-259522",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowContentCaching",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_124": {
        "description": "APPL-14-002150 - The macOS system must disable iCloud desktop and document folder synchronization.",
        "info": "The macOS system's ability to automatically synchronize a user's desktop and documents folder to their iCloud Drive must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated file synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud desktop and document folder synchronization by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259523r941191_rule,STIG-ID|APPL-14-002150,SWIFT-CSCv1|2.3,Vuln-ID|V-259523",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudDesktopAndDocuments",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_125": {
        "description": "APPL-14-002160 - The macOS system must disable iCloud Game Center.",
        "info": "This works only with supervised devices (MDM) and allows Apple Game Center to be disabled. The rationale is Game Center is using Apple ID and will share data on AppleID-based services; therefore, Game Center must be disabled. This setting also prohibits the functionality of adding friends to Game Center.",
        "solution": "Configure the macOS system to disable iCloud Game Center by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259524r941194_rule,STIG-ID|APPL-14-002160,SWIFT-CSCv1|2.3,Vuln-ID|V-259524",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowGameCenter",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_126": {
        "description": "APPL-14-002170 - The macOS system must disable iCloud Private Relay.",
        "info": "Enterprise networks may be required to audit all network traffic by policy; therefore, iCloud Private Relay must be disabled.\n\nNetwork administrators can also prevent the use of this feature by blocking DNS resolution of mask.icloud.com and mask-h2.icloud.com.",
        "solution": "Configure the macOS system to disable the iCloud Private Relay by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259525r941197_rule,STIG-ID|APPL-14-002170,SWIFT-CSCv1|2.3,Vuln-ID|V-259525",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudPrivateRelay",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_127": {
        "description": "DisableFMMiCloudSetting",
        "expect": "true",
        "payload_key": "DisableFMMiCloudSetting",
        "payload_type": "com.apple.icloud.managed"
    },
    "custom_item_128": {
        "description": "allowFindMyDevice",
        "expect": "false",
        "payload_key": "allowFindMyDevice",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_129": {
        "description": "allowFindMyFriends",
        "expect": "false",
        "payload_key": "allowFindMyFriends",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_130": {
        "description": "APPL-14-002190 - The macOS system must disable password autofill.",
        "info": "Password Autofill must be disabled.\n\nmacOS allows users to save passwords and use the Password Autofill feature in Safari and compatible apps. To protect against malicious users gaining access to the system, this feature must be disabled to prevent users from being prompted to save passwords in applications.",
        "solution": "Configure the macOS system to disable password autofill by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259527r941203_rule,STIG-ID|APPL-14-002190,SWIFT-CSCv1|2.3,Vuln-ID|V-259527",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowPasswordAutoFill",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_131": {
        "description": "APPL-14-002200 - The macOS system must disable personalized advertising.",
        "info": "Ad tracking and targeted ads must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling ad tracking ensures that applications and advertisers are unable to track users' interests and deliver targeted advertisements.",
        "solution": "Configure the macOS system to disable personalized advertising by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259528r941206_rule,STIG-ID|APPL-14-002200,SWIFT-CSCv1|2.3,Vuln-ID|V-259528",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowApplePersonalizedAdvertising",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_132": {
        "description": "APPL-14-002210 - The macOS system must disable sending Siri and Dictation information to Apple.",
        "info": "The ability for Apple to store and review audio of Siri and Dictation interactions must be disabled.\n\nThe information system must be configured to provide only essential capabilities. Disabling the submission of Siri and Dictation information will mitigate the risk of unwanted data being sent to Apple.",
        "solution": "Configure the macOS system to disable sending Siri and Dictation information to Apple by installing the \"com.apple.assistant.support\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259529r941209_rule,STIG-ID|APPL-14-002210,SWIFT-CSCv1|2.3,Vuln-ID|V-259529",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^2$",
        "payload_key": "Siri Data Sharing Opt-In Status",
        "payload_type": "com.apple.assistant.support"
    },
    "custom_item_133": {
        "description": "Intel",
        "cmd": "/usr/sbin/sysctl -n machdep.cpu.brand_string",
        "expect": "Intel"
    },
    "custom_item_134": {
        "description": "APPL-14-002220 - The macOS system must enforce on device dictation.",
        "info": "Dictation must be restricted to on device only to prevent potential data exfiltration.\n\nThe information system must be configured to provide only essential capabilities.",
        "solution": "Configure the macOS system to enforce on device dictation by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259530r941212_rule,STIG-ID|APPL-14-002220,SWIFT-CSCv1|2.3,Vuln-ID|V-259530",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "forceOnDeviceOnlyDictation",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_135": {
        "description": "Apple",
        "cmd": "/usr/sbin/sysctl -n machdep.cpu.brand_string",
        "expect": "Apple"
    },
    "custom_item_136": {
        "description": "APPL-14-002230 - The macOS system must disable dictation.",
        "info": "Dictation must be disabled on Intel-based Macs as the feature On Device Dictation is only available on Apple Silicon devices.",
        "solution": "Configure the macOS system to disable dictation by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259531r941215_rule,STIG-ID|APPL-14-002230,SWIFT-CSCv1|2.3,Vuln-ID|V-259531",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowDictation",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_137": {
        "description": "APPL-14-002240 - The macOS system must disable Printer Sharing.",
        "info": "Printer Sharing must be disabled.",
        "solution": "Configure the macOS system to disable Printer Sharing with the following commands:\n\n/usr/sbin/cupsctl --no-share-printers\n/usr/bin/lpstat -p | awk '{print $2}'| /usr/bin/xargs -I{} lpadmin -p {} -o printer-is-shared=false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259532r941218_rule,STIG-ID|APPL-14-002240,SWIFT-CSCv1|2.3,Vuln-ID|V-259532",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/cupsctl | /usr/bin/grep -c \"_share_printers=0\"",
        "expect": "^1$"
    },
    "custom_item_138": {
        "description": "APPL-14-002250 - The macOS system must disable Remote Management.",
        "info": "Remote Management must be disabled.",
        "solution": "Configure the macOS system to disable Remote Management with the following commands:\n\n/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259533r941221_rule,STIG-ID|APPL-14-002250,SWIFT-CSCv1|2.3,Vuln-ID|V-259533",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c \"RemoteDesktopEnabled = 0\"",
        "expect": "^1$"
    },
    "custom_item_139": {
        "description": "APPL-14-002260 - The macOS system must disable the Bluetooth system settings pane.",
        "info": "The Bluetooth System Setting pane must be disabled to prevent access to the Bluetooth configuration.",
        "solution": "Configure the macOS system to disable the Bluetooth system settings pane by installing the \"com.apple.systempreferences\" configuration profiles.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259534r941224_rule,STIG-ID|APPL-14-002260,SWIFT-CSCv1|2.3,Vuln-ID|V-259534",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()=\"DisabledSystemSettings\"]/following-sibling::*[1]' - | /usr/bin/grep -c com.apple.BluetoothSettings",
        "expect": "^1$"
    },
    "custom_item_140": {
        "description": "APPL-14-002270 - The macOS system must disable the iCloud Freeform services.",
        "info": "The macOS built-in Freeform.app connection to Apple's iCloud service must be disabled.\n\nApple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization must be controlled by an organization approved service.",
        "solution": "Configure the macOS system to disable iCloud Freeform services by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259535r941227_rule,STIG-ID|APPL-14-002270,SWIFT-CSCv1|2.3,Vuln-ID|V-259535",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowCloudFreeform",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_141": {
        "description": "APPL-14-003001 - The macOS system must issue or obtain public key certificates from an approved service provider.",
        "info": "The organization must issue or obtain public key certificates from an organization-approved service provider and ensure only approved trust anchors are in the System Keychain.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the macOS system to issue or obtain public key certificates from an approved service provider by obtaining the approved certificates from the appropriate authority and install them to the System Keychain.",
        "reference": "800-171|3.13.15,800-53|SC-23(5),800-53r5|SC-23(5),CAT|II,CCI|CCI-002470,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-259536r941230_rule,STIG-ID|APPL-14-003001,Vuln-ID|V-259536",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/security dump-keychain /Library/Keychains/System.keychain | /usr/bin/awk -F'\"' '/labl/ {print $4}'",
        "expect": "^Manual Review Required$"
    },
    "custom_item_142": {
        "description": "APPL-14-003007 - The macOS system must require passwords contain a minimum of one numeric character.",
        "info": "The macOS must be configured to require at least one numeric character be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to require passwords contain a minimum of one numeric character by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259537r941233_rule,STIG-ID|APPL-14-003007,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-259537",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyIdentifier\"]/following-sibling::*[1]/text()' - | /usr/bin/grep \"requireAlphanumeric\" -c | /usr/bin/awk '{print} END {if ($1 > 0) { print \"true\"} else { print \"false\"}}' ",
        "expect": "^@REQUIRE_ALPHANUMERIC@$"
    },
    "custom_item_143": {
        "description": "APPL-14-003008 - The macOS system must restrict maximum password lifetime to 60 days.",
        "info": "The macOS must be configured to enforce a maximum password lifetime limit of at least 60 days.\n\nThis rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to restrict maximum password lifetime to 60 days by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-000199,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259538r941236_rule,STIG-ID|APPL-14-003008,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-259538",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyAttributeExpiresEveryNDays\"]/following-sibling::*[1]/text()' -",
        "expect": "^@MAXIMUM_PASSWORD_LIFETIME@$"
    },
    "custom_item_144": {
        "description": "APPL-14-003009 - The macOS system must prohibit password reuse for a minimum of five generations.",
        "info": "The macOS must be configured to enforce a password history of at least five previous passwords when a password is created.\n\nThis rule ensures that users are not allowed to reuse a password that was used in any of the five previous password generations.\n\nLimiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to prohibit password reuse for five generations by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CAT|II,CCI|CCI-000200,CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259539r941239_rule,STIG-ID|APPL-14-003009,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-259539",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyAttributePasswordHistoryDepth\"]/following-sibling::*[1]/text()' -",
        "expect": "^@MINIMUM_PASSWORD_HISTORY@$"
    },
    "custom_item_145": {
        "description": "APPL-14-003010 - The macOS system must require a minimum password length of 14 characters.",
        "info": "The macOS must be configured to require a minimum of 14 characters be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to enforce a 14-character password length by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259540r941242_rule,STIG-ID|APPL-14-003010,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-259540",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/grep \"policyAttributePassword matches \"",
        "expect": "policyAttributePassword matches '\\{@MINIMUM_PASSWORD_LENGTH@,\\}'"
    },
    "custom_item_146": {
        "description": "APPL-14-003011 - The macOS system must require passwords contain a minimum of one special character.",
        "info": "The macOS must be configured to require at least one special character be used when a password is created.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to require passwords contain a minimum of one special character by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259541r941245_rule,STIG-ID|APPL-14-003011,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-259541",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/grep \"policyAttributePassword matches \"",
        "expect": "policyAttributePassword matches '\\(\\.\\*\\[^a-zA-Z0-9\\]\\.\\*\\)\\{@MINIMUM_COMPLEX_CHAR@,\\}'"
    },
    "custom_item_147": {
        "description": "APPL-14-003012 - The macOS system must disable password hints.",
        "info": "Password hints must be disabled.\n\nPassword hints leak information about passwords that are currently in use and can lead to loss of confidentiality.",
        "solution": "Configure the macOS system to disable password hints by installing the \"com.apple.loginwindow\" configuration profile.",
        "reference": "800-171|3.5.11,800-53|IA-6,800-53r5|IA-6,CAT|II,CCI|CCI-000206,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-6,ITSG-33|IA-6a.,NESA|T5.5.1,QCSC-v1|13.2,Rule-ID|SV-259542r941248_rule,STIG-ID|APPL-14-003012,Vuln-ID|V-259542",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "^0$",
        "payload_key": "RetriesUntilHint",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_148": {
        "description": "Intel",
        "cmd": "/usr/sbin/sysctl -n machdep.cpu.brand_string",
        "expect": "Intel"
    },
    "custom_item_149": {
        "description": "APPL-14-003013 - The macOS system must enable firmware password.",
        "info": "A firmware password must be enabled and set.\n\nSingle user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding the \"Option\" key down during startup. Setting a firmware password restricts access to these tools.\n\nTo set a firmware passcode use the following command:\n\n[source,bash]\n----\n/usr/sbin/firmwarepasswd -setpasswd\n----\n\nNote: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through the use of a machine specific binary generated and provided by Apple. Schedule a support call and provide proof of purchase before the firmware binary will be generated.\n\nNote: Firmware passwords are not supported on Apple Silicon devices. This rule is only applicable to Intel devices.",
        "solution": "Configure the macOS system with a firmware password with the following command:\n\n/usr/sbin/firmwarepasswd -setpasswd\n\nNote: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through a machine-specific binary generated and provided by Apple. Users must schedule a support call and provide proof of purchase before the firmware binary will be generated.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259543r941251_rule,STIG-ID|APPL-14-003013,SWIFT-CSCv1|2.3,Vuln-ID|V-259543",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/firmwarepasswd -check | /usr/bin/grep -c \"Password Enabled: Yes\"",
        "expect": "^1$"
    },
    "custom_item_150": {
        "description": "APPL-14-003014 - The macOS system must remove password hints from user accounts.",
        "info": "User accounts must not contain password hints. Password hints leak information about passwords that are currently in use and can lead to loss of confidentiality.",
        "solution": "Configure the macOS system to remove password hints from user accounts with the following command:\n\nfor u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 > 500 {print $1}'); do\n  /usr/bin/dscl . -delete /Users/$u hint\ndone",
        "reference": "800-171|3.5.11,800-53|IA-6,800-53r5|IA-6,CAT|II,CCI|CCI-000206,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-6,ITSG-33|IA-6a.,NESA|T5.5.1,QCSC-v1|13.2,Rule-ID|SV-259544r941254_rule,STIG-ID|APPL-14-003014,Vuln-ID|V-259544",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/dscl . -list /Users hint | /usr/bin/awk '{print $2}' | /usr/bin/wc -l | /usr/bin/xargs",
        "expect": "^0$"
    },
    "custom_item_151": {
        "description": "APPL-14-003020 - The macOS system must enforce smart card authentication.",
        "info": "Smart card authentication must be enforced.\n\nThe use of smart card credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWhen enforceSmartCard is set to \"true\", the smart card must be used for logon, authorization, and unlocking the screensaver.\n\nCAUTION: enforceSmartCard will apply to the whole system. No users will be able to log on with their password unless the profile is removed or a user is exempt from smart card enforcement.\n\nNote: enforceSmartcard requires allowSmartcard to be set to true in order to work.\n\nSatisfies: SRG-OS-000067-GPOS-00035,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000375-GPOS-00160,SRG-OS-000376-GPOS-00161",
        "solution": "Configure the macOS system to enforce multifactor authentication by installing the \"com.apple.security.smartcard\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the configuration profile.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.3,800-171|3.5.4,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53|IA-2(11),800-53|IA-2(12),800-53|IA-5(2)(b),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(6),800-53r5|IA-2(8),800-53r5|IA-2(12),800-53r5|IA-5(2)(b),CAT|II,CCI|CCI-000186,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-001941,CCI|CCI-001948,CCI|CCI-001953,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.1(d),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),ITSG-33|IA-2(100),ITSG-33|IA-5(2)(b),NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,PCI-DSSv3.2.1|8.3,PCI-DSSv3.2.1|8.3.1,PCI-DSSv3.2.1|8.3.2,PCI-DSSv4.0|8.4.1,PCI-DSSv4.0|8.4.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259545r941257_rule,STIG-ID|APPL-14-003020,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259545",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "enforceSmartCard",
        "payload_type": "com.apple.security.smartcard"
    },
    "custom_item_152": {
        "description": "APPL-14-003030 - The macOS system must allow smart card authentication.",
        "info": "Smart card authentication must be allowed.\n\nThe use of smart card credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWhen enabled, the smart card can be used for logon, authorization, and screen saver unlocking.\n\nSatisfies: SRG-OS-000068-GPOS-00036,SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057,SRG-OS-000376-GPOS-00161",
        "solution": "Configure the macOS system to enforce multifactor authentication by installing the \"com.apple.security.smartcard\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the configuration profile.",
        "reference": "800-171|3.5.1,800-171|3.5.2,800-171|3.5.3,800-171|3.5.4,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53|IA-2(12),800-53|IA-5(2)(c),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(8),800-53r5|IA-2(12),800-53r5|IA-5(2)(c),CAT|II,CCI|CCI-000187,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-001941,CCI|CCI-001953,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),ITSG-33|IA-5(2)(c),NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259546r941260_rule,STIG-ID|APPL-14-003030,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259546",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "allowSmartCard",
        "payload_type": "com.apple.security.smartcard"
    },
    "custom_item_153": {
        "description": "APPL-14-003050 - The macOS system must enforce multifactor authentication for logon.",
        "info": "The system must be configured to enforce multifactor authentication.\n\nAll users must go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nIMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.\n\nNote: /etc/pam.d/login will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057",
        "solution": "Configure the macOS system to enforce multifactor authentication for login with the following commands:\n\n/bin/cat > /etc/pam.d/login << LOGIN_END\n# login: auth account password session\nauth sufficient pam_smartcard.so\nauth optional pam_krb5.so use_kcminit\nauth optional pam_ntlm.so try_first_pass\nauth optional pam_mount.so try_first_pass\nauth required pam_opendirectory.so try_first_pass\nauth required pam_deny.so\naccount required pam_nologin.so\naccount required pam_opendirectory.so\npassword required pam_opendirectory.so\nsession required pam_launchd.so\nsession required pam_uwtmp.so\nsession optional pam_mount.so\nLOGIN_END\n\n/bin/chmod 644 /etc/pam.d/login\n/usr/sbin/chown root:wheel /etc/pam.d/login",
        "reference": "800-171|3.5.1,800-171|3.5.3,800-171|3.5.4,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(8),CAT|II,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-001941,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259547r941263_rule,STIG-ID|APPL-14-003050,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259547",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_deny.so)' /etc/pam.d/login",
        "expect": "^2$"
    },
    "custom_item_154": {
        "description": "APPL-14-003051 - The macOS system must enforce multifactor authentication for the su command.",
        "info": "The system must be configured such that, when the su command is used, multifactor authentication is enforced.\n\nAll users must go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nIMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.\n\nNote: /etc/pam.d/su will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057",
        "solution": "Configure the macOS system to enforce multifactor authentication for the su command with the following commands:\n\n/bin/cat > /etc/pam.d/su << SU_END\n# su: auth account password session\nauth sufficient pam_smartcard.so\nauth required pam_rootok.so\nauth required pam_group.so no_warn group=admin,wheel ruser root_only fail_safe\naccount required pam_permit.so\naccount required pam_opendirectory.so no_check_shell\npassword required pam_opendirectory.so\nsession required pam_launchd.so\nSU_END\n\n# Fix new file ownership and permissions\n/bin/chmod 644 /etc/pam.d/su\n/usr/sbin/chown root:wheel /etc/pam.d/su",
        "reference": "800-171|3.5.1,800-171|3.5.3,800-171|3.5.4,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(8),CAT|II,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-001941,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259548r941266_rule,STIG-ID|APPL-14-003051,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259548",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_rootok.so)' /etc/pam.d/su",
        "expect": "^2$"
    },
    "custom_item_155": {
        "description": "APPL-14-003052 - The macOS system must enforce multifactor authentication for privilege escalation through the sudo command.",
        "info": "The system must be configured to enforce multifactor authentication when the sudo command is used to elevate privilege.\n\nAll users must go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.\n\nIMPORTANT: Modification of Pluggable Authentication Modules (PAM) now requires user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.\n\nNote: /etc/pam.d/sudo will be automatically modified to its original state following any update or major upgrade to the operating system.\n\nSatisfies: SRG-OS-000105-GPOS-00052,SRG-OS-000106-GPOS-00053,SRG-OS-000107-GPOS-00054,SRG-OS-000108-GPOS-00055,SRG-OS-000112-GPOS-00057",
        "solution": "Configure the macOS system to enforce multifactor authentication for privilege escalation through the sudo command with the following commands:\n\n/bin/cat > /etc/pam.d/sudo << SUDO_END\n# sudo: auth account password session\nauth sufficient pam_smartcard.so\nauth required pam_opendirectory.so\nauth required pam_deny.so\naccount required pam_permit.so\npassword required pam_deny.so\nsession required pam_permit.so\nSUDO_END\n\n/bin/chmod 444 /etc/pam.d/sudo\n/usr/sbin/chown root:wheel /etc/pam.d/sudo",
        "reference": "800-171|3.5.1,800-171|3.5.3,800-171|3.5.4,800-53|IA-2(1),800-53|IA-2(2),800-53|IA-2(3),800-53|IA-2(4),800-53|IA-2(8),800-53r5|IA-2(1),800-53r5|IA-2(2),800-53r5|IA-2(8),CAT|II,CCI|CCI-000765,CCI|CCI-000766,CCI|CCI-000767,CCI|CCI-000768,CCI|CCI-001941,CN-L3|7.1.2.7(b),CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|IA-2(2),ITSG-33|IA-2(3),ITSG-33|IA-2(4),ITSG-33|IA-2(8),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,NIAv2|AM18,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259549r941269_rule,STIG-ID|APPL-14-003052,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259549",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/grep -Ec '^(auth\\\\s+sufficient\\\\s+pam_smartcard.so|auth\\\\s+required\\\\s+pam_deny.so)' /etc/pam.d/sudo",
        "expect": "^2$"
    },
    "custom_item_156": {
        "description": "APPL-14-003060 - The macOS system must require passwords contain a minimum of one lowercase character and one uppercase character.",
        "info": "The macOS be configured to require at least one lowercase character and one uppercase character be used when a password is created.\n\nThis rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.\n\nNote: The configuration profile generated must be installed from an MDM server.\n\nSatisfies: SRG-OS-000069-GPOS-00037,SRG-OS-000070-GPOS-00038",
        "solution": "Configure the macOS system to require at least one lowercase character and one uppercase character in password complexity by installing the \"com.apple.mobiledevice.passwordpolicy\" configuration profile.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000192,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259550r941272_rule,STIG-ID|APPL-14-003060,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-259550",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/grep policyAttributePassword",
        "expect": "policyAttributePassword matches '@PASSWORD_CONSTRAINTS@'"
    },
    "custom_item_157": {
        "description": "APPL-14-003070 - The macOS system must set minimum password lifetime to 24 hours.",
        "info": "The macOS must be configured to enforce a minimum password lifetime limit of 24 hours.\n\nThis rule discourages users from cycling through their previous passwords to get back to a preferred one.\n\nNote: The guidance for password-based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based on common complexity values, but an organization may define its own password complexity rules.",
        "solution": "Configure the macOS system to set minimum password lifetime to 24 hours.\n\nThis setting may be enforced using local policy or by a directory service.\n\nTo set local policy to require a minimum password lifetime, edit the current password policy to contain the followingwithin the \"policyCategoryPasswordContent\":\n\n[source,xml]\n----policyContentpolicyAttributeLastPasswordChangeTime < policyAttributeCurrentTime - (policyAttributeMinimumLifetimeHours * 60 * 60)policyIdentifierMinimum Password LifetimepolicyParameterspolicyAttributeMinimumLifetimeHours24----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNote: Refer to the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-000198,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259551r941275_rule,STIG-ID|APPL-14-003070,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-259551",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyAttributeMinimumLifetimeHours\"]/following-sibling::integer[1]/text()' -",
        "expect": "^@MINIMUM_PASSWORD_LIFETIME@$"
    },
    "custom_item_158": {
        "description": "APPL-14-003080 - The macOS system must disable accounts after 35 days of inactivity.",
        "info": "The macOS must be configured to disable accounts after 35 days of inactivity.\n\nThis rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.",
        "solution": "Configure the macOS system to disable accounts after 35 days of inactivity with the following command:\n\nThis setting may be enforced using local policy or by a directory service.\n\nTo set local policy to disable an inactive user after 35 days, edit the current password policy to contain the followingwithin the \"policyCategoryAuthentication\":\n\n[source,xml]\n----policyContentpolicyAttributeLastAuthenticationTime > policyAttributeCurrentTime - (policyAttributeInactiveDays * 24 * 60 * 60)policyIdentifierInactive AccountpolicyParameterspolicyAttributeInactiveDays35----\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of \"$pwpolicy_file\".\n\n[source,bash]\n----\n/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file\n----\nNote: Refer to the password policy supplemental on more information on how to implement password policies on macOS.",
        "reference": "800-171|3.5.5,800-171|3.5.6,800-53|IA-4e.,800-53r5|IA-4e.,CAT|II,CCI|CCI-000795,CN-L3|7.1.2.7(b),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-4e.,PCI-DSSv3.2.1|8.1.4,PCI-DSSv4.0|8.2.6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259552r941278_rule,STIG-ID|APPL-14-003080,SWIFT-CSCv1|5,Vuln-ID|V-259552",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()=\"policyAttributeInactiveDays\"]/following-sibling::integer[1]/text()' -",
        "expect": "^@PASSWORD_INACTIVITY@$"
    },
    "custom_item_159": {
        "description": "APPL-14-004001 - The macOS system must configure Apple System Log files to be owned by root and group to wheel.",
        "info": "The Apple System Logs (ASL) must be owned by root.\n\nASL logs contain sensitive data about the system and users. If ASL log files are set to only be readable and writable by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084",
        "solution": "Configure the macOS system with Apple System Log files owned by root and group to wheel with the following command:\n\n/usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/awk -F\":\" '!/^root:wheel:/{print $3}')",
        "reference": "800-53|SI-11a.,800-53|SI-11b.,800-53r5|SI-11a.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001312,CCI|CCI-001314,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,ITSG-33|SI-11c.,Rule-ID|SV-259553r941281_rule,STIG-ID|APPL-14-004001,Vuln-ID|V-259553",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ''",
        "expect": "^0$"
    },
    "custom_item_160": {
        "description": "APPL-14-004002 - The macOS system must configure Apple System Log files to mode 640 or less permissive.",
        "info": "The Apple System Logs (ASL) must be configured to be writable by root and readable only by the root user and group wheel. To achieve this, ASL log files must be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying, or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.\n\nSatisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084",
        "solution": "Configure the macOS system with Apple System Log files to mode 640 with the following command:\n\n/bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk -F\":\" '!/640/{print $2}')",
        "reference": "800-53|SI-11a.,800-53|SI-11b.,800-53r5|SI-11a.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001312,CCI|CCI-001314,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,ITSG-33|SI-11c.,Rule-ID|SV-259554r941284_rule,STIG-ID|APPL-14-004002,Vuln-ID|V-259554",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '",
        "expect": "^0$"
    },
    "custom_item_161": {
        "description": "APPL-14-004022 - The macOS system must require users to reauthenticate for privilege escalation when using the \"sudo\" command.",
        "info": "The file /etc/sudoers must include a timestamp_timout of 0.\n\nWithout reauthentication, users may access resources or perform tasks for which they do not have authorization. When operating systems provide the capability to escalate a functional capability or change user authenticators, it is critical the user reauthenticate.\n\nSatisfies: SRG-OS-000373-GPOS-00156,SRG-OS-000373-GPOS-00157,SRG-OS-000373-GPOS-00158",
        "solution": "Configure the macOS system to require reauthentication when using \"sudo\" with the following command:\n\n/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \\;\n/bin/echo \"Defaults timestamp_timeout=0\" >> /etc/sudoers.d/mscp",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-259555r941287_rule,STIG-ID|APPL-14-004022,Vuln-ID|V-259555",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/sudo -V | /usr/bin/grep -c \"Authentication timestamp timeout: 0.0 minutes\"",
        "expect": "^1$"
    },
    "custom_item_162": {
        "description": "APPL-14-004030 - The macOS system must configure system log files to be owned by root and group to wheel.",
        "info": "The system log files must be owned by root.\n\nSystem logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.\n\nSatisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084",
        "solution": "Configure the macOS system with system log files owned by root and group to wheel with the following command:\n\n/usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null | /usr/bin/awk -F\":\" '!/^root:wheel:/{print $3}')",
        "reference": "800-53|SI-11a.,800-53|SI-11b.,800-53r5|SI-11a.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001312,CCI|CCI-001314,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,ITSG-33|SI-11c.,Rule-ID|SV-259556r941290_rule,STIG-ID|APPL-14-004030,Vuln-ID|V-259556",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '",
        "expect": "^0$"
    },
    "custom_item_163": {
        "description": "APPL-14-004040 - The macOS system must configure system log files to mode 640 or less permissive.",
        "info": "The system logs must be configured to be writable by root and readable only by the root user and group wheel. To achieve this, system log files must be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying, or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.\n\nSatisfies: SRG-OS-000205-GPOS-00083,SRG-OS-000206-GPOS-00084",
        "solution": "Configure the macOS system with system log files set to mode 640 or less permissive with the following command:\n\n/bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null | /usr/bin/awk '!/640/{print $1}' | awk -F\":\" '!/640/{print $2}')",
        "reference": "800-53|SI-11a.,800-53|SI-11b.,800-53r5|SI-11a.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001312,CCI|CCI-001314,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,ITSG-33|SI-11c.,Rule-ID|SV-259557r941293_rule,STIG-ID|APPL-14-004040,Vuln-ID|V-259557",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '",
        "expect": "^0$"
    },
    "custom_item_164": {
        "description": "APPL-14-004050 - The macOS system must configure install.log retention to 365.",
        "info": "The install.log must be configured to require records be kept for an organizational-defined value before deletion, unless the system uses a central audit record storage facility.",
        "solution": "Configure the macOS system with install.log retention to 365 with the following command:\n\n/usr/bin/sed -i '' \"s/\\* file \\/var\\/log\\/install.log.*/\\* file \\/var\\/log\\/install.log format='\\$\\(\\(Time\\)\\(JZ\\)\\) \\$Host \\$\\(Sender\\)\\[\\$\\(PID\\\\)\\]: \\$Message' rotate=utc compress file_max=50M size_only ttl=365/g\" /etc/asl/com.apple.install\n\nNote: If there are multiple configuration files in /etc/asl that are set to process the file /var/log/install.log, these files will have to be manually removed.",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|III,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-259558r941296_rule,STIG-ID|APPL-14-004050,Vuln-ID|V-259558",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/sbin/aslmanager -dd 2>&1 | /usr/bin/awk '/\\\\/var\\\\/log\\\\/install.log/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i<=NR;i++) { if ($i == \"TTL\" && $(i+2) >= 365) { ttl=\"True\" }; if ($i == \"MAX\") {max=\"True\"}}} END{if (count > 1) { print \"Multiple config files for /var/log/install, manually remove\"} else if (ttl != \"True\") { print \"TTL not configured\" } else if (max == \"True\") { print \"Max Size is configured, must be removed\" } else { print \"Yes\" }}'",
        "expect": "^Yes$"
    },
    "custom_item_165": {
        "description": "APPL-14-004060 - The macOS system must configure sudoers timestamp type.",
        "info": "The file /etc/sudoers must be configured to not include a timestamp_type of global or ppid and be configured for timestamp record types of tty.\n\nThis rule ensures that the \"sudo\" command will prompt for the administrator's password at least once in each newly opened terminal window. This prevents a malicious user from taking advantage of an unlocked computer or an abandoned logon session by bypassing the normal password prompt requirement.\n\nSatisfies: SRG-OS-000373-GPOS-00156,SRG-OS-000373-GPOS-00157",
        "solution": "Configure the macOS system with sudoers timestamp type with the following command:\n\n/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_type/d; /!tty_tickets/d' '{}' \\;",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-259559r941299_rule,STIG-ID|APPL-14-004060,Vuln-ID|V-259559",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/sudo -V | /usr/bin/awk -F\": \" '/Type of authentication timestamp record/{print $2}'",
        "expect": "^tty$"
    },
    "custom_item_166": {
        "description": "/etc/security/audit_warn",
        "cmd": "/usr/bin/grep -c \"logger -s -p\" /etc/security/audit_warn",
        "expect": "^1$"
    },
    "custom_item_167": {
        "description": "csrutil",
        "cmd": "/usr/bin/csrutil status | /usr/bin/grep -c 'System Integrity Protection status: enabled.'",
        "expect": "^1$"
    },
    "custom_item_168": {
        "description": "dontAllowFDEDisable",
        "expect": "true",
        "payload_key": "dontAllowFDEDisable",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_169": {
        "description": "fdesetup",
        "cmd": "/usr/bin/fdesetup status | /usr/bin/grep -c \"FileVault is On.\"",
        "expect": "^1$"
    },
    "custom_item_170": {
        "description": "globalstate",
        "regex": "^[12]$",
        "plist_item": "globalstate",
        "plist_name": "/Library/Preferences/com.apple.alf"
    },
    "custom_item_171": {
        "description": "EnableFirewall",
        "expect": "true",
        "payload_key": "EnableFirewall",
        "payload_type": "com.apple.security.firewall"
    },
    "custom_item_172": {
        "description": "APPL-14-005052 - The macOS system must configure login window to prompt for username and password.",
        "info": "The login window must be configured to prompt all users for both a username and a password.\n\nBy default, the system displays a list of known users on the login window, which can make it easier for a malicious user to gain access to someone else's account. Requiring users to type in both their username and password mitigates the risk of unauthorized users gaining access to the information system.",
        "solution": "Configure the macOS system to prompt for username and password at the logon window by installing the \"com.apple.loginwindow\" configuration profile.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259563r941311_rule,STIG-ID|APPL-14-005052,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-259563",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SHOWFULLNAME",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_173": {
        "description": "APPL-14-005054 - The macOS system must disable TouchID prompt during Setup Assistant.",
        "info": "The prompt for TouchID during Setup Assistant must be disabled.\n\nmacOS prompts new users through enabling TouchID during Setup Assistant; this is not essential, and therefore must be disabled to prevent against the risk of individuals electing to enable TouchID to override organizationwide settings.",
        "solution": "Configure the macOS system to disable TouchID prompt during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259564r941314_rule,STIG-ID|APPL-14-005054,SWIFT-CSCv1|2.3,Vuln-ID|V-259564",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipTouchIDSetup",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_174": {
        "description": "APPL-14-005055 - The macOS system must disable Screen Time prompt during Setup Assistant.",
        "info": "The prompt for Screen Time setup during Setup Assistant must be disabled.",
        "solution": "Configure the macOS system to disable Screen Time prompt during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259565r941317_rule,STIG-ID|APPL-14-005055,SWIFT-CSCv1|2.3,Vuln-ID|V-259565",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipScreenTime",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_175": {
        "description": "APPL-14-005056 - The macOS system must disable Unlock with Apple Watch during Setup Assistant.",
        "info": "The prompt for Apple Watch unlock setup during Setup Assistant must be disabled.\n\nDisabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using an authorized identification and authentication procedures.",
        "solution": "Configure the macOS system to disable Unlock with Apple Watch during Setup Assistant by installing the \"com.apple.SetupAssistant.managed\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259566r941320_rule,STIG-ID|APPL-14-005056,SWIFT-CSCv1|2.3,Vuln-ID|V-259566",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "SkipUnlockWithWatch",
        "payload_type": "com.apple.SetupAssistant.managed"
    },
    "custom_item_176": {
        "description": "APPL-14-005058 - The macOS system must disable Handoff.",
        "info": "Handoff must be disabled.\n\nHandoff allows users to continue working on a document or project when the user switches from one Apple device to another. Disabling Handoff prevents data transfers to unauthorized devices.\n\nSatisfies: SRG-OS-000080-GPOS-00048,SRG-OS-000095-GPOS-00049,SRG-OS-000300-GPOS-00118",
        "solution": "Configure the macOS system to disable handoff by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.1.1,800-171|3.1.17,800-171|3.4.6,800-171|3.4.7,800-53|AC-3,800-53|AC-18(1),800-53|CM-7a.,800-53r5|AC-3,800-53r5|AC-18(1),800-53r5|CM-7a.,CAT|II,CCI|CCI-000213,CCI|CCI-000381,CCI|CCI-001443,CN-L3|7.1.3.5(c),CN-L3|8.1.4.2(f),CN-L3|8.1.4.4(a),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-18(1),ITSG-33|CM-7a.,NESA|T4.2.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS29,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259567r941323_rule,STIG-ID|APPL-14-005058,SWIFT-CSCv1|2.3,TBA-FIISB|31.1,Vuln-ID|V-259567",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowActivityContinuation",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_177": {
        "description": "APPL-14-005060 - The macOS system must disable proximity-based password sharing requests.",
        "info": "Proximity-based password sharing requests must be disabled.\n\nThe default behavior of macOS is to allow users to request passwords from other known devices (macOS and iOS). This feature must be disabled to prevent passwords from being shared.",
        "solution": "Configure the macOS system to disable proximity-based password sharing requests by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259568r941326_rule,STIG-ID|APPL-14-005060,SWIFT-CSCv1|2.3,Vuln-ID|V-259568",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowPasswordProximityRequests",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_178": {
        "description": "APPL-14-005061 - The macOS system must disable Erase Content and Settings.",
        "info": "Erase Content and Settings must be disabled.",
        "solution": "Configure the macOS system to disable Erase Content and Settings by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-259569r941329_rule,STIG-ID|APPL-14-005061,SWIFT-CSCv1|2.3,Vuln-ID|V-259569",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "false",
        "payload_key": "allowEraseContentAndSettings",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_179": {
        "description": "APPL-14-005070 - The macOS system must enable Authenticated Root.",
        "info": "Authenticated Root must be enabled.\n\nWhen Authenticated Root is enabled the macOS is booted from a signed volume that is cryptographically protected to prevent tampering with the system volume.\n\nNote: Authenticated Root is enabled by default on macOS systems.\n\nWARNING: If more than one partition with macOS is detected, the csrutil command will hang awaiting input.",
        "solution": "Configure the macOS system to enable authenticated root with the following command:\n\n/usr/bin/csrutil authenticated-root enable\n\nNote: To reenable \"Authenticated Root\", boot the affected system into \"Recovery\" mode, launch \"Terminal\" from the \"Utilities\" menu, and run the command.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-259570r941332_rule,STIG-ID|APPL-14-005070,TBA-FIISB|31.1,Vuln-ID|V-259570",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/csrutil authenticated-root | /usr/bin/grep -c 'enabled'",
        "expect": "^1$"
    },
    "custom_item_180": {
        "description": "familyControlsEnabled",
        "expect": "true",
        "payload_key": "familyControlsEnabled",
        "payload_type": "com.apple.applicationaccess.new"
    },
    "custom_item_181": {
        "description": "pathBlackList",
        "expect": "/Users/",
        "payload_key": "pathBlackList",
        "payload_type": "com.apple.applicationaccess.new"
    },
    "custom_item_182": {
        "description": "APPL-14-005090 - The macOS system must authorize USB devices before allowing connection.",
        "info": "USB devices connected to a Mac must be authorized.\n\n[IMPORTANT]\n====\nThis feature is removed if a smart card is paired or smart card attribute mapping is configured.\n====",
        "solution": "Configure the macOS system to authorize USB devices before allowing connection by installing the \"com.apple.applicationaccess\" configuration profile.",
        "reference": "800-53|IA-3,800-53r5|IA-3,CAT|II,CCI|CCI-001958,CSF|PR.AC-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,QCSC-v1|13.2,Rule-ID|SV-259572r941338_rule,STIG-ID|APPL-14-005090,TBA-FIISB|27.1,Vuln-ID|V-259572",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "allowUSBRestrictedMode",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_183": {
        "description": "APPL-14-005100 - The macOS system must ensure secure boot level set to full.",
        "info": "The Secure Boot security setting must be set to full.\n\nFull security is the default Secure Boot setting in macOS. During startup, when Secure Boot is set to full security, the Mac will verify the integrity of the operating system before allowing the operating system to boot.\n\nNote: This will only return a proper result on T2 or Apple Silicon Macs.\n\nSatisfies: SRG-OS-000445-GPOS-00199,SRG-OS-000446-GPOS-00200,SRG-OS-000447-GPOS-00201",
        "solution": "Configure the macOS system to ensure secure boot level set to full by booting into Recovery Mode and enable Full Secure Boot.",
        "reference": "800-53|SI-6a.,800-53|SI-6b.,800-53|SI-6d.,800-53r5|SI-6a.,800-53r5|SI-6b.,800-53r5|SI-6d.,CAT|II,CCI|CCI-002696,CCI|CCI-002699,CCI|CCI-002702,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-6a.,Rule-ID|SV-259573r941341_rule,STIG-ID|APPL-14-005100,Vuln-ID|V-259573",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c \"SecureBootLevel = full\"",
        "expect": "^1$"
    },
    "custom_item_184": {
        "description": "APPL-14-005110 - The macOS system must enforce enrollment in mobile device management.",
        "info": "Users must enroll their Mac in a Mobile Device Management (MDM) software.\n\nUser Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager (ASM) is required to manage certain security settings. Currently these include:\n\n* Allowed Kernel Extensions\n* Allowed Approved System Extensions\n* Privacy Preferences Policy Control Payload\n* ExtensibleSingleSignOn\n* FDEFileVault\n\nIn macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were previously locked behind ABM:\n\n* Activation Lock Bypass\n* Access to Bootstrap Tokens\n* Scheduling Software Updates\n* Query list and delete local users",
        "solution": "Configure the macOS system by ensuring that system is enrolled via UAMDM.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259574r941344_rule,STIG-ID|APPL-14-005110,SWIFT-CSCv1|2.3,Vuln-ID|V-259574",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep -c \"Yes (User Approved)\"",
        "expect": "^1$"
    },
    "custom_item_185": {
        "description": "Apple",
        "cmd": "/usr/sbin/sysctl -n machdep.cpu.brand_string",
        "expect": "Apple"
    },
    "custom_item_186": {
        "description": "APPL-14-005120 - The macOS system must enable recovery lock.",
        "info": "A recovery lock password must be enabled and set.\n\nSingle user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding down specific key combinations during startup. Setting a recovery lock restricts access to these tools.\n\nIMPORTANT: Recovery lock passwords are not supported on Intel devices. This rule is only applicable to Apple Silicon devices.",
        "solution": "Configure the macOS system with recovery lock with the SetRecoveryLock command. This can be used to set a Recovery Lock password and must be from the MDM.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259575r941347_rule,STIG-ID|APPL-14-005120,SWIFT-CSCv1|2.3,Vuln-ID|V-259575",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "cmd": "/usr/libexec/mdmclient QuerySecurityInfo | /usr/bin/grep -c \"IsRecoveryLockEnabled = 1\"",
        "expect": "^1$"
    },
    "custom_item_187": {
        "description": "APPL-14-005130 - The macOS system must enforce installation of XProtect Remediator and Gatekeeper updates automatically.",
        "info": "Software Update must be configured to update XProtect Remediator and Gatekeeper automatically.\n\nThis setting enforces definition updates for XProtect Remediator and Gatekeeper; with this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require the computer to be restarted.\n\nhttps://support.apple.com/en-us/HT207005\n\nNote: Software update will automatically update XProtect Remediator and Gatekeeper by default in the macOS.",
        "solution": "Configure the macOS system to enforce installation of XProtect Remediator and Gatekeeper updates automatically by installing the \"com.apple.SoftwareUpdate\" configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_macOS_14_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-259576r941350_rule,STIG-ID|APPL-14-005130,SWIFT-CSCv1|2.3,Vuln-ID|V-259576",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_macOS_14_V1R2_STIG.zip",
        "expect": "true",
        "payload_key": "ConfigDataInstall",
        "payload_type": "com.apple.SoftwareUpdate"
    }
}