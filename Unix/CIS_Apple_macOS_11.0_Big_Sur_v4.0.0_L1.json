{
    "custom_item_1": {
        "description": "MacOS 11 is installed",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_2": {
        "description": "1.1 Ensure All Apple-provided Software Is Current",
        "info": "Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.\n\nSoftware updates should be run at minimum every 30 days. Run the following command to verify when software update was previously run: $ /usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate | grep -e LastFullSuccessfulDate. The response should be in the last 30 days (Example): LastFullSuccessfulDate = '2020-07-30 12:45:25 +0000';\n\nRationale:\n\nIt is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities.\n\nImpact:\n\nInstallation of updates can be disruptive to the users especially if an restart is required. Major updates need to be applied after creating an organizational patch policy. It is also advised to run updates and forced restarts during system downtime and not while in active use.",
        "solution": "Graphical Method:\nPerform the following steps to install all available software updates:\n\nOpen System Preferences\n\nSelect Software Update\n\nSelect Show Updates\n\nSelect Update All\n\nTerminal Method:\nRun the following command to verify what packages need to be installed:\n\n$ /usr/bin/sudo /usr/sbin/softwareupdate -l\n\nThe output will include the following:\nSoftware Update found the following new or updated software:\nRun the following command to install all the packages that need to be updated:\nTo install all updates runthe command:\n\n$ /usr/bin/sudo /usr/sbin/softwareupdate -i -a\n\nOr run the following command to install individual packages:\n\n$ /usr/bin/sudo /usr/sbin/softwareupdate -i ''\n\nNote: If one of the software updates listed includes Action: restart, then you must attach the -R flag to force a system restart. If the system update is complete but no restart occurs, then the system is in an unknown state that requires a future restart. It is advised to run updates and forced restarts during system downtime and not while in active use.\n\nexample:\n\n$ /usr/bin/sudo /usr/sbin/softwareupdate -l\n\nSoftware Update Tool\n\nFinding available software\nSoftware Update found the following new or updated software:\n* Label: ProVideoFormats-2.2.7\nTitle: Pro Video Formats, Version: 2.2.7, Size: 9693KiB, Recommended: YES,\n* Label: Command Line Tools for Xcode-15.0\nTitle: Command Line Tools for Xcode, Version: 15.0, Size: 721962KiB, Recommended: YES,\n\n$ /usr/bin/sudo /usr/sbin/softwareupdate -i 'ProVideoFormats-2.2.7'\n\nSoftware Update Tool\n\nFinding available software\nAttempting to quit apps: (\n    'com.apple.Compressor'\n)\nWaiting for user to quit any relevant apps\nSuccessfully quit all apps\n\nDownloaded Pro Video Formats\nInstalling Pro Video Formats\nDone with Pro Video Formats\nDone.\n\nIn the above example, if a restart was required, the command to remediate would be /usr/bin/sudo /usr/sbin/softwareupdate -i 'ProVideoFormats-2.2.7' -R",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/softwareupdate -l 2>&1",
        "expect": "No new software available"
    },
    "custom_item_3": {
        "description": "1.2 Ensure Auto Update Is Enabled",
        "info": "Auto Update verifies that your system has the newest security patches and software updates. If 'Automatically check for updates' is not selected, background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.\n\nhttp://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/\n\nhttps://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/\n\nRationale:\n\nIt is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities.\n\nImpact:\n\nWithout automatic update, updates may not be made in a timely manner and the system will be exposed to additional risk.",
        "solution": "Graphical Method:\nPerform the following steps to enable the system to automatically check for updates:\n\nOpen System Preferences\n\nSelect Software Update\n\nSelect Advanced\n\nSet Check for updates to enabled\n\nTerminal Method:\nRun the following command to enable auto update:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.SoftwareUpdate\n\nThe key to include is AutomaticCheckEnabled\n\nThe key must be set to",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "AutomaticCheckEnabled",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_4": {
        "description": "1.3 Ensure Download New Updates When Available Is Enabled",
        "info": "In the GUI, both 'Install macOS updates' and 'Install app updates from the App Store' are dependent on whether 'Download new updates when available' is selected.\n\nRationale:\n\nIt is important that a system has the newest updates downloaded so that they can be applied.\n\nImpact:\n\nIf 'Download new updates when available' is not selected, updates may not be made in a timely manner and the system will be exposed to additional risk.",
        "solution": "Graphical Method:\nPerform the following steps to enable the system to automatically check for updates:\n\nOpen System Preferences\n\nSelect Software Update\n\nSelect Advanced\n\nSet Download new updates when available to enabled\n\nTerminal Method:\nRun the following command to enable auto update:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticDownload -bool true\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.SoftwareUpdate\n\nThe key to include is AutomaticDownload\n\nThe key must be set to",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "AutomaticDownload",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_5": {
        "description": "Check for AutoUpdate",
        "expect": "true",
        "payload_key": "AutoUpdate",
        "payload_type": "com.apple.commerce"
    },
    "custom_item_6": {
        "description": "1.4 Ensure Installation of App Update Is Enabled",
        "info": "Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.\n\nRationale:\n\nPatches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.\n\nImpact:\n\nUnpatched software may be exploited.",
        "solution": "Graphical Method:\nPerform the following steps to enable App Store updates to install automatically:\n\nOpen System Preferences\n\nSelect Software Updates\n\nSelect Advanced\n\nSet Install app updates from the App Store to enabled\n\nTerminal Method:\nRun the following command to to enable automatic checking and installing of macOS updates:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.SoftwareUpdate\n\nThe key to include is AutomaticallyInstallAppUpdates\n\nThe key must be set to",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "AutoUpdate",
        "payload_type": "com.apple.commerce"
    },
    "custom_item_7": {
        "description": "1.4 Ensure Installation of App Update Is Enabled",
        "info": "Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or administrator privileges for end users.\n\nRationale:\n\nPatches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.\n\nImpact:\n\nUnpatched software may be exploited.",
        "solution": "Graphical Method:\nPerform the following steps to enable App Store updates to install automatically:\n\nOpen System Preferences\n\nSelect Software Updates\n\nSelect Advanced\n\nSet Install app updates from the App Store to enabled\n\nTerminal Method:\nRun the following command to to enable automatic checking and installing of macOS updates:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.SoftwareUpdate\n\nThe key to include is AutomaticallyInstallAppUpdates\n\nThe key must be set to",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "AutomaticallyInstallAppUpdates",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_8": {
        "description": "ConfigDataInstall",
        "expect": "true",
        "payload_key": "ConfigDataInstall",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_9": {
        "description": "CriticalUpdateInstall",
        "expect": "true",
        "payload_key": "CriticalUpdateInstall",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_10": {
        "description": "1.6 Ensure Install of macOS Updates Is Enabled",
        "info": "Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to perform testing first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off simply to allow the administrator to contact users in order to verify installation. A dependable, repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.\n\nRationale:\n\nPatches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited.\n\nImpact:\n\nUnpatched software may be exploited.",
        "solution": "Graphical Method:\nPerform the following steps to enable macOS updates to run automatically:\n\nOpen System Preferences\n\nSelect Software Updates\n\nSelect Advanced\n\nSet Install macOS updates to enabled\n\nTerminal Method:\nRun the following commands to enable automatic checking of system data files and security updates:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticallyInstallMacOSUpdates -bool TRUE\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.SoftwareUpdate\n\nThe key to include is AutomaticallyInstallMacOSUpdates\n\nThe key must be set to",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "AutomaticallyInstallMacOSUpdates",
        "payload_type": "com.apple.SoftwareUpdate"
    },
    "custom_item_11": {
        "description": "1.7 Ensure Software Update Deferment Is Less Than or Equal to 30 Days",
        "info": "Apple provides the capability to manage software updates on Apple devices through mobile device management. Part of those capabilities permit organizations to defer software updates and allow for testing. Many organizations have specialized software and configurations that may be negatively impacted by Apple updates. If software updates are deferred, they should not be deferred for more than 30 days. This control only verifies that deferred software updates are not deferred for more than 30 days.\n\nManage software updates for Apple devices\n\nRationale:\n\nApple software updates almost always include security updates. Attackers evaluate updates to create exploit code in order to attack unpatched systems. The longer a system remains unpatched, the greater an exploit possibility exists in which there are publicly reported vulnerabilities.\n\nImpact:\n\nSome organizations may need more than 30 days to evaluate the impact of software updates.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.applicationaccess\n\nThe key to include is enforcedSoftwareUpdateDelay\n\nThe key must be set to<1-30>",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "^([0-9]|[12][0-9]|30)$",
        "payload_key": "enforcedSoftwareUpdateDelay",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_12": {
        "description": "1.9 Ensure the System is Managed by a Mobile Device Management (MDM) Software",
        "info": "Apple provides the capability to manage macOS, iOS and iPadOS using Mobile Device Management (MDM). Profiles are used to configure devices to enforce security controls as well as to configure the devices for authorized access. Many security controls available on Apple devices are only available through the use of profile settings using MDM. This capability is also misused by attackers who have added rogue profiles to the list of unwanted software and fake software updates to induce users to approve the installation of malicious content. Organizations should have Mobile Device management software in place to harden organizationally managed devices and take advantage of additional Apple controls as well as to make the devices more resistant to attackers enticing users to install unwanted content from rogue MDMs.\n\nRationale:\n\nMobile Device Management is the preferred Apple method to manage Apple devices. Some capability in this technology is a requirement for the enforcement of some controls. Users with managed devices should be trained and familiar with authrized content provided through the organizations' MDM.\n\nImpact:\n\nAn MDM is yet another additional tool that requires technically adept personnel to manage correctly. In theory proper use of an MDM can make services provisioning simpler with configuration profiles to reach authorized services.",
        "solution": "Enroll the system in a Mobile Device Management software.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep -c \"Yes (User Approved)\"",
        "expect": "^1$"
    },
    "custom_item_13": {
        "description": "2.1.1 Ensure Show Bluetooth Status in Menu Bar Is Enabled",
        "info": "By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.\n\nRationale:\n\nEnabling 'Show Bluetooth status in menu bar' is a security awareness method that helps the user understand the current state of Bluetooth, including whether it is enabled, discoverable, what paired devices exist, and what paired devices are currently active.\n\nImpact:\n\nBluetooth is a useful wireless tool that has been widely exploited when configured improperly. The user should have insight into the Bluetooth status.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.controlcenter\n\nThe key to include is Bluetooth\n\nThe key must be set to18Additional Information:\n\nTo verify individual users:\n\nAudit:\n\nGraphical Method:\n\nPerform the following steps to ensure that Bluetooth status shows in the menu bar:\n\nOpen System Preferences\n\nSelect Dock & Menu Bar\n\nSelect Bluetooth\n\nVerify that Show in Menu Bar is enabled\n\nTerminal Method:\n\nFor each user, run the following command to verify that the Bluetooth status is enabled to show in the menu bar:\n\n$ /usr/bin/sudo -u/usr/bin/defaults -currentHost read com.apple.controlcenter.plist Bluetooth\n\n18\n\nNote: If the settings has not been changed from the default, then this audit will fail on the command line. Follow the remediation instructions to verify that it is set to a disabled status.\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults -currentHost read com.apple.controlcenter.plist Bluetooth\n\n18\n\nRemediation:\n\nGraphical Method:\n\nPerform the following steps to enable Bluetooth status in the menu bar:\n\nOpen System Preferences\n\nSelect Dock & Menu Bar\n\nSelect Bluetooth\n\nSet Show in Menu Bar to enabled\n\nTerminal Method:\n\nFor each user, run the following command to enable Bluetooth status in the menu bar:\n\n$ /usr/bin/sudo -u/usr/bin/defaults -currentHost write com.apple.controlcenter.plist Bluetooth -int 18\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults -currentHost write com.apple.controlcenter.plist Bluetooth -int 18",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSCv8|13.9,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "^18$",
        "payload_key": "Bluetooth",
        "payload_type": "com.apple.controlcenter"
    },
    "custom_item_14": {
        "description": "Check to see if there's a wireless adapter on the system",
        "cmd": "/usr/sbin/networksetup -listallhardwareports | /usr/bin/grep 'Hardware Port: Wi-fi'",
        "expect": "Hardware Port: Wi-fi"
    },
    "custom_item_15": {
        "description": "2.1.2 Ensure Show Wi-Fi status in Menu Bar Is Enabled",
        "info": "The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks in order to connect. At the time of this revision, all computers Apple builds have wireless network capability, which has not always been the case. This control only pertains to systems that have a wireless NIC available. Operating systems running in a virtual environment may not score as expected, either.\n\nRationale:\n\nEnabling 'Show Wi-Fi status in menu bar' is a security awareness method that helps mitigate public area wireless exploits by making the user aware of their wireless connectivity status.\n\nImpact:\n\nThe user of the system should have a quick check on their wireless network status available.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.controlcenter\n\nThe key to include is WiFi\n\nThe key must be set to18Additional Information:\n\nAirPort is Apple's marketing name for its 802.11x based wireless network interfaces.\n\nOption-click the Wi-Fi icon in the menu bar to find out more information about the connected wireless network.\n\nTo verify individual users:\n\nAudit:\n\nGraphical Method:\n\nPerform the following steps to verify that the Wi-Fi status shows in the menu bar:\n\nOpen System Preferences\n\nSelect Dock & Menu Bar\n\nSelect Wi-Fi\n\nVerify that Show in Menu Bar is enabled\n\nor\n\nOpen System Preferences\n\nSelect Profiles\n\nVerify that an installed profile has WiFi set to 18\n\nTerminal Method:\n\nFor each user, run the following command to verify that Wi-Fi status is enabled in the menu bar:\n\n$ /usr/bin/sudo -udefaults -currentHost read com.apple.controlcenter.plist WiFi\n\n18\n\nNote: If the settings has not been changed from the default, then this audit will fail on the command line. Follow the remediation instructions to verify that it is set to a disabled status.\n\nexample:\n\n$ /usr/bin/sudo -u firstuser defaults -currentHost read com.apple.controlcenter.plist WiFi\n\n18\n\nRemediation:\n\nGraphical Method:\n\nPerform the following steps to enable Wi-Fi status in the menu bar:\n\nOpen System Preferences\n\nSelect Dock & Menu Bar\n\nSelect Wi-Fi\n\nSet Show in Menu Bar to enabled\n\nTerminal Method:\n\nFor each user, run the following command to enable Wi-Fi status in the menu bar:\n\n$ /usr/bin/sudo -udefaults -currentHost write com.apple.controlcenter.plist WiFi -int 18\n\nexample:\n\n$ /usr/bin/sudo -u firstuser defaults -currentHost write com.apple.controlcenter.plist WiFi -int 18",
        "reference": "800-171|3.1.16,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.15,800-53|AC-18,800-53|CM-6,800-53|CM-7,800-53|SC-23,800-53r5|AC-18,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-23,CSCv7|15.4,CSCv7|15.5,CSCv8|4.8,CSCv8|12.6,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-23,ITSG-33|SC-23a.,LEVEL|1A,NESA|T4.5.1,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "^18$",
        "payload_key": "WiFi",
        "payload_type": "com.apple.controlcenter"
    },
    "custom_item_16": {
        "description": "2.2.1 Ensure 'Set time and date automatically' Is Enabled",
        "info": "Correct date and time settings are required for authentication protocols, file creation, modification dates, and log entries.\n\nNote: If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required, use the Date & Time System Preference with each server separated by a space.\n\nAdditional Note: The default Apple time server is time.apple.com. Variations include time.euro.apple.com. While it is certainly more efficient to use internal time servers, there is no reason to block access to global Apple time servers or to add a time.apple.com alias to internal DNS records. There are no reports that Apple gathers any information from NTP synchronization, as the computers already phone home to Apple for Apple services including iCloud use and software updates. Best practice is to allow DNS resolution to an authoritative time service for time.apple.com, preferably to connect to Apple servers, but local servers are acceptable as well.\n\nRationale:\n\nKerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features.\n\nImpact:\n\nThe timed service will periodically synchronize with named time servers and will make the computer time more accurate.",
        "solution": "Graphical Method:\nPerform the following steps to enable the date and time to be set automatically:\n\nOpen System Preferences\n\nSelect Date & Time\n\nSet Set date and time automatically to enabled\n\nNote: By default, the operating system will use time.apple.com as the time server. You can change to any time server that meets your organization's requirements.\n\nTerminal Method:\nRun the following commands to enable the date and time setting automatically:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserversetNetworkTimeServer:$ /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on\n\nsetUsingNetworkTime: On\n\nexample:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver time.apple.com\n\nsetNetworkTimeServer: time.apple.com\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on\n\nsetUsingNetworkTime: On\n\nRun the following commands if you have not set, or need to set, a new time zone:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -listtimezones\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -settimezoneexample:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -listtimezones\n\nTime Zones:\n Africa/Abidjan\n Africa/Accra\n ...\n Pacific/Wake\n Pacific/Wallis\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -settimezone America/New_York\n\nSet TimeZone: America/New_York\n\nAdditional Information:\n\nTo learn more about timed, read: Has anyone got the time? How High Sierra has changed time synchronisation\n\nNote: The profile configuration has been removed since it requires a specific time server to be set.",
        "reference": "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/systemsetup -getusingnetworktime",
        "expect": "Network Time:[\\\\s]*On"
    },
    "custom_item_17": {
        "description": "2.2.2 Ensure Time Is Set Within Appropriate Limits",
        "info": "Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds. For this audit, a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of macOS integration into Directory systems, the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time, this check is not strict, so it may be too great for your organization. Your organization can adjust to a smaller offset value as needed.\n\nIf there are consistent drift issues on the OS, some of the most common drift issues should be investigated:\n\nThe chosen time server is not reachable based on network firewall rules on the current network\n\nThe computer is offline often and the battery drains, and the network is not immediately available\n\nThe chosen time server is a special internal or non-public time server that does not provide a reliable time source\n\nNote: ntpdate has been deprecated with 10.14. sntp replaces that command.\n\nRationale:\n\nKerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.\n\nImpact:\n\nAccurate time is required for many computer functions.",
        "solution": "Run the following commands to ensure your time is set within an appropriate limit:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver\n\nThe output will include Network Time Server: and the name of your time server\nexample: Network Time Server: time.apple.com.\n\n$ /usr/bin/sudo /usr/bin/sntp -sSexample:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver\n\nNetwork Time Server: time.apple.com\n\n$ /usr/bin/sudo /usr/bin/sntp -sS time.apple.com\n\nAdditional Information:\n\nThe associated check will fail if no network connection is available.",
        "reference": "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/systemsetup -getnetworktimeserver | /usr/bin/cut -d ' ' -f 4 | xargs /usr/bin/sntp | /usr/bin/grep '+/-'",
        "expect": "^[\\\\-\\\\+]?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-6][0-9]|270)\\\\.([\\\\d]{1,6})[\\\\s]+\\\\+\\\\/\\\\-[\\\\s]+([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-6][0-9]|270)\\\\.([\\\\d]{1,6})"
    },
    "custom_item_18": {
        "description": "2.3.1 Ensure an Inactivity Interval of 20 Minutes Or Less for the Screen Saver Is Enabled",
        "info": "A locking screen saver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS, the screen saver starts after a value is selected in the drop-down menu. 20 minutes or less is an acceptable value. Any value can be selected through the command line or script, but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.\n\nRationale:\n\nSetting an inactivity interval for the screen saver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.\n\nImpact:\n\nIf the screen saver is not set, users may leave the computer available for an unauthorized person to access information.",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "^([1-9]|[1-9][0-9]|[1-9][0-9][0-9]|1[0-1][0-9][0-9]|1200)$",
        "payload_key": "idleTime",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_19": {
        "description": "2.4.1 Ensure Remote Apple Events Is Disabled",
        "info": "Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.\n\nRationale:\n\nDisabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.\n\nImpact:\n\nWith remote Apple events turned on, an AppleScript program running on another Mac can interact with the local computer.",
        "solution": "Graphical Method:\nPerform the following steps to disable Remote Apple Events:\n\nOpen 'System Preferences\n\nSelect 'Sharing\n\nSet Remote Apple Events to disabled\n\nTerminal Method:\nRun the following commands to set Remote Apple Events to Off:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -setremoteappleevents off\n\nsetremoteappleevents: Off",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/systemsetup -getremoteappleevents",
        "expect": "^Remote Apple Events:[\\\\s]*Off"
    },
    "custom_item_20": {
        "description": "Check for forceInternetSharingOff",
        "expect": "true",
        "payload_key": "forceInternetSharingOff",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_21": {
        "description": "Check for NAT",
        "regex": "Enabled[\\\\s]*=[\\\\s]*0;",
        "managed_path": "/Library/Preferences/SystemConfiguration/",
        "plist_item": "NAT",
        "plist_name": "com.apple.nat"
    },
    "custom_item_22": {
        "description": "2.4.3 Ensure Screen Sharing Is Disabled",
        "info": "Screen Sharing allows a computer to connect to another computer on a network and display the computer's screen. While sharing the computer's screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.\n\nWhile mature administration and management does not use graphical connections for standard maintenance, most help desks have capabilities to assist users in performing their work when they have technical issues and need support. Help desks use graphical remote tools to understand what the user sees and assist them so they can get back to work. For MacOS, some of these remote capabilities can use Apple's OS tools. Control is therefore not meant to prohibit the use of a just-in-time graphical view from authorized personnel with authentication controls. Sharing should not be enabled except in narrow windows when help desk support is required.\n\nScreen Sharing on macOS can allow the use of the insecure VNC protocol. VNC is a clear text protocol that should not be used on macOS.\n\nRationale:\n\nDisabling Screen Sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.\n\nImpact:\n\nHelp desks may require the periodic use of a graphical connection mechanism to assist users. Any support that relies on native MacOS components will not work unless a scripted solution to enable and disable sharing as neccessary.",
        "solution": "Graphical Method:\nPerform the following steps to disable Screen Sharing:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet Screen Sharing to disabled\n\nTerminal Method:\nRun the following command to turn off Screen Sharing:\n\n$ /usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c 'com.apple.screensharing'",
        "expect": "^0$"
    },
    "custom_item_23": {
        "description": "2.4.4 Ensure Printer Sharing Is Disabled",
        "info": "By enabling Printer Sharing, the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.\n\nRationale:\n\nDisabling Printer Sharing mitigates the risk of attackers attempting to exploit the print server to gain access to the system.",
        "solution": "Graphical Method:\nPerform the following steps to disable Printer Sharing:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet Printer Sharing to disabled\n\nTerminal Method:\nRun the following command to disable Printer Sharing:\n\n$ /usr/bin/sudo /usr/sbin/cupsctl --no-share-printers",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/cupsctl | /usr/bin/grep _share_printers",
        "expect": "_share_printers=0"
    },
    "custom_item_24": {
        "description": "2.4.5 Ensure Remote Login Is Disabled",
        "info": "Remote Login allows an interactive terminal connection to a computer.\n\nRationale:\n\nDisabling Remote Login mitigates the risk of an unauthorized person gaining access to the system via Secure Shell (SSH). While SSH is an industry standard to connect to posix servers, the scope of the benchmark is for Apple macOS clients, not servers.\n\nmacOS does have an IP-based firewall available (pf, ipfw has been deprecated) that is not enabled or configured. There are more details and links in section 7.5. macOS no longer has TCP Wrappers support built in and does not have strong Brute-Force password guessing mitigations, or frequent patching of openssh by Apple. Since most macOS computers are mobile workstations, managing IP-based firewall rules on mobile devices can be very resource intensive. All of these factors can be parts of running a hardened SSH server.\n\nImpact:\n\nThe SSH server built into macOS should not be enabled on a standard user computer, particularly one that changes locations and IP addresses. A standard user that runs local applications, including email, web browser, and productivity tools, should not use the same device as a server. There are Enterprise management toolsets that do utilize SSH. If they are in use, the computer should be locked down to only respond to known, trusted IP addresses and appropriate administrator service accounts.\n\nFor macOS computers that are being used for specialized functions, there are several options to harden the SSH server to protect against unauthorized access including brute force attacks. There are some basic criteria that need to be considered:\n\nDo not open an SSH server to the internet without controls in place to mitigate SSH brute force attacks. This is particularly important for systems bound to Directory environments. It is great to have controls in place to protect the system, but if they trigger after the user is already locked out of their account, they are not optimal. If authorization happens after authentication, directory accounts for users that don't even use the system can be locked out.\n\nDo not use SSH key pairs when there is no insight to the security on the client system that will authenticate into the server with a private key. If an attacker gets access to the remote system and can find the key, they may not need a password or a key logger to access the SSH server.\n\nDetailed instructions on hardening an SSH server, if needed, are available in the CIS Linux Benchmarks, but it is beyond the scope of this benchmark.",
        "solution": "Graphical Method:\nPerform the following steps to disable Remote Login:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet Remote Login to disabled\n\nTerminal Method:\nRun the following command to disable Remote Login:\n\n$ /usr/bin/sudo /usr/sbin/systemsetup -setremotelogin off\n\nDo you really want to turn remote login off? If you do, you will lose this connection and can only turn it back on locally at the server (yes/no)?\n\nEntering yes will disable remote login.\n\nAdditional Information:\n\nman sshd_config",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/systemsetup -getremotelogin",
        "expect": "^Remote[\\\\s]*Login:[\\\\s]*Off$"
    },
    "custom_item_25": {
        "description": "2.4.6 Ensure DVD or CD Sharing Is Disabled",
        "info": "DVD or CD Sharing allows users to remotely access the system's optical drive. While Apple does not ship Macs with built-in optical drives any longer, external optical drives are still recognized when they are connected. In testing, the sharing of an external optical drive persists when a drive is reconnected.\n\nRationale:\n\nDisabling DVD or CD Sharing minimizes the risk of an attacker using the optical drive as a vector for attack and exposure of sensitive data.\n\nImpact:\n\nMany Apple devices are now sold without optical drives, however drive sharing may be needed for legacy optical media. The media should be explicitly re-shared as needed rather than using a persistent share. Optical drives should not be used for long-term storage. To store necessary data from an optical drive it should be copied to another form of external storage. Optionally, an image can be made of the optical drive so that it is stored in its original form on another form of external storage.",
        "solution": "Graphical Method:\nPerform the following steps to disable DVD or CD Sharing:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet DVD or CD sharing to disabled\n\nTerminal Method:\nRun the following command to disable DVD or CD Sharing:\n\n$ /usr/bin/sudo /bin/launchctl disable system/com.apple.ODSAgent\n\nNote: If using the Terminal method, the GUI will still show the service checked until after a reboot.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c 'com.apple.ODSAgent'",
        "expect": "^0$"
    },
    "custom_item_26": {
        "description": "2.4.7 Ensure Bluetooth Sharing Is Disabled",
        "info": "Bluetooth Sharing allows files to be exchanged with Bluetooth-enabled devices.\n\nRationale:\n\nDisabling Bluetooth Sharing minimizes the risk of an attacker using Bluetooth to remotely attack the system.\n\nImpact:\n\nControl 2.1.1 discusses disabling Bluetooth if no paired devices exist. There is a general expectation that Bluetooth peripherals will be used by most users in Apple's ecosystem. It is possible that sharing is required and Bluetooth peripherals are not. Bluetooth must be enabled if sharing is an acceptable use case.",
        "solution": "Graphical Method:\nPerform the following steps to disable Bluetooth Sharing:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet Bluetooth Sharing to disabled\n\nTerminal Method:\nRun the following command to disable Bluetooth Sharing is disabled:\n\n$ /usr/bin/sudo -u/usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-171|3.13.1,800-171|3.13.2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|MP-2,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|MP-2,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.8,CSCv7|5.1,CSCv7|9.2,CSCv7|14.6,CSCv8|3.3,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|MP-2,ITSG-33|MP-2a.,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "not_regex": "^1$",
        "plist_item": "PrefKeyServicesEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_27": {
        "description": "2.4.8 Ensure File Sharing Is Disabled",
        "info": "File sharing from a user workstation creates additional risks, such as:\n\nOpen ports are created that can be probed and attacked\n\nPasswords are attached to user accounts for access that may be exposed and endanger other parts of the organizational environment, including directory accounts\n\nIncreased complexity makes security more difficult and may expose additional attack vectors\n\nApple's File Sharing uses the Server Message Block (SMB) protocol to share to other computers that can mount SMB shares. This includes other macOS computers.\n\nApple warns that SMB sharing stored passwords is less secure, and anyone with system access can gain access to the password for that account. When sharing with SMB, each user accessing the Mac must have SMB enabled. Storing passwords, especially copies of valid directory passwords, decreases security for the directory account and should not be used.\n\nRationale:\n\nBy disabling File Sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.\n\nImpact:\n\nFile Sharing can be used to share documents with other users, but hardened servers should be used rather than user endpoints. Turning on File Sharing increases the visibility and attack surface of a system unnecessarily.",
        "solution": "Graphical Method:\nPerform the following steps to disable File Sharing:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet File Sharing to disabled\n\nTerminal Method:\nRun the following command to disable File Sharing:\n\n$ /usr/bin/sudo /bin/launchctl disable system/com.apple.smbd",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-6(2),800-53|AC-6(5),800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-6(2),800-53r5|AC-6(5),800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSCv8|5.4,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS16,NIAv2|VL2,NIAv2|VL3a,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c 'com.apple.smbd'",
        "expect": "^0$"
    },
    "custom_item_28": {
        "system": "Darwin",
        "description": "2.4.9 Ensure Remote Management Is Disabled",
        "info": "Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current screen, install software, report on, and generally manage client Macs.\n\nThe screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regarding screen sharing.\n\nRemote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on a macOS System and could accept connections from untrusted hosts depending on the configuration, which is a major concern for mobile systems. As with other sharing options, an open port even for authorized management functions can be attacked, and both unauthorized access and Denial-of-Service vulnerabilities could be exploited. If remote management is required, the pf firewall should restrict access only to known, trusted management consoles. Remote management should not be used across the Internet without the use of a VPN tunnel.\n\nRationale:\n\nRemote Management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.\n\nImpact:\n\nMany organizations utilize ARD for client management.",
        "solution": "Graphical Method:\nPerform the following steps to disable Remote Management:\n\nOpen System Preferences\n\nSelect Sharing\n\nSet Remote Management to disabled\n\nTerminal Method:\nRun the following command to disable Remote Management:\n\n$ /usr/bin/sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop\n\nStarting...\nRemoved preference to start ARD after reboot.\nDone.\n\nAdditional Information:\n\n/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -help",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-6(2),800-53|AC-6(5),800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-6(2),800-53r5|AC-6(5),800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv7|9.2,CSCv7|14.3,CSCv8|4.1,CSCv8|4.8,CSCv8|5.4,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS16,NIAv2|VL2,NIAv2|VL3a,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "name": "ARDAgent"
    },
    "custom_item_29": {
        "description": "2.4.11 Ensure AirDrop Is Disabled When Not Actively Transferring Files",
        "info": "AirDrop is Apple's built-in, on-demand ad hoc file exchange system that is compatible with both macOS and iOS. It uses Bluetooth LE for discovery that limits connectivity to Mac or iOS users that are in close proximity. Depending on the setting, it allows everyone or only Contacts to share files when they are near each other.\n\nIn many ways this technology is far superior to the alternatives. The file transfer is done over a TLS encrypted session, does not require any open ports that are required for file sharing, does not leave file copies on email servers or within cloud storage, and allows for the service to be mitigated so that only people already trusted and added to contacts can interact with you.\n\nWhile there are positives to AirDrop, there are privacy concerns that could expose personal information. For that reason, AirDrop should be disabled, and should only be enabled when needed, then disabled afterwards. The recommendation against enabling the sharing is not based on any known lack of security in the protocol but for specific user operational concerns.\n\nIf AirDrop is enabled, the Mac is advertising that a Mac is addressable on the local network and open to either unwanted AirDrop upload requests or for a negotiation on whether the remote user is in the user's contacts list. Neither process is desirable.\n\nIn most known use cases, AirDrop use is ad hoc networking in situations where Apple device users decide that a file should be exchanged and opt to use AirDrop, which can be enabled on the fly for that exchange.\n\nFor organizations concerned about any use of AirDrop because of Digital Loss Prevention (DLP) monitoring on other protocols, JAMF has an article on reviewing AirDrop logs.\n\nDetecting outbound AirDrop transfers and logging them\n\nRationale:\n\nAirDrop can allow malicious files to be downloaded from unknown sources. Contacts Only limits may expose personal information to devices in the same area.\n\nImpact:\n\nDisabling AirDrop can limit the ability to move files quickly over the network without using file shares.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.applicationaccess\n\nThe key to include is allowAirDrop\n\nThe key must be set toNote: AirDrop can only be enabled or disabled through configuration profiles. If your organization wants to use AirDrop, it would need to be set through Terminal or the GUI. Please see the Additional Information for assistance with those options, but those system will not technically be in compliance.",
        "reference": "800-171|3.1.1,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-2(1),800-53|AC-3,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-2(1),800-53r5|AC-3,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv7|15.4,CSCv8|4.1,CSCv8|4.8,CSCv8|6.7,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-2(1),ITSG-33|AC-3,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM3,NIAv2|AM28,NIAv2|GS8b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "false",
        "payload_key": "allowAirDrop",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_30": {
        "description": "fdesetup",
        "cmd": "/usr/bin/fdesetup status",
        "expect": "FileVault[\\\\s]+is[\\\\s]+On"
    },
    "custom_item_31": {
        "description": "dontAllowFDEDisable",
        "expect": "true",
        "payload_key": "dontAllowFDEDisable",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_32": {
        "description": "2.5.1.2 Ensure all user storage APFS volumes are encrypted",
        "info": "Apple developed a new file system which was first made available in 10.12 and then became the default in 10.13. The file system is optimized for Flash and Solid-State storage and encryption. https://en.wikipedia.org/wiki/Apple_File_System macOS computers generally have several volumes created as part of APFS formatting, including Preboot, Recovery and Virtual Memory (VM), as well as traditional user disks.\n\nAll APFS volumes that do not have specific roles and do not require encryption should be encrypted. 'Role' disks include Preboot, Recovery and VM. User disks are labelled with '(No specific role)' by default.\n\nRationale:\n\nIn order to protect user data from loss or tampering volumes, carrying data should be encrypted.\n\nImpact:\n\nWhile FileVault protects the boot volume, data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use Disk Utility to erase a user disk and format as APFS (Encrypted).\nNote: APFS Encrypted disks will be described as 'FileVault' whether they are the boot volume or not in the ap list.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|13.6,CSCv7|14.8,CSCv8|3.6,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1M,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/diskutil ap list | /usr/bin/egrep \"(APFS Volume Disk|FileVault:)\"",
        "expect": "Manual Review Required"
    },
    "custom_item_33": {
        "description": "2.5.1.3 Ensure all user storage CoreStorage volumes are encrypted",
        "info": "Apple introduced CoreStorage with 10.7. It is used as the default for formatting on macOS volumes prior to 10.13.\n\nAll HFS and CoreStorage Volumes should be encrypted.\n\nRationale:\n\nIn order to protect user data from loss or tampering, volumes carrying data should be encrypted.\n\nImpact:\n\nWhile FileVault protects the boot volume, data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use Disk Utility to erase a disk and format as macOS Extended (Journaled, Encrypted).",
        "reference": "800-171|3.5.2,800-171|3.8.5,800-171|3.8.7,800-171|3.13.16,800-53|IA-5(1),800-53|MP-5,800-53|MP-7,800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|MP-5,800-53r5|MP-7,800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CN-L3|8.5.4.1(c),CSCv7|13.6,CSCv7|14.8,CSCv8|3.9,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,CSF|PR.PT-2,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,ITSG-33|IA-5(1),ITSG-33|MP-5,ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1M,NESA|T1.4.1,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/diskutil cs list | /usr/bin/egrep \"(Logical Volume Family|Encryption Type:)\"",
        "expect": "Manual Review Required"
    },
    "custom_item_34": {
        "description": "Check for globalstate",
        "expect": "^[12]$",
        "payload_key": "globalstate",
        "payload_type": "com.apple.alf"
    },
    "custom_item_35": {
        "description": "Check for EnableFirewall",
        "expect": "true",
        "payload_key": "EnableFirewall",
        "payload_type": "com.apple.security.firewall"
    },
    "custom_item_36": {
        "description": "Check for stealthenabled",
        "expect": "^1$",
        "payload_key": "stealthenabled",
        "payload_type": "com.apple.alf"
    },
    "custom_item_37": {
        "description": "Check for EnableStealthMode",
        "expect": "true",
        "payload_key": "EnableStealthMode",
        "payload_type": "com.apple.security.firewall"
    },
    "custom_item_38": {
        "description": "2.5.6 Ensure Limit Ad Tracking Is Enabled",
        "info": "Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer to see advertising that is relevant to them and their interests, the detailed information that is collected, correlated, and available to advertisers in repositories via data mining is often disconcerting. This information is valuable to both advertisers and attackers, and has been used with other metadata to reveal users' identities.\n\nOrganizations should manage advertising settings on computers rather than allow users to configure the settings.\n\nApple Information\n\nAd tracking should be limited on 10.15 and prior.\n\nRationale:\n\nOrganizations should manage user privacy settings on managed devices to align with organizational policies and user data protection requirements.\n\nImpact:\n\nUses will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.applicationaccess\n\nThe key to include is allowApplePersonalizedAdvertising\n\nThe key must be set toNote: Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.\n\nAdditional Information:\n\nTo verify individual users:\n\nAudit:\n\nGraphical Method:\n\nPerform the following steps to verify that limited ad tracking is set:\n\nOpen System Preferences\n\nSelect Security & Privacy\n\nSelect Privacy\n\nSelect Apple Advertising\n\nVerify that Personalized Ads is not enabled\n\nTerminal Method:\n\nFor each user, run the following command to verify that ad tracking is limited:\n\n$ /usr/bin/sudo -u/usr/bin/defaults read /Users//Library/Preferences/com.apple.AdLib.plist allowApplePersonalizedAdvertising\n\n0\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults read /Users/firstuser/Library/Preferences/com.apple.AdLib.plist allowApplePersonalizedAdvertising\n\n0\n\n$ /usr/bin/sudo -u seconduser /usr/bin/defaults read /Users/seconduser/Library/Preferences/com.apple.AdLib.plist allowApplePersonalizedAdvertising\n\n1\n\nIn this example, firstuser is compliant and seconduser is not.\n\nRemediation:\n\nGraphical Method:\n\nPerform the following steps to set limited ad tracking:\n\nOpen System Preferences\n\nSelect Security & Privacy\n\nSelect Privacy\n\nSelect Apple Advertising\n\nSet Personalized Ads to disabled\n\nTerminal Method:\n\nFor each needed user, run the following command to enable limited ad tracking:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write /Users//Library/Preferences/com.apple.Adlib.plist allowApplePersonalizedAdvertising -bool false\n\nexample:\n\n$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/seconduser/Library/Preferences/com.apple.Adlib.plist allowApplePersonalizedAdvertising -bool false",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "false",
        "payload_key": "allowApplePersonalizedAdvertising",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_39": {
        "description": "2.5.7 Ensure Gatekeeper Is Enabled",
        "info": "Gatekeeper is Apple's application that utilizes allowlisting to restrict downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization.\n\nRationale:\n\nDisallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.",
        "solution": "Graphical Method:\nPerform the following steps to enable Gatekeeper:\n\nOpen System Preferences\n\nSelect Security & Privacy\n\nSelect General\n\nSet 'Allow apps downloaded from:' to 'App Store and identified developers'\n\nTerminal Method:\nRun the following command to enable Gatekeeper to allow applications from App Store and identified developers:\n\n$ /usr/bin/sudo /usr/sbin/spctl --master-enable\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.systempolicy.control\n\nThe key to include is AllowIdentifiedDevelopers\n\nThe key must be set toThe key to also include is EnableAssessment\n\nThe key must be set to",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-16,800-53r5|SI-3,800-53r5|SI-16,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|8.2,CSCv7|8.4,CSCv8|10.1,CSCv8|10.2,CSCv8|10.5,CSF|DE.CM-4,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,ITSG-33|SI-16,LEVEL|1A,NIAv2|GS8a,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/spctl --status",
        "expect": "assessments[\\\\s]+enabled"
    },
    "custom_item_40": {
        "description": "2.5.8 Ensure a Custom Message for the Login Screen Is Enabled",
        "info": "An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.\n\nRationale:\n\nAn access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.\n\nImpact:\n\nIf users are not informed of their responsibilities, unapproved activities may occur. Users that are not approved for access may take the lack of a warning banner as implied consent to access.",
        "solution": "Graphical Method:\nPerform the following steps to enable a login banner set to your organization's required text:\n\nOpen System Preferences\n\nSelect Security & Privacy\n\nSelect Show a message when the screen is locked\n\nSelect Set Lock Message\n\nInsert text in the Set a message to appear on the lock screen that matches your organization's required text\n\nTerminal Method:\nRun the following command to enable a custom login screen message:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText ''\n\nexample:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText 'Center for Internet Security Test Message'\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.loginwindow\n\nThe key to include is LoginwindowText\n\nThe key must be set to",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "@ACCESS_WARNING@",
        "payload_key": "LoginwindowText",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_41": {
        "description": "2.5.9 Ensure an Administrator Password Is Required to Access System-Wide Preferences",
        "info": "System Preferences controls system and user settings on a macOS Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the computer.\n\nRationale:\n\nBy requiring a password to unlock system-wide System Preferences, the risk of a user changing configurations that affect the entire system is mitigated and requires an admin user to re-authenticate to make changes.\n\nImpact:\n\nUsers will need to enter their password to unlock some additional preference panes that are unlocked by default like Network, Startup and Printers & Scanners.",
        "solution": "Graphical Method:\nPerform the following steps to verify that an administrator password is required to access system-wide preferences:\n\nOpen System Preferences\n\nSelect Security & Privacy\n\nSelect General\n\nSelect Advanced...\n\nSet Require an administrator password to access system-wide preferences to enabled\n\nTerminal Method:\nThe authorizationdb settings cannot be written to directly, so the plist must be exported out to temporary file. Changes can be made to the temporary plist, then imported back into the authorizationdb settings.\nRun the following commands to enable that an administrator password is required to access system-wide preferences:\n\n$ /usr/bin/sudo /usr/bin/security authorizationdb read system.preferences > /tmp/system.preferences.plist\n\nYES (0)\n\n$ /usr/bin/sudo /usr/bin/defaults write /tmp/system.preferences.plist shared -bool false\n\n$ /usr/bin/sudo /usr/bin/security authorizationdb write system.preferences < /tmp/system.preferences.plist\n\nYES (0)",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/security authorizationdb read system.preferences 2> /dev/null | grep -A1 shared | /usr/bin/grep 'shared' -A1",
        "expect": ""
    },
    "custom_item_42": {
        "description": "askForPassword",
        "expect": "true",
        "payload_key": "askForPassword",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_43": {
        "description": "askForPasswordDelay",
        "expect": "^[0-5]$",
        "payload_key": "askForPasswordDelay",
        "payload_type": "com.apple.screensaver"
    },
    "custom_item_44": {
        "description": "2.7.2 Ensure Time Machine Volumes Are Encrypted If Time Machine Is Enabled",
        "info": "One of the most important security tools for data protection on macOS is FileVault. With encryption in place it makes it difficult for an outside party to access your data if they get physical possession of the computer. One very large weakness in data protection with FileVault is the level of protection on backup volumes. If the internal drive is encrypted but the external backup volume that goes home in the same laptop bag is not, it is self-defeating. Apple tries to make this mistake easily avoided by providing a checkbox to enable encryption when setting up a Time Machine backup. Using this option does require some password management, particularly if a large drive is used with multiple computers. A unique, complex password to unlock the drive can be stored in keychains on multiple systems for ease of use.\n\nWhile some portable drives may contain non-sensitive data and encryption may make interoperability with other systems difficult, backup volumes should be protected just like boot volumes.\n\nRationale:\n\nBackup volumes need to be encrypted.",
        "solution": "Graphical Method:\nPerform the following steps to enable encryption on the Time Machine drive:\n\nOpen 'System Preferences\n\nSelect 'Time Machine\n\nSelect Backup Disk...\n\nSelect the existing Time Machine backup drive from the Available Drive list\n\nSet Encrypt backups to enabled\n\nSelect Use Disk\n\nNote: You can set encryption through Disk Utility or /usr/bin/sudo /usr/sbin/diskutil in terminal, but it is advised to use the GUI.",
        "reference": "800-171|3.5.2,800-171|3.8.9,800-171|3.13.16,800-53|CP-9,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|CP-9,800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|10.4,CSCv7|13.6,CSCv7|14.8,CSCv8|3.6,CSCv8|3.11,CSCv8|11.3,CSF|PR.AC-1,CSF|PR.DS-1,CSF|PR.IP-4,GDPR|32.1.a,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|M5.2.3,NESA|T2.2.4,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/defaults read /Library/Preferences/com.apple.TimeMachine.plist | /usr/bin/grep -c NotEncrypted",
        "expect": "^0$"
    },
    "custom_item_45": {
        "description": "Check for Wake On LAN/Modem Ring",
        "cmd": "/usr/bin/profiles -P -o stdout 2>&1 | /usr/bin/awk '/\"Wake On LAN\"/ { if ($NF == \"0;\" ) l+=1; n+=1; print } /\"Wake On Modem Ring\"/ { if ($NF == \"0;\") m+=1; n+=1; print } END { if (n == 0 || l+m != n || l == 0 || m == 0) print \"fail\"; else print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_46": {
        "description": "Check for womp",
        "cmd": "/usr/bin/pmset -g | /usr/bin/grep womp",
        "expect": "^[\\\\s]*womp[\\\\s]*0$"
    },
    "custom_item_47": {
        "description": "2.8.3 Ensure Power Nap Is Disabled for Intel Macs",
        "info": "Power Nap allows the system to stay in low power mode, especially while on battery power, and periodically connect to previously known networks with stored credentials for user applications to phone home and get updates. This capability requires FileVault to remain unlocked and the use of previously joined networks to be risk accepted based on the SSID without user input.\n\nThis control has been updated to check the status on both battery and AC Power. The presence of an electrical outlet does not completely correlate with logical and physical security of the device or available networks.\n\nRationale:\n\nDisabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.\n\nThe use of Power Nap adds to the risk of compromised physical and logical security. The user should be able to decrypt FileVault and have the applications download what is required when the computer is actively used.\n\nThe control to prevent computer sleep has been retired for this version of the Benchmark. Forcing the computer to stay on and use energy in case a management push is needed is contrary to most current management processes. Only keep computers unslept if after hours pushes are required on closed LANs.\n\nImpact:\n\nPower Nap exists for unattended user application updates like email and social media clients. With Power Nap disabled, the computer will not wake and reconnect to known wireless SSIDs intermittently when slept.",
        "solution": "Graphical Method:\nPerform the following steps to disable Power Nap:\n\nOpen System Preferences\n\nSelect Battery\n\nSelect Battery\n\nSet Enable Power Nap to enabled\n\nSelect Power Adapter\n\nSet Enable Power Nap to enabled\n\nSelect UPS\n\nSet Enable Power Nap to enabled\n\nTerminal Method:\nRun the following command to disable Power Nap:\n\n$ /usr/bin/sudo /usr/bin/pmset -a powernap 0\n\nAdditional Information:\n\nman pmset",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/pmset -g custom | /usr/bin/grep -c -E 'powernap[[:space:]]+1'",
        "expect": "^0$"
    },
    "custom_item_48": {
        "description": "Check for cpu brand",
        "cmd": "/usr/sbin/sysctl -n machdep.cpu.brand_string",
        "expect": "Apple"
    },
    "custom_item_49": {
        "description": "Check to see if there's an Apple T2 Security Chip on the system",
        "cmd": "system_profiler SPiBridgeDataType | awk -F: '/Model Name/ {print $NF}' | sed 's/^ *//'",
        "expect": "Apple T2 Security Chip"
    },
    "custom_item_50": {
        "description": "2.9 Ensure Legacy EFI Is Valid and Updating - valid",
        "info": "In order to mitigate firmware attacks, Apple has created an automated Firmware check to ensure that the EFI version running is a known good version from Apple. There is also an automated process to check it every seven days.\n\nThis check is only valid on T1 chips and prior. Neither T2 chips nor Apple silicon require this control check.\n\nRationale:\n\nIf the Firmware of a computer has been compromised, the Operating System that the Firmware loads cannot be trusted, either.",
        "solution": "If EFI does not pass the integrity check, you may send a report to Apple. Backing up files and clean installing a known good Operating System and Firmware is recommended.\n\nAdditional Information:\n\nEFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load macOS from, and it also determines whether the user can enter single user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode, and protection against firewire DMA attacks. While it was easier in the past to reset the firmware password by removing RAM, it did make tampering slightly harder because having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to manage the firmware password on macOS computers, though some tools did make it much easier.\n\nThe EFI password management capability has been replaced in new Apple silicon Macs. The security features are replaced in the Silicon Mac recoveryOS. Long-term it appears that macOS EFI management is a deprecated technology in mixed Intel/Apple Silicon environments.\n\nApple patched OS X in 10.7 to mitigate the DMA attacks, and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses single user mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive.\n\nStarting in late 2010 with the MacBook Air, Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password effectively more critical if it is used.\n\nSetting the firmware password may be a good practice in some environments. We cannot recommend it as a standard security practice at this time.",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/libexec/firmwarecheckers/eficheck/eficheck --integrity-check",
        "expect": "No[\\\\s]+changes[\\\\s]+detected[\\\\s]+in[\\\\s]+primary[\\\\s]+hashes"
    },
    "custom_item_51": {
        "description": "2.9 Ensure Legacy EFI Is Valid and Updating - checked regularly",
        "info": "In order to mitigate firmware attacks, Apple has created an automated Firmware check to ensure that the EFI version running is a known good version from Apple. There is also an automated process to check it every seven days.\n\nThis check is only valid on T1 chips and prior. Neither T2 chips nor Apple silicon require this control check.\n\nRationale:\n\nIf the Firmware of a computer has been compromised, the Operating System that the Firmware loads cannot be trusted, either.",
        "solution": "If EFI does not pass the integrity check, you may send a report to Apple. Backing up files and clean installing a known good Operating System and Firmware is recommended.\n\nAdditional Information:\n\nEFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load macOS from, and it also determines whether the user can enter single user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode, and protection against firewire DMA attacks. While it was easier in the past to reset the firmware password by removing RAM, it did make tampering slightly harder because having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to manage the firmware password on macOS computers, though some tools did make it much easier.\n\nThe EFI password management capability has been replaced in new Apple silicon Macs. The security features are replaced in the Silicon Mac recoveryOS. Long-term it appears that macOS EFI management is a deprecated technology in mixed Intel/Apple Silicon environments.\n\nApple patched OS X in 10.7 to mitigate the DMA attacks, and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses single user mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive.\n\nStarting in late 2010 with the MacBook Air, Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password effectively more critical if it is used.\n\nSetting the firmware password may be a good practice in some environments. We cannot recommend it as a standard security practice at this time.",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep com.apple.driver.eficheck",
        "expect": "com.apple.driver.eficheck"
    },
    "custom_item_52": {
        "description": "2.10 Audit Siri Settings",
        "info": "With macOS 10.12 Sierra, Apple has introduced Siri from iOS to macOS. While there are data spillage concerns with the use of data-gathering personal assistant software, the risk here does not seem greater in sending queries to Apple through Siri than in sending search terms in a browser to Google or Microsoft. While it is possible that Siri will be used for local actions rather than Internet searches, Siri could, in theory, tell Apple about confidential Programs and Projects that should not be revealed. This appears be a usage edge case.\n\nIn cases where sensitive or protected data is processed and Siri could expose that information through assisting a user in navigating their machine, it should be disabled. Siri does need to phone home to Apple, so it should not be available from air-gapped networks as part of its requirements.\n\nMost of the use case data published has shown that Siri is a tremendous time saver on iOS where multiple screens and menus need to be navigated through. Information like sports scores, weather, movie times, and simple to-do items on existing calendars can be easily found with Siri. None of the standard use cases should be more risky than already approved activity.\n\nFor information on Apple's privacy policy for Siri, click here.\n\nRationale:\n\nWhere 'normal' user activity is already limited, Siri use should be controlled as well.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.applicationaccess\n\nThe key to include is allowAssistant\n\nSet the key toorbased on your organization's requirements\n\nNote: Siri can only be enabled or disabled through configuration profiles. Any additional settings need to be set through either System Settings or Terminal.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "Manual Review Required",
        "payload_key": "allowAssistant",
        "payload_type": "com.apple.applicationaccess"
    },
    "custom_item_53": {
        "description": "3.1 Ensure Security Auditing Is Enabled",
        "info": "macOS's audit facility, auditd, receives notifications from the kernel when certain system calls, such as open, fork, and exit, are made. These notifications are captured and written to an audit log.\n\nRationale:\n\nLogs generated by auditd may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor.",
        "solution": "Terminal Method:\nPerform the following to enable security auditing:\nRun the following command to load auditd:\n\n$ /usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CSCv7|4.9,CSCv7|6.2,CSCv8|8.2,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep -i auditd",
        "expect": "com.apple.auditd"
    },
    "custom_item_54": {
        "description": "ttl",
        "file": "/etc/asl/com.apple.install",
        "regex": "(?i)ttl(?-i)",
        "expect": "(?i)ttl(?-i)[\\\\s]*=[\\\\s]*(36[5-9]|3[7-9][0-9]|[4-9]\\d{2,}|[1-9]\\d{3,})"
    },
    "custom_item_55": {
        "description": "all_max",
        "file": "/etc/asl/com.apple.install",
        "regex": "all_max=",
        "expect": "all_max="
    },
    "custom_item_56": {
        "description": "3.4 Ensure Security Auditing Retention Is Enabled",
        "info": "The macOS audit capability contains important information to investigate security or operational issues. This resource is only completely useful if it is retained long enough to allow technical staff to find the root cause of anomalies in the records.\n\nRetention can be set to respect both size and longevity. To retain as much as possible under a certain size, the recommendation is to use the following:\n\nexpire-after:60d OR 5G\n\nThis recomendation is based on minimum storage for review and investigation. When a third party tool is in use to allow remote logging or the store and forwarding of logs, this local storage requirement is not required.\n\nRationale:\n\nThe audit records need to be retained long enough to be reviewed as necessary.\n\nImpact:\n\nThe recommendation is that at least 60 days or 5 gigabytes of audit records are retained. Systems that have very little remaining disk space may have issues retaining sufficient data.",
        "solution": "Terminal Method:\nPerform the following to set the audit retention length:\nEdit the /etc/security/audit_control file so that expire-after: is at least 60d OR 5G\n\nDefault Value:\n\nMore info in the man page. To reference the man page use the command $ man audit_control",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-1,800-53|AU-2,800-53|AU-4,800-53r5|AU-1,800-53r5|AU-2,800-53r5|AU-4,CN-L3|8.1.4.3(a),CSCv7|6.4,CSCv7|6.7,CSCv8|8.1,CSCv8|8.3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-1,ITSG-33|AU-2,ITSG-33|AU-4,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.3.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.8,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "file": "/etc/security/audit_control",
        "regex": "^expire-after[\\\\s]*:",
        "expect": "^expire-after[\\\\s]*:[\\\\s]*([6-9][0-9]|[1-9][0-9]{2,})[Dd][\\\\s]+OR[\\\\s]+([5-9]|[\\\\d]{2,})G"
    },
    "custom_item_57": {
        "description": "/etc/security/audit_control",
        "file": "/etc/security/audit_control",
        "owner": "root",
        "mask": "007",
        "group": "wheel"
    },
    "custom_item_58": {
        "description": "/var/audit",
        "file": "/var/audit",
        "owner": "root",
        "mask": "007",
        "group": "wheel"
    },
    "custom_item_59": {
        "description": "Check for EnableLogging",
        "expect": "true",
        "payload_key": "EnableLogging",
        "payload_type": "com.apple.security.firewall"
    },
    "custom_item_60": {
        "description": "Check for LoggingOption",
        "expect": "detail",
        "payload_key": "LoggingOption",
        "payload_type": "com.apple.security.firewall"
    },
    "custom_item_61": {
        "description": "Check for EnableLogging",
        "expect": "^1$",
        "payload_key": "loggingenabled",
        "payload_type": "com.apple.alf"
    },
    "custom_item_62": {
        "description": "Check for LoggingOption",
        "expect": "^2$",
        "payload_key": "loggingoption",
        "payload_type": "com.apple.alf"
    },
    "custom_item_63": {
        "description": "4.2 Ensure HTTP Server Is Disabled",
        "info": "macOS used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable, and Apple has removed that capability from the GUI. Apache, however, is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end-user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.\n\nRationale:\n\nWeb serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.\n\nImpact:\n\nThe web server is both a point of attack for the system and a means for unauthorized file transfers.",
        "solution": "Terminal Method:\nRun the following command to disable the HTTP server services:\n\n$ sudo /usr/bin/sudo /bin/launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|9.2,CSCv8|4.1,CSCv8|4.8,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c 'org.apache.httpd'",
        "expect": "^0$"
    },
    "custom_item_64": {
        "description": "com.apple.nfsd",
        "cmd": "/bin/launchctl list | /usr/bin/grep -c 'com.apple.nfsd'",
        "expect": "^0$"
    },
    "custom_item_65": {
        "description": "/etc/exports",
        "file": "/etc/exports"
    },
    "custom_item_66": {
        "description": "5.1.1 Ensure Home Folders Are Secure",
        "info": "By default, macOS allows all valid users into the top level of every other user's home folder and restricts access to the Apple default folders within. Another user on the same system can see you have a 'Documents' folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system.\n\nThe best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures. Similarly with macOS, users can see into every new Directory that is created because of the default permissions.\n\nHome folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable.\n\nRationale:\n\nAllowing all users to view the top level of all networked users' home folder may not be desirable since it may lead to the revelation of sensitive information.\n\nImpact:\n\nIf implemented, users will not be able to use the 'Public' folders in other users' home folders. 'Public' folders with appropriate permissions would need to be set up in the /Shared folder.",
        "solution": "Terminal Method:\nFor each user, run the following command to secure all home folders:\n\n$ /usr/bin/sudo /bin/chmod -R og-rwx /Users/Alternately, run the following command if there needs to be executable access for a home folder:\n\n$ /usr/bin/sudo /bin/chmod -R og-rw /Users/example:\n\n$ /usr/bin/sudo /bin/chmod -R og-rw /Users/thirduser/\n\n$ /usr/bin/sudo /bin/chmod -R og-rwx /Users/fourthuser/\n\n# /bin/ls -l /Users/\n\ntotal 0\ndrwxr-xr-x+ 12 Guest       _guest  384 24 Jul 13:42 Guest\ndrwxrwxrwt   4 root        wheel   128 22 Jul 11:00 Shared\ndrwx--x--x+ 18 firstuser   staff   576 10 Aug 14:36 firstuser\ndrwx--x--x+ 15 seconduser  staff   480 10 Aug 09:16 seconduser\ndrwx--x--x+ 11 thirduser   staff   352 10 Aug 14:53 thirduser\ndrwx------+ 11 fourthuser  staff   352 10 Aug 14:53 fourthuser",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/find /Users -type d ! -perm -1000 -maxdepth 1 -a -perm +0066 | /usr/bin/egrep -v '^/Users$' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_67": {
        "description": "5.1.2 Ensure System Integrity Protection Status (SIP) Is Enabled",
        "info": "System Integrity Protection is a security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.\n\nRationale:\n\nRunning without System Integrity Protection on a production system runs the risk of the modification of system binaries or code injection of system processes that would otherwise be protected by SIP.\n\nImpact:\n\nSystem binaries and processes could become compromised.",
        "solution": "Terminal Method:\nPerform the following steps to enable System Integrity Protection:\n\nReboot into the Recovery Partition (reboot and hold down Command + R)\n\nSelect Utilities\n\nSelect Terminal\n\nRun the following command:\n\n$ /usr/bin/sudo /usr/bin/csrutil enable\n\nSuccessfully enabled System Integrity Protection. Please restart the machine for the changes to take effect.\n\nReboot the computer\n\nNote: If SIP has been disabled, the admin should research why it was disabled. You might also want to assume that the operating system has been compromised. If you believe this is the case, back up any files, and do a clean install to a known good Operating System.\nIt might be a better option to erase the Mac and reinstall the operating system. That is at your discretion.\nNote: You cannot enable System Integrity Protection from the booted operating system. If the remediation is attempted in the booted OS and not the Recovery Partition, the output will give the error csrutil: failed to modify system integrity configuration. This tool needs to be executed from the Recovery OS.",
        "reference": "800-171|3.4.1,800-171|3.4.6,800-171|3.4.7,800-171|3.4.9,800-53|CM-7,800-53|CM-7(1),800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53|SI-16,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,800-53r5|SI-16,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSCv8|2.6,CSCv8|10.5,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-7(2),ITSG-33|CM-8(3),ITSG-33|SI-16,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/csrutil status",
        "expect": "System Integrity Protection status: enabled"
    },
    "custom_item_68": {
        "description": "5.1.3 Ensure Apple Mobile File Integrity (AMFI) Is Enabled",
        "info": "Apple Mobile File Integrity (AMFI) was first released in macOS 10.12. The daemon and service block attempts to run unsigned code. AMFI uses lanchd, code signatures, certificates, entitlements, and provisioning profiles to create a filtered entitlement dictionary for an app. AMFI is the macOS kernel module that enforces code-signing and library validation.\n\nRationale:\n\nApple Mobile File Integrity validates that application code is validated.\n\nImpact:\n\nApplications could be compromised with malicious code.",
        "solution": "Terminal Method:\nRun the following command to enable the Apple Mobile File Integrity service:\n\n$ /usr/bin/sudo /usr/sbin/nvram boot-args=''",
        "reference": "800-171|3.4.1,800-171|3.4.6,800-171|3.4.7,800-171|3.4.9,800-53|CM-7,800-53|CM-7(1),800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSCv8|2.6,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/nvram -p | /usr/bin/grep -c 'amfi_get_out_of_my_way=1'",
        "expect": "^0$"
    },
    "custom_item_69": {
        "description": "5.1.4 Ensure Sealed System Volume (SSV) Is Enabled",
        "info": "Sealed System Volume is a security feature introduced in macOS 11.0 Big Sur.\n\nDuring system installation, a SHA-256 cryptographic hash is calculated for all immutable system files and stored in a Merkle tree which itself is hashed as the Seal. Both are stored in the metadata of the snapshot created of the System volume.\n\nThe seal is verified by the boot loader at startup. macOS will not boot if system files have been tampered with. If validation fails, the user will be instructed to reinstall the operating system.\n\nDuring read operations for files located in the Sealed System Volume, a hash is calculated and compared to the value stored in the Merkle tree.\n\nRationale:\n\nRunning without Sealed System Volume on a production system could run the risk of Apple software that integrates directly with macOS being modified.\n\nImpact:\n\nApple Software that integrates with the operating system could become compromised.",
        "solution": "If SSV has been disabled, assume that the operating system has been compromised. Back up any files, and do a clean install to a known good Operating System.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|13.6,CSCv7|14.8,CSCv8|3.6,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/csrutil authenticated-root status",
        "expect": "Authenticated Root status: enabled"
    },
    "custom_item_70": {
        "description": "5.1.5 Ensure Appropriate Permissions Are Enabled for System Wide Applications",
        "info": "Applications in the System Applications Directory (/Applications) should be world-executable since that is their reason to be on the system. They should not be world-writable and allow any process or user to alter them for other processes or users to then execute modified versions.\n\nRationale:\n\nUnauthorized modifications of applications could lead to the execution of malicious code.\n\nImpact:\n\nApplications changed will no longer be world-writable. Depending on the environment, there will be different risk tolerances on each non-conforming application. Global changes should not be performed where mission-critical applications are misconfigured.",
        "solution": "Terminal Method:\nRun the following command to change the permissions for each application that does not meet the requirements:\n\n$ /usr/bin/sudo IFS=$'\\n'\nfor apps in $( /usr/bin/find /System/Volumes/Data/Applications -iname '*\\.app' -type d -perm -2 | grep -v Xcode.app ); do\n  /bin/chmod -R o-w '$apps'\ndone\n\nNote: Global changes should not be performed where mission-critical applications are part of the improperly permissioned applications.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/find /System/Volumes/Applications -iname '*\\.app' -type d -perm -2 -ls | /usr/bin/grep -v 'Xcode.app' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_71": {
        "description": "5.1.6 Ensure No World Writable Files Exist in the System Folder",
        "info": "Software sometimes insists on being installed in the /System/Volumes/Data/System Directory and has inappropriate world-writable permissions.\n\nMacs with writable files in System should be investigated forensically. A file with open writable permissions is a sign of at best a rogue application. It could also be a sign of a computer compromise and a persistent presence on the system.\n\nRationale:\n\nFolders in /System/Volumes/Data/System should not be world-writable. The audit check excludes the 'Drop Box' folder that is part of Apple's default user template.\n\nImpact:\n\nChanging file permissions could disrupt the use of applications that rely on files in the System Folder with vulnerable permissions.",
        "solution": "Terminal Method:\nRun the following command to set permissions so that folders are not world-writable in the /System folder:\n\n$ /usr/bin/sudo IFS=$'\\n'\nfor sysPermissions in $( /usr/bin/find /System/Volumes/Data/System -type d -perm -2 | /usr/bin/grep -v 'Drop Box' ); do\n  /bin/chmod -R o-w '$sysPermissions'\ndone",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/find /System/Volumes/Data/System -type d -perm -2 -ls | /usr/bin/grep -v 'Drop Box' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_72": {
        "description": "Check for maxFailedAttempts",
        "expect": "^@PASSWORD_LOCKOUT_THRESHOLD@$",
        "payload_key": "maxFailedAttempts",
        "payload_type": "com.apple.mobiledevice.passwordpolicy"
    },
    "custom_item_73": {
        "description": "Check for minutesUntilFailedLoginReset",
        "expect": "^@PASSWORD_LOCKOUT_TIME@$",
        "payload_key": "minutesUntilFailedLoginReset",
        "payload_type": "com.apple.mobiledevice.passwordpolicy"
    },
    "custom_item_74": {
        "description": "5.2.2 Ensure Password Minimum Length Is Configured",
        "info": "A minimum password length is the fewest number of characters a password can contain to meet a system's requirements.\n\nEnsure that a minimum of a 15-character password is part of the password policy on the computer.\n\nWhere the confidentiality of encrypted information in FileVault is more of a concern, requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.\n\nRationale:\n\nInformation systems that are not protected with strong password schemes including passwords of minimum length provide a greater opportunity for attackers to crack the password and gain access to the system.\n\nImpact:\n\nShort passwords can be easily attacked.",
        "solution": "Terminal Method:\nRun the following command to set the password length to greater than or equal to 15:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'minChars==15>'\n\nexample:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'minChars=15'\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.mobiledevice.passwordpolicy\n\nThe key to include is minLength\n\nThe key must be set to=15>Note: The profile method is the preferred method for setting password policy since -setglobalpolicy in pwpolicy is deprecated and will likely be removed in a future macOS release.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -e \"policyAttributePassword matches\" | /usr/bin/cut -b 46-53 | /usr/bin/cut -d',' -f1 | /usr/bin/cut -d'{' -f2",
        "expect": "^@PASSWORD_MINIMUM_LENGTH@$"
    },
    "custom_item_75": {
        "description": "5.2.7 Ensure Password Age Is Configured",
        "info": "Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users should reset passwords periodically. This control uses 365 days as the acceptable value. Some organizations may be more or less restrictive. This control mainly exists to mitigate against password reuse of the macOS account password in other realms that may be more prone to compromise. Attackers take advantage of exposed information to attack other accounts.\n\nRationale:\n\nPasswords should be changed periodically to reduce exposure.\n\nImpact:\n\nRequired password changes will lead to some locked computers requiring admin assistance.",
        "solution": "Terminal Method:\nRun the following command to require that passwords expire after at most 365 days:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'maxMinutesUntilChangePassword='\n\nexample:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'maxMinutesUntilChangePassword=43200'\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.mobiledevice.passwordpolicy\n\nThe key to include is maxPINAgeInDays\n\nThe key must be set to=365>Note: The profile method is the preferred method for setting password policy since -setglobalpolicy in pwpolicy is deprecated and will likely be removed in a future macOS release.",
        "reference": "800-171|3.1.1,800-53|AC-2(3),800-53r5|AC-2(3),CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv7|16.9,CSCv8|5.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),LEVEL|1A,NIAv2|AM26,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "pref1=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributeExpiresEveryNDays | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1) && pref2=$(/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributeDaysUntilExpiration | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1) && echo $pref1:$pref2",
        "expect": "^(@PASSWORD_AGE@:.*|.*:@PASSWORD_AGE@)$"
    },
    "custom_item_76": {
        "description": "5.2.8 Ensure Password History Is Configured",
        "info": "Over time, passwords can be captured by third parties through mistakes, phishing attacks, third-party breaches, or merely brute-force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed), users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous password hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15. The latest NIST guidance based on exploit research referenced in this section details how one of the greatest risks is password exposure rather than password cracking. Passwords should be changed to a new unique value whenever a password might have been exposed to anyone other than the account holder. Attackers have maintained persistent control based on predictable password change patterns and substantially different patterns should be used in case of a leak.\n\nRationale:\n\nOld passwords should not be reused.\n\nImpact:\n\nRequired password changes will lead to some locked computers requiring admin assistance.",
        "solution": "Terminal Method:\nRun the following command to require that the password must to be different from at least the last 15 passwords:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'usingHistory==15>'\n\nexample:\n\n$ /usr/bin/sudo /usr/bin/pwpolicy -n /Local/Default -setglobalpolicy 'usingHistory=15'\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.mobiledevice.passwordpolicy\n\nThe key to include is pinHistory\n\nThe key must be set to=15>Note: The profile method is the preferred method for setting password policy since -setglobalpolicy in pwpolicy is deprecated and will likely be removed in a future macOS release.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 policyAttributePasswordHistoryDepth | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1",
        "expect": "^@PASSWORD_HISTORY@$"
    },
    "custom_item_77": {
        "description": "permissions",
        "file": "/etc/sudoers.d",
        "owner": "root",
        "group": "wheel"
    },
    "custom_item_78": {
        "description": "timestamp timeout",
        "cmd": "/usr/bin/sudo -V | /usr/bin/grep \"Authentication timestamp timeout:\"",
        "expect": "Authentication timestamp timeout: 0.0 minutes"
    },
    "custom_item_79": {
        "description": "5.4 Ensure a Separate Timestamp Is Enabled for Each User/tty Combo",
        "info": "Using tty tickets ensures that a user must enter the sudo password in each Terminal session.\n\nWith sudo versions 1.8 and higher, introduced in 10.12, the default value is to have tty tickets for each interface so that root access is limited to a specific terminal. The default configuration can be overwritten or not configured correctly on earlier versions of macOS.\n\nRationale:\n\nIn combination with removing the sudo timeout grace period, a further mitigation should be in place to reduce the possibility of a background process using elevated rights when a user elevates to root in an explicit context or tty.\n\nAdditional mitigation should be in place to reduce the risk of privilege escalation of background processes.\n\nImpact:\n\nThis control should have no user impact. Developers or installers may have issues if background processes are spawned with different interfaces than where sudo was executed.",
        "solution": "Terminal Method:\nRun the following command to edit the sudo settings:\n\n$ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/example: $ /usr/bin/sudo /usr/sbin/visudo -f /etc/sudoers.d/10_cissudoconfiguration\nNote: Unlike other Unix and/or Linux distros, macOS will ignore configuration files in the sudoers.d folder that contain a . so do not add a file extension to the configuration file.\nAdd the line Defaults timestamp_type=tty to the configuration file.\nNote: The Defaults timestamp_type=tty line can be added to an existing configuration file or a new one. That will depend on your organization's preference and works either way.\n\nDefault Value:\n\nIf no value is set, the default value of tty_tickets enabled will be used.\n\nAdditional Information:\n\nIn previous iterations and OS versions of the macOS Benchmark, the guidance was to edit the sudoers file directly. While this would properly configure the OS, any update would change the settings back to the default configuration. Creating a configuration file in the /etc/sudoers.d/ folder will not be modified on an OS update and will keep the proper configuration.\n\nWith the configuration file, there is no need to remove the Defaults !tty_tickets line from the visudo settings. The configuration file will take precedent.",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/sudo -V | /usr/bin/grep \"Type of authentication timestamp record: tty\"",
        "expect": "Type of authentication timestamp record: tty"
    },
    "custom_item_80": {
        "description": "5.5 Ensure the 'root' Account Is Disabled",
        "info": "The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. With some versions of Linux, the system administrator may commonly use the root account to perform administrative functions.\n\nRationale:\n\nEnabling and using the root account puts the system at risk since any successful exploit or mistake while the root account is in use could have unlimited access privileges within the system. Using the sudo command allows users to perform functions as a root user while limiting and password protecting the access privileges. By default the root account is not enabled on a macOS computer. An administrator can escalate privileges using the sudo command (use -s or -i to get a root shell).\n\nImpact:\n\nSome legacy POSIX software might expect an available root account.",
        "solution": "Graphical Method:\nPerform the following steps to ensure that the root user is disabled:\n\nOpen /System/Library/CoreServices/Applications/Directory Utility\n\nClick the lock icon to unlock the service\n\nClick Edit in the menu bar\n\nClick Disable Root User\n\nTerminal Method:\nRun the following command to disable the root user:\n\n$ /usr/bin/sudo /usr/sbin/dsenableroot -d\n\nusername = root\nuser password:",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/dscl . -read /Users/root AuthenticationAuthority",
        "expect": "(No such key: AuthenticationAuthority|Disabled)"
    },
    "custom_item_81": {
        "description": "Check for DisableAutoLoginClient",
        "expect": "true",
        "payload_key": "com.apple.login.mcx.DisableAutoLoginClient",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_82": {
        "description": "Check for autoLoginUser",
        "expect": "",
        "payload_key": "autoLoginUser",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_83": {
        "description": "5.7 Ensure an Administrator Account Cannot Log In to Another User's Active and Locked Session",
        "info": "macOS has a privilege that can be granted to any user that will allow that user to unlock an active user's sessions.\n\nRationale:\n\nDisabling the administrator's and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.\n\nImpact:\n\nWhile Fast user switching is a workaround for some lab environments, especially where there is even less of an expectation of privacy, this setting change may impact some maintenance workflows.",
        "solution": "Terminal Method:\nRun the following command to disable a user logging into another user's active and/or locked session:\n\n$ /usr/bin/sudo /usr/bin/security authorizationdb write system.login.screensaver use-login-window-ui\n\nYES (0)",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/security authorizationdb read system.login.screensaver 2>&1 | /usr/bin/grep -c use-login-window-ui",
        "expect": "^1$"
    },
    "custom_item_84": {
        "description": "5.9 Ensure Users' Accounts Do Not Have a Password Hint",
        "info": "Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.\n\nRationale:\n\nPassword hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks.",
        "solution": "Graphical Method:\nPerform the following steps to remove a user's password hint:\n\nOpen System Preferences\n\nSelect Users & Groups\n\nSelect the Current User\n\nSelect Change Password\n\nChange the password and ensure that no text is entered in the Password hint box\n\nNote: This will only change the currently logged-in user's password, and not any others that are not compliant on the Mac. Use the terminal method if multiple users are not in compliance.\nTerminal Method:\nRun the following command to remove a user's password hint:\n\n$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/hint\n\nexample:\n\n$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/firstuser hint\n\n$ /usr/bin/sudo /usr/bin/dscl . -list /Users hint . -delete /Users/seconduser hint\n\nAdditional Information:\n\nOrganizations might consider entering an organizational help desk phone number or other text (such as a warning to the user). A help desk number is only appropriate for organizations with trained help desk personnel that are validating user identities for password resets.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/bin/dscl . -list /Users hint | /usr/bin/awk '{ if ($2) print $0\" - fail\" }' | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_85": {
        "description": "Check for SecureKeyboardEntry",
        "expect": "true",
        "payload_key": "SecureKeyboardEntry",
        "payload_type": "com.apple.Terminal"
    },
    "custom_item_86": {
        "description": "5.10 Ensure Secure Keyboard Entry Terminal.app Is Enabled",
        "info": "Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal. Unauthorized applications and malicious code could intercept keystrokes entered in the Terminal.\n\nRationale:\n\nEnabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.\n\nImpact:\n\nEnabling this in Terminal would prevent an application that is otherwise validly intercepting keyboard input from intercepting that input in Terminal.app. This could impact productivity tools.",
        "solution": "Graphical Method:\nPerform the following steps to enable secure keyboard entries in Terminal:\n\nOpen the Applications folder\n\nOpen the Utilities folder\n\nOpen Terminal\n\nSelect Terminal in the Menu Bar\n\nSet Secure Keyboard Entry to enabled\n\nTerminal Method:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Terminal\n\nThe key to include is SecureKeyboardEntry\n\nThe key must be set toNote: Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|4.1,CSCv7|5.1,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "SecureKeyboardEntry",
        "payload_type": "com.apple.Terminal"
    },
    "custom_item_87": {
        "description": "5.10 Ensure Secure Keyboard Entry Terminal.app Is Enabled",
        "info": "Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal. Unauthorized applications and malicious code could intercept keystrokes entered in the Terminal.\n\nRationale:\n\nEnabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.\n\nImpact:\n\nEnabling this in Terminal would prevent an application that is otherwise validly intercepting keyboard input from intercepting that input in Terminal.app. This could impact productivity tools.",
        "solution": "Graphical Method:\nPerform the following steps to enable secure keyboard entries in Terminal:\n\nOpen the Applications folder\n\nOpen the Utilities folder\n\nOpen Terminal\n\nSelect Terminal in the Menu Bar\n\nSet Secure Keyboard Entry to enabled\n\nTerminal Method:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults write -app Terminal SecureKeyboardEntry -bool true\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Terminal\n\nThe key to include is SecureKeyboardEntry\n\nThe key must be set toNote: Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|4.1,CSCv7|5.1,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "regex": "^1$",
        "plist_item": "SecureKeyboardEntry",
        "plist_name": "com.apple.Terminal",
        "plist_user": "all"
    },
    "custom_item_88": {
        "description": "5.11 Ensure XProtect Is Running and Updated",
        "info": "XProtect is Apple's native signature-based antivirus technology. XProtect both finds and blocks the execution of known malware. There are many AV and Endpoint Threat Detection and Response (ETDR) tools available for Mac OS. The native Apple provisioned tool looks for specific known malware is completely integrated into the OS. No matter what other tools are being used XProtect should have the latest signatures available.\n\nRationale:\n\nApple creates signatures for known malware that actually effects Macs and that knowledge should be leveraged.\n\nImpact:\n\nSome organizations may have effective Mac OS anti-malware tools that XProtect conflicts with.",
        "solution": "Terminal Method:\nRun the following command to enable and update XProtect:\n\n$ sudo /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XProtect.daemon.scan.plist\n\n$ sudo /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XprotectFramework.PluginService.plist\n\n$ sudo /usr/sbin/softwareupdate -l --background-critical\n\nsoftwareupdate[97180]: Triggering a background check with forced scan (critical and config-data updates only) ...\n\nNote: Xprotect can only be enabled/disabled if SIP (System Integrity Protection) is disabled. If Xprotect is disabled, the system might be compromised and needs to be investigated.",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-16,800-53r5|SI-3,800-53r5|SI-16,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|8.2,CSCv7|8.4,CSCv8|10.1,CSCv8|10.2,CSCv8|10.5,CSF|DE.CM-4,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,ITSG-33|SI-16,LEVEL|1A,NIAv2|GS8a,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "sudo /bin/launchctl list | /usr/bin/grep -cE \"(com.apple.XprotectFramework.PluginService$|com.apple.XProtect.daemon.scan$)\"",
        "expect": "^2$"
    },
    "custom_item_89": {
        "description": "6.1.1 Ensure Login Window Displays as Name and Password Is Enabled",
        "info": "The login window prompts a user for his/her credentials, verifies their authorization level, and then allows or denies the user access to the system.\n\nRationale:\n\nPrompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.",
        "solution": "Graphical Method:\nPerform the following steps to ensure the login window display name and password:\n\nOpen System Preferences\n\nSelect Users and Groups\n\nSelect Login Options\n\nSet Display login window as: to Name and password\n\nTerminal Method:\nRun the following command to enable the login window to display name and password:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow SHOWFULLNAME -bool true\n\nNote: The GUI will not display the updated setting until the current user(s) logs out.\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.loginwindow\n\nThe key to include is SHOWFULLNAME\n\nThe key must be set to",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "SHOWFULLNAME",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_90": {
        "description": "6.1.2 Ensure Show Password Hints Is Disabled",
        "info": "Password hints are user-created text displayed when an incorrect password is used for an account.\n\nRationale:\n\nPassword hints make it easier for unauthorized persons to gain access to systems by displaying information provided by the user to assist in remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.\n\nImpact:\n\nThe user can set the hint to any value, including the password itself or clues that allow trivial social engineering attacks.",
        "solution": "Graphical Method:\nPerform the following steps to disable password hints from being shown:\n\nOpen System Preferences\n\nSelect Users & Groups\n\nSelect Login Options\n\nSet Show password hints to disabled\n\nTerminal Method:\nRun the following command to disable password hints:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow RetriesUntilHint -int 0\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.loginwindow\n\nThe key to include is RetriesUntilHint\n\nThe key must be set to0",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "^0$",
        "payload_key": "RetriesUntilHint",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_91": {
        "description": "Check for DisableGuestAccount",
        "expect": "true",
        "payload_key": "DisableGuestAccount",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_92": {
        "description": "6.1.3 Ensure Guest Account Is Disabled",
        "info": "The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes and cannot remotely login to the system. All files, caches, and passwords created by the guest user are deleted upon logging out.\n\nRationale:\n\nDisabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.\n\nImpact:\n\nA guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.",
        "solution": "Graphical Method:\nPerform the following steps to disable guest account availability:\n\nOpen System Preferences\n\nSelect Users & Groups\n\nSelect Guest User\n\nSet Allow guests to log in to this computer to disabled\n\nTerminal Method:\nRun the following command to disable the guest account:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool false\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.MCX\n\nThe key to include is DisableGuestAccount\n\nThe key must be set toAdditional Information:\n\nBy default, the guest account is enabled for access to sharing services but is not allowed to log into the computer.\n\nThe guest account does not need a password when it is enabled to log into the computer.",
        "reference": "800-171|3.1.1,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-171|3.5.2,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AC-3,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53|IA-5(1),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AC-3,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),800-53r5|IA-5(1),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.4,CSCv8|5.2,CSCv8|6.2,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|IA-5(1),LEVEL|1A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|4.1,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "true",
        "payload_key": "DisableGuestAccount",
        "payload_type": "com.apple.MCX"
    },
    "custom_item_93": {
        "description": "6.1.3 Ensure Guest Account Is Disabled",
        "info": "The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes and cannot remotely login to the system. All files, caches, and passwords created by the guest user are deleted upon logging out.\n\nRationale:\n\nDisabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.\n\nImpact:\n\nA guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.",
        "solution": "Graphical Method:\nPerform the following steps to disable guest account availability:\n\nOpen System Preferences\n\nSelect Users & Groups\n\nSelect Guest User\n\nSet Allow guests to log in to this computer to disabled\n\nTerminal Method:\nRun the following command to disable the guest account:\n\n$ /usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool false\n\nProfile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.MCX\n\nThe key to include is DisableGuestAccount\n\nThe key must be set toAdditional Information:\n\nBy default, the guest account is enabled for access to sharing services but is not allowed to log into the computer.\n\nThe guest account does not need a password when it is enabled to log into the computer.",
        "reference": "800-171|3.1.1,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-171|3.5.2,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AC-3,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53|IA-5(1),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AC-3,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),800-53r5|IA-5(1),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.4,CSCv8|5.2,CSCv8|6.2,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(b),HIPAA|164.312(d),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|IA-5(1),LEVEL|1A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.2.3,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|4.1,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "expect": "false",
        "payload_key": "GuestEnabled",
        "payload_type": "com.apple.loginwindow"
    },
    "custom_item_94": {
        "description": "6.1.4 Ensure Guest Access to Shared Folders Is Disabled",
        "info": "Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.\n\nRationale:\n\nNot allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.\n\nImpact:\n\nUnauthorized users could access shared files on the system.",
        "solution": "Graphical Method:\nPerform the following steps to no longer allow guest user access to shared folders:\n\nOpen 'System Preferences\n\nSelect 'Users & Groups\n\nSelect 'Guest User\n\nSet Allow guest users to connect to shared folders to disabled\n\nTerminal Method:\nRun the following commands to verify that shared folders are not accessible to guest users:\n\n$ /usr/bin/sudo /usr/sbin/sysadminctl -smbGuestAccess off",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/sysadminctl -smbGuestAccess status",
        "expect": "SMB guest access disabled"
    },
    "custom_item_95": {
        "description": "6.1.5 Ensure the Guest Home Folder Does Not Exist",
        "info": "In the previous two controls, the guest account login has been disabled and sharing to guests has been disabled, as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed, you have the option to archive it, leave it in place, or delete. In the case of the guest folder, the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed, it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders, as well. Rather than ignoring the folder's continued existence, it is best removed.\n\nRationale:\n\nThe Guest home folders are unneeded after the Guest account is disabled and could be used inappropriately.\n\nImpact:\n\nThe Guest account should not be necessary after it is disabled, and it will be automatically re-created if the Guest account is re-enabled",
        "solution": "Terminal Method:\nRun the following command to remove the Guest user home folder:\n\n$ /usr/bin/sudo /bin/rm -R /Users/Guest",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "file": "/Users/Guest"
    },
    "custom_item_96": {
        "description": "6.2 Ensure Show All Filename Extensions Setting is Enabled",
        "info": "A filename extension is a suffix added to a base filename that indicates the base filename's file format.\n\nRationale:\n\nVisible filename extensions allow the user to identify the file type and the application it is associated with, which leads to quick identification of misrepresented malicious files.\n\nImpact:\n\nThe user of the system can open files of unknown or unexpected filetypes if the extension is not visible.",
        "solution": "Graphical Method:\nPerform the following steps to ensure file extensions are shown:\n\nOpen Finder\n\nSelect Finder in the menu bar\n\nSelect Preferences\n\nSelect Advanced\n\nSet Show all filename extensions to enabled\n\nTerminal Method:\nRun the following command to enable displaying of file extensions:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write /Users//Library/Preferences/.GlobalPreferences.plist AppleShowAllExtensions -bool true\n\n$ /usr/bin/sudo killall Finder\n\nexample:\n\n$ /usr/bin/sudo -u seconduser /usr/bin/defaults write /Users/secondname/Library/Preferences/.GlobalPreferences.plist AppleShowAllExtensions -bool true\n\n$ /usr/bin/sudo killall Finder\n\nDefault Value:\n\nFilename extensions are turned off by default.",
        "reference": "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "regex": "^1$",
        "plist_item": "AppleShowAllExtensions",
        "plist_name": ".GlobalPreferences",
        "plist_user": "all"
    },
    "custom_item_97": {
        "description": "7.2.1 Ensure Automatic Opening of Safe Files in Safari Is Disabled",
        "info": "Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari evaluates file safety by using a list of filetypes maintained by Apple. The list of files include text, image, video and archive formats that would be run in the context of the OS rather than the browser.\n\nRationale:\n\nHackers have taken advantage of this setting via drive-by attacks. These attacks occur when a user visits a legitimate website that has been corrupted. The user unknowingly downloads a malicious file either by closing an infected pop-up or hovering over a malicious banner. An attacker can create a malicious file that will fall within Safari's safe file list that will download and execute without user input.\n\nImpact:\n\nApple considers many files that the operating system itself auto-executes as 'safe files.' Many of these files could be malicious and could execute locally without the user even knowing that a file of a specific type had been downloaded.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is AutoOpenSafeDownloads\n\nThe key must be set to:Note: Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.\n\nAdditional Information:\n\nTo verify individual users:\n\nAudit:\n\nGraphical Method:\n\nPerform the following to verify that safe files are not opened when download in Safari:\n\nOpen Safari\n\nSelect Safari from the menu bar\n\nSelect Preferences\n\nSelect General\n\nVerify that Open 'safe' files after downloading is disabled\n\nor\n\nOpen System Preferences\n\nSelect Profiles\n\nVerify that an installed profile has AutoOpenSafeDownloads set 0\n\nTerminal Method:\n\nRun the following command to verify that opening safe files after download in Safari is disabled:\n\n$ /usr/bin/sudo -u/usr/bin/defaults read /Users//Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads\n\n0\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults read /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads\n\n0\n\nNote: To run the Terminal commands, Terminal must be granted Full Disk Access in the Security & Privacy pane in System Preferences.\n\nRemediation:\n\nGraphical Method:\n\nPerform the following steps to set safe files to not open after downloading in Safari:\n\nOpen Safari\n\nSelect Safari from the menu bar\n\nSelect Preferences\n\nSelect General\n\nSet Open 'safe' files after downloading to disabled\n\nTerminal Method:\n\nRun the following command to disable safe files from not opening when downloaded in Safari:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write /Users//Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false\n\nNote: To run the Terminal commands, Terminal must be granted Full Disk Access in the Security & Privacy pane in System Preferences.",
        "reference": "800-171|3.13.13,800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|CM-10,800-53|SC-18,800-53|SI-3,800-53|SI-8,800-53r5|CM-10,800-53r5|SC-18,800-53r5|SI-3,800-53r5|SI-8,CN-L3|7.1.3.6(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CSCv7|7.1,CSCv7|7.9,CSCv7|8.5,CSCv8|9.1,CSCv8|9.6,CSF|DE.CM-3,CSF|DE.CM-4,CSF|DE.CM-5,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SC-18,ITSG-33|SI-3,ITSG-33|SI-8,LEVEL|1A,NIAv2|GS8a,NIAv2|SU3,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep AutoOpenSafeDownloads | /usr/bin/tr -d ' '",
        "expect": "\"?AutoOpenSafeDownloads\"?[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_98": {
        "description": "7.2.4 Ensure Warn When Visiting A Fradulent Website in Safari Is Enabled",
        "info": "Apple uses the Google Safe Browsing API to check for fraudulent websites and report them to the user attempting visit one.\n\nRationale:\n\nAttackers use crafted web pages to social engineer users to load unwanted content. Warning users prior to loading the content enables better security.\n\nImpact:\n\nOnce-compromised websites serving malware could be sanitized and remain in the database, though there is no widespread reporting of that risk.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is WarnAboutFraudulentWebsites\n\nThe key must be set to:",
        "reference": "800-171|3.13.1,800-171|3.13.13,800-53|CM-10,800-53|SC-7(3),800-53|SC-7(4),800-53|SC-18,800-53r5|CM-10,800-53r5|SC-7(3),800-53r5|SC-7(4),800-53r5|SC-18,CN-L3|8.1.10.6(j),CSCv7|7.1,CSCv7|7.4,CSCv8|9.1,CSCv8|9.3,CSF|DE.CM-3,CSF|DE.CM-5,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(3),ITSG-33|SC-7(4),ITSG-33|SC-18,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SU3,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|1.1,TBA-FIISB|43.1,TBA-FIISB|44.1.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep WarnAboutFraudulentWebsites | /usr/bin/tr -d ' '",
        "expect": "\"?WarnAboutFraudulentWebsites\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_99": {
        "description": "Check for BlockStoragePolicy",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep BlockStoragePolicy | /usr/bin/tr -d ' '",
        "expect": "\"?BlockStoragePolicy\"?[\\\\s]*=[\\\\s]*2;"
    },
    "custom_item_100": {
        "description": "Check for WebKitPreferences.storageBlockingPolicy",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep WebKitPreferences.storageBlockingPolicy | /usr/bin/tr -d ' '",
        "expect": "\"?WebKitPreferences.storageBlockingPolicy\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_101": {
        "description": "Check for WebKitStorageBlockingPolicy",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep WebKitStorageBlockingPolicy | /usr/bin/tr -d ' '",
        "expect": "\"?WebKitStorageBlockingPolicy\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_102": {
        "description": "7.2.7 Ensure Advertising Privacy Protection in Safari Is Enabled",
        "info": "Apple provides a framework that allows advertisers to target Apple users and end-users with advertisements. While many people prefer that when they see advertising it is relevant to them and their interests, the detailed information that is collected, correlated, and available to advertisers via data mining in repositories is often disconcerting. This information is valuable to both advertisers and attackers, and has been used with other metadata to reveal users' identities.\n\nOrganizations should manage advertising settings on computers rather than allow users to configure the settings.\n\nApple Information\n\nAd tracking should be limited on 10.15 and prior.\n\nRationale:\n\nOrganizations should manage user privacy settings on managed devices to align with organizational policies and user data protection requirements.\n\nImpact:\n\nUsers will see generic advertising rather than targeted advertising. Apple warns that this will reduce the number of relevant ads.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is WebKitPreferences.privateClickMeasurementEnabled\n\nThe key must be set to:Note: A user can still uncheck this option in the GUI, but it remains on in the background and will show it enabled when re-launching Safari.\n\nAdditional Information:\n\nTo verify individual users:\n\nAudit:\n\nGraphical Method:\n\nPerform the following steps to verify that allow privacy-preserving measurement of ad effectiveness in Safari is enabled:\n\nOpen Safari\n\nSelect Safari from the menu bar\n\nSelect Prefernces\n\nSelect Privacy\n\nVerify that Allow privacy-preserving measurement of ad effectiveness is enabled\n\nTerminal Method:\n\nRun the following command to verify that allow privacy-preserving measurement of ad effectiveness in Safari is not disabled:\n\n$ /usr/bin/sudo -u/usr/bin/defaults read /Users//Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled\n\n1\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults read /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled\n\n1\n\nNote: To run the Terminal commands, Terminal must be granted Full Disk Access in the Security & Privacy pane in System Preferences.\n\nRemediation:\n\nGraphical Method:\n\nPerform the following steps to set Safari to allow privacy-preserving measurement of ad effectiveness:\n\nOpen Safari\n\nSelect Safari from the menu bar\n\nSelect Prefernces\n\nSelect Privacy\n\nSet Warn when visiting a fraudulent site to enabled\n\nTerminal Method:\n\nRun the following command to enable allow privacy-preserving measurement of ad effectiveness in Safari:\n\n$ /usr/bin/sudo -u/usr/bin/defaults write /Users//Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled -bool true\n\nexample:\n\n$ /usr/bin/sudo -u firstuser /usr/bin/defaults write /Users/firstuser/Library/Containers/com.apple.Safari/Data/Library/Preferences/com.apple.Safari WebKitPreferences.privateClickMeasurementEnabled -bool true\n\nNote: To run the Terminal commands, Terminal must be granted Full Disk Access in the Security & Privacy pane in System Preferences.",
        "reference": "800-171|3.13.13,800-53|CM-10,800-53|SC-18,800-53r5|CM-10,800-53r5|SC-18,CSCv7|7.1,CSCv8|9.1,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18,LEVEL|1A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"WebKitPreferences.privateClickMeasurementEnabled\" | /usr/bin/tr -d ' '",
        "expect": "\"?WebKitPreferences.privateClickMeasurementEnabled\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_103": {
        "description": "7.2.8 Ensure Show Full Website Address in Safari Is Enabled",
        "info": "Attackers use websites with malicious or unwanted content to exploit the user or the computer. Part of the attack chain is to lure someone to load their content rather than the desired content. In order to reduce the risk in interacting with unwanted content, the full website address should always be displayed in Safari.\n\nRationale:\n\nFull visibility into what site is being visited is important for privacy and security.\n\nImpact:\n\nMany URLs are very long and complicated, particularly for internal content management systems. Some complete URLS in the Smart Search Field may be difficult to parse.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is ShowFullURLInSmartSearchField\n\nThe key must be set to:Note: Since the profile method sets a system-wide setting and not a user-level one, the profile method is the preferred method. It is always better to set system-wide than per user.",
        "reference": "800-171|3.13.13,800-53|CM-10,800-53|SC-18,800-53r5|CM-10,800-53r5|SC-18,CSCv7|7.1,CSCv8|9.1,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18,LEVEL|1A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep ShowFullURLInSmartSearchField | /usr/bin/tr -d ' '",
        "expect": "\"?ShowFullURLInSmartSearchField\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_104": {
        "description": "7.2.10 Ensure Pop-up Windows Are Blocked",
        "info": "Bowser pop-up windows have long been one of the most annoying delivery mechanisms of unwanted web content. The content can be as unwanted content, including Not Safe For Work, or malicious content relying on a user interacting with the pop-up. Safari has a built-in capability to disable pop-ups that should be enabled.\n\nRationale:\n\nPop-up windows are almost always unwanted content and should be blocked.\n\nImpact:\n\nObsolete web content delivery systems may still rely on pop-ups on internal web portals. Specific domains can be set to be allowed if absolutely necessary. Web Developers should update content to reduce risk in the environment so that no pop-ups are allowed",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is safariAllowPopups\n\nThe key must be set to:",
        "reference": "800-171|3.13.13,800-53|CM-10,800-53|SC-18,800-53r5|CM-10,800-53r5|SC-18,CSCv7|7.1,CSCv8|9.1,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18,LEVEL|1A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep safariAllowPopups | /usr/bin/tr -d ' '",
        "expect": "\"?safariAllowPopups\"?[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_105": {
        "description": "7.2.11 Ensure Javascript Is Enabled",
        "info": "While some graybeards (Me not included) promote the good old days when web pages were primarily or exclusively text and dynamic content was not available current web sites contain extensive scripting (JavaScript) to provide an appealing experience. For most users mission critical information on websites (Internal or External) are likely to require JavaScript and if the browser does not allow JavaScript the site will not work well, or at all and may lead to help desk calls.\n\nRationale:\n\nFor normal user experience in web browsing JavaScript must be enabled. Specialized browsing for specific use cases, advanced users or explicit domains may be desirable but is cumbersome in the current environment.\n\nImpact:\n\nPurposely malicious JavaScript on allowed pages is a security vulnerability and may not be acceptable in certain environments. User expectations must be managed if JavaScript use is considered as too risky.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is WebKitPreferences.javaScriptEnabled\n\nThe key must be set to:Note: This mobile configuration profile setting with enable Javascript and remove the ability for the user to disable it in the GUI.",
        "reference": "800-171|3.13.13,800-53|CM-10,800-53|SC-18,800-53r5|CM-10,800-53r5|SC-18,CSCv7|7.1,CSCv8|9.1,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18,LEVEL|1M,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep WebKitPreferences.javaScriptEnabled | /usr/bin/tr -d ' '",
        "expect": "\"?WebKitPreferences.javaScriptEnabled\"?[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_106": {
        "description": "7.2.12 Ensure Show Status Bar Is Enabled",
        "info": "The Status Bar in Safari shows the full URL of any link on hover. It protects the user from visiting sites where the domain has been obfuscated by allowing the user to review whether the link points to an unexpected location.\n\nRationale:\n\nShowing the Status Bar allows the user to review full URL of hyperlinks.\n\nImpact:\n\nThe Status Bar is only visible at they very bottom of the Web page when a hyperlink is hovered over. There should be no noticeable impact.",
        "solution": "Profile Method:\nCreate or edit a configuration profile with the following information:\n\nThe PayloadType string is com.apple.Safari\n\nThe key to include is ShowOverlayStatusBar\n\nThe key must be set to:",
        "reference": "800-171|3.13.13,800-53|CM-10,800-53|SC-18,800-53r5|CM-10,800-53r5|SC-18,CSCv7|7.1,CSCv8|9.1,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18,LEVEL|1A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/14563",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep ShowOverlayStatusBar | /usr/bin/tr -d ' '",
        "expect": "\"?ShowOverlayStatusBar\"?[\\\\s]*=[\\\\s]*1;"
    }
}