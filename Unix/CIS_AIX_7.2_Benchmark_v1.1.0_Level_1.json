{
    "custom_item_1": {
        "system": "AIX",
        "description": "4.7.1.9 Ensure all directories in root PATH deny write access to all",
        "info": "To secure the root users executable PATH, all directories must not be group and world writable.\n\nRationale:\n\nThere should not be group or world writable directories in the root user's executable path. This may allow an attacker to gain super user access by forcing an administrator operating as root to execute a Trojan horse program.",
        "solution": "Search and report on group or world writable directories in root's PATH. The command must be run as the root user. The script below traverses up each individual directory PATH, ensuring that all directories are not group/world writable and that they are owned by root or the bin user:\n\necho '/:${PATH}' | tr ':' '\\n' | grep '^/' | sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nprint 'Checking ${DIR}'\nwhile [[ -d ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(d???????w? *) ]] && print ' WARNING ${DIR} is world writable' || print ' ${DIR} is not world writable'\n[[ '$(ls -ld ${DIR})' = @(d????w???? *) ]] && print ' WARNING ${DIR} is group writable' || print ' ${DIR} is not group writable'\n[[ '$(ls -ld ${DIR} |awk '{print $3}')' != @(root|bin) ]] && print ' WARNING ${DIR} is not owned by root or bin'\nDIR=${DIR%/*}\ndone\ndone\n\nNOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable are marked with 'WARNING'\nTo manually change permissions on the directories:\nTo remove group writable access:\n\nchmod g-wTo remove world writable access:\n\nchmod o-wTo remove both group and world writable access:\n\nchmod go-wTo change the owner of a directory:\n\nchownTo fully automate the PATH directory permission changes execute the following code as the root user:\n\necho '/:${PATH}' | tr ':' '\\n' | grep '^/' | sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nwhile [[ -d ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(d???????w? *) ]] && chmod o-w ${DIR} && print 'Removing world write from ${DIR}'\n[[ '$(ls -ld ${DIR})' = @(d????w???? *) ]] && chmod g-w ${DIR} && print 'Removing group write from ${DIR}'\nDIR=${DIR%/*}\ndone\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "name": "writeable_dirs_in_root_path_variable",
        "mask": "022"
    },
    "custom_item_2": {
        "description": "4.7.2.2 Verify Trust of suid, sgid, acl, and trusted-bit files and programs",
        "info": "The system is audited for both suid and sgid files and programs.\n\nRationale:\n\nAn audit should be performed on the system to search for the presence of both suid and sgid files and programs. In order to prevent these files from being potentially exploited the suid and sgid permissions should be removed wherever possible.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review the currently mounted filesystems:\n\nmount\n\nUn-mount all non-local filesystems and cdrom media:\n\nunmountIf there are non-local filesystems which cannot be un-mounted, use the following to find all suid and sgid files on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) \\( -perm -04000 -o -perm -02000 \\) -type f -ls\n\nIf all non-local filesystems have been un-mounted:\n\nfind / \\( -perm -04000 -o -perm -02000 \\) -type f -ls\n\nReview the files and where possible, use the chmod command to remove the appropriate suid or sgid bits:\n\nchmod u-schmod g-sDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nUse the chmod command to re-instate the suid and sgid bits to the relevant files:\n\nchmod u+schmod g+s",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "name": "find_suid_sgid_files",
        "basedir": "/",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_3": {
        "description": "AIX Version 7, Release 2 or greater, found",
        "cmd": "/usr/bin/oslevel",
        "expect": "^[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_4": {
        "description": "2.1 Collect system configuration regularly",
        "info": "Maintain a listing of the system configuration showing assets configured into the system.\n\nRationale:\n\nThe syslog facility local1 is chosen as this is also the facility that the Dynamic Resource Manager (DRM) reports to. The command logger simplifies appending command stdout to the syslogd.\n\nImpact:\n\nAll changes to the system configuration should be logged so that the expected configuration is documented. Regular verification of the current configuration makes it possible to identify and correct undocumented system configuration changes.",
        "solution": "This example shows how to setup a daily cronjob. The actual frequency you use might differ. The keyword in the recommendation is: regular.\n\nThis example also shows two syslog reporting lines: one to a system file, the second to a centralized syslog service.\n\nThe syslog facility local1 is used to keep these reports out of the standard syslog facilities. There is not meant to establish a requirement to use facility local1.\n\n# mkdir -p /var/log/syslog\n# touch /var/log/syslog/inventory.log\n# print 'local1.info /var/log/syslog/inventory.log rotate 1m files 24 compress' >> /etc/syslog.conf\n# print 'local1.info @rsyslog.domain' >> /etc/syslog.conf\n# refresh -s syslogd || startsrc -s syslogd\n\n# print '0 0 * * * /usr/sbin/lsconf -v | /usr/bin/logger -p local1.info -t Inventory' >> /var/spool/crontabs/root\n# /usr/sbin/lsconf -v | /usr/bin/logger -p local1.info -t Inventory",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53|CM-8(1),800-53|PM-5,800-53r5|CM-8,800-53r5|CM-8(1),800-53r5|PM-5,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|1.4,CSCv8|1.1,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|CM-8,ITSG-33|CM-8(1),LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/syslog.conf",
        "regex": "^[\\\\s]*local1.info[\\\\s]*@LOCAL_SYSLOG_FILE@",
        "expect": "^[\\\\s]*local1.info[\\\\s]*@LOCAL_SYSLOG_FILE@"
    },
    "custom_item_5": {
        "description": "2.2 Scan for TROJAN aka Untrusted/Unauthorized Applications (Implement Allowlist)",
        "info": "This recommendation is find and report (audit) software on the system that has not been included in the TE (trusted execution) TSD (trusted signature database).\n\nRationale:\n\nThese entries establish a so-called AllowList. Software not included on this AllowList should be generating a syslog and/or audit record whenever it is executed.\n\nTrusted Execution (TE) is an AIX security component that can be used to monitor unauthorized software in real time.\n\nUnauthorized seems a clear definition, but how TE determines unauthorized may not be as clear. Simply put, the goal is that all software is on the AllowList. If not, the software is unauthorized. AIX uses the term TROJAN (see below) to determine that an application is unauthorized. Software that does not require any special kernel privileges to run is also authorized.\n\nWhat is a Trojan?\n\nFor this benchmark we add the AIX concept of TROJAN as a definition of unauthorised. AIX defines Trojan any executable not in the TSD with one or more of the following characteristics:\n\nuses either SUID or SGID\n\nis linked to a command in the TSD (AllowList)\n\nis in the privcmds (aka RBAC definition, ie, may have kernel privileges).\n\nis linked to a command in the privcmds database.\n\nSummary: On AIX the construct AllowList is implemented by the TSD. The clear advantage of an AllowList monitored by a system security component is that the system can enforce and/or report violations of AllowList in real-time.\n\nThis recommendation focuses on reporting violations of the AllowList. A later recommendation (update or new version of benchmark) will have a Level 2 recommendation including enforcing violations.",
        "solution": "This will be a manual process. The remediation is to find and remove the offending file (currently the reported file might be the artifact of another error - most common is a symbolic link that points at a non-existent object).\nThe starting point is running the same command from the AUDIT section:\n\ntrustchk -i -n tree / 2>&1 >/dev/null | grep untrusted\n\nLine by line, verify the root cause and act (one of):\n\nremove the offending object\n\nremove SUID/SGID settings\n\nremove privcmds setting\n\nadd to TSD aka AllowList",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7,800-53|CM-7(1),800-53|CM-7(5),800-53|CM-10,800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(5),800-53r5|CM-10,800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|2.1,CSCv7|2.3,CSCv7|2.6,CSCv7|2.7,CSCv8|2.5,CSCv8|2.6,CSCv8|2.7,CSF|DE.CM-3,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|1M,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/trustchk -i -n tree / 2>&1 >/dev/null | /usr/bin/grep untrusted | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_6": {
        "description": "trustchk",
        "cmd": "/usr/sbin/trustchk -p TE",
        "expect": "^[\\\\s]*TE[\\\\s]*=[\\\\s]*[Oo][Nn][\\\\s]*$"
    },
    "custom_item_7": {
        "description": "chkexec",
        "cmd": "/usr/sbin/trustchk -p CHKEXEC",
        "expect": "^[\\\\s]*CHKEXEC[\\\\s]*=[\\\\s]*[Oo][Nn][\\\\s]*$"
    },
    "custom_item_8": {
        "description": "kern.info",
        "file": "/etc/syslog.conf",
        "regex": "^[\\\\s]*kern\\.info",
        "expect": "^[\\\\s]*kern\\.info[\\\\s]+"
    },
    "custom_item_9": {
        "description": "te",
        "cmd": "/usr/sbin/trustchk -p TE",
        "expect": "^[\\\\s]*TE[\\\\s]*=[\\\\s]*[Oo][Nn]$"
    },
    "custom_item_10": {
        "description": "kern.info",
        "file": "/etc/syslog.conf",
        "regex": "^[\\\\s]*kern\\.info",
        "expect": "^[\\\\s]*kern\\.info[\\\\s]+"
    },
    "custom_item_11": {
        "description": "chkshlib",
        "cmd": "/usr/sbin/trustchk -p CHKSHLIB",
        "expect": "^[\\\\s]*CHKSHLIB[\\\\s]*=[\\\\s]*[Oo][Nn]$"
    },
    "custom_item_12": {
        "description": "chkkernext",
        "cmd": "/usr/sbin/trustchk -p CHKKERNEXT",
        "expect": "^[\\\\s]*CHKKERNEXT[\\\\s]*=[\\\\s]*[Oo][Nn]$"
    },
    "custom_item_13": {
        "description": "te",
        "cmd": "/usr/sbin/trustchk -p TE",
        "expect": "^[\\\\s]*TE[\\\\s]*=[\\\\s]*[Oo][Nn]$"
    },
    "custom_item_14": {
        "description": "chkscript",
        "cmd": "/usr/sbin/trustchk -p CHKSCRIPT",
        "expect": "^[\\\\s]*CHKSCRIPT[\\\\s]*=[\\\\s]*[Oo][Nn]$"
    },
    "custom_item_15": {
        "description": "kern.info",
        "file": "/etc/syslog.conf",
        "regex": "^[\\\\s]*kern\\.info",
        "expect": "^[\\\\s]*kern\\.info[\\\\s]+"
    },
    "custom_item_16": {
        "description": "2.7 Remove Unused Symbolic Links",
        "info": "This recommendation finds and removes symbolic links whose targets are missing. Symbolic Links that do not have a valid target are a risk to system integrity.\n\nThe recommendation is to scan frequently (weekly or daily) for symbolic links without a valid target object and remove them.\n\nRationale:\n\nDo not assume that anyone responsible for maintaining system integrity is (actively) monitoring unknown software.\n\nSymbolic links - pointing at nothing - are, by definition, unauthorized and/or belong on a blocklist.\n\nImpact:\n\nSymbolic Links, used properly, are a tremendous asset - enhancing system usability (ease of use). However, when pointing to nothing (i.e., whatever they pointed at has been removed but not replaced) system integrity is at the mercy of whatever process replaces that filesystem location later.\n\nTo reduce risk to system integrity any symbolic link that points at a non-existent file-system object is to be removed.\n\nNote: most symbolic links that point at no longer existent objects exist due to incomplete software removal procedures. When an authorized application is (re-)installed it's installation process will (or should) re-create the symbolic link.",
        "solution": "The following command will remove all symbolic links that lack a valid target object:\n\nfind -L / \\( -fstype jfs -o -fstype jfs2 \\) -type l | xargs rm",
        "reference": "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find -L / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type l -ls 2>&1 | /usr/bin/grep -v 'Link to an already visited ancestor' | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_17": {
        "description": "3.3 Ensure default user umask is 027 or more restrictive",
        "info": "The user file-creation mode mask (umask) is used to determine the file permission for newly created directories and files. In AIX, the default permissions for any newly created directory is 0755 (rwxr-xr-x), and for any newly created file it is 0644 (rw-r--r--). The umask modifies the default AIX permissions by restricting (masking) these permissions. The umask is not simply subtracted, but is processed bitwise. Bits set in the umask are cleared in the resulting file mode.\n\nRationale:\n\nSetting a very secure default value for umask ensures that users make a conscious choice about their file permissions. A default umask setting of 077 causes files and directories created by users to not be readable by any other user on the system. A umask of 027 would make files and directories readable by users in the same Unix group, while a umask of 022 would make files readable by every user on the system.",
        "solution": "Add the umask attribute to the default user stanza in /etc/security/user:\n\nchsec -f /etc/security/user -s default -a umask=027\n\nDefault Value:\n\numask=022",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a umask",
        "expect": "^[\\\\s]*default[\\\\s]+umask[\\\\s]*=[\\\\s]*[2-7]7[\\\\s]*$"
    },
    "custom_item_18": {
        "description": "3.4 Remove group write permission from default groups - exceptions must be in TSD and audit",
        "info": "The system is audited for group writable files.\n\nRationale:\n\nAn audit should be performed on the system to search for the presence of group writable files.\n\nIn an extreme case - where this permission is required - the file needs to be added to the TSD and audit configurations.\n\nThe preference is no group writeable files.",
        "solution": "Review the currently mounted local filesystems using the following to find all group writable files on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type f -perm -g+w -ls\n\nRemedy any files in the list, e.g., chmod g-w {filename}\n\nDocument any files, and motivate why they are group writeable, and also add documentation re: when/why this exception ceases.\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nThe audit procedure does not verify remote file systems (e.g., NFS). The expectation is that these are being audited on the file (e.g., NFS) server - rather than on all clients.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type f -perm -g+w -ls | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_19": {
        "description": "3.5 Application Data with requirement for world writable directories",
        "info": "The system is audited for world writable directories.\n\nRationale:\n\nWorld writable directories are considered as a common application component - usually a location for temporary files.\n\nAn audit should be performed on the system to search for the presence of world writable directories. Directories should only be world writable when absolutely necessary, and only with the so-called SVTX bit set. This protects users files from being deleted or renamed.\n\nImpact:\n\nWorld writable directories exist on UNIX systems (e.g., /tmp, /var/tmp). These directories are needed for normal operations. To protect the files created in the directories the 'links to the inode' (ie, filename) need to be protected so that others may not accidentally, or maliciously - remove or modify the filename.",
        "solution": "Review the local mounted JFS/JFS2 filesystems using the following command to find all world writable directories missing the SVTX bit:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type d -perm -o+w ! -perm -1000 -ls\n\nIf a directory must retain world writable access, ensure that SVTX bit is set so that users can only remove the filenames they own:\n\nchmod o+t ${dir}\n\nNOTE: This will leave existing modes while adding the SVTX (also known as sticky bit) to the directory. The documented meaning of the flag for directories is:\nSets the link permission to directories.\n\nOtherwise, remove world-write permission - without modifying the other mode bits:\n\nchmod o-w ${dir}\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type d -perm -o+w ! -perm -1000 -ls | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_20": {
        "description": "3.6 Ensure there are no world writable files - exceptions must be in TSD and audit",
        "info": "The system is audited for world writable files.\n\nRationale:\n\nAn audit should be performed on the system to search for the presence of world writable files.\n\nIn an extreme case - where this permission is required - the file needs to be added to the TSD and audit configurations.\n\nThe preference is no world writeable files.",
        "solution": "Review the currently mounted local filesystems using the following to find all world writable files on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type f -perm -o+w -ls\n\nRemedy any files in the list, e.g., chmod o-w {filename}\n\nDocument any files, and motivate why they are world writeable, and also add documentation re: when/why this exception ceases.\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nThe audit procedure does not verify remote file systems (e.g., NFS). The expectation is that these are being audited on the file (e.g., NFS) server - rather than on all clients.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type f -perm -o+w -ls | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_21": {
        "description": "3.7 Ensure there are no 'staff' writable files - exceptions must be in TSD and audit",
        "info": "The system is audited for group staff writable files.\n\nRationale:\n\nAn audit should be performed on the system to search for files that can be modified by members of the group staff. As staff is the default group for user accounts any file that is writable via group staff is comparable to being writable by other aka world writable.\n\nIn a case - where this permission is required - the recommendation is to create a new group and appoint a group administrator.\n\nThe goal is no group staff writable files.",
        "solution": "Review the currently mounted local filesystems using the following to find all world writable files on local JFS/JFS2 filesystems only:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) -type f -perm -g+w -group staff -ls\n\nRemedy any files in the list, e.g., chmod o-w {filename}\n\nDocument any files, and motivate why they are world writeable, and also add documentation re: when/why this exception ceases.\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nThe audit procedure does not verify remote file systems (e.g., NFS). The expectation is that these are being audited on the file (e.g., NFS) server - rather than on all clients.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) -type f -perm -g+w -group staff -ls | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_22": {
        "description": "3.8 Ensure all files and directories are owned by a user (uid) and assigned to a group (gid)",
        "info": "When a user or group identifier is removed from the system verify that any data associated with the ID removed is either removed or re-assigned.\n\nRationale:\n\nWorst case: a previously removed UID/GID is re-instated. Data left behind suddenly is owned and/or accessible to the new ID - gaining unintended access to data left-behind.",
        "solution": "Review the currently mounted local filesystems:\n\nfind / \\( -fstype jfs -o -fstype jfs2 \\) \\( -type d -o -type f \\) \\( -nouser -o -nogroup \\) -ls\n\nEither assign UID/GID:\n\nchownchgrpor remove the file/directory:\n\n[[ -f]] && rm -f[[ -d]] && rmdirRepeat the audit\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|MP-6,800-53r5|MP-6,CSCv8|3.5,CSF|PR.DS-3,CSF|PR.IP-6,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.3.2,ITSG-33|MP-6,LEVEL|1A,NESA|T1.4.1,NESA|T1.4.2,NIAv2|MS5b,NIAv2|MS6,NIAv2|MS9,NIAv2|MS10a,NIAv2|MS10b,NIAv2|MS10c,NIAv2|MS10d,NIAv2|MS10e,NIAv2|MS10f,NIAv2|MS11a,NIAv2|MS11b,NIAv2|MS12a,NIAv2|MS12b,NIAv2|MS12c,NIAv2|MS13,NIAv2|MS14,NIAv2|MS17,NIAv2|MS18a,NIAv2|MS18b,NIAv2|MS18c,NIAv2|MS20,NIAv2|MS21,NIAv2|NS16,QCSC-v1|3.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/find / \\\\( -fstype jfs -o -fstype jfs2 \\\\) \\\\( -type d -o -type f \\\\) \\\\( -nouser -o -nogroup \\\\) -ls | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_23": {
        "description": "sugroups",
        "cmd": "/usr/sbin/lsuser -a sugroups root",
        "expect": "^[\\\\s]*root[\\\\s]+sugroups[\\\\s]*=[\\\\s]*((?!ALL).)*$"
    },
    "custom_item_24": {
        "description": "login rlogin su",
        "cmd": "/usr/sbin/lsuser -a login rlogin su root",
        "expect": "^[\\\\s]*root[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]+su[\\\\s]*=[\\\\s]*true[\\\\s]*$"
    },
    "custom_item_25": {
        "description": "lsattr fullcore",
        "cmd": "/usr/sbin/lsattr -El sys0 -a fullcore",
        "expect": "^[\\\\s]*fullcore[\\\\s]+false[\\\\s]+Enable[\\\\s]+full[\\\\s]+CORE[\\\\s]+dump[\\\\s]+True[\\\\s]*$"
    },
    "custom_item_26": {
        "description": "lssec limits",
        "cmd": "/usr/bin/lssec -f /etc/security/limits -s default -a core -a core_hard",
        "expect": "^[\\\\s]*default[\\\\s]+core[\\\\s]*=[\\\\s]*0[\\\\s]+core_hard[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_27": {
        "description": "4.11 Remove current working directory from default /etc/environment PATH",
        "info": "This change removes any '.' or '::' entries from /etc/environment. If a '.' or '::' is present the current working directory is included in the default search path.\n\nRationale:\n\nAny '.' and '::' will be removed from /etc/environment. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.",
        "solution": "Examine PATH in /etc/environment to see if it contains any '.' or '::' entries:\n\ngrep '^PATH=' /etc/environment |awk '/((:[ \\t]*:)|(:[ \\t]*$)|(^[\\t]*:)|(^.:)|(:.$)|(:.:))/'\n\nIf the command above yields output, remove the '.' and '::' entries from:\n\nvi /etc/environment\n\nDefault Value:\n\nDot present",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/environment",
        "regex": "^PATH=",
        "expect": "((:[ \\\\t]*:)|(:[ \\\\t]*$)|(^[ \\\\t]*:)|(^.:)|(:.$)|(:.:))"
    },
    "custom_item_28": {
        "description": "4.12 Lock historical users",
        "info": "Lock OS administrative accounts to further enhance security.\n\nRationale:\n\nLock administrative user accounts. Generic OS administrative user accounts are targeted by hackers in an attempt to gain unauthorized access to a server.",
        "solution": "Lock standard accounts using chuser:\n\nACCOUNTS=daemon,bin,sys,adm,uucp,nobody,lpd,lp,invscout,ipsec,nuucp,sshd\nlsuser -a account_locked ${ACCOUNTS} | grep -v account_locked=true | while read account attributes; do\n  chuser account_locked=true ${account}\ndone\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv7|16.8,CSCv7|16.9,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked daemon,bin,sys,adm,uucp,nobody,lpd,lp,invscout,ipsec,nuucp,sshd | /usr/bin/grep -v account_locked=true | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_29": {
        "description": "4.13 Remove current working directory from root's PATH",
        "info": "This change removes any '.' or '::' entries from the root PATH. If a '.' or '::' is present the current working directory is included in the search path.\n\nRationale:\n\nAny '.' and '::' will be removed from the root PATH. This means that any harmful programs placed in common PATH locations, would never be automatically executed. All directories must be explicitly defined within the PATH variable.",
        "solution": "Examine root's PATH to see if it contains any '.' or '::' entries:\n\nsu - root -c 'echo ${PATH}' |awk '/((:[ \\t]*:)|(:[ \\t]*$)|(^[ \\t]*:)|(^.:)|(:.$)|(:.:))/'\n\nIf the command above yields output, remove the '.' and '::' entries from the relevant initialization files. The files to examine are dependant on the root users shell definition in /etc/passwd. Once the file or files have been identified remove the '.' and '::' from the PATH variable\n\nviDefault Value:\n\nDot not present",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/su - root -c \"echo ${PATH}\" 2>&1 | /usr/bin/awk '/((:[ \\\\t]*:)|(:[ \\\\t]*$)|(^[ \\\\t]*:)|(^.:)|(:.$)|(:.:))/' | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*pass:?[\\\\s]*\\\\**$"
    },
    "custom_item_30": {
        "description": "4.14 Configuration: /etc/motd",
        "info": "Create a /etc/motd file which displays, post initial logon, a statutory warning message.\n\nRationale:\n\nThe creation of a /etc/motd file which contains a statutory warning message could aid in the prosecution of offenders guilty of unauthorized system access. The /etc/motd is displayed after successful logins from the console, SSH and other system access protocols.",
        "solution": "Create a /etc/motd file:\n\ntouch /etc/motd\nchmod u=rw,go=r /etc/motd\nchown bin:bin /etc/motd\n\nBelow is a sample banner:\n\n*************************************************************************** '\nNOTICE TO USERS\nThis computer system is the private property of its owner, whether individual, corporate or government. It is for authorized use only. Users (authorized or unauthorized) have no explicit or implicit expectation of privacy. Any or all uses of this system and all files on this system may be intercepted, monitored, recorded, copied, audited, inspected, and disclosed to your employer, to authorized site, government, and law enforcement personnel, as well as authorized officials of government agencies, both domestic and foreign. By using this system, the user consents to such interception, monitoring,recording, copying, auditing, inspection, and disclosure at the discretion of such personnel or officials. Unauthorized or improper use of this system may result in civil and criminal penalties and administrative or disciplinary action, as appropriate. By continuing to use this system you indicate your awareness of and consent to these terms and conditions of use. LOG OFF IMMEDIATELY if you do not agree to the conditions stated in this warning.\n****************************************************************************\n\nNOTE: Replace 'its owner' with the relevant company name\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/motd",
        "owner": "bin",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_31": {
        "description": "lsitab writesrv",
        "cmd": "/usr/sbin/lsitab writesrv | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_32": {
        "description": "lssrc writesrv",
        "cmd": "/usr/bin/lssrc -s writesrv | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+inoperative$"
    },
    "custom_item_33": {
        "description": "4.1.1.2 dt",
        "info": "This entry executes the CDE startup script which starts the AIX Common Desktop Environment.\n\nRationale:\n\nIf there is not an lft connected to the system and there are no other X11 clients that require CDE, remove the dt entry.",
        "solution": "In /etc/inittab, remove the dt entry:\n\nrmitab dt\n\nDefault Value:\n\nUncommented (if an lft is present)",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsitab dt | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_34": {
        "description": "4.1.1.3 piobe",
        "info": "The piobe daemon is the I/O back end for the printing process, handling the job scheduling and spooling.\n\nRationale:\n\nIf there is not a requirement for the system to support either local or remote printing, remove the piobe entry.",
        "solution": "In /etc/inittab, remove the piobe entry:\n\nrmitab piobe\n\nDefault Value:\n\nUncommented",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsitab piobe | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_35": {
        "description": "4.1.1.4 qdaemon",
        "info": "This is the printing scheduling daemon that manages the submission of print jobs to piobe.\n\nRationale:\n\nIf there is not a requirement to support local or remote printing, remove the qdaemon entry from/etc/inittab.",
        "solution": "In /etc/inittab, remove the qdaemon entry:\n\nrmitab qdaemon\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsitab qdaemon | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_36": {
        "description": "4.1.1.5 rc.nfs",
        "info": "The rcnfs entry starts the NFS, NIS and automount daemons during system boot. Additionally, it automounts filesystems with the attribute vfs = nfs.\n\nRationale:\n\nNFS is a service with numerous historical vulnerabilities and should not be enabled unless there is no alternative.",
        "solution": "Use the rmitab command to remove the NFS start-up script from /etc/inittab:\n\nrmitab rcnfs\n\nAlso, to be certain NFS related services have been discounted - execute the following script:\n\n/etc/nfs.clean\n\nDefault Value:\n\nUncommented\n\nAdditional Information:\n\nIf NFS related services are required, then read-only exports and mounts are recommended. NFS mounts should include the options nodev and nosuid to prevent unauthorized access. Further no filesystem or directory should be exported with root access.\n\nRemember, Unless otherwise required the NFS related services should be disabled.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsitab rcnfs | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_37": {
        "description": "4.1.1.6 cas_agent",
        "info": "The /etc/inittab entry labeled cas_agent starts an agent that communicates with FSM and/or IBM Director. The agent is started by the SRC subsystem and is installed by the fileset cas.agent.\n\nRationale:\n\nThe products this agent communicates with are depreciated - no longer supported by IBM as POWER platform systems management software. While harmless when running the agent may trigger a security alert due to the way it initializes with FSM (System Director).",
        "solution": "The following command will deinstall the cas.agent fileset and also any filesets installed that depend on cas.agent (e.g., if artex.base.agent is also installed):\n\nlslpp -L cas.agent  >/dev/null 2>&1 && installp -ug cas.agent\n\nDefault Value:\n\n:on: if agent is installed.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lslpp -L cas.agent",
        "expect": "[\\\\s]*not[\\\\s]+installed\\.[\\\\s]*$"
    },
    "custom_item_38": {
        "description": "4.1.2.1 inetd - aka Super Daemon",
        "info": "When none of the services run and managed by inetd are required then disable the inetd daemon itself.\n\nThis is the preferred state.\n\nRationale:\n\nWhen no inetd managed services are required there is no need to start the daemon at boot time.\n\nAn administrator can manually start the inetd service post-IPL, should any of the inetd supported services are/become required.\n\nImpact:\n\nWhen an inetd service is required this service is permitted. Be sure to review the section 4.1.5 Inetd (aka Super Daemon) Services later in the document.",
        "solution": "Review any active inetd services:\n\nrefresh -s inetd\nlssrc -ls inetd\n\nNOTE: If there are active services and the services are required, do not disable inetd. Skip to the next section and consider the implementation of TCP Wrappers to secure access to these active services. If the active services are not required disable them via the chsubserver command.\nDisable inetd if there are no active services:\n\nchrctcp -d inetd\nstopsrc -s inetd\n\nDefault Value:\n\nEnabled\n\nAdditional Information:\n\nReversion:\n\nComment in inetd startup in /etc/rc.tcpip:\n\nchrctcp -a inetd",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/inetd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/inetd"
    },
    "custom_item_39": {
        "description": "on disk /usr/sbin/aixmibd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/aixmibd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/aixmibd"
    },
    "custom_item_40": {
        "description": "lssrc aixmibd",
        "cmd": "/usr/bin/lssrc -s aixmibd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The aixmibd Subsystem is not on file\\\\.)$"
    },
    "custom_item_41": {
        "description": "on disk /usr/sbin/dhcpcd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcpcd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcpcd"
    },
    "custom_item_42": {
        "description": "lssrc dhcpcd",
        "cmd": "/usr/bin/lssrc -s dhcpcd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The dhcpcd Subsystem is not on file\\\\.)$"
    },
    "custom_item_43": {
        "description": "on disk /usr/sbin/dhcprd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcprd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcprd"
    },
    "custom_item_44": {
        "description": "lssrc dhcprd",
        "cmd": "/usr/bin/lssrc -s dhcprd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The dhcprd Subsystem is not on file\\\\.)$"
    },
    "custom_item_45": {
        "description": "on disk /usr/sbin/dhcpsd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcpsd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/dhcpsd"
    },
    "custom_item_46": {
        "description": "lssrc dhcpsd",
        "cmd": "/usr/bin/lssrc -s dhcpsd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The dhcpsd Subsystem is not on file\\\\.)$"
    },
    "custom_item_47": {
        "description": "on disk /usr/sbin/dpid2",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/dpid2",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/dpid2"
    },
    "custom_item_48": {
        "description": "lssrc dpid2",
        "cmd": "/usr/bin/lssrc -s dpid2 | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The dpid2 Subsystem is not on file\\\\.)$"
    },
    "custom_item_49": {
        "description": "on disk /usr/sbin/gated",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/gated",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/gated"
    },
    "custom_item_50": {
        "description": "lssrc gated",
        "cmd": "/usr/bin/lssrc -s gated | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The gated Subsystem is not on file\\\\.)$"
    },
    "custom_item_51": {
        "description": "on disk /usr/sbin/hostmibd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/hostmibd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/hostmibd"
    },
    "custom_item_52": {
        "description": "lssrc hostmibd",
        "cmd": "/usr/bin/lssrc -s hostmibd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The hostmibd Subsystem is not on file\\\\.)$"
    },
    "custom_item_53": {
        "description": "on disk /usr/sbin/named",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/named",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/named"
    },
    "custom_item_54": {
        "description": "lssrc named",
        "cmd": "/usr/bin/lssrc -s named | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The named Subsystem is not on file\\\\.)$"
    },
    "custom_item_55": {
        "description": "4.1.2.11 portmap",
        "info": "If all RPC services are disabled, disable the portmap daemon itself.\n\nThe portmap daemon is required for the RPC service. It converts the RPC program numbers into Internet port numbers. The daemon may be disabled if the server is not:\n\nAn NFS server\n\nA NIS (YP) or NIS+ server\n\nRunning the CDE GUI\n\nRunning a third-party software application that relies on RPC support\n\nRationale:\n\nIf no RPC services are required then there is no need to start the portmap daemon at boot time.\n\nA start of portmap can be done either manually, or scripted, should RPC port-mapping support be needed post-IPL.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review any active RPC services:\n\nrpcinfo -p localhost\n\nRun the program above (in Audit) with the argument fix\n\ncheck exit status (should be 0)\n\nDefault Value:\n\nEnabled\n\nAdditional Information:\n\nReversion:\n\nRestore in portmap startup in /etc/rc.tcpip:\n\nchrctcp -a portmap\n\nstartsrc -s portmap",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh -e\n  {\n# Author: Michael Felt, AIXTools\n# Version: 1.01\naction=$1\nret=0\nset $(rpcinfo -p localhost 2>/dev/null | /usr/bin/egrep -v \"(portmap)|(status)|(nsm)|(pyramid)\" | wc -l)\nif [ $1 -gt 1 ] ; then\n  # There are RPC services other than portmap related services\n  # Unless specifically required for a business process this is considered a risk.\n  # If there are RPC services active - will not disable portmap service\n  if [[ $# -eq 0 || ${action} != \"fix\" ]]; then\n    print \"$0: Audit mode: Verify the services listed are actually needed.\"\n    print \"This should be scored as an error unless there is a documented need\"\n    print \"for the following RPC based services.\"\n  else\n    print \"$0: FIX mode: cannot fix portmap service activation\"\n    print \"\\\\tbefore the RPC services are deactivated.\"\n    ret=-1\n  fi\n  print \"++++ The following services (excluding portmap itself) are active ++++\"\n  rpcinfo -p localhost 2>/dev/null | /usr/bin/egrep -v \"(portmap)|(status)|(nsm)|(pyramid)\"\nelif [ $1 -le 1 ] ; then\n  if [[ ${action} != \"fix\" ]] ; then\n    if [ $1 -eq 1 ] ; then\n      print \"portmap is active. This should be considered an error.\"\n    fi\n    # No RPC services were reported. Check is autostart is disabled.\n    result=$(grep \"start[[:blank:]]/usr/sbin/portmap\" /etc/rc.tcpip)\n    if [[ $result == '[ -z \"$portmap_pid\" ] && start /usr/sbin/portmap \"${src_running}\"' ]] ; then\n      print \"portmap is set to autostart. This should be considered an error.\"\n    fi\n  elif [[ $action == \"fix\" ]]; then\n    print \"Removing autostart of portmap.\"\n    PID=$$\n    umask 077\n    cat /etc/rc.tcpip >/var/tmp/rctcpip.${PID}\n    sed -e \"s/^\\\\[ -z \\\\\"\\\\$portmap_pid\\\\\"/#&/\"/etc/rc.tcpip\n    rm -f /var/tmp/rctcpip.${PID}\n    # Stop the portmapper, if active\n    stopsrc -s portmap\n    # Switch of automatic NFS services, if still in /etc/inittab\n    chitab \"rcnfs:23456789:off:/etc/rc.nfs > /dev/console 2>&1 # Start NFS Daemons\"\n  fi\nfi\n}",
        "expect": "^Manual Review Required$"
    },
    "custom_item_56": {
        "description": "on disk /usr/sbin/routed",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/routed",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/routed"
    },
    "custom_item_57": {
        "description": "lssrc routed",
        "cmd": "/usr/bin/lssrc -s routed | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+inoperative$"
    },
    "custom_item_58": {
        "description": "on disk /usr/sbin/rwhod",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/rwhod",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/rwhod"
    },
    "custom_item_59": {
        "description": "lssrc rwhod",
        "cmd": "/usr/bin/lssrc -s rwhod | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The rwhod Subsystem is not on file\\\\.)$"
    },
    "custom_item_60": {
        "description": "on disk /usr/lib/sendmail",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/lib/sendmail",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/lib/sendmail"
    },
    "custom_item_61": {
        "description": "lssrc sendmail",
        "cmd": "/usr/bin/lssrc -s sendmail | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The sendmail Subsystem is not on file\\\\.)$"
    },
    "custom_item_62": {
        "description": "on disk /usr/sbin/snmpd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/snmpd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/snmpd"
    },
    "custom_item_63": {
        "description": "lssrc snmpd",
        "cmd": "/usr/bin/lssrc -s snmpd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The snmpd Subsystem is not on file\\\\.)$"
    },
    "custom_item_64": {
        "description": "on disk /usr/sbin/snmpmibd",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/snmpmibd",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/snmpmibd"
    },
    "custom_item_65": {
        "description": "lssrc snmpmibd",
        "cmd": "/usr/bin/lssrc -s snmpmibd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The snmpmibd Subsystem is not on file\\\\.)$"
    },
    "custom_item_66": {
        "description": "on disk /usr/sbin/timed",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/timed",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/timed"
    },
    "custom_item_67": {
        "description": "lssrc timed",
        "cmd": "/usr/bin/lssrc -s timed | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "[\\\\s]+(inoperative|The timed Subsystem is not on file\\\\.)$"
    },
    "custom_item_68": {
        "description": "4.1.3.1 autoconf6",
        "info": "This entry starts autoconf6 on system startup. This is to automatically configure IPv6 interfaces at boot time.\n\nRationale:\n\nautoconf6 is used to automatically configure IPv6 interfaces at boot time. Running this service may allow other hosts on the same physical subnet to connect via IPv6, even when the network does not support it. You must disable this unless you utilize IPv6 on the server.",
        "solution": "In /etc/rc.tcpip, comment out the autoconf6 entry:\n\nchrctcp -d autoconf6\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|9.2,CSCv8|4.2,CSCv8|4.8,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/autoconf6",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/autoconf6"
    },
    "custom_item_69": {
        "description": "4.1.3.2 ndpd-host",
        "info": "This entry starts ndpd-host on system startup. This is the Neighbor Discovery Protocol (NDP) daemon.\n\nThe ndpd-host command handles the default route, which includes the default router, the default interface, and the default interface address. However, the ndpd-host command does not overwrite the static default routes that are set on the host. When the daemon is stopped, the daemon cleans up the prefix addresses and the routes that are created during its lifetime.\n\nRationale:\n\nThe ndpd-host performs the client function of the NDP protocol.\n\nUnless the server utilizes (dynamic) IPv6 this utility is not required and should be disabled.\n\nIpv6 static configuration is not affected by ndpd-host.\n\nImpact:\n\nWhen IPv6 is active and NDP is used to get a non-link-local IPv6 address (link-local addresses begin with fe80::) it is also likely that the MTU size of the interface will change from 1500 to 1492. Additionally, it may add default route to the IPv6 router it received it's address from. For example:\n\nBEFORE NDP\n\nnetstat -ni\n\nName  Mtu   Network     Address           Ipkts Ierrs    Opkts Oerrs  Coll\n\n...\n\nen0   1500  192.168.129 192.168.129.71   105156791     0 49249083     1     0\n\nen0   1500  fe80::dead:beef:fef7:6204    105156791     0 49249083     1     0\n\nnetstat -rn\n\nRouting tables\n\nDestination        Gateway           Flags   Refs     Use  If   Exp  Groups\n\nRoute tree for Protocol Family 2 (Internet):\n\ndefault            192.168.129.1     UG       23  35660110 en0      -      -\n\n127/8              127.0.0.1         U         2     22988 lo0      -      -\n\n192.168.129.0      192.168.129.71    UHSb      0         0 en0      -      -   =>\n\n192.168.129/24     192.168.129.71    U        12  13578475 en0      -      -\n\n192.168.129.71     127.0.0.1         UGHS      0     21471 lo0      -      -\n\n192.168.129.255    192.168.129.71    UHSb      0         0 en0      -      -\n\nRoute tree for Protocol Family 24 (Internet v6):\n\ndefault            link#2            UC        0         0 en0      -      -\n\n::1%1              ::1%1             UH        0     19154 lo0      -      -\n\n...\n\nAfter NDP\n\nnetstat -ni\n\nName  Mtu   Network     Address           Ipkts Ierrs    Opkts Oerrs  Coll\n\n...\n\nen0   1492  192.168.129 192.168.129.71   105190883     0 49267729     1     0\n\nen0   1492  BEEF:980:a9ea:1:deed:beef:fef7:6204 105190883     0 49267729     1     0\n\nen0   1492  fe80::deed:beef:fef7:6204    105190883     0 49267729     1     0\n\nnetstat -nr\n\nRouting tables\n\nDestination        Gateway           Flags   Refs     Use  If   Exp  Groups\n\nRoute tree for Protocol Family 2 (Internet):\n\ndefault            192.168.129.1     UG       17  35724295 en0      -      -\n\n127/8              127.0.0.1         U         2     23044 lo0      -      -\n\n192.168.129.0      192.168.129.71    UHSb      0         0 en0      -      -   =>\n\n192.168.129/24     192.168.129.71    U        14  13622746 en0      -      -\n\n192.168.129.71     127.0.0.1         UGHS      0     21576 lo0      -      -\n\n192.168.129.255    192.168.129.71    UHSb      0         0 en0      -      -\n\nRoute tree for Protocol Family 24 (Internet v6):\n\ndefault            fe80::dead:beef:fefa:4bfe UG        0         0 en0      -      -\n\n::1%1              ::1%1             UH        0     19198 lo0      -      -\n\nNote: the IPv6 destination address is the link-local (fe80::) address of the IPv6 router.",
        "solution": "In /etc/rc.tcpip, comment out the ndpd-host entry:\n\nchrctcp -d ndpd-host\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|9.2,CSCv8|4.2,CSCv8|4.8,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/ndpd-host",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/ndpd-host"
    },
    "custom_item_70": {
        "description": "4.1.3.3 ndpd-router",
        "info": "This entry starts ndpd-router on system startup. This manages the Neighbor Discovery Protocol (NDP) for non kernel activities.\n\nIt receives Router Solicitations and sends Router Advertisements. It can also exchange routing information using the RIPng protocol.\n\nRationale:\n\nThe ndpd-router manages NDP for non-kernel activities. Unless the server utilizes IPv6, this is not required and should be disabled.\n\nImpact:\n\nThis service is not needed unless the AIX host is actively exchanging routing information with IPv6 routers.\n\nSee: manpage AIX 7.1 ndpd-router Daemon",
        "solution": "In /etc/rc.tcpip, comment out the ndpd-router entry:\n\nchrctcp -d ndpd-router\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|9.2,CSCv8|4.2,CSCv8|4.8,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/rc.tcpip",
        "regex": "^[\\\\s]*start[\\\\s]+/usr/sbin/ndpd-router",
        "expect": "^[\\\\s]*start[\\\\s]+/usr/sbin/ndpd-router"
    },
    "custom_item_71": {
        "description": "4.1.4.1 NFS - disable NFS client",
        "info": "Disable NFS client unless system needs to access known NFS shares.\n\nRationale:\n\nNFS can be exploited to gain unauthorized access to file and directories. If a system does not need access to an NFS server the NFS client should be disabled to minimize this risk.\n\nAs AIX software hierarchy does not permit the de installation of the NFS client functionality - the base recommendation is to disable NFS mount permissions. The secondary control is to frequently verify that unauthorized/unexpected NFS mounts are detected.\n\nImpact:\n\nNFS exploits are frequently based on file permission settings - and mistakes in the NFS server and/or NFS client configuration settings. A typical classroom example is getting root access via SUID with a executable originating from an NFS share.",
        "solution": "Ensure that there are no current NFS client mounts:\n\nmount |grep 'nfs'\ncat /etc/filesystems |grep 'nfs'\n\nThe above commands should yield no output.\nDe-install the NFS client software:\n\ninstallp -u bos.net.nfs.client\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nRe-install the software from the product DVD's",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/grep -p nfs /etc/filesystems | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'",
        "expect": "^none$"
    },
    "custom_item_72": {
        "description": "lsnfsmnt nosuid",
        "cmd": "/usr/sbin/lsnfsmnt -l | /usr/bin/egrep -v \"^Name\" | /usr/bin/grep -v \"nosuid\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_73": {
        "description": "lsnfsmnt nodev",
        "cmd": "/usr/sbin/lsnfsmnt -l | /usr/bin/egrep -v \"^Name\" | /usr/bin/grep -v \"nodev\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_74": {
        "description": "/etc/exports exists",
        "file": "/etc/exports"
    },
    "custom_item_75": {
        "description": "4.1.4.4 NFS - localhost removal",
        "info": "Remove any reference to localhost or localhost aliases from /etc/exports.\n\nRationale:\n\nIf the RPC portmapper has proxy forwarding enabled, which is a default setting in many vendor versions. You must not export your local filesytems back to the localhost, either by name or to the alias localhost, and you must not export to any netgroups of which your host is a member. If proxy forwarding is enabled, an attacker may carefully craft NFS packets and send them to the portmapper, which in turn, forwards them to the NFS server. As the packets come from the portmapper process, which runs as root, they appear to be coming from a trusted system. This configuration may allow anyone to alter and delete files at will.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove any reference to localhost or localhost aliases in /etc/exports: Review the content of /etc/exports and check for localhost or localhost aliases:\n\ncat /etc/exports\n\nNOTE: If instances of localhost or localhost aliases are found, edit the file and remove them. Create a copy of /etc/exports:\n\ncp -p /etc/exports /etc/exports.pre_cis\n\nEdit the file:\n\nvi /etc/exports\n\nEdit the relevant NFS exports to remove the localhost access, for example:\n\n/nfsexport sec=sys,rw,access=localhost:testserver\n\nIf /etc/exports is updated, as localhost references have been removed, update the current NFS export options:\n\nexportfs -a\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /etc/exports",
        "expect": "^Manual Review Required$"
    },
    "custom_item_76": {
        "description": "4.1.4.6 NFS - no_root_squash option",
        "info": "For each NFS export, ensure that the anon aka root_squash option is set to -2 or -1.\n\nRationale:\n\nEach NFS export on the server should have the anon=-2 option set. With this (default) value root (euid==0') is seen as the account nobody. When anon=0 the remote root user has root access on the NFS mount.\n\nBy ensuring the export option anon=-2 when a client process with euid==0 attempts to access (read, write, or delete) the NFS mount the server substitutes the UID to the server's nobody account. This means that the root user on the client cannot access or change files that only root on the server can access or change.\n\nMany NFS servers call this root_squash. On AIX is is called anon. To be consistent with other benchmark terminalogy CIS recommends that root_squash is set on all exported filesystems.\n\nOn AIX the default value of any exported filesystem or directory for anon is -2. Thus, when anon is not set it's effective value is -2. Any other value has to be explicitly set.\n\nAs a more secure option you can set the option to anon=-1. This setting is accepted because it disables anonymous access. By default, secure NFS accepts non-secure requests as anonymous.\n\nNOTE: The root user on the client can still use su to become any other user (change the euid) and access and change that users files, assuming that the same user exists on the NFS server and owns files and/or directories in the NFS export.",
        "solution": "To change this value for all failing NFS exported filesystems:\n\nlsnfsexp | grep -v 'anon=-1' | grep anon= | while read fs rest; do\n chnfsexp -d ${fs} -a -2\ndone\n\nThe command chnfsexp re-exports the file or directory with the new settings active.\n\nDefault Value:\n\n(blank) which is seen as -2 (nobody) effective setting root_squash by default.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsnfsexp -l | /usr/bin/egrep -v \"anon=-1\" | /usr/bin/grep \"anon=\" | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "pass"
    },
    "custom_item_77": {
        "description": "4.1.5.1 bootps",
        "info": "This entry starts the command /usr/sbin/bootpd when required. This service is used to provide boot partition data for a network boot. It uses the same UDP port as DHCP server dhcpsd.\n\nThe recommendation is to disable this service UNLESS you are operating a NIM server. When using NIM bootps as a service is accepted, but the preference would be to configure a DHCP server with the equivalent information.\n\nRationale:\n\nThe bootpd command implements an Internet Boot Protocol server.",
        "solution": "In /etc/inetd.conf, comment out the bootps entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep bootps | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_78": {
        "description": "4.1.5.2 chargen",
        "info": "This entry starts the chargen service when required. This service is used to test the integrity of TCP/IP packets arriving at the destination.\n\nRationale:\n\nThis chargen service is a character generator service and is used for testing the integrity of TCP/IP packets arriving at the destination. An attacker may spoof packets between machines running the chargen service and thus provide an opportunity for DoS attacks. You must disable this service unless you are testing your network.",
        "solution": "In /etc/inetd.conf, comment out the chargen entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'chargen' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep chargen | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_79": {
        "description": "4.1.5.3 comsat",
        "info": "This entry starts the comsat service.\n\nThe comsat daemon receives messages on a datagram port associated with the biff service specification.\n\nThe recommendation is to leave this service disabled.\n\nRationale:\n\nThe comsat daemon is the server that receives reports of incoming mail and notifies users if they have enabled this service with the biff command. Started by the inetd daemon, the comsat daemon is not meant to be used at the command line.",
        "solution": "In /etc/inetd.conf, comment out the comsat entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'comsat' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep comsat | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_80": {
        "description": "4.1.5.4 daytime",
        "info": "The service should be disabled as it can leave the system vulnerable to DoS ping attacks.\n\nThis entry starts the daytime service when required. This provides the current date and time to other servers on a network.\n\nRationale:\n\nThis daytime service is a defunct time service, typically used for testing purposes only.",
        "solution": "In /etc/inetd.conf, comment out the daytime entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p tcp\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'daytime' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep daytime | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_81": {
        "description": "4.1.5.5 discard",
        "info": "This entry starts the discard service when required. This service is used as a debugging tool by setting up a listening socket which ignores the data it receives.\n\nRationale:\n\nThe discard service is used as a debugging and measurement tool. It sets up a listening socket and ignores data that it receives. This is a /dev/null service and is obsolete. This can be used in DoS attacks and therefore, must be disabled.",
        "solution": "In /etc/inetd.conf, comment out the discard entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'discard' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep discard | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_82": {
        "description": "4.1.5.6 echo",
        "info": "This entry starts the echo service when required. This service sends back data received by it on a specified port.\n\nRationale:\n\nThe echo service sends back data received by it on a specified port. This can be misused by an attacker to launch DoS attacks or Smurf attacks by initiating a data storm and causing network congestion. The service is used for testing purposes and therefore must be disabled if not required.",
        "solution": "In /etc/inetd.conf, comment out the echo entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p tcp\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'echo' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep echo | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_83": {
        "description": "4.1.5.7 exec",
        "info": "The recommendation is that rexecd is disabled. This service can be performed securely using OpenSSH.\n\nThis entry starts the rexecd daemon when required. This daemon executes a command from a remote system once the connection has been authenticated.\n\nRationale:\n\nThe exec service is used to execute a command sent from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the rexecd daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "In /etc/inetd.conf, comment out the exec entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'exec' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep exec | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_84": {
        "description": "4.1.5.8 finger",
        "info": "This entry starts the fingerd daemon.\n\nRationale:\n\nThe fingerd daemon provides the server function for the finger command. This allows users to view real-time pertinent user login information on other remote systems. This service should be disabled as it may provide an attacker with a valid user list to target.",
        "solution": "In /etc/inetd.conf, comment out the finger entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'finger' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep finger | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_85": {
        "description": "4.1.5.9 ftp",
        "info": "This entry starts the ftpd daemon when required. This service is used for transferring files from/to a remote machine.\n\nThe recommendation is that ftp is disabled and sftp is used as a replacement file and directory copying mechanism.\n\nRationale:\n\nThis ftp service is used to transfer files from or to a remote machine. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the ftpd daemon should be disabled.",
        "solution": "In /etc/inetd.conf, comment out the ftp entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'ftp' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nUncommented",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep ftp | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_86": {
        "description": "4.1.5.10 imap2",
        "info": "This entry starts the imap2 service when required.\n\nRationale:\n\nThe imap2 service orInternet Message Access Protocol (IMAP) supports the IMAP4 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required.",
        "solution": "In /etc/inetd.conf, comment out the imap2 entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'imap2' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep imap2 | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_87": {
        "description": "4.1.5.11 instsrv",
        "info": "This entry starts the instsrv service when required. This service should be disabled.\n\nRationale:\n\nThe instsrv service is part of the Network Installation Tools, used for servicing servers running AIX 3.2.",
        "solution": "In /etc/inetd.conf, comment out the instsrv entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'instsrv' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nCommented out",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep instsrv | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_88": {
        "description": "4.1.5.12 klogin",
        "info": "This entry starts the klogin service when required. This is a kerberized login service, which provides a higher degree of security over traditional rlogin and telnet.\n\nRationale:\n\nThe klogin service offers a higher degree of security than traditional rlogin or telnet by eliminating most clear-text password exchanges on the network. However, it is still not as secure as SSH, which encrypts all traffic. If you use klogin to login to a system, the password is not sent in clear text; however, if you su to another user, that password exchange is open to detection from network-sniffing programs. The recommendation is to utilize SSH wherever possible instead of klogin.\n\nIf the klogin service is used, you must use the latest kerberos version available and make sure that all the latest patches are installed.",
        "solution": "In /etc/inetd.conf, comment out the klogin entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'klogin' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep klogin | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_89": {
        "description": "4.1.5.13 kshell",
        "info": "This entry starts the kshell service when required. This is a kerberized remote shell service, which provides a higher degree of security over traditional rsh.\n\nRationale:\n\nThe kshell service offers a higher degree of security than traditional rsh services. However, it still does not use encrypted communications. The recommendation is to utilize SSH wherever possible instead of kshell.\n\nIf the kshell service is used, you should use the latest kerberos version available and must make sure that all the latest patches are installed.",
        "solution": "In /etc/inetd.conf, comment out the kshell entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'kshell' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep kshell | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_90": {
        "description": "4.1.5.14 login",
        "info": "This entry starts the rlogin daemon when required. This service authenticates remote user logins.\n\nRationale:\n\nThis login service is used to authenticate a remote user connection when logging in via the rlogin command. The username and password are passed over the network in clear text and therefore insecurely. Unless required the rlogin daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "In /etc/inetd.conf, comment out the rlogin entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'rlogin' -p tcp6\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nUncommented",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep rlogin | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_91": {
        "description": "4.1.5.15 netstat",
        "info": "This entry executes the command netstat -f inet. This service is displays active IP connections on a server.\n\nThe recommendation is to leave this disabled.\n\nRationale:\n\nThe netstat command symbolically displays the contents of various network-related data structures for active connections.\n\nThis interface requests a report of statistics or address control blocks to those items specified by the inet aka AF_INET (ipv4) address family.",
        "solution": "In /etc/inetd.conf, comment out the netstat entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'netstat' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep netstat | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_92": {
        "description": "4.1.5.16 ntalk",
        "info": "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.\n\nRationale:\n\nThis ntalk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the ntalk service will be disabled.",
        "solution": "In /etc/inetd.conf, comment out the ntalk entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'ntalk' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep ntalk | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_93": {
        "description": "4.1.5.17 pcnfsd",
        "info": "This entry starts the pcnfsd daemon when required. This service is an authentication and printing program, which uses NFS to provide file transfer services.\n\nRationale:\n\nThe pcnfsd service is an authentication and printing program, which uses NFS to provide file transfer services. This service is vulnerable and exploitable and permits the machine to be compromised both locally and remotely. If PC NFS clients are required within the environment, Samba is recommended as an alternative software solution. The pcnfsd daemon predates Microsoft's release of SMB specifications. This service should therefore be disabled.",
        "solution": "In /etc/inetd.conf, comment out the pcnfsd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'pcnfsd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep pcnfsd | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_94": {
        "description": "4.1.5.18 pop3",
        "info": "This entry starts the pop3 service when required.\n\nRationale:\n\nThe pop3 service provides a pop3 server. It supports the pop3 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required.",
        "solution": "In /etc/inetd.conf, comment out the pop3 entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'pop3' -p tcp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/inetd.conf",
        "regex": "^[\\\\s]*pop3[\\\\s]+",
        "expect": "^[\\\\s]*pop3[\\\\s]+"
    },
    "custom_item_95": {
        "description": "4.1.5.19 rexd",
        "info": "This entry starts the rxed service when required.\n\nThis service should be disabled if it is not required.\n\nRationale:\n\nThe rexd daemon executes programs for remote machines when a client issues a request to execute a program on a remote machine. The inetd daemon starts the rexd daemon from the /etc/inetd.conf file.\n\nNon-interactive programs use standard file descriptors connected directly to TCP connections. Interactive programs use pseudo-terminals, similar to the login sessions provided by the rlogin command. The rexd daemon can use the network file system (NFS) to mount the file systems specified in the remote execution request. Diagnostic messages are normally printed on the console and returned to the requester.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rexd' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rexd\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_96": {
        "description": "4.1.5.20 rquotad",
        "info": "This entry starts the rquotad service when required. This allows NFS clients to enforce disk quotas on locally mounted filesystems.\n\nRationale:\n\nThe rquotad service allows NFS clients to enforce disk quotas on file systems that are mounted on the local system. This service should be disabled if it is not required.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf and if running, refresh inetd:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rquotad' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rquotad\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_97": {
        "description": "4.1.5.21 rstatd",
        "info": "This entry starts the rstatd daemon. This service is used to provide kernel statistics and other monitorable parameters such as CPU usage, system uptime, network usage etc.\n\nThis service should be disabled if not explicitly required by performance monitoring software to collect statistics.\n\nRationale:\n\nThe rstatd service is used to provide kernel statistics and other monitorable parameters pertinent to the system such as: CPU usage, system uptime, network usage etc.\n\nAn attacker may use this information in a DoS attack.",
        "solution": "In /etc/inetd.conf, comment out the rstatd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'rstatd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep rstatd | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_98": {
        "description": "4.1.5.22 rusersd",
        "info": "This entry starts the rsusersd daemon when required. This service provides a list of current users active on a system.\n\nRationale:\n\nThe rusersd service runs as root and provides a list of current users active on a system. An attacker may use this service to learn valid account names on the system. This is not an essential service and should be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rusersd' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rusersd\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_99": {
        "description": "4.1.5.23 rwalld",
        "info": "This entry starts the rwalld daemon when required. This service allows remote users to broadcast system wide messages.\n\nRationale:\n\nThe rwalld service allows remote users to broadcast system wide messages. The service runs as root and should be disabled unless absolutely necessary.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'rwalld' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]rwalld\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_100": {
        "description": "4.1.5.24 shell",
        "info": "This entry starts the rshd daemon when required. This daemon executes a command from a remote system.\n\nRationale:\n\nThis shell service is used to execute a command from a remote server. The username and passwords are passed over the network in clear text and therefore insecurely. Unless required the rshd daemon will be disabled. This function, if required, should be facilitated through SSH.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'shell' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]shell\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_101": {
        "description": "4.1.5.25 sprayd",
        "info": "This entry starts the sprayd daemon when required. This service is used as a tool to generate UDP packets for testing and diagnosing network problems.\n\nRationale:\n\nThe sprayd service is used as a tool to generate UDP packets for testing and diagnosing network problems.\n\nThe service must be disabled if not explicitly required for network performance testing purposes as it can be used as a (Distributed) Denial of Service ((D)DoS) attack.",
        "solution": "In /etc/inetd.conf, comment out the sprayd entry and refresh the inetd process:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'sprayd' -p udp\nlssrc -s inetd && refresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep sprayd | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_102": {
        "description": "4.1.5.26 xmquery",
        "info": "This entry starts the xmquery daemon when required.\n\nRationale:\n\nThis xmquery service provides near real-time network-based data monitoring and local recording from a given node.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'xmquery' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]xmquery\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_103": {
        "description": "4.1.5.27 talk",
        "info": "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.\n\nRationale:\n\nThis talk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the talk service will be disabled",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'talk' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]talk\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_104": {
        "description": "4.1.5.28 telnet",
        "info": "The recommendation is that telnet is disabled and OpenSSH is used as a replacement mechanism.\n\nThis entry starts the telnetd daemon when required. This provides a protocol for command line access from a remote machine.\n\nRationale:\n\nThe telnet protocol passes username and password in clear text over the network in clear text and therefore insecurely.\n\nThis telnet service is used to service remote user connections. Historically, telnet was the most commonly used remote access method for UNIX servers. This has been replaced by OpenSSH (or no remote CLI access).\n\nUnless required the telnetd daemon should be disabled.\n\nImpact:\n\nWhen OpenSSH is not available other steps should be examined, e.g., a bastion hosted environment where OpenSSH is used to get to the bastion host and then telnet from bastion to telnet-only server.",
        "solution": "In /etc/inetd.conf, comment out the telnet entry:\n\nchsubserver -r inetd -C /etc/inetd.conf -d  -v 'telnet' -p 'tcp6'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep telnet | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_105": {
        "description": "4.1.5.29 tftp",
        "info": "This entry starts the tftp service when required.\n\nRationale:\n\nThe tftp service allows remote systems to download or upload files to the tftp server without any authentication. It is therefore a service that should not run, unless needed. One of the main reasons for requiring this service to be activated is if the host is a NIM master. However, the service can be enabled and then disabled once a NIM operation has completed, rather than left running permanently.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'tftp' -p 'udp6'\nrefresh -s inetd\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]tftp\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_106": {
        "description": "4.1.5.30 time",
        "info": "This entry starts the time service when required. This service can be used to synchronize system clocks.\n\nRationale:\n\nThe time service is an obsolete process used to synchronize system clocks at boot time. This has been superseded by NTP, which should be use if time synchronization is necessary. Unless required the time service will be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'tcp'\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'udp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]time\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_107": {
        "description": "4.1.5.31 uucp",
        "info": "This entry starts the uucp service when required. This service facilitates file copying between networked servers.\n\nRationale:\n\nThe uucp (UNIX to UNIX Copy Program), service allows users to copy files between networked machines. Unless an application or process requires UUCP this should be disabled.",
        "solution": "Use chsubserver to disable this service in /etc/inetd.conf:\n\nchsubserver -r inetd -C /etc/inetd.conf -d -v 'uucp' -p 'tcp'\nrefresh -s inetd\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssrc -s inetd -l | /usr/bin/grep \"[[:blank:]]uucp\" | /usr/bin/wc -l",
        "expect": "^0$"
    },
    "custom_item_108": {
        "description": "4.2.1 clean_partial_conns",
        "info": "The clean_partial_conns parameter determines whether or not the system is open to SYN attacks. This parameter, when enabled, clears down connections in the SYN RECEIVED state after a set period of time. This attempts to stop DoS attacks when a hacker may flood a system with SYN flag set packets.\n\nRationale:\n\nThe clean_partial_conns parameter will be set to 1, to clear down pending SYN received connections after a set period of time.",
        "solution": "In /etc/tunables/nextboot, add the clean_partial_conns entry:\n\nno -p -o clean_partial_conns=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep clean_partial_conns",
        "expect": "^[\\\\s]*clean_partial_conns[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_109": {
        "description": "4.2.2 bcastping",
        "info": "The bcastping parameter determines whether the system responds to ICMP echo packets sent to the broadcast address.\n\nRationale:\n\nThe bcastping parameter will be set to 0. This means that the system will not respond to ICMP packets sent to the broadcast address. By default, when this is enabled the system is susceptible to smurf attacks, where a hacker utilizes this tool to send a small number of ICMP echo packets. These packets can generate huge numbers of ICMP echo replies and seriously affect the performance of the targeted host and network. This parameter will be disabled to ensure protection from this type of attack.",
        "solution": "In /etc/tunables/nextboot, add the bcastping entry:\n\nno -p -o bcastping=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep bcastping",
        "expect": "^[\\\\s]*bcastping[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_110": {
        "description": "4.2.3 directed_broadcast",
        "info": "The directed_broadcast parameter determines whether or not the system allows a directed broadcast to a network gateway.\n\nRationale:\n\nThe directed_broadcast parameter will be set to 0, to prevent directed broadcasts being sent network gateways. This would prevent a redirected packet from reaching a remote network.",
        "solution": "In /etc/tunables/nextboot, add the directed_broadcast entry:\n\nno -p -o directed_broadcast=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(9),800-53r5|SC-7(9),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(9),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep directed_broadcast",
        "expect": "^[\\\\s]*directed_broadcast[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_111": {
        "description": "4.2.4 icmpaddressmask",
        "info": "The icmpaddressmask parameter determines whether the system responds to an ICMP address mask ping.\n\nRationale:\n\nThe icmpaddressmask parameter will be set to 0, This means that the system will not respond to ICMP address mask request pings. By default, when this is enabled the system is susceptible to source routing attacks. This is typically a feature performed by a device such as a network router and should not be enabled within the operating system.",
        "solution": "In /etc/tunables/nextboot, add the icmpaddressmask entry:\n\nno -p -o icmpaddressmask=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep icmpaddressmask",
        "expect": "^[\\\\s]*icmpaddressmask[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_112": {
        "description": "4.2.5 ipforwarding",
        "info": "The ipforwarding parameter determines whether or not the system forwards TCP/IP packets.\n\nRationale:\n\nThe ipforwarding parameter will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device.",
        "solution": "In /etc/tunables/nextboot, add the ipforwarding entry:\n\nno -p -o ipforwarding=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipforwarding",
        "expect": "^[\\\\s]*ipforwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_113": {
        "description": "4.2.6 ipignoreredirects",
        "info": "The ipignoreredirects parameter determines whether or not the system will process IP redirects.\n\nRationale:\n\nThe ipignoreredirects will be set to 1, to prevent IP re-directs being processed by the system.",
        "solution": "In /etc/tunables/nextboot, add the ipignoreredirects entry:\n\nno -p -o ipignoreredirects=1\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipignoreredirects",
        "expect": "^[\\\\s]*ipignoreredirects[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_114": {
        "description": "4.2.7 ipsendredirects",
        "info": "The ipsendredirects parameter determines whether or not the system forwards re-directed TCP/IP packets.\n\nRationale:\n\nThe ipsendredirects parameter will be set to 0, to ensure that redirected packets do not reach remote networks.",
        "solution": "In /etc/tunables/nextboot, add the ipsendredirects entry:\n\nno -p -o ipsendredirects=0\n\nThis makes the change permanent by adding the entry into/etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipsendredirects",
        "expect": "^[\\\\s]*ipsendredirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_115": {
        "description": "4.2.8 ipsrcrouteforward",
        "info": "The ipsrcrouteforward parameter determines whether or not the system forwards IPV4 source-routed packets.\n\nRationale:\n\nThe ipsrcrouteforward will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcrouteforward entry:\n\nno -p -o ipsrcrouteforward=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipsrcrouteforward",
        "expect": "^[\\\\s]*ipsrcrouteforward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_116": {
        "description": "4.2.9 ipsrcrouterecv",
        "info": "The ipsrcrouterecv parameter determines whether the system accepts source routed packets.\n\nRationale:\n\nThe ipsrcrouterecv parameter will be set to 0, This means that the system will not accept source routed packets. By default, when this is enabled the system is susceptible to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcrouterecv entry:\n\nno -p -o ipsrcrouterecv=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipsrcrouterecv",
        "expect": "^[\\\\s]*ipsrcrouterecv[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_117": {
        "description": "4.2.10 ipsrcroutesend",
        "info": "The ipsrcroutesend parameter determines whether or not the system can send source-routed packets.\n\nRationale:\n\nThe ipsrcroutesend parameter will be set to 0, to ensure that any local applications cannot send source routed packets.",
        "solution": "In /etc/tunables/nextboot, add the ipsrcroutesend entry:\n\nno -p -o ipsrcroutesend=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ipsrcroutesend",
        "expect": "^[\\\\s]*ipsrcroutesend[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_118": {
        "description": "4.2.11 ip6srcrouteforward",
        "info": "The ip6srcrouteforward parameter determines whether or not the system forwards IPV6 source-routed packets.\n\nRationale:\n\nThe ip6srcrouteforward parameter will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall.",
        "solution": "In /etc/tunables/nextboot, add the ip6srcrouteforward entry:\n\nno -p -o ip6srcrouteforward=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ip6srcrouteforward",
        "expect": "^[\\\\s]*ip6srcrouteforward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_119": {
        "description": "portcheck",
        "cmd": "/usr/sbin/nfso -a | /usr/bin/grep portcheck",
        "expect": "^[\\\\s]*portcheck[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_120": {
        "description": "use_reserved_ports",
        "cmd": "/usr/sbin/nfso -a | /usr/bin/grep nfs_use_reserved_ports",
        "expect": "^[\\\\s]*nfs_use_reserved_ports[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_121": {
        "description": "4.2.13 nonlocsrcroute",
        "info": "The nonlocsrcroute parameter determines whether the system allows source routed packets to be addressed to hosts outside of the LAN.\n\nRationale:\n\nThe nonlocsrcroute parameter will be set to 0. This means that the system will not allow source routed packets to be addressed to hosts outside of the LAN. By default, when this is enabled the system is susceptible to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the nonlocsrcroute entry:\n\nno -p -o nonlocsrcroute=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep nonlocsrcroute",
        "expect": "^[\\\\s]*nonlocsrcroute[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_122": {
        "description": "4.2.14 sockthresh",
        "info": "The sockthresh parameter value determines what percentage of the total memory allocated to networking, set via thewall, can be used for sockets.\n\nRationale:\n\nThe sockthresh parameterwill be set to 60. This means that 60% of network memory can be used to service new socket connections, the remaining 40% is reserved for existing sockets. This ensures a quality of service for existing connections.",
        "solution": "In /etc/tunables/nextboot, add the sockthresh entry:\n\nno -p -o sockthresh=60\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep sockthresh",
        "expect": "^[\\\\s]*sockthresh[\\\\s]*=[\\\\s]*60[\\\\s]*$"
    },
    "custom_item_123": {
        "description": "4.2.15 tcp_pmtu_discover",
        "info": "The tcp_pmtu_discover parameter controls whether TCP MTU discovery is enabled.\n\nRationale:\n\nThe tcp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When tcp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the tcp_pmtu_discover entry:\n\nno -p -o tcp_pmtu_discover=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep tcp_pmtu_discover",
        "expect": "^[\\\\s]*tcp_pmtu_discover[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_124": {
        "description": "4.2.16 tcp_tcpsecure",
        "info": "The tcp_tcpsecure parameter value determines if the system is protected from three specific TCP vulnerabilities: The values are ORed together. If all three values are to be set the value to set is: 1|2|4 (or 7).\n\nFake SYN - This is used to terminate an established connection. A tcp_tcpsecure bit-value of 1 protects the system from this vulnerability.\n\nFake RST - As above, this is used to terminate an established connection. A tcp_tcpsecure bit-value of 2 protects the system from this vulnerability.\n\nFake data - A hacker may inject fake data into an established connection. A tcp_tcpsecure bit-value of 4 protects the system from this vulnerability.\n\nRationale:\n\nThe tcp_tcpsecure parameter should be set to 7. This means that the system will be protected from TCP connection reset and data integrity attacks.",
        "solution": "In /etc/tunables/nextboot, add the tcp_tcpsecure entry:\n\nno -p -o tcp_tcpsecure=7\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot.\n\nDefault Value:\n\ntcp_tcpsecure = 0",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -o tcp_tcpsecure",
        "expect": "^[\\\\s]*tcp_tcpsecure[\\\\s]*=[\\\\s]*7[\\\\s]*$"
    },
    "custom_item_125": {
        "description": "4.2.17 udp_pmtu_discover",
        "info": "The udp_pmtu_discover parameter controls whether MTU discovery is enabled.\n\nRationale:\n\nThe udp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When udp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks.",
        "solution": "In /etc/tunables/nextboot, add the udp_pmtu_discover entry:\n\nno -p -o udp_pmtu_discover=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n1",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep udp_pmtu_discover",
        "expect": "^[\\\\s]*udp_pmtu_discover[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_126": {
        "description": "4.2.18 ip6forwarding",
        "info": "The ip6forwarding parameter determines whether or not the system forwards IPv6 TCP/IP packets.\n\nRationale:\n\nThe ip6forwarding parameter will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device.",
        "solution": "In /etc/tunables/nextboot, add the ip6forwarding entry:\n\nno -p -o ip6forwarding=0\n\nThis makes the change permanent by adding the entry into /etc/tunables/nextboot\n\nDefault Value:\n\n0",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/no -a | /usr/bin/grep ip6forwarding",
        "expect": "^[\\\\s]*ip6forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_127": {
        "description": "v6",
        "cmd": "/usr/sbin/lsdev -C -c ipsec | /usr/bin/grep ipsec_v6 | /usr/bin/awk '{print} END {if (NR == 0) print \"not found\"}'",
        "expect": "^[\\\\s]*ipsec_v6[\\\\s]+Available[\\\\s]+IP[\\\\s]+Version[\\\\s]+6[\\\\s]+Security[\\\\s]+Extension"
    },
    "custom_item_128": {
        "description": "v4",
        "cmd": "/usr/sbin/lsdev -C -c ipsec | /usr/bin/grep ipsec_v4 | /usr/bin/awk '{print} END {if (NR == 0) print \"not found\"}'",
        "expect": "^[\\\\s]*ipsec_v4[\\\\s]+Available[\\\\s]+IP[\\\\s]+Version[\\\\s]+4[\\\\s]+Security[\\\\s]+Extension"
    },
    "custom_item_129": {
        "description": "ipv4",
        "cmd": "/usr/sbin/lsfilt -v 4 -O | /usr/bin/grep 127.0.0.0",
        "expect": "deny.*127\\\\.0\\\\.0\\\\.0.*all"
    },
    "custom_item_130": {
        "description": "ipv6",
        "cmd": "/usr/sbin/lsfilt -v 6 -O | /usr/bin/grep ::1",
        "expect": "deny.*::1.*all"
    },
    "custom_item_131": {
        "description": "ipv4",
        "cmd": "/usr/sbin/lsfilt -v4 -O -a 2>&1 | /usr/bin/grep -E '(inactive|Can not open device)' | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_132": {
        "description": "ipv6",
        "cmd": "/usr/sbin/lsfilt -v6 -O -a 2>&1 | /usr/bin/grep -E '(inactive|Can not open device)' | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_133": {
        "description": "4.5.6 Uninstall snmp",
        "info": "On AIX 7.2 and later, unless otherwise needed - uninstall snmp and snmpd support.\n\nRationale:\n\nImpact:\n\nIf not installed, the rest of the recommendations in this section titled SNMP Configuration may be ignored.",
        "solution": "Execute the following command:\n\ntypeset -i SNMP\nSNMP=$(lslpp -Lcq | grep bos.net.tcp.snmp | wc -l)\nif [[ $SNMP -ne 0 ]]; then\n  installp -ug bos.net.tcp.snmp bos.net.tcp.snmpd\nfi",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "lslpp -Lcq bos.net.tcp.snmp 2>/dev/null\nSNMP=$?\nlslpp -Lcq bos.net.tcp.snmpd 2>/dev/null\nSNMPD=$?\nif [[ ${SNMP} -eq 0 || ${SNMPD} -eq 0 ]]; then\n echo \"SNMP and/or SNMPD support is installed, review section 'SNMP Configuration'\"\nelse\n echo \"SNMP software is not installed, section 'SNMP Configuration' may be ignored\"\nfi",
        "expect": "^SNMP software is not installed, section 'SNMP Configuration' may be ignored"
    },
    "custom_item_134": {
        "description": "4.5.7 Uninstall/Disable sendmail",
        "info": "On AIX, unless otherwise needed - uninstall or disable sendmail support.\n\nALSO: if the version installed does not display support for SASLv2 - remove sendmail on AIX 7.2 and chmod to 0 (zero) otherwise.\n\nRationale:\n\nMaintaining a secure sendmail MTA (mail transfer agent) is a complex process. While, historically, *NIX systems have run a (localhost) MTA (mail transmission agent) or MSP (mail submission program) - there is no real need these days for every system to have this software installed.\n\nNote: Historically, the AIX sendmail build has not supported the AUTH feature. Since AIX 7.2 TL4 a new packaging of sendmail (still as version 8.15.2, so version number is not the way to verify suitability) allows AUTH support indirectly via the SASLv2 (Simple Authentication and Security Layer) API interface. Our recommendation is to disable/remove sendmail programs that do not provide SASLv2 support.\n\nImpact:\n\nIf not installed, the rest of the recommendations in this section titled Sendmail Configuration may be ignored.\n\nApplications configured to speak to a localhost MTA or MSP may fail to send mail. These applications should be (re-)configured to use STARTTLS or SSL and send their mail messages via a hardened MTA host.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lslpp -Lcq | /usr/bin/grep -i 'sendmail' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_135": {
        "description": "4.5.1.1 CDE - de-installing CDE",
        "info": "The recommendation is to de-install CDE aka X11.Dt from the system, assuming that it is not required and is already installed.\n\nRationale:\n\nCDE has a history of security problems and should be disabled.\n\nNOTE: If CDE is required, it is vital to patch the software and consider TCP Wrappers to further enhance security.",
        "solution": "Identity if CDE is already installed:\n\nlslpp -L |grep -i X11.Dt\n\nIf there are CDE filesets installed - de-install them if CDE is not required. For each fileset preview the de-installation:\n\ninstallp -upReview the fileset removal preview output, paying particular attention to the other pre-requisites that will also be removed. Typically only X11.Dt filesets should be de-installed as pre-requisites. Once reviewed, de-install the fileset and pre-requisites:\n\ninstallp -ugNOTE: Repeat until all CDE related filesets are de-installed\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nRe-install the CDE software from the AIX media.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lslpp -L X11.Dt.*",
        "expect": "[\\\\s]*not[\\\\s]+installed\\\\.[\\\\s]*$"
    },
    "custom_item_136": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_137": {
        "description": "dtappgather",
        "file": "/usr/dt/bin/dtappgather",
        "mask": "6000"
    },
    "custom_item_138": {
        "description": "dtprintinfo",
        "file": "/usr/dt/bin/dtprintinfo",
        "mask": "6000"
    },
    "custom_item_139": {
        "description": "dtsession",
        "file": "/usr/dt/bin/dtsession",
        "mask": "6000"
    },
    "custom_item_140": {
        "description": "dtaction",
        "file": "/usr/dt/bin/dtaction",
        "mask": "6000"
    },
    "custom_item_141": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_142": {
        "description": "saverTimeout",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*dtsession[\\\\*]saverTimeout:",
        "expect": "^[\\\\s]*dtsession[\\\\*]saverTimeout:[\\\\s]+([1-9]|10)[\\\\s]*$"
    },
    "custom_item_143": {
        "description": "lockTimeout",
        "file": "/etc/dt/config/*/sys.resources",
        "regex": "^[\\\\s]*dtsession[\\\\*]lockTimeout:",
        "expect": "^[\\\\s]*dtsession[\\\\*]lockTimeout:[\\\\s]+([1-9]|10)[\\\\s]*$"
    },
    "custom_item_144": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_145": {
        "description": "persLabelString",
        "file": "/etc/dt/config/*/Xresources",
        "regex": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]persLabelString:",
        "expect": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]persLabelString:[\\\\s]+@CDE_PERSLABEL_STRING@"
    },
    "custom_item_146": {
        "description": "labelString",
        "file": "/etc/dt/config/*/Xresources",
        "regex": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]labelString:",
        "expect": "^[\\\\s]*Dtlogin[\\\\*]greeting[\\\\.]labelString:[\\\\s]+@CDE_LABEL_STRING@"
    },
    "custom_item_147": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_148": {
        "description": "4.5.1.9 CDE - /etc/dt/config/Xconfig permissions and ownership",
        "info": "The /etc/dt/config/Xconfig file is used to customize CDE DT login attributes. Ensure this file is owned by root:bin and permissions prevent group and other from writing to the file.\n\nRationale:\n\nThe /etc/dt/config/Xconfig file can be used to customize CDE DT login attributes. The default file, /usr/dt/config/Xconfig, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Check to see if the /etc/dt/config/Xconfig exists:\n\nls -l /etc/dt/config/Xconfig\n\nApply the appropriate ownership and permissions to /etc/dt/config/Xconfig:\n\nchown root:bin /etc/dt/config/Xconfig\nchmod go-w /etc/dt/config/Xconfig\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/dt/config/Xconfig",
        "owner": "root",
        "mask": "333",
        "group": "bin"
    },
    "custom_item_149": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_150": {
        "description": "permissions and ownership",
        "file": "/etc/dt/config/Xservers",
        "owner": "root",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_151": {
        "description": "X11",
        "cmd": "/usr/bin/lslpp -L | /usr/bin/grep -i CDE",
        "expect": "^[\\\\s]*X11\\\\.Dt\\\\."
    },
    "custom_item_152": {
        "description": "4.5.1.11 CDE - /etc/dt/config/*/Xresources permissions and ownership",
        "info": "The /etc/dt/config/*/Xresources file contains appearance and behavior resources for the Dtlogin login screen.\n\nRationale:\n\nThe /etc/dt/config/*/Xresources file defines the customization of the Dtlogin screen. The default file, /usr/dt/config/*/Xresources, is unconditionally overwritten upon subsequent installation. It is recommended that the appropriate permissions and ownership are applied to secure the file.",
        "solution": "Set the appropriate permissions and ownership on all Xresources files:\n\nchown root:sys /etc/dt/config/*/Xresources\nchmod u=rw,go=r /etc/dt/config/*/Xresources\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/dt/config/*/Xresources",
        "owner": "root",
        "mask": "133",
        "group": "sys"
    },
    "custom_item_153": {
        "description": "4.5.2.1 FTPD: Disable root access to ftpd",
        "info": "This change adds the root user to the /etc/ftpusers file, which disables ftp for root.\n\nRationale:\n\nThis change ensures that direct root ftp access is disabled. As detailed previously, ftp as a service should be disabled. If the service has to be enabled then this change must be implemented to ensure that remote root file transfer access is not enabled.",
        "solution": "Add root to the /etc/ftpusers file:\n\necho 'root' >> /etc/ftpusers\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ftpusers",
        "regex": "^root$",
        "expect": "^root$"
    },
    "custom_item_154": {
        "description": "4.5.2.2 FTPD: Display acceptable usage policy during login",
        "file": "/etc/inetd.conf",
        "regex": "^ftp[\\\\s]+",
        "expect": "^ftp[\\\\s]+"
    },
    "custom_item_155": {
        "description": "4.5.2.2 FTPD: Display acceptable usage policy during login",
        "info": "Set an ftpd login banner which displays the acceptable usage policy.\n\nRationale:\n\nThe message in banner.msg is displayed for FTP logins. Banners display necessary warnings to users trying to gain unauthorized access to the system and are required for legal purposes. The recommendation is to set the banner as:\n\n'Authorized uses only. All activity will be monitored and reported'.\n\nThe content may be changed to reflect any corporate AUP.",
        "solution": "Ensure that the bos.msg.en_US.net.tcp.client fileset is installed:\n\nlslpp -L 'bos.msg.en_US.net.tcp.client'\n\nNOTE: If the fileset is not installed, install it from the AIX media or another software repository. The fileset should reflect the language used on the server.\nOnce installed set the ftp AUP banner:\n\ndspcat -g /usr/lib/nls/msg/en_US/ftpd.cat > /tmp/ftpd.tmp\nsed 's/\\'\\%s FTP server (\\%s) ready.\\'/\\'\\%s Authorized uses only. All activity may be monitored and reported\\'/' /tmp/ftpd.tmp > /tmp/ftpd.msg\ngencat /usr/lib/nls/msg/en_US/ftpd.cat /tmp/ftpd.msg\nrm /tmp/ftpd.tmp /tmp/ftpd.msg\n\nDefault Value:\n\n%s FTP server (%s) ready.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/dspcat /usr/lib/nls/msg/en_US/ftpd.cat 1 9 | awk '{ print } END { if (NR==0) print \"blank\" }'",
        "expect": "@FTP_LOGIN_TEXT@"
    },
    "custom_item_156": {
        "description": "4.5.2.3 FTPD: Prevent world access and group write to files",
        "info": "The umask of the ftpd service should be set to at least 027 in order to prevent the FTP daemon process from creating world-accessable, group-writeable files by default.\n\nRationale:\n\nThe umask of the ftpd service should be set to at least 027 in order to prevent the FTP daemon process from creating world-accessable and group-writeable files by default. These files could then be transferred over the network which could result in compromise of the critical information.",
        "solution": "Set the default umask of the ftp daemon:\n\n[[ $(grep -c '^ftp[[:blank:]]' /etc/inetd.conf) -gt 0 ]] && chsubserver -c -v ftp -p tcp 'ftpd -l -u 027' && refresh -s inetd || RC=0'\n\nNOTE: The umask above restricts write permissions for both group and other. All access for other is removed.\n\nDefault Value:\n\n/usr/sbin/ftpd ftpd -l",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/inetd.conf",
        "regex": "^ftp[\\\\s]+",
        "expect": "^ftp[\\\\s]+.+/usr/sbin/ftpd.+-u[\\\\s]*[0-7][2-7]7"
    },
    "custom_item_157": {
        "description": "8.1.1 Configuring syslog - local logging",
        "info": "This recommendation implements a local syslog configuration.\n\nRationale:\n\nEstablishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date.\n\nImpact:\n\nThis recommendation is manual because there are likely local requirements that surpass the basic recommendation here.\n\nNOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.",
        "solution": "Explicitly define a log file for the auth.info output in /etc/syslog.conf:\n\nprintf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nNOTE: This ensures that remote login, sudo or su attempts are logged separately\nCreate the authlog file and make it readable by root only:\n\ntouch /var/adm/authlog\nchown root:system /var/adm/authlog\nchmod u=rw,go= /var/adm/authlog\n\nCreate an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog:\n\nprintf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4\\n' >> /etc/syslog.conf\n\nCreate the syslog file:\n\ntouch /var/adm/syslog\nchmod u=rw,g=r,o= /var/adm/syslog\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDefault Value:\n\nNot configured\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/syslog.conf and remove the authlog and syslog entries:\n\nvi /etc/syslog.conf\n\nRemove:\n\nauth.info               /var/adm/authlog rotate time 1w files 4\n\n*.info;auth.none        /var/adm/syslog rotate time 1w files 4\n\nRefresh syslogd to force the daemon to read the edited /etc/syslog.conf:\n\nrefresh -s syslogd\n\nDelete the authlog and syslog files:\n\nrm /var/adm/authlog /var/adm/syslog",
        "reference": "800-171|3.3.8,800-53|AU-9(2),800-53r5|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(2),LEVEL|1M,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.2.1|10.5.3,PCI-DSSv3.2.1|10.5.4,PCI-DSSv4.0|10.3.3,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /var/adm/cron/cron.allow",
        "file": "/etc/inetd.conf",
        "regex": "^ftp[\\\\s]+",
        "expect": "^Manual Review Required$",
        "content": "@LOGIN_HERALD_TEXT@",
        "owner": "root",
        "mask": "137",
        "group": "system",
        "timeout": "@FIND_TIMEOUT@",
        "system": "AIX",
        "name": "find_suid_sgid_files",
        "NOdescription": "4.7.2.2 Verify Trust of suid, sgid, acl, and trusted-bit files and programs",
        "basedir": "/",
        "YESdescription": "5.1.5 Establish and Maintain an Inventory of Administrator accounts",
        "MEDIUMdescription": "7.2 Use FLRTVC regularly"
    },
    "custom_item_158": {
        "description": "rhosts",
        "file": "/etc/rhosts.equiv"
    },
    "custom_item_159": {
        "description": "shosts",
        "file": "/etc/shosts.equiv"
    },
    "custom_item_160": {
        "description": "4.5.3.3 OpenSSH: Remove .shosts files",
        "info": "The recommendation is to remove any existing .shosts files from all user home directories.\n\nRationale:\n\nThe existence of .shosts files in a user home directory, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method, these files, if they exist, should be removed.",
        "solution": "List out all of the existing .shost files:\n\nfind / -name '.shosts' -print\n\nReview the list of .shost files and remove them individually, or all at once:\nIndividually:\n\nrmAll at once:\n\nfind / -name '.shosts' -exec rm {} \\;\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nAny deleted files would need to be restored from a backup.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "~/.shosts"
    },
    "custom_item_161": {
        "description": "4.5.3.4 sshd_config: Restrict users and groups allowed access via OpenSSH",
        "info": "There are multiple options available to regulate access to a server via OpenSSH. At least of the following options should be implemented. Note: The allow/deny users directives are processed in the following order: DenyUsers, AllowUsers. The allow/deny groups directives are processed in the following order: DenyGroups, AllowGroups. Note: If a DenyUser or DenyGroup matches the associated Allow directive is not processed. To implement DenyAll except use only Allow* directives. To implement PermitALL except use only Deny* directives. It is advised not to combine Allow and Deny directives as this can make the configuration harder to debug.\n\nDenyUsers: The DenyUsers variable specifies user names not permitted to access the system via sshd. The definition is a list username pattern(s) separated by spaces. Numeric userIDs are not are not allowed (recognized). Patterns can be narrowed to restrict access from specific hosts using the form username@host.\n\nAllowUsers: The AllowUsers variable specifies user names permitted to access the system via sshd. The definition is a list username pattern(s) separated by spaces. Numeric userIDs are not are not allowed (recognized). Patterns can be narrowed to permit access only from specific host(s) using the form username@host.\n\nDenyGroups: The DenyGroups variable specifies group names not permitted to access the system via sshd. The definition is a list groupname pattern(s) separated by spaces. Numeric groupIDs are not allowed (recognized). Login is disallowed for users whose primary group or supplementary group list matches one of the patterns.\n\nAllowGroups: The AllowGroups variable specifies group names permitted to access the system via sshd. The definition is a list groupname pattern(s) separated by spaces. Numeric groupIDs are not allowed (recognized). Login is allowed for users whose primary group or supplementary group list matches one of the patterns.\n\nRationale:\n\nBy default, login is allowed for all users and all groups.\n\nRestricting which users can access the system via OpenSSH will help ensure that only authorized users access the system.\n\nImpact:\n\nWhen implemented - no longer can any user connect from any host. They must satisfy the connection requirements.\n\nNote: your organization may already have a OpenSSH restricted access model as this recommendation is already Level 1 for Linux* benchmarks.",
        "solution": "Edit the /etc/ssh/sshd_config file to set one (or more) of the following parameters:\n\nAllowUsersAllowGroupsDenyUsersDenyGroupsRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nAll users from any host are permitted.\n\nAdditional Information:\n\nSubsequent releases of AIX benchmarks are expected to have this recommendation scored at Level 1",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)(Allow|Deny)(Users|Groups)(?-i)[\\\\s]",
        "expect": "^[\\\\s]*(?i)(Allow|Deny)(Users|Groups)(?-i)[\\\\s]"
    },
    "custom_item_162": {
        "description": "banner_text",
        "file": "@BANNER_FILE@",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_163": {
        "description": "sshd_config",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*Banner[\\\\s]*",
        "expect": "^[\\\\s]*Banner[\\\\s]*@BANNER_FILE@[\\\\s]*$"
    },
    "custom_item_164": {
        "description": "4.5.3.7 sshd_config: HostbasedAuthentication is 'no'",
        "info": "The recommendation is to ensure the sshd daemon is configured to prevent host-based authentication.\n\nRationale:\n\nHost-based authentication is a method to authenticate users (rather than requiring password or key-based authentication method). Used at a system level by OpenSSH requires the file /etc/shosts.equiv to contain a list of so-called trusted hosts. When this method is active any user on a trusted host can login to the server as authenticated because the server identity the user imitates the connection from (aka the OpenSSH client) authentificatees the user as trusted.\n\nSince this feature disables user-based authentication from some hosts - our recommendation is to disable host-based authentication.",
        "solution": "Edit the /etc/ssh/sshd_config file to ensure that host based authentication is disallowed:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#HostbasedAuthentication no\n\nWith:\n\nHostbasedAuthentication no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nHostbasedAuthentication no\n\nAdditional Information:\n\nReversion:\n\nRevert to the default setting for the HostBasedAuthentication parameter:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\nHostbasedAuthentication no\n\nWith:\n\n# HostbasedAuthentication no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\n\nstartsrc -s sshd",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-6,800-53|CM-7,800-53|MA-4,800-53r5|CM-6,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*HostbasedAuthentication[\\\\s]+no[\\\\s]*$",
        "expect": "^[\\\\s]*HostbasedAuthentication[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_165": {
        "description": "4.5.3.8 sshd_config: IgnoreRhosts is 'yes' or 'shosts-only'",
        "info": "The IgnoreRhosts parameter controls whether .rhosts and .shosts files will be used in RhostsRSAAuthentication or HostbasedAuthentication.\n\nRationale:\n\nA user can logon to a remote system without authenticating themselves if .rhosts or .shosts files exist in the remote home directory and if the client machine name and user name are present in these files.\n\nThis method presents a risk as the system could be exploited by IP, DNS (Domain Name Server) and routing spoofing attacks. Additionally, this authentication method relies on the integrity of the client machine.\n\nThese weaknesses are well known and have been exploited. Since this authentication method entails a risk the primary recommendation is to disable the method (setting is yes). Only with documented cases - including steps to mitigate the accepted risk - may shosts mechanism be activated.\n\nImpact:\n\nThe title of this recommendation implies acceptance of shosts-only. This is only expected for particular hosts.\n\nFurther, the addition of shosts-only requires OpenSSH 8.2 and later.\n\nSince AIX is currently operating with OpenSSH 8.1 the audit and remediation paragraphs are written to implement the preferred setting - yes IgnoreRhosts in any form.",
        "solution": "Edit the /etc/ssh/sshd_config file to disable the .shosts and .rhosts authentication parameter:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#IgnoreRhosts yes\n\nWith:\n\nIgnoreRhosts yes\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nIgnoreRhosts yes",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-6,800-53|CM-7,800-53|MA-4,800-53r5|CM-6,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*IgnoreRhosts[\\\\s]+yes[\\\\s]*$",
        "expect": "^[\\\\s]*IgnoreRhosts[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_166": {
        "description": "4.5.3.9 sshd_config: PermitEmptyPasswords is 'no'",
        "info": "The recommendation is to edit the /etc/ssh/sshd_config file to ensure that the SSH daemon does not authenticate users with a null password.\n\nRationale:\n\nIf password authentication is used and an account has an empty password, the SSH server must be configured to disallow access to the account. Permitting empty passwords could create an easy path of access for hackers to enter the system.",
        "solution": "Edit the /etc/ssh/sshd_config file to disable the acceptance null passwords:\n\nvi /etc/ssh/sshd_config\n\nReplace:\n\n#PermitEmptyPasswords no\n\nWith:\n\nPermitEmptyPasswords no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nPermitEmptyPasswords no",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*PermitEmptyPasswords[\\\\s]+no[\\\\s]*$",
        "expect": "^[\\\\s]*PermitEmptyPasswords[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_167": {
        "description": "4.5.3.10 sshd_config: LogLevel is 'INFO' or 'VERBOSE'",
        "info": "The INFO parameter specifies that record login and logout activity will be logged. While this is the default setting for OpenSSH we believe it is better to explicity set the value in the configuration file.\n\nRationale:\n\nSSH provides several logging levels with varying amounts of verbosity.\n\n          LogLevel\n\n               Gives the verbosity level that is used when logging\n\n               messages from sshd(8).  The possible values are:\n\n               QUIET, FATAL, ERROR, INFO, VERBOSE, DEBUG, DEBUG1,\n\n               DEBUG2, and DEBUG3.  The default is INFO.  DEBUG and\n\n               DEBUG1 are equivalent.  DEBUG2 and DEBUG3 each specify\n\n               higher levels of debugging output.  Logging with a\n\n               DEBUG level violates the privacy of users and is not\n\n               recommended.\n\nDEBUG (and VERBOSE) is specifically not recommended other than strictly for debugging SSH communications. INFO level is the default level and records login/logout activity of SSH users. Login information includes the fingerprint of their SSH keys, when used.\n\nIn situations, such as Incident Response, an SSH fingerprint may be important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.\n\nNote: the default action of OpenSSH is to propagate this key for every ssh login.",
        "solution": "Edit the /etc/ssh/sshd_config:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nLogLevel INFO\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 2\nstartsrc -s sshd\n\nDefault Value:\n\n#LogLevel INFO",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*LogLevel[\\\\s]+",
        "expect": "^[\\\\s]*LogLevel[\\\\s]+(INFO|VERBOSE)[\\\\s]*$"
    },
    "custom_item_168": {
        "description": "4.5.3.11 sshd_config: sftp-server arguments include '-u 027 -f AUTH -l INFO'",
        "info": "The sftp-server is started by the sshd server after authentication has been completed successfully. The process runs with the euid of the authenticated user.\n\nRationale:\n\nSSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.\n\nLike sshd (see Recommendation: OpenSSH: LogLevel) the sftp-server needs to be configured with syslog information. Additionally, the umask value needs specification.",
        "solution": "Edit the /etc/ssh/sshd_config:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nSubsystem sftp /usr/sbin/sftp-server -u 027 -f AUTH -l VERBOSE\n\nor\n\nSubsystem sftp /usr/sbin/sftp-server -u 027 -f AUTH -l DEBUG\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nsleep 5\nstartsrc -s sshd",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*Subsystem[\\\\s]+sftp[\\\\s]+/usr/sbin/sftp-server[\\\\s]+-u[\\\\s]+027[\\\\s]+-f[\\\\s]+AUTH[\\\\s]+-l[\\\\s]+(INFO|DEBUG)[\\\\s]*$",
        "expect": "^[\\\\s]*Subsystem[\\\\s]+sftp[\\\\s]+/usr/sbin/sftp-server[\\\\s]+-u[\\\\s]+027[\\\\s]+-f[\\\\s]+AUTH[\\\\s]+-l[\\\\s]+(INFO|DEBUG)[\\\\s]*$"
    },
    "custom_item_169": {
        "description": "4.5.3.12 sshd_config: MaxAuthTries is '4'",
        "info": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.\n\nRationale:\n\nSetting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.",
        "solution": "Edit the/etc/ssh/sshd_config file to set the parameter as follows::\n\nMaxAuthTries 4\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*MaxAuthTries",
        "expect": "^[\\\\s]*MaxAuthTries[\\\\s]+[1-4][\\\\s]*$"
    },
    "custom_item_170": {
        "description": "4.5.3.13 sshd_config: PermitUserEnvironment is 'no'",
        "info": "The PermitUserEnvironment option allows users to present environment options to the ssh daemon.\n\nRationale:\n\nPermitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing trojan'd programs).\n\nImpact:\n\nThe general condition is to specify no while the recommendation leaves room for specific User(s) or Group(s) to use this feature in controlled ways.",
        "solution": "Edit the/etc/ssh/sshd_config file:\n\nvi /etc/ssh/sshd_config\n\nSet:\n\nPermitUserEnvironment no\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*PermitUserEnvironment[\\\\s]+no[\\\\s]*$",
        "expect": "^[\\\\s]*PermitUserEnvironment[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_171": {
        "description": "4.5.3.15 sshd_config, ssh_config: KexAlgorithms",
        "info": "Key exchange is any method in cryptography by which cryptographic keys are exchanged between two parties, allowing use of a cryptographic algorithm. If the sender and receiver wish to exchange encrypted messages, each must be equipped to encrypt messages to be sent and decrypt messages received\n\nNotes:\n\nKex algorithms have a higher preference the earlier they appear in the list\n\nSome organizations may have stricter requirements for approved Key exchange algorithms\n\nEnsure that Key exchange algorithms used are in compliance with site policy\n\nThe only Key Exchange Algorithms currently FIPS 140-2 approved are: - ecdh-sha2-nistp256 - ecdh-sha2-nistp384 - ecdh-sha2-nistp521 - diffie-hellman-group-exchange-sha256 - diffie-hellman-group16-sha512 - diffie-hellman-group18-sha512 - diffie-hellman-group14-sha256\n\nThe Key Exchange algorithms supported by OpenSSH 8.2 are:\n\ncurve25519-sha256\n\ncurve25519-sha256@libssh.org\n\ndiffie-hellman-group1-sha1\n\ndiffie-hellman-group14-sha1\n\ndiffie-hellman-group14-sha256\n\ndiffie-hellman-group16-sha512\n\ndiffie-hellman-group18-sha512\n\ndiffie-hellman-group-exchange-sha1\n\ndiffie-hellman-group-exchange-sha256\n\necdh-sha2-nistp256\n\necdh-sha2-nistp384\n\necdh-sha2-nistp521\n\nsntrup4591761x25519-sha512@tinyssh.org\n\nRationale:\n\nKey exchange methods that are considered weak should be removed. A key exchange method may be weak because too few bits are used, or the hashing algorithm is considered too weak. Using weak algorithms could expose connections to man-in-the-middle attacks\n\nImpact:\n\nWeak clients no longer connect.",
        "solution": "Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to contain a comma separated list of the site approved key exchange algorithms\nExample:\n\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\n\nDefault Value:\n\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256",
        "reference": "800-171|3.1.13,800-171|3.4.6,800-171|3.4.7,800-171|3.5.2,800-171|3.7.5,800-171|3.13.8,800-53|AC-17(2),800-53|CM-7,800-53|IA-5,800-53|IA-5(1),800-53|MA-4,800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|CM-7,800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|MA-4,800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|9.2,CSCv7|16.4,CSCv8|3.10,CSCv8|4.6,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|CM-7,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|MA-4,ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T2.3.4,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS15a,NIAv2|SS24,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh\n  {\n  ports=$(/usr/bin/awk '/^Port / { print $2 } /^Match (.* )?LocalPort / { for(x=2; x<=NF; x+=2) if ($x == \"LocalPort\") print $(x+1) }' /etc/ssh/sshd_config | /usr/bin/awk '{print $0}; END {if (NR == 0) print \"22\"}' | uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/usr/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/usr/bin/grep -i kexalgorithms)\"; done | /usr/bin/grep -E \"(.*?)(diffie-hellman-group1-sha1|diffie-hellman-group14-sha1|diffie-hellman-group-exchange-sha1)\" | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"; else print \"fail\"}'\n  }",
        "expect": "^pass$"
    },
    "custom_item_172": {
        "description": "4.5.3.16 sshd_config, ssh_config: Ciphers",
        "info": "This variable limits the ciphers that SSH can use during communication.\n\nNotes:\n\nSome organizations may have stricter requirements for approved ciphers\n\nEnsure that ciphers used are in compliance with site policy\n\nThe only 'strong' ciphers currently FIPS 140-2 compliant are: - aes256-ctr - aes192-ctr - aes128-ctr\n\nSupported ciphers in OpenSSH 8.2:\n\n3des-cbc\n\naes128-cbc\n\naes192-cbc\n\naes256-cbc\n\naes128-ctr\n\naes192-ctr\n\naes256-ctr\n\naes128-gcm@openssh.com\n\naes256-gcm@openssh.com\n\nchacha20-poly1305@openssh.com\n\nRationale:\n\nWeak ciphers that are used for authentication to the cryptographic module cannot be relied upon to provide confidentiality or integrity, and system data may be compromised\n\nResearch conducted at various institutions determined that the symmetric portion of the SSH Transport Protocol (as described in RFC 4253) has security weaknesses that allowed recovery of up to 32 bits of plaintext from a block of ciphertext that was encrypted with the Cipher Block Chaining (CBD) method. From that research, new Counter mode algorithms (as described in RFC4344) were designed that are not vulnerable to these types of attacks and these algorithms are now recommended for standard use.\n\nThe Triple DES ciphers, as used in SSH, have a birthday bound of approximately four billion blocks, which makes it easier for remote attackers to obtain cleartext data via a birthday attack against a long-duration encrypted session, aka a 'Sweet32' attack\n\nError handling in the SSH protocol; Client and Server, when using a block cipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for remote attackers to recover certain plaintext data from an arbitrary block of ciphertext in an SSH session via unknown vectors",
        "solution": "Edit the /etc/ssh/sshd_config file and add/modify the Ciphers line to contain a comma separated list of the site approved ciphers.\nExample\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nRe-cycle the sshd daemon to pick up the configuration changes:\n\nstopsrc -s sshd\nstartsrc -s sshd\n\nDefault Value:\n\nAIX with OpenSSH 8.1\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh\n  {\n  ports=$(/usr/bin/awk '/^Port / { print $2 } /^Match (.* )?LocalPort / { for(x=2; x<=NF; x+=2) if ($x == \"LocalPort\") print $(x+1) }' /etc/ssh/sshd_config | /usr/bin/awk '{print $0}; END {if (NR == 0) print \"22\"}' | uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/usr/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/usr/bin/grep -i ciphers)\"; done | /usr/bin/grep -E \"(3des-cbc|aes128-cbc|aes192-cbc|aes256-cbc|arcfour|arcfour128|arcfour256|blowfish-cbc|cast128-cbc|rijndael-cbc@lysator\\\\.liu\\\\.se)\" | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"; else print \"fail\"}'\n  }",
        "expect": "^pass$"
    },
    "custom_item_173": {
        "description": "4.5.3.17 sshd_config, ssh_config: MACs - Message Authtification Codes",
        "info": "This variable limits the types of MAC algorithms that SSH can use during communication.\n\nNotes:\n\nSome organizations may have stricter requirements for approved MACs\n\nEnsure that MACs used are in compliance with site policy\n\nThe only 'strong' MACs currently FIPS 140-2 approved are:\n\nhmac-sha2-256\n\nhmac-sha2-512\n\nThe Supported MACs are:\n\nhmac-md5\n\nhmac-md5-96\n\nhmac-sha1\n\nhmac-sha1-96\n\nhmac-sha2-256\n\nhmac-sha2-512\n\numac-64@openssh.com\n\numac-128@openssh.com\n\nhmac-md5-etm@openssh.com\n\nhmac-md5-96-etm@openssh.com\n\nhmac-sha1-etm@openssh.com\n\nhmac-sha1-96-etm@openssh.com\n\nhmac-sha2-256-etm@openssh.com\n\nhmac-sha2-512-etm@openssh.com\n\numac-64-etm@openssh.com\n\numac-128-etm@openssh.com\n\nRationale:\n\nClients that expect the weak MACs will often use/expect weak encryption keys as well.\n\nLike CipherKeys the sshd MACs need to be configured to exclude weak message authentication codes.\n\nMD5 and 96-bit MAC algorithms are considered weak and have been shown to increase exploit-ability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algorithm could take advantage of a MiTM (man in the middle) position to decrypt the SSH tunnel and capture credentials and information\n\nImpact:\n\nWeak clients will not connect and/or lose the ability to connect.",
        "solution": "Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma separated list of the site approved MACs\nExample:\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n\nDefault Value:\n\nMACs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1",
        "reference": "800-171|3.1.13,800-171|3.4.6,800-171|3.4.7,800-171|3.5.2,800-171|3.7.5,800-171|3.13.8,800-53|AC-17(2),800-53|CM-7,800-53|IA-5,800-53|IA-5(1),800-53|MA-4,800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|CM-7,800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|MA-4,800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|9.2,CSCv7|14.4,CSCv7|16.5,CSCv7|18.4,CSCv7|18.5,CSCv8|3.10,CSCv8|4.6,CSCv8|16.5,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|CM-7,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|MA-4,ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T2.3.4,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS15a,NIAv2|SS24,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh\n  {\n  ports=$(/usr/bin/awk '/^Port / { print $2 } /^Match (.* )?LocalPort / { for(x=2; x<=NF; x+=2) if ($x == \"LocalPort\") print $(x+1) }' /etc/ssh/sshd_config | /usr/bin/awk '{print $0}; END {if (NR == 0) print \"22\"}' | uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/usr/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/usr/bin/grep -i MACs)\"; done | /usr/bin/grep -E \"(hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1|hmac-sha1-96|umac-64@openssh\\\\.com|umac-128@openssh\\\\.com|hmac-md5-etm@openssh\\\\.com|hmac-md5-96-etm@openssh\\\\.com|hmac-ripemd160-etm@openssh\\\\.com|hmac-sha1-etm@openssh\\\\.com|hmac-sha1-96-etm@openssh\\\\.com|umac-64-etm@openssh\\\\.com|umac-128-etm@openssh\\\\.com)\" | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"; else print \"fail\"}'\n  }",
        "expect": "^pass$"
    },
    "custom_item_174": {
        "description": "4.5.3.18 sshd_config, ssh_config: ReKeyLimit",
        "info": "This variable specifies the maximum amount of data that may be transmitted before the session key is renegotiated, optionally followed by a maximum amount of time that may pass before the session key is renegotiated.\n\nRationale:\n\nThis recommendation is based on the guidelines outlined in Chapter 9 in [RFC4253], i.e. the recommendation is to release/renew Session keys after one hour or after the transfer of one gigabyte (depending on whichever comes first).",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nRekeyLimit 1G 3600\n\nDefault Value:\n\nRekeyLimit default None",
        "reference": "800-171|3.1.13,800-171|3.4.6,800-171|3.4.7,800-171|3.5.2,800-171|3.7.5,800-171|3.13.8,800-53|AC-17(2),800-53|CM-7,800-53|IA-5,800-53|IA-5(1),800-53|MA-4,800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|CM-7,800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|MA-4,800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|9.2,CSCv7|14.4,CSCv8|3.10,CSCv8|4.6,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|CM-7,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|MA-4,ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T2.3.4,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS15a,NIAv2|SS24,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh\n  {\n  ports=$(/usr/bin/awk '/^Port / { print $2 } /^Match (.* )?LocalPort / { for(x=2; x<=NF; x+=2) if ($x == \"LocalPort\") print $(x+1) }' /etc/ssh/sshd_config | /usr/bin/awk '{print $0}; END {if (NR == 0) print \"22\"}' | uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/usr/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/usr/bin/grep -i rekeylimit)\"; done | /usr/bin/grep -E \"(.*?)(1G|1073741824)[[:blank:]]+3600[[:blank:]]*\" | /usr/bin/awk '{print} END {if (NR != 0) print \"pass\"; else print \"fail\"}'\n  }",
        "expect": "^pass$"
    },
    "custom_item_175": {
        "description": "SmtpGreetingMessage",
        "file": "/etc/mail/sendmail.cf",
        "regex": "^[^#\\\\n]*SmtpGreetingMessage",
        "expect": "^[\\\\s]*O[\\\\s]+SmtpGreetingMessage[\\\\s]*=[\\\\s]*mailerready[\\\\s]*$"
    },
    "custom_item_176": {
        "description": "helpfile",
        "file": "/etc/mail/helpfile"
    },
    "custom_item_177": {
        "description": "PrivacyOptions - authwarnings",
        "file": "/etc/mail/sendmail.cf",
        "regex": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=",
        "expect": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=[\\\\s]*.*authwarnings"
    },
    "custom_item_178": {
        "description": "PrivacyOptions - noexpn",
        "file": "/etc/mail/sendmail.cf",
        "regex": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=",
        "expect": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=[\\\\s]*.*noexpn"
    },
    "custom_item_179": {
        "description": "PrivacyOptions - novrfy",
        "file": "/etc/mail/sendmail.cf",
        "regex": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=",
        "expect": "^[\\\\s]*O[\\\\s]PrivacyOptions[\\\\s]*=[\\\\s]*.*novrfy"
    },
    "custom_item_180": {
        "description": "4.5.4.3 /etc/mail/sendmail.cf - DaemonPortOptions",
        "info": "The recommendation is to enable running sendmail in MTA mode to support local applications that require legacy MTA (i.e., connection via port 25) support.\n\nRecall the preferred recommendation is to not run sendmail locally.\n\nRationale:",
        "solution": "Create a backup copy of /etc/mail/sendmail.cf:\n\ncp -p /etc/mail/sendmail.cf /etc/mail/sendmail.cf.pre_cis\n\nEdit:\n\nvi /etc/mail/sendmail.cf\n\nReplace: (assuming the default configuration)\n\nO DaemonPortOptions=Name=MTA\n\nwith\n\nO DaemonPortOptions=Name=MTA,Addr=localhost\n\nAdditional Information:\n\nReversion:\n\nCopy back the original /etc/sendmail.cf file:\n\ncp -p /etc/mail/sendmail.cf.pre_cis /etc/mail/sendmail.cf",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/mail/sendmail.cf",
        "regex": "^O[\\\\s]*DaemonPortOptions[\\\\s]*=",
        "expect": "^O[\\\\s]*DaemonPortOptions[\\\\s]*=[\\\\s]*.*[\\\\s]*Addr=(127\\\\.0\\\\.0\\\\.1|localhost)[\\\\s]*"
    },
    "custom_item_181": {
        "description": "4.5.4.4 /etc/mail/sendmail.cf - access control",
        "info": "The access controls for /etc/mail/sendmail.cf are applied.\n\nRationale:\n\nThe /etc/mail/sendmail.cf file is used by the sendmail daemon to determine its default configuration. This file must be protected from unauthorized access and modifications.",
        "solution": "Set the recommended permissions and ownership on /etc/mail/sendmail.cf:\n\nchmod u=rw,g=r,o= /etc/mail/sendmail.cf\nchown root.system /etc/mail/sendmail.cf\ntrustchk -u /etc/mail/sendmail.cf mode owner group\n\nDefault Value:\n\n-rw-r--r-- root system sendmail.cf",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/mail/sendmail.cf",
        "owner": "root",
        "mask": "137",
        "group": "system"
    },
    "custom_item_182": {
        "description": "4.5.4.5 /var/spool/clientmqueue - access control",
        "info": "The recommended DAC (discretionary access control) settings for the /var/spool/clientmqueue directory are applied.\n\nRationale:\n\nQueued messages are the messages that have not yet reached their final destination. To ensure the integrity of the messages during storage, the mail queue directory must be secured from unauthorized access. The clientmqueue (/var/spool/clientmqueue) is the mail queue for handling locally generated outbound emails. This queue is used when mail is submitted to sendmail as an MSP rather than as an MTA.\n\nNOTE: It is possible to specify an alternate spool directory in the /etc/mail/submit.cf file via the QueueDirectory parameter. When this is used that directory name needs identical DAC settings.",
        "solution": "Set the recommended permissions and ownership on /var/spool/mqueue:\n\nchmod ug=rwx,o=   /var/spool/clientmqueue\nchown smmsp.smmsp /var/spool/clientmqueue\n\nDefault Value:\n\ndrwxrwx---    smmsp    smmsp           /var/spool/clientmqueue",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/spool/clientmqueue",
        "owner": "smmsp",
        "mask": "007",
        "group": "smmsp"
    },
    "custom_item_183": {
        "description": "4.5.4.6 /var/spool/mqueue - access control",
        "info": "The recommended DAC (discretionary access control) settings for the /var/spool/mqueue directory are applied.\n\nRationale:\n\nThe sendmail daemon stores its queued mail in the /var/spool/mqueue directory. Queued messages are the messages that have not yet reached their final destination. To ensure the integrity of the messages during storage, the mail queue directory must be secured from unauthorized access.\n\nNOTE: It is possible to specify an alternate spool directory in the /etc/mail/sendmail.cf file via the QueueDirectory parameter. When this is used that directory name needs identical DAC settings.",
        "solution": "Set the recommended permissions and ownership on /var/spool/mqueue:\n\nchmod u=rwx,go= /var/spool/mqueue\nchown root /var/spool/mqueue\n\nDefault Value:\n\ndrwxrwx---    root     system          /var/spool/mqueue",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/spool/mqueue",
        "owner": "root",
        "mask": "077",
        "group": "system"
    },
    "custom_item_184": {
        "description": "4.6.1 /etc/security/login.cfg - logintimeout",
        "info": "Defines the number of seconds during which the password must be typed at login.\n\nRationale:\n\nIn setting the logintimeout attribute, a password must be entered within a specified time period.",
        "solution": "In /etc/security/login.cfg, set the usw stanza logintimeout attribute to 30 or less:\n\nchsec -f /etc/security/login.cfg -s usw -a logintimeout=30\n\nThis means that a user will have 30 seconds, from prompting, in which to type in their password.\n\nDefault Value:\n\n60",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,LEVEL|1A,NIAv2|NS49",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s usw -a logintimeout",
        "expect": "^usw[\\\\s]+logintimeout[\\\\s]*=[\\\\s]*([1-9]|[12][0-9]|30)[\\\\s]*$"
    },
    "custom_item_185": {
        "description": "4.6.2 /etc/security/login.cfg - logindelay",
        "info": "Defines the number of seconds delay between each failed login attempt. This works as a multiplier, so if the parameter is set to 10, after the first failed login it would delay for 10 seconds, after the second failed login 20 seconds etc.\n\nRationale:\n\nIn setting the logindelay attribute, this implements a delay multiplier in-between unsuccessful login attempts.",
        "solution": "In /etc/security/login.cfg, set the default stanza logindelay attribute to 10 or greater:\n\nchsec -f /etc/security/login.cfg -s default -a logindelay=10\n\nThis means that a user will have to wait 10 seconds before being able to re-enter their password. During subsequent attempts this delay will increase as a multiplier of (the number of failed login attempts * logindelay)\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,LEVEL|1A,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s default -a logindelay",
        "expect": "^default[\\\\s]+logindelay[\\\\s]*=[\\\\s]*[1-9][0-9]+[\\\\s]*$"
    },
    "custom_item_186": {
        "description": "4.6.3 herald (logon message)",
        "info": "This change adds a default herald to /etc/security/login.cfg.\n\nRationale:\n\nThis change puts into place a suggested login herald to replace the default entry. A herald should not provide any information about the operating system or version. Instead, it should detail a company standard acceptable use policy.\n\nThis suggestion for a herald should be tailored to reflect your corporate standard policy.",
        "solution": "Add a default login herald to /etc/security/login.cfg:\n\nchsec -f /etc/security/login.cfg -s default -a herald='Unauthorized use of this system is prohibited.\\\\nlogin:'\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,LEVEL|1A,NESA|M1.3.6,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/security/login.cfg",
        "content": "@LOGIN_HERALD_TEXT@"
    },
    "custom_item_187": {
        "description": "4.6.4 loginretries",
        "info": "Defines the number of attempts a user has to login to the system before their account is disabled.\n\nRationale:\n\nIn setting the loginretries attribute, this ensures that a user can have a pre-defined number of attempts to get their password right, prior to locking the account.\n\nImpact:\n\nThe setting chosen here (5) is a group consensus as secure enough. However, a local site-policy may have a more strict requirement for all, or some systems.\n\nWhile the audit and artifact currently test for exactly 5 - the actual recommendation is: greater than 0 (zero) AND (less than or equal to 5 (five) or greater than 0 (zero) AND not greater than 5 (five)",
        "solution": "In /etc/security/user, set the default stanza loginretries attribute to 5:\n\nchsec -f /etc/security/user -s default -a loginretries=5\n\nThis means that a user will have 5 attempts to enter the correct password. This does not apply to the root user, which has its own stanza entry disabling this feature.\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.8,800-171|3.1.18,800-53|AC-7,800-53|AC-19,800-53r5|AC-7,800-53r5|AC-19,CN-L3|8.1.4.1(b),CSCv8|4.10,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-7,ITSG-33|AC-19,LEVEL|1A,NIAv2|AM24,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a loginretries",
        "expect": "^[\\\\s]*default[\\\\s]+loginretries[\\\\s]*=[\\\\s]*[1-5][\\\\s]*$"
    },
    "custom_item_188": {
        "description": "export",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*(export|readonly)[\\\\s]+(TMOUT[\\\\s]+TIMEOUT[\\\\s]*|TIMEOUT[\\\\s]+TMOUT[\\\\s]*)$",
        "expect": "^[\\\\s]*(export|readonly)[\\\\s]+(TMOUT[\\\\s]+TIMEOUT[\\\\s]*|TIMEOUT[\\\\s]+TMOUT[\\\\s]*)$"
    },
    "custom_item_189": {
        "description": "TIMEOUT",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*TIMEOUT",
        "expect": "^[\\\\s]*TIMEOUT[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]|[1-8][0-9]{2}|900)[\\\\s]*$"
    },
    "custom_item_190": {
        "description": "TMOUT",
        "file": "/etc/profile",
        "regex": "^[\\\\s]*TMOUT",
        "expect": "^[\\\\s]*TMOUT[\\\\s]*=[\\\\s]*([1-9]|[1-9][0-9]|[1-8][0-9]{2}|900)[\\\\s]*$"
    },
    "custom_item_191": {
        "description": "4.7.1.1 Home directory must exist",
        "info": "All accounts must have a trusted started point - a HOME directory.\n\nRationale:\n\nA missing home directory on many systems places the account in a default directory. Examples include: / and /home/guest.\n\nThis recommendation is specifically about locally administered accounts (in AIX terms, -R files). If an account exists in the local registry it must have a home directory that is accessible. This is to ensure it is not an invalid account (e.g., restored via a backup accidentally). If a valid account - it still needs a home directory.\n\nAs the difference between: valid account but missing a HOME directory and invalid account but missing a HOME directory cannot be made by a script - the recommendation is to lock the account.\n\nImpact:\n\nA valid user can open a ticket and get a HOME directory created or restored.\n\nThe risk of an invalid user gaining access via an old username is reduced.",
        "solution": "Lock local accounts with UID >= 200 when HOME directory does not exist:\n\n#!/usr/bin/ksh -e\n# Provided to CIS by AIXTools\n# Copyright AIXTools, 2022\nlsuser -R files -a id home account_locked ALL | while read name ids homes locks rest;\ndo\n  uid=$(echo ${ids} | cut -f2 -d =)\n  if [[ ${uid} -ge 200 ]]; then\n    home=$(echo ${homes} | cut -f2 -d =)\n    locked=$(echo ${locks} | cut -f2 -d =)\n    if [[ ${locked} == 'true' ]]; then\n        continue\n    elif [[ ! -d ${home} ]]; then\n        /usr/bin/printf 'Locked Account [%s]: Missing \\${HOME} at: %-32s\\n' ${name} ${home}\n/usr/bin/chuser -R files account_locked=true ${name}\n    fi\n  fi\ndone",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh -e\nlsuser -R files -a id home account_locked ALL | while read name ids homes locks rest;\ndo\n  uid=$(echo ${ids} | cut -f2 -d =)\n  if [[ ${uid} -ge 200 ]]; then\n    home=$(echo ${homes} | cut -f2 -d =)\n    locked=$(echo ${locks} | cut -f2 -d =)\n    if [[ ${locked} == \"true\" ]]; then\n        continue\n    elif [[ ! -d ${home} ]]; then\n        /usr/bin/printf \"Recommend Lock Account [%s]: Missing \\\\${HOME} at: %-32s\\\\n\" ${name} ${home}\n    fi\n  fi\ndone | /usr/bin/awk '{ print } END { if(NR==0) { print \"pass\" } }'",
        "expect": "^pass$"
    },
    "custom_item_192": {
        "description": "4.7.1.2 Home directory must be owned by account, or special account",
        "info": "All user home directories must have a suitable owner UID.\n\nRationale:\n\nManipulating home directories may enable malicious users to steal or modify data, or to gain other user's system privileges. The UID (or owner) of the HOME directory needs to be either the account or a special account defined for this purpose.\n\nWhen the account is the owner - the security policy must specify that (some) accounts may have DAC authorization to modify HOME directory contents. Security policy may also specify a special UID used to own HOME directories to prevent accounts from modifying the layout and/or content of the HOME directory.\n\nThe assumption of this recommendation is that security policy has not specified either. The recommendation is to lock accounts when the HOME directory is not owned by the user or by root.\n\nImpact:\n\n*Locally administered accounts with HOME directories owned by a random userid will be locked.\n\nValid users can open a ticket to get the UID of their HOME directory corrected.\n\nThe risk of a malicious user modifying an accounts HOME directory is reduced.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh -e\nlsuser -R files -a id home account_locked ALL | while read name ids homes locks rest;\ndo\n    uid=$(echo ${ids} | cut -f2 -d =)\n    if [[ ${uid} -ge 200 ]]; then\n        home=$(echo ${homes} | cut -f2 -d =)\n        locked=$(echo ${locks} | cut -f2 -d =)\n        if [[ ${home} == \"/dev/null\" || ${locked} == \"true\" ]]; then\n            continue\n        elif [[ ! -d ${home} ]]; then\n            /usr/bin/printf \"%-32s does not exist; Recommend Lock Account [%s]\\\\n\" ${home} ${name}\n            continue\n        else\n            /usr/bin/perl -e '\n                $user=$ARGV[0]; $hd=$ARGV[1]; $uid=$ARGV[2]; $huid=((stat $hd)[4]);\n                if ($huid != $uid && $huid != 0) {\n                    exit(1); # triggers command after OR (||)\n                }' ${name} ${home} ${uid} || \\\\\n                    /usr/bin/printf \"Recommend Lock Account: %s does not own %s\\\\n\" ${name} ${home}\n        fi\n    fi\ndone | /usr/bin/awk '{ print } END { if(NR==0) { print \"pass\" } }'",
        "expect": "^pass$"
    },
    "custom_item_193": {
        "description": "4.7.1.3 Home directory: write access restricted to 'owner'",
        "info": "Home directories must be writeable only by the owner. This recommendation audits (or removes) any write permission given via traditional file mode permissions (using chmod). Neither should a home directory have any permissions managed (whether permit or deny) via ACL's.\n\nRationale:\n\nHOME directories with group or world write access enable malicious users to add files or directories, or even remove them if the directory 'T' (SVTX) bit is not also set. While this does not necessarily allow access to data - existing data might be destroyed (unlink()) or replaced (new file added with same name). These modifications could be used, e.g., to use the users authorizations to gain other system privileges.\n\nDisabling read and execute access for world and/or group might be part of a company security policy - and the audit and remediation scripts will need to be modified to reflect this addition.\n\nThe use of ACL's is discouraged because their effect is not immediately visible using standard tools. They must be identified (locating inodes with permission bit 0200000000 set) as active and read using aclget before the actual permissions granted or denied are known. Better is to deny outside access to home (ie, user) related data. When data must be shared create an area outside of ${HOME}.\n\nImpact:\n\nThere should be no impact - at least as far a world permissions are concerned. There is a potential that all members in the group staff or system might see minimal impact - if their systems have, or had, a default umask of 002 when their accounts were created.\n\nAccounts created with a default umask of 022 or stricter will not be impacted, unless a user account modified their HOME directory mode bits to permit group and/or other write access.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh -e\nlsuser -R files -a id home ALL | while read name ids homes rest;\ndo\n  uid_check=$(echo ${ids} | cut -f2 -d =)\n  if [[ ${uid_check} -ge 200 ]]; then\n    home=$(echo ${homes} | cut -f2 -d =)\n    if [[ ${home} == \"/dev/null\" ]]; then\n        continue\n    elif [[ ! -d ${home} ]]; then\n        /usr/bin/printf \"%-32s does not exist; recommend to lock account named [%s]\\\\n\" ${home} ${name}\n    else [[ ${home} != \"/\" && ${home} != \"/dev/null\" ]]\n      /usr/bin/perl -e '$f=$ARGV[0]; $m=(stat $f)[2]; \\\\\n          printf(\"Recommend chmod on: %s: to remove group or world write mode\\\\n\", $f) if $m & 022; \\\\\n          printf(\"Recommend remove ACL on: %s\\\\n \", $f) if $m & 0200000000; \\\\\n          exit($m & 0200000022)' ${home} \\\\\n          || (ls -led ${home} && (aclget ${home} | grep -ip Enabled))\n    fi\n  fi\ndone | /usr/bin/awk '{ print } END { if(NR==0) { print \"pass\" } }'",
        "expect": "^pass$"
    },
    "custom_item_194": {
        "description": "/audit",
        "file": "/audit",
        "owner": "root",
        "mask": "5037",
        "group": "audit"
    },
    "custom_item_195": {
        "description": "/etc/security/audit",
        "file": "/etc/security/audit",
        "owner": "root",
        "mask": "5037",
        "group": "audit"
    },
    "custom_item_196": {
        "description": "4.7.1.5 SECURITY Subsystems: /etc/security",
        "info": "This /etc/security directory contains multiple files and directories used to keep the targeted AIX system secure. Most subsystems are owned by root:security (UID:GID). However, additional systems such as AUDIT and AIXPERT have there own permissions (and recommendations).\n\nTraditionally, /etc/security has been identified as USER administration - including the shadow password file. But there is much more under /etc/security. Normal installations also have configuration files for security subsystems including: aixpert, tsd, ice, ldap, rbac, audit, ipsec, fpm, and trusted computing (tscd).\n\nWhile these subsystems may not be enabled - their files need to be secured to ensure no unauthorized access.\n\nRationale:\n\nThe /etc/security directory contains sensitive files for multiple security systems. For the USER subsystem there are files such as /etc/security/passwd, /etc/security/user that must be secured from unauthorized access and modification.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "#!/usr/bin/ksh -e\n  {\nSPECIAL=\"security/(aixpert|audit|ice)\"\nfind /etc/security ! -user root -a ! -user bin -ls\nfind /etc/security -type d -a ! -group security -ls | /usr/bin/egrep -v ${SPECIAL}\nfind /etc/security/aixpert /etc/security/ice -type d -a ! -group bin -ls\nfind /etc/security/audit -type d ! -group audit -ls\n\nfind /etc/security -type d -ls | \\\\\n /usr/bin/awk '{print $NF \" \" $3}' | \\\\\n /usr/bin/grep -v drwxr-s---\n } | /usr/bin/awk '{ print } END { if(NR==0) { print \"pass\" } }'",
        "expect": "^pass$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_197": {
        "description": "4.7.1.6 /var/adm/ras",
        "info": "The /var/adm/ras directory contains log files which contain sensitive information such as login times and IP addresses.\n\nRationale:\n\nThe log files in the /var/adm/ras directory can contain sensitive information such as login times and IP addresses, which may be altered by an attacker when removing traces of system access. All files in this directory must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write access from all files in /var/adm/ras:\n\nchmod o-rw /var/adm/ras/*\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "find /var/adm/ras/* ! -name . -prune -type f -a \\\\( -perm -o=r -o -perm -o=w \\\\) -exec ls -ldi {} + | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"}'",
        "expect": "^pass$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_198": {
        "description": "4.7.1.7 /var/adm/sa",
        "info": "The /var/adm/sa directory holds the performance data produced by the sar utility.\n\nRationale:\n\nThe /var/adm/sa directory contains the report files produced by the sar utility. This directory must be secured from unauthorized access.",
        "solution": "Set the recommended ownership and permissions on /var/adm/sa:\n\nchown adm:adm /var/adm/sa\nchmod u=rwx,go=rx /var/adm/sa\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/adm/sa",
        "owner": "adm",
        "mask": "022",
        "group": "adm"
    },
    "custom_item_199": {
        "description": "4.7.1.8 /var/spool/cron/crontabs",
        "info": "The /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system.\n\nRationale:\n\nThe /var/spool/cron/crontabs directory contains all of the crontabs for the users on the system. Crontab files present a security problem because they are run by the cron daemon, which runs with super user rights. Allowing other users to have read/write permissions on these files may allow them to escalate their privileges. To negate this risk, the directory and all the files that it contains must be secured.",
        "solution": "Apply the appropriate permissions to /var/spool/cron/crontabs:\n\nchmod -R o= /var/spool/cron/crontabs\nchmod ug=rwx,o= /var/spool/cron/crontabs\nchgrp -R cron /var/spool/cron/crontabs\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/spool/cron/crontabs",
        "mask": "007",
        "group": "cron"
    },
    "custom_item_200": {
        "description": "4.7.1.10 Ensure root user has a dedicated home directory",
        "info": "The root user must have a dedicated home directory and not use / as their home directory.\n\nRationale:\n\nBy default, the home directory for the root user on AIX is /. This means that all configuration files and directories it creates are visible to all users and may be accessible if the root user has a weak umask setting.\n\nMoving these files to a dedicated home directory and setting appropriate file permissions allows for appropriate use of discretionary access control to these files.",
        "solution": "Create a new home directory for the root user\n\nmkdir /root\n\nSet ownership and permissions on this directory\n\nchown root:system /root\nchmod 0700 /root\n\nUpdate the home directory for the root user\n\nchuser home=/root root\n\nMove any necessary configuration files or directories to this new directory",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a home root",
        "expect": "^root[\\\\s]*home=/[a-zA-Z0-9_-]+$"
    },
    "custom_item_201": {
        "description": "4.7.1.11 /etc/security/audit",
        "info": "The /etc/security/audit directory contains the system audit configuration files.\n\nRationale:\n\nThe /etc/security/audit directory stores the audit configuration files. This directory must have adequate access controls to prevent unauthorized access.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/security/audit:\n\nchown -R root:audit /etc/security/audit\nchmod u=rwx,g=rx,o= /etc/security/audit\nchmod -R u=rw,g=r,o= /etc/security/audit/*\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/security/audit",
        "owner": "root",
        "mask": "5027",
        "group": "audit"
    },
    "custom_item_202": {
        "description": "4.7.2.1 New configuration file for sendmail /etc/mail/submit.cf",
        "info": "From 7.2.4, sendmail is updated to version 8.15.2, there is a new configuration file /etc/mail/submit.cf. Ensure the permission is changed to -rw-r----- (0640).\n\nRationale:\n\nPrivileged access to make changes to this configuration file /etc/mail/submit.cf.\n\nImpact:\n\nIt will not impact the usability of application or system.",
        "solution": "chmod u=rw,g=r,o= /etc/mail/submit.cf\n\nDefault Value:\n\n644 (-rw-r--r--)",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|7.8,CSCv8|9.5,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/mail/submit.cf",
        "mask": "137"
    },
    "custom_item_203": {
        "description": "4.7.2.3 crontab entries - owned by userid",
        "info": "This script checks the permissions of all the root crontab entries, to ensure that they are owned and writable by the root user only.\n\nRationale:\n\nAll root crontab entries must be owned and writable by the root user only. If a script had group or world writable access, it could be replaced or edited with malicious content, which would then subsequently run on the system with root authority.",
        "solution": "Ensure that all root crontab entries are owned and writable by root only.\nThe script below traverses up each individual directory path, ensuring that all directories are not group/world writable and that they are owned by the root or bin user:\n\ncrontab -l |egrep -v '^#' |awk '{print $6}' |grep '^/' |sort -u | while read DIR\ndo\nDIR=${DIR:-$(pwd)}\nwhile [[ -a ${DIR} ]]\ndo\n[[ '$(ls -ld ${DIR})' = @(????????w? *) ]] && print ' WARNING ${DIR} is world writable'\n[[ '$(ls -ld ${DIR})' = @(?????w???? *) ]] && print ' WARNING ${DIR} is group writable'\n[[ '$(ls -ld ${DIR} |awk '{print $3}')' != @(root|bin) ]] && print ' WARNING ${DIR} is not owned by root or bin'\nDIR=${DIR%/*}\ndone\ndone\n\nNOTE: Review the output and manually change the directories, if possible. Directories which are group and/or world writable or not owned by root are marked with 'WARNING'\nTo manually change permissions on the files or directories:\nTo remove group writable access:\n\nchmod g-wTo remove world writable access:\n\nchmod o-wTo remove both group and world writable access:\n\nchmod go-wTo change the owner of a file or directory:\n\nchownDefault Value:\n\nN/A\n\nAdditional Information:\n\nDefault AIX Security Expert policy values:\n\nHigh Level policy Permissions checked\n\nMedium Level policy Permissions checked\n\nLow Level policy Permissions checked",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/crontab -l | /usr/bin/egrep -v '^#' | /usr/bin/awk '{print $6}' | /usr/bin/grep \"^/\" | /usr/bin/sort -u | while read DIR; do DIR=${DIR:-$(pwd)}; while [[ -a ${DIR} ]]; do [[ \"$(ls -ld ${DIR})\" = @(????????w? *) ]] && print \" WARNING ${DIR} is world writable\"; [[ \"$(ls -ld ${DIR})\" = @(?????w???? *) ]] && print \" WARNING ${DIR} is group writable\"; [[ \"$(ls -ld ${DIR} |awk '{print $3}')\" != @(root|bin) ]] && print \" WARNING ${DIR} is not owned by root or bin\"; DIR=${DIR%/*}; done; done | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'",
        "expect": "^none$"
    },
    "custom_item_204": {
        "description": "4.7.2.4 Home directory configuration files",
        "info": "The user configuration files in each home directory e.g. $HOME/.profile, must not be group or world writable.\n\nRationale:\n\nGroup or world-writable user configuration files may enable malicious users to steal or modify other user's data, or to gain elevated privileges.",
        "solution": "Search and remediate any user configuration files which have group or world writable access:\n\nlsuser -a home ALL |cut -f2 -d= |egrep -v '^/$|/etc|/bin|/var|/usr|/usr/sys' |while read homedir;\ndo\nif [[ -d ${homedir} ]];\nthen\necho 'Removing 'go-w' from all user confguration files in '${homedir}''\nls -a ${homedir} |egrep '^\\.[a-z]' |while read file;\ndo\nif [[ -f '${homedir}/${file}' ]];\nthen\necho 'Running 'chmod go-w' on '${homedir}/${file}''\nchmod go-w '${homedir}/${file}'\nfi\ndone\nelse\necho 'ERROR - no home directory for '${homedir}''\nfi\ndone\n\nNOTE: The permission change is automatically applied\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /etc/passwd | /usr/bin/awk -F: '($7 != \"/sbin/nologin\" && $7 != \"/bin/false\") { print $1 \" \" $6 }' | /usr/bin/egrep -v \"^/$|/etc|/bin|/var|/usr|/usr/sys\" | while read user dir; do if [ ! -d \"$dir\" ]; then /usr/bin/echo \"The home directory ($dir) of user $user does not exist.\"; else for file in $dir/.[A-Za-z0-9]*; do if [ ! -h \"$file\" -a -f \"$file\" ]; then fileperm=`ls -ld $file | cut -f1 -d\" \"`; if [ `/usr/bin/echo $fileperm | cut -c6` != \"-\" ]; then /usr/bin/echo \"Group Write permission set on file $file\"; fi; if [ `/usr/bin/echo $fileperm | cut -c9` != \"-\" ]; then /usr/bin/echo \"Other Write permission set on file $file\"; fi; fi; done; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"Pass - No home configuration files found with group or other permissions\"; else print}'",
        "expect": "Pass - No home configuration files found with group or other permissions"
    },
    "custom_item_205": {
        "description": "4.7.2.5 /smit.log",
        "info": "The /smit.log file maintains a history of all smit commands run as root.\n\nRationale:\n\nThe /smit.log file may contain sensitive information regarding system configuration, which may be of interest to an attacker. This log file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write access to /smit.log:\n\nchmod o-rw /smit.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/smit.log",
        "mask": "137"
    },
    "custom_item_206": {
        "description": "4.7.2.6 /etc/group",
        "info": "The /etc/group file contains a list of the groups defined within the system.\n\nRationale:\n\nThe /etc/group file defines basic group attributes. Since the file contains sensitive information, it must be properly secured.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/group:\n\nchown root:security /etc/group\nchmod u=rw,go=r /etc/group\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/group",
        "owner": "root",
        "mask": "133",
        "group": "security"
    },
    "custom_item_207": {
        "description": "4.7.2.7 /etc/inetd.conf",
        "info": "The recommended permissions and ownership for /etc/inetd.conf are applied.\n\nRationale:\n\nThe/etc/inetd.conf file contains the list of services that inetd controls and determines their current status i.e. active or disabled. This file must be protected from unauthorized access and modifications to ensure that the services disabled in this benchmark remain locked down.",
        "solution": "Set the recommended permissions and ownership to /etc/inetd.conf:\n\nchmod u=rw,go=r /etc/inetd.conf\nchown root:system /etc/inetd.conf\ntrustchk -u /etc/inetd.conf mode=644\n\nDefault Value:\n\n664, root:system",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/inetd.conf",
        "owner": "root",
        "mask": "133",
        "group": "system"
    },
    "custom_item_208": {
        "description": "4.7.2.8 /etc/motd",
        "info": "The /etc/motd file contains the message of the day, shown after successful initial login.\n\nRationale:\n\nThe /etc/motd file contains the message of the day, shown after successful initial login. The file should only be editable by its owner.",
        "solution": "Apply the appropriate permissions to /etc/motd:\n\nchown bin:bin /etc/motd\nchmod u=rw,go=r /etc/motd\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/motd",
        "owner": "bin",
        "mask": "133",
        "group": "bin"
    },
    "custom_item_209": {
        "description": "4.7.2.9 /etc/passwd",
        "info": "The /etc/passwd file contains a list of the users defined within the system.\n\nRationale:\n\nThe /etc/passwd file defines all users within the system. Since the file contains sensitive information, it must be properly secured.",
        "solution": "Ensure correct ownership and permissions are in place for /etc/passwd:\n\nchown root:security /etc/passwd\nchmod u=rw,go=r /etc/passwd\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/passwd",
        "owner": "root",
        "mask": "133",
        "group": "security"
    },
    "custom_item_210": {
        "description": "4.7.2.10 /etc/ssh/ssh_config",
        "info": "The /etc/ssh/ssh_config file defines SSH client behavior.\n\nRationale:\n\nThe /etc/ssh/ssh_config file is the system-wide client configuration file for OpenSSH, which allows you to set options that modify the operation of the client programs. The recommended value is not to provide any writable access rights for any user other than root.",
        "solution": "Change the permissions of the /etc/ssh/ssh_config file to ensure that only the owner can read and write to the file:\n\nchmod 644 /etc/ssh/ssh_config\n\nDefault Value:\n\n640\n\nAdditional Information:\n\nUsing the octal mode to (re)set the mode will also disable any ACL's that might have been set.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/ssh_config",
        "owner": "root",
        "mask": "133",
        "group": "system"
    },
    "custom_item_211": {
        "description": "4.7.2.11 /etc/ssh/sshd_config",
        "info": "The /etc/ssh/sshd_config file defines SSH server behavior.\n\nRationale:\n\nThe SSH daemon reads the configuration information from this file and includes the authentication mode and cryptographic levels to use during SSH communication.\n\nImpact:\n\nSome organizations feel all configuration information for OpenSSH server must be confidential - and many other benchmarks recommend exclusive root access to the file /etc/ssh/sshd_config. This configuration will work UNLESS sftp access is required by non-root users.\n\nNon-root users (when mode is octal 0600) cannot load_server_config and the connection closes even though authentication succeeded.\n\nJun 25 14:42:45 x071 auth|security:info sshd[12255378]: Accepted password for michael from 192.168.129.65 port 32810 ssh2\n\nJun 25 14:42:45 x071 auth|security:info sftp-server[7077962]: session opened for local user michael from [192.168.129.65]\n\nJun 25 14:42:45 x071 auth|security:debug sftp-server[7077962]: debug2: load_server_config: filename /etc/ssh/sshd_config\n\nJun 25 14:42:45 x071 auth|security:info sshd[8847468]: Received disconnect from 192.168.129.65 port 32810:11: disconnected by user\n\nJun 25 14:42:45 x071 auth|security:info sshd[8847468]: Disconnected from user michael 192.168.129.65 port 32810\n\nThis is what is needed for the sftp-server to start:\n\nJun 25 14:45:10 x071 auth|security:info sshd[7077994]: Accepted password for michael from 192.168.129.65 port 32812 ssh2\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: session opened for local user michael from [192.168.129.65]\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: load_server_config: filename /etc/ssh/sshd_config\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: load_server_config: done config len = 288\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug2: parse_server_config: config /etc/ssh/sshd_config len 288\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:34 setting SyslogFacility AUTH\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:36 setting LogLevel INFO\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:114 setting Banner /etc/banner\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: /etc/ssh/sshd_config:117 setting Subsystem sftp\\t/usr/sbin/sftp-server -l DEBUG3 -f AUTH\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: received client version 3\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug3: request 0: realpath\n\nJun 25 14:45:10 x071 auth|security:info sftp-server[11272308]: realpath '.'\n\nJun 25 14:45:10 x071 auth|security:debug sftp-server[11272308]: debug1: request 0: sent names count 1\n\nThe recommendation is to stay with the default file mode (octal 0644) unless site policy requires octal 0600 AND it is acceptable that sftp will not function.\n\nChoosing octal 0600 is considered a Level 2 recommendation",
        "solution": "Change the permissions of the /etc/ssh/sshd_config file to ensure all accounts can read the file but only the owner (root) can modify it:\n\nchmod u=rw,go=r /etc/ssh/sshd_config\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/etc/ssh/sshd_config",
        "owner": "root",
        "mask": "133",
        "group": "system"
    },
    "custom_item_212": {
        "description": "4.7.2.12 /var/adm/cron/at.allow",
        "info": "The /var/adm/cron/at.allow file contains a list of users who can schedule jobs via the at command.\n\nRationale:\n\nThe /var/adm/cron/at.allow file controls which users can schedule jobs via the at command. Only the root user should have permissions to create, edit, or delete this file.",
        "solution": "Apply the appropriate permissions to /var/adm/cron/at.allow:\n\nchown root:sys /var/adm/cron/at.allow\nchmod u=r,go= /var/adm/cron/at.allow\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/adm/cron/at.allow",
        "owner": "root",
        "mask": "377",
        "group": "sys"
    },
    "custom_item_213": {
        "description": "4.7.2.13 /var/adm/cron/cron.allow",
        "info": "The /var/adm/cron/cron.allow file contains a list of users who can schedule jobs via the cron command.\n\nRationale:\n\nThe /var/adm/cron/cron.allow file controls which users can schedule jobs via cron. Only the root user should have permissions to create, edit, or delete this file.",
        "solution": "Apply the appropriate permissions to /var/adm/cron/cron.allow:\n\nchown root:sys /var/adm/cron/cron.allow\nchmod u=r,go= /var/adm/cron/cron.allow\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/adm/cron/cron.allow",
        "owner": "root",
        "mask": "377",
        "group": "sys"
    },
    "custom_item_214": {
        "description": "4.7.2.14 /var/ct/RMstart.log",
        "info": "The /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured.\n\nRationale:\n\nRMC provides a single monitoring and management infrastructure for both RSCT peer domains and management domains. Its generalized framework is used by cluster management tools to monitor, query, modify, and control cluster resources, /var/ct/RMstart.log is the logfile used by RMC and can contain sensitive data that must be secured.",
        "solution": "Remove world read and write from /var/ct/RMstart.log:\n\nchmod o-rw /var/ct/RMstart.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/ct/RMstart.log",
        "owner": "root",
        "mask": "137",
        "group": "system"
    },
    "custom_item_215": {
        "description": "4.7.2.15 /var/adm/cron/log",
        "info": "The /var/adm/cron/log file contains a log of all cron jobs run on the system.\n\nRationale:\n\nThe /var/adm/cron/log, records all cron jobs run on the system. The file permissions must ensure that it is accessible only to its owner and group.",
        "solution": "Specify exact permissions and user.group ids to /var/adm/cron/log:\n\nchmod ug=rw /var/adm/cron/log\nchown bin.cron /var/adm/cron/log\n\nDefault Value:\n\n660",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/adm/cron/log",
        "owner": "bin",
        "mask": "117",
        "group": "cron"
    },
    "custom_item_216": {
        "description": "4.7.2.16 /var/tmp/dpid2.log",
        "info": "The /var/tmp/dpid2.log is the logfile used by dpid2 daemon, and contains SNMP information.\n\nRationale:\n\nThe /var/tmp/dpid2.log logfile is used by the dpid2 daemon and can contain sensitive SNMP information. This file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write from /var/tmp/dpid2.log:\n\nchmod o-rw /var/tmp/dpid2.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/tmp/dpid2.log",
        "owner": "root",
        "mask": "137",
        "group": "system"
    },
    "custom_item_217": {
        "description": "4.7.2.17 /var/tmp/hostmibd.log",
        "info": "The /var/tmp/hostmibd.log is the logfile used by hostmibd daemon, and contains network and machine related information.\n\nRationale:\n\nThe /var/tmp/hostmibd.log log file can contain network and machine related statistics logged by the daemon. This file must be secured from unauthorized access and modifications.",
        "solution": "Remove world read and write from /var/tmp/hostmibd.log:\n\nchmod o-rw /var/tmp/hostmibd.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/tmp/hostmibd.log",
        "owner": "root",
        "mask": "137",
        "group": "system"
    },
    "custom_item_218": {
        "description": "4.7.2.18 /var/tmp/snmpd.log",
        "info": "The /var/tmp/snmpd.log is the logfile used by snmpd daemon, and contains network and machine related information.\n\nRationale:\n\nThe /var/tmp/snmpd.log logfile contains sensitive information through which an attacker can find out about the SNMP deployment architecture in your network. This log file must be secured from unauthorized access.",
        "solution": "Remove world read and write from /var/tmp/snmpd.log:\n\nchmod o-rw /var/tmp/snmpd.log\n\nDefault Value:\n\n644",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "file": "/var/tmp/snmpd.log",
        "owner": "root",
        "mask": "137",
        "group": "system"
    },
    "custom_item_219": {
        "description": "5.4.1 maxage",
        "info": "Defines the maximum number of weeks that a password is valid.\n\nRationale:\n\nThe maxage attribute enforces regular password changes. We recommend this to be 13 or less, but not 0 which disables this setting.\n\nImpact:\n\nHistorically, this recommendation has been to set maxage=13. In recent years several communities (e.g., Windows, DoD) have concluded that too frequent forced password changes leads to both weaker passwords and weaker/bad password discipline.\n\nAn initial proposal to increase the maxage to 52 is not unnamimous within the AIX community - so the recommendation, for now, remains at 13.\n\nLocal Policy may decide to follow the other communities and set this value as 52.\n\nDue to this lack of consensus this control is being set at Level 2.\n\nThe value chosen by an organization is to maintain overall password quality and secrecy.",
        "solution": "In /etc/security/user, set the default user stanza maxage attribute to a number greater than 0 but less than or equal to 13:\n\nchsec -f /etc/security/user -s default -a maxage=13\n\nThis means that a user password must be changed 13 weeks after being set. If 0 is set then this effectively disables password ageing.\n\nDefault Value:\n\nmaxage=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxage",
        "expect": "^[\\\\s]*default[\\\\s]+maxage[\\\\s]*=[\\\\s]*([1-9]|1[0-3])[\\\\s]*$"
    },
    "custom_item_220": {
        "description": "5.4.2 maxexpired",
        "info": "Defines the number of weeks after maxage, that a password can be reset by the user.\n\nRationale:\n\nThe maxexpired attribute limits the number of weeks after password expiry that a password may be changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza maxexpired attribute to 4:\n\nchsec -f /etc/security/user -s default -a maxexpired=4\n\nThis means that a user can reset their password up to 4 weeks after it has expired. After this an administrative user would need to reset the password.\n\nDefault Value:\n\nNo limit",
        "reference": "800-171|3.1.1,800-53|AC-2(3),800-53r5|AC-2(3),CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv8|5.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),LEVEL|1A,NIAv2|AM26,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxexpired",
        "expect": "^[\\\\s]*default[\\\\s]+maxexpired[\\\\s]*=[\\\\s]*([1-4])[\\\\s]*$"
    },
    "custom_item_221": {
        "description": "5.1.2 All accounts must have a hashed password",
        "info": "All (unlocked) accounts on the server must have a password.\n\nFor this recommendation we look at the so-called files registery - as we cannot reliably review the entries kept in a centralized authentication system such as LDAP or Kerberos.\n\nRationale:\n\nAn account password is a secret code word that must be entered to gain access to the account. If an account exists that has a blank password, multiple users may access the account without authentication and leave a weak audit trail. An attacker may gain unauthorized system access or perform malicious actions, which then cannot be attributed to any specific individual.\n\nImpact:\n\nIf no password hash is available and a locked account gets unlocked then the account is available without any verification aka authentication.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/egrep -p \"password = +$\" /etc/security/passwd | /usr/bin/grep \":\" | awk -F: '{ print $1 } ' | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_222": {
        "description": "UID",
        "cmd": "/usr/bin/cut -d: -f 3 /etc/passwd | /usr/bin/sort -n | /usr/bin/uniq -d | /usr/bin/awk '{print} END {if (NR==0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_223": {
        "description": "username",
        "cmd": "/usr/bin/cut -d: -f 1 /etc/passwd | /usr/bin/sort | /usr/bin/uniq -d | /usr/bin/awk '{print} END {if (NR==0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_224": {
        "description": "GID",
        "cmd": "/usr/bin/cut -d: -f 3 /etc/group | /usr/bin/sort -n | /usr/bin/uniq -d | /usr/bin/awk '{print} END {if (NR==0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_225": {
        "description": "group",
        "cmd": "/usr/bin/cut -d: -f 1 /etc/group | /usr/bin/sort | /usr/bin/uniq -d | /usr/bin/awk '{print} END {if (NR==0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_226": {
        "description": "5.1.1.1 histexpire",
        "info": "Defines the period of time in weeks that a user will not be able to reuse a password.\n\nRationale:\n\nIn setting the histexpire attribute, it ensures that a user cannot reuse a password within a set period of time.",
        "solution": "In /etc/security/user, set the default user stanza histexpire attribute to be greater than or equal to 26:\n\nchsec -f /etc/security/user -s default -a histexpire=52\n\nThis means that a user will not be able to reuse any password set in the last 52 weeks (one year).\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a histexpire",
        "expect": "^[\\\\s]*default[\\\\s]+histexpire[\\\\s]*=[\\\\s]*(2[6-9]|[3-9][0-9]|[1-9][0-9][0-9]+)[\\\\s]*$"
    },
    "custom_item_227": {
        "description": "5.1.1.2 histsize",
        "info": "Defines the number of previous passwords that a user may not reuse.\n\nRationale:\n\nIn setting the histsize attribute, it enforces a minimum number of previous passwords a user cannot reuse.\n\nImpact:\n\nThe recommendation is to not use this attribute. This attribute was traditionally used together with minage to prevent rapid reuse of old passwords. Instead _Unique Passwords' relies solely on the time-based histexpire attribute.",
        "solution": "In /etc/security/user, set the default user stanza histsize attribute to be 0:\n\nchsec -f /etc/security/user -s default -a histsize=0\n\nThis means that this setting is not being used for password management.\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a histsize",
        "expect": "^default[\\\\s]+histsize[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_228": {
        "description": "5.1.1.3 minage",
        "info": "Defines the minimum number of weeks before a password can be changed.\n\nRationale:\n\nThe minage attribute prohibits users changing their password until a set number of weeks have passed.\n\nImpact:\n\nThe AIX community prefers to rely on the AIX attribute histexpire rather than a historical minage value.\n\nHistorically, the minage attribute has been used to prevent a user from write a script to spool through histsize passwords, and then return to the same password as before. The attribute histexpire overrides histsize. Therefore, there is no need to force a user to request assistance from system administrators in order to reset a poorly chosen password, or in the case of special accounts that policy states passwords are meant for 'one time use'.\n\nAgain, since AIX has a different way to prevent scripted password re-cycling, the need for minage is not longer warranted.",
        "solution": "In/etc/security/user, set the default user stanza minage attribute to 1:\n\nchsec -f /etc/security/user -s default -a minage=1\n\nThis means that a user can only change their password after one week.\n\nDefault Value:\n\nminage=0",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minage",
        "expect": "^[\\\\s]*default[\\\\s]+minage[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_229": {
        "description": "5.2.1 Ensure new passwords are controlled by password attributes (disable NOCHECK)",
        "info": "Ensure new passwords are required to pass password attribute controls.\n\nRationale:\n\nIf password restrictions are not enforced for some accounts, those accounts represent a much greater risk of being compromised by an attacker as they may have weaker passwords vulnerable to brute force attack or provide an indefinite window of opportunity for the use of already compromised credentials if the same password has been used on multiple systems.\n\nImpact:\n\nWhen exceptions to the defaults are required - rather than disable all password checking - an account needs to have the attribute redefined per account.\n\nSHA512 password encryption is recommended as the most secure.",
        "solution": "In the file /etc/security/passwd clear the NOCHECK attribute from all users:\n\n#!/usr/bin/ksh -e\n# Copyright AIXTools, 2022\n\n/usr/bin/grep -p NOCHECK /etc/security/passwd | /usr/bin/egrep ':$' | sed -e 's/://' | while read USER; do\n  /usr/bin/pwdadm -c $USER\n  /usr/bin/pwdadm -f ADMCHG $USER\ndone",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/grep NOCHECK /etc/security/passwd | /usr/bin/awk '{ print } END { if (NR==0) print \"pass\" }'",
        "expect": "^pass$"
    },
    "custom_item_230": {
        "description": "5.2.2 pwd_algorithm",
        "info": "Defines the loadable password algorithm used when storing user passwords.\n\nRationale:\n\nA development since AIX 5.1 was the ability to use different password algorithms as defined in /etc/security/pwdalg.cfg. The traditional UNIX password algorithm is crypt, which is a one-way hash function supporting only 8 character passwords. The use of brute force password guessing attacks means that crypt no longer provides an appropriate level of security and so other encryption mechanisms are recommended.\n\nThe recommendation of this benchmark is to set the password algorithm to ssha512. This algorithm supports long passwords, up to 255 characters in length and allows passphrases including the use of the extended ASCII table and the space character. Any passwords already set using crypt will be recognized. When the password is reset the new password hash algorithm will be used to encrypt the password.\n\nImpact:\n\nA password algorithm other than crypt is required to support a password minlen greater than 8 (eight) characters.\n\nSHA512 password encryption is recommended as the most secure.",
        "solution": "In the file /etc/security/login.cfg set the usw stanza attribute pwd_algorithm to ssha512:\n\n#!/usr/bin/ksh -e\n# chk_algorithm:5.2.1\n# Provided to CIS by AIXTools\n# Copyright AIXTools, 2022\n\nEXPECT='usw pwd_algorithm=ssha512'\nCMD='lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm'\n\nTST=$(${CMD})\n[[ ${TST} == ${EXPECT} ]] && exit 0\n\nchsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha512\nexit $?\n\nDefault Value:\n\ncrypt\n\nAdditional Information:\n\nConsider looking for passwords encrypted using crypt and set the ADMCHG flag to initiate a password change at next login.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv7|16.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "expect": "^usw[\\\\s]+pwd_algorithm[\\\\s]*=[\\\\s]*ssha512[\\\\s]*$"
    },
    "custom_item_231": {
        "description": "5.2.3 Ensure passwords are not hashed using 'crypt'",
        "info": "The recommendation is to change the default password hash algorithm to ssha512 (see paragraph 5.2.1). However, changing the default algorithm away from crypt is not enough. The user must supply a new passowrd before a new hashed version of the password is stored in the shadow password file /etc/security/password.\n\nRationale:\n\nThe hash algorithm crypt is known by all *nix versions - so it has provided portability. And in the '70's processor power was weak enough that the mere 56 bits protection against brute-force attacks was reasonable to sufficient. Fifty (50) years later - this is not the case.\n\nImpact:\n\nThe audit looks for hashed passwords that are 14 (fourteen) characters long. That is the length of the crypt hash. The remediation neither changes the password nor locks the account. However, it does clear (if present) and password flags (noteably NOCHECK needs to be removed) and sets the flag ADMCHG so that the account will be required to reset their password during the next login.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv7|16.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "expect": "none found"
    },
    "custom_item_232": {
        "description": "5.2.4 minlen",
        "info": "Defines the minimum length of a password.\n\nRationale:\n\nIn setting the minlen attribute, it ensures that passwords meet the required length criteria.",
        "solution": "In /etc/security/user, set the default user stanza minlen attribute to be greater than or equal to 14:\n\nchsec -f /etc/security/user -s default -a minlen=14\n\nThis means that all user passwords must be at least 14 characters in length.\nNOTE: To support a password length greater than 8 characters the default algorithm must be changed. If the command above returns an error (3004-692 Error changing 'minlen' to '14' : Value is invalid.) the recommendation 3.1.15 /etc/security/login.cfg - pwd_algorithm needs to be completed first.\n\nDefault Value:\n\ndefault minlen=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minlen",
        "expect": "^[\\\\s]*default[\\\\s]+minlen[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_LENGTH@[\\\\s]*$"
    },
    "custom_item_233": {
        "description": "5.2.5 mindiff",
        "info": "Defines the minimum number of characters that are required in a new password which were not in the old password.\n\nRationale:\n\nThe mindiff attribute ensures that users are not able to reuse the same or similar passwords.",
        "solution": "In /etc/security/user, set the default user stanza mindiff attribute to be greater than or equal to 4:\n\nchsec -f /etc/security/user -s default -a mindiff=4\n\nThis means that when a user password is set it needs to comprise of at least 4 characters not present in the previous password.\n\nDefault Value:\n\nmindiff=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a mindiff",
        "expect": "^[\\\\s]*default[\\\\s]+mindiff[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_DIFF@[\\\\s]*$"
    },
    "custom_item_234": {
        "description": "5.2.6 minalpha",
        "info": "Defines the minimum number of alphabetic characters in a password.\n\nRationale:\n\nIn setting the minalpha attribute, it ensures that passwords have a minimum number of alphabetic characters.",
        "solution": "In /etc/security/user, set the default user stanza minalpha attribute to be greater than or equal to 3:\n\nchsec -f /etc/security/user -s default -a minalpha=3\n\nThis means that there must be at least 3 alphabetic characters (upper or lowercase) within a password.\n\nDefault Value:\n\nminalpha=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minalpha",
        "expect": "^[\\\\s]*default[\\\\s]+minalpha[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_ALPHA@[\\\\s]*$"
    },
    "custom_item_235": {
        "description": "5.2.7 minother",
        "info": "Defines the number of characters within a password which must be non-alphabetic.\n\nRationale:\n\nIn setting the minother attribute, it increases password complexity by enforcing the use of non-alphabetic characters in every user password.",
        "solution": "In /etc/security/user, set the default user stanza minother attribute to be greater than or equal to 3:\n\nchsec -f /etc/security/user -s default -a minother=3\n\nThis means that there must be at least 3 non-alphabetic characters within a password.\n\nDefault Value:\n\ndefault minother=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minother",
        "expect": "^[\\\\s]*default[\\\\s]+minother[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_OTHER@[\\\\s]*$"
    },
    "custom_item_236": {
        "description": "5.2.8 maxrepeats",
        "info": "Defines the maximum number of times a character may appear in a password.\n\nRationale:\n\nIn setting the maxrepeats attribute, it enforces a maximum number of character repeats within a password.",
        "solution": "In/etc/security/user, set the default user stanza maxrepeats attribute to 2:\n\nchsec -f /etc/security/user -s default -a maxrepeats=4\n\nThis means that a user may not use the same character more than four (4) times in a password.\nThis value has been increased from two (2) - in parallel with the increase in minlen from eight (8) to fourteen (14).\n\nDefault Value:\n\nmaxrepeats=8",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a maxrepeats",
        "expect": "^[\\\\s]*default[\\\\s]+maxrepeats[\\\\s]*=[\\\\s]*@PASSWORD_MAXREPEAT@[\\\\s]*$"
    },
    "custom_item_237": {
        "description": "5.2.9 mindigit",
        "info": "Defines the minimum number of digits in a password.\n\nRationale:\n\nIn setting the mindigit attribute, the password must contain a digit when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza mindigit attribute to 1:\n\nchsec -f /etc/security/user -s default -a mindigit=1\n\nThis means that there must be at least 1 digit within a password.\n\nDefault Value:\n\ndefault mindigit=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a mindigit",
        "expect": "^[\\\\s]*default[\\\\s]+mindigit[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_DIGIT@[\\\\s]*$"
    },
    "custom_item_238": {
        "description": "5.2.10 minloweralpha",
        "info": "Defines the minimum number of lower case alphabetic characters in a password.\n\nRationale:\n\nIn setting the minloweralpha attribute, the password must contain a lower case alphabetic character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minloweralpha attribute to 1:\n\nchsec -f /etc/security/user -s default -a minloweralpha=1\n\nThis means that there must be at least 1 lower case alphabetic character within a password.\n\nDefault Value:\n\ndefault minloweralpha=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minloweralpha",
        "expect": "^[\\\\s]*default[\\\\s]+minloweralpha[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_L_ALPHA@[\\\\s]*$"
    },
    "custom_item_239": {
        "description": "5.2.11 minupperalpha",
        "info": "Defines the minimum number of upper case alphabetic characters in a password.\n\nRationale:\n\nIn setting the minupperalpha attribute, the password must contain an upper case alphabetic character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minupperalpha attribute to 1:\n\nchsec -f /etc/security/user -s default -a minupperalpha=1\n\nThis means that there must be at least 1 upper case alphabetic character within a password.\n\nDefault Value:\n\ndefault minupperalpha=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minupperalpha",
        "expect": "^[\\\\s]*default[\\\\s]+minupperalpha[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_U_ALPHA@[\\\\s]*$"
    },
    "custom_item_240": {
        "description": "5.2.12 minspecialchar",
        "info": "Defines the minimum number of special characters in a password.\n\nRationale:\n\nIn setting the minspecialchar attribute, the password must contain a special character when it is changed by the user.",
        "solution": "In /etc/security/user, set the default user stanza minspecialchar attribute to 1:\n\nchsec -f /etc/security/user -s default -a minspecialchar=1\n\nThis means that there must be at least 1 special character within a password.\n\nDefault Value:\n\ndefault minspecialchar=0",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/lssec -f /etc/security/user -s default -a minspecialchar",
        "expect": "^[\\\\s]*default[\\\\s]+minspecialchar[\\\\s]*=[\\\\s]*@PASSWORD_MINIMUM_S_CHAR@[\\\\s]*$"
    },
    "custom_item_241": {
        "description": "5.3.1 adm",
        "info": "This change locks and disables login access for the adm user account.\n\nRationale:\n\nThis change disables direct local and remote login to the adm user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the adm user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to adm user:\n\nchuser account_locked=true login=false rlogin=false adm\n\nDefault Value:\n\naccount_locked=false rlogin=true login=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin adm",
        "expect": "^([\\\\s]*adm[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"adm\" does not exist\\\\.)$"
    },
    "custom_item_242": {
        "description": "5.3.2 bin",
        "info": "This change locks and disables login access for the bin user account.\n\nRationale:\n\nThis change disables direct local and remote login to the bin user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the bin user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable bin user access:\n\nchuser account_locked=true login=false rlogin=false bin\n\nDefault Value:\n\naccount_locked=false rlogin=true login=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin bin",
        "expect": "^([\\\\s]*bin[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"bin\" does not exist\\\\.)$"
    },
    "custom_item_243": {
        "description": "5.3.3 daemon",
        "info": "This change locks and disables login access for the daemon user account.\n\nRationale:\n\nThis change disables direct local and remote login to the daemon user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the daemon user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable daemon user access:\n\nchuser account_locked=true login=false rlogin=false daemon\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin daemon",
        "expect": "^([\\\\s]*daemon[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"daemon\" does not exist\\\\.)$"
    },
    "custom_item_244": {
        "description": "5.3.4 guest",
        "info": "This change locks and disables login access for the guest user account.\n\nRationale:\n\nThis change disables direct local and remote login to the guest user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the guest user directly. All users should be given unique logon ids to ensure traceability and accountability.\n\nImpact:\n\nHistorically the guest user account was to provide access to unknown users, i.e., the user identity was not important.\n\nToday the guest account should not be used. The numeric userid is reserved by the OS.\n\nAll authorized users should be given specific logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to guest user:\n\nchuser account_locked=true login=false rlogin=false adm\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin guest",
        "expect": "^([\\\\s]*guest[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"guest\" does not exist\\\\.)$"
    },
    "custom_item_245": {
        "description": "5.3.5 lpd",
        "info": "This change locks and disables login access for the lpd user account.\n\nRationale:\n\nThis change disables direct local and remote login to the lpd user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the lpd user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to lpd user:\n\nchuser account_locked=true login=false rlogin=false lpd\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin lpd",
        "expect": "^([\\\\s]*lpd[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"lpd\" does not exist\\\\.)$"
    },
    "custom_item_246": {
        "description": "5.3.6 nobody",
        "info": "This change locks and disables login access for the nobody user account.\n\nRationale:\n\nThis change disables direct local and remote login to the nobody user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the nobody user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the login and remote login user flags to disable nobody user access:\n\nchuser account_locked=true login=false rlogin=false nobody\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin nobody",
        "expect": "^([\\\\s]*nobody[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"nobody\" does not exist\\\\.)$"
    },
    "custom_item_247": {
        "description": "5.3.7 nuucp",
        "info": "This change locks and disables login access for the nuucp user account.\n\nRationale:\n\nThis change disables direct local and remote login to the nuucp user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the nuucp user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to nuucp user::\n\nchuser account_locked=true login=false rlogin=false nuucp\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin nuucp",
        "expect": "^([\\\\s]*nuucp[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"nuucp\" does not exist\\\\.)$"
    },
    "custom_item_248": {
        "description": "5.3.8 sys",
        "info": "This change locks and disables login access for the sys user account.\n\nRationale:\n\nThis change disables direct local and remote login to the sys user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the sys user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to sys user:\n\nchuser account_locked=true login=false rlogin=false sys\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin sys",
        "expect": "^([\\\\s]*sys[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"sys\" does not exist\\\\.)$"
    },
    "custom_item_249": {
        "description": "5.3.9 uucp",
        "info": "This change locks and disables login access for the uucp user account.\n\nRationale:\n\nThis change disables direct local and remote login to the uucp user account. Do not set a password on this account to ensure that the only access is via su from the root account.\n\nThere should not be a requirement to log in as the uucp user directly. All users should be given unique logon ids to ensure traceability and accountability.",
        "solution": "Change the following user attributes to uucp user:\n\nchuser account_locked=true login=false rlogin=false uucp\n\nDefault Value:\n\naccount_locked=false login=true rlogin=true",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/sbin/lsuser -a account_locked login rlogin uucp",
        "expect": "^([\\\\s]*uucp[\\\\s]+account_locked[\\\\s]*=[\\\\s]*true[\\\\s]+login[\\\\s]*=[\\\\s]*false[\\\\s]+rlogin[\\\\s]*=[\\\\s]*false[\\\\s]*|User \"uucp\" does not exist\\\\.)$"
    },
    "custom_item_250": {
        "description": "ftp",
        "file": "/etc/inetd.conf",
        "regex": "^ftp[\\\\s]+",
        "expect": "^ftp[\\\\s]+"
    },
    "custom_item_251": {
        "description": "5.3.10 Ensure System Accounts cannot access system using ftp.",
        "info": "If ftp is active on the system, the file /etc/ftpusers is a deny list used by ftp daemon containing a list of users who are not allowed to access the system via ftp.\n\nRationale:\n\nThe /etc/ftpusers file contains a list of users who are not allowed to access the system via ftp. All users with a UID less than 200 should typically be added into the file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "List all users with a UID less than 200 to the /etc/ftpusers file:\n\nlsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do\nif [ 'lsuser -f $NAME | grep id | cut -f2 -d=' -lt 200 ] > /dev/null 2>&1; then\necho 'Would add $NAME to /etc/ftpusers'\nfi\ndone\n\nNOTE: Review the list of users\nAdd all relevant users with a UID of less that 200 to the /etc/ftpusers file:\n\nlsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d: | while read NAME; do\nif [ 'lsuser -f $NAME | grep id | cut -f2 -d=' -lt 200 ] > /dev/null 2>&1; then\necho $NAME >> /etc/ftpusers\nfi\ndone\n\nDefault Value:\n\nN/A\n\nAdditional Information:\n\nReversion:\n\nEdit /etc/ftpusers and leave only the root entry:\n\nvi /etc/ftpusers",
        "reference": "800-171|3.5.2,800-53|IA-5,800-53r5|IA-5,CSCv8|4.7,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /etc/ftpusers",
        "expect": "^Manual Review Required$"
    },
    "custom_item_252": {
        "description": "6.4 Adding authorized users in at.allow",
        "info": "The /var/adm/cron/at.allow file defines which users on the system are able to schedule jobs via at.\n\nRationale:\n\nThe /var/adm/cron/at.allow file defines which users are able to schedule jobs via at. Review the current at files and add any relevant users to the /var/adm/cron/at.allow file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review the current at files:\n\nls -l /var/spool/cron/atjobs\ncat /var/spool/cron/atjobs/*\n\nNOTE: Review the list of at schedules and remove any files which should not be there, or have no content\nAdd the recommended system users to the at.allow list:\n\necho 'adm' >> /var/adm/cron/at.allow\necho 'sys' >> /var/adm/cron/at.allow\n\nAdd any other users who require permissions to use the at scheduler:\n\necho>> /var/adm/cron/at.allow\n\nNOTE: Whereis the username.\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1M,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /var/adm/cron/at.allow",
        "expect": "^Manual Review Required$"
    },
    "custom_item_253": {
        "description": "6.6 Adding authorized users in cron.allow",
        "info": "The /var/adm/cron/cron.allow file defines which users on the system are able to schedule jobs via cron.\n\nRationale:\n\nThe /var/adm/cron/cron.allow file defines which users are able to schedule jobs via cron. Review the current cron files and add any relevant users to the /var/adm/cron/cron.allow file.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Review the current cron files:\n\nls -l /var/spool/cron/crontabs/\ncat /var/spool/cron/crontabs/*\n\nNOTE: Review the list of cron schedules and remove any files which should not be there, or have no content.\nAdd the recommended system users to the cron.allow list:\n\necho 'sys' >> /var/adm/cron/cron.allow\necho 'adm' >> /var/adm/cron/cron.allow\n\nAdd any other users who require permissions to use the cron scheduler:\n\necho>> /var/adm/cron/cron.allow\n\nNOTE: Whereis the username.\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/13069",
        "cmd": "/usr/bin/cat /var/adm/cron/cron.allow",
        "expect": "^Manual Review Required$"
    }
}