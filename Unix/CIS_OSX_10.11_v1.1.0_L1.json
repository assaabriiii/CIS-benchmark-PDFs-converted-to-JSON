{
    "custom_item_1": {
        "description": "Mac OSX 10.11 El Capitan is installed",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_2": {
        "description": "1.1 Verify all Apple provided software is current",
        "info": "It is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities.",
        "solution": "Perform the following to ensure the system is configured as prescribed:\n1.\tChoose Apple menu > Software Update - If prompted, enter an admin name and password.\n2.\tInstall all available updates and software patches that are applicable.\nAlternatively:\n1.\tIn Terminal, run the following:\nsoftwareupdate -l\n2.\tIn Terminal, run the following for any packages that show up in step 1:\nsudo softwareupdate -i packagename",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/softwareupdate -l 2>&1",
        "expect": "No new software available"
    },
    "custom_item_3": {
        "description": "1.2 Enable Auto Update",
        "info": "It is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen a terminal session and enter the following command to enable the auto update feature:\nsudo defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -int 1",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "AutomaticCheckEnabled",
        "plist_name": "/Library/Preferences/com.apple.SoftwareUpdate"
    },
    "custom_item_4": {
        "description": "1.3 Enable app update installs",
        "info": "Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen a terminal session and enter the following command to enable the auto update feature:\nsudo defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE\nThe remediation requires a log out and log in to show in the GUI. Please note that.",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "AutoUpdate",
        "plist_name": "/Library/Preferences/com.apple.commerce"
    },
    "custom_item_5": {
        "description": "1.4 Enable system data files and security update installs - 'ConfigDataInstall'",
        "info": "Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited",
        "solution": "Perform the following to implement the prescribed state:\n1. Open a terminal session and enter the following command to enable install system data files and security updates:\nsudo defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "ConfigDataInstall",
        "plist_name": "/Library/Preferences/com.apple.SoftwareUpdate"
    },
    "custom_item_6": {
        "description": "1.4 Enable system data files and security update installs - 'CriticalUpdateInstall'",
        "info": "Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited",
        "solution": "Perform the following to implement the prescribed state:\n1. Open a terminal session and enter the following command to enable install system data files and security updates:\nsudo defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "CriticalUpdateInstall",
        "plist_name": "/Library/Preferences/com.apple.SoftwareUpdate"
    },
    "custom_item_7": {
        "description": "1.5 Enable OS X update installs",
        "info": "Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen a terminal session and enter the following command to enable install system data files and security updates:\nsudo defaults write /Library/Preferences/com.apple.commerce AutoUpdateRestartRequired -bool TRUE",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "AutoUpdateRestartRequired",
        "plist_name": "/Library/Preferences/com.apple.commerce"
    },
    "custom_item_8": {
        "description": "2.1.1 Disable Bluetooth, if no paired devices exist - Bluetooth is disabled",
        "regex": "0",
        "plist_item": "ControllerPowerState",
        "plist_name": "/Library/Preferences/com.apple.Bluetooth"
    },
    "custom_item_9": {
        "description": "2.1.1 Disable Bluetooth, if no paired devices exist - Bluetooth is disabled",
        "info": "Bluetooth is particularly susceptible to a diverse set of security vulnerabilities involving identity detection, location tracking, denial of service, unintended control and access of data and voice channels, and unauthorized device control and data access.",
        "solution": "Perform the following to implement the prescribed state:\n1. In Terminal, run the following commands:\nsudo /usr/bin/defaults write /Library/Preferences/com.apple.Bluetooth ControllerPowerState -int 0\nsudo killall -HUP blued",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "ControllerPowerState",
        "plist_name": "/Library/Preferences/com.apple.Bluetooth"
    },
    "custom_item_10": {
        "description": "2.1.1 Disable Bluetooth, if no paired devices exist - Bluetooth is paired",
        "info": "Bluetooth is particularly susceptible to a diverse set of security vulnerabilities involving identity detection, location tracking, denial of service, unintended control and access of data and voice channels, and unauthorized device control and data access.",
        "solution": "Perform the following to implement the prescribed state:\n1. In Terminal, run the following commands:\nsudo /usr/bin/defaults write /Library/Preferences/com.apple.Bluetooth ControllerPowerState -int 0\nsudo killall -HUP blued",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/system_profiler | /usr/bin/grep 'Bluetooth:' -A 20 | /usr/bin/grep Connectable",
        "expect": "Connectable: Yes"
    },
    "custom_item_11": {
        "description": "2.1.2 Disable Bluetooth 'Discoverable' mode when not pairing devices",
        "info": "When in the discoverable state an unauthorized user could gain access to the system by pairing it with a remote device.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Bluetooth\n3. Turn Bluetooth Off",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/system_profiler SPBluetoothDataType | /usr/bin/grep -i discoverable",
        "expect": "Discoverable:[\\\\s]*Off"
    },
    "custom_item_12": {
        "description": "2.1.3 Show Bluetooth status in menu bar",
        "info": "Enabling 'Show Bluetooth status in menu bar' is a security awareness method that helps understand the current state of Bluetooth, including whether it is enabled, Discoverable, what paired devices exist and are currently active.",
        "solution": "In System Preferences: Bluetooth, turn Show Bluetooth Status In Menu Bar on.\nAlternatively run the following in the command line:\n/usr/bin/defaults write com.apple.systemuiserver menuExtras -array-add '/System/Library/CoreServices/Menu Extras/Bluetooth.menu'",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read com.apple.systemuiserver menuExtras | /usr/bin/grep Bluetooth.menu",
        "expect": "/System/Library/CoreServices/Menu Extras/Bluetooth\\\\.menu"
    },
    "custom_item_13": {
        "description": "2.2.2 Ensure time set is within appropriate limits",
        "info": "Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to implement the prescribed state:\nIn Terminal, run the following command:\nsudo systemsetup -getnetworktimeserver\nUse 'Network Time Server:' your.time.server to capture drift:\nsudo ntpdate -svd your.time.server | egrep offset",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "ntpdate -svd `sudo /usr/sbin/systemsetup -getnetworktimeserver | cut -d ' ' -f 4` | egrep offset",
        "expect": ""
    },
    "custom_item_14": {
        "description": "2.2.3 Restrict NTP server to loopback interface - restrict lo",
        "info": "Mobile workstations on untrusted networks should not have open listening services\navailable to other nodes on the network.",
        "solution": "Perform the following to implement the prescribed state -\n      1. Run the following command in Terminal-sudo vim /etc/ntp-restrict.conf\n      2. Add the following lines to the filerestrict lo interface ignore wildcard interface listen lo",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|1S,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/cat /etc/ntp-restrict.conf | /usr/bin/grep 'restrict lo'",
        "expect": "restrict[\\\\s]*lo"
    },
    "custom_item_15": {
        "description": "2.2.3 Restrict NTP server to loopback interface - interface ignore wildcard",
        "info": "Mobile workstations on untrusted networks should not have open listening services\navailable to other nodes on the network.",
        "solution": "Perform the following to implement the prescribed state -\n      1. Run the following command in Terminal-sudo vim /etc/ntp-restrict.conf\n      2. Add the following lines to the filerestrict lo interface ignore wildcard interface listen lo",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|1S,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/cat /etc/ntp-restrict.conf | /usr/bin/grep 'interface ignore wildcard'",
        "expect": "interface[\\\\s]*ignore[\\\\s]*wildcard"
    },
    "custom_item_16": {
        "description": "2.2.3 Restrict NTP server to loopback interface - interface listen lo",
        "info": "Mobile workstations on untrusted networks should not have open listening services\navailable to other nodes on the network.",
        "solution": "Perform the following to implement the prescribed state -\n      1. Run the following command in Terminal-sudo vim /etc/ntp-restrict.conf\n      2. Add the following lines to the filerestrict lo interface ignore wildcard interface listen lo",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|1S,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/cat /etc/ntp-restrict.conf | /usr/bin/grep 'interface listen lo'",
        "expect": "interface[\\\\s]*listen[\\\\s]*lo"
    },
    "custom_item_17": {
        "description": "2.3.1 Set an inactivity interval of 20 minutes or less for the screen saver",
        "info": "Setting an inactivity interval for the screensaver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.",
        "solution": "Perform the following to implement the prescribed state:\nOpen System Preferences\nSelect Desktop & Screen Saver\nSelect Screen Saver\nSet Start after to 20 minutes or less\nAlternatively:\nIn Terminal, run one of the the following commands:\n/usr/bin/defaults -currentHost write com.apple.screensaver idleTime -int 600\n/usr/bin/defaults -currentHost write com.apple.screensaver idleTime -int 1200\nThere are anomalies if the command line is used make the setting something other than what is available in the GUI Menu. Choose either 10 minutes or 20 minutes.",
        "reference": "800-171|3.1.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": ".* = ([1-9]|[1-9][0-9]|[1-9][0-9][0-9]|1[0-1][0-9][0-9]|1200)$",
        "plist_item": "idleTime",
        "plist_name": "com.apple.screensaver",
        "plist_user": "all"
    },
    "custom_item_18": {
        "description": "2.3.3 Verify Display Sleep is set to a value larger than the Screen Saver",
        "info": "Users of the system can easily assume that the computer is protected when the display goes to sleep.\nThe computer should be configured so that the screen is locked whenever the display turns off automatically.\nNOTE : CIS recommends this value be 'longer than the Screen Saver'.  An assumed value of '10' is used here.",
        "solution": "In System Preferences: Energy Saver, drag the slider for 'Put the display(s) to sleep...' to a reasonable number,\nbut longer than the screen saver setting. The Mac will display a warning if the number is too short.\nAlternatively, use the following command:\nsudo /usr/bin/pmset -c displaysleep 0\nNote: The -c flag means 'wall power.' Different settings must be used for other power sources",
        "reference": "800-171|3.1.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1NS,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pmset -g | /usr/bin/grep displaysleep",
        "expect": "^[\\\\s]*displaysleep[\\\\s]+(0|[1-9]\\\\d{1,})[\\\\s]*$"
    },
    "custom_item_19": {
        "description": "2.3.4 Set a screen corner to Start Screen Saver",
        "info": "Ensuring the user has a quick method to lock their screen may reduce opportunity for individuals in close physical proximity of the device to see screen contents.",
        "solution": "In System Preferences: Desktop & Screen Saver: Screen Saver: Hot Corners, make sure at least one Active Screen Corner is set to Start Screen Saver.\nMake sure the user knows about this feature. The screen corners can be set using the defaults command, but the permutations of combinations are many.\nThe plist file to check is ~/Library/Preferences/com.apple.dock and the keys are:\nwvous-bl-corner\nwvous-br-corner\nwvous-tl-corner\nwvous-tr-corner\nThere are also modifier keys to check and various values for each of these keys. A value of 5 means the corner will start the screen saver.\nThe corresponding wvous-xx-modifier key should be set to 0.",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|1S,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read ~/Library/Preferences/com.apple.dock | /usr/bin/grep -i corner",
        "expect": "\".*-corner\"[\\\\s]*=[\\\\s]*5;$"
    },
    "custom_item_20": {
        "description": "2.4.1 Disable Remote Apple Events",
        "info": "Disabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\nsudo /usr/sbin/systemsetup -setremoteappleevents off",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/systemsetup -getremoteappleevents",
        "expect": "^Remote Apple Events:[\\\\s]*Off"
    },
    "custom_item_21": {
        "description": "2.4.2 Disable Internet Sharing",
        "info": "Disabling Internet Sharing reduces the remote attack surface of the system.",
        "solution": "Perform the following to implement the prescribed state:\nOpen System Preferences\nSelect Sharing\nUncheck Internet Sharing",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.nat | /usr/bin/grep -i Enabled | /usr/bin/grep -v 0 | /usr/bin/awk '{print} END {if (NR == 0) print\"pass\"}'",
        "expect": "pass"
    },
    "custom_item_22": {
        "description": "2.4.3 Disable Screen Sharing",
        "info": "Disabling screen sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.",
        "solution": "Perform the following to implement the prescribed state:\nOpen System Preferences\nSelect Sharing\nUncheck Screen Sharing",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl load /System/Library/LaunchDaemons/com.apple.screensharing.plist",
        "expect": "Service[\\\\s]+is[\\\\s]+disabled"
    },
    "custom_item_23": {
        "description": "2.4.4 Disable Printer Sharing",
        "info": "Disabling Printer Sharing mitigates the risk of attackers attempting to exploit the print server to gain access to the system.",
        "solution": "Perform the following to implement the prescribed state:\nOpen System Preferences\nSelect Sharing\nUncheck Printer Sharing",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/system_profiler SPPrintersDataType",
        "expect": "(The[\\\\s]*printers[\\\\s]*list[\\\\s]*is[\\\\s]*empty|Shared:[\\\\s]+No)"
    },
    "custom_item_24": {
        "description": "2.4.5 Disable Remote Login",
        "info": "Disabling Remote Login mitigates the risk of an unauthorized person gaining access to the system via Secure Shell (SSH). While SSH is an industry standard to connect to posix servers, the scope of the benchmark is for Apple OSX clients, not servers. OS X does have an IP based firewall available (pf, ipfw has been deprecated) that is not enabled or configured. There are more details and links in section 7.5. OS X no longer has TCP Wrappers support built-in and does not have strong Brute-Force password guessing mitigations, or frequent patching of openssh by Apple. Most OS X computers are mobile workstations, managing IP based firewall rules on mobile devices can be very resource intensive. All of these factors can be parts of running a hardened SSH server.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\nsudo systemsetup -setremotelogin off",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,800-53r5|AC-17,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,LEVEL|1S,NESA|T5.4.5,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.6",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/systemsetup -getremotelogin",
        "expect": "^Remote[\\\\s]*Login:[\\\\s]*Off$"
    },
    "custom_item_25": {
        "description": "2.4.6 Disable DVD or CD Sharing",
        "info": "Disabling DVD or CD Sharing minimizes the risk of an attacker using the optical drive as a vector for attack and exposure of sensitive data.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Sharing\n3.\tUncheck DVD or CD Sharing",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl list | /usr/bin/egrep ODSAgent | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_26": {
        "description": "2.4.7 Disable Bluetooth Sharing",
        "info": "Disabling Bluetooth Sharing minimizes the risk of an attacker using Bluetooth to remotely attack the system.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to implement the prescribed state:\nOpen System Preferences\nSelect Sharing\nUncheck Bluetooth Sharing",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "system_profiler SPBluetoothDataType | grep State | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "(none|State:[\\\\s]*Disabled)"
    },
    "custom_item_27": {
        "description": "2.4.8 Disable File Sharing - AppleFileServer",
        "info": "By disabling file sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal to turn off AFP from the command line:\nsudo /bin/launchctl unload -w /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist\nRun the following command in Terminal to turn off SMB sharing from the CLI:\nsudo defaults delete /Library/Preferences/SystemConfiguration/com.apple.smb.server EnabledServices\nsudo /bin/launchctl unload -w /System/Library/LaunchDaemons/nmbd.plist\nsudo /bin/launchctl unload -w /System/Library/LaunchDaemons/smbd.plist",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl list | /usr/bin/grep AppleFileServer | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_28": {
        "description": "2.4.8 Disable File Sharing - SMB",
        "info": "By disabling file sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal to turn off AFP from the command line:\nsudo /bin/launchctl unload -w /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist\nRun the following command in Terminal to turn off SMB sharing from the CLI:\nsudo defaults delete /Library/Preferences/SystemConfiguration/com.apple.smb.server EnabledServices\nsudo /bin/launchctl unload -w /System/Library/LaunchDaemons/com.apple.smbd.plist",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl list | /usr/bin/grep smbd | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_29": {
        "description": "2.4.9 Disable Remote Management - 'ARDAgent is not running'",
        "info": "Remote management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.",
        "solution": "In System Preferences: Sharing, turn off Remote Management.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/ps -ef | /usr/bin/egrep ARDAgent | /usr/bin/grep -v egrep | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_30": {
        "description": "2.4.9 Disable Remote Management - 'ARDAgent file does not exist'",
        "info": "Remote management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.",
        "solution": "In System Preferences: Sharing, turn off Remote Management.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "file": "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"
    },
    "custom_item_31": {
        "description": "2.6.1 Enable FileVault - Encryption Status",
        "info": "Encrypting sensitive data minimizes the likelihood of unauthorized users gaining access to it.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect FileVault\n4.\tSelect Turn on FileVault",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/diskutil cs list | /usr/bin/grep -i encryption",
        "expect": "Encryption Status:[\\\\s]*Unlocked"
    },
    "custom_item_32": {
        "description": "2.6.1 Enable FileVault - Encryption Type",
        "info": "Encrypting sensitive data minimizes the likelihood of unauthorized users gaining access to it.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect FileVault\n4.\tSelect Turn on FileVault",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/diskutil cs list | /usr/bin/grep -i encryption",
        "expect": "Encryption Type:[\\\\s]*AES-XTS"
    },
    "custom_item_33": {
        "description": "2.6.2 Enable Gatekeeper",
        "info": "Disallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect General\n4.\tSelect Allow applications downloaded from: Mac App Store and identified developers\nAlternatively, perform the following to ensure the system is configured as:\n1.\tRun the following command in Terminal:\nsudo spctl --master-enable",
        "reference": "800-171|3.4.8,800-53|CM-7(4),800-53r5|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/sbin/spctl --status",
        "expect": "assessments[\\\\s]*enabled"
    },
    "custom_item_34": {
        "description": "2.6.3 Enable Firewall",
        "info": "A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect Firewall\n4.\tSelect Turn On Firewall\n\nAlternatively:\n1.\tRun the following command in Terminal:\ndefaults write /Library/Preferences/com.apple.alf globalstate - int2.\tWhereis:\n1 = on for specific services\n2 = on for essential services",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSCv6|9.2,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1S,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "[12]",
        "plist_item": "globalstate",
        "plist_name": "/Library/Preferences/com.apple.alf"
    },
    "custom_item_35": {
        "description": "2.6.4 Enable Firewall Stealth Mode",
        "info": "Stealth mode on the firewall minimizes the threat of system discovery tools while connected to a network or the Internet.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect Firewall Options\n4.\tSelect Enable stealth mode\n\nAlternatively:\n1.\tRun the following command in Terminal:\nsudo /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSCv6|9.2,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1S,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getstealthmode",
        "expect": "Stealth mode enabled"
    },
    "custom_item_36": {
        "description": "2.6.5 Review Application Firewall Rules",
        "info": "A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet. Which applications are allowed access to accept incoming connections through the firewall is important to understand.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect Firewall Options\n4.\tSelect unneeded rules\n5.\tSelect the minus sign below to delete them\n\nAlternatively:\n1.\tEdit and run the following command in Terminal to remove specific applications:\n/usr/libexec/ApplicationFirewall/socketfilterfw --remove2.\tWhereis the one to be removed",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSCv6|9.2,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1S,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --listapps | /usr/bin/grep Allow | /usr/bin/wc -l",
        "expect": "^[\\\\s]*([0-9]|10)[\\\\s]*$"
    },
    "custom_item_37": {
        "description": "2.8.2 Time Machine Volumes Are Encrypted",
        "info": "Backup volumes need to be encrypted\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Ensure that backup volumes are encrypted using the Time Machine control or using Disk\nUtility",
        "reference": "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),LEVEL|1NS,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/tmutil destinationinfo",
        "expect": ""
    },
    "custom_item_38": {
        "description": "2.9 Pair the remote control infrared receiver if enabled",
        "regex": "0",
        "plist_item": "DeviceEnabled",
        "plist_name": "/Library/Preferences/com.apple.driver.AppleIRController"
    },
    "custom_item_39": {
        "description": "2.9 Pair the remote control infrared receiver if enabled - 'DeviceEnabled = 1'",
        "info": "An infrared remote can be used from a distance to circumvent physical security controls. A remote could also be used to page through a document or presentation, thus revealing sensitive information.",
        "solution": "Perform one of the following to implement the prescribed state:\nDisable the remote control infrared receiver:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect the General tab\n4.\tSelect Advanced\n5.\tCheck Disable remote control infrared receiver\n\nPair a remote control infrared receiver\n1.\tHolding the remote close to the computer, point the remote at the front of the computer.\n2.\tPair the Apple Remote.\n- If you have an Apple Remote with seven buttons, press and hold both the Right and Menu buttons on the remote until the paired-remote icon appears on your screen\n-\tIf you have an Apple Remote with six buttons, press and hold both the Next and Menu buttons on the remote until the paired-remote icon appears on your screen",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "DeviceEnabled",
        "plist_name": "/Library/Preferences/com.apple.driver.AppleIRController"
    },
    "custom_item_40": {
        "description": "2.9 Pair the remote control infrared receiver if enabled - 'UIDFilter != none'",
        "info": "An infrared remote can be used from a distance to circumvent physical security controls. A remote could also be used to page through a document or presentation, thus revealing sensitive information.",
        "solution": "Perform one of the following to implement the prescribed state:\nDisable the remote control infrared receiver:\n1.\tOpen System Preferences\n2.\tSelect Security & Privacy\n3.\tSelect the General tab\n4.\tSelect Advanced\n5.\tCheck Disable remote control infrared receiver\n\nPair a remote control infrared receiver\n1.\tHolding the remote close to the computer, point the remote at the front of the computer.\n2.\tPair the Apple Remote.\n- If you have an Apple Remote with seven buttons, press and hold both the Right and Menu buttons on the remote until the paired-remote icon appears on your screen\n-\tIf you have an Apple Remote with six buttons, press and hold both the Next and Menu buttons on the remote until the paired-remote icon appears on your screen",
        "reference": "800-171|3.1.18,800-53|AC-19,800-53r5|AC-19,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,LEVEL|1S,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController | /usr/bin/grep UIDFilter | /usr/bin/grep none | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "^[\\\\s]*none[\\\\s]*$"
    },
    "custom_item_41": {
        "description": "2.10 Enable Secure Keyboard Entry in terminal.app",
        "info": "Enabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen Terminal\n2.\tSelect Terminal\n3.\tSelect Secure Keyboard Entry",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "SecureKeyboardEntry",
        "plist_name": "com.apple.Terminal",
        "plist_user": "all"
    },
    "custom_item_42": {
        "description": "3.1.1 Retain system.log for 90 or more days",
        "info": "Archiving and retaining system.log for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.",
        "solution": "Perform the following to implement the prescribed state:\n\n1.\tRun the following command in Terminal:\nsudo vim /etc/asl.conf\n\n2.\tReplace or edit the current setting with a compliant setting\n> system.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90",
        "reference": "800-53|AU-11,800-53r5|AU-11,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "file": "/etc/asl.conf",
        "regex": "^[^#]+system\\.log.+ttl=",
        "expect": "^[^#]+system\\.log.+ttl=([9]\\\\d|[1-9]\\\\d{2,})"
    },
    "custom_item_43": {
        "description": "3.1.2 Retain appfirewall.log for 90 or more days",
        "info": "Archiving and retaining appfirewall.log for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.",
        "solution": "Perform the following to implement the prescribed state:\n\n1.\tRun the following command in Terminal:\nsudo vim /etc/asl.conf\n\n2.\tReplace or edit the current setting with a compliant setting\n> appfirewall.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90",
        "reference": "800-53|AU-11,800-53r5|AU-11,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "file": "/etc/asl.conf",
        "regex": "^[^#]+appfirewall\\\\.log.+ttl=",
        "expect": "^[^#]+appfirewall\\\\.log.+ttl=([9]\\\\d|[1-9]\\\\d{2,})"
    },
    "custom_item_44": {
        "description": "3.1.3 Retain authd.log for 90 or more days",
        "info": "Archiving and retaining authd.log for 90 or more days is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tPerform the following to implement the prescribed state:\n\n2.\tRun the following command in Terminal:\nsudo vim /etc/asl/com.apple.authd\n\n3.\tReplace or edit the current setting with a compliant setting\n * file /var/log/authd.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=90",
        "reference": "800-53|AU-11,800-53r5|AU-11,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "file": "/etc/asl/com.apple.authd",
        "regex": "^[^#]+authd\\\\.log.+ttl=",
        "expect": "^[^#]+authd\\\\.log.+ttl=([9]\\\\d|[1-9]\\\\d{2,})"
    },
    "custom_item_45": {
        "description": "3.2 Enable security auditing",
        "info": "Logs generated by auditd may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\nsudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl list | /usr/bin/grep -i auditd",
        "expect": "com.apple.auditd"
    },
    "custom_item_46": {
        "description": "3.5 Retain install.log for 365 or more days",
        "info": "Archiving and retaining install.log for at least a year is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\nsudo vim /etc/asl/com.apple.install\nReplace or edit the current setting with a compliant setting\n* file /var/log/install.log mode=0640 format=bsd rotate=utc compress file_max=5M ttl=365",
        "reference": "800-53|AU-11,800-53r5|AU-11,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|1S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/grep -i install\\\\.log /etc/asl/com.apple.install | /usr/bin/grep -i ttl",
        "expect": "ttl=(36[5-9]|3[7-9][0-9]|[4-9]\\d{2,}|[1-9]\\d{3,})"
    },
    "custom_item_47": {
        "description": "4.2 Enable 'Show Wi-Fi status in menu bar'",
        "info": "Enabling 'Show Wi-Fi status in menu bar' is a security awareness method that helps mitigate public area wireless exploits by making the user aware of their wireless connectivity status.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tOpen System Preferences\n2.\tSelect Network\n3.\tCheck Show Wi-Fi status in menu bar",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read com.apple.systemuiserver menuExtras | /usr/bin/grep AirPort\\\\.menu",
        "expect": "/System/Library/CoreServices/Menu Extras/Airport.\\\\.menu"
    },
    "custom_item_48": {
        "description": "4.4 Ensure http server is not running",
        "info": "Web serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.",
        "solution": "Ensure that the Web Server is not running and is not set to start at boot\nStop the Web Server\n sudo apachectl stop\nEnsure that the web server will not auto-start at boot\n sudo defaults write /System/Library/LaunchDaemons/org.apache.httpd Disabled -bool true",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/ps -ef | /usr/bin/grep -i httpd | /usr/bin/grep -v grep",
        "expect": ""
    },
    "custom_item_49": {
        "description": "4.5 Ensure ftp server is not running",
        "info": "Ftp servers should not be run on an end user desktop. Dedicated servers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.",
        "solution": "Ensure that the FTP Server is not running and is not set to start at boot\nStop the ftp Server\nsudo -s launchctl unload -w /System/Library/LaunchDaemons/ftp.plist",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/launchctl list | /usr/bin/egrep ftpd | /usr/bin/cut -d'.' -f3 | /usr/bin/egrep '^ftpd'",
        "expect": ""
    },
    "custom_item_50": {
        "description": "4.6 Ensure nfs server is not running",
        "info": "File serving should not be done from a user desktop, dedicated servers should be used. Open ports make it easier to exploit the computer.",
        "solution": "Ensure that the NFS Server is not running and is not set to start at boot\nStop the NFS Server\nsudo nfsd disable\nRemove the exported Directory listing\nrm /etc/export",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/ps -ef | /usr/bin/grep -i nfsd | /usr/bin/grep -v grep | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"}'",
        "expect": "pass"
    },
    "custom_item_51": {
        "description": "5.1.1 Secure Home Folders",
        "info": "Allowing all users to view the top level of all networked user's home folder may not be desirable since it may lead to the revelation of sensitive information.",
        "solution": "Perform the following to implement the prescribed state: Run one of the following commands in Terminal: sudo chmod -R og-rwx /Users/<username> sudo chmod -R og-rw /Users/<username> Substitute user name in <username>. This command has to be run for each user account with a local home folder. Impact: If implemented, users will not be able to use the 'Public' folders in other users' home folders. 'Public' folders with appropriate permissions would need to be set up in the /Shared folder.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/find /Users -type d ! -perm -1000 -maxdepth 1 -a -perm +0066 | /usr/bin/egrep -v '^/Users$' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_52": {
        "description": "5.1.2 Check System Wide Applications for appropriate permissions",
        "info": "Unauthorized modifications of applications could lead to the execution of malicious code.",
        "solution": "Change permissions so that 'Others' can only execute. (Example Below)\nsudo chmod -R o-w /Applications/Bad\\ Permissions.app/",
        "reference": "800-171|3.1.5,800-53|AC-6(7)(b),800-53r5|AC-6(7)(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.5,ITSG-33|AC-6,LEVEL|1S,NESA|M1.1.3,NESA|T5.1.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/find /Applications -iname '*\\.app' -type d -perm -2 -ls | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_53": {
        "description": "5.1.3 Check System folder for world writable files",
        "info": "Folders in /System should not be world writable. The audit check excludes the 'Drop Box' folder that is part of Apple's default user template.",
        "solution": "Change permissions so that 'Others' can only execute. (Example Below)\nsudo chmod -R o-w /Bad/Directory",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/find /System -type d -perm -2 -ls | /usr/bin/grep -v 'Public/Drop Box' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_54": {
        "description": "5.2.1 Configure account lockout threshold",
        "info": "The account lockout feature mitigates brute-force password attacks on the system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CN-L3|8.1.4.1(b),CSCv6|16.7,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,LEVEL|1S,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A 1 'policyAttributeMaximumFailedAuthentications' | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1",
        "expect": "@PASSWORD_LOCKOUT_THRESHOLD@"
    },
    "custom_item_55": {
        "description": "5.2.2 Set a minimum password length",
        "info": "Information systems not protected with strong password schemes including passwords of minimum length provide the opportunity for anyone to crack the password and gain access to the system, and cause the device, information, or the local network to be compromised or a Denial of Service.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep 'Must be a minimum of'",
        "expect": "must[\\\\s]+be[\\\\s]+a[\\\\s]+minimum[\\\\s]+of[\\\\s]+@PASSWORD_MINIMUM_LENGTH@[\\\\s]+characters"
    },
    "custom_item_56": {
        "description": "5.2.3 Complex passwords must contain an Alphabetic Character - 'Policy Check'",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep Alpha",
        "expect": "@PASSWORD_ALPHA_REQUIRED@"
    },
    "custom_item_57": {
        "description": "5.2.3 Complex passwords must contain an Alphabetic Character - 'RequiresAlpha'",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep Alpha",
        "expect": "@PASSWORD_ALPHA_REQUIRED@"
    },
    "custom_item_58": {
        "description": "5.2.3 Complex passwords must contain an Alphabetic Character - '1 letter'",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep 'Must contain at least.*letter'",
        "expect": ".*Must[\\\\s]+contain[\\\\s]+at[\\\\s]+least[\\\\s]+@PASSWORD_ALPHABETIC_CHARACTERS@[\\\\s]+letter.*"
    },
    "custom_item_59": {
        "description": "5.2.4 Complex passwords must contain a Numeric Character - 'Policy Check'",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep Numeric",
        "expect": "@PASSWORD_REQUIRES_NUMERIC@"
    },
    "custom_item_60": {
        "description": "5.2.4 Complex passwords must contain a Numeric Character - 'Numeric'",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep Numeric",
        "expect": "@PASSWORD_REQUIRES_NUMERIC@"
    },
    "custom_item_61": {
        "description": "5.2.4 Complex passwords must contain a Numeric Character - '1 number'",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep 'number'",
        "expect": ".*Must[\\\\s]+contain[\\\\s]+at[\\\\s]+least[\\\\s]+@PASSWORD_NUMERIC_CHARACTERS@[\\\\s]+number.*"
    },
    "custom_item_62": {
        "description": "5.2.5 Complex passwords must contain a Special Character",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep 'Must contain at least.*special'",
        "expect": "Must[\\\\s]+contain[\\\\s]+at[\\\\s]+least[\\\\s]+@PASSWORD_SPECIAL_CHARACTERS@[\\\\s]+special"
    },
    "custom_item_63": {
        "description": "5.2.6 Complex passwords must contain uppercase and lowercase letters",
        "info": "The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep com\\\\.apple\\\\.uppercaseAndLowercase | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "com\\\\.apple\\\\.@PASSWORD_CASE_SENSITIVE@"
    },
    "custom_item_64": {
        "description": "5.2.7 Password Age",
        "info": "Passwords should be changed periodically to reduce exposure",
        "solution": "Perform the following to ensure the system is configured as prescribed:\n\n1.\tRun the following command in Terminal:\npwpolicy -getaccountpolicies | egrep policyAttributeExpiresEveryNDays\n\n2.\tVerify the value returnedpolicyAttributeCurrentTime > policyAttributeLastPasswordChangeTime + policyAttributeExpiresEveryNDays * 24 * 60 * 60policyAttributeExpiresEveryNDaysShould contain 90 or less",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),LEVEL|1S,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep policyAttributeExpiresEveryNDays -A1",
        "expect": "integer.*@PASSWORD_AGE@"
    },
    "custom_item_65": {
        "description": "5.2.8 Password History",
        "info": "Old passwords should not be reused",
        "solution": "Perform the following to implement the prescribed state for all pwpolicy controls\n1. Run the following command in Terminal:\npwpolicy -setaccountpolicies\nExamples in pwpolicy man page and in the back of the Benchmark",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),LEVEL|1S,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/egrep 'differ from past'",
        "expect": "differ[\\\\s]+from[\\\\s]+past[\\\\s]+@PASSWORD_HISTORY@"
    },
    "custom_item_66": {
        "description": "5.3 Reduce the sudo timeout period",
        "info": "The sudo command stays logged in as the root user for five minutes before timing out and re-requesting a password. This five minute window should be eliminated since it leaves the system extremely vulnerable. This is especially true if an exploit were to gain access to the system, since they would be able to make changes as a root user.",
        "solution": "Perform the following to implement the prescribed state:\n1.\tRun the following command in Terminal:\nsudo visudo\n2.\tIn the '# Defaults specification' section, add the line:\nDefaults timestamp_timeout=0",
        "reference": "800-171|3.1.1,800-53|AC-3(7),800-53r5|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/cat /etc/sudoers | /usr/bin/grep -v '#[\\\\s]*Defaults' | /usr/bin/grep timestamp",
        "expect": "Defaults[\\\\s]*timestamp_timeout[\\\\s]*=[\\\\s]*0"
    },
    "custom_item_67": {
        "description": "5.7 Do not enable the 'root' account",
        "info": "Enabling the root account puts the system at risk since any exploit would have unlimited access privileges within the system. Using the sudo command allows users to perform functions as a root user while limiting and password protecting the access privileges. By default the root account is not enabled on a Mac OS X client computer. It is enabled on Mac OS X Server. An administrator can escalate privileges using the sudo command (use -s or -i to get a root shell).",
        "solution": "Open System Preferences, Users & Groups. Click the lock icon to unlock it. In the Network Account Server section, click Join or Edit. Click Open Directory Utility. Click the lock icon to unlock it. Select the Edit menu > Disable Root User.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/dscl . -read /Users/root AuthenticationAuthority",
        "expect": "(No such key: AuthenticationAuthority|Disabled)"
    },
    "custom_item_68": {
        "description": "5.8 Disable automatic login",
        "info": "Disabling automatic login decreases the likelihood of an unauthorized person gaining access to a system.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\nsudo defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser",
        "reference": "800-53|AC-14a.,800-53r5|AC-14a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-14a.,LEVEL|1S,NESA|T5.6.1,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow | /usr/bin/grep autoLoginUser | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_69": {
        "description": "5.9 Require a password to wake the computer from sleep or screen saver",
        "info": "Prompting for a password when waking from sleep or screensaver mode mitigates the threat of an unauthorized person gaining access to a system in the user's absence.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal: The current user will need to log off and on for changes to take effect.\ndefaults write com.apple.screensaver askForPassword -int 1\nThe current user will need to log off and on for changes to take effect.",
        "reference": "800-171|3.1.10,800-53|AC-11,800-53r5|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "askForPassword",
        "plist_name": "com.apple.screensaver",
        "plist_user": "all"
    },
    "custom_item_70": {
        "description": "5.10 Require an administrator password to access system-wide preferences",
        "info": "By requiring a password to unlock System-wide System Preferences the risk is mitigated of a user changing configurations that affect the entire system and requires an admin user to re-authenticate to make changes",
        "solution": "In System Preferences: Security, General tab under Advanced, check 'Require an administrator password to access system-wide preferences'",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/security authorizationdb read system.preferences | /usr/bin/grep 'shared' -A1",
        "expect": ""
    },
    "custom_item_71": {
        "description": "5.11 Disable ability to login to another user's active and locked session",
        "info": "Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.",
        "solution": "Perform the following to implement the prescribed state:\nsudo vi /etc/pam.d/screensaver\nLocate 'account     required     pam_group.so no_warn group=admin,wheel fail_safe'\nRemove 'admin,'\nSave",
        "reference": "800-53|AC-10,800-53r5|AC-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,LEVEL|1S,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/grep -i 'group=admin,wheel fail_safe' /etc/pam.d/screensaver | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_72": {
        "description": "5.12 Create a custom message for the Login Screen",
        "info": "An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.",
        "solution": "Perform the following to implement the prescribed state:\nTo add text with elevated privileges:\nsudo defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText 'your text here'\nTo remove the text with elevated privileges:\nsudo defaults delete /Library/Preferences/com.apple.loginwindow LoginwindowText",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1S,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "@ACCESS_WARNING@",
        "plist_item": "LoginwindowText",
        "plist_name": "/Library/Preferences/com.apple.loginwindow"
    },
    "custom_item_73": {
        "description": "5.14 Do not enter a password-related hint",
        "info": "Password hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks",
        "solution": "1. Open System Preferences\n2. Select Users & Groups\n3. Highlight the user\n4. Select Change Password\n5. Verify that no text is entered in the Password hint box",
        "reference": "800-171|3.5.11,800-53|IA-6,800-53r5|IA-6,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-6,ITSG-33|IA-6a.,LEVEL|1NS,NESA|T5.5.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "RetriesUntilHint",
        "plist_name": "/Library/Preferences/com.apple.loginwindow"
    },
    "custom_item_74": {
        "description": "5.18 System Integrity Protection status",
        "info": "Running with System Integrity Protection on a production system runs the risk of modification system binaries or code injection of system processes that would otherwise be protected by SIP.",
        "solution": "Perform the following while booted in OS X Recovery Partition.\n1. Select Terminal from the Utilities menu\n\n2. Run the following command in Terminal:\n/usr/bin/csrutil enable\n\n3. The output should be:\nSuccessfully enabled System Integrity Protection. Please restart the machine for the changes to take effect.\n\n4. Reboot.\n\nIf a change is to the status is attempted from the booted Operating System rather than the recovery partition an error will be generated.\ncsrutil: failed to modify system integrity configuration. This tool needs to be executed from the Recovery OS.",
        "reference": "800-53|SI-7(1),800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSF|PR.DS-6,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ITSG-33|SI-7(1),LEVEL|1S,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,SWIFT-CSCv1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/csrutil status",
        "expect": "System Integrity Protection status: enabled"
    },
    "custom_item_75": {
        "description": "6.1.1 Display login window as name and password",
        "info": "Prompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Users and Groups\n3. Select Login Options\n4. Select Name and Password\nAlternatively:\n1. Run the following command in Terminal\nsudo defaults write /Library/Preferences/com.apple.loginwindow SHOWFULLNAME -bool yes",
        "reference": "800-171|3.1.7,800-53|AC-6(10),800-53r5|AC-6(10),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "1",
        "plist_item": "SHOWFULLNAME",
        "plist_name": "/Library/Preferences/com.apple.loginwindow"
    },
    "custom_item_76": {
        "description": "6.1.2 Disable 'Show password hints'",
        "info": "Password hints make it easier for unauthorized persons to gain access to systems by providing information to anyone that the user provided to assist remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Users & Groups\n3. Select Login Options\n4. Uncheck Show password hints\nAlternatively:\n1. Run the following command in Terminal:\nsudo defaults write /Library/Preferences/com.apple.loginwindow RetriesUntilHint -int 0",
        "reference": "800-171|3.5.11,800-53|IA-6,800-53r5|IA-6,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-6,ITSG-33|IA-6a.,LEVEL|1S,NESA|T5.5.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "RetriesUntilHint",
        "plist_name": "/Library/Preferences/com.apple.loginwindow"
    },
    "custom_item_77": {
        "description": "6.1.3 Disable guest account login",
        "info": "Disabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Users & Groups\n3. Select Guest User\n4. Uncheck Allow guests to log in to this computer\nAlternatively:\n1. Run the following command in Terminal:\nsudo defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool NO",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1S,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "GuestEnabled",
        "plist_name": "/Library/Preferences/com.apple.loginwindow.plist"
    },
    "custom_item_78": {
        "description": "6.1.4 Disable 'Allow guests to connect to shared folders' - AFP Sharing",
        "info": "Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly use privilege escalation attacks to take control of the system.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Users & Groups\n3. Select Guest User\n4. Uncheck Allow guests to connect to shared folders\nAlternatively:\n1. Run the following command in Terminal:\nsudo defaults write /Library/Preferences/com.apple.AppleFileServer guestAccess -bool no",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "guestAccess",
        "plist_name": "/Library/Preferences/com.apple.AppleFileServer"
    },
    "custom_item_79": {
        "description": "6.1.5 Remove Guest home folder",
        "info": "The Guest home folders are unneeded after the Guest account is disabled and could be used\ninappropriately.",
        "solution": "Perform the following to implement the prescribed state -\n      1. Run the following command in Terminal-rm -R /Users/Guest\n      2. Make sure there is no ouputImpact-\nThe Guest account should not be necessary after it is disabled and it will be automatically\nre-created if the Guest account is re-eanbled",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/bin/ls /Users/ | /usr/bin/grep Guest | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_80": {
        "description": "6.1.4 Disable 'Allow guests to connect to shared folders' - SMB Sharing",
        "info": "Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly use privilege escalation attacks to take control of the system.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open System Preferences\n2. Select Users & Groups\n3. Select Guest User\n4. Uncheck Allow guests to connect to shared folders\nAlternatively:\n1. Run the following command in Terminal:\nsudo defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess -bool no",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "AllowGuestAccess",
        "plist_name": "/Library/Preferences/SystemConfiguration/com.apple.smb.server"
    },
    "custom_item_81": {
        "description": "6.2 Turn on filename extensions",
        "info": "Visible filename extensions allows the user to identify the file type and the application it is associated with which leads to quick identification of misrepresented malicious files.",
        "solution": "Perform the following to implement the prescribed state:\n1. Select Finder\n2. Select Preferences\n3. Check Show all filename extensions\nAlternatively, use the following command:\ndefaults write NSGlobalDomain AppleShowAllExtensions -bool true",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "cmd": "/usr/bin/defaults read NSGlobalDomain AppleShowAllExtensions",
        "expect": "^1$"
    },
    "custom_item_82": {
        "description": "6.3 Disable the automatic run of safe files in Safari",
        "info": "Hackers have taken advantage of this setting via drive-by attacks. These attacks occur when a user visits a legitimate website that has been corrupted. The user unknowingly downloads a malicious file either by closing an infected pop-up or hovering over a malicious banner. The attackers make sure that the malicious file type will fall within Safari's safe files policy and will download and run without user input.",
        "solution": "Perform the following to implement the prescribed state:\n1. Open Safari\n2. Select Safari from the menu bar\n3. Select Preferences\n4. Select General\n5. Uncheck Open 'safe' files after downloading\nAlternatively run the following command in Terminal:\ndefaults write com.apple.Safari AutoOpenSafeDownloads -boolean no",
        "reference": "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),LEVEL|1S,NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/301",
        "regex": "0",
        "plist_item": "AutoOpenSafeDownloads",
        "plist_name": "com.apple.Safari",
        "plist_user": "all"
    }
}