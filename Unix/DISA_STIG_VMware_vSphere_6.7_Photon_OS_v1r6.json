{
    "custom_item_1": {
        "system": "Linux",
        "description": "PHTN-67-000034 - The Photon operating system must not have Duplicate User IDs (UIDs).",
        "info": "To ensure accountability and prevent unauthenticated access, organizational users must be uniquely identified and authenticated to prevent potential misuse and provide for non-repudiation.",
        "solution": "Open /etc/passwd with a text editor.\n\nConfigure each user account that has a duplicate UID with a unique UID.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239106r675126_rule,STIG-ID|PHTN-67-000034,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-239106",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "name": "passwd_duplicate_uid"
    },
    "custom_item_2": {
        "system": "Linux",
        "description": "PHTN-67-000100 - The Photon operating system must be configured so that all files have a valid owner and group owner.",
        "info": "If files do not have valid user and group owners, unintended access to files could occur.",
        "solution": "At the command line, execute the following command for each returned file:\n\n# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239171r675321_rule,STIG-ID|PHTN-67-000100,SWIFT-CSCv1|2.3,Vuln-ID|V-239171",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "name": "find_orphan_files",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_3": {
        "description": "Photon OS is installed",
        "file": "/etc/photon-release"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "PHTN-67-000001 - The Photon operating system must audit all account creations - useradd",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239073r816595_rule,STIG-ID|PHTN-67-000001,TBA-FIISB|36.2.3,Vuln-ID|V-239073",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep useradd",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/useradd[\\\\s]+-p[\\\\s]+x[\\\\s]+-k[\\\\s]+useradd[\\\\s]*$"
    },
    "custom_item_5": {
        "system": "Linux",
        "description": "PHTN-67-000001 - The Photon operating system must audit all account creations - groupadd",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-000018,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239073r816595_rule,STIG-ID|PHTN-67-000001,TBA-FIISB|36.2.3,Vuln-ID|V-239073",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep groupadd",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/groupadd[\\\\s]+-p[\\\\s]+x[\\\\s]+-k[\\\\s]+groupadd[\\\\s]*$"
    },
    "custom_item_6": {
        "system": "Linux",
        "description": "PHTN-67-000002 - The Photon operating system must automatically lock an account when three unsuccessful logon attempts occur.",
        "info": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nSatisfies: SRG-OS-000021-GPOS-00005, SRG-OS-000329-GPOS-00128",
        "solution": "Open /etc/pam.d/system-auth with a text editor.\n\nAdd the following line after the last auth statement:\n\nauth    required        pam_tally2.so file=/var/log/tallylog deny=3 onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53|AC-7b.,800-53r5|AC-7a.,800-53r5|AC-7b.,CAT|II,CCI|CCI-000044,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-239074r856034_rule,STIG-ID|PHTN-67-000002,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-239074",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/grep pam_tally2 /etc/pam.d/system-auth",
        "expect": "^[\\\\s]*auth[\\\\s]+required[\\\\s]+pam_tally2.so[\\\\s]+file=/var/log/tallylog[\\\\s]+deny=[1-3][\\\\s]+"
    },
    "custom_item_7": {
        "system": "Linux",
        "description": "PHTN-67-000003 - The Photon operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting SSH access - ssh",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000228-GPOS-00088",
        "solution": "At the command line, execute the following commands:\n\n# cp /etc/issue.DoD /etc/issue\n\nOpen /etc/ssh/sshd_config with a text editor and ensure that the 'Banner' line is uncommented and set to the following:\n\nBanner /etc/issue\n\nOpen /etc/issue with a text editor.\n\nEnsure that the file contains the Standard Mandatory DoD Notice and Consent Banner:\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-239075r675033_rule,STIG-ID|PHTN-67-000003,TBA-FIISB|45.2.4,Vuln-ID|V-239075",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep banner",
        "expect": "^[\\\\s]*banner[\\\\s]+/etc/issue[\\\\s]*$"
    },
    "custom_item_8": {
        "system": "Linux",
        "description": "PHTN-67-000003 - The Photon operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting SSH access - content",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000228-GPOS-00088",
        "solution": "At the command line, execute the following commands:\n\n# cp /etc/issue.DoD /etc/issue\n\nOpen /etc/ssh/sshd_config with a text editor and ensure that the 'Banner' line is uncommented and set to the following:\n\nBanner /etc/issue\n\nOpen /etc/issue with a text editor.\n\nEnsure that the file contains the Standard Mandatory DoD Notice and Consent Banner:\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-239075r675033_rule,STIG-ID|PHTN-67-000003,TBA-FIISB|45.2.4,Vuln-ID|V-239075",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/issue",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_9": {
        "system": "Linux",
        "description": "PHTN-67-000004 - The Photon operating system must limit the number of concurrent sessions to 10 for all accounts and/or account types.",
        "info": "Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to denial-of-service attacks.",
        "solution": "At the command line, execute the following command:\n\n# echo '*              hard    maxlogins      10' >> /etc/security/limits.conf",
        "reference": "800-53|AC-10,800-53r5|AC-10,CAT|II,CCI|CCI-000054,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-239076r877399_rule,STIG-ID|PHTN-67-000004,Vuln-ID|V-239076",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/security/limits.conf",
        "regex": "^[\\\\s]*\\\\*[\\\\s]+hard[\\\\s]+maxlogins[\\\\s]+",
        "expect": "^[\\\\s]*\\\\*[\\\\s]+hard[\\\\s]+maxlogins[\\\\s]+([1-9]|10)[\\\\s]*$"
    },
    "custom_item_10": {
        "system": "Linux",
        "description": "PHTN-67-000005 - The Photon operating system must set a session inactivity timeout of 15 minutes or less - duration",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.\n\nSatisfies: SRG-OS-000029-GPOS-00010, SRG-OS-000126-GPOS-00066, SRG-OS-000279-GPOS-00109",
        "solution": "Open /etc/profile.d/tmout.sh with a text editor and set its content to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null",
        "reference": "800-171|3.1.10,800-171|3.1.11,800-171|3.7.5,800-53|AC-11a.,800-53|AC-12,800-53|MA-4e.,800-53r5|AC-11a.,800-53r5|AC-12,800-53r5|MA-4e.,CAT|II,CCI|CCI-000057,CCI|CCI-000879,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,ITSG-33|AC-12,ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T2.3.8,NESA|T2.3.9,NESA|T5.4.4,NIAv2|AM23a,NIAv2|AM23b,NIAv2|NS49,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,Rule-ID|SV-239077r856035_rule,STIG-ID|PHTN-67-000005,TBA-FIISB|45.2.3,Vuln-ID|V-239077",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/profile.d/tmout.sh",
        "regex": "^[\\\\s]*TMOUT[\\\\s]*=",
        "expect": "^[\\\\s]*TMOUT[\\\\s]*=[\\\\s]*([1-8][0-9]{0,2}|900)[\\\\s]*$"
    },
    "custom_item_11": {
        "system": "Linux",
        "description": "PHTN-67-000005 - The Photon operating system must set a session inactivity timeout of 15 minutes or less - readonly",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.\n\nSatisfies: SRG-OS-000029-GPOS-00010, SRG-OS-000126-GPOS-00066, SRG-OS-000279-GPOS-00109",
        "solution": "Open /etc/profile.d/tmout.sh with a text editor and set its content to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null",
        "reference": "800-171|3.1.10,800-171|3.1.11,800-171|3.7.5,800-53|AC-11a.,800-53|AC-12,800-53|MA-4e.,800-53r5|AC-11a.,800-53r5|AC-12,800-53r5|MA-4e.,CAT|II,CCI|CCI-000057,CCI|CCI-000879,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,ITSG-33|AC-12,ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T2.3.8,NESA|T2.3.9,NESA|T5.4.4,NIAv2|AM23a,NIAv2|AM23b,NIAv2|NS49,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,Rule-ID|SV-239077r856035_rule,STIG-ID|PHTN-67-000005,TBA-FIISB|45.2.3,Vuln-ID|V-239077",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/profile.d/tmout.sh",
        "regex": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]*$",
        "expect": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]*$"
    },
    "custom_item_12": {
        "system": "Linux",
        "description": "PHTN-67-000005 - The Photon operating system must set a session inactivity timeout of 15 minutes or less - export",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.\n\nSatisfies: SRG-OS-000029-GPOS-00010, SRG-OS-000126-GPOS-00066, SRG-OS-000279-GPOS-00109",
        "solution": "Open /etc/profile.d/tmout.sh with a text editor and set its content to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null",
        "reference": "800-171|3.1.10,800-171|3.1.11,800-171|3.7.5,800-53|AC-11a.,800-53|AC-12,800-53|MA-4e.,800-53r5|AC-11a.,800-53r5|AC-12,800-53r5|MA-4e.,CAT|II,CCI|CCI-000057,CCI|CCI-000879,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,ITSG-33|AC-12,ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T2.3.8,NESA|T2.3.9,NESA|T5.4.4,NIAv2|AM23a,NIAv2|AM23b,NIAv2|NS49,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,Rule-ID|SV-239077r856035_rule,STIG-ID|PHTN-67-000005,TBA-FIISB|45.2.3,Vuln-ID|V-239077",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/profile.d/tmout.sh",
        "regex": "^[\\\\s]*export[\\\\s]+TMOUT[\\\\s]*$",
        "expect": "^[\\\\s]*export[\\\\s]+TMOUT[\\\\s]*$"
    },
    "custom_item_13": {
        "system": "Linux",
        "description": "PHTN-67-000005 - The Photon operating system must set a session inactivity timeout of 15 minutes or less - mesg",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.\n\nSatisfies: SRG-OS-000029-GPOS-00010, SRG-OS-000126-GPOS-00066, SRG-OS-000279-GPOS-00109",
        "solution": "Open /etc/profile.d/tmout.sh with a text editor and set its content to the following:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\nmesg n 2>/dev/null",
        "reference": "800-171|3.1.10,800-171|3.1.11,800-171|3.7.5,800-53|AC-11a.,800-53|AC-12,800-53|MA-4e.,800-53r5|AC-11a.,800-53r5|AC-12,800-53r5|MA-4e.,CAT|II,CCI|CCI-000057,CCI|CCI-000879,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,ITSG-33|AC-12,ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T2.3.8,NESA|T2.3.9,NESA|T5.4.4,NIAv2|AM23a,NIAv2|AM23b,NIAv2|NS49,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,Rule-ID|SV-239077r856035_rule,STIG-ID|PHTN-67-000005,TBA-FIISB|45.2.3,Vuln-ID|V-239077",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/profile.d/tmout.sh",
        "regex": "^[\\\\s]*mesg[\\\\s]+",
        "expect": "^[\\\\s]*mesg[\\\\s]+n[\\\\s]+2>[\\\\s]*/dev/null[\\\\s]*$"
    },
    "custom_item_14": {
        "system": "Linux",
        "description": "PHTN-67-000006 - The Photon operating system must have the sshd SyslogFacility set to 'authpriv' - authpriv.",
        "info": "Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'SyslogFacility' line is uncommented and set to the following:\n\nSyslogFacility AUTHPRIV\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-239078r675042_rule,STIG-ID|PHTN-67-000006,SWIFT-CSCv1|2.6,Vuln-ID|V-239078",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep syslogfacility",
        "expect": "^[\\\\s]*syslogfacility[\\\\s]+AUTHPRIV[\\\\s]*$"
    },
    "custom_item_15": {
        "system": "Linux",
        "description": "PHTN-67-000007 - The Photon operating system must have sshd authentication logging enabled.",
        "info": "Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nShipping sshd authentication events to syslog allows organizations to use their log aggregators to correlate forensic activities among multiple systems.",
        "solution": "Open /etc/rsyslog.conf with a text editor and locate the following line:\n\n$IncludeConfig /etc/vmware-syslog/syslog.conf\n\nEnsure that the following entry is put beneath the stated line and before the '# vmware services' line.\n\nauthpriv.*   /var/log/audit/sshinfo.log\n\nIf the following line is at the end of the file, it must be removed or commented out:\n\nauth.*                       /var/log/auth.log\n\nAt the command line, execute the following command:\n\n# systemctl restart syslog\n# service sshd reload",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-239079r675045_rule,STIG-ID|PHTN-67-000007,SWIFT-CSCv1|2.6,Vuln-ID|V-239079",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/rsyslog.conf",
        "regex": "^[\\\\s]*authpriv\\\\.\\\\*[\\\\s]+",
        "expect": "^[\\\\s]*authpriv\\\\.\\\\*[\\\\s]+/.+$"
    },
    "custom_item_16": {
        "system": "Linux",
        "description": "PHTN-67-000008 - The Photon operating system must have the sshd LogLevel set to 'INFO' - INFO.",
        "info": "Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nThe INFO LogLevel is required, at least, to ensure the capturing of failed login events.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'LogLevel' line is uncommented and set to the following:\n\nLogLevel INFO\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-239080r675048_rule,STIG-ID|PHTN-67-000008,SWIFT-CSCv1|2.6,Vuln-ID|V-239080",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep loglevel",
        "expect": "^[\\\\s]*loglevel[\\\\s]+INFO[\\\\s]*$"
    },
    "custom_item_17": {
        "system": "Linux",
        "description": "PHTN-67-000009 - The Photon operating system must configure sshd to use approved encryption algorithms.",
        "info": "Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nOpenSSH on the Photon operating system is compiled with a FIPS-validated cryptographic module. The 'FipsMode' setting controls whether this module is initialized and used in FIPS 140-2 mode.\n\nSatisfies: SRG-OS-000033-GPOS-00014, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173, SRG-OS-000396-GPOS-00176, SRG-OS-000423-GPOS-00187",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'FipsMode' line is uncommented and set to the following:\n\nFipsMode yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.13,800-171|3.7.5,800-171|3.13.8,800-171|3.13.11,800-53|AC-17(2),800-53|MA-4(6),800-53|SC-8,800-53|SC-13,800-53r5|AC-17(2),800-53r5|MA-4(6),800-53r5|SC-8,800-53r5|SC-13,CAT|I,CCI|CCI-000068,CCI|CCI-001453,CCI|CCI-002418,CCI|CCI-002450,CCI|CCI-002890,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.MA-2,CSF|PR.PT-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ITSG-33|AC-17(2),ITSG-33|MA-4(6),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T2.3.4,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5e,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-239081r877398_rule,STIG-ID|PHTN-67-000009,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-239081",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep fipsmode",
        "expect": "^[\\\\s]*fipsmode[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_18": {
        "system": "Linux",
        "description": "PHTN-67-000010 - The Photon operating system must configure auditd to log to disk.",
        "info": "Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content must be shipped to a central location, but it must also be logged locally.\n\nSatisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018, SRG-OS-000041-GPOS-00019",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the 'write_logs' line is uncommented and set to the following:\n\nwrite_logs = yes\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000130,CCI|CCI-000132,CCI|CCI-000133,CCI|CCI-000134,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239082r675054_rule,STIG-ID|PHTN-67-000010,SWIFT-CSCv1|6.4,Vuln-ID|V-239082",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*write_logs[\\\\s]*=",
        "expect": "^[\\\\s]*write_logs[\\\\s]*=[\\\\s]*yes[\\\\s]*$"
    },
    "custom_item_19": {
        "system": "Linux",
        "description": "PHTN-67-000011 - The Photon operating system must configure auditd to use the correct log format.",
        "info": "To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know exact, unfiltered details of the event in question.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the 'log_format' line is uncommented and set to the following:\n\nlog_format = RAW\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000131,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239083r675057_rule,STIG-ID|PHTN-67-000011,SWIFT-CSCv1|6.4,Vuln-ID|V-239083",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*log_format[\\\\s]*=",
        "expect": "^[\\\\s]*log_format[\\\\s]*=[\\\\s]*RAW[\\\\s]*$"
    },
    "custom_item_20": {
        "system": "Linux",
        "description": "PHTN-67-000012 - The Photon operating system must be configured to audit the execution of privileged functions - uid 32",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nSatisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AU-3(1),800-53|MA-4(1)(a),800-53r5|AU-3(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000135,CCI|CCI-002884,CN-L3|7.1.3.3(b),CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239084r856037_rule,STIG-ID|PHTN-67-000012,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.3,Vuln-ID|V-239084",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep execve",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b32[\\\\s]+-S[\\\\s]+execve[\\\\s]+-C[\\\\s]+uid!=euid[\\\\s]+-F[\\\\s]+euid=0[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)execpriv[\\\\s]*$"
    },
    "custom_item_21": {
        "system": "Linux",
        "description": "PHTN-67-000012 - The Photon operating system must be configured to audit the execution of privileged functions - uid 64",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nSatisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AU-3(1),800-53|MA-4(1)(a),800-53r5|AU-3(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000135,CCI|CCI-002884,CN-L3|7.1.3.3(b),CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239084r856037_rule,STIG-ID|PHTN-67-000012,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.3,Vuln-ID|V-239084",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep execve",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b64[\\\\s]+-S[\\\\s]+execve[\\\\s]+-C[\\\\s]+uid!=euid[\\\\s]+-F[\\\\s]+euid=0[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)execpriv[\\\\s]*$"
    },
    "custom_item_22": {
        "system": "Linux",
        "description": "PHTN-67-000012 - The Photon operating system must be configured to audit the execution of privileged functions - gid 32",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nSatisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AU-3(1),800-53|MA-4(1)(a),800-53r5|AU-3(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000135,CCI|CCI-002884,CN-L3|7.1.3.3(b),CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239084r856037_rule,STIG-ID|PHTN-67-000012,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.3,Vuln-ID|V-239084",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep execve",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b32[\\\\s]+-S[\\\\s]+execve[\\\\s]+-C[\\\\s]+gid!=egid[\\\\s]+-F[\\\\s]+egid=0[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)execpriv[\\\\s]*$"
    },
    "custom_item_23": {
        "system": "Linux",
        "description": "PHTN-67-000012 - The Photon operating system must be configured to audit the execution of privileged functions - gid 64",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nSatisfies: SRG-OS-000042-GPOS-00020, SRG-OS-000392-GPOS-00172",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AU-3(1),800-53|MA-4(1)(a),800-53r5|AU-3(1),800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000135,CCI|CCI-002884,CN-L3|7.1.3.3(b),CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239084r856037_rule,STIG-ID|PHTN-67-000012,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.3,Vuln-ID|V-239084",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep execve",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b64[\\\\s]+-S[\\\\s]+execve[\\\\s]+-C[\\\\s]+gid!=egid[\\\\s]+-F[\\\\s]+egid=0[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)execpriv[\\\\s]*$"
    },
    "custom_item_24": {
        "system": "Linux",
        "description": "PHTN-67-000013 - The Photon operating system audit log must log space limit problems to syslog.",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nSatisfies: SRG-OS-000046-GPOS-00022, SRG-OS-000344-GPOS-00135",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the 'space_left_action' line is uncommented and set to the following:\n\nspace_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.4,800-53|AU-5a.,800-53|AU-5(2),800-53r5|AU-5a.,800-53r5|AU-5(2),CAT|II,CCI|CCI-000139,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5a.,ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239085r856038_rule,STIG-ID|PHTN-67-000013,Vuln-ID|V-239085",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*space_left_action[\\\\s]*=",
        "expect": "^[\\\\s]*space_left_action[\\\\s]*=[\\\\s]*SYSLOG[\\\\s]*$"
    },
    "custom_item_25": {
        "system": "Linux",
        "description": "PHTN-67-000014 - The Photon operating system audit log must attempt to log audit failures to syslog - disk_full_action",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the following lines are present, not duplicated, and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239086r675066_rule,STIG-ID|PHTN-67-000014,Vuln-ID|V-239086",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*disk_full_action[\\\\s]*=",
        "expect": "^[\\\\s]*disk_full_action[\\\\s]*=[\\\\s]*SYSLOG[\\\\s]*$"
    },
    "custom_item_26": {
        "system": "Linux",
        "description": "PHTN-67-000014 - The Photon operating system audit log must attempt to log audit failures to syslog - disk_error_action",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the following lines are present, not duplicated, and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239086r675066_rule,STIG-ID|PHTN-67-000014,Vuln-ID|V-239086",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*disk_error_action[\\\\s]*=",
        "expect": "^[\\\\s]*disk_error_action[\\\\s]*=[\\\\s]*SYSLOG[\\\\s]*$"
    },
    "custom_item_27": {
        "system": "Linux",
        "description": "PHTN-67-000014 - The Photon operating system audit log must attempt to log audit failures to syslog - admin_space_left_action",
        "info": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the following lines are present, not duplicated, and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239086r675066_rule,STIG-ID|PHTN-67-000014,Vuln-ID|V-239086",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*admin_space_left_action[\\\\s]*=",
        "expect": "^[\\\\s]*admin_space_left_action[\\\\s]*=[\\\\s]*SYSLOG[\\\\s]*$"
    },
    "custom_item_28": {
        "system": "Linux",
        "description": "PHTN-67-000015 - The Photon operating system audit log must have correct permissions.",
        "info": "Audit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\nUnauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
        "solution": "At the command line, execute the following command:\n\n#  chmod 0600Replacewith the log files more permissive than 0600.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239087r675069_rule,STIG-ID|PHTN-67-000015,Vuln-ID|V-239087",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "(audit_log_file=$(/usr/bin/grep \"^log_file\" /etc/audit/auditd.conf|/usr/bin/sed s/^[^\\/]*//) && if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in \"${audit_log_file%/*}\":\\n\"; /usr/bin/stat -c \"%n permissions are %a\" ${audit_log_file%}*; else printf \"audit log file(s) not found\\n\"; fi)",
        "expect": "[\\\\s]+permissions[\\\\s]+are[\\\\s]+[0-6]00[\\\\s]*$"
    },
    "custom_item_29": {
        "system": "Linux",
        "description": "PHTN-67-000016 - The Photon operating system audit log must be owned by root.",
        "info": "Audit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\nUnauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
        "solution": "At the command line, execute the following command:\n\n#  chown root:rootReplacewith the log files not owned by root.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239088r675072_rule,STIG-ID|PHTN-67-000016,Vuln-ID|V-239088",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "(audit_log_file=$(/usr/bin/grep \"^log_file\" /etc/audit/auditd.conf|/usr/bin/sed s/^[^\\/]*//) && if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in \"${audit_log_file%/*}\":\\n\"; /usr/bin/stat -c \"%n is owned by %U\" ${audit_log_file%}*; else printf \"audit log file(s) not found\\n\"; fi)",
        "expect": "[\\\\s]+is[\\\\s]+owned[\\\\s]+by[\\\\s]+root[\\\\s]*$"
    },
    "custom_item_30": {
        "system": "Linux",
        "description": "PHTN-67-000017 - The Photon operating system audit log must be group-owned by root.",
        "info": "Audit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\nUnauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
        "solution": "At the command line, execute the following command:\n\n#  chown root:rootReplacewith the log files not group owned by root.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239089r675075_rule,STIG-ID|PHTN-67-000017,Vuln-ID|V-239089",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "(audit_log_file=$(/usr/bin/grep \"^log_file\" /etc/audit/auditd.conf|/usr/bin/sed s/^[^\\/]*//) && if [ -f \"${audit_log_file}\" ] ; then printf \"Log(s) found in \"${audit_log_file%/*}\":\\n\"; /usr/bin/stat -c \"%n is group owned by %G\" ${audit_log_file%}*; else printf \"audit log file(s) not found\\n\"; fi)",
        "expect": "[\\\\s]+is[\\\\s]+group[\\\\s]+owned[\\\\s]+by[\\\\s]+root[\\\\s]*$"
    },
    "custom_item_31": {
        "system": "Linux",
        "description": "PHTN-67-000018 - The Photon operating system must have the auditd service running.",
        "info": "Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.\n\nSatisfies: SRG-OS-000062-GPOS-00031, SRG-OS-000042-GPOS-00021, SRG-OS-000255-GPOS-00096, SRG-OS-000363-GPOS-00150, SRG-OS-000365-GPOS-00152, SRG-OS-000445-GPOS-00199, SRG-OS-000446-GPOS-00200, SRG-OS-000461-GPOS-00205, SRG-OS-000465-GPOS-00209, SRG-OS-000467-GPOS-00211, SRG-OS-000474-GPOS-00219, SRG-OS-000475-GPOS-00220",
        "solution": "At the command line, execute the following command:\n\n# systemctl enable auditd.service\n# service auditd start",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.4.3,800-171|3.4.5,800-53|AU-3,800-53|AU-3(1),800-53|AU-12a.,800-53|AU-12c.,800-53|CM-3(5),800-53|CM-5(1),800-53|SI-6a.,800-53|SI-6b.,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-12a.,800-53r5|AU-12c.,800-53r5|CM-3(5),800-53r5|CM-5(1),800-53r5|SI-6a.,800-53r5|SI-6b.,CAT|II,CCI|CCI-000135,CCI|CCI-000169,CCI|CCI-000172,CCI|CCI-001487,CCI|CCI-001744,CCI|CCI-001814,CCI|CCI-002696,CCI|CCI-002699,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CN-L3|8.1.10.6(g),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.IP-3,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.1.2,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-12a.,ITSG-33|AU-12c.,ITSG-33|CM-3,ITSG-33|CM-5(1),ITSG-33|SI-6a.,NESA|T3.2.3,NESA|T3.3.2,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|CM1,NIAv2|CM1a,NIAv2|CM1b,NIAv2|CM1c,NIAv2|SM8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv3.2.1|11.5,PCI-DSSv4.0|10.2.2,PCI-DSSv4.0|11.5.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239090r856039_rule,STIG-ID|PHTN-67-000018,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239090",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/systemctl status auditd",
        "expect": "^[\\\\s]*Active[\\\\s]*:[\\\\s]*active[\\\\s]*\\\\(running\\\\)"
    },
    "custom_item_32": {
        "system": "Linux",
        "description": "PHTN-67-000019 - The Photon operating system must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.",
        "info": "Without the capability to restrict the roles and individuals that can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
        "solution": "At the command line, execute the following command:\n\n# chmod 640Replacewith any file with incorrect permissions.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12b.,800-53r5|AU-12b.,CAT|II,CCI|CCI-000171,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12b.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239091r675081_rule,STIG-ID|PHTN-67-000019,SWIFT-CSCv1|6.4,Vuln-ID|V-239091",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /etc/audit/* -type f -exec /usr/bin/stat -c \"%n permissions are %a\" {} $1\\\\;",
        "expect": "^((?![\\\\s]+permissions[\\\\s]+are[\\\\s]+(7[0-7][0-7]|[0-6][5-7][0-7]|[0-7][0-7][1-7])).)*$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_33": {
        "system": "Linux",
        "description": "PHTN-67-000020 - The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur - 32",
        "info": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\nSatisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239092r816603_rule,STIG-ID|PHTN-67-000020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239092",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep chmod",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b32[\\\\s]+-S[\\\\s]+chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)perm_mod[\\\\s]*$"
    },
    "custom_item_34": {
        "system": "Linux",
        "description": "PHTN-67-000020 - The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur - 64",
        "info": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\nSatisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239092r816603_rule,STIG-ID|PHTN-67-000020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239092",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep chmod",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b64[\\\\s]+-S[\\\\s]+chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)perm_mod[\\\\s]*$"
    },
    "custom_item_35": {
        "system": "Linux",
        "description": "PHTN-67-000020 - The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur - uid 32",
        "info": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\nSatisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239092r816603_rule,STIG-ID|PHTN-67-000020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239092",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep chmod",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b32[\\\\s]+-S[\\\\s]+chmod,fchmod,fchown,chown,fchownat,fchmodat[\\\\s]+-F[\\\\s]+auid>=1000[\\\\s]+-F[\\\\s]+auid!=(-1|4294967295)[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)perm_mod[\\\\s]*$"
    },
    "custom_item_36": {
        "system": "Linux",
        "description": "PHTN-67-000020 - The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur - uid 64",
        "info": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\nSatisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchown,chown,fchownat,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -k perm_mod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239092r816603_rule,STIG-ID|PHTN-67-000020,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239092",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep chmod",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+-F[\\\\s]+arch=b64[\\\\s]+-S[\\\\s]+chmod,fchmod,chown,fchown,fchownat,fchmodat[\\\\s]+-F[\\\\s]+auid>=1000[\\\\s]+-F[\\\\s]+auid!=(-1|4294967295)[\\\\s]+(-k[\\\\s]+|-F[\\\\saudi]+key=)perm_mod[\\\\s]*$"
    },
    "custom_item_37": {
        "system": "Linux",
        "description": "PHTN-67-000021 - The Photon operating system must enforce password complexity by requiring that at least one uppercase character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239093r863026_rule,STIG-ID|PHTN-67-000021,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-239093",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+ucredit=-1([\\\\s]|$)"
    },
    "custom_item_38": {
        "system": "Linux",
        "description": "PHTN-67-000022 - The Photon operating system must enforce password complexity by requiring that at least one lowercase character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239094r816607_rule,STIG-ID|PHTN-67-000022,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-239094",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+lcredit=-1([\\\\s]|$)"
    },
    "custom_item_39": {
        "system": "Linux",
        "description": "PHTN-67-000023 - The Photon operating system must enforce password complexity by requiring that at least one numeric character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239095r816609_rule,STIG-ID|PHTN-67-000023,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-239095",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+dcredit=-1([\\\\s]|$)"
    },
    "custom_item_40": {
        "system": "Linux",
        "description": "PHTN-67-000024 - The Photon operating system must require that new passwords are at least four characters different from the old password.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(b),800-53r5|IA-5(1)(b),CAT|II,CCI|CCI-000195,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(b),NESA|T5.2.3,NIAv2|AM22d,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239096r816611_rule,STIG-ID|PHTN-67-000024,SWIFT-CSCv1|4.1,Vuln-ID|V-239096",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+difok=4([\\\\s]|$)"
    },
    "custom_item_41": {
        "system": "Linux",
        "description": "PHTN-67-000025 - The Photon operating system must store only encrypted representations of passwords.",
        "info": "Passwords must be protected at all times via strong, one-way encryption. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. If they are encrypted with a weak cipher, those passwords are much more vulnerable to offline brute forcing attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nAdd the following argument (sha512) to the password line:\n\npassword required pam_unix.so sha512 shadow try_first_pass\n\nSave and close.",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|II,CCI|CCI-000196,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239097r877397_rule,STIG-ID|PHTN-67-000025,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-239097",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+required[\\\\s]+pam_unix.so[^#]*[\\\\s]+sha512",
        "expect": "^[\\\\s]*password[\\\\s]+required[\\\\s]+pam_unix.so[^#]*[\\\\s]+sha512([\\\\s]|$)"
    },
    "custom_item_42": {
        "system": "Linux",
        "description": "PHTN-67-000026 - The Photon operating system must store only encrypted representations of passwords.",
        "info": "Passwords must be protected at all times via strong, one-way encryption. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. If they are encrypted with a weak cipher, those passwords are much more vulnerable to offline brute forcing attacks.",
        "solution": "Open /etc/login.defs with a text editor.\n\nAdd or replace the ENCRYPT_METHOD line as follows:\n\nENCRYPT_METHOD SHA512",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|II,CCI|CCI-000196,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239098r877397_rule,STIG-ID|PHTN-67-000026,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-239098",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*ENCRYPT_METHOD[\\\\s]+",
        "expect": "^[\\\\s]*ENCRYPT_METHOD[\\\\s]+@PASSWORD_ENCRYPTION@[\\\\s]*$"
    },
    "custom_item_43": {
        "system": "Linux",
        "description": "PHTN-67-000027 - The Photon operating system must be configured so that passwords for new users are restricted to a 24-hour minimum lifetime.",
        "info": "Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.",
        "solution": "Open /etc/login.defs with a text editor.\n\nModify the PASS_MIN_DAYS line to the following:\n\nPASS_MIN_DAYS   1",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-000198,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239099r675105_rule,STIG-ID|PHTN-67-000027,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-239099",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*PASS_MIN_DAYS[\\\\s]+",
        "expect": "^[\\\\s]*PASS_MIN_DAYS[\\\\s]+@PASSWORD_MIN_DAYS@[\\\\s]*$"
    },
    "custom_item_44": {
        "system": "Linux",
        "description": "PHTN-67-000028 - The Photon operating system must be configured so that passwords for new users are restricted to a 90-day maximum lifetime.",
        "info": "Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.",
        "solution": "Open /etc/login.defs with a text editor.\n\nModify the PASS_MAX_DAYS line to the following:\n\nPASS_MAX_DAYS   90",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-000199,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239100r675108_rule,STIG-ID|PHTN-67-000028,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-239100",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*PASS_MAX_DAYS[\\\\s]+",
        "expect": "^[\\\\s]*PASS_MAX_DAYS[\\\\s]+@PASSWORD_MAX_DAYS@[\\\\s]*$"
    },
    "custom_item_45": {
        "system": "Linux",
        "description": "PHTN-67-000029 - The Photon operating system must prohibit password reuse for a minimum of five generations.",
        "info": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nAdd the following line after the last auth statement:\n\npassword required pam_pwhistory.so enforce_for_root use_authtok remember=5 retry=3\n\nSave and close.",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CAT|II,CCI|CCI-000200,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239101r816615_rule,STIG-ID|PHTN-67-000029,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-239101",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+required[\\\\s]+pam_pwhistory.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+required[\\\\s]+pam_pwhistory.so[^#]*[\\\\s]+remember=5([\\\\s]|$)"
    },
    "custom_item_46": {
        "system": "Linux",
        "description": "PHTN-67-000030 - The Photon operating system must ensure old passwords are being stored.",
        "info": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.",
        "solution": "At the command line, execute the following commands:\n\n# touch /etc/security/opasswd\n# chown root:root /etc/security/opasswd\n# chmod 0600 /etc/security/opasswd",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CAT|II,CCI|CCI-000200,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239102r675114_rule,STIG-ID|PHTN-67-000030,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-239102",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/security/opasswd"
    },
    "custom_item_47": {
        "system": "Linux",
        "description": "PHTN-67-000031 - The Photon operating system must enforce a minimum eight-character password length.",
        "info": "The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239103r863028_rule,STIG-ID|PHTN-67-000031,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-239103",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+minlen=8([\\\\s]|$)"
    },
    "custom_item_48": {
        "system": "Linux",
        "description": "PHTN-67-000032 - The Photon operating system must only allow installation of packages signed by VMware.",
        "info": "Installation of any non-trusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by VMware.",
        "solution": "Confirm with VMware support that this package is not supported (for potential package additions after STIG publication).\n\nAt the command line, execute the following command:\n\n# rpm -e",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-239104r675120_rule,STIG-ID|PHTN-67-000032,SWIFT-CSCv1|2.3,Vuln-ID|V-239104",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/rpm -qa gpg-pubkey --qf \"%{version}-%{release} %{summary}\\n\"|grep -v \"66fd4949-4803fe57\"",
        "expect": ""
    },
    "custom_item_49": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - sctp",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+sctp[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_50": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - dccp",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+dccp[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_51": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - dccp_ipv4",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+dccp_ipv4[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_52": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - dccp_ipv6",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+dccp_ipv6[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_53": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - ipx",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+ipx[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_54": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - appletalk",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+appletalk[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_55": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - decnet",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+decnet[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_56": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - rds",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+rds[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_57": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - tipc",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+tipc[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_58": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - bluetooth",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+bluetooth[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_59": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - usb-storage",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+usb_storage[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_60": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - ieee1394",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+ieee1394[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_61": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - cramfs",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+cramfs[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_62": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - freevxfs",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+freevxfs[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_63": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - jffs2",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+jffs2[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_64": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - hfs",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+hfs[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_65": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - hfsplus",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+hfsplus[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_66": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - squashfs",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+squashfs[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_67": {
        "system": "Linux",
        "description": "PHTN-67-000033 - The Photon operating system must disable the loading of unnecessary kernel modules - udf",
        "info": "To support the requirements and principles of least functionality, the operating system must provide only essential capabilities and limit the use of modules, protocols, and/or services to only those required for the proper functioning of the product.\n\nSatisfies: SRG-OS-000096-GPOS-00050, SRG-OS-000114-GPOS-00059",
        "solution": "Open /etc/modprobe.d/modprobe.conf with a text editor and set the contents as follows:\n\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb-storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53|IA-3,800-53r5|CM-7b.,800-53r5|IA-3,CAT|II,CCI|CCI-000382,CCI|CCI-000778,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.AC-1,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|CM-7a.,ITSG-33|IA-3,ITSG-33|IA-3a.,NESA|T5.4.3,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,QCSC-v1|13.2,Rule-ID|SV-239105r840147_rule,STIG-ID|PHTN-67-000033,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-239105",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/modprobe --showconfig | grep '^install' | grep '/bin'",
        "expect": "^[\\\\s]*install[\\\\s]+udf[\\\\s]+/bin/false[\\\\s]*$"
    },
    "custom_item_68": {
        "system": "Linux",
        "description": "PHTN-67-000035 - The Photon operating system must configure sshd to disallow root logins.",
        "info": "Logging on with a user-specific account provides individual accountability for actions performed on the system. Users must log in with their individual accounts and elevate to root as necessary. Disallowing root SSH login also reduces the distribution of the root password to users who may not otherwise need that level of privilege.",
        "solution": "Open /etc/ssh/sshd_config with a text editor and ensure that the 'PermitRootLogin' line is uncommented and set to the following:\n\nPermitRootLogin no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.5.1,800-53|IA-2(5),800-53r5|IA-2(5),CAT|II,CCI|CCI-000770,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239107r675129_rule,STIG-ID|PHTN-67-000035,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-239107",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep permitrootlogin",
        "expect": "^[\\\\s]*permitrootlogin[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_69": {
        "system": "Linux",
        "description": "PHTN-67-000036 - The Photon operating system must disable new accounts immediately upon password expiration.",
        "info": "Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.\n\nDisabling inactive accounts ensures that accounts that may not have been responsibly removed are not available to attackers who may have compromised their credentials.",
        "solution": "Open /etc/default/useradd with a text editor.\n\nRemove any existing 'INACTIVE' line and add the following line:\n\nINACTIVE=0",
        "reference": "800-171|3.5.5,800-171|3.5.6,800-53|IA-4e.,800-53r5|IA-4e.,CAT|II,CCI|CCI-000795,CN-L3|7.1.2.7(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-4e.,PCI-DSSv3.2.1|8.1.4,PCI-DSSv4.0|8.2.6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239108r675132_rule,STIG-ID|PHTN-67-000036,SWIFT-CSCv1|5,Vuln-ID|V-239108",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/default/useradd",
        "regex": "^[\\\\s]*INACTIVE[\\\\s]*=",
        "expect": "^[\\\\s]*INACTIVE[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_70": {
        "system": "Linux",
        "description": "PHTN-67-000037 - The Photon operating system must use TCP syncookies.",
        "info": "A TCP SYN flood attack can cause a denial of service by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected and enables the system to continue servicing valid connection requests.\n\nSatisfies: SRG-OS-000142-GPOS-00071, SRG-OS-000420-GPOS-00186",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following line:\n\nnet.ipv4.tcp_syncookies=1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-53|SC-5,800-53|SC-5(2),800-53r5|SC-5,800-53r5|SC-5(2),CAT|II,CCI|CCI-001095,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,ITSG-33|SC-5(2),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-239109r856040_rule,STIG-ID|PHTN-67-000037,SWIFT-CSCv1|6.4,Vuln-ID|V-239109",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.tcp_syncookies",
        "expect": "^[\\\\s]*net.ipv4.tcp_syncookies[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_71": {
        "system": "Linux",
        "description": "PHTN-67-000038 - The Photon operating system must configure sshd to disconnect idle SSH sessions.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'ClientAliveInterval' line is uncommented and set to the following:\n\nClientAliveInterval 900\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-239110r675138_rule,STIG-ID|PHTN-67-000038,SWIFT-CSCv1|2.6,Vuln-ID|V-239110",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep clientaliveinterval",
        "expect": "^[\\\\s]*clientaliveinterval[\\\\s]+900[\\\\s]*$"
    },
    "custom_item_72": {
        "system": "Linux",
        "description": "PHTN-67-000039 - The Photon operating system must configure sshd to disconnect idle SSH sessions.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'ClientAliveCountMax' line is uncommented and set to the following:\n\nClientAliveCountMax 0\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-239111r675141_rule,STIG-ID|PHTN-67-000039,SWIFT-CSCv1|2.6,Vuln-ID|V-239111",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep clientalivecountmax",
        "expect": "^[\\\\s]*clientalivecountmax[\\\\s]+0[\\\\s]*$"
    },
    "custom_item_73": {
        "system": "Linux",
        "description": "PHTN-67-000040 - The Photon operating system must configure rsyslog to offload system logs to a central server.",
        "info": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Proper configuration of rsyslog ensures that information critical to forensic analysis of security events is available for future action without any manual offloading or cron jobs.\n\nSatisfies: SRG-OS-000205-GPOS-00083, SRG-OS-000274-GPOS-00104, SRG-OS-000275-GPOS-00105, SRG-OS-000276-GPOS-00106, SRG-OS-000277-GPOS-00107, SRG-OS-000479-GPOS-00224",
        "solution": "Open /etc/vmware-syslog/syslog.conf with a text editor.\n\nRemove any existing content and create a new remote server configuration line.\n\nFor UDP (*.* or AO approved logging events):\n\n*.* @:port;RSYSLOG_syslogProtocol23Format\n\nFor TCP (*.* or AO approved logging events):\n\n*.* @@:port;RSYSLOG_syslogProtocol23Format\n\nOR\n\nNavigate to https://:5480 to access the VAMI.\n\nAuthenticate and navigate to 'Syslog Configuration'.\n\nClick 'Edit' in the top right.\n\nConfigure a remote syslog server and click 'OK'.",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53|AU-4(1),800-53|SI-11a.,800-53r5|AC-2(4),800-53r5|AU-4(1),800-53r5|SI-11a.,CAT|II,CCI|CCI-001312,CCI|CCI-001683,CCI|CCI-001684,CCI|CCI-001685,CCI|CCI-001686,CCI|CCI-001851,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|AU-4,ITSG-33|SI-11b.,NESA|T3.3.1,NESA|T3.6.2,NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239112r856041_rule,STIG-ID|PHTN-67-000040,TBA-FIISB|36.2.3,Vuln-ID|V-239112",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/vmware-syslog/syslog.conf",
        "regex": "^[\\\\s]*\\\\*\\\\.\\\\*[\\\\s]+@",
        "expect": "^[\\\\s]*\\\\*\\\\.\\\\*[\\\\s]+@.*"
    },
    "custom_item_74": {
        "system": "Linux",
        "description": "PHTN-67-000041 - The Photon operating system /var/log directory must be owned by root.",
        "info": "Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state and can provide sensitive information to an unprivileged attacker.",
        "solution": "At the command line, execute the following command:\n\n# chown root:root /var/log",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-239113r675147_rule,STIG-ID|PHTN-67-000041,Vuln-ID|V-239113",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/var/log",
        "owner": "root"
    },
    "custom_item_75": {
        "system": "Linux",
        "description": "PHTN-67-000042 - The Photon operating system messages file must be owned by root.",
        "info": "Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state and can provide sensitive information to an unprivileged attacker.",
        "solution": "At the command line, execute the following command:\n\n# chown root:root /var/log/vmware/messages",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-239114r675150_rule,STIG-ID|PHTN-67-000042,Vuln-ID|V-239114",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/var/log/vmware/messages",
        "owner": "root",
        "group": "root"
    },
    "custom_item_76": {
        "system": "Linux",
        "description": "PHTN-67-000043 - The Photon operating system messages file must have mode 0640 or less permissive.",
        "info": "Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state and can provide sensitive information to an unprivileged attacker.",
        "solution": "At the command line, execute the following command:\n\n# chmod 0640 /var/log/vmware/messages",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-239115r675153_rule,STIG-ID|PHTN-67-000043,Vuln-ID|V-239115",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/var/log/vmware/messages",
        "mask": "7137"
    },
    "custom_item_77": {
        "system": "Linux",
        "description": "PHTN-67-000044 - The Photon operating system must audit all account modifications - usermod",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access.  One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-251878r816564_rule,STIG-ID|PHTN-67-000044,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-251878",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/usr/sbin/usermod'",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/usermod[\\\\s]+-p[\\\\s]+x[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)usermod[\\\\s]*$"
    },
    "custom_item_78": {
        "system": "Linux",
        "description": "PHTN-67-000044 - The Photon operating system must audit all account modifications - groupmod",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access.  One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-251878r816564_rule,STIG-ID|PHTN-67-000044,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-251878",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/usr/sbin/groupmod'",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/groupmod[\\\\s]+-p[\\\\s]+x[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)groupmod[\\\\s]*$"
    },
    "custom_item_79": {
        "system": "Linux",
        "description": "PHTN-67-000045 - The Photon operating system must audit all account modifications - passwd",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nSatisfies: SRG-OS-000239-GPOS-00089, SRG-OS-000303-GPOS-00120, SRG-OS-000304-GPOS-00121",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CCI|CCI-002130,CCI|CCI-002132,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239116r856042_rule,STIG-ID|PHTN-67-000045,TBA-FIISB|36.2.3,Vuln-ID|V-239116",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/etc/passwd'",
        "expect": "^[\\\\s]*-w[\\\\s]+/etc/passwd[\\\\s]+-p[\\\\s]+wa[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)passwd[\\\\s]*$"
    },
    "custom_item_80": {
        "system": "Linux",
        "description": "PHTN-67-000045 - The Photon operating system must audit all account modifications - shadow",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nSatisfies: SRG-OS-000239-GPOS-00089, SRG-OS-000303-GPOS-00120, SRG-OS-000304-GPOS-00121",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CCI|CCI-002130,CCI|CCI-002132,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239116r856042_rule,STIG-ID|PHTN-67-000045,TBA-FIISB|36.2.3,Vuln-ID|V-239116",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/etc/shadow'",
        "expect": "^[\\\\s]*-w[\\\\s]+/etc/shadow[\\\\s]+-p[\\\\s]+wa[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)shadow[\\\\s]*$"
    },
    "custom_item_81": {
        "system": "Linux",
        "description": "PHTN-67-000045 - The Photon operating system must audit all account modifications - group",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nSatisfies: SRG-OS-000239-GPOS-00089, SRG-OS-000303-GPOS-00120, SRG-OS-000304-GPOS-00121",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CCI|CCI-002130,CCI|CCI-002132,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239116r856042_rule,STIG-ID|PHTN-67-000045,TBA-FIISB|36.2.3,Vuln-ID|V-239116",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/etc/group'",
        "expect": "^[\\\\s]*-w[\\\\s]+/etc/group[\\\\s]+-p[\\\\s]+wa[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)group[\\\\s]*$"
    },
    "custom_item_82": {
        "system": "Linux",
        "description": "PHTN-67-000045 - The Photon operating system must audit all account modifications - gshadow",
        "info": "Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nSatisfies: SRG-OS-000239-GPOS-00089, SRG-OS-000303-GPOS-00120, SRG-OS-000304-GPOS-00121",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CCI|CCI-002130,CCI|CCI-002132,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239116r856042_rule,STIG-ID|PHTN-67-000045,TBA-FIISB|36.2.3,Vuln-ID|V-239116",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/etc/gshadow'",
        "expect": "^[\\\\s]*-w[\\\\s]+/etc/gshadow[\\\\s]+-p[\\\\s]+wa[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)gshadow[\\\\s]*$"
    },
    "custom_item_83": {
        "system": "Linux",
        "description": "PHTN-67-000046 - The Photon operating system must audit all account disabling actions.",
        "info": "When operating system accounts are disabled, user accessibility is affected. Accounts are used for identifying individual users or the operating system processes themselves. To detect and respond to events affecting user accessibility and system processing, operating systems must audit account disabling actions.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/bin/passwd -p x -k passwd\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001404,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239117r816631_rule,STIG-ID|PHTN-67-000046,TBA-FIISB|36.2.3,Vuln-ID|V-239117",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/usr/bin/passwd'",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/bin/passwd[\\\\s]+-p[\\\\s]+x[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)passwd[\\\\s]*$"
    },
    "custom_item_84": {
        "system": "Linux",
        "description": "PHTN-67-000047 - The Photon operating system must audit all account removal actions - userdel",
        "info": "When operating system accounts are removed, user accessibility is affected. Accounts are used for identifying individual users or the operating system processes themselves. To detect and respond to events affecting user accessibility and system processing, operating systems must audit account removal actions.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239118r816634_rule,STIG-ID|PHTN-67-000047,TBA-FIISB|36.2.3,Vuln-ID|V-239118",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/usr/sbin/userdel'",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/userdel[\\\\s]+-p[\\\\s]+x[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)userdel[\\\\s]*$"
    },
    "custom_item_85": {
        "system": "Linux",
        "description": "PHTN-67-000047 - The Photon operating system must audit all account removal actions - groupdel",
        "info": "When operating system accounts are removed, user accessibility is affected. Accounts are used for identifying individual users or the operating system processes themselves. To detect and respond to events affecting user accessibility and system processing, operating systems must audit account removal actions.",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001405,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-239118r816634_rule,STIG-ID|PHTN-67-000047,TBA-FIISB|36.2.3,Vuln-ID|V-239118",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep '/usr/sbin/groupdel'",
        "expect": "^[\\\\s]*-w[\\\\s]+/usr/sbin/groupdel[\\\\s]+-p[\\\\s]+x[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)groupdel[\\\\s]*$"
    },
    "custom_item_86": {
        "system": "Linux",
        "description": "PHTN-67-000048 - The Photon operating system must initiate auditing as part of the boot process.",
        "info": "Each process on the system carries an 'auditable' flag, which indicates whether its activities can be audited. Although auditd takes care of enabling this for all processes that launch after it starts, adding the kernel argument ensures the flag is set at boot for every process on the system. This includes processes created before auditd starts.",
        "solution": "Open /boot/grub2/grub.cfg with a text editor and locate the boot command line arguments. An example follows:\n\nlinux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0\n\nAdd 'audit=1' to the end of the line so it reads as follows:\n\nlinux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0 audit=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append 'audit=1' to it.\n\nReboot the system for the change to take effect.",
        "reference": "800-53|AU-14(1),800-53r5|AU-14(1),CAT|II,CCI|CCI-001464,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-14,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239119r675165_rule,STIG-ID|PHTN-67-000048,SWIFT-CSCv1|6.4,Vuln-ID|V-239119",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/cat /proc/cmdline",
        "expect": "[\\\\s]audit=1([\\\\s]|$)"
    },
    "custom_item_87": {
        "system": "Linux",
        "description": "PHTN-67-000049 - The Photon operating system audit files and directories must have correct permissions.",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command:\n\n# chown root:root /etc/audit/auditd.conf",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239120r675168_rule,STIG-ID|PHTN-67-000049,Vuln-ID|V-239120",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "owner": "root",
        "group": "root"
    },
    "custom_item_88": {
        "system": "Linux",
        "description": "PHTN-67-000050 - The Photon operating system audit files and directories must have correct permissions - auditctl",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chown root:root",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239121r675171_rule,STIG-ID|PHTN-67-000050,Vuln-ID|V-239121",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/auditctl",
        "owner": "root",
        "group": "root"
    },
    "custom_item_89": {
        "system": "Linux",
        "description": "PHTN-67-000050 - The Photon operating system audit files and directories must have correct permissions - auditd",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chown root:root",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239121r675171_rule,STIG-ID|PHTN-67-000050,Vuln-ID|V-239121",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/auditd",
        "owner": "root",
        "group": "root"
    },
    "custom_item_90": {
        "system": "Linux",
        "description": "PHTN-67-000050 - The Photon operating system audit files and directories must have correct permissions - aureport",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chown root:root",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239121r675171_rule,STIG-ID|PHTN-67-000050,Vuln-ID|V-239121",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/aureport",
        "owner": "root",
        "group": "root"
    },
    "custom_item_91": {
        "system": "Linux",
        "description": "PHTN-67-000050 - The Photon operating system audit files and directories must have correct permissions - ausearch",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chown root:root",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239121r675171_rule,STIG-ID|PHTN-67-000050,Vuln-ID|V-239121",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/ausearch",
        "owner": "root",
        "group": "root"
    },
    "custom_item_92": {
        "system": "Linux",
        "description": "PHTN-67-000050 - The Photon operating system audit files and directories must have correct permissions - autrace",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chown root:root",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239121r675171_rule,STIG-ID|PHTN-67-000050,Vuln-ID|V-239121",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/autrace",
        "owner": "root",
        "group": "root"
    },
    "custom_item_93": {
        "system": "Linux",
        "description": "PHTN-67-000051 - The Photon operating system must protect audit tools from unauthorized modification - auditctl",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.\n\nSatisfies: SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chmod 750",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239122r675174_rule,STIG-ID|PHTN-67-000051,Vuln-ID|V-239122",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/auditctl",
        "mask": "027"
    },
    "custom_item_94": {
        "system": "Linux",
        "description": "PHTN-67-000051 - The Photon operating system must protect audit tools from unauthorized modification - auditd",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.\n\nSatisfies: SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chmod 750",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239122r675174_rule,STIG-ID|PHTN-67-000051,Vuln-ID|V-239122",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/auditd",
        "mask": "027"
    },
    "custom_item_95": {
        "system": "Linux",
        "description": "PHTN-67-000051 - The Photon operating system must protect audit tools from unauthorized modification - aureport",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.\n\nSatisfies: SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chmod 750",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239122r675174_rule,STIG-ID|PHTN-67-000051,Vuln-ID|V-239122",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/aureport",
        "mask": "027"
    },
    "custom_item_96": {
        "system": "Linux",
        "description": "PHTN-67-000051 - The Photon operating system must protect audit tools from unauthorized modification - ausearch",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.\n\nSatisfies: SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chmod 750",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239122r675174_rule,STIG-ID|PHTN-67-000051,Vuln-ID|V-239122",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/ausearch",
        "mask": "027"
    },
    "custom_item_97": {
        "system": "Linux",
        "description": "PHTN-67-000051 - The Photon operating system must protect audit tools from unauthorized modification - autrace",
        "info": "Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operations on audit information.\n\nSatisfies: SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099",
        "solution": "At the command line, execute the following command for each file returned:\n\n# chmod 750",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239122r675174_rule,STIG-ID|PHTN-67-000051,Vuln-ID|V-239122",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/usr/sbin/autrace",
        "mask": "027"
    },
    "custom_item_98": {
        "system": "Linux",
        "description": "PHTN-67-000052 - The Photon operating system must enforce password complexity by requiring that at least one special character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239123r863030_rule,STIG-ID|PHTN-67-000052,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-239123",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+ocredit=-1([\\\\s]|$)"
    },
    "custom_item_99": {
        "system": "Linux",
        "description": "PHTN-67-000053 - The Photon operating system package files must not be modified.",
        "info": "Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity. Without confidence in the integrity of the auditing system and tools, the information it provides cannot be trusted.",
        "solution": "If the audit system binaries have been altered, the system must be taken offline and the ISSM must be notified immediately.\n\nReinstalling the audit tools is not supported.\n\nThe appliance should be restored from a backup or a snapshot or redeployed once the root cause is remediated.",
        "reference": "800-171|3.3.8,800-53|AU-9(3),800-53r5|AU-9(3),CAT|II,CCI|CCI-001496,CN-L3|8.1.4.3(d),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239124r877393_rule,STIG-ID|PHTN-67-000053,TBA-FIISB|37.3.3,Vuln-ID|V-239124",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/rpm -V audit | /usr/bin/grep \"^..5\" | /usr/bin/grep -v \"^...........c\"",
        "expect": ""
    },
    "custom_item_100": {
        "system": "Linux",
        "description": "PHTN-67-000054 - The Photon operating system must set an inactivity timeout value for non-interactive sessions - duration",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.",
        "solution": "Open /etc/bash.bashrc with a text editor and add the following to the end:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CAT|II,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-239125r856043_rule,STIG-ID|PHTN-67-000054,Vuln-ID|V-239125",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/bash.bashrc",
        "regex": "^[\\\\s]*TMOUT[\\\\s]*=",
        "expect": "^[\\\\s]*TMOUT[\\\\s]*=[\\\\s]*([1-8][0-9]{0,2}|900)[\\\\s]*$"
    },
    "custom_item_101": {
        "system": "Linux",
        "description": "PHTN-67-000054 - The Photon operating system must set an inactivity timeout value for non-interactive sessions - readonly",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.",
        "solution": "Open /etc/bash.bashrc with a text editor and add the following to the end:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CAT|II,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-239125r856043_rule,STIG-ID|PHTN-67-000054,Vuln-ID|V-239125",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/bash.bashrc",
        "regex": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]*$",
        "expect": "^[\\\\s]*readonly[\\\\s]+TMOUT[\\\\s]*$"
    },
    "custom_item_102": {
        "system": "Linux",
        "description": "PHTN-67-000054 - The Photon operating system must set an inactivity timeout value for non-interactive sessions - export",
        "info": "A session timeout is an action taken when a session goes idle for any reason. Rather than relying on the user to manually disconnect their session prior to going idle, the Photon operating system must be able to identify when a session has idled and take action to terminate the session.",
        "solution": "Open /etc/bash.bashrc with a text editor and add the following to the end:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CAT|II,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-239125r856043_rule,STIG-ID|PHTN-67-000054,Vuln-ID|V-239125",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/bash.bashrc",
        "regex": "^[\\\\s]*export[\\\\s]+TMOUT[\\\\s]*$",
        "expect": "^[\\\\s]*export[\\\\s]+TMOUT[\\\\s]*$"
    },
    "custom_item_103": {
        "system": "Linux",
        "description": "PHTN-67-000055 - The Photon operating system must configure sshd with a specific ListenAddress.",
        "info": "Without specifying a ListenAddress, sshd will listen on all interfaces. In situations with multiple interfaces, this may not be intended behavior and could lead to offering remote access on an unapproved network.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'ListenAddress' line is uncommented and set to a valid local IP:\n\nExample:\n\nListenAddress 169.254.1.2\n\nReplace '169.254.1.2' with the management address of the VCSA.\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-002314,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-239126r856044_rule,STIG-ID|PHTN-67-000055,SWIFT-CSCv1|2.6,Vuln-ID|V-239126",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep listenaddress",
        "expect": "^[\\\\s]*listenaddress[\\\\s]+((?!(\\\\[::\\\\]|0\\\\.0\\\\.0\\\\.0)).)*:"
    },
    "custom_item_104": {
        "system": "Linux",
        "description": "PHTN-67-000056 - The Photon operating system must audit the execution of privileged functions.",
        "info": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\nSatisfies: SRG-OS-000327-GPOS-00127, SRG-OS-000471-GPOS-00215",
        "solution": "At the command line, execute the following command to obtain a list of setuid files:\n\n# find / -xdev -perm -4000 -type f -o -perm -2000 -type f\n\nOpen /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following line:\n\nReplacewith each path found in the first command.\n\n-a always,exit -F path=-F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.1.7,800-171|3.3.1,800-171|3.3.2,800-53|AC-6(9),800-53|AU-12c.,800-53r5|AC-6(9),800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CCI|CCI-002234,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.2(d),CN-L3|8.1.4.3(a),CN-L3|8.1.10.6(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.3,ITSG-33|AC-6,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SM8,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239127r856045_rule,STIG-ID|PHTN-67-000056,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|45.1.1,Vuln-ID|V-239127",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "IFS=$'\\\\n'; LINES=$(find / -xdev \\\\( -perm -4000 -o -perm -2000 \\\\) -type f); for LINE in $LINES; do LINE=\"-a always,exit -F path=$LINE -F perm=x -F auid>=$UIDMINVAL -F audit\\\\>=1000 -F auid!=-1 -F key=privileged\"; if [ $(/sbin/auditctl -l | /bin/egrep -- \"^$LINE\" | wc -l) -eq 0 ] ; then echo \"$LINE - not found in output of auditctl -l\"; fi; done",
        "expect": "^((?!not found in).)*$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_105": {
        "system": "Linux",
        "description": "PHTN-67-000057 - The Photon operating system must configure auditd to keep five rotated log files.",
        "info": "Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation cron job, setting a reasonable number of logs to keep and configuring auditd to not rotate the logs on its own. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.",
        "solution": "Open /etc/audit/auditd.conf with a text editor. Add or change the 'num_logs' line as follows:\n\nnum_logs = 5\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239128r877391_rule,STIG-ID|PHTN-67-000057,Vuln-ID|V-239128",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*num_logs[\\\\s]*=",
        "expect": "^[\\\\s]*num_logs[\\\\s]*=[\\\\s]*[5-9][\\\\s]*$"
    },
    "custom_item_106": {
        "system": "Linux",
        "description": "PHTN-67-000058 - The Photon operating system must configure auditd to keep five rotated log files.",
        "info": "Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation cron job, setting a reasonable number of logs to keep and configuring auditd to not rotate the logs on its own. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nAdd or change the 'max_log_file_action' line as follows:\n\nmax_log_file_action = IGNORE\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239129r877391_rule,STIG-ID|PHTN-67-000058,Vuln-ID|V-239129",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*max_log_file_action[\\\\s]*=",
        "expect": "^[\\\\s]*max_log_file_action[\\\\s]*=[\\\\s]*IGNORE[\\\\s]*$"
    },
    "custom_item_107": {
        "system": "Linux",
        "description": "PHTN-67-000059 - The Photon operating system must configure a cron job to rotate auditd logs daily - bash",
        "info": "Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation cron job, setting a reasonable number of logs to keep and configuring auditd to not rotate the logs on its own. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.",
        "solution": "If /etc/cron.daily/audit-rotate does not exist, run the following commands:\n\n# touch /etc/cron.daily/audit-rotate\n# chown root:root /etc/cron.daily/audit-rotate\n# chmod 0700 /etc/cron.daily/audit-rotate\n\nOpen /etc/cron.daily/audit-rotate with a text editor.\n\nSet its contents as follows:\n\n#!/bin/bash\nservice auditd rotate",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239130r877391_rule,STIG-ID|PHTN-67-000059,Vuln-ID|V-239130",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.daily/audit-rotate",
        "regex": "^[\\\\s]*#!/bin/bash",
        "expect": "^[\\\\s]*#!/bin/bash"
    },
    "custom_item_108": {
        "system": "Linux",
        "description": "PHTN-67-000059 - The Photon operating system must configure a cron job to rotate auditd logs daily - restart",
        "info": "Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation cron job, setting a reasonable number of logs to keep and configuring auditd to not rotate the logs on its own. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.",
        "solution": "If /etc/cron.daily/audit-rotate does not exist, run the following commands:\n\n# touch /etc/cron.daily/audit-rotate\n# chown root:root /etc/cron.daily/audit-rotate\n# chmod 0700 /etc/cron.daily/audit-rotate\n\nOpen /etc/cron.daily/audit-rotate with a text editor.\n\nSet its contents as follows:\n\n#!/bin/bash\nservice auditd rotate",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239130r877391_rule,STIG-ID|PHTN-67-000059,Vuln-ID|V-239130",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.daily/audit-rotate",
        "regex": "^[\\\\s]*service[\\\\s]+auditd[\\\\s]+rotate[\\\\s]*$",
        "expect": "^[\\\\s]*service[\\\\s]+auditd[\\\\s]+rotate[\\\\s]*$"
    },
    "custom_item_109": {
        "system": "Linux",
        "description": "PHTN-67-000060 - The Photon operating system must configure auditd to log space limit problems to syslog.",
        "info": "If security personnel are not notified immediately when storage volume reaches 75% utilization, they are unable to plan for audit record storage capacity expansion.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the 'space_left' line is uncommented and set to the following:\n\nspace_left = 75\n\nAt the command line, execute the following command:\n\n# service auditd reload",
        "reference": "800-171|3.3.4,800-53|AU-5(1),800-53r5|AU-5(1),CAT|II,CCI|CCI-001855,CN-L3|7.1.3.7(e),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(1),NESA|T3.3.1,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239131r877389_rule,STIG-ID|PHTN-67-000060,TBA-FIISB|37.3.2,Vuln-ID|V-239131",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*space_left[\\\\s]*=",
        "expect": "^[\\\\s]*space_left[\\\\s]*=[\\\\s]*75[\\\\s]*$"
    },
    "custom_item_110": {
        "system": "Linux",
        "description": "PHTN-67-000061 - The Photon operating system must be configured to synchronize with an approved DoD time source.",
        "info": "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\nSatisfies: SRG-OS-000355-GPOS-00143, SRG-OS-000356-GPOS-00144",
        "solution": "Open /etc/ntp.conf with a text editor and set its contents to the following:\n\ntinker panic 0\nrestrict default kod nomodify notrap nopeer\nrestrict 127.0.0.1\nrestrict -6 ::1\ndriftfile /var/lib/ntp/drift/ntp.drift\nserverAt the command line, execute the following commands:\n\n# chkconfig ntpd on\n# systemctl start ntp\n\nOR\n\nNavigate to https://:5480 to access the VAMI.\n\nAuthenticate and navigate to 'Time'.\n\nClick 'Edit' in the top right and configure at least one appropriate NTP server.\n\nClick 'OK'.",
        "reference": "800-171|3.3.7,800-53|AU-8(1)(a),800-53|AU-8(1)(b),800-53r5|SC-45(1),CAT|II,CCI|CCI-001891,CCI|CCI-002046,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239132r877038_rule,STIG-ID|PHTN-67-000061,TBA-FIISB|37.4,Vuln-ID|V-239132",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/ntp.conf",
        "regex": "^[\\\\s]*(server|peer|multicastclient)[\\\\s]+",
        "expect": "^[\\\\s]*(server|peer|multicastclient)[\\\\s]+@NTP_SERVER@[\\\\s]*$"
    },
    "custom_item_111": {
        "system": "Linux",
        "description": "PHTN-67-000062 - The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.",
        "info": "Installation of any non-trusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. Ensuring all packages' cryptographic signatures are valid prior to installation ensures the provenance of the software and protects against malicious tampering.",
        "solution": "Open the file containing 'nosignature' with a text editor and remove the option.",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-239133r877463_rule,STIG-ID|PHTN-67-000062,Vuln-ID|V-239133",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/grep -s nosignature /usr/lib/rpm/rpmrc /etc/rpmrc ~root/.rpmrc",
        "expect": ""
    },
    "custom_item_112": {
        "system": "Linux",
        "description": "PHTN-67-000063 - The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.",
        "info": "Installation of any non-trusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.",
        "solution": "Open /etc/tdnf/tdnf.conf with a text editor.\n\nRemove any existing gpgcheck setting and add the following line:\n\ngpgcheck=1",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-239134r877463_rule,STIG-ID|PHTN-67-000063,Vuln-ID|V-239134",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/tdnf/tdnf.conf",
        "regex": "^[\\\\s]*gpgcheck[\\\\s]*=",
        "expect": "^[\\\\s]*gpgcheck[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_113": {
        "system": "Linux",
        "description": "PHTN-67-000064 - The Photon operating system RPM package management tool must cryptographically verify the authenticity of all software packages during installation.",
        "info": "Installation of any non-trusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.",
        "solution": "Open the file where gpgcheck is not set to '1' with a text editor.\n\nRemove any existing gpgcheck setting and add the following line at the end of the file:\n\ngpgcheck=1",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-239135r877463_rule,STIG-ID|PHTN-67-000064,Vuln-ID|V-239135",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/yum.repos.d/*",
        "regex": "^[\\\\s]*gpgcheck[\\\\s]*=",
        "expect": "^[\\\\s]*gpgcheck[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_114": {
        "system": "Linux",
        "description": "PHTN-67-000065 - The Photon operating system must require users to reauthenticate for privilege escalation.",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\nSatisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157, SRG-OS-000373-GPOS-00158\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Check the configuration of the '/etc/sudoers' and '/etc/sudoers.d/*' files with the following command:\n\n# visudo\nOR\n# visudo -f /etc/sudoers.d/Remove any occurrences of 'NOPASSWD' tags associated with user accounts with a password hash.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-239136r856054_rule,STIG-ID|PHTN-67-000065,Vuln-ID|V-239136",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/grep -ihs nopasswd /etc/sudoers /etc/sudoers.d/* | /usr/bin/grep -v '^#' | /usr/bin/grep -v '^%'",
        "expect": ""
    },
    "custom_item_115": {
        "system": "Linux",
        "description": "PHTN-67-000066 - The Photon operating system must prohibit the use of cached authenticators after one day.",
        "info": "If cached authentication information is out of date, the validity of the authentication information may be questionable.",
        "solution": "At the command line, execute the following command:\n\n# /opt/likewise/bin/lwregshell set_value '[HKEY_THIS_MACHINE\\Services\\lsass\\Parameters\\Providers\\ActiveDirectory]' CacheEntryExpiry 14400",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239137r856055_rule,STIG-ID|PHTN-67-000066,Vuln-ID|V-239137",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/opt/likewise/bin/lwregshell list_values 'HKEY_THIS_MACHINE\\\\Services\\\\lsass\\\\Parameters\\\\Providers\\\\ActiveDirectory' | /usr/bin/grep CacheEntryExpiry",
        "expect": "^.*CacheEntryExpiry.*\\\\(([0-9]{1,4}|1[0-3][0-9]{3}|14[0-3][0-9]{2}|14400)\\\\)"
    },
    "custom_item_116": {
        "system": "Linux",
        "description": "PHTN-67-000067 - The Photon operating system must configure sshd to use FIPS 140-2 ciphers.",
        "info": "Privileged access contains control and configuration information and is particularly sensitive, so additional protections are necessary. This is maintained by using cryptographic mechanisms such as encryption to protect confidentiality.\n\nNonlocal maintenance and diagnostic activities are activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system (e.g., the software implementing 'ping,' 'ls,' 'ipconfig,' or the hardware and software implementing the monitoring port of an Ethernet switch).\n\nThe operating system can meet this requirement through leveraging a cryptographic module.\n\nSatisfies: SRG-OS-000394-GPOS-00174, SRG-OS-000424-GPOS-00188, SRG-OS-000478-GPOS-00223",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'Ciphers' line is uncommented and set to the following:\n\nCiphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.7.5,800-171|3.13.8,800-171|3.13.11,800-53|MA-4(6),800-53|SC-8(1),800-53|SC-13,800-53r5|MA-4(6),800-53r5|SC-8(1),800-53r5|SC-13,CAT|I,CCI|CCI-002421,CCI|CCI-002450,CCI|CCI-003123,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|MA-4(6),ITSG-33|SC-8(1),ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T2.3.4,NESA|T5.4.4,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5d,NIAv2|NS5e,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-239138r877381_rule,STIG-ID|PHTN-67-000067,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,TBA-FIISB|29.1,TBA-FIISB|45.2.3,Vuln-ID|V-239138",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep ciphers",
        "expect": "^[\\\\s]*ciphers[\\\\s]+aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr[\\\\s]*$"
    },
    "custom_item_117": {
        "system": "Linux",
        "description": "PHTN-67-000068 - The Photon operating system must use OpenSSH for remote maintenance sessions.",
        "info": "If the remote connection is not closed and verified as closed, the session may remain open and be exploited by an attacker; this is referred to as a zombie session. Remote connections must be disconnected and verified as disconnected when nonlocal maintenance sessions have been terminated and are no longer available for use.\n\nSatisfies: SRG-OS-000395-GPOS-00175, SRG-OS-000074-GPOS-00042, SRG-OS-000112-GPOS-00057, SRG-OS-000113-GPOS-00058, SRG-OS-000120-GPOS-00061, SRG-OS-000125-GPOS-00065, SRG-OS-000425-GPOS-00189, SRG-OS-000426-GPOS-00190",
        "solution": "Installing openssh manually is not supported by VMware. Revert to a previous backup or redeploy the VCSA.",
        "reference": "800-171|3.5.4,800-171|3.5.10,800-171|3.7.5,800-171|3.13.8,800-53|IA-2(8),800-53|IA-2(9),800-53|IA-5(1)(c),800-53|IA-7,800-53|MA-4c.,800-53|MA-4(7),800-53|SC-8(2),800-53r5|IA-2(8),800-53r5|IA-5(1)(c),800-53r5|IA-7,800-53r5|MA-4c.,800-53r5|MA-4(7),800-53r5|SC-8(2),CAT|II,CCI|CCI-000197,CCI|CCI-000803,CCI|CCI-000877,CCI|CCI-001941,CCI|CCI-001942,CCI|CCI-002420,CCI|CCI-002422,CCI|CCI-002891,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.MA-2,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|IA-2(8),ITSG-33|IA-2(9),ITSG-33|IA-5(1)(c),ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|MA-4c.,ITSG-33|MA-4(7),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T2.3.4,NESA|T2.3.8,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM18,NIAv2|CY6,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-239139r856057_rule,STIG-ID|PHTN-67-000068,SWIFT-CSCv1|2.1,SWIFT-CSCv1|4.1,SWIFT-CSCv1|4.2,TBA-FIISB|26.1,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|45.2.3,Vuln-ID|V-239139",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/rpm -qa | /usr/bin/grep openssh-server-",
        "expect": "^[\\\\s]*openssh-server-.*[\\\\s]*$"
    },
    "custom_item_118": {
        "system": "Linux",
        "description": "PHTN-67-000069 - The Photon operating system must implement address space layout randomization (ASLR) to protect its memory from unauthorized code execution.",
        "info": "ASLR makes it more difficult for an attacker to predict the location of attack code he or she has introduced into a process's address space during an attempt at exploitation. Additionally, ASLR also makes it more difficult for an attacker to know the location of existing code to repurpose it using return-oriented programming techniques.",
        "solution": "Open /etc/sysctl.d/50-security-hardening.conf with a text editor.\n\nEnsure that the 'randomize_va_space' is uncommented and set to the following:\n\nkernel.randomize_va_space=2\n\nAt the command line, execute the following command:\n\n# sysctl --system",
        "reference": "800-53|SI-16,800-53r5|SI-16,CAT|II,CCI|CCI-002824,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,Rule-ID|SV-239140r856058_rule,STIG-ID|PHTN-67-000069,Vuln-ID|V-239140",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/cat /proc/sys/kernel/randomize_va_space",
        "expect": "^[\\\\s]*2[\\\\s]*$"
    },
    "custom_item_119": {
        "system": "Linux",
        "description": "PHTN-67-000070 - The Photon operating system must remove all software components after updated versions have been installed.",
        "info": "Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.",
        "solution": "Open /etc/tdnf/tdnf.conf with a text editor.\n\nRemove any existing 'clean_requirements_on_remove' line and ensure the following line is present:\n\nclean_requirements_on_remove=true",
        "reference": "800-171|3.14.1,800-53|SI-2(6),800-53r5|SI-2(6),CAT|II,CCI|CCI-002617,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-239141r856059_rule,STIG-ID|PHTN-67-000070,SWIFT-CSCv1|2.2,Vuln-ID|V-239141",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/tdnf/tdnf.conf",
        "regex": "^[\\\\s]*clean_requirements_on_remove[\\\\s]*=",
        "expect": "^[\\\\s]*clean_requirements_on_remove[\\\\s]*=[\\\\s]*true[\\\\s]*$"
    },
    "custom_item_120": {
        "system": "Linux",
        "description": "PHTN-67-000071 - The Photon operating system must generate audit records when the sudo command is used.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000458-GPOS-00203, SRG-OS-000463-GPOS-00207, SRG-OS-000466-GPOS-00210, SRG-OS-000468-GPOS-00212",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239142r821356_rule,STIG-ID|PHTN-67-000071,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239142",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep sudo",
        "expect": "^[\\\\s]*-a[\\\\s]+always,exit[\\\\s]+(-S[\\\\s]+all[\\\\s]+)?-F[\\\\s]+path=/usr/bin/sudo[\\\\s]+-F[\\\\s]+perm=x[\\\\s]+-F[\\\\s]+auid>=1000[\\\\s]+-F[\\\\s]+auid!=(-1|4294967295)[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)privileged[\\\\s]*$"
    },
    "custom_item_121": {
        "system": "Linux",
        "description": "PHTN-67-000072 - The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur - faillog",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000470-GPOS-00214, SRG-OS-000472-GPOS-00217, SRG-OS-000473-GPOS-00218",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /var/log/faillog -p wa\n-w /var/log/lastlog -p wa\n-w /var/log/tallylog -p wa\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239143r816646_rule,STIG-ID|PHTN-67-000072,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239143",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep faillog",
        "expect": "^[\\\\s]*-w[\\\\s]+/var/log/faillog[\\\\s]+-p[\\\\s]+wa[\\\\s]*$"
    },
    "custom_item_122": {
        "system": "Linux",
        "description": "PHTN-67-000072 - The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur - lastlog",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000470-GPOS-00214, SRG-OS-000472-GPOS-00217, SRG-OS-000473-GPOS-00218",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /var/log/faillog -p wa\n-w /var/log/lastlog -p wa\n-w /var/log/tallylog -p wa\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239143r816646_rule,STIG-ID|PHTN-67-000072,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239143",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep lastlog",
        "expect": "^[\\\\s]*-w[\\\\s]+/var/log/lastlog[\\\\s]+-p[\\\\s]+wa[\\\\s]*$"
    },
    "custom_item_123": {
        "system": "Linux",
        "description": "PHTN-67-000072 - The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur - tallylog",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000470-GPOS-00214, SRG-OS-000472-GPOS-00217, SRG-OS-000473-GPOS-00218",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /var/log/faillog -p wa\n-w /var/log/lastlog -p wa\n-w /var/log/tallylog -p wa\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239143r816646_rule,STIG-ID|PHTN-67-000072,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239143",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep tallylog",
        "expect": "^[\\\\s]*-w[\\\\s]+/var/log/tallylog[\\\\s]+-p[\\\\s]+wa[\\\\s]*$"
    },
    "custom_item_124": {
        "system": "Linux",
        "description": "PHTN-67-000073 - The Photon operating system must audit the insmod module.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000471-GPOS-00216, SRG-OS-000477-GPOS-00222",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /sbin/insmod -p x\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239144r816649_rule,STIG-ID|PHTN-67-000073,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239144",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep insmod",
        "expect": "^[\\\\s]*-w[\\\\s]+/sbin/insmod[\\\\s]+-p[\\\\s]+x[\\\\s]*$"
    },
    "custom_item_125": {
        "system": "Linux",
        "description": "PHTN-67-000074 - The Photon operating system auditd service must generate audit records for all account creations, modifications, disabling, and termination events.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).",
        "solution": "Open /etc/audit/rules.d/audit.STIG.rules with a text editor and add the following lines:\n\n-w /etc/security/opasswd -p wa -k opasswd\n\nAt the command line, execute the following command:\n\n# /sbin/augenrules --load",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239145r816652_rule,STIG-ID|PHTN-67-000074,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-239145",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/auditctl -l | /usr/bin/grep opasswd",
        "expect": "^[\\\\s]*-w[\\\\s]+/etc/security/opasswd[\\\\s]+-p[\\\\s]+[a-z]*w[a-z]*[\\\\s]+(-k[\\\\s]+|-F[\\\\s]+key=)opasswd[\\\\s]*$"
    },
    "custom_item_126": {
        "system": "Linux",
        "description": "PHTN-67-000075 - The Photon operating system must use the pam_cracklib module.",
        "info": "If the operating system allows the user to select passwords based on dictionary words, this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239146r863032_rule,STIG-ID|PHTN-67-000075,SWIFT-CSCv1|2.3,Vuln-ID|V-239146",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so"
    },
    "custom_item_127": {
        "system": "Linux",
        "description": "PHTN-67-000076 - The Photon operating system must set the FAIL_DELAY parameter.",
        "info": "Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.",
        "solution": "Open /etc/login.defs with a text editor.\n\nAdd the following line after the last auth statement:\n\nFAIL_DELAY 4",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239147r675249_rule,STIG-ID|PHTN-67-000076,SWIFT-CSCv1|2.3,Vuln-ID|V-239147",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*FAIL_DELAY[\\\\s]+",
        "expect": "^[\\\\s]*FAIL_DELAY[\\\\s]+@PASSWORD_FAIL_DELAY@[\\\\s]*$"
    },
    "custom_item_128": {
        "system": "Linux",
        "description": "PHTN-67-000077 - The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.",
        "info": "Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.",
        "solution": "Open /etc/pam.d/system-auth with a text editor.\n\nRemove any existing 'pam_faildelay' line and add the following line at the end of the file:\n\nauth      optional    pam_faildelay.so  delay=4000000",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239148r675252_rule,STIG-ID|PHTN-67-000077,SWIFT-CSCv1|2.3,Vuln-ID|V-239148",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-auth",
        "regex": "^[\\\\s]*auth[\\\\s]+optional[\\\\s]+pam_faildelay.so[\\\\s]+",
        "expect": "^[\\\\s]*auth[\\\\s]+optional[\\\\s]+pam_faildelay.so[^#]*[\\\\s]+delay=4000000([\\\\s]|$)"
    },
    "custom_item_129": {
        "system": "Linux",
        "description": "PHTN-67-000078 - The Photon operating system must ensure audit events are flushed to disk at proper intervals - freq",
        "info": "Without setting a balance between performance and ensuring all audit events are written to disk, performance of the system may suffer or the risk of missing audit entries may be too high.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the line below is present and any existing 'flush' and 'freq' settings are removed.\n\nflush = INCREMENTAL_ASYNC\nfreq = 50",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239149r675255_rule,STIG-ID|PHTN-67-000078,SWIFT-CSCv1|2.3,Vuln-ID|V-239149",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*freq[\\\\s]*=",
        "expect": "^[\\\\s]*freq[\\\\s]*=[\\\\s]*50[\\\\s]*$"
    },
    "custom_item_130": {
        "system": "Linux",
        "description": "PHTN-67-000078 - The Photon operating system must ensure audit events are flushed to disk at proper intervals - flush",
        "info": "Without setting a balance between performance and ensuring all audit events are written to disk, performance of the system may suffer or the risk of missing audit entries may be too high.",
        "solution": "Open /etc/audit/auditd.conf with a text editor.\n\nEnsure that the line below is present and any existing 'flush' and 'freq' settings are removed.\n\nflush = INCREMENTAL_ASYNC\nfreq = 50",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239149r675255_rule,STIG-ID|PHTN-67-000078,SWIFT-CSCv1|2.3,Vuln-ID|V-239149",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/audit/auditd.conf",
        "regex": "^[\\\\s]*flush[\\\\s]*=",
        "expect": "^[\\\\s]*flush[\\\\s]*=[\\\\s]*INCREMENTAL_ASYNC[\\\\s]*$"
    },
    "custom_item_131": {
        "system": "Linux",
        "description": "PHTN-67-000079 - The Photon operating system must ensure root $PATH entries are appropriate.",
        "info": "The $PATH variable contains a semicolon-delimited set of directories that allows root to not specify the full path for a limited set of binaries. Having unexpected directories in $PATH can lead to root running a binary other than the one intended.",
        "solution": "At the command line, execute the following command:\n\n# export PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239150r675258_rule,STIG-ID|PHTN-67-000079,SWIFT-CSCv1|2.3,Vuln-ID|V-239150",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/echo $PATH",
        "expect": "^[\\\\s]*/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/java/jre-vmware/bin:/opt/vmware/bin[\\\\s]*$"
    },
    "custom_item_132": {
        "system": "Linux",
        "description": "PHTN-67-000080 - The Photon operating system must create a home directory for all new local interactive user accounts.",
        "info": "If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.",
        "solution": "Open /etc/login.defs with a text editor.\n\nEnsure that the following is present and any existing CREATE_HOME line is removed:\n\nCREATE_HOME     yes",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239151r675261_rule,STIG-ID|PHTN-67-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-239151",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*CREATE_HOME[\\\\s]+",
        "expect": "^[\\\\s]*CREATE_HOME[\\\\s]+@CREATE_HOME@[\\\\s]*$"
    },
    "custom_item_133": {
        "system": "Linux",
        "description": "PHTN-67-000081 - The Photon operating system must disable the debug-shell service.",
        "info": "The debug-shell service is intended to diagnose system-related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9. This service must remain disabled until and unless otherwise directed by VMware support.",
        "solution": "At the command line, execute the following commands:\n\n# systemctl stop debug-shell.service\n# systemctl disable debug-shell.service\n\nReboot for changes to take effect.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239152r675264_rule,STIG-ID|PHTN-67-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-239152",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/systemctl is-enabled debug-shell.service",
        "expect": "^[\\\\s]*disabled[\\\\s]*$"
    },
    "custom_item_134": {
        "system": "Linux",
        "description": "PHTN-67-000083 - The Photon operating system must configure sshd to disallow Generic Security Service Application Program Interface (GSSAPI) authentication.",
        "info": "GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the system's GSSAPI to remote hosts, increasing the attack surface of the system.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'GSSAPIAuthentication' line is uncommented and set to the following:\n\nGSSAPIAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239154r675270_rule,STIG-ID|PHTN-67-000083,SWIFT-CSCv1|2.3,Vuln-ID|V-239154",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep gssapiauthentication",
        "expect": "^[\\\\s]*gssapiauthentication[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_135": {
        "system": "Linux",
        "description": "PHTN-67-000084 - The Photon operating system must configure sshd to disable environment processing.",
        "info": "Enabling environment processing may enable users to bypass access restrictions in some configurations and must therefore be disabled.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'PermitUserEnvironment' line is uncommented and set to the following:\n\nPermitUserEnvironment no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239155r675273_rule,STIG-ID|PHTN-67-000084,SWIFT-CSCv1|2.3,Vuln-ID|V-239155",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep permituserenvironment",
        "expect": "^[\\\\s]*permituserenvironment[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_136": {
        "system": "Linux",
        "description": "PHTN-67-000085 - The Photon operating system must configure sshd to disable X11 forwarding.",
        "info": "X11 is an older, insecure graphics forwarding protocol. It is not used by Photon and should be disabled as a general best practice to limit attack surface area and communication channels.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'X11Forwarding' line is uncommented and set to the following:\n\nX11Forwarding no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239156r675276_rule,STIG-ID|PHTN-67-000085,SWIFT-CSCv1|2.3,Vuln-ID|V-239156",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep x11forwarding",
        "expect": "^[\\\\s]*x11forwarding[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_137": {
        "system": "Linux",
        "description": "PHTN-67-000086 - The Photon operating system must configure sshd to perform strict mode checking of home directory configuration files.",
        "info": "If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'StrictModes' line is uncommented and set to the following:\n\nStrictModes yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239157r675279_rule,STIG-ID|PHTN-67-000086,SWIFT-CSCv1|2.3,Vuln-ID|V-239157",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep strictmodes",
        "expect": "^[\\\\s]*strictmodes[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_138": {
        "system": "Linux",
        "description": "PHTN-67-000087 - The Photon operating system must configure sshd to disallow Kerberos authentication.",
        "info": "If Kerberos is enabled through SSH, sshd provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'KerberosAuthentication' line is uncommented and set to the following:\n\nKerberosAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239158r675282_rule,STIG-ID|PHTN-67-000087,SWIFT-CSCv1|2.3,Vuln-ID|V-239158",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep kerberosauthentication",
        "expect": "^[\\\\s]*kerberosauthentication[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_139": {
        "system": "Linux",
        "description": "PHTN-67-000088 - The Photon operating system must configure sshd to use privilege separation.",
        "info": "Privilege separation in sshd causes the process to drop root privileges when not needed, which would decrease the impact of software vulnerabilities in the unprivileged section.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'UsePrivilegeSeparation' line is uncommented and set to the following:\n\nUsePrivilegeSeparation yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239159r675285_rule,STIG-ID|PHTN-67-000088,SWIFT-CSCv1|2.3,Vuln-ID|V-239159",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)useprivilegeseparation(?-i)[\\\\s]+",
        "expect": "^[\\\\s]*(?i)useprivilegeseparation(?-i)[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_140": {
        "system": "Linux",
        "description": "PHTN-67-000089 - The Photon operating system must configure sshd to disallow authentication with an empty password.",
        "info": "Blank passwords are one of the first things an attacker checks for when probing a system. Even is the user somehow has a blank password on the OS, sshd must not allow that user to log in.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'PermitEmptyPasswords' line is uncommented and set to the following:\n\nPermitEmptyPasswords no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239160r675288_rule,STIG-ID|PHTN-67-000089,SWIFT-CSCv1|2.3,Vuln-ID|V-239160",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep permitemptypasswords",
        "expect": "^[\\\\s]*permitemptypasswords[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_141": {
        "system": "Linux",
        "description": "PHTN-67-000090 - The Photon operating system must configure sshd to disallow compression of the encrypted session stream.",
        "info": "If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'Compression' line is uncommented and set to the following:\n\nCompression no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239161r675291_rule,STIG-ID|PHTN-67-000090,SWIFT-CSCv1|2.3,Vuln-ID|V-239161",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep compression",
        "expect": "^[\\\\s]*compression[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_142": {
        "system": "Linux",
        "description": "PHTN-67-000091 - The Photon operating system must configure sshd to display the last login immediately after authentication.",
        "info": "Providing users with feedback on the last time they logged on via SSH facilitates user recognition and reporting of unauthorized account use.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'PrintLastLog' line is uncommented and set to the following:\n\nPrintLastLog yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239162r675294_rule,STIG-ID|PHTN-67-000091,SWIFT-CSCv1|2.3,Vuln-ID|V-239162",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep printlastlog",
        "expect": "^[\\\\s]*printlastlog[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_143": {
        "system": "Linux",
        "description": "PHTN-67-000092 - The Photon operating system must configure sshd to ignore user-specific trusted hosts lists.",
        "info": "SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'IgnoreRhosts' line is uncommented and set to the following:\n\nIgnoreRhosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239163r675297_rule,STIG-ID|PHTN-67-000092,SWIFT-CSCv1|2.3,Vuln-ID|V-239163",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep ignorerhosts",
        "expect": "^[\\\\s]*ignorerhosts[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_144": {
        "system": "Linux",
        "description": "PHTN-67-000093 - The Photon operating system must configure sshd to ignore user-specific known_host files.",
        "info": "SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines which must also be ignored while disabling host-based authentication generally.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'IgnoreUserKnownHosts' line is uncommented and set to the following:\n\nIgnoreUserKnownHosts yes\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239164r675300_rule,STIG-ID|PHTN-67-000093,SWIFT-CSCv1|2.3,Vuln-ID|V-239164",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep ignoreuserknownhosts",
        "expect": "^[\\\\s]*ignoreuserknownhosts[\\\\s]+yes[\\\\s]*$"
    },
    "custom_item_145": {
        "system": "Linux",
        "description": "PHTN-67-000094 - The Photon operating system must configure sshd to limit the number of allowed login attempts per connection.",
        "info": "By setting the login attempt limit to a low value, an attacker will be forced to reconnect frequently, which severely limits the speed and effectiveness of brute-force attacks.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'MaxAuthTries' line is uncommented and set to the following:\n\nMaxAuthTries 2\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239165r675303_rule,STIG-ID|PHTN-67-000094,SWIFT-CSCv1|2.3,Vuln-ID|V-239165",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep maxauthtries",
        "expect": "^[\\\\s]*maxauthtries[\\\\s]+2[\\\\s]*$"
    },
    "custom_item_146": {
        "system": "Linux",
        "description": "PHTN-67-000095 - The Photon operating system must be configured so that the x86 Ctrl-Alt-Delete key sequence is disabled on the command line - masked",
        "info": "When the Ctrl-Alt-Del target is enabled, a locally logged-on user who presses Ctrl-Alt-Delete, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of a mixed OS environment, this can create the risk of short-term loss of systems availability due to unintentional reboot.",
        "solution": "At the command line, execute the following command:\n\n# systemctl mask ctrl-alt-del.target",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239166r675306_rule,STIG-ID|PHTN-67-000095,SWIFT-CSCv1|2.3,Vuln-ID|V-239166",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/systemctl status ctrl-alt-del.target",
        "expect": "^[\\\\s]*Loaded:[\\\\s]+masked[\\\\s]+"
    },
    "custom_item_147": {
        "system": "Linux",
        "description": "PHTN-67-000095 - The Photon operating system must be configured so that the x86 Ctrl-Alt-Delete key sequence is disabled on the command line - inactive",
        "info": "When the Ctrl-Alt-Del target is enabled, a locally logged-on user who presses Ctrl-Alt-Delete, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of a mixed OS environment, this can create the risk of short-term loss of systems availability due to unintentional reboot.",
        "solution": "At the command line, execute the following command:\n\n# systemctl mask ctrl-alt-del.target",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239166r675306_rule,STIG-ID|PHTN-67-000095,SWIFT-CSCv1|2.3,Vuln-ID|V-239166",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/systemctl status ctrl-alt-del.target",
        "expect": "^[\\\\s]*Active:[\\\\s]+inactive[\\\\s]+"
    },
    "custom_item_148": {
        "system": "Linux",
        "description": "PHTN-67-000096 - The Photon operating system must be configured so that the /etc/skel default scripts are protected from unauthorized modification - bash_logout",
        "info": "If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 750 /etc/skel/.bash_logout\n# chmod 644 /etc/skel/.bash_profile\n# chmod 750 /etc/skel/.bashrc\n# chown root:root /etc/skel/.bash_logout\n# chown root:root /etc/skel/.bash_profile\n# chown root:root /etc/skel/.bashrc",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239167r675309_rule,STIG-ID|PHTN-67-000096,SWIFT-CSCv1|2.3,Vuln-ID|V-239167",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/skel/.bash_logout",
        "owner": "root",
        "mask": "027",
        "group": "root"
    },
    "custom_item_149": {
        "system": "Linux",
        "description": "PHTN-67-000096 - The Photon operating system must be configured so that the /etc/skel default scripts are protected from unauthorized modification - bash_profile",
        "info": "If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 750 /etc/skel/.bash_logout\n# chmod 644 /etc/skel/.bash_profile\n# chmod 750 /etc/skel/.bashrc\n# chown root:root /etc/skel/.bash_logout\n# chown root:root /etc/skel/.bash_profile\n# chown root:root /etc/skel/.bashrc",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239167r675309_rule,STIG-ID|PHTN-67-000096,SWIFT-CSCv1|2.3,Vuln-ID|V-239167",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/skel/.bash_profile",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_150": {
        "system": "Linux",
        "description": "PHTN-67-000096 - The Photon operating system must be configured so that the /etc/skel default scripts are protected from unauthorized modification - bashrc",
        "info": "If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 750 /etc/skel/.bash_logout\n# chmod 644 /etc/skel/.bash_profile\n# chmod 750 /etc/skel/.bashrc\n# chown root:root /etc/skel/.bash_logout\n# chown root:root /etc/skel/.bash_profile\n# chown root:root /etc/skel/.bashrc",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239167r675309_rule,STIG-ID|PHTN-67-000096,SWIFT-CSCv1|2.3,Vuln-ID|V-239167",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/skel/.bashrc",
        "owner": "root",
        "mask": "027",
        "group": "root"
    },
    "custom_item_151": {
        "system": "Linux",
        "description": "PHTN-67-000097 - The Photon operating system must be configured so that the /root path is protected from unauthorized access.",
        "info": "If the /root path is accessible from users other than root, unauthorized users could change the root partitions files.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 700 /root\n# chown root:root /root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239168r675312_rule,STIG-ID|PHTN-67-000097,SWIFT-CSCv1|2.3,Vuln-ID|V-239168",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/root",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_152": {
        "system": "Linux",
        "description": "PHTN-67-000098 - The Photon operating system must be configured so that all global initialization scripts are protected from unauthorized modification.",
        "info": "Local initialization files are used to configure the user's shell environment upon login. Malicious modification of these files could compromise accounts upon login.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod o-w# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239169r675315_rule,STIG-ID|PHTN-67-000098,SWIFT-CSCv1|2.3,Vuln-ID|V-239169",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /etc/bash.bashrc /etc/profile /etc/profile.d/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;",
        "expect": "",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_153": {
        "system": "Linux",
        "description": "PHTN-67-000099 - The Photon operating system must be configured so that all system startup scripts are protected from unauthorized modification.",
        "info": "If system startup scripts are accessible to unauthorized modification, this could compromise the system on startup.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod o-w# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239170r675318_rule,STIG-ID|PHTN-67-000099,SWIFT-CSCv1|2.3,Vuln-ID|V-239170",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /etc/rc.d/* -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;",
        "expect": "",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_154": {
        "system": "Linux",
        "description": "PHTN-67-000101 - The Photon operating system must be configured so that the /etc/cron.allow file is protected from unauthorized modification.",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 600 /etc/cron.allow\n# chown root:root /etc/cron.allow",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239172r675324_rule,STIG-ID|PHTN-67-000101,SWIFT-CSCv1|2.3,Vuln-ID|V-239172",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.allow",
        "owner": "root",
        "mask": "177",
        "group": "root"
    },
    "custom_item_155": {
        "system": "Linux",
        "description": "PHTN-67-000102 - The Photon operating system must be configured so that all cron jobs are protected from unauthorized modification.",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod o-w# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239173r675327_rule,STIG-ID|PHTN-67-000102,SWIFT-CSCv1|2.3,Vuln-ID|V-239173",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /etc/cron.d/ /etc/cron.daily/ /etc/cron.hourly/ /etc/cron.monthly/ /etc/cron.weekly/ -xdev -type f -a '(' -perm -002 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\; 2>/dev/null",
        "expect": "",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_156": {
        "system": "Linux",
        "description": "PHTN-67-000103 - The Photon operating system must be configured so that all cron paths are protected from unauthorized modification - cron.d",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 755# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239174r675330_rule,STIG-ID|PHTN-67-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-239174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.d",
        "owner": "root",
        "mask": "022",
        "group": "root"
    },
    "custom_item_157": {
        "system": "Linux",
        "description": "PHTN-67-000103 - The Photon operating system must be configured so that all cron paths are protected from unauthorized modification - cron.daily",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 755# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239174r675330_rule,STIG-ID|PHTN-67-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-239174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.daily",
        "owner": "root",
        "mask": "022",
        "group": "root"
    },
    "custom_item_158": {
        "system": "Linux",
        "description": "PHTN-67-000103 - The Photon operating system must be configured so that all cron paths are protected from unauthorized modification - cron.hourly",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 755# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239174r675330_rule,STIG-ID|PHTN-67-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-239174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.hourly",
        "owner": "root",
        "mask": "022",
        "group": "root"
    },
    "custom_item_159": {
        "system": "Linux",
        "description": "PHTN-67-000103 - The Photon operating system must be configured so that all cron paths are protected from unauthorized modification - cron.monthly",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 755# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239174r675330_rule,STIG-ID|PHTN-67-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-239174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.monthly",
        "owner": "root",
        "mask": "022",
        "group": "root"
    },
    "custom_item_160": {
        "system": "Linux",
        "description": "PHTN-67-000103 - The Photon operating system must be configured so that all cron paths are protected from unauthorized modification - cron.weekly",
        "info": "If cron files and folders are accessible to unauthorized users, malicious jobs may be created.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 755# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239174r675330_rule,STIG-ID|PHTN-67-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-239174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/cron.weekly",
        "owner": "root",
        "mask": "022",
        "group": "root"
    },
    "custom_item_161": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv4.conf.all.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net.ipv4.conf.all.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_162": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv4.conf.default.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net.ipv4.conf.default.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_163": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv4.conf.eth0.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.accept_source_route",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_164": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv6.conf.all.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net.ipv6.conf.all.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_165": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv6.conf.default.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net.ipv6.conf.default.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_166": {
        "system": "Linux",
        "description": "PHTN-67-000104 - The Photon operating system must not forward IPv4 or IPv6 source-routed packets - net.ipv6.conf.eth0.accept_source_route",
        "info": "Source routing is an Internet Protocol (IP) mechanism that allows an IP packet to carry information, a list of addresses, which tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the 'route record', provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.eth0.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\nnet.ipv6.conf.eth0.accept_source_route = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239175r816656_rule,STIG-ID|PHTN-67-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-239175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.eth0.accept_source_route",
        "expect": "^[\\\\s]*net.ipv6.conf.eth0.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_167": {
        "system": "Linux",
        "description": "PHTN-67-000105 - The Photon operating system must not respond to IPv4 Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.",
        "info": "Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following line:\n\nnet.ipv4.icmp_echo_ignore_broadcasts=1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239176r816658_rule,STIG-ID|PHTN-67-000105,SWIFT-CSCv1|2.3,Vuln-ID|V-239176",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.icmp_echo_ignore_broadcasts",
        "expect": "^[\\\\s]*net.ipv4.icmp_echo_ignore_broadcasts[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_168": {
        "system": "Linux",
        "description": "PHTN-67-000106 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted - net.ipv4.conf.all.accept_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239177r816660_rule,STIG-ID|PHTN-67-000106,SWIFT-CSCv1|2.3,Vuln-ID|V-239177",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.all.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_169": {
        "system": "Linux",
        "description": "PHTN-67-000106 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted - net.ipv4.conf.default.accept_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239177r816660_rule,STIG-ID|PHTN-67-000106,SWIFT-CSCv1|2.3,Vuln-ID|V-239177",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.default.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_170": {
        "system": "Linux",
        "description": "PHTN-67-000106 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted - net.ipv4.conf.eth0.accept_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239177r816660_rule,STIG-ID|PHTN-67-000106,SWIFT-CSCv1|2.3,Vuln-ID|V-239177",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.accept_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_171": {
        "system": "Linux",
        "description": "PHTN-67-000107 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted - net.ipv4.conf.all.secure_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.eth0.secure_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239178r816662_rule,STIG-ID|PHTN-67-000107,SWIFT-CSCv1|2.3,Vuln-ID|V-239178",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.secure_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.all.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_172": {
        "system": "Linux",
        "description": "PHTN-67-000107 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted - net.ipv4.conf.default.secure_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.eth0.secure_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239178r816662_rule,STIG-ID|PHTN-67-000107,SWIFT-CSCv1|2.3,Vuln-ID|V-239178",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.secure_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.default.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_173": {
        "system": "Linux",
        "description": "PHTN-67-000107 - The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted - net.ipv4.conf.eth0.secure_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.eth0.secure_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239178r816662_rule,STIG-ID|PHTN-67-000107,SWIFT-CSCv1|2.3,Vuln-ID|V-239178",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.secure_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_174": {
        "system": "Linux",
        "description": "PHTN-67-000108 - The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects - net.ipv4.conf.all.send_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239179r816664_rule,STIG-ID|PHTN-67-000108,SWIFT-CSCv1|2.3,Vuln-ID|V-239179",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.send_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.all.send_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_175": {
        "system": "Linux",
        "description": "PHTN-67-000108 - The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects - net.ipv4.conf.default.send_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239179r816664_rule,STIG-ID|PHTN-67-000108,SWIFT-CSCv1|2.3,Vuln-ID|V-239179",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.send_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.default.send_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_176": {
        "system": "Linux",
        "description": "PHTN-67-000108 - The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects - net.ipv4.conf.eth0.send_redirects",
        "info": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239179r816664_rule,STIG-ID|PHTN-67-000108,SWIFT-CSCv1|2.3,Vuln-ID|V-239179",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.send_redirects",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.send_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_177": {
        "system": "Linux",
        "description": "PHTN-67-000109 - The Photon operating system must log IPv4 packets with impossible addresses - net.ipv4.conf.all.log_martians",
        "info": "The presence of 'martian' packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.eth0.log_martians = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239180r816666_rule,STIG-ID|PHTN-67-000109,SWIFT-CSCv1|2.3,Vuln-ID|V-239180",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.log_martians",
        "expect": "^[\\\\s]*net.ipv4.conf.all.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_178": {
        "system": "Linux",
        "description": "PHTN-67-000109 - The Photon operating system must log IPv4 packets with impossible addresses - net.ipv4.conf.default.log_martians",
        "info": "The presence of 'martian' packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.eth0.log_martians = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239180r816666_rule,STIG-ID|PHTN-67-000109,SWIFT-CSCv1|2.3,Vuln-ID|V-239180",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.log_martians",
        "expect": "^[\\\\s]*net.ipv4.conf.default.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_179": {
        "system": "Linux",
        "description": "PHTN-67-000109 - The Photon operating system must log IPv4 packets with impossible addresses - net.ipv4.conf.eth0.log_martians",
        "info": "The presence of 'martian' packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.eth0.log_martians = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239180r816666_rule,STIG-ID|PHTN-67-000109,SWIFT-CSCv1|2.3,Vuln-ID|V-239180",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.log_martians",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_180": {
        "system": "Linux",
        "description": "PHTN-67-000110 - The Photon operating system must use a reverse-path filter for IPv4 network traffic - net.ipv4.conf.all.rp_filter",
        "info": "Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.eth0.rp_filter = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239181r816668_rule,STIG-ID|PHTN-67-000110,SWIFT-CSCv1|2.3,Vuln-ID|V-239181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.rp_filter",
        "expect": "^[\\\\s]*net.ipv4.conf.all.rp_filter[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_181": {
        "system": "Linux",
        "description": "PHTN-67-000110 - The Photon operating system must use a reverse-path filter for IPv4 network traffic - net.ipv4.conf.default.rp_filter",
        "info": "Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.eth0.rp_filter = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239181r816668_rule,STIG-ID|PHTN-67-000110,SWIFT-CSCv1|2.3,Vuln-ID|V-239181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.rp_filter",
        "expect": "^[\\\\s]*net.ipv4.conf.default.rp_filter[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_182": {
        "system": "Linux",
        "description": "PHTN-67-000110 - The Photon operating system must use a reverse-path filter for IPv4 network traffic - net.ipv4.conf.eth0.rp_filter",
        "info": "Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.eth0.rp_filter = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239181r816668_rule,STIG-ID|PHTN-67-000110,SWIFT-CSCv1|2.3,Vuln-ID|V-239181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.rp_filter",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.rp_filter[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_183": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv4.conf.all.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.mc_forwarding",
        "expect": "^[\\\\s]*net.ipv4.conf.all.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_184": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv4.conf.default.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.mc_forwarding",
        "expect": "^[\\\\s]*net.ipv4.conf.default.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_185": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv4.conf.eth0.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.conf.eth0.mc_forwarding",
        "expect": "^[\\\\s]*net.ipv4.conf.eth0.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_186": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv6.conf.all.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.mc_forwarding",
        "expect": "(^[\\\\s]*net.ipv6.conf.all.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$|cannot stat /proc/sys/net/ipv6/conf/all/mc_forwarding)"
    },
    "custom_item_187": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv6.conf.default.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.mc_forwarding",
        "expect": "(^[\\\\s]*net.ipv6.conf.default.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$|cannot stat /proc/sys/net/ipv6/conf/default/mc_forwarding)"
    },
    "custom_item_188": {
        "system": "Linux",
        "description": "PHTN-67-000111 - The Photon operating system must not perform multicast packet forwarding - net.ipv6.conf.eth0.mc_forwarding",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.mc_forwarding = 0\nnet.ipv4.conf.default.mc_forwarding = 0\nnet.ipv4.conf.eth0.mc_forwarding = 0\nnet.ipv6.conf.all.mc_forwarding = 0\nnet.ipv6.conf.default.mc_forwarding = 0\nnet.ipv6.conf.eth0.mc_forwarding = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239182r816670_rule,STIG-ID|PHTN-67-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-239182",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv6.conf.eth0.mc_forwarding",
        "expect": "(^[\\\\s]*net.ipv6.conf.eth0.mc_forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$|cannot stat /proc/sys/net/ipv6/conf/eth0/mc_forwarding)"
    },
    "custom_item_189": {
        "system": "Linux",
        "description": "PHTN-67-000112 - The Photon operating system must not perform IPv4 packet forwarding.",
        "info": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following line:\n\nnet.ipv4.ip_forward = 0\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239183r816672_rule,STIG-ID|PHTN-67-000112,SWIFT-CSCv1|2.3,Vuln-ID|V-239183",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.ip_forward",
        "expect": "^[\\\\s]*net.ipv4.ip_forward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_190": {
        "system": "Linux",
        "description": "PHTN-67-000113 - The Photon operating system must send TCP timestamps.",
        "info": "TCP timestamps are used to provide protection against wrapped sequence numbers. It is possible to calculate system uptime (and boot time) by analyzing TCP timestamps. These calculated uptimes can help a bad actor in determining likely patch levels for vulnerabilities.",
        "solution": "Open /etc/sysctl.conf with a text editor.\n\nAdd or update the following line:\n\nnet.ipv4.tcp_timestamps = 1\n\nRun the following command to load the new setting:\n\n# /sbin/sysctl --load",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239184r816674_rule,STIG-ID|PHTN-67-000113,SWIFT-CSCv1|2.3,Vuln-ID|V-239184",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/sbin/sysctl net.ipv4.tcp_timestamps",
        "expect": "^[\\\\s]*net.ipv4.tcp_timestamps[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_191": {
        "system": "Linux",
        "description": "PHTN-67-000114 - The Photon OS must not have the xinetd service enabled.",
        "info": "The xinetd service is not required for normal appliance operation and must be disabled.",
        "solution": "At the command line, execute the following commands:\n\n# service xinetd stop\n# systemctl disable xinetd.service",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239185r675363_rule,STIG-ID|PHTN-67-000114,SWIFT-CSCv1|2.3,Vuln-ID|V-239185",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/systemctl is-enabled xinetd.service",
        "expect": "(disabled|Failed to get unit file state)"
    },
    "custom_item_192": {
        "system": "Linux",
        "description": "PHTN-67-000115 - The Photon operating system must be configured to protect the SSH public host key from unauthorized modification.",
        "info": "If a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 644# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239186r675366_rule,STIG-ID|PHTN-67-000115,SWIFT-CSCv1|2.3,Vuln-ID|V-239186",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/ssh/*key.pub",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_193": {
        "system": "Linux",
        "description": "PHTN-67-000116 - The Photon operating system must be configured to protect the SSH private host key from unauthorized access.",
        "info": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 600# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239187r675369_rule,STIG-ID|PHTN-67-000116,SWIFT-CSCv1|2.3,Vuln-ID|V-239187",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/ssh/*key",
        "owner": "root",
        "mask": "177",
        "group": "root"
    },
    "custom_item_194": {
        "system": "Linux",
        "description": "PHTN-67-000117 - The Photon operating system must enforce password complexity on the root account.",
        "info": "Password complexity rules must apply to all accounts on the system, including root. Without specifying the enforce_for_root flag, pam_cracklib does not apply complexity rules to the root user. While root users can find ways around this requirement, given its superuser power, it is necessary to attempt to force compliance.",
        "solution": "Open /etc/applmgmt/appliance/system-password with a text editor.\n\nComment out any existing 'pam_cracklib.so' line and add the following:\n\npassword requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=8 minclass=4 difok=4 retry=3 maxsequence=0 enforce_for_root\n\nSave and close.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239188r863035_rule,STIG-ID|PHTN-67-000117,SWIFT-CSCv1|2.3,Vuln-ID|V-239188",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/pam.d/system-password",
        "regex": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[\\\\s]+",
        "expect": "^[\\\\s]*password[\\\\s]+requisite[\\\\s]+pam_cracklib.so[^#]*[\\\\s]+enforce_for_root([\\\\s]|$)"
    },
    "custom_item_195": {
        "system": "Linux",
        "description": "PHTN-67-000118 - The Photon operating system must protect all boot configuration files from unauthorized access.",
        "info": "Boot configuration files control how the system boots, including single-user mode, auditing, log levels, etc. Improper or malicious configurations can negatively affect system security and availability.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 600# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239189r675375_rule,STIG-ID|PHTN-67-000118,SWIFT-CSCv1|2.3,Vuln-ID|V-239189",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /boot/*.cfg -xdev -type f -a '(' -not -perm 600 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;",
        "expect": "",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_196": {
        "system": "Linux",
        "description": "PHTN-67-000119 - The Photon operating system must protect sshd configuration from unauthorized access.",
        "info": "The sshd_config file contains all the configuration items for sshd. Incorrect or malicious configuration of sshd can allow unauthorized access to the system, insecure communication, limited forensic trail, etc.",
        "solution": "At the command line, execute the following commands:\n\n# chmod 600 /etc/ssh/sshd_config\n# chown root:root /etc/ssh/sshd_config",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239190r675378_rule,STIG-ID|PHTN-67-000119,SWIFT-CSCv1|2.3,Vuln-ID|V-239190",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "owner": "root",
        "mask": "177",
        "group": "root"
    },
    "custom_item_197": {
        "system": "Linux",
        "description": "PHTN-67-000120 - The Photon operating system must protect all sysctl configuration files from unauthorized access.",
        "info": "The sysctl configuration file specifies values for kernel parameters to be set on boot. Incorrect or malicious configuration of these parameters can have a negative effect on system security.",
        "solution": "At the command line, execute the following commands for each returned file:\n\n# chmod 600# chown root:root",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239191r675381_rule,STIG-ID|PHTN-67-000120,SWIFT-CSCv1|2.3,Vuln-ID|V-239191",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/find /etc/sysctl.conf /etc/sysctl.d/* -xdev -type f -a '(' -not -perm 600 -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;",
        "expect": "",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_198": {
        "system": "Linux",
        "description": "PHTN-67-000122 - The Photon operating system must set the UMASK parameter correctly.",
        "info": "The umask value influences the permissions assigned to files when they are created. The umask setting in login.defs controls the permissions for a new user's home directory. By setting the proper umask, home directories will only allow the new user to read and write files there.\n\nSatisfies: SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00230",
        "solution": "Open /etc/login.defs with a text editor.\n\nEnsure that the 'UMASK' line is uncommented and set to the following:\n\nUMASK 077",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239193r675387_rule,STIG-ID|PHTN-67-000122,SWIFT-CSCv1|2.3,Vuln-ID|V-239193",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*UMASK[\\\\s]+",
        "expect": "^[\\\\s]*UMASK[\\\\s]+@LOGIN_DEFS_UMASK@[\\\\s]*$"
    },
    "custom_item_199": {
        "system": "Linux",
        "description": "PHTN-67-000123 - The Photon operating system must configure sshd to disallow HostbasedAuthentication.",
        "info": "SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled.",
        "solution": "Open /etc/ssh/sshd_config with a text editor.\n\nEnsure that the 'HostbasedAuthentication' line is uncommented and set to the following:\n\nHostbasedAuthentication no\n\nAt the command line, execute the following command:\n\n# service sshd reload",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-239194r877377_rule,STIG-ID|PHTN-67-000123,SWIFT-CSCv1|2.3,Vuln-ID|V-239194",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/sbin/sshd -T | /usr/bin/grep hostbasedauthentication",
        "expect": "^[\\\\s]*hostbasedauthentication[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_200": {
        "system": "Linux",
        "description": "PHTN-67-000124 - The Photon operating system must enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.",
        "info": "If the system does not require authentication before it boots into single-user mode, anyone with vCenter console rights to the VCSA can trivially access all files on the system. GRUB2 is the boot loader for Photon OS and can be configured to require a password to boot into single-user mode or make modifications to the boot menu.\n\nNote: The VCSA does not support building grub changes via grub2-mkconfig.",
        "solution": "At the command line, execute the following command:\n\n# grub2-mkpasswd-pbkdf2\n\nEnter a secure password and ensure this password is stored for break-glass situations. The vCenter root account cannot be recovered without knowing this separate password.\n\nCopy the resulting encrypted string. An example string follows:\n\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nOpen /boot/grub2/grub.cfg with a text editor. Find the line that begins with 'set rootpartition'. Below this line, paste the following on its own line:\n\nset superusers='root'\n\nBelow this, paste the following, substituting your own encrypted string from the steps above:\n\npassword_pbkdf2 rootThe VCSA ships with one 'menuentry' block by default. Copy that entire block and paste it right below that block.\n\nExample:\nmenuentry 'Photon' {\n    linux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0\n    if [ '$photon_initrd' ]; then\n        initrd '/'$photon_initrd\n    fi\n}\nmenuentry 'Photon' {\n    linux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0\n    if [ '$photon_initrd' ]; then\n        initrd '/'$photon_initrd\n    fi\n}\n\nModify the first menuentry block to add the '--unrestricted' option as follows:\n\nmenuentry 'Photon' --unrestricted {\n\nModify the second menuentry block to add the allowed user as follows:\n\nmenuentry 'Recover Photon' --users root {\n\nThis concludes the fix. To verify, following is an example grub.cfg snippet:\n\n...\nset rootpartition=PARTUUID=326e5b0f-42fb-471a-8209-18964c4a2ed3\nset superusers='root'\npassword_pbkdf2 root grub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nmenuentry 'Photon' --unrestricted {\n    linux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0\n    if [ '$photon_initrd' ]; then\n        initrd '/'$photon_initrd\n    fi\n}\n\nmenuentry 'Recover Photon' --users root {\n    linux '/'$photon_linux root=$rootpartition net.ifnames=0 $photon_cmdline coredump_filter=0x37 consoleblank=0\n    if [ '$photon_initrd' ]; then\n        initrd '/'$photon_initrd\n    fi\n}",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-239195r675393_rule,STIG-ID|PHTN-67-000124,TBA-FIISB|31.1,Vuln-ID|V-239195",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "file": "/boot/grub2/grub.cfg",
        "regex": "^[\\\\s]*password_pbkdf2[\\\\s]+",
        "expect": "^[\\\\s]*password_pbkdf2[\\\\s]+root[\\\\s]+"
    },
    "custom_item_201": {
        "system": "Linux",
        "description": "PHTN-67-000129 - The Photon operating system must be configured to offload audit logs to a syslog server.",
        "info": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOffloading is a common process in information systems with limited audit storage capacity.\n\nSatisfies: SRG-OS-000342-GPOS-00133, SRG-OS-000447-GPOS-00201",
        "solution": "Open /etc/vmware-syslog/stig-services-auditd.conf with a text editor.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type='imfile' File='/var/log/audit/audit.log'\nTag='auditd'\nSeverity='info'\nFacility='local0')",
        "reference": "800-53|AU-4(1),800-53|SI-6d.,800-53r5|AU-4(1),800-53r5|SI-6d.,CAT|II,CCI|CCI-001851,CCI|CCI-002702,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|VMW_vSphere_6-7_Photon_OS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,ITSG-33|SI-6a.,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-239072r877390_rule,STIG-ID|PHTN-67-000129,Vuln-ID|V-239072",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_VMW_vSphere_6-7_Y23M07_STIG.zip",
        "cmd": "/usr/bin/echo $(/usr/bin/cat /etc/vmware-syslog/stig-services-auditd.conf | /usr/bin/grep -v '^#')",
        "expect": "input\\\\(type=\"imfile\"[\\\\s]+File=\"/var/log/audit/audit.log\"[\\\\s]+Tag=\"auditd\"[\\\\s]+Severity=\"info\"[\\\\s]+Facility=\"local0\"\\\\)"
    }
}