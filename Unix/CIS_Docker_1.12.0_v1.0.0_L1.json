{
    "custom_item_1": {
        "description": "4.3 Do not install unnecessary packages in the container",
        "info": "https://docs.docker.com/userguide/dockerimages/\n2.http://www.livewyer.com/blog/2015/02/24/slimming-down-your-docker-containers-alpine-linux\n3.https://github.com/progrium/busybox",
        "solution": "At the outset, do not install anything on the container that does not justify the purpose. If\nthe image had some packages that your container does not use, uninstall them.Consider using a minimal base image rather than the standard Redhat/Centos/Debian\nimages if you can. Some of the options include BusyBox and Alpine.Not only does this trim your image size from >150Mb to ~20 Mb, there are also fewer tools\nand paths to escalate privileges. You can even remove the package installer as a final\nhardening measure for leaf/production containers.Impact-None.\nDefault Value-Not Applicable.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "name": "list_docker_container_packages"
    },
    "custom_item_2": {
        "description": "4.4 Rebuild the images to include security patches",
        "info": "https://docs.docker.com/userguide/dockerimages/",
        "solution": "Follow the below steps to rebuild the images with security patches-\nStep 1- 'docker pull' all the base images (i.e., given your set of Dockerfiles, extract all\nimages declared in 'FROM' instructions, and re-pull them to check for an updated/patched\nversions). Patch the packages within the images too.\nStep 2- Force a rebuild of each image with 'docker build --no-cache'.\nStep 3- Restart all containers with the updated images.You could also use ONBUILD directive in the Dockerfile to trigger particular update\ninstructions for images that you know are used as base images frequently.Impact-NoneDefault Value-By default, containers and images are not updated of their own.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "name": "list_docker_container_packages"
    },
    "custom_item_3": {
        "description": "Check if this is a Docker Vessel/Host",
        "cmd": "/usr/bin/docker info",
        "expect": "Containers"
    },
    "custom_item_4": {
        "description": "2.1 Restrict network traffic between containers",
        "info": "https://docs.docker.com/articles/networking",
        "solution": "Run the docker in daemon mode and pass '--icc=false' as argument.For Example,/usr/bin/dockerd --icc=false\nImpact-The inter container communication would be disabled. No containers would be able to talk\nto another container on the same host. If any communication between containers on the\nsame host is desired, then it needs to be explicitly defined using container linking.Default Value-By default, all inter container communication is allowed.",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(21),800-53r5|SC-7(21),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.3,NIAv2|VL6,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [i]cc=",
        "expect": "icc=false"
    },
    "custom_item_5": {
        "description": "2.2 Set the logging level",
        "info": "https://docs.docker.com/engine/reference/commandline/daemon/",
        "solution": "Run the Docker daemon as below-dockerd --log-level='info'Impact-None.Default Value-By default, Docker daemon is set to log level of 'info'.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [l]og-level",
        "expect": "log-level='info'"
    },
    "custom_item_6": {
        "description": "2.3 Allow Docker to make changes to iptables",
        "info": "https://docs.docker.com/v1.8/articles/networking/",
        "solution": "Do not run the Docker daemon with '--iptables=false' parameter.\nFor example, do not start the Docker daemon as below-dockerd --iptables=falseImpact-None.Default Value-By default, 'iptables' is set to 'true'.",
        "reference": "800-171|3.13.1,800-53|SC-7(12),800-53r5|SC-7(12),CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(12),LEVEL|1A,NESA|T4.5.4,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.2.1|1.4,PCI-DSSv4.0|1.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [i]ptables=false | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_7": {
        "description": "2.4 Do not use insecure registries",
        "info": "https://docs.docker.com/registry/insecure/",
        "solution": "Do not use any insecure registries.For example, do not start the Docker daemon as below-dockerd --insecure-registry 10.1.0.0/16Impact-None.\nDefault Value-By default, Docker assumes all, but local, registries are secure.",
        "reference": "800-53|SI-7(6),800-53r5|SI-7(6),CSF|PR.DS-6,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ITSG-33|SI-7,ITSG-33|SI-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,SWIFT-CSCv1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [i]nsecure-registry | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_8": {
        "description": "2.5 Do not use the aufs storage driver",
        "info": "http://docs.docker.com/reference/commandline/cli/#daemon-storage-driver-option\n2.https://github.com/docker/docker/issues/6047\n3.http://muehe.org/posts/switching-docker-from-aufs-to-devicemapper/\n4.http://jpetazzo.github.io/assets/2015-03-05-deep-dive-into-docker-storage-drivers.html#1",
        "solution": "Do not explicitly use 'aufs' as storage driver.For example, do not start Docker daemon as below-dockerd --storage-driver aufsImpact-'aufs' is the only storage driver that allows containers to share executable and shared\nlibrary memory. It might be useful if you are running thousands of containers with the\nsame program or libraries.\nDefault Value-By default, Docker uses 'devicemapper' as the storage driver on most of the platforms.\nDefault storage driver can vary based on your OS vendor. You should use the storage driver\nthat is best supported by your preferred vendor.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker info | grep -ie \"^storage driver: aufs\" | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_9": {
        "description": "2.6 Configure TLS authentication for Docker daemon - tlscacert",
        "info": "http://docs.docker.com/articles/https/\n2.http://www.hnwatcher.com/r/1644394/Intro-to-Docker-Swarm-Part-2-Comfiguration-Modes-and-Requirements\n3.http://www.blackfinsecurity.com/docker-swarm-with-tls-authentication/",
        "solution": "Follow the steps mentioned in the Docker documentation or other references.Impact-You would need to manage and guard certificates and keys for Docker daemon and Docker\nclients.\nDefault Value-By default, TLS authentication is not configured.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]tlscacert",
        "expect": "--tlscacert"
    },
    "custom_item_10": {
        "description": "2.6 Configure TLS authentication for Docker daemon -tlsverify",
        "info": "http://docs.docker.com/articles/https/\n2.http://www.hnwatcher.com/r/1644394/Intro-to-Docker-Swarm-Part-2-Comfiguration-Modes-and-Requirements\n3.http://www.blackfinsecurity.com/docker-swarm-with-tls-authentication/",
        "solution": "Follow the steps mentioned in the Docker documentation or other references.Impact-You would need to manage and guard certificates and keys for Docker daemon and Docker\nclients.\nDefault Value-By default, TLS authentication is not configured.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]tlsverify",
        "expect": "--tlsverify"
    },
    "custom_item_11": {
        "description": "2.6 Configure TLS authentication for Docker daemon - tlskey",
        "info": "http://docs.docker.com/articles/https/\n2.http://www.hnwatcher.com/r/1644394/Intro-to-Docker-Swarm-Part-2-Comfiguration-Modes-and-Requirements\n3.http://www.blackfinsecurity.com/docker-swarm-with-tls-authentication/",
        "solution": "Follow the steps mentioned in the Docker documentation or other references.Impact-You would need to manage and guard certificates and keys for Docker daemon and Docker\nclients.\nDefault Value-By default, TLS authentication is not configured.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]tlskey",
        "expect": "--tlskey"
    },
    "custom_item_12": {
        "description": "2.6 Configure TLS authentication for Docker daemon - tlscert",
        "info": "http://docs.docker.com/articles/https/\n2.http://www.hnwatcher.com/r/1644394/Intro-to-Docker-Swarm-Part-2-Comfiguration-Modes-and-Requirements\n3.http://www.blackfinsecurity.com/docker-swarm-with-tls-authentication/",
        "solution": "Follow the steps mentioned in the Docker documentation or other references.Impact-You would need to manage and guard certificates and keys for Docker daemon and Docker\nclients.\nDefault Value-By default, TLS authentication is not configured.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]tlscert",
        "expect": "--tlscert"
    },
    "custom_item_13": {
        "description": "2.7 Set default ulimit as appropriate - default-ulimit",
        "info": "https://docs.docker.com/engine/reference/commandline/daemon/#default-ulimits",
        "solution": "Run the docker in daemon mode and pass '--default-ulimit' as argument with respective\nulimits as appropriate in your environment.For Example,dockerd --default-ulimit nproc=1024-2408 --default-ulimit nofile=100-200Impact-If the ulimits are not set properly, the desired resource control might not be achieved and\nmight even make the system unusable.Default Value-By default, no ulimit is set.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1M,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]default-ulimit",
        "expect": "--default-ulimit @DEFAULT_ULIMIT@"
    },
    "custom_item_14": {
        "description": "2.13 Disable operations on legacy registry (v1)",
        "info": "https://docs.docker.com/engine/reference/commandline/daemon/\n2.https://github.com/docker/docker/issues/8093\n3.https://github.com/docker/docker/issues/9015\n4.https://github.com/docker/docker-registry/issues/612\n5.https://docs.docker.com/registry/spec/api/\n6.https://the.binbashtheory.com/creating-private-docker-registry-2-0-with-token-authentication-service/\n7.https://blog.docker.com/2015/07/new-tool-v1-registry-docker-trusted-registry-v2-open-source/\n8.http://www.slideshare.net/Docker/docker-registry-v2",
        "solution": "Start the docker daemon as below-dockerd --disable-legacy-registryImpact-Legacy registry operations would be restricted.Default Value-By default, legacy registry operations are allowed.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]disable-legacy-registry",
        "expect": "--disable-legacy-registry=false"
    },
    "custom_item_15": {
        "description": "2.14 Enable live restore",
        "info": "https://github.com/docker/docker/pull/23213",
        "solution": "Run the docker in daemon mode and pass '--live-restore' as an argument.For Example,dockerd --live-restoreImpact-None.Default Value-By default, --live-restore is not enabled.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]live-restore",
        "expect": "--live-restore"
    },
    "custom_item_16": {
        "description": "2.15 Do not enable swarm mode, if not needed",
        "info": "https://docs.docker.com/engine/reference/commandline/swarm_init/",
        "solution": "If swarm mode has been enabled on a system in error, rundocker swarm leaveImpact-None.Default Value-By default, docker swarm mode is not enabled.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker info |grep Swarm",
        "expect": "Swarm:"
    },
    "custom_item_17": {
        "description": "2.16 Control the number of manager nodes in a swarm",
        "info": "https://docs.docker.com/engine/swarm/manage-nodes/\n2.https://docs.docker.com/engine/swarm/admin_guide/#/add-manager-nodes-for-\nfault-tolerance\nNote: Nessus has not performed an evaluation of this check. Please manually review the check output\nfor correctness.",
        "solution": "If an excessive number of managers is configured, the excess can be demoted as worker\nusing the following command-docker node demoteWhereis the node ID value of the manager to be demoted.Impact-NoneDefault Value-A single manager is all that is required to start a given cluster.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker node ls | grep Leader",
        "expect": ".*"
    },
    "custom_item_18": {
        "description": "2.17 Bind swarm services to a specific host interface",
        "info": "https://docs.docker.com/engine/reference/commandline/swarm_init/#/listen-\naddr-value\n2.https://docs.docker.com/engine/swarm/admin_guide/#/recover-from-disaster\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remediation of this requires re-initialization of the swarm specifying a specific interface\nfor the --listen-addr parameter.Impact-NoneDefault Value-By default, docker swarm services listen on all available host interfaces.",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ss -nlp|grep dockerd",
        "expect": ""
    },
    "custom_item_19": {
        "description": "2.18 Disable Userland Proxy",
        "info": "http://windsock.io/the-docker-proxy/\n2.https://github.com/docker/docker/issues/14856\n3.https://github.com/docker/docker/issues/22741\n4.https://docs.docker.com/engine/userguide/networking/default_network/binding/",
        "solution": "Run the Docker daemon as below-dockerd --userland-proxy=falseImpact-Some systems with older Linux kernels may not be able to support hairpin NAT and\ntherefore require the userland proxy service. Also, some networking setups can be\nimpacted by the removal of the userland proxy.Default Value-By default, the userland proxy is enabled.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "ps -ef | grep docker | grep [\\-][\\-]userland-proxy",
        "expect": "--userland-proxy=false"
    },
    "custom_item_20": {
        "description": "3.1 Verify that docker.service file ownership is set to root:root",
        "info": "https://docs.docker.com/engine/admin/systemd/",
        "solution": "Step 1- Find out the file location-systemctl show -p FragmentPath docker.service\nStep 2- If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the ownership and group\nownership for the file to 'root'.For example,chown root-root /usr/lib/systemd/system/docker.serviceImpact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the ownership and group-ownership for this file\nis correctly set to 'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_DOCKER_SERVICE_FILE@",
        "owner": "root",
        "group": "root"
    },
    "custom_item_21": {
        "description": "3.2 Verify that docker.service file permissions are set to 644 or more restrictive",
        "info": "https://docs.docker.com/articles/systemd/",
        "solution": "Step 1- Find out the file location-systemctl show -p FragmentPath docker.serviceStep 2- If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the file permissions to '644'.For example,chmod 644 /usr/lib/systemd/system/docker.service\nImpact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the file permissions are correctly set to '644'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_DOCKER_SERVICE_FILE@",
        "mask": "133"
    },
    "custom_item_22": {
        "description": "3.3 Verify that docker.socket file ownership is set to root:root",
        "info": "https://docs.docker.com/articles/basics/#bind-docker-to-another-hostport-or-a-unix-socket\n2.https://github.com/YungSang/fedora-atomic-packer/blob/master/oem/docker.socket\n3.http://daviddaeschler.com/2014/12/14/centos-7rhel-7-and-docker-containers-on-boot/",
        "solution": "Step 1- Find out the file location-systemctl show -p FragmentPath docker.socketStep 2- If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the ownership and group\nownership for the file to 'root'.For example,\nchown root-root /usr/lib/systemd/system/docker.socketImpact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the ownership and group-ownership for this file\nis correctly set to 'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_DOCKER_SOCKET_FILE@",
        "owner": "root",
        "group": "root"
    },
    "custom_item_23": {
        "description": "3.4 Verify that docker.socket file permissions are set to 644 or more restrictive",
        "info": "https://docs.docker.com/articles/basics/#bind-docker-to-another-hostport-or-a-unix-socket\n2.https://github.com/YungSang/fedora-atomic-packer/blob/master/oem/docker.socket\n3.http://daviddaeschler.com/2014/12/14/centos-7rhel-7-and-docker-containers-on-boot/",
        "solution": "Step 1- Find out the file location-systemctl show -p FragmentPath docker.socketStep 2- If the file does not exist, this recommendation is not applicable. If the file exists,\nexecute the below command with the correct file path to set the file permissions to '644'.For example,chmod 644 /usr/lib/systemd/system/docker.socket\nImpact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable. By default, if the file is present, the file permissions for this file are correctly set\nto '644'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_DOCKER_SOCKET_FILE@",
        "mask": "133"
    },
    "custom_item_24": {
        "description": "3.5 Verify that /etc/docker directory ownership is set to root:root",
        "info": "https://docs.docker.com/articles/certificates/",
        "solution": "chown root-root /etc/dockerThis would set the ownership and group-ownership for the directory to 'root'.Impact-None.Default Value-By default, the ownership and group-ownership for this directory is correctly set to 'root'.",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/docker",
        "owner": "root",
        "group": "root"
    },
    "custom_item_25": {
        "description": "3.6 Verify that /etc/docker directory permissions are set to 755 or more restrictive",
        "info": "https://docs.docker.com/articles/certificates/",
        "solution": "chmod 755 /etc/dockerThis would set the permissions for the directory to '755'.Impact-None.Default Value-By default, the permissions for this directory are correctly set to '755'.",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/docker",
        "mask": "022"
    },
    "custom_item_26": {
        "description": "3.7 Verify that registry certificate file ownership is set to root:root",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/reference/commandline/cli/#insecure-registries",
        "solution": "chown root-root /etc/docker/certs.d//*\nThis would set the ownership and group-ownership for the registry certificate files to\n'root'.Impact-None.Default Value-By default, the ownership and group-ownership for registry certificate files is correctly set\nto 'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@BASE_PATH_TO_CERTS@@REGISTRY_NAME@/*",
        "owner": "root",
        "group": "root"
    },
    "custom_item_27": {
        "description": "3.8 Verify that registry certificate file permissions are set to 444 or more restrictive",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/reference/commandline/cli/#insecure-registries",
        "solution": "chmod 444 /etc/docker/certs.d//*\nThis would set the permissions for registry certificate files to '444'.Impact-None.Default Value-By default, the permissions for registry certificate files might not be '444'. The default file\npermissions are governed by the system or user specific umask values.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@BASE_PATH_TO_CERTS@@REGISTRY_NAME@/*",
        "mask": "333"
    },
    "custom_item_28": {
        "description": "3.9 Verify that TLS CA certificate file ownership is set to root:root",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chown root-rootThis would set the ownership and group-ownership for the TLS CA certificate file to 'root'.Impact-None.Default Value-By default, the ownership and group-ownership for TLS CA certificate file is correctly set to\n'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_TLS_CA_FILE@",
        "owner": "root",
        "group": "root"
    },
    "custom_item_29": {
        "description": "3.10 Verify that TLS CA certificate file permissions are set to 444 or more restrictive",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chmod 444This would set the file permissions of the TLS CA file to '444'.Impact-None.Default Value-By default, the permissions for TLS CA certificate file might not be '444'. The default file\npermissions are governed by the system or user specific umask values.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_TLS_CA_FILE@",
        "mask": "333"
    },
    "custom_item_30": {
        "description": "3.11 Verify that Docker server certificate file ownership is set to root:root",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chown root-rootThis would set the ownership and group-ownership for the Docker server certificate file to\n'root'.Impact-None.Default Value-By default, the ownership and group-ownership for Docker server certificate file is\ncorrectly set to 'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_SERVER_CERT_FILE@",
        "owner": "root",
        "group": "root"
    },
    "custom_item_31": {
        "description": "3.12 Verify that Docker server certificate file permissions are set to 444 or more restrictive",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chmod 444This would set the file permissions of the Docker server file to '444'.Impact-None.Default Value-By default, the permissions for Docker server certificate file might not be '444'. The default\nfile permissions are governed by the system or user specific umask values.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_SERVER_CERT_FILE@",
        "mask": "333"
    },
    "custom_item_32": {
        "description": "3.13 Verify that Docker server certificate key file ownership is set to root:root",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chown root-rootThis would set the ownership and group-ownership for the Docker server certificate key\nfile to 'root'.Impact-None.Default Value-By default, the ownership and group-ownership for Docker server certificate key file is\ncorrectly set to 'root'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_SERVER_CERT_KEY_FILE@",
        "owner": "root",
        "group": "root"
    },
    "custom_item_33": {
        "description": "3.14 Verify that Docker server certificate key file permissions are set to 400",
        "info": "https://docs.docker.com/articles/certificates/\n2.http://docs.docker.com/articles/https/",
        "solution": "chmod 400This would set the Docker server certificate key file permissions to '400'.Impact-None.Default Value-By default, the permissions for Docker server certificate key file might not be '400'. The\ndefault file permissions are governed by the system or user specific umask values.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "@PATH_TO_SERVER_CERT_KEY_FILE@",
        "mask": "377"
    },
    "custom_item_34": {
        "description": "3.15 Verify that Docker socket file ownership is set to root:docker",
        "info": "https://docs.docker.com/reference/commandline/cli/#daemon-socket-option\n2.https://docs.docker.com/articles/basics/#bind-docker-to-another-hostport-or-a-unix-socket",
        "solution": "chown root-docker /var/run/docker.sock\nThis would set the ownership to 'root' and group-ownership to 'docker' for default Docker\nsocket file.\nImpact-None.Default Value-By default, the ownership and group-ownership for Docker socket file is correctly set to\n'root-docker'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/var/run/docker.sock",
        "owner": "root",
        "group": "docker"
    },
    "custom_item_35": {
        "description": "3.16 Verify that Docker socket file permissions are set to 660 or more restrictive",
        "info": "https://docs.docker.com/reference/commandline/cli/#daemon-socket-option\n2.https://docs.docker.com/articles/basics/#bind-docker-to-another-hostport-or-a-unix-socket",
        "solution": "chmod 660 /var/run/docker.sock\nThis would set the file permissions of the Docker socket file to '660'.Impact-None.Default Value-By default, the permissions for Docker socket file is correctly set to '660'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/var/run/docker.sock",
        "mask": "117"
    },
    "custom_item_36": {
        "description": "3.17 Verify that daemon.json file ownership is set to root:root",
        "info": "https://docs.docker.com/engine/reference/commandline/daemon/#daemon-configuration-file",
        "solution": "chown root-root /etc/docker/daemon.json\nThis would set the ownership and group-ownership for the file to 'root'.Impact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/docker/daemon.json",
        "owner": "root",
        "group": "root"
    },
    "custom_item_37": {
        "description": "3.18 Verify that daemon.json file permissions are set to 644 or more restrictive",
        "info": "https://docs.docker.com/engine/reference/commandline/daemon/#daemon-configuration-file",
        "solution": "chmod 644 /etc/docker/daemon.json\nThis would set the file permissions for this file to '644'.Impact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/docker/daemon.json",
        "mask": "133"
    },
    "custom_item_38": {
        "description": "3.19 Verify that /etc/default/docker file ownership is set to root:root",
        "info": "https://docs.docker.com/engine/admin/configuring/",
        "solution": "chown root-root /etc/default/docker\nThis would set the ownership and group-ownership for the file to 'root'.Impact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/default/docker",
        "owner": "root",
        "group": "root"
    },
    "custom_item_39": {
        "description": "3.20 Verify that /etc/default/docker file permissions are set to 644 or more restrictive",
        "info": "https://docs.docker.com/engine/admin/configuring/",
        "solution": "chmod 644 /etc/default/docker\nThis would set the file permissions for this file to '644'.Impact-None.Default Value-This file may not be present on the system. In that case, this recommendation is not\napplicable.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "file": "/etc/default/docker",
        "mask": "133"
    },
    "custom_item_40": {
        "description": "4.1 Create a user for the container",
        "cmd": "/usr/bin/docker ps -q | xargs docker inspect --format '{{ .Id }}: User={{.Config.User}}'",
        "expect": "User=$"
    },
    "custom_item_41": {
        "description": "4.1 Create a user for the container",
        "info": "https://github.com/docker/docker/issues/2918\n2.https://github.com/docker/docker/pull/4572\n3.https://github.com/docker/docker/issues/7906\n4.https://www.altiscale.com/hadoop-blog/making-docker-work-yarn/\n5.http://docs.docker.com/articles/security/",
        "solution": "Ensure that the Dockerfile for the container image contains below instruction-USERwhere username or ID refers to the user that could be found in the container base image. If\nthere is no specific user created in the container base image, then add a useradd command\nto add the specific user before USER instruction.For example, add the below lines in the Dockerfile to create a user in the container-RUN useradd -d /home/username -m -s /bin/bash username\nUSER usernameNote- If there are users in the image that the containers do not need, consider deleting\nthem. After deleting those users, commit the image and then generate new instances of\ncontainers for use.Impact-None.Default Value-By default, the containers are run with root privileges and as user root inside the\ncontainer.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs docker inspect --format '{{ .Id }}: User={{.Config.User}}'",
        "expect": ""
    },
    "custom_item_42": {
        "description": "4.1 Create a user for the container",
        "info": "https://github.com/docker/docker/issues/2918\n2.https://github.com/docker/docker/pull/4572\n3.https://github.com/docker/docker/issues/7906\n4.https://www.altiscale.com/hadoop-blog/making-docker-work-yarn/\n5.http://docs.docker.com/articles/security/",
        "solution": "Ensure that the Dockerfile for the container image contains below instruction-USERwhere username or ID refers to the user that could be found in the container base image. If\nthere is no specific user created in the container base image, then add a useradd command\nto add the specific user before USER instruction.For example, add the below lines in the Dockerfile to create a user in the container-RUN useradd -d /home/username -m -s /bin/bash username\nUSER usernameNote- If there are users in the image that the containers do not need, consider deleting\nthem. After deleting those users, commit the image and then generate new instances of\ncontainers for use.Impact-None.Default Value-By default, the containers are run with root privileges and as user root inside the\ncontainer.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs docker inspect --format '{{ .Id }}: User={{.Config.User}}'",
        "expect": ".*"
    },
    "custom_item_43": {
        "description": "4.2 Use trusted base images for containers",
        "info": "https://titanous.com/posts/docker-insecurity\n2.https://registry.hub.docker.com/\n3.http://blog.docker.com/2014/10/docker-1-3-signed-images-process-injection-security-options-mac-shared-directories/\n4.https://github.com/docker/docker/issues/8093\n5.http://docs.docker.com/reference/commandline/cli/#pull\n6.https://github.com/docker/docker/pull/11109\n7.https://blog.docker.com/2015/11/docker-trusted-registry-1-4/\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure and use Docker Content trust.Impact-None.Default Value-Not Applicable.",
        "reference": "800-171|3.4.8,800-53|CM-7(5),800-53r5|CM-7(5),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker images",
        "expect": ""
    },
    "custom_item_44": {
        "description": "4.6 Add HEALTHCHECK instruction to the container image",
        "info": "https://github.com/docker/docker/pull/22719",
        "solution": "Follow Docker documentation and rebuild your container image with HEALTHCHECK\ninstruction.Impact-None.Default Value-By default, HEALTHCHECK is not set.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{.Config.Healthcheck}}'",
        "expect": ""
    },
    "custom_item_45": {
        "description": "4.7 Do not use update instructions alone in the Dockerfile",
        "info": "https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-\npractices/#/apt-get\n2.https://github.com/docker/docker/issues/3313\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use update instructions along with install instructions (or any other) and version pinning\nfor packages while installing them. This would bust the cache and force to extract the\nrequired versions.Alternatively, you could use --no-cache flag during docker build process to avoid using\ncached layers.Impact-None\nDefault Value-By default, docker does not enforce any restrictions on using update instructions.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for image in $(docker images|awk {'print $3'}); do docker history $image 2>/dev/null|grep -i UPDATE;done",
        "expect": ""
    },
    "custom_item_46": {
        "description": "4.9 Use COPY instead of ADD in Dockerfile",
        "info": "https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-\npractices/#/add-or-copy",
        "solution": "Use COPY instructions in Dockerfiles.Impact-You would need to take care of the functionalities provided by ADD instructions such as\nfetching files from remote URLs.Default Value-Not Applicable",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for image in $(docker images|awk {'print $3'}); do docker history $image 2>/dev/null|grep ADD;done",
        "expect": ""
    },
    "custom_item_47": {
        "description": "4.10 Do not store secrets in Dockerfiles",
        "info": "https://github.com/docker/docker/issues/13490\n2.http://12factor.net/config\n3.https://avicoder.me/2016/07/22/Twitter-Vine-Source-code-dump/\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Do not store any kind of secrets within Dockerfiles.Impact-You would need to identify a way to handle secrets for your Docker images.Default Value-By default, there are no restrictions on storing config secrets in the Dockerfiles.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for image in $(docker images|awk {'print $3'}); do docker history $image;done",
        "expect": ""
    },
    "custom_item_48": {
        "description": "5.3 Restrict Linux Kernel Capabilities within containers",
        "info": "https://docs.docker.com/articles/security/#linux-kernel-capabilities\n2.https://github.com/docker/docker/blob/master/daemon/execdriver/native/template/default_template.go\n3.http://man7.org/linux/man-pages/man7/capabilities.7.html\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Execute the below command to add needed capabilities-$> docker run --cap-add={'Capability 1','Capability 2'}For example,docker run --interactive --tty --cap-add={'NET_ADMIN','SYS_ADMIN'} centos-latest\n/bin/bashExecute the below command to drop unneeded capabilities-$> docker run --cap-drop={'Capability 1','Capability 2'}For example,docker run --interactive --tty --cap-drop={'SETUID','SETGID'} centos-latest /bin/bashAlternatively,You may choose to drop all capabilities and add only add the needed ones-$> docker run --cap-drop=all --cap-add={'Capability 1','Capability 2'}For example,docker run --interactive --tty --cap-drop=all --cap-add={'NET_ADMIN','SYS_ADMIN'}\ncentos-latest /bin/bashImpact-Based on what Linux Kernel Capabilities were added or dropped, restrictions within the\ncontainer would apply.Default Value-By default, below capabilities are available for containers-AUDIT_WRITE\nCHOWN\nDAC_OVERRIDE\nFOWNER\nFSETID\nKILL\nMKNOD\nNET_BIND_SERVICE\nNET_RAW\nSETFCAP\nSETGID\nSETPCAP\nSETUID\nSYS_CHROOT",
        "reference": "800-171|3.1.5,800-53|AC-6(4),800-53r5|AC-6(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6(4),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: CapAdd={{json .HostConfig.CapAdd }} CapDrop={{json .HostConfig.CapDrop }}'",
        "expect": ""
    },
    "custom_item_49": {
        "description": "5.4 Do not use privileged containers",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Privileged={{ .HostConfig.Privileged }}'",
        "expect": "Privileged=true"
    },
    "custom_item_50": {
        "description": "5.4 Do not use privileged containers",
        "info": "https://docs.docker.com/reference/commandline/cli",
        "solution": "Do not run container with the --privileged flag.For example, do not start a container as below-docker run --interactive --tty --privileged centos /bin/bashImpact-Linux Kernel Capabilities other than defaults would not be available for use within\ncontainer.Default Value-False.",
        "reference": "800-171|3.1.5,800-53|AC-6(4),800-53r5|AC-6(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6(4),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Privileged={{ .HostConfig.Privileged }}'",
        "expect": ""
    },
    "custom_item_51": {
        "description": "5.4 Do not use privileged containers",
        "info": "https://docs.docker.com/reference/commandline/cli",
        "solution": "Do not run container with the --privileged flag.For example, do not start a container as below-docker run --interactive --tty --privileged centos /bin/bashImpact-Linux Kernel Capabilities other than defaults would not be available for use within\ncontainer.Default Value-False.",
        "reference": "800-171|3.1.5,800-53|AC-6(4),800-53r5|AC-6(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6(4),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Privileged={{ .HostConfig.Privileged }}'",
        "expect": ".*"
    },
    "custom_item_52": {
        "description": "5.5 Do not mount sensitive host system directories on containers",
        "info": "https://docs.docker.com/userguide/dockervolumes",
        "solution": "Do not mount host sensitive directories on containers especially in read-write mode.Impact-None.Default Value-Docker defaults to a read-write volume but you can also mount a directory read-only. By\ndefault, no sensitive host directories are mounted on containers.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs docker inspect --format '{{ .Id }}: Volumes={{ .Mounts }}'",
        "expect": ""
    },
    "custom_item_53": {
        "description": "5.6 Do not run ssh within containers",
        "info": "http://blog.docker.com/2014/06/why-you-dont-need-to-run-sshd-in-docker/",
        "solution": "Uninstall SSH server from the container and use nsenter or any other commands such as\ndocker exec or docker attach to interact with the container instance.docker exec --interactive --tty $INSTANCE_ID shORdocker attach $INSTANCE_IDImpact-None.\nDefault Value-By default, SSH server is not running inside the container. Only one process per container is\nallowed.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do /usr/bin/docker exec $i ps -el|grep ssh; done",
        "expect": ""
    },
    "custom_item_54": {
        "description": "5.7 Do not map privileged ports within containers",
        "cmd": "for i in $(/usr/bin/docker ps -q); do echo $i ' : ';/usr/bin/docker port $i; done",
        "expect": ":([0-9]|[1-9][0-9]|[1-9][0-9][0-9]|10[0-2][0-3])$"
    },
    "custom_item_55": {
        "description": "5.7 Do not map privileged ports within containers",
        "info": "http://docs.docker.com/articles/networking/#binding-ports\n2.https://www.adayinthelifeof.nl/2012/03/12/why-putting-ssh-on-another-port-than-22-is-bad-idea",
        "solution": "Do not map the container ports to privileged host ports when starting a container. Also,\nensure that there is no such container to host privileged port mapping declarations in the\nDockerfile.Impact-None.Default Value-By default, mapping a container port to a privileged port on the host is allowed.Note- There might be certain cases where you want to map privileged ports, because if you\nforbid it, then the corresponding application has to run outside of a container.For example- HTTP and HTTPS load balancers have to bind 80/tcp and 443/tcp\nrespectively. Forbidding to map privileged ports effectively forbids from running those in a\ncontainer, and mandates using an external load balancer. In such cases, those containers\ninstances should be marked as exceptions for this recommendation.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do echo $i ' : ';/usr/bin/docker port $i; done",
        "expect": ""
    },
    "custom_item_56": {
        "description": "5.7 Do not map privileged ports within containers",
        "info": "http://docs.docker.com/articles/networking/#binding-ports\n2.https://www.adayinthelifeof.nl/2012/03/12/why-putting-ssh-on-another-port-than-22-is-bad-idea",
        "solution": "Do not map the container ports to privileged host ports when starting a container. Also,\nensure that there is no such container to host privileged port mapping declarations in the\nDockerfile.Impact-None.Default Value-By default, mapping a container port to a privileged port on the host is allowed.Note- There might be certain cases where you want to map privileged ports, because if you\nforbid it, then the corresponding application has to run outside of a container.For example- HTTP and HTTPS load balancers have to bind 80/tcp and 443/tcp\nrespectively. Forbidding to map privileged ports effectively forbids from running those in a\ncontainer, and mandates using an external load balancer. In such cases, those containers\ninstances should be marked as exceptions for this recommendation.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do echo $i ' : ';/usr/bin/docker port $i; done",
        "expect": ".*"
    },
    "custom_item_57": {
        "description": "5.8 Open only needed ports on container",
        "info": "https://docs.docker.com/articles/networking/#binding-ports\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Fix the Dockerfile of the container image to expose only needed ports by your\ncontainerized application. You can also completely ignore the list of ports defined in the\nDockerfile by NOT using '-P' (UPPERCASE) or '--publish-all' flag when starting the\ncontainer. Use the '-p' (lowercase) or '--publish' flag to explicitly define the ports that\nyou need for a particular container instance.For example,docker run --interactive --tty --publish 5000 --publish 5001 --publish 5002 centos\n/bin/bash\nImpact-None.Default Value-By default, all the ports that are listed in the Dockerfile under EXPOSE instruction for an\nimage are opened when container is run with '-P' or '--publish-all' flag.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do /usr/bin/docker port $i; done",
        "expect": ""
    },
    "custom_item_58": {
        "description": "5.9 Do not share the host's network namespace",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: NetworkMode={{ .HostConfig.NetworkMode }}'",
        "expect": "host"
    },
    "custom_item_59": {
        "description": "5.9 Do not share the host's network namespace",
        "info": "http://docs.docker.com/articles/networking/#how-docker-networks-a-container\n2.https://github.com/docker/docker/issues/6401",
        "solution": "Do not pass '--net=host' option when starting the container.Impact-None.Default Value-By default, container connects to Docker bridge.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: NetworkMode={{ .HostConfig.NetworkMode }}'",
        "expect": ""
    },
    "custom_item_60": {
        "description": "5.9 Do not share the host's network namespace",
        "info": "http://docs.docker.com/articles/networking/#how-docker-networks-a-container\n2.https://github.com/docker/docker/issues/6401",
        "solution": "Do not pass '--net=host' option when starting the container.Impact-None.Default Value-By default, container connects to Docker bridge.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: NetworkMode={{ .HostConfig.NetworkMode }}'",
        "expect": ".*"
    },
    "custom_item_61": {
        "description": "5.10 Limit memory usage for container",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Memory={{ .HostConfig.Memory }}'",
        "expect": "Memory=0"
    },
    "custom_item_62": {
        "description": "5.10 Limit memory usage for container",
        "info": "https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\n2.http://docs.docker.com/reference/commandline/cli/#run\n3.https://docs.docker.com/articles/runmetrics/",
        "solution": "Run the container with only as much memory as required. Always run the container using\n'-m' or '--memory' argument. You should start the container as below-$> docker run--memoryFor example,docker run --interactive --tty --memory 256m centos /bin/bashIn the above example, the container is started with a memory limit of 256 MB.Note- Please note that the output of the below command would return values in scientific\nnotation if memory limits are in place.docker inspect --format='{{.Config.Memory}}' 7c5a2d4c7fe0\nFor example, if the memory limit is set to 256 MB for the above container instance, the\noutput of the above command would be 2.68435456e+08 and NOT 256m. You should\nconvert this value using a scientific calculator or programmatic methods.Impact-If you do not set proper limits, the container process may have to starve.Default Value-By default, all containers on a Docker host share the resources equally. No memory limits\nare enforced.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Memory={{ .HostConfig.Memory }}'",
        "expect": ""
    },
    "custom_item_63": {
        "description": "5.10 Limit memory usage for container",
        "info": "https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\n2.http://docs.docker.com/reference/commandline/cli/#run\n3.https://docs.docker.com/articles/runmetrics/",
        "solution": "Run the container with only as much memory as required. Always run the container using\n'-m' or '--memory' argument. You should start the container as below-$> docker run--memoryFor example,docker run --interactive --tty --memory 256m centos /bin/bashIn the above example, the container is started with a memory limit of 256 MB.Note- Please note that the output of the below command would return values in scientific\nnotation if memory limits are in place.docker inspect --format='{{.Config.Memory}}' 7c5a2d4c7fe0\nFor example, if the memory limit is set to 256 MB for the above container instance, the\noutput of the above command would be 2.68435456e+08 and NOT 256m. You should\nconvert this value using a scientific calculator or programmatic methods.Impact-If you do not set proper limits, the container process may have to starve.Default Value-By default, all containers on a Docker host share the resources equally. No memory limits\nare enforced.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Memory={{ .HostConfig.Memory }}'",
        "expect": ".*"
    },
    "custom_item_64": {
        "description": "5.11 Set container CPU priority appropriately",
        "info": "https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\n2.http://docs.docker.com/reference/commandline/cli/#run\n3.https://docs.docker.com/articles/runmetrics/\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Manage the CPU shares between your containers. To do so start the container using '-c' or\n'--cpu-shares' argument. You may start the container as below-$> docker run--cpu-sharesFor example,docker run --interactive --tty --cpu-shares 512 centos /bin/bashIn the above example, the container is started with a CPU shares of 50% of what the other\ncontainers use. So, if the other container has CPU shares of 80%, this container will have\nCPU shares of 40%.\nNote- Every new container will have 1024 shares of CPU by default. However, this value is\nshown as '0' if you run the command mentioned in the audit section.Alternatively,1. Navigate to /sys/fs/cgroup/cpu/system.slice/ directory.\n2. Check your container instance ID using 'docker ps' command.\n3. Now, inside the above directory (in step 1), you would have a directory by name\n'docker-.scope' for example 'docker-\n4acae729e8659c6be696ee35b2237cc1fe4edd2672e9186434c5116e1a6fbed6.scope'.\nNavigate to this directory.\n4. You will find a file named 'cpu.shares'. Execute 'cat cpu.shares'. This will always\ngive you the CPU share value based on the system. So, even if there are no CPU\nshares configured using '-c' or '--cpu-shares' argument in the 'docker run'\ncommand, this file will have a value of '1024'.If we set one containers CPU shares to 512 it will receive half of the CPU time compared to\nthe other container. So, take 1024 as 100% and then do quick math to derive the number\nthat you should set for respective CPU shares. For example, use 512 if you want to set 50%\nand 256 if you want to set 25%.Impact-If you do not set proper CPU shares, the container process may have to starve if the\nresources on the host are not available. If the CPU resources on the host are free, CPU\nshares do not place any restrictions on the CPU that the container may use.Default Value-By default, all containers on a Docker host share the resources equally. No CPU shares are\nenforced.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: CpuShares={{ .HostConfig.CpuShares }}'",
        "expect": ""
    },
    "custom_item_65": {
        "description": "5.12 Mount container's root filesystem as read only",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: ReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'",
        "expect": "ReadonlyRootfs=false"
    },
    "custom_item_66": {
        "description": "5.12 Mount container's root filesystem as read only",
        "info": "http://docs.docker.com/reference/commandline/cli/#run",
        "solution": "Add a '--read-only' flag to allow the container's root filesystem to be mounted as read\nonly. This can be used in combination with volumes to force a container's process to only\nwrite to locations that will be persisted.You should run the container as below-$> docker run--read-only -vFor example,docker run --interactive --tty --read-only --volume /centdata centos /bin/bashThis would run the container with read-only root filesystem and would use 'centdata' as\ncontainer volume for writing.Impact-The container root file system would not be writable. You should explicitly define a volume\nfor the container for writing.Default Value-By default, a container will have its root filesystem writable allowing processes to write\nfiles anywhere.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: ReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'",
        "expect": ""
    },
    "custom_item_67": {
        "description": "5.12 Mount container's root filesystem as read only",
        "info": "http://docs.docker.com/reference/commandline/cli/#run",
        "solution": "Add a '--read-only' flag to allow the container's root filesystem to be mounted as read\nonly. This can be used in combination with volumes to force a container's process to only\nwrite to locations that will be persisted.You should run the container as below-$> docker run--read-only -vFor example,docker run --interactive --tty --read-only --volume /centdata centos /bin/bashThis would run the container with read-only root filesystem and would use 'centdata' as\ncontainer volume for writing.Impact-The container root file system would not be writable. You should explicitly define a volume\nfor the container for writing.Default Value-By default, a container will have its root filesystem writable allowing processes to write\nfiles anywhere.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: ReadonlyRootfs={{ .HostConfig.ReadonlyRootfs }}'",
        "expect": ".*"
    },
    "custom_item_68": {
        "description": "5.13 Bind incoming container traffic to a specific host interface",
        "cmd": "for i in $(/usr/bin/docker ps -q); do /usr/bin/docker port $i; done",
        "expect": "0\\.0\\.0\\.\\0:"
    },
    "custom_item_69": {
        "description": "5.13 Bind incoming container traffic to a specific host interface",
        "info": "https://docs.docker.com/articles/networking/#binding-container-ports-to-the-host",
        "solution": "Bind the container port to a specific host interface on the desired host port.For example,docker run --detach --publish 10.2.3.4-49153-80 nginxIn the example above, the container port 80 is bound to the host port on 49153 and would\naccept incoming connection only from 10.2.3.4 external interface.Impact-None.Default Value-By default, Docker exposes the container ports on 0.0.0.0, the wildcard IP address that\nwill match any possible incoming network interface on the host machine.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do /usr/bin/docker port $i; done",
        "expect": ""
    },
    "custom_item_70": {
        "description": "5.13 Bind incoming container traffic to a specific host interface",
        "info": "https://docs.docker.com/articles/networking/#binding-container-ports-to-the-host",
        "solution": "Bind the container port to a specific host interface on the desired host port.For example,docker run --detach --publish 10.2.3.4-49153-80 nginxIn the example above, the container port 80 is bound to the host port on 49153 and would\naccept incoming connection only from 10.2.3.4 external interface.Impact-None.Default Value-By default, Docker exposes the container ports on 0.0.0.0, the wildcard IP address that\nwill match any possible incoming network interface on the host machine.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "for i in $(/usr/bin/docker ps -q); do /usr/bin/docker port $i; done",
        "expect": ".*"
    },
    "custom_item_71": {
        "description": "5.14 Set the 'on-failure' container restart policy to 5 - RestartPolicyName=always",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: RestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{ .HostConfig.RestartPolicy.MaximumRetryCount }}'",
        "expect": "RestartPolicyName=always"
    },
    "custom_item_72": {
        "description": "5.14 Set the 'on-failure' container restart policy to 5 - RestartPolicyName=always",
        "info": "http://docs.docker.com/ reference/commandline/cli/#restart-policies",
        "solution": "If a container is desired to be restarted of its own, then start the container as below-$> docker run--restart=on-failure-5For example,docker run --detach --restart=on-failure-5 nginxImpact-The container would attempt to restart only for 5 times.Default Value-By default, containers are not configured with restart policies. Hence, containers do not\nattempt to restart of their own.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: RestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{ .HostConfig.RestartPolicy.MaximumRetryCount }}'",
        "expect": ""
    },
    "custom_item_73": {
        "description": "5.14 Set the 'on-failure' container restart policy to 5 - RestartPolicyName=always",
        "info": "http://docs.docker.com/ reference/commandline/cli/#restart-policies",
        "solution": "If a container is desired to be restarted of its own, then start the container as below-$> docker run--restart=on-failure-5For example,docker run --detach --restart=on-failure-5 nginxImpact-The container would attempt to restart only for 5 times.Default Value-By default, containers are not configured with restart policies. Hence, containers do not\nattempt to restart of their own.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: RestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{ .HostConfig.RestartPolicy.MaximumRetryCount }}'",
        "expect": ".*"
    },
    "custom_item_74": {
        "description": "5.14 Set the 'on-failure' container restart policy to 5 - RestartPolicyName=on-failure",
        "info": "http://docs.docker.com/ reference/commandline/cli/#restart-policies",
        "solution": "If a container is desired to be restarted of its own, then start the container as below-$> docker run--restart=on-failure-5For example,docker run --detach --restart=on-failure-5 nginxImpact-The container would attempt to restart only for 5 times.Default Value-By default, containers are not configured with restart policies. Hence, containers do not\nattempt to restart of their own.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: RestartPolicyName={{ .HostConfig.RestartPolicy.Name }} MaximumRetryCount={{ .HostConfig.RestartPolicy.MaximumRetryCount }}'|grep RestartPolicyName=on-failure|egrep 'MaximumRetryCount=([6-9]\\|[1-9][0-9]+)'",
        "expect": ""
    },
    "custom_item_75": {
        "description": "5.15 Do not share the host's process namespace",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: PidMode={{ .HostConfig.PidMode }}'",
        "expect": "PidMode=host"
    },
    "custom_item_76": {
        "description": "5.15 Do not share the host's process namespace",
        "info": "https://docs.docker.com/reference/run/#pid-settings\n2.http://man7.org/linux/man-pages/man7/pid_namespaces.7.html",
        "solution": "Do not start a container with '--pid=host' argument.For example, do not start a container as below-docker run --interactive --tty --pid=host centos /bin/bashImpact-Container processes cannot see the processes on the host system. In certain cases, you\nwant your container to share the host's process namespace. For example, you could build a\ncontainer with debugging tools like strace or gdb, but want to use these tools when\ndebugging processes within the container. If this is desired, then share only one (or\nneeded) host process by using the '-p' switch.For example,docker run --pid=host rhel7 strace -p 1234Default Value-By default, all containers have the PID namespace enabled and the host's process\nnamespace is not shared with the containers.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: PidMode={{ .HostConfig.PidMode }}'",
        "expect": ""
    },
    "custom_item_77": {
        "description": "5.15 Do not share the host's process namespace",
        "info": "https://docs.docker.com/reference/run/#pid-settings\n2.http://man7.org/linux/man-pages/man7/pid_namespaces.7.html",
        "solution": "Do not start a container with '--pid=host' argument.For example, do not start a container as below-docker run --interactive --tty --pid=host centos /bin/bashImpact-Container processes cannot see the processes on the host system. In certain cases, you\nwant your container to share the host's process namespace. For example, you could build a\ncontainer with debugging tools like strace or gdb, but want to use these tools when\ndebugging processes within the container. If this is desired, then share only one (or\nneeded) host process by using the '-p' switch.For example,docker run --pid=host rhel7 strace -p 1234Default Value-By default, all containers have the PID namespace enabled and the host's process\nnamespace is not shared with the containers.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: PidMode={{ .HostConfig.PidMode }}'",
        "expect": ".*"
    },
    "custom_item_78": {
        "description": "5.16 Do not share the host's IPC namespace",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: IpcMode={{ .HostConfig.IpcMode }}'",
        "expect": "IpcMode=host"
    },
    "custom_item_79": {
        "description": "5.16 Do not share the host's IPC namespace",
        "info": "https://docs.docker.com/reference/run/#ipc-settings\n2.http://man7.org/linux/man-pages/man7/namespaces.7.html",
        "solution": "Do not start a container with '--ipc=host' argument.\nFor example, do not start a container as below-docker run --interactive --tty --ipc=host centos /bin/bashImpact-Shared memory segments are used to accelerate inter-process communication. It is\ncommonly used by high performance applications. If such applications are containerized\ninto multiple containers, you might need to share the IPC namespace of the containers to\nachieve high performance. In such cases, you should still be sharing container specific IPC\nnamespaces only and not the host IPC namespace. You may share the container's IPC\nnamespace with other container as below-$> docker run--ipc=container-$INSTANCE_IDFor example,docker run --interactive --tty --ipc=container-e3a7a1a97c58 centos /bin/bashDefault Value-By default, all containers have the IPC namespace enabled and host IPC namespace is not\nshared with any container.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: IpcMode={{ .HostConfig.IpcMode }}'",
        "expect": ""
    },
    "custom_item_80": {
        "description": "5.16 Do not share the host's IPC namespace",
        "info": "https://docs.docker.com/reference/run/#ipc-settings\n2.http://man7.org/linux/man-pages/man7/namespaces.7.html",
        "solution": "Do not start a container with '--ipc=host' argument.\nFor example, do not start a container as below-docker run --interactive --tty --ipc=host centos /bin/bashImpact-Shared memory segments are used to accelerate inter-process communication. It is\ncommonly used by high performance applications. If such applications are containerized\ninto multiple containers, you might need to share the IPC namespace of the containers to\nachieve high performance. In such cases, you should still be sharing container specific IPC\nnamespaces only and not the host IPC namespace. You may share the container's IPC\nnamespace with other container as below-$> docker run--ipc=container-$INSTANCE_IDFor example,docker run --interactive --tty --ipc=container-e3a7a1a97c58 centos /bin/bashDefault Value-By default, all containers have the IPC namespace enabled and host IPC namespace is not\nshared with any container.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: IpcMode={{ .HostConfig.IpcMode }}'",
        "expect": ".*"
    },
    "custom_item_81": {
        "description": "5.17 Do not directly expose host devices to containers",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Devices={{ .HostConfig.Devices }}'",
        "expect": "Devices=\\\\[.+\\\\]"
    },
    "custom_item_82": {
        "description": "5.17 Do not directly expose host devices to containers",
        "info": "http://docs.docker.com/reference/commandline/cli/#run",
        "solution": "Do not directly expose the host devices to containers. If at all, you need to expose the host\ndevices to containers, use the correct set of permissions-For example, do not start a container as below-docker run --interactive --tty --device=/dev/tty0-/dev/tty0-rwm --\ndevice=/dev/temp_sda-/dev/temp_sda-rwm centos bashFor example, share the host device with correct permissions-docker run --interactive --tty --device=/dev/tty0-/dev/tty0-rw --\ndevice=/dev/temp_sda-/dev/temp_sda-r centos bashImpact-You would not be able to use the host devices directly within the containers.Default Value-By default, no host devices are exposed to containers. If you do not provide sharing\npermissions and choose to expose a host device to a container, the host device would be\nexposed with read, write and mknod permissions.",
        "reference": "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.,LEVEL|1M",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Devices={{ .HostConfig.Devices }}'",
        "expect": ""
    },
    "custom_item_83": {
        "description": "5.17 Do not directly expose host devices to containers",
        "info": "http://docs.docker.com/reference/commandline/cli/#run",
        "solution": "Do not directly expose the host devices to containers. If at all, you need to expose the host\ndevices to containers, use the correct set of permissions-For example, do not start a container as below-docker run --interactive --tty --device=/dev/tty0-/dev/tty0-rwm --\ndevice=/dev/temp_sda-/dev/temp_sda-rwm centos bashFor example, share the host device with correct permissions-docker run --interactive --tty --device=/dev/tty0-/dev/tty0-rw --\ndevice=/dev/temp_sda-/dev/temp_sda-r centos bashImpact-You would not be able to use the host devices directly within the containers.Default Value-By default, no host devices are exposed to containers. If you do not provide sharing\npermissions and choose to expose a host device to a container, the host device would be\nexposed with read, write and mknod permissions.",
        "reference": "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.,LEVEL|1M",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Devices={{ .HostConfig.Devices }}'",
        "expect": ".*"
    },
    "custom_item_84": {
        "description": "5.18 Override default ulimit at runtime only if needed",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Ulimits={{json .HostConfig.Ulimits }}'",
        "expect": "Ulimits=\\\\[.*\\\\]"
    },
    "custom_item_85": {
        "description": "5.18 Override default ulimit at runtime only if needed",
        "info": "http://docs.docker.com/reference/commandline/cli/#setting-ulimits-in-a-container",
        "solution": "Only override the default ulimit settings if needed.For example, to override default ulimit settings start a container as below-docker run --ulimit nofile=1024-1024 --interactive --tty centos /bin/bashImpact-If the ulimits are not set properly, the desired resource control might not be achieved and\nmight even make the system unusable.\nDefault Value-Container instances inherit the default ulimit settings set at the Docker daemon level.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1M,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Ulimits={{json .HostConfig.Ulimits }}'",
        "expect": ""
    },
    "custom_item_86": {
        "description": "5.18 Override default ulimit at runtime only if needed",
        "info": "http://docs.docker.com/reference/commandline/cli/#setting-ulimits-in-a-container",
        "solution": "Only override the default ulimit settings if needed.For example, to override default ulimit settings start a container as below-docker run --ulimit nofile=1024-1024 --interactive --tty centos /bin/bashImpact-If the ulimits are not set properly, the desired resource control might not be achieved and\nmight even make the system unusable.\nDefault Value-Container instances inherit the default ulimit settings set at the Docker daemon level.",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1M,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "/usr/bin/docker ps -q | xargs /usr/bin/docker inspect --format '{{ .Id }}: Ulimits={{json .HostConfig.Ulimits }}'",
        "expect": ".*"
    },
    "custom_item_87": {
        "description": "5.19 Do not set mount propagation mode to shared",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Propagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'",
        "expect": "shared"
    },
    "custom_item_88": {
        "description": "5.19 Do not set mount propagation mode to shared",
        "info": "https://github.com/docker/docker/pull/17034\n2.https://docs.docker.com/engine/reference/run/\n3.https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt",
        "solution": "Do not mount volumes in shared mode propagation.For example, do not start container as below-docker run--volume=/hostPath-/containerPath-sharedImpact-None.Default Value-By default, the container mounts are private.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Propagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'",
        "expect": ""
    },
    "custom_item_89": {
        "description": "5.19 Do not set mount propagation mode to shared",
        "info": "https://github.com/docker/docker/pull/17034\n2.https://docs.docker.com/engine/reference/run/\n3.https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt",
        "solution": "Do not mount volumes in shared mode propagation.For example, do not start container as below-docker run--volume=/hostPath-/containerPath-sharedImpact-None.Default Value-By default, the container mounts are private.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Propagation={{range $mnt := .Mounts}} {{json $mnt.Propagation}} {{end}}'",
        "expect": ".*"
    },
    "custom_item_90": {
        "description": "5.20 Do not share the host's UTS namespace",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UTSMode={{ .HostConfig.UTSMode }}'",
        "expect": "host"
    },
    "custom_item_91": {
        "description": "5.20 Do not share the host's UTS namespace",
        "info": "https://docs.docker.com/engine/reference/run/\n2.http://man7.org/linux/man-pages/man7/namespaces.7.html",
        "solution": "Do not start a container with '--uts=host' argument.For example, do not start a container as below-docker run --rm --interactive --tty --uts=host rhel7.2Impact-None.Default Value-\nBy default, all containers have the UTS namespace enabled and host UTS namespace is not\nshared with any container.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UTSMode={{ .HostConfig.UTSMode }}'",
        "expect": ""
    },
    "custom_item_92": {
        "description": "5.20 Do not share the host's UTS namespace",
        "info": "https://docs.docker.com/engine/reference/run/\n2.http://man7.org/linux/man-pages/man7/namespaces.7.html",
        "solution": "Do not start a container with '--uts=host' argument.For example, do not start a container as below-docker run --rm --interactive --tty --uts=host rhel7.2Impact-None.Default Value-\nBy default, all containers have the UTS namespace enabled and host UTS namespace is not\nshared with any container.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UTSMode={{ .HostConfig.UTSMode }}'",
        "expect": ".*"
    },
    "custom_item_93": {
        "description": "5.21 Do not disable default seccomp profile",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: SecurityOpt={{ .HostConfig.SecurityOpt }}'",
        "expect": "seccomp:unconfined"
    },
    "custom_item_94": {
        "description": "5.21 Do not disable default seccomp profile",
        "info": "http://blog.scalock.com/new-docker-security-features-and-what-they-mean-seccomp-profiles\n2.https://docs.docker.com/engine/reference/run/\n3.https://github.com/docker/docker/blob/master/profiles/seccomp/default.json\n4.https://docs.docker.com/engine/security/seccomp/\n5.https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt",
        "solution": "By default, seccomp profiles are enabled. You do not need to do anything unless you want\nto modify and use the modified seccomp profile.Impact-With Docker 1.10 and greater, the default seccomp profile blocks syscalls, regardless of --\ncap-add passed to the container. You should create your own custom seccomp profile in\nsuch cases. You may also disable the default seccomp profile by passing --security-\nopt=seccomp-unconfined on docker run.\nDefault Value-When you run a container, it uses the default profile unless you override it with the --\nsecurity-opt option.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: SecurityOpt={{ .HostConfig.SecurityOpt }}'",
        "expect": ""
    },
    "custom_item_95": {
        "description": "5.21 Do not disable default seccomp profile",
        "info": "http://blog.scalock.com/new-docker-security-features-and-what-they-mean-seccomp-profiles\n2.https://docs.docker.com/engine/reference/run/\n3.https://github.com/docker/docker/blob/master/profiles/seccomp/default.json\n4.https://docs.docker.com/engine/security/seccomp/\n5.https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt",
        "solution": "By default, seccomp profiles are enabled. You do not need to do anything unless you want\nto modify and use the modified seccomp profile.Impact-With Docker 1.10 and greater, the default seccomp profile blocks syscalls, regardless of --\ncap-add passed to the container. You should create your own custom seccomp profile in\nsuch cases. You may also disable the default seccomp profile by passing --security-\nopt=seccomp-unconfined on docker run.\nDefault Value-When you run a container, it uses the default profile unless you override it with the --\nsecurity-opt option.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: SecurityOpt={{ .HostConfig.SecurityOpt }}'",
        "expect": ".*"
    },
    "custom_item_96": {
        "description": "5.24 Confirm cgroup usage",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: CgroupParent={{ .HostConfig.CgroupParent }}'",
        "expect": "CgroupParent=.+"
    },
    "custom_item_97": {
        "description": "5.24 Confirm cgroup usage",
        "info": "https://docs.docker.com/engine/reference/run/#specifying-custom-cgroups\n2.https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html",
        "solution": "Do not use --cgroup-parent option in docker run command unless needed.Impact-None.Default Value-By default, containers run under docker cgroup.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: CgroupParent={{ .HostConfig.CgroupParent }}'",
        "expect": ""
    },
    "custom_item_98": {
        "description": "5.24 Confirm cgroup usage",
        "info": "https://docs.docker.com/engine/reference/run/#specifying-custom-cgroups\n2.https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html",
        "solution": "Do not use --cgroup-parent option in docker run command unless needed.Impact-None.Default Value-By default, containers run under docker cgroup.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: CgroupParent={{ .HostConfig.CgroupParent }}'",
        "expect": ".+"
    },
    "custom_item_99": {
        "description": "5.25 Restrict container from acquiring additional privileges",
        "info": "https://github.com/projectatomic/atomic-site/issues/269\n2.https://github.com/docker/docker/pull/20727\n3.https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt\n4.https://lwn.net/Articles/475678/\n5.https://lwn.net/Articles/475362/",
        "solution": "Start a container as below-docker run--security-opt=no-new-privilegesFor example,docker run --rm -it --security-opt=no-new-privileges ubuntu bashImpact-no_new_priv prevents LSMs like SELinux from transitioning to process labels that have\naccess not allowed to the current process.Default Value-By default, new privileges are not restricted.",
        "reference": "800-53|SC-39,800-53r5|SC-39,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A,QCSC-v1|5.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: SecurityOpt={{ .HostConfig.SecurityOpt }}'|grep -v no-new-privileges",
        "expect": ""
    },
    "custom_item_100": {
        "description": "5.26 Check container health at runtime",
        "info": "https://github.com/docker/docker/pull/22719\n      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the container using --health-cmd and the other parameters.For example,docker run -d --health-cmd='stat /etc/passwd || exit 1' nginxImpact-None.Default Value-By default, health checks are not done at container runtime.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Health={{ .State.Health.Status }}'",
        "expect": "Health="
    },
    "custom_item_101": {
        "description": "5.28 Use PIDs cgroup limit",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: PidsLimit={{ .HostConfig.PidsLimit }}'",
        "expect": "PidsLimit=(0|-1)$"
    },
    "custom_item_102": {
        "description": "5.28 Use PIDs cgroup limit",
        "info": "https://github.com/docker/docker/pull/18697\n2.https://docs.docker.com/engine/reference/commandline/run/",
        "solution": "Use --pids-limit flag while launching the container with an appropriate value.For example,docker run -it --pids-limit 100In the above example, the number of processes allowed to run at any given time is set to\n100. After a limit of 100 concurrently running processes is reached, docker would restrict\nany new process creation.Impact-Set the PIDs limit value as appropriate. Incorrect values might leave the containers\nunusable.Default Value-The Default value for --pids-limit is 0 which means there is no restriction on the number\nof forks. Also, note that PIDs cgroup limit works only for the kernel versions 4.3+.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: PidsLimit={{ .HostConfig.PidsLimit }}'",
        "expect": ""
    },
    "custom_item_103": {
        "description": "5.28 Use PIDs cgroup limit",
        "info": "https://github.com/docker/docker/pull/18697\n2.https://docs.docker.com/engine/reference/commandline/run/",
        "solution": "Use --pids-limit flag while launching the container with an appropriate value.For example,docker run -it --pids-limit 100In the above example, the number of processes allowed to run at any given time is set to\n100. After a limit of 100 concurrently running processes is reached, docker would restrict\nany new process creation.Impact-Set the PIDs limit value as appropriate. Incorrect values might leave the containers\nunusable.Default Value-The Default value for --pids-limit is 0 which means there is no restriction on the number\nof forks. Also, note that PIDs cgroup limit works only for the kernel versions 4.3+.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: PidsLimit={{ .HostConfig.PidsLimit }}'",
        "expect": ".*"
    },
    "custom_item_104": {
        "description": "5.30 Do not share the host's user namespaces",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UsernsMode={{ .HostConfig.UsernsMode }}'",
        "expect": "UsernsMode=.+"
    },
    "custom_item_105": {
        "description": "5.30 Do not share the host's user namespaces",
        "info": "https://docs.docker.com/engine/reference/commandline/run/#/run\n2.https://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf\n3.https://github.com/docker/docker/pull/12648",
        "solution": "Do not share user namespaces between host and containers.Impact-NoneDefault Value-By default, the host user namespace is shared with the containers until user namespace\nsupport is enabled.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7a.,800-53r5|SC-7a.,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T3.6.3,NESA|T4.2.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UsernsMode={{ .HostConfig.UsernsMode }}'",
        "expect": ""
    },
    "custom_item_106": {
        "description": "5.30 Do not share the host's user namespaces",
        "info": "https://docs.docker.com/engine/reference/commandline/run/#/run\n2.https://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf\n3.https://github.com/docker/docker/pull/12648",
        "solution": "Do not share user namespaces between host and containers.Impact-NoneDefault Value-By default, the host user namespace is shared with the containers until user namespace\nsupport is enabled.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7a.,800-53r5|SC-7a.,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7a.,LEVEL|1A,NESA|T3.4.1,NESA|T3.6.3,NESA|T4.2.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: UsernsMode={{ .HostConfig.UsernsMode }}'",
        "expect": ".*"
    },
    "custom_item_107": {
        "description": "5.31 Do not mount the Docker socket inside any containers",
        "info": "https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/\n2.https://forums.docker.com/t/docker-in-docker-vs-mounting-var-run-docker-\nsock/9450/2\n3.https://github.com/docker/docker/issues/21109",
        "solution": "Ensure that no containers mount docker.sock as a volume.Impact-NoneDefault Value-By default, docker.sock is not mounted inside containers.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|1A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/517",
        "cmd": "docker ps --quiet | xargs docker inspect --format '{{ .Id }}: Volumes={{ .Mounts }}' | grep docker\\\\.sock",
        "expect": ""
    }
}