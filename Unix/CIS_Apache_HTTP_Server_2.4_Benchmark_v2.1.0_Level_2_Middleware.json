{
    "custom_item_1": {
        "description": "Apache found",
        "cmd": "@APP_Binary_catalog@/apachectl -version",
        "expect": "Apache/@PRODUCT_VERSION@.*"
    },
    "custom_item_2": {
        "system": "Linux",
        "description": "5.13 Ensure Access to Inappropriate File Extensions Is Restricted - 'httpd.conf FileMatch directive'",
        "info": "Restrict access to inappropriate file extensions that are not expected to be a legitimate part of web sites using the FilesMatch directive.\n\nRationale:\n\nThere are many files that are often left within the web server document root that could provide an attacker with sensitive information. Most often these files are mistakenly left behind after installation, trouble-shooting, or backing up files before editing. Regardless of the reason for their creation, these files can still be served by Apache even when there is no hyperlink pointing to them. The web administrators should use the FilesMatch directive to restrict access to only those file extensions that are appropriate for the web server. Rather than create a list of potentially inappropriate file extensions such as .bak, .config, .old, etc, it is recommended instead that a white list of the appropriate and expected file extensions for the web server be created, reviewed and restricted with a FilesMatch directive.",
        "solution": "Perform the following to implement the recommended state:\n\nCompile a list of existing file extension on the web server. The following find/awk command may be useful, but is likely to need some customization according to the appropriate webroot directories for your web server. Please note that the find command skips over any files without a dot (.) in the file name, as these are not expected to be appropriate web content.\n\nfind */htdocs -type f -name '*.*' | awk -F. '{print $NF }' | sort -u\n\nReview the list of existing file extensions, for appropriate content for the web server, remove those that are inappropriate and add any additional file extensions expected to be added to the web server in the near future.\n\nAdd the FilesMatch directive below which denies access to all files by default.\n\n# Block all files by default, unless specifically allowed.Require all deniedAdd another a FilesMatch directive that allows access to those file extensions specifically allowed from the review process in step 2. An example FilesMatch directive is below. The file extensions in the regular expression should match your approved list, and not necessarily the expression below.\n\n# Allow files with specifically approved file extensions\n# Such as (css, htm; html; js; pdf; txt; xml; xsl; ...),\n# images (gif; ico; jpeg; jpg; png; ...), multimediaRequire all grantedDefault Value:\n\nThere are no restrictions on file extensions in the default configuration.",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/bin/sed -n '//p' @APP_Config_files@ /dev/null | /usr/bin/egrep '^\\\\s*Require\\\\s+'",
        "expect": "^[\\\\s]*Require[\\\\s]+[Aa]ll[\\\\s]*[Dd]enied[\\\\s]*$"
    },
    "custom_item_3": {
        "system": "Linux",
        "description": "12.3 Ensure Apache AppArmor Profile is in Enforce Mode",
        "info": "AppArmor profiles may be in one of three modes: disabled, complain or enforce. In the complain mode, any violations of the access controls are logged but the restrictions are not enforced. Also, once a profile mode has been changed, it is recommended to restart the Apache server, otherwise the currently running process may not be confined by the policy.\n\nRationale:\n\nThe complain mode is useful for testing and debugging a profile, but is not appropriate for production. Only the confined process running in enforce mode will prevent attacks that violate the configured access controls.",
        "solution": "Perform the following to implement the recommended state:\n\nSet the profile state to enforce mode.\n\n# aa-enforce apache2\nSetting /usr/sbin/apache2 to enforce mode.\n\nStop the Apache server and confirm that is it not running. In some cases, the AppArmor controls may prevent the web server from stopping properly, and it may be necessary to stop the process manually or even reboot the server.\n\n# service apache2 stop\n * Stopping web server apache2\n# service apache2 status\n * apache2 is not running\n\nRestart the Apache service.\n\n# service apache2 start\n * Starting web server apache2\n\nDefault Value:\n\nThe default mode is enforce.",
        "reference": "800-171|3.4.8,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|2.7,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestBody[\\\\s]*",
        "expect": "@APP_Binary_catalog@/apachectl[\\\\s]*confined[\\\\s]*by[\\\\s]*'@APP_Binary_catalog@/apachectl[\\\\s]*\\\\(enforce\\\\)'",
        "MEDIUMsystem": "Linux",
        "cmd": "/usr/sbin/aa-unconfined --paranoid | /usr/bin/grep @APP_Binary_catalog@/apachectl",
        "rpm": "libselinux1-0.0.0-0",
        "operator": "gt",
        "YESsystem": "Linux",
        "MEDIUMdescription": "12.1 Ensure the AppArmor Framework Is Enabled"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "5.14 Ensure IP Address Based Requests Are Disallowed - RewriteEngine",
        "info": "The Apache module mod_rewrite can be used to disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a host name which will therefore include the host name in the HTTP HOST header.\n\nRationale:\n\nA common malware propagation and automated network scanning technique is to use IP addresses rather than host names for web requests, since it's much simpler to automate. By denying IP based web requests, these automated techniques will be denied access to the website. Of course, malicious web scanning techniques continue to evolve, and many are now using hostnames, however denying access to the IP based requests is still a worthwhile defense.",
        "solution": "Perform the following to implement the recommended state:\n\nLoad the mod_rewrite module for Apache by doing either one of the following:\n\nBuild Apache with mod_rewrite statically loaded during the build, by adding the --enable-rewrite option to the ./configure script.\n\n./configure --enable-rewrite\n\nOr, dynamically loading the module with the LoadModule directive in the httpd.conf configuration file.\n\nLoadModule rewrite_module modules/mod_rewrite.so\n\nAdd the RewriteEngine directive to the configuration within the global server context with the value of on so that the rewrite engine is enabled.\n\nRewriteEngine On\n\nLocate the Apache configuration file such as httpd.conf and add the following rewrite condition to match the expected host name of the top server level configuration.\n\nRewriteCond %{HTTP_HOST} !^www\\.example\\.com [NC]\nRewriteCond %{REQUEST_URI} !^/error [NC]\nRewriteRule ^.(.*) - [L,F]\n\nDefault Value:\n\nRewriteEngine off",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|9.2,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*RewriteEngine[\\\\s]*",
        "expect": "^[\\\\s]*RewriteEngine[\\\\s]+On[\\\\s]*"
    },
    "custom_item_5": {
        "system": "Linux",
        "description": "5.14 Ensure IP Address Based Requests Are Disallowed - RewriteCond HTTP_HOST",
        "info": "The Apache module mod_rewrite can be used to disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a host name which will therefore include the host name in the HTTP HOST header.\n\nRationale:\n\nA common malware propagation and automated network scanning technique is to use IP addresses rather than host names for web requests, since it's much simpler to automate. By denying IP based web requests, these automated techniques will be denied access to the website. Of course, malicious web scanning techniques continue to evolve, and many are now using hostnames, however denying access to the IP based requests is still a worthwhile defense.",
        "solution": "Perform the following to implement the recommended state:\n\nLoad the mod_rewrite module for Apache by doing either one of the following:\n\nBuild Apache with mod_rewrite statically loaded during the build, by adding the --enable-rewrite option to the ./configure script.\n\n./configure --enable-rewrite\n\nOr, dynamically loading the module with the LoadModule directive in the httpd.conf configuration file.\n\nLoadModule rewrite_module modules/mod_rewrite.so\n\nAdd the RewriteEngine directive to the configuration within the global server context with the value of on so that the rewrite engine is enabled.\n\nRewriteEngine On\n\nLocate the Apache configuration file such as httpd.conf and add the following rewrite condition to match the expected host name of the top server level configuration.\n\nRewriteCond %{HTTP_HOST} !^www\\.example\\.com [NC]\nRewriteCond %{REQUEST_URI} !^/error [NC]\nRewriteRule ^.(.*) - [L,F]\n\nDefault Value:\n\nRewriteEngine off",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|9.2,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*RewriteCond[\\\\s]+",
        "expect": "^[\\\\s]*RewriteCond[\\\\s]+%{HTTP_HOST}[\\\\s]+!\\\\^.*[A-z]+.*[\\\\s]+[\\\\[]NC[\\\\]]"
    },
    "custom_item_6": {
        "system": "Linux",
        "description": "5.14 Ensure IP Address Based Requests Are Disallowed - RewriteCond REQUEST_URI",
        "info": "The Apache module mod_rewrite can be used to disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a host name which will therefore include the host name in the HTTP HOST header.\n\nRationale:\n\nA common malware propagation and automated network scanning technique is to use IP addresses rather than host names for web requests, since it's much simpler to automate. By denying IP based web requests, these automated techniques will be denied access to the website. Of course, malicious web scanning techniques continue to evolve, and many are now using hostnames, however denying access to the IP based requests is still a worthwhile defense.",
        "solution": "Perform the following to implement the recommended state:\n\nLoad the mod_rewrite module for Apache by doing either one of the following:\n\nBuild Apache with mod_rewrite statically loaded during the build, by adding the --enable-rewrite option to the ./configure script.\n\n./configure --enable-rewrite\n\nOr, dynamically loading the module with the LoadModule directive in the httpd.conf configuration file.\n\nLoadModule rewrite_module modules/mod_rewrite.so\n\nAdd the RewriteEngine directive to the configuration within the global server context with the value of on so that the rewrite engine is enabled.\n\nRewriteEngine On\n\nLocate the Apache configuration file such as httpd.conf and add the following rewrite condition to match the expected host name of the top server level configuration.\n\nRewriteCond %{HTTP_HOST} !^www\\.example\\.com [NC]\nRewriteCond %{REQUEST_URI} !^/error [NC]\nRewriteRule ^.(.*) - [L,F]\n\nDefault Value:\n\nRewriteEngine off",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|9.2,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*RewriteCond[\\\\s]+",
        "expect": "^[\\\\s]*RewriteCond[\\\\s]+%{REQUEST_URI}[\\\\s]+!\\\\^/error[\\\\s]+[\\\\[]NC[\\\\]]"
    },
    "custom_item_7": {
        "system": "Linux",
        "description": "5.14 Ensure IP Address Based Requests Are Disallowed - RewriteRule",
        "info": "The Apache module mod_rewrite can be used to disallow access for requests that use an IP address instead of a host name for the URL. Most normal access to the website from browsers and automated software will use a host name which will therefore include the host name in the HTTP HOST header.\n\nRationale:\n\nA common malware propagation and automated network scanning technique is to use IP addresses rather than host names for web requests, since it's much simpler to automate. By denying IP based web requests, these automated techniques will be denied access to the website. Of course, malicious web scanning techniques continue to evolve, and many are now using hostnames, however denying access to the IP based requests is still a worthwhile defense.",
        "solution": "Perform the following to implement the recommended state:\n\nLoad the mod_rewrite module for Apache by doing either one of the following:\n\nBuild Apache with mod_rewrite statically loaded during the build, by adding the --enable-rewrite option to the ./configure script.\n\n./configure --enable-rewrite\n\nOr, dynamically loading the module with the LoadModule directive in the httpd.conf configuration file.\n\nLoadModule rewrite_module modules/mod_rewrite.so\n\nAdd the RewriteEngine directive to the configuration within the global server context with the value of on so that the rewrite engine is enabled.\n\nRewriteEngine On\n\nLocate the Apache configuration file such as httpd.conf and add the following rewrite condition to match the expected host name of the top server level configuration.\n\nRewriteCond %{HTTP_HOST} !^www\\.example\\.com [NC]\nRewriteCond %{REQUEST_URI} !^/error [NC]\nRewriteRule ^.(.*) - [L,F]\n\nDefault Value:\n\nRewriteEngine off",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|9.2,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*RewriteRule[\\\\s]+",
        "expect": "^[\\\\s]*RewriteRule[\\\\s]+\\\\^\\\\\\.\\\\(\\\\\\.\\\\*\\\\)[\\\\s]+-[\\\\s]+[\\\\[]L,F[\\\\]]"
    },
    "custom_item_8": {
        "system": "Linux",
        "description": "5.15 Ensure the IP Addresses for Listening for Requests Are Specified - 'httpd.conf Listen 0.0.0.0:80 does not exists'",
        "info": "The Apache Listen directive specifies the IP addresses and port numbers the Apache web server will listen for requests. Rather than be unrestricted to listen on all IP addresses available to the system, the specific IP address or addresses intended should be explicitly specified. Specifically, a Listen directive with no IP address specified, or with an IP address of zeros should not be used.\n\nRationale:\n\nHaving multiple interfaces on web servers is fairly common, and without explicit Listen directives, the web server is likely to be listening on an inappropriate IP address / interface that was not intended for the web server. Single homed system with a single IP addressed are also required to have an explicit IP address in the Listen directive, in case additional interfaces are added to the system at a later date.",
        "solution": "Perform the following to implement the recommended state:\n\nFind any Listen directives in the Apache configuration file with no IP address specified, or with an IP address of all zeros similar to the examples below. Keep in mind there may be both IPv4 and IPv6 addresses on the system.\n\nListen 80\nListen 0.0.0.0:80\nListen [::ffff:0.0.0.0]:80\n\nModify the Listen directives in the Apache configuration file to have explicit IP addresses according to the intended usage. Multiple Listendirectives may be specified for each IP address & Port.\n\nListen 10.1.2.3:80\nListen 192.168.4.5:80\nListen [2001:db8::a00:20ff:fea7:ccea]:80\n\nDefault Value:\n\nListen 80",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7(1),800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|9.2,CSCv8|2.7,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2A,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*Listen[\\\\s]+",
        "expect": "^[\\\\s]*Listen[\\\\s]+(.*0\\\\.0\\\\.0\\\\.0.*:)?80[\\\\s]*$"
    },
    "custom_item_9": {
        "system": "Linux",
        "description": "5.15 Ensure the IP Addresses for Listening for Requests Are Specified - 'httpd.conf Listen [::ffff:0.0.0.0]:80 does not exists'",
        "info": "The Apache Listen directive specifies the IP addresses and port numbers the Apache web server will listen for requests. Rather than be unrestricted to listen on all IP addresses available to the system, the specific IP address or addresses intended should be explicitly specified. Specifically, a Listen directive with no IP address specified, or with an IP address of zeros should not be used.\n\nRationale:\n\nHaving multiple interfaces on web servers is fairly common, and without explicit Listen directives, the web server is likely to be listening on an inappropriate IP address / interface that was not intended for the web server. Single homed system with a single IP addressed are also required to have an explicit IP address in the Listen directive, in case additional interfaces are added to the system at a later date.",
        "solution": "Perform the following to implement the recommended state:\n\nFind any Listen directives in the Apache configuration file with no IP address specified, or with an IP address of all zeros similar to the examples below. Keep in mind there may be both IPv4 and IPv6 addresses on the system.\n\nListen 80\nListen 0.0.0.0:80\nListen [::ffff:0.0.0.0]:80\n\nModify the Listen directives in the Apache configuration file to have explicit IP addresses according to the intended usage. Multiple Listendirectives may be specified for each IP address & Port.\n\nListen 10.1.2.3:80\nListen 192.168.4.5:80\nListen [2001:db8::a00:20ff:fea7:ccea]:80\n\nDefault Value:\n\nListen 80",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7(1),800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|9.2,CSCv8|2.7,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2A,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*Listen[\\\\s]+",
        "expect": "^[\\\\s]*Listen[\\\\s]+\\[::ffff:0\\\\.0\\\\.0\\\\.0\\]:80[\\\\s]*$"
    },
    "custom_item_10": {
        "system": "Linux",
        "description": "5.16 Ensure Browser Framing Is Restricted",
        "info": "To prevent Clickjacking or UI Redressing attacks, it's important for the server to include an HTTP header which instructs browsers to restrict the content from being framed. There are two headers that may be used. The Content-Security-Policy header, or the X-Frame-Options header. The Header directive allows server HTTP response headers to be added, replaced or merged. We will use the directive to add a server HTTP response header to tell browsers to restrict all of the web pages from being framed by other web sites.\n\nRationale:\n\nUsing iframes and regular web frames to embed malicious content along with expected web content has been a favored attack vector for attacking web clients for a long time. This can happen when the attacker lures the victim to a malicious web site, which uses frames to include the expected content from the legitimate site. The attack can also be performed via XSS (either reflected, DOM or stored XSS) to add the malicious content to the legitimate web site.\n\nTo combat this attack vector, either an X-Frame-Options response header or a Content-Security-Policy response header may be used. The Content-Security-Policy header is the preferred solution. The X-Frame-Options header should have a value of either DENY, which prevents all framing, or SAMEORIGIN which prevents framing except via pages which share the same origin. The Content-Security-Policy header may also be to restrict framing with a frame-ancestors directive and a value of none or self",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the Header directive for the Content-Security-Policy header in the Apache configuration to have the condition always, an action of append and a value of frame-ancestors self, as shown below.\n\nHeader always append Content-Security-Policy 'frame-ancestors 'self''\n\nDefault Value:\n\nNeither the Content-Security-Policy HTTP response header nor the X-Frame-Options header is generated by default.",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|8.5,CSCv7|18.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*.+X-Frame-Options[\\\\s]+",
        "expect": "^[\\\\s]*Header[\\\\s]+[Aa]lways[\\\\s]+([Aa]ppend|[Ss]et)[\\\\s]+X-Frame-Options[\\\\s]+(SAMEORIGIN|DENY)[\\\\s]*$"
    },
    "custom_item_11": {
        "system": "Linux",
        "description": "5.17 Ensure HTTP Header Referrer-Policy is set appropriately",
        "info": "The server now allows for controlling the amount of 'referrer' information being sent with requests. Limiting information to only what is needed is security best practice.\n\nRationale:\n\nHTTP/S traffic is vulnerabe to attack - limiting what is sent in a request to only what is needed will limit the threat vector.\n\nImpact:\n\nYou must only limit the header information to what is needed to support the request. Limiting it to much may disrupt the ability to get a proper/expected response.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the Header directive for the Referrer-Policy header in the Apache configuration to have the appropriate condition as shown below.\n\nHeader set Referrer-Policy ''\n\nDefault Value:\n\nReferrer-Policy Policy is not set by Default",
        "reference": "800-171|3.4.9,800-171|3.13.1,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-7(8),800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-7(8),800-53r5|SC-18,CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv7|18.2,CSCv8|9.4,CSCv8|13.10,CSF|DE.CM-3,CSF|DE.CM-5,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(8),ITSG-33|SC-18,LEVEL|2M,NESA|T4.5.4,NIAv2|SU3,NIAv2|SU4,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "Referrer-Policy",
        "expect": ""
    },
    "custom_item_12": {
        "system": "Linux",
        "description": "5.18 Ensure HTTP Header Permissions-Policy is set appropriately",
        "info": "The HTTP Permissions-Policy is a control that provides a way to allow or deny the use of certain browser features within a document or within any element in the document.\n\nRationale:\n\nHaving and using the ability to control browser features as needed with the directive follows the zero trust model and comply directly with CIS Controls section 2 of versions 7 and 8.\n\nImpact:\n\nYou must only limit the origins and directives to what is needed to support the request. Limiting it too much may disrupt the ability to get a proper/expected response.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the Header directive for the Permissions-Policy header in the Apache configuration to have the appropriate condition as shown below.\n\nHeader set Permissions-Policy ''\n\nDefault Value:\n\nPermissions-Policy Policy is not set by Default",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-53|CM-7,800-53|CM-7(1),800-53|SC-7(8),800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SC-7(8),800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CN-L3|8.1.10.6(j),CSCv7|2.7,CSCv7|9.4,CSCv8|2.7,CSCv8|13.10,CSF|PR.AC-5,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SC-7(8),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2M,NESA|T3.4.1,NESA|T4.5.4,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,NIAv2|SU4,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "Permissions-Policy",
        "expect": ""
    },
    "custom_item_13": {
        "system": "Linux",
        "description": "6.2 Ensure a Syslog Facility Is Configured for Error Logging - Main",
        "info": "The ErrorLog directive should be configured to send logs to a syslog facility so that the logs can be processed and monitored along with the system logs.\n\nRationale:\n\nIt is easy for the web server error logs to be overlooked in the log monitoring process, and yet the application level attacks have become the most common and are extremely important for detecting attacks early, as well as detecting non-malicious problems such as a broken link, or internal errors. By including the Apache error logs with the system logging facility, the application logs are more likely to be included in the established log monitoring process.",
        "solution": "Perform the following to implement the recommended state:\n\nAdd an ErrorLog directive if not already configured. Any appropriate syslog facility may be used in place of local1.\n\nErrorLog 'syslog:local1'\n\nAdd a similar ErrorLog directive for each virtual host if necessary.\n\nDefault Value:\n\nThe following is the default configuration:\n\nErrorLog 'logs/error_log'",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.6,CSCv7|6.8,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*ErrorLog[\\\\s]+",
        "expect": "^[\\\\s]*ErrorLog[\\\\s]+\"syslog:.*\"[\\\\s]*$"
    },
    "custom_item_14": {
        "system": "Linux",
        "description": "12.3 Ensure Apache AppArmor Profile is in Enforce Mode",
        "info": "AppArmor profiles may be in one of three modes: disabled, complain or enforce. In the complain mode, any violations of the access controls are logged but the restrictions are not enforced. Also, once a profile mode has been changed, it is recommended to restart the Apache server, otherwise the currently running process may not be confined by the policy.\n\nRationale:\n\nThe complain mode is useful for testing and debugging a profile, but is not appropriate for production. Only the confined process running in enforce mode will prevent attacks that violate the configured access controls.",
        "solution": "Perform the following to implement the recommended state:\n\nSet the profile state to enforce mode.\n\n# aa-enforce apache2\nSetting /usr/sbin/apache2 to enforce mode.\n\nStop the Apache server and confirm that is it not running. In some cases, the AppArmor controls may prevent the web server from stopping properly, and it may be necessary to stop the process manually or even reboot the server.\n\n# service apache2 stop\n * Stopping web server apache2\n# service apache2 status\n * apache2 is not running\n\nRestart the Apache service.\n\n# service apache2 start\n * Starting web server apache2\n\nDefault Value:\n\nThe default mode is enforce.",
        "reference": "800-171|3.4.8,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|2.7,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/aa-unconfined --paranoid | /usr/bin/grep @APP_Binary_catalog@/apachectl",
        "expect": "@APP_Binary_catalog@/apachectl[\\\\s]*confined[\\\\s]*by[\\\\s]*'@APP_Binary_catalog@/apachectl[\\\\s]*\\\\(enforce\\\\)'",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestBody[\\\\s]*",
        "rpm": "libselinux1-0.0.0-0",
        "operator": "gt",
        "YESsystem": "Linux",
        "MEDIUMdescription": "12.1 Ensure the AppArmor Framework Is Enabled"
    },
    "custom_item_15": {
        "system": "Linux",
        "description": "6.6 Ensure ModSecurity Is Installed and Enabled",
        "info": "ModSecurity is an open source web application firewall (WAF) for real-time web application monitoring, logging, and access control. It enables but does not include a powerful customizable rule set, which may be used to detect and block common web application attacks. Installation of ModSecurity without a rule set does not provide additional security for the protected web applications. Refer to the benchmark recommendation 'Install and Enable OWASP ModSecurity Core Rule Set' for details on a recommended rule set.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstallation of the ModSecurity Apache module enables a customizable web application firewall rule set which may be configured to detect and block common attack patterns as well as block outbound data leakage.",
        "solution": "Install the ModSecurity module if it is not already installed in modules/mod_security2.so. It may be installed via OS package installation (such as apt-get or yum) or built from the source files. See https://www.modsecurity.org/download.html for details.\n\nAdd or modify the LoadModule directive if not already present in the Apache configuration as shown below. Typically, the LoadModule directive is placed in file named mod_security.conf which is included in the Apache configuration:\n\nLoadModule security2_module modules/mod_security2.so\n\nDefault Value:\n\nThe ModSecurity module is NOT loaded by default.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "@APP_Binary_catalog@/apachectl -M | /usr/bin/egrep security2_module | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "security2_module"
    },
    "custom_item_16": {
        "description": "Check if OWASP CRS 3",
        "cmd": "echo '@OWASP_CRS_DIR@'",
        "expect": "crs-3"
    },
    "custom_item_17": {
        "system": "Linux",
        "description": "6.7 Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled - Active Rules",
        "info": "The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:\n\nHTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.\n\nReal-time Blacklist Lookups - utilizes 3rd Party IP Reputation\n\nHTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.\n\nCommon Web Attacks Protection - detecting common web application security attack.\n\nAutomation Detection - detecting bots, crawlers, scanners and other surface malicious activity.\n\nIntegration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.\n\nTracking Sensitive Data - tracks credit card usage and blocks leakages.\n\nTrojan Protection - detecting access to trojan horses.\n\nIdentification of Application Defects - alerts on application misconfigurations.\n\nError Detection and Hiding - disguising error messages sent by the server.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstalling, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.",
        "solution": "Install, configure and test the OWASP ModSecurity Core Rule Set:\n\nDownload the OWASP ModSecurity CRS from the project page https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project\n\nUnbundled the archive and follow the instructions in the INSTALL file.\n\nDepending on the CRS version used, the crs-setup.conf or the modsecurity_crs_10_setup.conf file will be required, and rules in the base_rules directory are intended as a baseline useful for most applications.\n\nTest the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.\n\nIt is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.\n\nDefault Value:\n\nThe OWASP ModSecurity CRS is NOT installed or enabled by default.\n\nCRS v3.0 Default Values:\n\ninbound_anomaly_score_threshold = 5\n\noutbound_anomaly_score_threshold = 4\n\nparanoia_level = 1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.5,CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "find '@OWASP_CRS_DIR@' -name '*.conf' | xargs /usr/bin/grep '^SecRule ' | wc -l",
        "expect": "(32[5-9]|3[3-9][0-9]|[4-9][0-9][0-9])"
    },
    "custom_item_18": {
        "system": "Linux",
        "description": "6.7 Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled - Inbound Anomaly Threshold",
        "info": "The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:\n\nHTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.\n\nReal-time Blacklist Lookups - utilizes 3rd Party IP Reputation\n\nHTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.\n\nCommon Web Attacks Protection - detecting common web application security attack.\n\nAutomation Detection - detecting bots, crawlers, scanners and other surface malicious activity.\n\nIntegration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.\n\nTracking Sensitive Data - tracks credit card usage and blocks leakages.\n\nTrojan Protection - detecting access to trojan horses.\n\nIdentification of Application Defects - alerts on application misconfigurations.\n\nError Detection and Hiding - disguising error messages sent by the server.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstalling, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.",
        "solution": "Install, configure and test the OWASP ModSecurity Core Rule Set:\n\nDownload the OWASP ModSecurity CRS from the project page https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project\n\nUnbundled the archive and follow the instructions in the INSTALL file.\n\nDepending on the CRS version used, the crs-setup.conf or the modsecurity_crs_10_setup.conf file will be required, and rules in the base_rules directory are intended as a baseline useful for most applications.\n\nTest the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.\n\nIt is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.\n\nDefault Value:\n\nThe OWASP ModSecurity CRS is NOT installed or enabled by default.\n\nCRS v3.0 Default Values:\n\ninbound_anomaly_score_threshold = 5\n\noutbound_anomaly_score_threshold = 4\n\nparanoia_level = 1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.5,CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "find '@OWASP_CRS_DIR@' -name '*.conf' | xargs /usr/bin/egrep -v '^\\s*#' | /usr/bin/grep 'setvar:tx.inbound_anomaly_score_threshold'",
        "expect": "setvar:tx.inbound_anomaly_score_threshold[\\\\s]*=[\\\\s]*[2-5][^0-9]"
    },
    "custom_item_19": {
        "system": "Linux",
        "description": "6.7 Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled - Outbound Anomaly Threshold",
        "info": "The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:\n\nHTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.\n\nReal-time Blacklist Lookups - utilizes 3rd Party IP Reputation\n\nHTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.\n\nCommon Web Attacks Protection - detecting common web application security attack.\n\nAutomation Detection - detecting bots, crawlers, scanners and other surface malicious activity.\n\nIntegration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.\n\nTracking Sensitive Data - tracks credit card usage and blocks leakages.\n\nTrojan Protection - detecting access to trojan horses.\n\nIdentification of Application Defects - alerts on application misconfigurations.\n\nError Detection and Hiding - disguising error messages sent by the server.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstalling, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.",
        "solution": "Install, configure and test the OWASP ModSecurity Core Rule Set:\n\nDownload the OWASP ModSecurity CRS from the project page https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project\n\nUnbundled the archive and follow the instructions in the INSTALL file.\n\nDepending on the CRS version used, the crs-setup.conf or the modsecurity_crs_10_setup.conf file will be required, and rules in the base_rules directory are intended as a baseline useful for most applications.\n\nTest the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.\n\nIt is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.\n\nDefault Value:\n\nThe OWASP ModSecurity CRS is NOT installed or enabled by default.\n\nCRS v3.0 Default Values:\n\ninbound_anomaly_score_threshold = 5\n\noutbound_anomaly_score_threshold = 4\n\nparanoia_level = 1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.5,CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "find '@OWASP_CRS_DIR@' -name '*.conf' | xargs /usr/bin/egrep -v '^\\s*#' | /usr/bin/grep 'setvar:tx.outbound_anomaly_score_threshold'",
        "expect": "setvar:tx.outbound_anomaly_score_threshold[\\\\s]*=[\\\\s]*[2-4][^0-9]"
    },
    "custom_item_20": {
        "system": "Linux",
        "description": "6.7 Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled - Paranoia Level",
        "info": "The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:\n\nHTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.\n\nReal-time Blacklist Lookups - utilizes 3rd Party IP Reputation\n\nHTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.\n\nCommon Web Attacks Protection - detecting common web application security attack.\n\nAutomation Detection - detecting bots, crawlers, scanners and other surface malicious activity.\n\nIntegration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.\n\nTracking Sensitive Data - tracks credit card usage and blocks leakages.\n\nTrojan Protection - detecting access to trojan horses.\n\nIdentification of Application Defects - alerts on application misconfigurations.\n\nError Detection and Hiding - disguising error messages sent by the server.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstalling, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.",
        "solution": "Install, configure and test the OWASP ModSecurity Core Rule Set:\n\nDownload the OWASP ModSecurity CRS from the project page https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project\n\nUnbundled the archive and follow the instructions in the INSTALL file.\n\nDepending on the CRS version used, the crs-setup.conf or the modsecurity_crs_10_setup.conf file will be required, and rules in the base_rules directory are intended as a baseline useful for most applications.\n\nTest the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.\n\nIt is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.\n\nDefault Value:\n\nThe OWASP ModSecurity CRS is NOT installed or enabled by default.\n\nCRS v3.0 Default Values:\n\ninbound_anomaly_score_threshold = 5\n\noutbound_anomaly_score_threshold = 4\n\nparanoia_level = 1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.5,CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "find '@OWASP_CRS_DIR@' -name '*.conf' | xargs /usr/bin/egrep -v '^\\s*#' | /usr/bin/grep 'setvar:tx.paranoia_level'",
        "expect": "setvar:tx.paranoia_level[\\\\s]*=[\\\\s]*1[^0-9]"
    },
    "custom_item_21": {
        "system": "Linux",
        "description": "6.7 Ensure the OWASP ModSecurity Core Rule Set Is Installed and Enabled - Active Rules",
        "info": "The OWASP ModSecurity Core Rules Set (CRS) is a set of open source web application defensive rules for the ModSecurity web application firewall (WAF). The OWASP ModSecurity CRS provides baseline protections in the following attack/threat categories:\n\nHTTP Protection - detecting violations of the HTTP protocol and a locally defined usage policy.\n\nReal-time Blacklist Lookups - utilizes 3rd Party IP Reputation\n\nHTTP Denial of Service Protections - defense against HTTP Flooding and Slow HTTP DoS Attacks.\n\nCommon Web Attacks Protection - detecting common web application security attack.\n\nAutomation Detection - detecting bots, crawlers, scanners and other surface malicious activity.\n\nIntegration with AV Scanning for File Uploads - detects malicious files uploaded through the web application.\n\nTracking Sensitive Data - tracks credit card usage and blocks leakages.\n\nTrojan Protection - detecting access to trojan horses.\n\nIdentification of Application Defects - alerts on application misconfigurations.\n\nError Detection and Hiding - disguising error messages sent by the server.\n\nNote: Like other application security/application firewall systems, ModSecurity requires a significant commitment of staff resources for initial tuning of the rules and handling alerts. In some cases, this may require additional time working with application developers/maintainers to modify applications based on analysis of the results of tuning and monitoring logs. After setup, an ongoing commitment of staff is required for monitoring logs and ongoing tuning, especially after upgrades/patches. Without this commitment to tuning and monitoring, installing ModSecurity may NOT be effective and may provide a false sense of security.\n\nRationale:\n\nInstalling, configuring and enabling of the OWASP ModSecurity Core Rule Set (CRS), provides additional baseline security defense, and provides a good starting point to customize the monitoring and blocking of common web application attacks.",
        "solution": "Install, configure and test the OWASP ModSecurity Core Rule Set:\n\nDownload the OWASP ModSecurity CRS from the project page https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project\n\nUnbundled the archive and follow the instructions in the INSTALL file.\n\nDepending on the CRS version used, the crs-setup.conf or the modsecurity_crs_10_setup.conf file will be required, and rules in the base_rules directory are intended as a baseline useful for most applications.\n\nTest the application for correct functionality after installing the CRS. Check web server error logs and the modsec_audit.log file for blocked requests due to false positives.\n\nIt is also recommended to test the application response to malicious traffic such as an automated web application scanner to ensure the rules are active. The web server error log and modsec_audit.log files should show logs of the attacks and the servers response codes.\n\nDefault Value:\n\nThe OWASP ModSecurity CRS is NOT installed or enabled by default.\n\nCRS v3.0 Default Values:\n\ninbound_anomaly_score_threshold = 5\n\noutbound_anomaly_score_threshold = 4\n\nparanoia_level = 1",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.5,CSCv7|18.10,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "find '@OWASP_CRS_DIR@' -name 'modsecurity_crs_*.conf' | xargs /usr/bin/grep '^SecRule ' | wc -l",
        "expect": "[2-9][0-9][0-9]"
    },
    "custom_item_22": {
        "system": "Linux",
        "description": "7.10 Ensure OCSP Stapling Is Enabled - SSLUseStapling",
        "info": "The OCSP (Online Certificate Status Protocol) provides the current revocation status of an X.509 certificate and allows for a certificate authority to revoke the validity of a signed certificate before its expiration date. The URI for the OCSP server is included in the certificate and verified by the browser. The Apache SSLUseStapling directive along with the SSLStaplingCache directive are recommended to enable OCSP Stapling by the web server. If the client requests OCSP stapling, then the web server can include the OCSP server response along with the web server's X.509 certificate.\n\nRationale:\n\nThe OCSP protocol is a big improvement over CRLs (certificate revocation lists) for checking if a certificate has been revoked. There are however some minor privacy and efficiency concerns with OCSP. The fact that the browser has to check a third-party CA discloses that the browser is configured for OCSP checking. Also, the already high overhead of making an SSL connection is increased by the need for the OCSP requests and responses. The OCSP stapling improves the situation by having the SSL server 'staple' an OCSP response, signed by the OCSP server, to the certificate it presents to the client. This obviates the need for the client to ask the OCSP server for status information on the server certificate. However, the client will still need to make OCSP requests on any intermediate CA certificates that are typically used to sign the server's certificate.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the SSLUseStapling directive to have a value of on in the Apache server level configuration and every virtual host that is SSL enabled. Also ensure that SSLStaplingCache is set to one of the three cache types similar to the examples below.\n\nSSLUseStapling On\nSSLStaplingCache 'shmcb:logs/ssl_staple_cache(512000)'\n- or-\nSSLStaplingCache 'dbm:logs/ssl_staple_cache.db'\n- or -\nSSLStaplingCache  dc:UNIX:logs/ssl_staple_socket\n\nDefault Value:\n\nSSLUseStapling Off SSLStaplingCache",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*SSLUseStapling[\\\\s]+",
        "expect": "^[\\\\s]*SSLUseStapling[\\\\s]+On[\\\\s]*$"
    },
    "custom_item_23": {
        "system": "Linux",
        "description": "7.10 Ensure OCSP Stapling Is Enabled - SSLStaplingCache",
        "info": "The OCSP (Online Certificate Status Protocol) provides the current revocation status of an X.509 certificate and allows for a certificate authority to revoke the validity of a signed certificate before its expiration date. The URI for the OCSP server is included in the certificate and verified by the browser. The Apache SSLUseStapling directive along with the SSLStaplingCache directive are recommended to enable OCSP Stapling by the web server. If the client requests OCSP stapling, then the web server can include the OCSP server response along with the web server's X.509 certificate.\n\nRationale:\n\nThe OCSP protocol is a big improvement over CRLs (certificate revocation lists) for checking if a certificate has been revoked. There are however some minor privacy and efficiency concerns with OCSP. The fact that the browser has to check a third-party CA discloses that the browser is configured for OCSP checking. Also, the already high overhead of making an SSL connection is increased by the need for the OCSP requests and responses. The OCSP stapling improves the situation by having the SSL server 'staple' an OCSP response, signed by the OCSP server, to the certificate it presents to the client. This obviates the need for the client to ask the OCSP server for status information on the server certificate. However, the client will still need to make OCSP requests on any intermediate CA certificates that are typically used to sign the server's certificate.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the SSLUseStapling directive to have a value of on in the Apache server level configuration and every virtual host that is SSL enabled. Also ensure that SSLStaplingCache is set to one of the three cache types similar to the examples below.\n\nSSLUseStapling On\nSSLStaplingCache 'shmcb:logs/ssl_staple_cache(512000)'\n- or-\nSSLStaplingCache 'dbm:logs/ssl_staple_cache.db'\n- or -\nSSLStaplingCache  dc:UNIX:logs/ssl_staple_socket\n\nDefault Value:\n\nSSLUseStapling Off SSLStaplingCache",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*SSLStaplingCache[\\\\s]+",
        "expect": "^[\\\\s]*SSLStaplingCache[\\\\s]+"
    },
    "custom_item_24": {
        "system": "Linux",
        "description": "7.11 Ensure HTTP Strict Transport Security Is Enabled",
        "info": "HTTP Strict Transport Security (HSTS) is an optional web server security policy mechanism specified by an HTTP Server header. The HSTS header allows a server declaration that only HTTPS communication should be used rather than clear text HTTP communication.\n\nRationale:\n\nUsage of HTTP Strict Transport Security (HSTS) helps protect HSTS compliant browsers and other agents from HTTP downgrade attacks. Downgrade attacks include a variety of man-in-the-middle attacks which leave the web communication vulnerable to disclosure and modification by forcing the usage of HTTP rather than HTTPS communication. The sslstrip attack tool by Moxie Marlinspike released in 2009 is one such attack, which works when the server allows both HTTP and HTTPS communication. However, a man-in-the-middle HTTP-to-HTTPS proxy would be effective in cases where the server required HTTPS, but did not publish an HSTS policy to the browser. This attack would also be effective on browsers which were not compliant with HSTS. All current up-to-date browsers support HSTS.\n\nThe HSTS header specifies a length of time in seconds that the browser/user agent should access the server only using HTTPS. The header may also specify if all sub-domains should also be included in the same policy. Once a compliant browser receives the HSTS Header it will not allow access to the server via HTTP. Therefore, it is important that you ensure that there is no portion of the web site or web application that requires HTTP prior to enabling the HSTS protocol.\n\nIf all sub-domains are to be included via the includeSubDomains option, then carefully consider all various host names, web applications and third-party services used to include any DNS CNAME values that may be impacted. An overly broad includeSubDomains policy will disable access to HTTP web sites for all websites with the same domain name. Also consider that the access will be disabled for the number of seconds given in the max-age value, so in the event a mistake is made, a large value, such as a year, could create significant support issues. An optional flag of preload may be added if the web site name is to be submitted to be preloaded in Chrome, Firefox and Safari browsers. See https://hstspreload.appspot.com/ for details.",
        "solution": "Perform the following to implement the recommended state:\nAdd a Header directive as shown below in the Apache server level configuration and every virtual host that is SSL enabled. The includeSubDomains and preload flags may be included in the header, but are not required.\n\nHeader always set Strict-Transport-Security 'max-age=600; includeSubDomains; preload'\n- or -\nHeader always set Strict-Transport-Security 'max-age=600'\n\nDefault Value:\n\nThe Strict Transport Security header is not present by default.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*.+Strict-Transport-Security[\\\\s]+",
        "expect": "^[\\\\s]*Header[\\\\s]+[Aa]lways[\\\\s]+[Ss]et[\\\\s]+Strict-Transport-Security[\\\\s]+[Mm]ax-[Aa]ge=(4[8-9][0-9]|[5-9][0-9][0-9])[\\\\s]*$"
    },
    "custom_item_25": {
        "system": "Linux",
        "description": "7.12 Ensure Only Cipher Suites That Provide Forward Secrecy Are Enabled",
        "info": "In cryptography, forward secrecy (FS), which is also known as perfect forward secrecy (PFS), is a feature of specific key exchange protocols that give assurance that your session keys will not be compromised even if the private key of the server is compromised. Protocols such as RSA do not provide the forward secrecy, while the protocols ECDHE (Elliptic-Curve Diffie-Hellman Ephemeral) and the DHE (Diffie-Hellman Ephemeral) will provide forward secrecy. The ECDHE is the stronger protocol and should be preferred, while the DHE may be allowed for greater compatibility with older clients. The TLS ciphers should be configured to require either the ECDHE or the DHE ephemeral key exchange, while not allowing other cipher suites.\n\nRationale:\n\nDuring the TLS handshake, after the initial client & server Hello, there is a pre-master secret generated, which is used to generate the master secret, and in turn generates the session key. When using protocols that do not provide forward secrecy, such as RSA, the pre-master secret is encrypted by the client with the server's public key and sent over the network. However, with protocols such as ECDHE (Elliptic-Curve Diffie-Hellman Ephemeral) the pre-master secret is not sent over the wire, even in encrypted format. The key exchange arrives at the shared secret in the clear using ephemeral keys that are not stored or used again. With FS, each session has a unique key exchange, so that future sessions are protected.",
        "solution": "Perform one of the following to implement the recommended state:\n\nAdd or modify the following line in the Apache server level configuration and every virtual host that is SSL/TLS enabled:\n\nSSLCipherSuite EECDH:EDH:!NULL:!SSLv2:!RC4:!aNULL:!3DES:!IDEA\n\nThe more recent versions of openssl (such as 1.0.2 and newer) will support the usage of ECDHE as a synonym for EECDH and DHE as a synonym for EDH in the cipher specification. The usage of ECDHE and DHE are preferred so that the specification matches the expected output. So, the cipher specification could be:\n\nSSLCipherSuite ECDHE:DHE:!NULL:!SSLv2:!RC4:!aNULL:!3DES:!IDEA\n\nDefault Value:\n\nThe default value for SSLCipherSuite depends on OpenSSL library version used.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv7|18.5,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*SSLCipherSuite[\\\\s]+",
        "expect": "^[\\\\s]*SSLCipherSuite[\\\\s]+EECDH:EDH:!NULL:!SSLv2:!RC4:!aNULL:!3DES:!IDEA[\\\\s]*$"
    },
    "custom_item_26": {
        "system": "Linux",
        "description": "8.3 Ensure All Default Apache Content Is Removed - 'httpd.conf Include conf/extra/httpd-autoindex.conf does not exists'",
        "info": "In previous recommendations, we have removed default content such as the Apache manuals and default CGI programs. However, if you want to further restrict information leakage about the web server, it is important that default content such as icons are not left on the web server.\n\nRationale:\n\nTo identify the type of web servers and versions software installed it is common for attackers to scan for icons or special content specific to the server type and version. A simple request like http://example.com/icons/apache_pb2.png may tell the attacker that the server is Apache 2.4. Many icons are used primarily for auto indexing, which is also recommended to be disabled.",
        "solution": "Perform either of the following to implement the recommended state:\n\nThe default source build places the auto-index and icon configurations in the extra/httpd-autoindex.conf file, so it can be disabled by leaving the include line commented out in the main httpd.conffile as shown below.\n\n# Fancy directory listings\n#Include conf/extra/httpd-autoindex.conf\n\nAlternatively, the icon alias directive and the directory access control configuration can be commented out as shown if present:\n\n# We include the /icons/ alias for FancyIndexed directory listings. If\n# you do not use FancyIndexing, you may comment this out.\n#\n#Alias /icons/ '/var/www/icons/'\n##     Options Indexes MultiViews FollowSymLinks\n#     AllowOverride None\n#     Order allow,deny\n#     Allow from all\n#Default Value:\n\nThe default source build does not enable access to the Apache icons.",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|13.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*Include[\\\\s]+conf/extra/httpd-autoindex\\\\.conf[\\\\s]*",
        "expect": "^[\\\\s]*Include[\\\\s]+conf/extra/httpd-autoindex\\\\.conf[\\\\s]*"
    },
    "custom_item_27": {
        "system": "Linux",
        "description": "8.3 Ensure All Default Apache Content Is Removed - 'httpd.conf Alias /icons/ /var/www/icons/ does not exist'",
        "info": "In previous recommendations, we have removed default content such as the Apache manuals and default CGI programs. However, if you want to further restrict information leakage about the web server, it is important that default content such as icons are not left on the web server.\n\nRationale:\n\nTo identify the type of web servers and versions software installed it is common for attackers to scan for icons or special content specific to the server type and version. A simple request like http://example.com/icons/apache_pb2.png may tell the attacker that the server is Apache 2.4. Many icons are used primarily for auto indexing, which is also recommended to be disabled.",
        "solution": "Perform either of the following to implement the recommended state:\n\nThe default source build places the auto-index and icon configurations in the extra/httpd-autoindex.conf file, so it can be disabled by leaving the include line commented out in the main httpd.conffile as shown below.\n\n# Fancy directory listings\n#Include conf/extra/httpd-autoindex.conf\n\nAlternatively, the icon alias directive and the directory access control configuration can be commented out as shown if present:\n\n# We include the /icons/ alias for FancyIndexed directory listings. If\n# you do not use FancyIndexing, you may comment this out.\n#\n#Alias /icons/ '/var/www/icons/'\n##     Options Indexes MultiViews FollowSymLinks\n#     AllowOverride None\n#     Order allow,deny\n#     Allow from all\n#Default Value:\n\nThe default source build does not enable access to the Apache icons.",
        "reference": "800-171|3.4.9,800-171|3.13.13,800-53|CM-10,800-53|CM-11,800-53|SC-18,800-53r5|CM-10,800-53r5|CM-11,800-53r5|SC-18,CSCv7|13.2,CSCv8|9.4,CSF|DE.CM-3,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|SC-18,LEVEL|2A,NIAv2|SU3,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*Alias[\\\\s]+/icons/[\\\\s]+\"/var/www/icons/\"[\\\\s]*",
        "expect": "^[\\\\s]*Alias[\\\\s]+/icons/[\\\\s]+\"/var/www/icons/\"[\\\\s]*"
    },
    "custom_item_28": {
        "system": "Linux",
        "description": "8.4 Ensure ETag Response Header Fields Do Not Include Inodes",
        "info": "The FileETag directive configures the file attributes that are used to create the ETag (entity tag) response header field when the document is based on a static file. The ETag value is used in cache management to save network bandwidth. The value returned may be based on combinations of the file inode, the modification time, and the file size.\n\nRationale:\n\nWhen the FileETag is configured to include the file inode number, remote attackers may be able to discern the inode number from returned values. The inode is considered sensitive information, as it could be useful in assisting in other attacks.",
        "solution": "Perform the following to implement the recommended state:\nRemove all instances of the FileETag directive. Alternatively, add or modify the FileETag directive in the server and each virtual host configuration to have either the value None or MTime Size.\n\nDefault Value:\n\nThe default value is MTime Size.",
        "reference": "800-53|SI-8,800-53r5|SI-8,CSCv7|7.4,CSCv7|7.7,CSCv8|9.2,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-8,LEVEL|2A,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*FileETag[\\\\s]+.*([Aa]ll|[Ii][Nn]ode).*",
        "expect": "^[\\\\s]*FileETag[\\\\s]+.*([Aa]ll|[Ii][Nn]ode).*"
    },
    "custom_item_29": {
        "system": "Linux",
        "description": "10.1 Ensure the LimitRequestLine directive is Set to 512 or less",
        "info": "Buffer Overflow attacks attempt to exploit an application by providing more data than the application buffer can contain. If the application allows copying data to the buffer to overflow the boundaries of the buffer, then the application is vulnerable to a buffer overflow. The results of Buffer overflow vulnerabilities vary, and may result in the application crashing, or may allow the attacker to execute instructions provided in the data. The Apache LimitRequest* directives allow the Apache web server to limit the sizes of requests and request fields and can be used to help protect programs and applications processing those requests.\n\nSpecifically, the LimitRequestLine directive limits the allowed size of a client's HTTP request-line, which consists of the HTTP method, URI, and protocol version.\n\nRationale:\n\nThe limiting of the size of the request line is helpful so that the web server can prevent an unexpectedly long or large request from being passed to a potentially vulnerable CGI program, module or application that would have attempted to process the request. Of course, the underlying dependency is that we need to set the limits high enough to not interfere with any one application on the server, while setting them low enough to be of value in protecting the applications. Since the configuration directive is available only at the server configuration level, it is not possible to tune the value for different portions of the same web server. Please read the Apache documentation carefully, as these requests may interfere with the expected functionality of some web applications.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the LimitRequestline directive in the Apache configuration to have a value of 512 or shorter.\n\nLimitRequestline 512\n\nDefault Value:\n\nLimitRequestline 8190",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestLine[\\\\s]*",
        "expect": "^[\\\\s]*LimitRequestLine[\\\\s]+(51[0-2]|50[0-9]|[1-4][0-9][0-9]|[1-9][0-9]|[1-9])[\\\\s]*$"
    },
    "custom_item_30": {
        "system": "Linux",
        "description": "10.2 Ensure the LimitRequestFields Directive is Set to 100 or Less",
        "info": "The LimitRequestFields directive limits the number of fields allowed in an HTTP request.\n\nRationale:\n\nThe limiting of the number of fields is helpful so that the web server can prevent an unexpectedly high number of fields from being passed to a potentially vulnerable CGI program, module or application that would have attempted to process the request. Of course, the underlying dependency is that we need to set the limits high enough to not interfere with any one application on the server, while setting them low enough to be of value in protecting the applications. Since the configuration directives are available only at the server configuration level, it is not possible to tune the value for different portions of the same web server. Please read the Apache documentation carefully, as these requests may interfere with the expected functionality of some web applications.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the LimitRequestFields directive in the Apache configuration to have a value of 100 or less. If the directive is not present the default depends on a compile time configuration, but defaults to a value of 100.\n\nLimitRequestFields 100\n\nDefault Value:\n\nLimitRequestFields 100",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestFields[\\\\s]+",
        "expect": "^[\\\\s]*LimitRequestFields[\\\\s]+(100|[1-9][0-9]|[1-9])[\\\\s]*$"
    },
    "custom_item_31": {
        "system": "Linux",
        "description": "10.3 Ensure the LimitRequestFieldsize Directive is Set to 1024 or Less",
        "info": "The LimitRequestFieldSize limits the number of bytes that will be allowed in an HTTP request header. It is recommended that the LimitRequestFieldSize directive be set to 1024 or less.\n\nRationale:\n\nBy limiting of the size of request headers is helpful so that the web server can prevent an unexpectedly long or large value from being passed to exploit a potentially vulnerable program. Of course, the underlying dependency is that we need to set the limits high enough to not interfere with any one application on the server, while setting them low enough to be of value in protecting the applications. Since the configuration directives are available only at the server configuration level, it is not possible to tune the value for different portions of the same web server. Please read the Apache documentation carefully, as these requests may interfere with the expected functionality of some web applications.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the LimitRequestFieldsize directive in the Apache configuration to have a value of 1024 or less.\n\nLimitRequestFieldsize 1024\n\nDefault Value:\n\nLimitRequestFieldsize 8190",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestFieldSize[\\\\s]*",
        "expect": "^[\\\\s]*LimitRequestFieldSize[\\\\s]+(102[0-4]|10[0-1][0-9]|[1-9][0-9][0-9]|[1-9][0-9]|[1-9])[\\\\s]*$"
    },
    "custom_item_32": {
        "system": "Linux",
        "description": "10.4 Ensure the LimitRequestBody Directive is Set to 102400 or Less",
        "info": "The LimitRequestBody directive limits the number of bytes that are allowed in a request body. Size of requests may vary greatly; for example, during a file upload the size of the file must fit within this limit.\n\nRationale:\n\nThe limiting of the size of the request body is helpful so that the web server can prevent an unexpectedly long or large request from being passed to a potentially vulnerable program. Of course, the underlying dependency is that we need to set the limits high enough to not interfere with any one application on the server, while setting them low enough to be of value in protecting the applications. The LimitRequestBody may be configured on a per directory, or per location context. Please read the Apache documentation carefully, as these requests may interfere with the expected functionality of some web applications.",
        "solution": "Perform the following to implement the recommended state:\nAdd or modify the LimitRequestBody directive in the Apache configuration to have a value of 102400 (100K) or less. Please read the Apache documentation so that it is understood that this directive will limit the size of file up-loads to the web server.\n\nLimitRequestBody 102400\n\nDefault Value:\n\nLimitRequestBody 0 (unlimited)",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|5.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "file": "@APP_Config_files@",
        "regex": "^[\\\\s]*LimitRequestBody[\\\\s]*",
        "expect": "^[\\\\s]*LimitRequestBody[\\\\s]+(102400|102[1-3][0-9][0-9]|10[0-1][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9]|[1-9])[\\\\s]*$"
    },
    "custom_item_33": {
        "description": "Check for SELinux - RPM",
        "rpm": "libselinux-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_34": {
        "description": "Check for SELinux1 - RPM",
        "rpm": "libselinux1-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_35": {
        "description": "Check for SELinux - dpkg",
        "cmd": "dpkg -s libselinux1 2>&1",
        "expect": "^[\\\\s]*Status: install ok installed[\\\\s]*"
    },
    "custom_item_36": {
        "system": "Linux",
        "description": "11.1 Ensure SELinux Is Enabled in Enforcing Mode - current",
        "info": "SELinux (Security-Enhanced Linux) is a Linux kernel security module that provides mandatory access control security policies with type enforcement that are checked after the traditional discretionary access controls. It was created by the US National Security Agency and can enforce rules on files and processes in a Linux system, and restrict actions, based on defined policies.\n\nRationale:\n\nWeb applications and services continue to be one of the leading attack vectors for black-hat criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The SELinux mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model which only allows what is explicitly permitted.",
        "solution": "Perform the following to implement the recommended state:\nIf SELinux is not enabled in the configuration file, edit the file /etc/selinux/config and set the value of SELINUX as enforcing and reboot the system for the new configuration to be effective.\n\nSELINUX=enforcing\n\nIf the current mode is not enforcing, and an immediate reboot is not possible, the current mode can be set to enforcing with the setenable command shown below.\n\n# setenforce 1\n\nDefault Value:\n\nSELinux is not enabled by default.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53|MP-2,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.7,CSCv8|3.3,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/sestatus",
        "expect": "^[\\\\s]*Current[\\\\s]+mode[\\\\s]*:[\\\\s]*enforcing[\\\\s]*$"
    },
    "custom_item_37": {
        "system": "Linux",
        "description": "11.1 Ensure SELinux Is Enabled in Enforcing Mode - config",
        "info": "SELinux (Security-Enhanced Linux) is a Linux kernel security module that provides mandatory access control security policies with type enforcement that are checked after the traditional discretionary access controls. It was created by the US National Security Agency and can enforce rules on files and processes in a Linux system, and restrict actions, based on defined policies.\n\nRationale:\n\nWeb applications and services continue to be one of the leading attack vectors for black-hat criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The SELinux mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model which only allows what is explicitly permitted.",
        "solution": "Perform the following to implement the recommended state:\nIf SELinux is not enabled in the configuration file, edit the file /etc/selinux/config and set the value of SELINUX as enforcing and reboot the system for the new configuration to be effective.\n\nSELINUX=enforcing\n\nIf the current mode is not enforcing, and an immediate reboot is not possible, the current mode can be set to enforcing with the setenable command shown below.\n\n# setenforce 1\n\nDefault Value:\n\nSELinux is not enabled by default.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53|MP-2,800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.7,CSCv8|3.3,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/sestatus",
        "expect": "^[\\\\s]*Mode[\\\\s]+from[\\\\s]+config[\\\\s]+file[\\\\s]*:[\\\\s]*enforcing[\\\\s]*$"
    },
    "custom_item_38": {
        "description": "11.2 Ensure Apache Processes Run in the httpd_t Confined Context - apachectl",
        "info": "SELinux includes customizable targeted policies that may be used to confine the Apache httpd server to enforce least privileges so that the httpd server has only the minimal access to specified directories, files and network ports. Access is controlled by process types (domains) defined for the httpd process. There are over a hundred individual httpd related types defined in a default Apache SELinux policy which includes many of the common Apache add-ons and applications such as php, nagios, smokeping and many others. The default SELinux policies work well for a default Apache installation, but implementation of SELinux targeted polices on a complex or highly customized web server requires a rather significant development and testing effort which comprehends both the workings of SELinux and the detailed operations and requirements of the web application.\n\nAll directories and files to be accessed by the web server process must have security labels with appropriate types. The following types are a sample of the most commonly used:\n\nhttp_port_t - Network ports allowed for listening\n\nhttpd_sys_content_t - Read access to directories and files with web content\n\nhttpd_log_t - Directories and files to be used for writable log data\n\nhttpd_sys_script_exec_t - Directories and files for executable content.\n\nRationale:\n\nWith the proper implementation of SELinux, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example, a vulnerability that allows an attacker to read inappropriate system files may be prevented from execution by SELinux because the inappropriate files are not labeled as httpd_sys_content_t. Likewise writing to an unexpected directory or execution of unexpected content can be prevented by similar mandatory security labels enforced by SELinux.",
        "solution": "If the running httpd processes are not confined to the httpd_t SELinux context. Then check the context for the httpd binary and the apachectl binary and set the httpd binary to have a context of httpd_exec_t and the apachectl executable should have a context of initrc_exec_t as shown below. Also note that on some platforms such as Ubuntu, the Apache executable is named apache2 instead of httpd.\n\n# ls -alZ /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl\n-rwxr-xr-x. root root system_u:object_r:initrc_exec_t:s0 /usr/sbin/apachectl\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.worker\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.event\n\nIf the executable files are not labeled correctly, they may be relabeled with the chcon command, as shown, however the file system labeling is based on the SELinux file context polices and the file systems will on some occasions be relabeled according to the policy.\n\n# chcon -t initrc_exec_t /usr/sbin/apachectl\n# chcon -t httpd_exec_t /usr/sbin/httpd /usr/sbin/httpd.*\n\nSince the file system may be relabeled based on SELinux policy, it's best to check the SELinux policy with semanage fcontext -l option. If the policy is not present, then add the pattern to the policy using the -a option. The restorecon command shown below will restore the file context label according to the current policy, which is required if a pattern was added.\n\n# ### Check the Policy\n# semanage fcontext -l | fgrep 'apachectl'\n/usr/sbin/apachectl regular file system_u:object_r:initrc_exec_t:s0\n# semanage fcontext -l | fgrep '/usr/sbin/httpd'\n/usr/sbin/httpd regular file system_u:object_r:httpd_exec_t:s0\n/usr/sbin/httpd.worker regular file system_u:object_r:httpd_exec_t:s0\n/usr/sbin/httpd.event regular file system_u:object_r:httpd_exec_t:s0\n# ### Add to the policy, if not present\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd'\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.worker'\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.event'\n# semanage fcontext -f -- -a -t initrc_exec_t /usr/sbin/apachectl\n\n# ### Restore the file labeling accord to the SELinux policy\n# restorecon -v /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl\n\nDefault Value:\n\nSELinux is not enabled by default.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|1.7,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/bin/ls -lZ @APACHECTL_LOCATION@",
        "expect": ":initrc_exec_t:.* @APACHECTL_LOCATION@"
    },
    "custom_item_39": {
        "description": "11.2 Ensure Apache Processes Run in the httpd_t Confined Context - httpd",
        "info": "SELinux includes customizable targeted policies that may be used to confine the Apache httpd server to enforce least privileges so that the httpd server has only the minimal access to specified directories, files and network ports. Access is controlled by process types (domains) defined for the httpd process. There are over a hundred individual httpd related types defined in a default Apache SELinux policy which includes many of the common Apache add-ons and applications such as php, nagios, smokeping and many others. The default SELinux policies work well for a default Apache installation, but implementation of SELinux targeted polices on a complex or highly customized web server requires a rather significant development and testing effort which comprehends both the workings of SELinux and the detailed operations and requirements of the web application.\n\nAll directories and files to be accessed by the web server process must have security labels with appropriate types. The following types are a sample of the most commonly used:\n\nhttp_port_t - Network ports allowed for listening\n\nhttpd_sys_content_t - Read access to directories and files with web content\n\nhttpd_log_t - Directories and files to be used for writable log data\n\nhttpd_sys_script_exec_t - Directories and files for executable content.\n\nRationale:\n\nWith the proper implementation of SELinux, vulnerabilities in the web application may be prevented from being exploited due to the additional restrictions. For example, a vulnerability that allows an attacker to read inappropriate system files may be prevented from execution by SELinux because the inappropriate files are not labeled as httpd_sys_content_t. Likewise writing to an unexpected directory or execution of unexpected content can be prevented by similar mandatory security labels enforced by SELinux.",
        "solution": "If the running httpd processes are not confined to the httpd_t SELinux context. Then check the context for the httpd binary and the apachectl binary and set the httpd binary to have a context of httpd_exec_t and the apachectl executable should have a context of initrc_exec_t as shown below. Also note that on some platforms such as Ubuntu, the Apache executable is named apache2 instead of httpd.\n\n# ls -alZ /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl\n-rwxr-xr-x. root root system_u:object_r:initrc_exec_t:s0 /usr/sbin/apachectl\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.worker\n-rwxr-xr-x. root root system_u:object_r:httpd_exec_t:s0 /usr/sbin/httpd.event\n\nIf the executable files are not labeled correctly, they may be relabeled with the chcon command, as shown, however the file system labeling is based on the SELinux file context polices and the file systems will on some occasions be relabeled according to the policy.\n\n# chcon -t initrc_exec_t /usr/sbin/apachectl\n# chcon -t httpd_exec_t /usr/sbin/httpd /usr/sbin/httpd.*\n\nSince the file system may be relabeled based on SELinux policy, it's best to check the SELinux policy with semanage fcontext -l option. If the policy is not present, then add the pattern to the policy using the -a option. The restorecon command shown below will restore the file context label according to the current policy, which is required if a pattern was added.\n\n# ### Check the Policy\n# semanage fcontext -l | fgrep 'apachectl'\n/usr/sbin/apachectl regular file system_u:object_r:initrc_exec_t:s0\n# semanage fcontext -l | fgrep '/usr/sbin/httpd'\n/usr/sbin/httpd regular file system_u:object_r:httpd_exec_t:s0\n/usr/sbin/httpd.worker regular file system_u:object_r:httpd_exec_t:s0\n/usr/sbin/httpd.event regular file system_u:object_r:httpd_exec_t:s0\n# ### Add to the policy, if not present\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd'\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.worker'\n# semanage fcontext -f -- -a -t httpd_exec_t '/usr/sbin/httpd.event'\n# semanage fcontext -f -- -a -t initrc_exec_t /usr/sbin/apachectl\n\n# ### Restore the file labeling accord to the SELinux policy\n# restorecon -v /usr/sbin/httpd /usr/sbin/httpd.* /usr/sbin/apachectl\n\nDefault Value:\n\nSELinux is not enabled by default.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|1.7,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/bin/ps -eZ | /usr/bin/grep $(basename @APP_Binary_catalog@/apachectl)",
        "expect": ":httpd_t:"
    },
    "custom_item_40": {
        "system": "Linux",
        "description": "11.3 Ensure the httpd_t Type is Not in Permissive Mode",
        "info": "In addition to setting the entire SELinux configuration in permissive mode, it is possible to set individual process types (domains) such as httpd_t into a permissive mode as well. The permissive mode will not prevent any access or actions, instead, any actions that would have been denied are simply logged.\n\nRationale:\n\nUsage of the permissive mode is helpful for testing and ensuring that SELinux will not prevent access that is necessary for the proper function of a web application. However, all access is allowed in permissive mode by SELinux.",
        "solution": "Perform the following to implement the recommended state:\nIf the httpd_t type is in permissive mode; the customized permissive mode should be deleted with the following semanage command.\n\n# semanage permissive -d httpd_t\n\nDefault Value:\n\nThe httpd_t type is not in permissive mode by default.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.4.8,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|CM-7(5),800-53|CM-10,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CM-7(5),800-53r5|CM-10,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|2.7,CSCv8|2.5,CSCv8|3.3,CSF|DE.CM-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CM-7,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/semodule -l | /usr/bin/grep permissive_httpd_t | /usr/bin/awk -F: '{ print $NF } END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_41": {
        "system": "Linux",
        "description": "11.4 Ensure Only the Necessary SELinux Booleans are Enabled",
        "info": "SELinux booleans allow or disallow behavior specific to the Apache web server. Common examples include whether CGI execution is allowed, or if the httpd server is allowed to communicate with the current terminal (tty). Communication with the terminal, may be necessary for entering a passphrase during start up to decrypt a private key.\n\nRationale:\n\nEnabling only the necessary httpd related booleans provides a defense in depth approach, that will deny actions that are not in use or expected.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to implement the recommended state:\nTo disable the SELinux httpd booleans that are determined to be unnecessary, use the setsebool command as shown below with the -P option to make the change persistent.\n\n# setsebool -P httpd_enable_cgi off\n# getsebool httpd_enable_cgi\nhttpd_enable_cgi --> off\n\nDefault Value:\n\nSELinux is not enabled by default.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7,800-53|CM-7(1),800-53|CM-7(5),800-53|CM-10,800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(5),800-53r5|CM-10,800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|9.2,CSCv8|2.5,CSCv8|2.7,CSF|DE.CM-3,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2M,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/getsebool -a | /usr/bin/grep httpd_ | /usr/bin/grep '> on'",
        "expect": ""
    },
    "custom_item_42": {
        "system": "Linux",
        "description": "12.1 Ensure the AppArmor Framework Is Enabled",
        "info": "AppArmor is a Linux kernel security module that provides a named based mandatory access control with security policies. AppArmor can enforce rules on programs for file access and network connections and restrict actions based on defined policies.\n\nRationale:\n\nWeb applications and web services continue to be one of the leading attack vectors for black-hat criminals to gain access to information and servers. The threat is high because web servers are often externally accessible and typically have the greatest share of server-side vulnerabilities. The AppArmor mandatory access controls provide a much stronger security model which can be used to implement a deny-by-default model which only allows what is explicitly permitted.",
        "solution": "Perform the following to implement the recommended state:\n\nIf the aa-status command is not found, then the AppArmor package is not installed and needs to be installed using the appropriate the Linux distribution package management. For example:\n\n# apt-get install apparmor\n# apt-get install libapache2-mod-apparmor\n\nTo enable the AppArmor framework run the init.d script as shown below.\n\n# /etc/init.d/apparmor start\n\nDefault Value:\n\nAppArmor is enabled by default.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7,800-53|CM-7(1),800-53|CM-7(5),800-53|CM-10,800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-7(5),800-53r5|CM-10,800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|2.7,CSCv8|2.5,CSCv8|2.6,CSCv8|2.7,CSF|DE.CM-3,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2A,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/aa-status",
        "expect": "^[\\\\s]*apparmor[\\\\s]+module[\\\\s]+is[\\\\s]+loaded"
    },
    "custom_item_43": {
        "system": "Linux",
        "description": "12.3 Ensure Apache AppArmor Profile is in Enforce Mode",
        "info": "AppArmor profiles may be in one of three modes: disabled, complain or enforce. In the complain mode, any violations of the access controls are logged but the restrictions are not enforced. Also, once a profile mode has been changed, it is recommended to restart the Apache server, otherwise the currently running process may not be confined by the policy.\n\nRationale:\n\nThe complain mode is useful for testing and debugging a profile, but is not appropriate for production. Only the confined process running in enforce mode will prevent attacks that violate the configured access controls.",
        "solution": "Perform the following to implement the recommended state:\n\nSet the profile state to enforce mode.\n\n# aa-enforce apache2\nSetting /usr/sbin/apache2 to enforce mode.\n\nStop the Apache server and confirm that is it not running. In some cases, the AppArmor controls may prevent the web server from stopping properly, and it may be necessary to stop the process manually or even reboot the server.\n\n# service apache2 stop\n * Stopping web server apache2\n# service apache2 status\n * apache2 is not running\n\nRestart the Apache service.\n\n# service apache2 start\n * Starting web server apache2\n\nDefault Value:\n\nThe default mode is enforce.",
        "reference": "800-171|3.4.8,800-53|CM-7(5),800-53|CM-10,800-53r5|CM-7(5),800-53r5|CM-10,CSCv7|2.7,CSCv8|2.5,CSF|DE.CM-3,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,LEVEL|2A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3",
        "see_also": "https://workbench.cisecurity.org/files/4548",
        "cmd": "/usr/sbin/aa-unconfined --paranoid | /usr/bin/grep @APP_Binary_catalog@/apachectl",
        "expect": "@APP_Binary_catalog@/apachectl[\\\\s]*confined[\\\\s]*by[\\\\s]*'@APP_Binary_catalog@/apachectl[\\\\s]*\\\\(enforce\\\\)'"
    }
}