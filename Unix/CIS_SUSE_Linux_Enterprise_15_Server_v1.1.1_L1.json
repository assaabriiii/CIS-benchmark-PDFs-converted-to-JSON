{
    "custom_item_1": {
        "description": "1.1.22 Ensure sticky bit is set on all world-writable directories",
        "info": "Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.\n\nThis feature prevents the ability to delete or rename files in world writable directories (such as /tmp ) that are owned by another user.",
        "solution": "Run the following command to set the sticky bit on all world writable directories:\n\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null | xargs -I '{}' chmod a+t '{}'",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-171|3.13.1,800-171|3.13.2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|MP-2,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|MP-2,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|MP-2,ITSG-33|MP-2a.,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_world_writeable_directories",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_2": {
        "description": "6.1.10 Ensure no ungrouped files or directories exist",
        "info": "Sometimes when administrators delete users or groups from the system they neglect to remove all files owned by those users or groups.\n\nA new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
        "solution": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|13.2,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_orphan_files",
        "find_option": "nogroup",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_3": {
        "system": "Linux",
        "description": "6.1.11 Audit SUID executables",
        "info": "The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to perform functions (such as changing their password) that require root privileges.\n\nThere are valid reasons for SUID programs, but it is important to identify and review such programs to ensure they are legitimate.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Ensure that no rogue SUID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_suid_sgid_files",
        "find_option": "suid",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "6.1.12 Audit SGID executables",
        "info": "The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges.\n\nThere are valid reasons for SGID programs, but it is important to identify and review such programs to ensure they are legitimate. Review the files returned by the action in the audit section and check to see if system binaries have a different md5 checksum than what from the package. This is an indication that the binary may have been replaced.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Ensure that no rogue SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_suid_sgid_files",
        "find_option": "sgid",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_5": {
        "description": "6.1.8 Ensure no world writable files exist",
        "info": "Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.\n\nData in world-writable files can be modified and compromised by any user on the system. World writable files may also indicate an incorrectly written script or program that could potentially be the cause of a larger compromise to the system's integrity.",
        "solution": "Removing write access for the \"other\" category ( chmod o-w) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-171|3.13.1,800-171|3.13.2,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|MP-2,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|MP-2,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|MP-2,ITSG-33|MP-2a.,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.2.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.2,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS13c,NIAv2|SS15a,NIAv2|SS15c,NIAv2|SS16,NIAv2|SS29,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_world_writeable_files",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_6": {
        "description": "6.1.9 Ensure no unowned files or directories exist",
        "info": "Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.\n\nA new user who is assigned the deleted user's user ID or group ID may then end up \"owning\" these files, and thus have more access on the system than was intended.",
        "solution": "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|13.2,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "find_orphan_files",
        "find_option": "nouser",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_7": {
        "description": "6.2.13 Ensure all groups in /etc/passwd exist in /etc/group",
        "info": "Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group\n\nGroups defined in the /etc/passwd file but not in the /etc/group file pose a threat to system security since group permissions are not properly managed.",
        "solution": "Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "passwd_invalid_gid"
    },
    "custom_item_8": {
        "description": "6.2.14 Ensure no duplicate UIDs exist",
        "info": "Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.\n\nUsers must be assigned unique UIDs for accountability and to ensure appropriate access protections.",
        "solution": "Based on the results of the audit script, establish unique UIDs and review all files owned by the shared UIDs to determine which UID they are supposed to belong to.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "passwd_duplicate_uid"
    },
    "custom_item_9": {
        "description": "6.2.15 Ensure no duplicate GIDs exist",
        "info": "Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.\n\nNote: You can also use the grpck command to check for other inconsistencies in the /etc/group file.\n\nUser groups must be assigned unique GIDs for accountability and to ensure appropriate access protections.",
        "solution": "Based on the results of the audit script, establish unique GIDs and review all files owned by the shared GID to determine which group they are supposed to belong to.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "group_duplicate_gid"
    },
    "custom_item_10": {
        "description": "6.2.16 Ensure no duplicate user names exist",
        "info": "Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name.\n\nIf a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in /etc/passwd\n\nExample: If \"test4\" has a UID of 1000 and a subsequent \"test4\" entry has a UID of 2000, logging in as \"test4\" will use UID 1000. Effectively, the UID is shared, which is a security problem",
        "solution": "Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "passwd_duplicate_username"
    },
    "custom_item_11": {
        "description": "6.2.17 Ensure no duplicate group names exist",
        "info": "Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.\n\nIf a group is assigned a duplicate group name, it will create and have access to files with the first GID for that group in /etc/group Effectively, the GID is shared, which is a security problem.",
        "solution": "Based on the results of the audit script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "group_duplicate_name"
    },
    "custom_item_12": {
        "description": "6.2.3 Ensure root is the only UID 0 account",
        "info": "Any account with UID 0 has superuser privileges on the system.\n\nThis access must be limited to only the default root account and only from the system console. Administrative access must be through an unprivileged account using an approved mechanism as noted in Item 5.6 Ensure access to the su command is restricted.",
        "solution": "Remove any users other than root with UID 0 or assign them a new UID if appropriate.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "passwd_zero_uid"
    },
    "custom_item_13": {
        "description": "6.2.5 Ensure all users' home directories exist",
        "info": "Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.\n\nIf the user's home directory does not exist or is unassigned, the user will be placed in \"/\" and will not be able to write any files or have local environment variables set.",
        "solution": "If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users without an assigned home directory should be removed or assigned a home directory as appropriate.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "active_accounts_without_home_dir"
    },
    "custom_item_14": {
        "description": "6.2.6 Ensure users' home directories permissions are 750 or more restrictive",
        "info": "While the system administrator can establish secure permissions for users' home directories, the users can easily override these.\n\nGroup or world-writable user home directories may enable malicious users to steal or modify other users' data or to gain another user's system privileges.",
        "solution": "Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "accounts_bad_home_permissions",
        "mask": "0027",
        "ignore_shell": "/usr/sbin/nologin /usr/bin/false /sbin/nologin /bin/false",
        "ignore_user": "halt sync shutdown"
    },
    "custom_item_15": {
        "description": "6.2.7 Ensure users own their home directories",
        "info": "The user home directory is space defined for the particular user to set local environment variables and to store personal files.\n\nSince the user is accountable for files stored in the user home directory, the user must be the owner of the directory.",
        "solution": "Change the ownership of any home directories that are not owned by the defined user to the correct user.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "name": "accounts_bad_home_permissions",
        "mask": "0000",
        "ignore_shell": "/usr/sbin/nologin /usr/bin/false /sbin/nologin /bin/false",
        "ignore_user": "halt sync shutdown"
    },
    "custom_item_16": {
        "description": "SUSE Linux 15 is installed - VERSION",
        "file": "/etc/os-release",
        "regex": "^[\\\\s]*VERSION[\\\\s]*=",
        "expect": "^[\\\\s]*VERSION[\\\\s]*=\"[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_17": {
        "description": "SUSE Linux 15 is installed - NAME",
        "file": "/etc/os-release",
        "regex": "^[\\\\s]*NAME[\\\\s]*=",
        "expect": "^[\\\\s]*NAME[\\\\s]*=\"[\\\\s]*SLES[\\\\s]*\"$"
    },
    "custom_item_18": {
        "description": "Check GDM installed",
        "rpm": "gdm-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_19": {
        "description": "banner check",
        "file": "@BANNER_PATH@",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_20": {
        "description": "gdm - system-db:gdm",
        "file": "/etc/dconf/profile/gdm",
        "regex": "^[\\\\s]*system-db:gdm[\\\\s]*",
        "expect": "^[\\\\s]*system-db:gdm[\\\\s]*"
    },
    "custom_item_21": {
        "description": "disable-user-list",
        "file": "@LOGIN_SCREEN_PATH@",
        "regex": "^[\\\\s]*disable-user-list[\\\\s]*=",
        "expect": "^[\\\\s]*disable-user-list[\\\\s]*=[\\\\s]*true[\\\\s]*$"
    },
    "custom_item_22": {
        "description": "gdm - user-db:user",
        "file": "/etc/dconf/profile/gdm",
        "regex": "^[\\\\s]*user-db:user[\\\\s]*",
        "expect": "^[\\\\s]*user-db:user[\\\\s]*"
    },
    "custom_item_23": {
        "description": "banner-message-enable",
        "file": "@BANNER_PATH@",
        "regex": "^[\\\\s]*banner-message-enable[\\\\s]*=",
        "expect": "^[\\\\s]*banner-message-enable[\\\\s]*=[\\\\s]*true[\\\\s]*$"
    },
    "custom_item_24": {
        "description": "gdm - file-db:/usr/share/gdm/greeter-dconf-defaults",
        "file": "/etc/dconf/profile/gdm",
        "regex": "^[\\\\s]*file-db:/usr/share/gdm/greeter-dconf-defaults[\\\\s]*",
        "expect": "^[\\\\s]*file-db:/usr/share/gdm/greeter-dconf-defaults[\\\\s]*"
    },
    "custom_item_25": {
        "description": "lsmod udf",
        "cmd": "/sbin/lsmod | grep udf | /bin/awk \\'{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}\\'",
        "expect": "^pass$"
    },
    "custom_item_26": {
        "description": "modprobe udf",
        "cmd": "/sbin/modprobe -n -v udf | /bin/grep -E '(udf|install)' | /bin/awk '{print} END {if (NR == 0) print \"fail\"}'",
        "expect": "^install /bin/true$"
    },
    "custom_item_27": {
        "description": "1.1.12 Ensure noexec option set on /var/tmp partition",
        "info": "The noexec mount option specifies that the filesystem cannot contain executable binaries.\n\nSince the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp",
        "solution": "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /var/tmp :\n\n# mount -o remount,noexec /var/tmp",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|2.6,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/var/tmp[\\\\s]+",
        "expect": "noexec"
    },
    "custom_item_28": {
        "description": "1.1.13 Ensure nodev option set on /var/tmp partition",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nSince the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/tmp",
        "solution": "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /var/tmp :\n\n# mount -o remount,nodev /var/tmp",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/var/tmp[\\\\s]+",
        "expect": "nodev"
    },
    "custom_item_29": {
        "description": "1.1.14 Ensure nosuid option set on /var/tmp partition",
        "info": "The nosuid mount option specifies that the filesystem cannot contain setuid files.\n\nSince the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp",
        "solution": "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /var/tmp :\n\n# mount -o remount,nosuid /var/tmp",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/var/tmp[\\\\s]+",
        "expect": "nosuid"
    },
    "custom_item_30": {
        "description": "1.1.18 Ensure nodev option set on /home partition",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nNote: The actions in this recommendation refer to the /home partition, which is the default user partition. If you have created other user partitions, it is recommended that the Remediation and Audit steps be applied to these partitions as well.\n\nSince the user partitions are not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices.",
        "solution": "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /home partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /home/ with the nodev mount option:\n\n# mount -o remount,nodev /home",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/home[\\\\s]+",
        "expect": "nodev"
    },
    "custom_item_31": {
        "description": "1.1.19 Ensure noexec option set on removable media partitions",
        "info": "The noexec mount option specifies that the filesystem cannot contain executable binaries.\n\nSetting this option on a file system prevents users from executing programs from the removable media. This deters users from being able to introduce potentially malicious software on the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|2.6,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/mount | grep -v noexec",
        "expect": "^Manual Review Required$"
    },
    "custom_item_32": {
        "description": "check if tmp is mounted",
        "cmd": "/bin/findmnt -nk /tmp",
        "expect": "^[\\\\s]*/tmp[\\\\s]+"
    },
    "custom_item_33": {
        "description": "check if tmp.mount is enabled",
        "cmd": "/bin/systemctl is-enabled tmp.mount",
        "expect": "^(enabled|static|generated)$"
    },
    "custom_item_34": {
        "description": "1.1.20 Ensure nodev option set on removable media partitions",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nRemovable media containing character and block special devices could be used to circumvent security controls by allowing non-root users to access sensitive device files such as /dev/kmem or the raw disk partitions.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/mount | grep -v nodev",
        "expect": "^Manual Review Required$"
    },
    "custom_item_35": {
        "description": "1.1.21 Ensure nosuid option set on removable media partitions",
        "info": "The nosuid mount option specifies that the filesystem cannot contain setuid files.\n\nSetting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/mount | grep -v nosuid",
        "expect": "^Manual Review Required$"
    },
    "custom_item_36": {
        "description": "1.1.23 Disable Automounting",
        "info": "autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives.\n\nNotes:\n\n -\n\nAdditional methods of disabling a service exist. Consult your distribution documentation for appropriate methods.\n\n -\n\nThis control should align with the tolerance of the use of portable drives and optical media in the organization.\n\n -\n\nOn a server requiring an admin to manually mount media can be part of defense-in-depth to reduce the risk of unapproved software or information being introduced or proprietary software or information being exfiltrated.\n\n -\n\nIf admins commonly use flash drives and Server access has sufficient physical controls, requiring manual mounting may not increase security.\n\nWith automounting enabled anyone with physical access could attach a USB drive or disc and have its contents available in system even if they lacked permissions to mount it themselves.",
        "solution": "Run the following command to mask autofs :\n\n# systemctl --now mask autofs\n\nImpact:\n\nThe use of portable hard drives is very common for workstation users. If your organization allows the use of portable storage or media on workstations and physical access controls to workstations is considered adequate there is little value add in turning off automounting.",
        "reference": "800-171|3.8.7,800-53|MP-7,800-53r5|MP-7,CN-L3|8.5.4.1(c),CSCv7|8.4,CSCv7|8.5,CSCv8|10.3,CSF|PR.PT-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,LEVEL|1A,NESA|T1.4.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/systemctl is-enabled autofs",
        "expect": "(disabled|masked|Failed to get unit file state for autofs.service)"
    },
    "custom_item_37": {
        "description": "1.1.3 Ensure noexec option set on /tmp partition",
        "info": "The noexec mount option specifies that the filesystem cannot contain executable binaries.\n\nSince the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /tmp",
        "solution": "Edit the /etc/fstab file OR the /etc/systemd/system/local-fs.target.wants/tmp.mount file:\n\nIF /etc/fstab is used to mount /tmp\n\nEdit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /tmp :\n\n# mount -o remount,noexec /tmp\n\nOR\n\nIf an explicit systemd target is used to mount /tmp :\n\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to add noexec to the /tmp mount options:\n\n[Mount]\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\n\nRun the following command to restart the systemd daemon:\n\n# systemctl daemon-reload\n\nRun the following command to restart tmp.mount\n\n# systemctl restart tmp.mount",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|2.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/tmp[\\\\s]+",
        "expect": "noexec"
    },
    "custom_item_38": {
        "description": "1.1.4 Ensure nodev option set on /tmp partition",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nSince the /tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /tmp",
        "solution": "Edit the /etc/fstab file OR the /etc/systemd/system/local-fs.target.wants/tmp.mount file:\n\nIF /etc/fstab is used to mount /tmp :\n\nEdit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /tmp :\n\n# mount -o remount,nodev /tmp\n\nOR\n\nIf an explicit systemd target is used to mount /tmp :\n\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nodev to the /tmp mount options:\n\n[Mount]\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\n\nRun the following command to restart the systemd daemon:\n\n# systemctl daemon-reload\n\nRun the following command to restart tmp.mount\n\n# systemctl restart tmp.mount",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/tmp[\\\\s]+",
        "expect": "nodev"
    },
    "custom_item_39": {
        "description": "1.1.5 Ensure nosuid option set on /tmp partition",
        "info": "The nosuid mount option specifies that the filesystem cannot contain setuid files.\n\nSince the /tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /tmp",
        "solution": "IF /etc/fstab is used to mount /tmp\n\nEdit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /tmp :\n\n# mount -o remount,nosuid /tmp\n\nOR\n\nIf an explicit systemd target is used to mount /tmp :\n\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nosuid to the /tmp mount options:\n\n[Mount]\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\n\nRun the following command to restart the systemd daemon:\n\n# systemctl daemon-reload\n\nRun the following command to restart tmp.mount :\n\n# systemctl restart tmp.mount",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/tmp[\\\\s]+",
        "expect": "nosuid"
    },
    "custom_item_40": {
        "description": "1.1.6 Ensure /dev/shm is configured",
        "info": "/dev/shm is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access. If /dev/shm is not configured, tmpfs will be mounted to /dev/shm by systemd.\n\nNotes:\n\n -\n\nAn entry for /dev/shm in /etc/fstab will take precedence.\n\n -\n\ntmpfs can be resized using the size={size} parameter in /etc/fstab If we don't specify the size, it will be half the RAM.\n\nResize tmpfs example:\n\ntmpfs /dev/shm tmpfs defaults,noexec,nodev,nosuid,size=2G 0 0\n\nAny user can upload and execute files inside the /dev/shm similar to the /tmp partition. Configuring /dev/shm allows an administrator to set the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.",
        "solution": "Edit /etc/fstab and add or edit the following line:\n\ntmpfs /dev/shm tmpfs defaults,noexec,nodev,nosuid 0 0\n\nRun the following command to remount /dev/shm :\n\n# mount -o remount,noexec,nodev,nosuid /dev/shm",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/dev/shm[\\\\s]+",
        "expect": "[\\\\s]+/dev/shm[\\\\s]+"
    },
    "custom_item_41": {
        "description": "1.1.7 Ensure noexec option set on /dev/shm partition",
        "info": "The noexec mount option specifies that the filesystem cannot contain executable binaries.\n\nNote: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added to /etc/fstab to add mount options even though it is already being mounted on boot.\n\nSetting this option on a file system prevents users from executing programs from shared memory. This deters users from introducing potentially malicious software on the system.",
        "solution": "Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /dev/shm :\n\n# mount -o remount,noexec,nodev,nosuid /dev/shm",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|2.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/dev/shm[\\\\s]+",
        "expect": "noexec"
    },
    "custom_item_42": {
        "description": "1.1.8 Ensure nodev option set on /dev/shm partition",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nNote: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added to /etc/fstab to add mount options even though it is already being mounted on boot.\n\nSince the /dev/shm filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create special devices in /dev/shm partitions.",
        "solution": "Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /dev/shm :\n\n# mount -o remount,noexec,nodev,nosuid /dev/shm",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/dev/shm[\\\\s]+",
        "expect": "nodev"
    },
    "custom_item_43": {
        "description": "1.1.9 Ensure nosuid option set on /dev/shm partition",
        "info": "The nosuid mount option specifies that the filesystem cannot contain setuid files.\n\nNote: /dev/shm is mounted automatically by systemd. /dev/shm needs to be added to /etc/fstab to add mount options even though it is already being mounted on boot.\n\nSetting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them.",
        "solution": "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.\n\nRun the following command to remount /dev/shm :\n\n# mount -o remount,noexec,nodev,nosuid /dev/shm",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/proc/self/mountinfo",
        "regex": "[\\\\s]+/dev/shm[\\\\s]+",
        "expect": "nosuid"
    },
    "custom_item_44": {
        "description": "1.2.1 Ensure GPG keys are configured",
        "info": "Most packages managers implement GPG key signing to verify package integrity during installation.\n\nIt is important to ensure that updates are obtained from a valid source to protect against spoofing that could lead to the inadvertent installation of malware on the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update your package manager GPG keys in accordance with site policy.",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/rpm -q --queryformat \"%{SUMMARY}\\\\n\" gpg-pubkey",
        "expect": "^Manual Review Required$"
    },
    "custom_item_45": {
        "description": "1.2.2 Ensure package manager repositories are configured",
        "info": "Systems need to have package manager repositories configured to ensure they receive the latest patches and updates.\n\nIf a system's package repositories are misconfigured important patches may not be identified or a rogue repository could introduce compromised software.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure your package manager repositories according to site policy.",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/zypper repos",
        "expect": "^Manual Review Required$"
    },
    "custom_item_46": {
        "description": "*.repo gpgcheck",
        "cmd": "/bin/awk -v 'RS=[' -F '\\\\n' '/\\\\n\\\\s*enabled\\\\s*=\\\\s*1(\\\\W.*)?$/ && ! /\\\\n\\\\s*gpgcheck\\\\s*=\\\\s*1(\\\\W.*)?$/ { t=substr($1, 1, index($1, \"]\")-1); print t, \"does not have gpgcheck enabled.\" }' /etc/zypp/repos.d/*.repo | /bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "^pass$"
    },
    "custom_item_47": {
        "description": "zypp.conf gpgcheck",
        "file": "/etc/zypp/zypp.conf",
        "regex": "^[\\\\s]*gpgcheck[\\\\s]*=",
        "expect": "^[\\\\s]*gpgcheck[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_48": {
        "description": "1.3.1 Ensure sudo is installed",
        "info": "sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy. The invoking user's real (not effective) user ID is used to determine the user name with which to query the security policy.\n\nsudo supports a plugin architecture for security policies and input/output logging. Third parties can develop and distribute their own policy and I/O logging plugins to work seamlessly with the sudo front end. The default security policy is sudoers, which is configured via the file /etc/sudoers.\n\nThe security policy determines what privileges, if any, a user has to run sudo. The policy may require that users authenticate themselves with a password or another authentication mechanism. If authentication is required, sudo will exit if the user's password is not entered within a configurable time limit. This limit is policy-specific.",
        "solution": "Run the following command to install sudo.\n\n# zypper install sudo",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "sudo-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_49": {
        "description": "1.3.2 Ensure sudo commands use pty",
        "info": "sudo can be configured to run only from a pseudo-pty\n\nNote: visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the sudoers file against multiple simultaneous edits, provides basic sanity checks, and checks for parse errors. If the sudoers file is currently being edited you will receive a message to try again later. The -f option allows you to tell visudo which file to edit.\n\nAttackers can run a malicious program using sudo, which would again fork a background process that remains even when the main program has finished executing.\n\nThis can be mitigated by configuring sudo to run other commands only from a pseudo-pty, whether I/O logging is turned on or not.",
        "solution": "Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo or visudo -fand add the following line:\n\nDefaults use_pty",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/grep -Ei '^\\\\s*Defaults\\\\s+([^#]\\\\S+,\\\\s*)?use_pty\\\\b' /etc/sudoers /etc/sudoers.d/* | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_50": {
        "description": "1.3.3 Ensure sudo log file exists",
        "info": "sudo can use a custom log file\n\nNote: visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the sudoers file against multiple simultaneous edits, provides basic sanity checks, and checks for parse errors. If the sudoers file is currently being edited you will receive a message to try again later. The -f option allows you to tell visudo which file to edit.\n\nA sudo log file simplifies auditing of sudo commands",
        "solution": "edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo or visudo -fand add the following line:\n\nDefaults logfile=\"\"\n\nExample\n\nDefaults logfile=\"/var/log/sudo.log\"\n\nImpact:\n\nEditing the sudo configuration incorrectly can cause sudo to stop functioning",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/grep -Ei '^\\\\s*Defaults\\\\s+([^#;]+,\\\\s*)?logfile\\\\s*=\\\\s*(\")?[^#;]+(\")?' /etc/sudoers /etc/sudoers.d/* | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_51": {
        "description": "1.4.1 Ensure AIDE is installed",
        "info": "AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.\n\nNote: The prelinking feature can interfere with AIDE because it alters binaries to speed up their start up times. Run prelink -ua to restore the binaries to their prelinked state, thus avoiding false positives from AIDE.\n\nBy monitoring the filesystem state compromised files can be detected to prevent or limit the exposure of accidental or malicious misconfigurations or modified binaries.",
        "solution": "Configure AIDE as appropriate for your environment. Consult the AIDE documentation for options.\n\nRun the following command to install AIDE:\n\n# zypper install aide\n\nRun the following commands to initialize AIDE:\n\n# aide --init\n\n# mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db",
        "reference": "800-171|3.1.7,800-171|3.3.1,800-171|3.3.2,800-53|AC-6(9),800-53|AU-2,800-53|AU-12,800-53r5|AC-6(9),800-53r5|AU-2,800-53r5|AU-12,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.3(a),CN-L3|8.1.10.6(a),CSCv7|14.9,CSCv8|3.14,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.3,ITSG-33|AC-6,ITSG-33|AU-2,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "aide-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_52": {
        "description": "crontab aide check",
        "cmd": "/usr/bin/crontab -u root -l | grep aide",
        "expect": "^((\\\\d{1,2}|\\\\*)[\\\\s]+){5}\\\\/usr\\\\/bin\\\\/aide[\\\\s]+.*--check"
    },
    "custom_item_53": {
        "description": "/etc/cron.* /etc/crontab aide check",
        "cmd": "/bin/grep -r aide /etc/cron.* /etc/crontab",
        "expect": "^.*:((\\\\d{1,2}|\\\\*)[\\\\s]+){5}(root)?[\\\\s]*\\\\/usr\\\\/bin\\\\/aide[\\\\s]+.*--check"
    },
    "custom_item_54": {
        "description": "systemctl is-enabled aidecheck.timer",
        "cmd": "/usr/bin/systemctl is-enabled aidecheck.timer | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^enabled$"
    },
    "custom_item_55": {
        "description": "systemctl status aidecheck.timer",
        "cmd": "/usr/bin/systemctl status aidecheck.timer | /usr/bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^[\\\\s]*Active:[\\\\s]*active[\\\\s]*\\\\((running|waiting)\\\\).*$"
    },
    "custom_item_56": {
        "description": "systemctl is-enabled aidecheck.service",
        "cmd": "/usr/bin/systemctl is-enabled aidecheck.service | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^enabled$"
    },
    "custom_item_57": {
        "description": "grub.cfg superusers",
        "file": "/boot/grub2/grub.cfg",
        "regex": "^[\\\\s]*set[\\\\s]*superusers[\\\\s]*=",
        "expect": "^[\\\\s]*set[\\\\s]*superusers[\\\\s]*=\".+\"*$"
    },
    "custom_item_58": {
        "description": "grub.cfg password_pbkdf2",
        "cmd": "/bin/awk -F. '/^\\\\s*password_pbkdf2\\\\s+/ {print $1\".\"$2\".\"$3}' /boot/grub2/grub.cfg",
        "expect": "^[\\\\s]*password_pbkdf2[\\\\s]+"
    },
    "custom_item_59": {
        "description": "1.5.2 Ensure permissions on bootloader config are configured",
        "info": "The grub configuration file contains information on boot settings and passwords for unlocking boot options. The grub2 configuration is usually grub.cfg stored in /boot/grub2/\n\nNotes:\n\n -\n\nThis recommendation is designed around the grub2 bootloader.\n\n -\n\nIf LILO or another bootloader is in use in your environment:\n\n -\n\nEnact equivalent settings\n\n -\n\nReplace /boot/grub2/grub.cfg and /boot/grub2/user.cfg with the appropriate boot configuration files for your environment\n\nSetting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.",
        "solution": "Run the following commands to set ownership and permissions on your grub configuration:\n\n# chown root:root /boot/grub2/grub.cfg\n\n# chmod og-rwx /boot/grub2/grub.cfg",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/boot/grub2/grub.cfg",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_60": {
        "description": "systemd-sulogin-shell rescue",
        "file": "/usr/lib/systemd/system/rescue.service",
        "regex": "^ExecStart=-/usr/lib/systemd/systemd-sulogin-shell rescue",
        "expect": "^ExecStart=-/usr/lib/systemd/systemd-sulogin-shell rescue"
    },
    "custom_item_61": {
        "description": "systemd-sulogin-shell emergency",
        "file": "/usr/lib/systemd/system/emergency.service",
        "regex": "^ExecStart=-/usr/lib/systemd/systemd-sulogin-shell emergency",
        "expect": "^ExecStart=-/usr/lib/systemd/systemd-sulogin-shell emergency"
    },
    "custom_item_62": {
        "description": "limits.conf limits.d hard core",
        "cmd": "/bin/grep -E '^\\\\s*\\\\*\\\\s+hard\\\\s+core\\\\s+0\\\\s*$' /etc/security/limits.conf /etc/security/limits.d/* | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_63": {
        "description": "sysctl.conf sysctl.d fs.suid_dumpable",
        "cmd": "/bin/grep -E '^\\\\s*fs\\\\.suid_dumpable\\\\s*=\\\\s*0\\\\s*$' /etc/sysctl.conf /etc/sysctl.d/* | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_64": {
        "description": "sysctl - fs.suid_dumpable",
        "cmd": "/sbin/sysctl fs.suid_dumpable",
        "expect": "^[\\\\s]*fs\\\\.suid_dumpable[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_65": {
        "description": "journalctl protection active",
        "cmd": "/usr/bin/journalctl | /bin/grep 'protection:\\\\s*active'",
        "expect": "NX[\\\\s]+\\\\(Execute[\\\\s]+Disable\\\\)[\\\\s]+protection:[\\\\s]+active"
    },
    "custom_item_66": {
        "description": "NX Protection is active",
        "cmd": "if [[ -n $(/bin/grep -E 'noexec[0-9]*=off' /proc/cmdline) || -z $(/bin/grep -E -i ' (pae|nx)' /proc/cpuinfo) || -n $(/bin/grep -E '\\\\sNX\\\\s.*\\\\sprotection:\\\\s' /var/log/dmesg 2>&1 | /bin/grep -v active) ]]; then echo \"NX Protection is not active\"; else echo \"NX Protection is active\";fi",
        "expect": "^NX Protection is active$"
    },
    "custom_item_67": {
        "system": "Linux",
        "description": "1.6.3 Ensure address space layout randomization (ASLR) is enabled",
        "info": "Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.\n\nRandomly placing virtual memory regions will make it difficult to write memory page exploits as the memory placement will be consistently shifting.",
        "solution": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file:\n\nkernel.randomize_va_space = 2\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w kernel.randomize_va_space=2",
        "reference": "800-53|SI-16,800-53r5|SI-16,CSCv7|8.3,CSCv8|10.5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-16,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/sbin/sysctl kernel.randomize_va_space",
        "expect": "^[\\\\s]*kernel\\\\.randomize_va_space[\\\\s]*=[\\\\s]*2$"
    },
    "custom_item_68": {
        "description": "1.6.4 Ensure prelink is disabled",
        "info": "prelink is a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases.\n\nThe prelinking feature can interfere with the operation of AIDE, because it changes binaries. Prelinking can also increase the vulnerability of the system if a malicious user is able to compromise a common library such as libc.",
        "solution": "Run the following command to restore binaries to normal:\n\n# prelink -ua\n\nRun the following command to uninstall prelink :\n\n# zypper remove prelink",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|14.9,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "prelink-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_69": {
        "description": "rpm check apparmor-utils",
        "rpm": "apparmor-utils-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_70": {
        "description": "rpm check apparmor-parser",
        "rpm": "apparmor-parser-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_71": {
        "description": "rpm check apparmor-profiles",
        "rpm": "apparmor-profiles-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_72": {
        "description": "rpm check libapparmor1",
        "rpm": "libapparmor1-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_73": {
        "description": "rpm check apparmor-docs",
        "rpm": "apparmor-docs-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_74": {
        "description": "grub.cfg - apparmor",
        "file": "/boot/grub2/grub.cfg",
        "regex": "^[\\\\s]*linux.*",
        "expect": "(?i)[\\\\s]*apparmor[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_75": {
        "description": "grub.cfg - security",
        "file": "/boot/grub2/grub.cfg",
        "regex": "^[\\\\s]*linux.*",
        "expect": "(?i)[\\\\s]*security[\\\\s]*=[\\\\s]*apparmor"
    },
    "custom_item_76": {
        "description": "apparmor_status - processes are unconfined",
        "cmd": "/usr/sbin/apparmor_status",
        "expect": "^[\\\\s]*0[\\\\s]+processes[\\\\s]+are[\\\\s]+unconfined"
    },
    "custom_item_77": {
        "description": "apparmor_status - profiles are loaded",
        "cmd": "/usr/sbin/apparmor_status",
        "expect": "^[\\\\s]*[1-9][0-9]*[\\\\s]+profiles[\\\\s]+are[\\\\s]+loaded"
    },
    "custom_item_78": {
        "description": "/etc/motd exist",
        "file": "/etc/motd"
    },
    "custom_item_79": {
        "description": "mrsv not included in /etc/motd",
        "file": "/etc/motd",
        "regex": "\\\\\\\\[mrsv]",
        "expect": "\\\\\\\\[mrsv]"
    },
    "custom_item_80": {
        "description": "banner text",
        "file": "/etc/motd",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_81": {
        "system": "Linux",
        "description": "issue OS string",
        "cmd": "RELEASE=$(/bin/grep '^ID=' /etc/os-release | /usr/bin/cut -d= -f2 | /bin/sed -e 's/\"//g'); ISSUE=$(/bin/grep -E -i \"$RELEASE\" /etc/issue ); /bin/awk -v i=\"$ISSUE\" -v r=\"$RELEASE\" 'BEGIN { if ( tolower(i) ~ tolower(r) ) { print \"FAIL - OS String found\"; } else { print \"PASS - no OS String found\"; } }'",
        "expect": "^[\\\\s]*PASS - no OS String found$"
    },
    "custom_item_82": {
        "description": "mrsv not included in /etc/issue",
        "file": "/etc/issue",
        "regex": "\\\\\\\\[mrsv]",
        "expect": "\\\\\\\\[mrsv]"
    },
    "custom_item_83": {
        "description": "/etc/issue - banner text",
        "file": "/etc/issue",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_84": {
        "description": "mrsv not included in /etc/issue.net",
        "file": "/etc/issue.net",
        "regex": "\\\\\\\\[mrsv]",
        "expect": "\\\\\\\\[mrsv]"
    },
    "custom_item_85": {
        "system": "Linux",
        "description": "issue.net OS string",
        "cmd": "RELEASE=$(/bin/grep '^ID=' /etc/os-release | /usr/bin/cut -d= -f2 | /bin/sed -e 's/\"//g'); ISSUE=$(/bin/grep -E -i \"$RELEASE\" /etc/issue.net ); /bin/awk -v i=\"$ISSUE\" -v r=\"$RELEASE\" 'BEGIN { if ( tolower(i) ~ tolower(r) ) { print \"FAIL - OS String found\"; } else { print \"PASS - no OS String found\"; } }'",
        "expect": "^[\\\\s]*PASS - no OS String found$"
    },
    "custom_item_86": {
        "description": "banner text",
        "file": "/etc/issue.net",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_87": {
        "description": "1.8.1.4 Ensure permissions on /etc/motd are configured",
        "info": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\n\nIf the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.",
        "solution": "Run the following commands to set permissions on /etc/motd :\n\n# chown root:root /etc/motd\n\n# chmod u-x,go-wx /etc/motd",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/motd",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_88": {
        "description": "1.8.1.5 Ensure permissions on /etc/issue are configured",
        "info": "The contents of the /etc/issue file are displayed to users prior to login for local terminals.\n\nIf the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.",
        "solution": "Run the following commands to set permissions on /etc/issue :\n\n# chown root:root /etc/issue\n\n# chmod u-x,go-wx /etc/issue",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/issue",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_89": {
        "description": "1.8.1.6 Ensure permissions on /etc/issue.net are configured",
        "info": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.\n\nIf the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.",
        "solution": "Run the following commands to set permissions on /etc/issue.net :\n\n# chown root:root /etc/issue.net\n\n# chmod u-x,go-wx /etc/issue.net",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/issue.net",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_90": {
        "description": "1.9 Ensure updates, patches, and additional security software are installed",
        "info": "Periodically patches are released for included software either due to security flaws or to include additional functionality.\n\nNote: Site policy may mandate a testing period before install onto production systems for available updates.\n\nNewer patches may contain security enhancements that would not be available through the latest full update. As a result, it is recommended that the latest software patches be used to take advantage of the latest functionality. As with any software installation, organizations need to determine if a given update meets their requirements and verify the compatibility and supportability of any additional software against the update revision that is selected.",
        "solution": "Use your package manager to update all packages on the system according to site policy. The following command will install all available updates:\n\n# zypper update",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-171|3.14.1,800-53|RA-5,800-53|SI-2,800-53|SI-2(2),800-53r5|RA-5,800-53r5|SI-2,800-53r5|SI-2(2),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv7|3.4,CSCv7|3.5,CSCv8|7.3,CSCv8|7.4,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,ITSG-33|SI-2,ITSG-33|SI-2(2),LEVEL|1M,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|PR9,PCI-DSSv3.2.1|6.1,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,PCI-DSSv4.0|6.3.3,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/zypper list-updates",
        "expect": "^No updates found"
    },
    "custom_item_91": {
        "description": "2.1.1 Ensure xinetd is not installed",
        "info": "The eXtended InterNET Daemon ( xinetd ) is an open source super daemon that replaced the original inetd daemon. The xinetd daemon listens for well known services and dispatches the appropriate daemon to properly respond to service requests.\n\nIf there are no xinetd services required, it is recommended that the package be removed to reduce the attack surface are of the system.\n\nNote: If an xinetd service or services are required, ensure that any xinetd service not required is stopped and disabled",
        "solution": "Run the following command to remove xinetd :\n\n# zypper remove xinetd",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "xinetd-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_92": {
        "description": "2.2.10 Ensure FTP Server is not installed",
        "info": "FTP (File Transfer Protocol) is a traditional and widely used standard tool for transferring files between a server and clients over a network, especially where no authentication is necessary (permits anonymous users to connect to a server).\n\nFTP does not protect the confidentiality of data or authentication credentials. It is recommended SFTP be used if file transfer is required. Unless there is a need to run the system as a FTP server (for example, to allow anonymous downloads), it is recommended that the package be removed to reduce the potential attack surface.\n\nNote: Additional FTP servers also exist and should be removed if not required.",
        "solution": "Run the following command to remove vsftpd :\n\n# zypper remove vsftpd",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "vsftpd-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_93": {
        "description": "systemctl is-enabled systemd-timesyncd.service",
        "cmd": "/bin/systemctl is-enabled systemd-timesyncd.service",
        "expect": "^enabled$"
    },
    "custom_item_94": {
        "description": "rpm check chrony",
        "rpm": "chrony-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_95": {
        "description": "2.2.11 Ensure HTTP server is not installed",
        "info": "HTTP or web servers provide the ability to host web site content.\n\nUnless there is a need to run the system as a web server, it is recommended that the package be removed to reduce the potential attack surface.\n\nNotes:\n\n -\n\nSeveral http servers exist. apache apache2 lighttpd and nginx are example packages that provide an HTTP server\n\n -\n\nThese and other packages should also be audited, and removed if not required",
        "solution": "Run the following command to remove apache2 :\n\n# zypper remove apache2",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "apache2-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_96": {
        "description": "systemctl is-enabled systemd-timesyncd.service",
        "cmd": "/bin/systemctl is-enabled systemd-timesyncd.service",
        "expect": "enabled"
    },
    "custom_item_97": {
        "description": "2.2.1.2 Ensure systemd-timesyncd is configured",
        "info": "systemd-timesyncd is a daemon that has been added for synchronizing the system clock across the network.\n\nThe systemd-timesyncd daemon:\n\n - Implements an SNTP client.\n - Only implements a client side\n - Does not bother with the full NTP complexity\n - Only on querys time from one remote server, synchronizing the local clock to it\n\n - runs with minimal privileges\n - saves the current clock to disk every time a new NTP sync has been acquired\n - Uses this to correct the system clock early at bootup\n - to make sure that time monotonically progresses on these systems, even if it is not always correct\n\n - Requires a new system user and group \"systemd-timesync\" to be created on installation of systemd\n - Hooked up with networkd to only operate when network connectivity is available\n\nNotes:\n\n -\n\nThe systemd-timesyncd service specifically implements only SNTP. This minimalistic service will set the system clock for large offsets or slowly adjust it for smaller deltas. More complex use cases are not covered by systemd-timesyncd.\n\n -\n\nThis recommendation only applies if timesyncd is in use on the system\n\nProper configuration is vital to ensuring time synchronization is working properly.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Edit the file /etc/systemd/timesyncd.conf and add/modify the following lines:\n\nNTP=0.suse.pool.ntp.org 1.suse.pool.ntp.org #Servers listed should be In Accordance With Local Policy\n\nFallbackNTP=2.suse.pool.ntp.org 3.suse.pool.ntp.org #Servers listed should be In Accordance With Local Policy\n\nRootDistanceMax=1 #should be In Accordance With Local Policy\n\nRun the following commands to enable and start systemd-timesyncd :\n\n# systemctl --now enable systemd-timesyncd.service\n\n# timedatectl set-ntp true",
        "reference": "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|1M,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/timedatectl status",
        "expect": "^Manual Review Required$"
    },
    "custom_item_98": {
        "description": "2.2.12 Ensure IMAP and POP3 server is not installed",
        "info": "dovecot is an open source IMAP and POP3 server for Linux based systems.\n\nUnless POP3 and/or IMAP servers are to be provided by this system, it is recommended that the package be removed to reduce the potential attack surface.\n\nNotes:\n\n -\n\nSeveral IMAP/POP3 servers exist and can use other service names. courier-imap and cyrus-imap are example services that provide a mail server.\n\n -\n\nThese and other services should also be audited and the packages removed if not required.",
        "solution": "Run the following command to remove dovecot :\n\n# zypper remove dovecot",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "dovecot-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_99": {
        "description": "chronyd options",
        "file": "/etc/sysconfig/chronyd",
        "regex": "^[\\\\s]*OPTIONS[\\\\s]*=",
        "expect": "^[\\\\s]*OPTIONS[\\\\s]*=[\\\\s]*\"([^\"#]*\\\\s+)*-u\\\\schrony\\\\b[^\"#]*\"\\\\s*(?:#.*)?$"
    },
    "custom_item_100": {
        "description": "chrony.conf - server/pool",
        "file": "/etc/chrony.conf",
        "regex": "^[\\\\s]*(server|pool)[\\\\s]+@NTP_SERVER@",
        "expect": "^[\\\\s]*(server|pool)[\\\\s]+@NTP_SERVER@"
    },
    "custom_item_101": {
        "description": "2.2.13 Ensure Samba is not installed",
        "info": "The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Server Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.\n\nIf there is no need to mount directories and file systems to Windows systems, then this package can be removed to reduce the potential attack surface.",
        "solution": "Run the following command to remove samba :\n\n# zypper remove samba",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "samba-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_102": {
        "description": "2.2.14 Ensure HTTP Proxy Server is not installed",
        "info": "Squid is a standard proxy server used in many distributions and environments.\n\nUnless a system is specifically set up to act as a proxy server, it is recommended that the squid package be removed to reduce the potential attack surface.\n\nNote: Several HTTP proxy servers exist. These should be checked and removed unless required.",
        "solution": "Run the following command to remove the squid package:\n\n# zypper remove squid",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "squid-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_103": {
        "description": "rpm check net-snmp",
        "rpm": "net-snmp-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_104": {
        "description": "check /etc/snmp/snmpd.conf for group v1",
        "file": "/etc/snmp/snmpd.conf",
        "regex": "^[\\\\s]*group.*v1",
        "expect": "^[\\\\s]*group.*v1"
    },
    "custom_item_105": {
        "description": "check /etc/snmp/snmpd.conf for user authpriv",
        "file": "/etc/snmp/snmpd.conf",
        "regex": "^[\\\\s]*r[ow]user",
        "expect": "^[\\\\s]*r[ow]user.*authPriv"
    },
    "custom_item_106": {
        "description": "check /etc/snmp/snmpd.conf for com2sec",
        "file": "/etc/snmp/snmpd.conf",
        "regex": "^[\\\\s]*com2sec",
        "expect": "^[\\\\s]*com2sec.*(public|private)"
    },
    "custom_item_107": {
        "description": "check /etc/snmp/snmpd.conf for community",
        "file": "/etc/snmp/snmpd.conf",
        "regex": "^[\\\\s]*r[ow]community",
        "expect": "^[\\\\s]*r[ow]community (public|private)"
    },
    "custom_item_108": {
        "description": "2.2.16 Ensure mail transfer agent is configured for local-only mode",
        "info": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.\n\nThe software for all Mail Transfer Agents is complex and most have a long history of security issues. While it is important to ensure that the system can process local mail messages, it is not necessary to have the MTA's daemon listening on a port unless the server is intended to be a mail server that receives and processes mail from other systems.\n\nNotes:\n\n -\n\nThis recommendation is designed around the postfix mail server.\n\n -\n\nDepending on your environment you may have an alternative MTA installed such as sendmail. If this is the case consult the documentation for your installed MTA to configure the recommended state.",
        "solution": "Edit /etc/postfix/main.cf and add the following line to the RECEIVING MAIL section. If the line already exists, change it to look like the line below:\n\ninet_interfaces = loopback-only\n\nRun the following command to restart postfix :\n\n# systemctl restart postfix",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/ss -lntu | /bin/grep -P ':25\\\\b' | /bin/grep -Pv '\\\\h+(127\\\\.0\\\\.0\\\\.1|\\\\[?::1\\\\]?):25\\\\b'  | /bin/awk \\'{print} END { if(NR==0) print \"pass\" ; else print \"fail\"}\\'",
        "expect": "^pass$"
    },
    "custom_item_109": {
        "description": "rpm check rsync",
        "rpm": "rsync-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_110": {
        "description": "2.2.17 Ensure rsync is not installed or the rsyncd service is masked",
        "info": "The rsyncd service can be used to synchronize files between systems over network links.\n\nUnless required, the rsync package should be removed to reduce the attack surface area of the system.\n\nThe rsyncd service presents a security risk as it uses unencrypted protocols for communication.\n\nNote: If a required dependency exists for the rsync package, but the rsyncd service is not required, the service should be masked.",
        "solution": "Run the following command to remove the rsync package:\n\n# zypper remove rsync\n\nOR\n\nRun the following command to mask the rsyncd service:\n\n# systemctl --now mask rsyncd\n\nImpact:\n\nThere are packages that are dependent on the rsync package. If the rsync package is removed, these packages will be removed as well.\n\nBefore removing the rsync package, review any dependent packages to determine if they are required on the system. If a dependent package is required, mask the rsyncd service and leave the rsync package installed.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/systemctl is-enabled rsyncd",
        "expect": "^masked$"
    },
    "custom_item_111": {
        "description": "2.2.17 Ensure rsync is not installed or the rsyncd service is masked",
        "info": "The rsyncd service can be used to synchronize files between systems over network links.\n\nUnless required, the rsync package should be removed to reduce the attack surface area of the system.\n\nThe rsyncd service presents a security risk as it uses unencrypted protocols for communication.\n\nNote: If a required dependency exists for the rsync package, but the rsyncd service is not required, the service should be masked.",
        "solution": "Run the following command to remove the rsync package:\n\n# zypper remove rsync\n\nOR\n\nRun the following command to mask the rsyncd service:\n\n# systemctl --now mask rsyncd\n\nImpact:\n\nThere are packages that are dependent on the rsync package. If the rsync package is removed, these packages will be removed as well.\n\nBefore removing the rsync package, review any dependent packages to determine if they are required on the system. If a dependent package is required, mask the rsyncd service and leave the rsync package installed.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "rsync-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_112": {
        "description": "2.2.18 Ensure NIS server is not installed",
        "info": "The ypserv package provides the Network Information Service (NIS). This service, formally known as Yellow Pages, is a client-server directory service protocol for distributing system configuration files. The NIS server is a collection of programs that allow for the distribution of configuration files.\n\nThe NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication for querying NIS maps. NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the ypserv package be removed, and if required a more secure services be used.",
        "solution": "Run the following command to remove ypserv :\n\n# zypper remove ypserv",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "ypserv-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_113": {
        "description": "2.2.19 Ensure telnet-server is not installed",
        "info": "The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol.\n\nThe telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow a user with access to sniff network traffic the ability to steal credentials. The ssh package provides an encrypted session and stronger security.",
        "solution": "Run the following command to remove the telnet-server package:\n\n# zypper remove telnet-server",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "telnet-server-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_114": {
        "description": "2.2.2 Ensure X11 Server components are not installed",
        "info": "The X Window System provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs and various add on. The X Windows system is typically used on workstations where users login, but not on servers where users typically do not login.\n\nUnless your organization specifically requires graphical login access via X Windows, remove it to reduce the potential attack surface.",
        "solution": "Run the following command to remove the X Windows Server packages:\n\n# zypper remove xorg-x11-server*\n\nImpact:\n\nMany Linux systems run applications which require a Java runtime. Some Linux Java packages have a dependency on specific X Windows xorg-x11-fonts. One workaround to avoid this dependency is to use the \"headless\" Java packages for your specific Java runtime.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/rpm -qa xorg-x11-server* | /bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_115": {
        "description": "rpm check avahi-autoipd",
        "rpm": "avahi-autoipd-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_116": {
        "description": "avahi",
        "rpm": "avahi-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_117": {
        "description": "2.2.4 Ensure CUPS is not installed",
        "info": "The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. A system running CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based remote administration capability.\n\nIf the system does not need to print jobs or accept print jobs from other systems, it is recommended that CUPS be removed to reduce the potential attack surface.\n\nNote: Removing CUPS will prevent printing from the system",
        "solution": "Run the following command to remove cups :\n\n# zypper remove cups\n\nImpact:\n\nDisabling CUPS will prevent printing from the system, a common task for workstation systems.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "cups-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_118": {
        "description": "2.2.5 Ensure DHCP Server is not installed",
        "info": "The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses.\n\nUnless a system is specifically set up to act as a DHCP server, it is recommended that the dhcp package be removed to reduce the potential attack surface.",
        "solution": "Run the following command to remove dhcp :\n\n# zypper remove dhcp",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "dhcp-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_119": {
        "description": "2.2.6 Ensure LDAP server is not installed",
        "info": "The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.\n\nIf the system will not need to act as an LDAP server, it is recommended that the software be removed to reduce the potential attack surface.",
        "solution": "Run the following command to remove openldap-servers :\n\n# zypper remove openldap2",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "openldap2-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_120": {
        "description": "nfs-utils",
        "rpm": "nfs-utils-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_121": {
        "description": "rpm check nfs-kernel-server",
        "rpm": "nfs-kernel-server-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_122": {
        "description": "2.2.7 Ensure nfs-utils is not installed or the  nfs-server service is masked",
        "info": "The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.\n\nIf the system does not require network shares, it is recommended that the nfs-utils and nfs-kernel-server packages be removed to reduce the attack surface of the system.\n\nNote: many of the libvirt packages used by Enterprise Linux virtualization are dependent on the nfs-utils package. If the nfs-utils or nfs-kernel-server packages are required as a dependency, the nfs-server service should be disabled and masked to reduce the attack surface of the system",
        "solution": "Run the following commands to remove nfs-utils and nfs-kernel-server :\n\n# zypper remove nfs-utils\n\n# zypper remove nfs-kernel-server\n\nOR\n\nIf the nfs-utils or nfs-kernel-server packages are required as a dependency\n\nRun the following command to stop and mask the nfs-server service:\n\n# systemctl --now mask nfs-server",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/systemctl is-enabled nfs-server",
        "expect": "^masked$"
    },
    "custom_item_123": {
        "description": "rpcbind exist",
        "rpm": "rpcbind-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_124": {
        "description": "rpcbind exist",
        "rpm": "rpcbind-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_125": {
        "description": "systemctl is-enabled rpcbind",
        "cmd": "/bin/systemctl is-enabled rpcbind",
        "expect": "^(masked|disabled)$"
    },
    "custom_item_126": {
        "description": "systemctl is-enabled rpcbind.socket",
        "cmd": "/bin/systemctl is-enabled rpcbind.socket",
        "expect": "^(masked|disabled)$"
    },
    "custom_item_127": {
        "description": "2.2.9 Ensure DNS Server is not installed",
        "info": "The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.\n\nUnless a system is specifically designated to act as a DNS server, it is recommended that the package be removed to reduce the potential attack surface.",
        "solution": "Run the following command to remove bind :\n\n# zypper remove bind",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "bind-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_128": {
        "description": "2.3.1 Ensure NIS Client is not installed",
        "info": "The Network Information Service (NIS), formerly known as Yellow Pages, is a client-server directory service protocol used to distribute system configuration files. The NIS client ( ypbind ) was used to bind a machine to an NIS server and receive the distributed configuration files.\n\nThe NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication for querying NIS maps. NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the service be removed.",
        "solution": "Run the following command to remove the ypbind package:\n\n# zypper remove ypbind\n\nImpact:\n\nMany insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "ypbind-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_129": {
        "description": "2.3.2 Ensure rsh client is not installed",
        "info": "The rsh package contains the client commands for the rsh services.\n\nThese legacy clients contain numerous security exposures and have been replaced with the more secure SSH package. Even if the server is removed, it is best to ensure the clients are also removed to prevent users from inadvertently attempting to use these commands and therefore exposing their credentials. Note that removing the rsh package removes the clients for rsh rcp and rlogin",
        "solution": "Run the following command to remove the rsh package:\n\n# zypper remove rsh\n\nImpact:\n\nMany insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "rsh-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_130": {
        "description": "2.3.3 Ensure talk client is not installed",
        "info": "The talk software makes it possible for users to send and receive messages across systems through a terminal session. The talk client, which allows initialization of talk sessions, is installed by default.\n\nThe software presents a security risk as it uses unencrypted protocols for communication.",
        "solution": "Run the following command to remove the talk package:\n\n# zypper remove talk\n\nImpact:\n\nMany insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "talk-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_131": {
        "description": "2.3.4 Ensure telnet client is not installed",
        "info": "The telnet package contains the telnet client, which allows users to start connections to other systems via the telnet protocol.\n\nThe telnet protocol is insecure and unencrypted. The use of an unencrypted transmission medium could allow an unauthorized user to steal credentials. The ssh package provides an encrypted session and stronger security and is included in most Linux distributions.",
        "solution": "Run the following command to remove the telnet package:\n\n# zypper remove telnet\n\nImpact:\n\nMany insecure service clients are used as troubleshooting tools and in testing environments. Uninstalling them can inhibit capability to test and troubleshoot. If they are required it is advisable to remove the clients after use to prevent accidental or intentional misuse.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "telnet-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_132": {
        "description": "2.3.5 Ensure LDAP client is not installed",
        "info": "The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.\n\nIf the system will not need to act as an LDAP client, it is recommended that the software be removed to reduce the potential attack surface.",
        "solution": "Run the following command to remove the openldap-clients package:\n\n# zypper remove openldap2-clients\n\nImpact:\n\nRemoving the LDAP client will prevent or inhibit using LDAP for authentication in your environment.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|2.6,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "openldap2-client-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_133": {
        "system": "Linux",
        "description": "2.4 Ensure nonessential services are removed or masked",
        "info": "A network port is identified by its number, the associated IP address, and the type of the communication protocol such as TCP or UDP.\n\nA listening port is a network port on which an application or process listens on, acting as a communication endpoint.\n\nEach listening port can be open or closed (filtered) using a firewall. In general terms, an open port is a network port that accepts incoming packets from remote locations.\n\nServices listening on the system pose a potential risk as an attack vector. These services should be reviewed, and if not required, the service should be stopped, and the package containing the service should be removed. If required packages have a dependency, the service should be stopped and masked to reduce the attack surface of the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to remove the package containing the service:\n\n# zypper removeOr If required packages have a dependency:\n\nRun the following command to stop and mask the service:\n\n# systemctl --now mask",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/lsof -i -P -n | /bin/grep -v \"(ESTABLISHED)\"",
        "expect": "Manual Review Required"
    },
    "custom_item_134": {
        "description": "ip link show up",
        "cmd": "/sbin/ip link show up",
        "expect": "Manual Review Required"
    },
    "custom_item_135": {
        "description": "iw list",
        "cmd": "/usr/sbin/iw list | /bin/awk \\'{print} END {if (NR == 0) print \"none\"}\\'",
        "expect": "Manual Review Required"
    },
    "custom_item_136": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_137": {
        "description": "sysctl net.ipv6.conf.all.forwarding",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.forwarding",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_138": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.all.forwarding",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf",
        "regex": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding\\\\s*=\\\\s*1\\\\s*$",
        "expect": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding\\\\s*=\\\\s*1\\\\s*$"
    },
    "custom_item_139": {
        "description": "sysctl net.ipv4.ip_forward",
        "cmd": "/sbin/sysctl net.ipv4.ip_forward",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.ip_forward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_140": {
        "description": "sysctl.conf sysctl.d net.ipv4.ip_forward",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\\s*$",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\\s*$"
    },
    "custom_item_141": {
        "description": "sysctl net.ipv4.ip_forward",
        "cmd": "/sbin/sysctl net.ipv4.ip_forward",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.ip_forward[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_142": {
        "description": "sysctl.conf sysctl.d net.ipv4.ip_forward",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\\s*$",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\\s*$"
    },
    "custom_item_143": {
        "description": "sysctl net.ipv4.conf.default.send_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.send_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.send_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_144": {
        "description": "sysctl net.ipv4.conf.all.send_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.send_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.send_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_145": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_146": {
        "description": "sysctl net.ipv4.conf.all.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_147": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.all.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_source_route",
        "expect": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_source_route\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_148": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.default.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_149": {
        "description": "sysctl net.ipv4.conf.default.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_150": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.default.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_source_route",
        "expect": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_source_route\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_151": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.all.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_152": {
        "description": "sysctl net.ipv6.conf.all.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_153": {
        "description": "sysctl net.ipv6.conf.default.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_154": {
        "description": "sysctl net.ipv4.conf.all.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_155": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.default.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_156": {
        "description": "sysctl net.ipv4.conf.default.accept_source_route",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_157": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.all.accept_source_route",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_158": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_159": {
        "description": "sysctl net.ipv4.conf.all.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_160": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.all.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_161": {
        "description": "sysctl net.ipv6.conf.all.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_162": {
        "description": "sysctl net.ipv6.conf.default.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_163": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.default.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_164": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.default.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_165": {
        "description": "sysctl net.ipv4.conf.default.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_166": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.all.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_167": {
        "description": "sysctl net.ipv4.conf.all.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_168": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.all.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_169": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.default.accept_redirects",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_170": {
        "description": "sysctl net.ipv4.conf.default.accept_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_171": {
        "description": "sysctl net.ipv4.conf.default.secure_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.secure_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_172": {
        "description": "sysctl net.ipv4.conf.all.secure_redirects",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.secure_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_173": {
        "description": "sysctl net.ipv4.conf.default.log_martians",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.log_martians",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_174": {
        "description": "sysctl net.ipv4.conf.all.log_martians",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.log_martians",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_175": {
        "system": "Linux",
        "description": "3.3.5 Ensure broadcast ICMP requests are ignored",
        "info": "Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.\n\nAccepting ICMP echo and timestamp requests with broadcast or multicast destinations for your network could be used to trick your host into starting (or participating) in a Smurf attack. A Smurf attack relies on an attacker sending large amounts of ICMP broadcast messages with a spoofed source address. All hosts receiving this message and responding would send echo-reply messages back to the spoofed address, which is probably not routable. If many hosts respond to the packets, the amount of traffic on the network could be significantly multiplied.",
        "solution": "Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\n# sysctl -w net.ipv4.route.flush=1",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/sbin/sysctl net.ipv4.icmp_echo_ignore_broadcasts",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.icmp_echo_ignore_broadcasts[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_176": {
        "system": "Linux",
        "description": "3.3.6 Ensure bogus ICMP responses are ignored",
        "info": "Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.\n\nSome routers (and some attackers) will send responses that violate RFC-1122 and attempt to fill up a log file system with many useless error messages.",
        "solution": "Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file:\n\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\n# sysctl -w net.ipv4.route.flush=1",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/sbin/sysctl net.ipv4.icmp_ignore_bogus_error_responses",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.icmp_ignore_bogus_error_responses[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_177": {
        "description": "sysctl net.ipv4.conf.default.rp_filter",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.rp_filter",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.rp_filter[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_178": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.default.rp_filter",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.rp_filter",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.default\\\\.rp_filter\\\\s*=\\\\s*1\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_179": {
        "description": "sysctl net.ipv4.conf.all.rp_filter",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.rp_filter",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.rp_filter[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_180": {
        "description": "sysctl.conf sysctl.d net.ipv4.conf.all.rp_filter",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.rp_filter",
        "expect": "^\\\\s*net\\\\.ipv4\\\\.conf\\\\.all\\\\.rp_filter\\\\s*=\\\\s*1\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_181": {
        "system": "Linux",
        "description": "3.3.8 Ensure TCP SYN Cookies is enabled",
        "info": "When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with the specially crafted sequence number. This allows the system to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.\n\nAttackers use SYN flood attacks to perform a denial of service attacked on a system by sending many SYN packets without completing the three way handshake. This will quickly use up slots in the kernel's half-open connection queue and prevent legitimate connections from succeeding. SYN cookies allow the system to keep accepting valid connections, even if under a denial of service attack.",
        "solution": "Set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file:\n\nnet.ipv4.tcp_syncookies = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.tcp_syncookies=1\n\n# sysctl -w net.ipv4.route.flush=1",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/sbin/sysctl net.ipv4.tcp_syncookies",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.tcp_syncookies[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_182": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_183": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.default.accept_ra",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\.ipv6\\.conf\\.default\\.accept_ra",
        "expect": "^\\\\s*net\\.ipv6\\.conf\\.default\\.accept_ra\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_184": {
        "description": "sysctl.conf sysctl.d net.ipv6.conf.all.accept_ra",
        "file": "/etc/sysctl.conf /etc/sysctl.d/*",
        "regex": "^\\\\s*net\\.ipv6\\.conf\\.all\\.accept_ra",
        "expect": "^\\\\s*net\\.ipv6\\.conf\\.all\\.accept_ra\\\\s*=\\\\s*0\\\\s*$",
        "min_occurrences": "1"
    },
    "custom_item_185": {
        "system": "Linux",
        "description": "sysctl net.ipv6.conf.default.accept_ra",
        "cmd": "sysctl net.ipv6.conf.default.accept_ra",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_ra[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_186": {
        "system": "Linux",
        "description": "sysctl net.ipv6.conf.all.accept_ra",
        "cmd": "sysctl net.ipv6.conf.all.accept_ra",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_ra[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_187": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_188": {
        "description": "iptables installed",
        "rpm": "iptables-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_189": {
        "description": "firewalld check - installed",
        "rpm": "firewalld-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_190": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_191": {
        "description": "rpm check nftables",
        "rpm": "nftables-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_192": {
        "description": "3.5.1.2 Ensure nftables is not installed or stopped and masked",
        "info": "nftables is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames and is the successor to iptables.\n\nNotes:\n\n -\n\nSupport for using nftables as the back-end for firewalld was added in release v0.6.0. In Fedora 19 Linux derivatives, firewalld utilizes iptables as it's back-end by default.\n\n -\n\nfirewalld may be configured as the front-end to nftables. If this case, nftables should be stopped and masked instead of removed.\n\nRunning both firewalld and nftables may lead to conflict.",
        "solution": "Run the following command to remove nftables :\n\n# zypper remove nftables\n\nOR\n\nRun the following command to stop and mask nftables :\n\nsystemctl --now mask nftables",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|CM-6,800-53|CM-7,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|4.8,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "nftables-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_193": {
        "description": "systemctl status nftables",
        "cmd": "/bin/systemctl status nftables | /bin/grep \"Active: \" | /bin/grep -v \"inactive (dead)\" | /bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_194": {
        "description": "systemctl is-enabled nftables",
        "cmd": "/bin/systemctl is-enabled nftables",
        "expect": "^masked$"
    },
    "custom_item_195": {
        "description": "Nftables check - installed",
        "rpm": "nftables-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_196": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_197": {
        "description": "firewall-cmd --state",
        "cmd": "/usr/bin/firewall-cmd --state",
        "expect": "^running$"
    },
    "custom_item_198": {
        "description": "systemctl is-enabled firewalld",
        "cmd": "/bin/systemctl is-enabled firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^enabled$"
    },
    "custom_item_199": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_200": {
        "system": "Linux",
        "description": "3.5.1.4 Ensure default zone is set",
        "info": "A firewall zone defines the trust level for a connection, interface or source address binding. This is a one to many relation, which means that a connection, interface or source can only be part of one zone, but a zone can be used for many network connections, interfaces and sources.\n\n - The default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone.\n - If no zone assigned to a connection, interface or source, only the default zone is used.\n - The default zone is not always listed as being used for an interface or source as it will be used for it either way. This depends on the manager of the interfaces.\n\nConnections handled by NetworkManager are listed as NetworkManager requests to add the zone binding for the interface used by the connection. Also interfaces under control of the network service are listed also because the service requests it.\n\nNotes:\n\n -\n\nA firewalld zone configuration file contains the information for a zone.\n\n -\n\nThese are the zone description, services, ports, protocols, icmp-blocks, masquerade, forward-ports and rich language rules in an XML file format.\n\n -\n\nThe file name has to be zone_name.xml where length of zone_name is currently limited to 17 chars.\n\n -\n\nNetworkManager binds interfaces to zones automatically\n\nBecause the default zone is the zone that is used for everything that is not explicitly bound/assigned to another zone, it is important for the default zone to set",
        "solution": "Run the following command to set the default zone:\n\n# firewall-cmd --set-default-zone=Example:\n\n# firewall-cmd --set-default-zone=public",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/firewall-cmd --get-default-zone",
        "expect": "@FIREWALLD_DEFAULT_ZONE@"
    },
    "custom_item_201": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_202": {
        "description": "3.5.1.5 Ensure network interfaces are assigned to appropriate zone",
        "info": "firewall zones define the trust level of network connections or interfaces.\n\nNote: The firewall in the Linux kernel is not able to handle network connections with the name shown by NetworkManager, it can only handle the network interfaces used by the connection. Because of this NetworkManager tells firewalld to assign the network interface that is used for this connection to the zone defined in the configuration of that connection. This assignment happens before the interface is used. The configuration of the connection can either be the NetworkManager configuration or also an ifcfg. For example: If the zone is not set in the configuration file, the interfaces will be assigned to the default zone defined in the firewalld configuration. If a connection has more than one interface, all of them will be supplied to firewalld. Also changes in the names of interfaces will be handled by NetworkManager and supplied to firewalld.\n\nA network interface not assigned to the appropriate zone can allow unexpected or undesired network traffic to be accepted on the interface.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to assign an interface to the approprate zone.\n\n# firewall-cmd --zone=--change-interface=Example:\n\n# firewall-cmd --zone=customezone --change-interface=eth0\n\nImpact:\n\nChanging firewall settings while connected over network can result in being locked out of the system.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/nmcli -t connection show | /bin/awk -F: \\'{if($4){print $4}}\\' | while read INT; do /usr/bin/firewall-cmd --get-active-zones | /bin/grep -B1 $INT; done",
        "expect": "^Manual Review Required$"
    },
    "custom_item_203": {
        "description": "systemctl is-active firewalld",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_204": {
        "description": "3.5.1.6 Ensure unnecessary services and ports are not accepted",
        "info": "Services and ports can be accepted or explicitly rejected or dropped by a zone.\n\nFor every zone, you can set a default behavior that handles incoming traffic that is not further specified. Such behavior is defined by setting the target of the zone. There are three options - default, ACCEPT, REJECT, and DROP.\n\n - ACCEPT - you accept all incoming packets except those disabled by a specific rule.\n - REJECT - you disable all incoming packets except those that you have allowed in specific rules and the source machine is informed about the rejection.\n - DROP - you disable all incoming packets except those that you have allowed in specific rules and no information sent to the source machine.\n\nTo reduce the attack surface of a system, all services and ports should be blocked unless required\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following command to remove an unnecessary service:\n\n# firewall-cmd --remove-service=Example:\n\n#firewall-cmd --remove-service=cockpit\n\nRun the following command to remove an unnecessary port:\n\n# firewall-cmd --remove-port=/Example:\n\n# firewall-cmd --remove-port=25/tcp\n\nRun the following command to make new settings persistent:\n\n# firewall-cmd --runtime-to-permanent",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/firewall-cmd --get-active-zones | /bin/awk '!/:/ {print $1}' | while read ZN; do /usr/bin/firewall-cmd --list-all --zone=$ZN; done",
        "expect": "^Manual Review Required$"
    },
    "custom_item_205": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_206": {
        "description": "3.5.2.1 Ensure nftables is installed",
        "info": "nftables provides a new in-kernel packet classification framework that is based on a network-specific Virtual Machine (VM) and a new nft userspace command line tool. nftables reuses the existing Netfilter subsystems such as the existing hook infrastructure, the connection tracking system, NAT, userspace queuing and logging subsystem.\n\nNotes:\n\n -\n\nnftables is available in Linux kernel 3.13 and newer.\n\n -\n\nOnly one firewall utility should be installed and configured.\n\nnftables is a subsystem of the Linux kernel that can protect against threats originating from within a corporate network to include malicious mobile code and poorly configured software on a host.",
        "solution": "Run the following command to install nftables\n\n# zypper install nftables\n\nImpact:\n\nChanging firewall settings while connected over the network can result in being locked out of the system.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "nftables-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_207": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_208": {
        "description": "3.5.2.10 Ensure nftables rules are permanent",
        "info": "nftables is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames.\n\nThe nftables service reads the /etc/sysconfig/nftables.conf file for a nftables file or files to include in the nftables ruleset.\n\nA nftables ruleset containing the input, forward, and output base chains allow network traffic to be filtered.\n\nChanges made to nftables ruleset only affect the live system, you will also need to configure the nftables ruleset to apply on boot",
        "solution": "Edit the /etc/sysconfig/nftables.conf file and un-comment or add a line with includefor each nftables file you want included in the nftables ruleset on boot\n\nExample:\n\n# vi /etc/sysconfig/nftables.conf\n\nAdd the line:\n\ninclude \"/etc/nftables/nftables.rules\"",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/sysconfig/nftables.conf",
        "regex": "^[\\\\s]*include[\\\\s]+",
        "expect": "^[\\\\s]*include[\\\\s]+\"?@NFTABLES_RULES_FILE@\"?"
    },
    "custom_item_209": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_210": {
        "description": "rpm check firewalld",
        "rpm": "firewalld-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_211": {
        "description": "3.5.2.2 Ensure firewalld is not installed or stopped and masked",
        "info": "firewalld (Dynamic Firewall Manager) provides a dynamically managed firewall with support for network/firewall \"zones\" to assign a level of trust to a network and its associated connections, interfaces or sources. It has support for IPv4, IPv6, Ethernet bridges and also for IPSet firewall settings. There is a separation of the runtime and permanent configuration options.\n\nRunning both nftables.service and firewalld.service may lead to conflict and unexpected results.",
        "solution": "Run the following command to remove firewalld\n\n# zypper remove firewalld\n\nOR\n\nRun the following command to stop and mask firewalld\n\n# systemctl --now mask firewalld",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|CM-6,800-53|CM-7,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|4.8,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "firewalld-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_212": {
        "description": "systemctl is-enabled firewalld",
        "cmd": "/bin/systemctl is-enabled firewalld",
        "expect": "^masked$"
    },
    "custom_item_213": {
        "description": "rpm check firewalld",
        "rpm": "firewalld-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_214": {
        "description": "systemctl status firewalld",
        "cmd": "/bin/systemctl status firewalld | /bin/grep \"Active: \" | /bin/grep -v \"inactive (dead) \" | /bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_215": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_216": {
        "description": "3.5.2.3 Ensure iptables are flushed",
        "info": "nftables is a replacement for iptables, ip6tables, ebtables and arptables\n\nIt is possible to mix iptables and nftables. However, this increases complexity and also the chance to introduce errors. For simplicity flush out all iptables rules, and ensure it is not loaded\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following commands to flush iptables:\n\nFor iptables:\n\n# iptables -F\n\nFor ip6tables\n\n# ip6tables -F",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/sbin/iptables -L;/usr/sbin/ip6tables -L",
        "expect": "^Manual Review Required$"
    },
    "custom_item_217": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_218": {
        "description": "3.5.2.4 Ensure a table exists",
        "info": "Tables hold chains. Each table only has one address family and only applies to packets of this family. Tables can have one of five families.\n\nnftables doesn't have any default tables. Without a table being build, nftables will not filter network traffic.",
        "solution": "Run the following command to create a table in nftables\n\n# nft create table inetExample:\n\n# nft create table inet filter\n\nImpact:\n\nAdding rules to a running nftables can cause loss of connectivity to the system",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/sbin/nft list tables | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_219": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_220": {
        "description": "nft list ruleset hook output",
        "cmd": "/usr/sbin/nft list ruleset | /bin/grep 'hook output'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+output[\\\\s]+priority[\\\\s]+0;"
    },
    "custom_item_221": {
        "description": "nft list ruleset hook forward",
        "cmd": "/usr/sbin/nft -n list ruleset | /bin/grep 'hook forward'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+forward[\\\\s]+priority[\\\\s]+0;"
    },
    "custom_item_222": {
        "description": "nft list ruleset hook input",
        "cmd": "/usr/sbin/nft list ruleset | /bin/grep 'hook input'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+input[\\\\s]+priority[\\\\s]+0;"
    },
    "custom_item_223": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_224": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n{\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi\n}",
        "expect": "^IPv6 is enabled on the system$"
    },
    "custom_item_225": {
        "description": "nft list ruleset hook input ip saddr 127.0.0.0/8",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'ip saddr 127\\.0\\.0\\.0/8' | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_226": {
        "description": "nft list ruleset /hook input ip6 saddr ::1",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'ip6 saddr ::1' | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_227": {
        "description": "nft list ruleset hook input iif lo accept",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'iif \"lo\" accept' | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_228": {
        "description": "nft list ruleset hook input ip saddr 127.0.0.0/8",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'ip saddr 127\\.0\\.0\\.0/8' | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_229": {
        "description": "nft list ruleset hook input iif lo accept",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep 'iif \"lo\" accept' | /bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_230": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_231": {
        "description": "nft list ruleset hook input ip protocol ct state",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook input/,/}/' | /bin/grep -E 'ip protocol (tcp|udp|icmp) ct state'",
        "expect": "^Manual Review Required$"
    },
    "custom_item_232": {
        "description": "nft list ruleset hook output ip protocol ct state",
        "cmd": "/usr/sbin/nft list ruleset | /bin/awk '/hook output/,/}/' | /bin/grep -E 'ip protocol (tcp|udp|icmp) ct state'",
        "expect": "^Manual Review Required$"
    },
    "custom_item_233": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_234": {
        "description": "nft list ruleset hook output",
        "cmd": "/usr/sbin/nft list ruleset | /bin/grep 'hook output'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+output[\\\\s]+priority[\\\\s]+0;[\\\\s]+policy[\\\\s]+drop;"
    },
    "custom_item_235": {
        "description": "nft list ruleset hook forward",
        "cmd": "/usr/sbin/nft list ruleset | /bin/grep 'hook forward'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+forward[\\\\s]+priority[\\\\s]+0;[\\\\s]+policy[\\\\s]+drop;"
    },
    "custom_item_236": {
        "description": "nft list ruleset hook input",
        "cmd": "/usr/sbin/nft list ruleset | /bin/grep 'hook input'",
        "expect": "type[\\\\s]+filter[\\\\s]+hook[\\\\s]+input[\\\\s]+priority[\\\\s]+0;[\\\\s]+policy[\\\\s]+drop;"
    },
    "custom_item_237": {
        "description": "systemctl is-active nftables",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^active$"
    },
    "custom_item_238": {
        "description": "3.5.2.9 Ensure nftables service is enabled",
        "info": "The nftables service allows for the loading of nftables rulesets during boot, or starting on the nftables service\n\nThe nftables service restores the nftables rules from the rules files referenced in the /etc/sysconfig/nftables.conf file during boot or the starting of the nftables service",
        "solution": "Run the following command to enable the nftables service:\n\n# systemctl enable nftables",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/systemctl is-enabled nftables | /bin/awk '{print} END {if(NR==0) print \"disabled\" }'",
        "expect": "^enabled$"
    },
    "custom_item_239": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_240": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_241": {
        "description": "3.5.3.1.1 Ensure iptables package is installed",
        "info": "iptables is a utility program that allows a system administrator to configure the tables provided by the Linux kernel firewall, implemented as different Netfilter modules, and the chains and rules it stores. Different kernel modules and programs are used for different protocols; iptables applies to IPv4, ip6tables to IPv6, arptables to ARP, and ebtables to Ethernet frames.\n\nA method of configuring and maintaining firewall rules is necessary to configure a Host Based Firewall.",
        "solution": "Run the following command to install iptables\n\n# zypper install iptables",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "iptables-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_242": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_243": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_244": {
        "description": "3.5.3.1.2 Ensure nftables is not installed",
        "info": "nftables is a subsystem of the Linux kernel providing filtering and classification of network packets/datagrams/frames and is the successor to iptables.\n\nRunning both iptables and nftables may lead to conflict.",
        "solution": "Run the following command to remove nftables :\n\n# zypper remove nftables",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|CM-6,800-53|CM-7,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|4.8,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "nftables-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_245": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_246": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_247": {
        "description": "rpm check firewalld",
        "rpm": "firewalld-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_248": {
        "description": "3.5.3.1.3 Ensure firewalld is not installed or stopped and masked",
        "info": "firewalld (Dynamic Firewall Manager) provides a dynamically managed firewall with support for network/firewall \"zones\" to assign a level of trust to a network and its associated connections, interfaces or sources. It has support for IPv4, IPv6, Ethernet bridges and also for IPSet firewall settings. There is a separation of the runtime and permanent configuration options.\n\nRunning iptables.service and\\or ip6tables.service with firewalld.service may lead to conflict and unexpected results.",
        "solution": "Run the following command to remove firewalld\n\n# zypper remove firewalld\n\nOR\n\nRun the following command to stop and mask firewalld\n\n# systemctl --now mask firewalld",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|CM-6,800-53|CM-7,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-6,800-53r5|CM-7,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|4.8,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS15a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "firewalld-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_249": {
        "description": "systemctl is-enabled firewalld",
        "cmd": "/bin/systemctl is-enabled firewalld",
        "expect": "^masked$"
    },
    "custom_item_250": {
        "description": "rpm check firewalld",
        "rpm": "firewalld-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_251": {
        "description": "systemctl status firewalld",
        "cmd": "/bin/systemctl status firewalld | /bin/grep \"Active: \" | /bin/grep -v \"inactive (dead)\" | /bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_252": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_253": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_254": {
        "description": "iptables Chain OUTPUT DROP REJECT",
        "cmd": "/usr/sbin/iptables -L | /bin/grep 'Chain OUTPUT'",
        "expect": "^Chain OUTPUT \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_255": {
        "description": "iptables Chain INPUT DROP REJECT",
        "cmd": "/usr/sbin/iptables -L | /bin/grep 'Chain INPUT'",
        "expect": "^Chain INPUT \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_256": {
        "description": "iptables Chain FORWARD DROP REJECT",
        "cmd": "/usr/sbin/iptables -L | /bin/grep 'Chain FORWARD'",
        "expect": "^Chain FORWARD \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_257": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_258": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_259": {
        "description": "iptables INPUT",
        "cmd": "/usr/sbin/iptables -L INPUT -v -n | /bin/awk '{ a[$3\":\"$4\":\"$6\":\"$7\":\"$8\":\"$9] = NR; print } END { if (a[\"ACCEPT:all:lo:*:0.0.0.0/0:0.0.0.0/0\"] > 0 && a[\"ACCEPT:all:lo:*:0.0.0.0/0:0.0.0.0/0\"] < a[\"DROP:all:*:*:127.0.0.0/8:0.0.0.0/0\"]) { print \"pass\" } else { print \"fail\" } }'",
        "expect": "^pass$"
    },
    "custom_item_260": {
        "description": "iptables OUTPUT",
        "cmd": "/usr/sbin/iptables -L OUTPUT -v -n | /bin/awk '{ a[$3\":\"$4\":\"$6\":\"$7\":\"$8\":\"$9] = NR; print } END { if (a[\"ACCEPT:all:*:lo:0.0.0.0/0:0.0.0.0/0\"] > 0) { print \"pass\" } else { print \"fail\" } }'",
        "expect": "^pass$"
    },
    "custom_item_261": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_262": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_263": {
        "description": "3.5.3.2.3 Ensure outbound and established connections are configured",
        "info": "Configure the firewall rules for new outbound, and established connections.\n\nIf rules are not in place for new outbound, and established connections all packets will be dropped by the default policy preventing network usage.\n\nNote: Changing firewall settings while connected over network can result in being locked out of the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/sbin/iptables -L -v -n",
        "expect": "^Manual Review Required$"
    },
    "custom_item_264": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_265": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_266": {
        "description": "3.5.3.2.4 Ensure firewall rules exist for all open ports",
        "info": "Any ports that have been opened on non-loopback addresses need firewall rules to govern traffic.\n\nWithout a firewall rule configured for open ports default firewall policy will drop all packets to these ports.\n\nNotes:\n\n - Changing firewall settings while connected over network can result in being locked out of the system.\n - The remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any restrictions in compliance with site policy.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections:\n\n# iptables -A INPUT -p--dport-m state --state NEW -j ACCEPT",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/sbin/ss -4tuln; /usr/sbin/iptables -L INPUT -v -n",
        "expect": "^Manual Review Required$"
    },
    "custom_item_267": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_268": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_269": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n{\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi\n}",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_270": {
        "description": "ip6tables Chain OUTPUT",
        "cmd": "/usr/sbin/ip6tables -L | /bin/grep 'Chain OUTPUT'",
        "expect": "^Chain OUTPUT \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_271": {
        "description": "ip6tables Chain INPUT",
        "cmd": "/usr/sbin/ip6tables -L | /bin/grep 'Chain INPUT'",
        "expect": "^Chain INPUT \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_272": {
        "description": "ip6tables Chain FORWARD",
        "cmd": "/usr/sbin/ip6tables -L | /bin/grep 'Chain FORWARD'",
        "expect": "^Chain FORWARD \\\\(policy (DROP|REJECT)\\\\)$"
    },
    "custom_item_273": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_274": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_275": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n{\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi\n}",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_276": {
        "description": "ip6tables INPUT",
        "cmd": "/usr/sbin/ip6tables -L INPUT -v -n | /bin/awk '{ a[$3\":\"$4\":\"$5\":\"$6\":\"$7\":\"$8] = NR; print } END { if (a[\"ACCEPT:all:lo:*:::/0:::/0\"] > 0 && a[\"ACCEPT:all:lo:*:::/0:::/0\"] < a[\"DROP:all:*:*:::1:::/0\"]) { print \"pass\" } else { print \"fail\" } }'",
        "expect": "^pass$"
    },
    "custom_item_277": {
        "description": "ip6tables OUTPUT",
        "cmd": "/usr/sbin/ip6tables -L OUTPUT -v -n | /bin/awk '{ a[$3\":\"$4\":\"$5\":\"$6\":\"$7\":\"$8] = NR; print } END { if (a[\"ACCEPT:all:*:lo:::/0:::/0\"] > 0) { print \"pass\" } else { print \"fail\" } }'",
        "expect": "^pass$"
    },
    "custom_item_278": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_279": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_280": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n{\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi\n}",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_281": {
        "description": "3.5.3.3.3 Ensure IPv6 outbound and established connections are configured",
        "info": "Configure the firewall rules for new outbound, and established IPv6 connections.\n\nIf rules are not in place for new outbound, and established connections all packets will be dropped by the default policy preventing network usage.\n\nNote: Changing firewall settings while connected over network can result in being locked out of the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/sbin/ip6tables -L -v -n",
        "expect": "^Manual Review Required$"
    },
    "custom_item_282": {
        "description": "check if nftables is not active",
        "cmd": "/bin/systemctl is-active nftables | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_283": {
        "description": "check if firewalld is not active",
        "cmd": "/bin/systemctl is-active firewalld | /bin/awk '{print} END {if(NR==0) print \"inactive\" }'",
        "expect": "^(inactive|unknown)$"
    },
    "custom_item_284": {
        "description": "check if IPv6 is enabled on the system",
        "cmd": "#!/bin/bash\n{\n[ -n \"$passing\" ] && passing=\"\"\n[ -z \"$(grep \"^\\\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1)\" ] && passing=\"true\"\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" /etc/sysctl.conf \\\\\n/etc/sysctl.d/*.conf && grep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" \\\\\n/etc/sysctl.conf /etc/sysctl.d/*.conf && sysctl net.ipv6.conf.all.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && \\\\\nsysctl net.ipv6.conf.default.disable_ipv6 | \\\\\ngrep -Eq \"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.default\\\\.disable_ipv6\\\\s*=\\\\s*1\\\\b(\\\\s+#.*)?$\" && passing=\"true\"\nif [ \"$passing\" = true ] ; then\n\techo \"IPv6 is disabled on the system\"\nelse\n\techo \"IPv6 is enabled on the system\"\nfi\n}",
        "expect": "IPv6 is enabled on the system"
    },
    "custom_item_285": {
        "description": "3.5.3.3.4 Ensure IPv6 firewall rules exist for all open ports",
        "info": "Any ports that have been opened on non-loopback addresses need firewall rules to govern traffic.\n\nWithout a firewall rule configured for open ports default firewall policy will drop all packets to these ports.\n\nNotes:\n\n - Changing firewall settings while connected over network can result in being locked out of the system.\n - The remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any restrictions in compliance with site policy.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections:\n\n# ip6tables -A INPUT -p--dport-m state --state NEW -j ACCEPT",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/usr/bin/ss -6tuln; /usr/sbin/ip6tables -L INPUT -v -n",
        "expect": "^Manual Review Required$"
    },
    "custom_item_286": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_287": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_288": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_289": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_290": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_291": {
        "description": "4.2.1.1 Ensure rsyslog is installed",
        "info": "The rsyslog software is a recommended replacement to the original syslogd daemon.\n\nrsyslog provides improvements over syslogd including:\n\n - connection-oriented (i.e. TCP) transmission of logs\n - The option to log to database formats\n - Encryption of log data en route to a central logging server\n\nThe security enhancements of rsyslog such as connection-oriented (i.e. TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server) justify installing and configuring the package.",
        "solution": "Run the following command to install rsyslog:\n\n# zypper install rsyslog",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_292": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_293": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_294": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_295": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_296": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_297": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_298": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_299": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_300": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_301": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_302": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_303": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_304": {
        "description": "4.2.1.3 Ensure rsyslog default file permissions configured",
        "info": "rsyslog will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files.\n\nThe $FileCreateMode parameter specifies the file creation mode with which rsyslogd creates new files. If not specified, the value 0644 is used.\n\nNotes:\n\n -\n\nThe value given must always be a 4-digit octal number, with the initial digit being zero.\n\n -\n\nThis setting can be overridden by a less restrictive setting in any file ending inconf in the /etc/rsyslog.d/ directory\n\nIt is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.",
        "solution": "Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and set $FileCreateMode to 0640 or more restrictive:\n\n$FileCreateMode 0640",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\$FileCreateMode",
        "expect": "\\\\$FileCreateMode 0[0246][04]0[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_305": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_306": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_307": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_308": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_309": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_310": {
        "description": "news.err",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*news\\\\.err",
        "expect": "news\\\\.err[\\\\s]+-@LOG_NEWS_ERR@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_311": {
        "description": "'mail.err /var/log/mail.err'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*mail\\\\.err",
        "expect": "mail\\\\.err[\\\\s]+@LOG_MAIL_ERR@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_312": {
        "description": "'local6,local7.* -/var/log/localmessages'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*local6,local7",
        "expect": "local6,local7\\\\.\\\\*[\\\\s]+-@LOG_LOCALMESSAGES@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_313": {
        "description": "'auth,authpriv.* /var/log/secure'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*auth,authpriv\\\\.\\\\*",
        "expect": "auth,authpriv\\\\.\\\\*[\\\\s]+@LOG_SECURE@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_314": {
        "description": "'local2,local3.* -/var/log/localmessages'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*local2,local3",
        "expect": "local2,local3\\\\.\\\\*[\\\\s]+-@LOG_LOCALMESSAGES@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_315": {
        "description": "'*.=warning;*.=err -/var/log/warn'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\*\\\\.=warning;\\\\*\\\\.=err",
        "expect": "\\\\*\\\\.=warning;\\\\*\\\\.=err[\\\\s]+-@LOG_WARN@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_316": {
        "description": "'*.emerg :omusrmsg:*'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\*\\\\.emerg",
        "expect": "\\\\*\\\\.emerg\\\\s+:omusrmsg:\\\\*$",
        "min_occurrences": "1"
    },
    "custom_item_317": {
        "description": "'mail.info -/var/log/mail.info'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*mail\\\\.info",
        "expect": "mail\\\\.info[\\\\s]+-@LOG_MAIL_INFO@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_318": {
        "description": "news.notice",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*news\\\\.notice",
        "expect": "news\\\\.notice[\\\\s]+-@LOG_NEWS_NOTICE@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_319": {
        "description": "'mail.* -/var/log/mail'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*mail\\\\.\\\\*",
        "expect": "mail\\\\.\\\\*[\\\\s]+-@LOG_MAIL@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_320": {
        "description": "'*.crit /var/log/warn'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\*\\\\.crit",
        "expect": "\\\\*\\\\.crit[\\\\s]+@LOG_WARN@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_321": {
        "description": "news.crit",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*news\\\\.crit",
        "expect": "news\\\\.crit[\\\\s]+-@LOG_NEWS_CRIT@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_322": {
        "description": "'mail.warning -/var/log/mail.warn'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*mail\\\\.warning",
        "expect": "mail\\\\.warning[\\\\s]+-@LOG_MAIL_WARN@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_323": {
        "description": "'*.*;mail.none;news.none -/var/log/messages'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\*\\\\.\\\\*;mail\\.none;news\\\\.none",
        "expect": "\\\\*\\\\.\\\\*;mail\\\\.none;news\\\\.none[\\\\s]+-@LOG_MESSAGES@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_324": {
        "description": "'local4,local5.* -/var/log/localmessages'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*local4,local5",
        "expect": "local4,local5\\\\.\\\\*[\\\\s]+-@LOG_LOCALMESSAGES@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_325": {
        "description": "'local0,local1.* -/var/log/localmessages'",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*local0,local1",
        "expect": "local0,local1\\\\.\\\\*[\\\\s]+-@LOG_LOCALMESSAGES@[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_326": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_327": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_328": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_329": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_330": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_331": {
        "description": "rsyslog new format",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^\\\\s*([^#]+\\\\s+)?action\\\\(([^#]+\\\\s+)?\\\\btarget=\\\\\"?[^#\"]+\\\\\"?\\\\b",
        "expect": "^\\\\s*([^#]+\\\\s+)?action\\\\(([^#]+\\\\s+)?\\\\btarget=\\\\\"?[^#\"]+\\\\\"?\\\\b",
        "min_occurrences": "1"
    },
    "custom_item_332": {
        "description": "rsyslog old format",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^\\\\s*[^#]+\\\\.\\\\*\\\\s+@",
        "expect": "^\\\\s*[^#]+\\\\.\\\\*\\\\s+@",
        "min_occurrences": "1"
    },
    "custom_item_333": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_334": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_335": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_336": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_337": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_338": {
        "description": "Old format ModLoad imtcp",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\$ModLoad imtcp",
        "expect": "^Manual Review Required$"
    },
    "custom_item_339": {
        "description": "Old format InputTCPServerRun",
        "file": "/etc/rsyslog.conf /etc/rsyslog.d/*.conf",
        "regex": "^[\\\\s]*\\\\$InputTCPServerRun",
        "expect": "^Manual Review Required$"
    },
    "custom_item_340": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_341": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_342": {
        "description": "rsyslog check - installed",
        "rpm": "rsyslog-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_343": {
        "description": "enabled",
        "cmd": "/bin/systemctl is-enabled rsyslog",
        "expect": "^enabled$"
    },
    "custom_item_344": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_345": {
        "description": "4.2.2.1 Ensure journald is configured to send logs to rsyslog",
        "info": "Data from journald may be stored in volatile memory or persisted locally on the server. Utilities exist to accept remote export of journald logs, however, use of the rsyslog service provides a consistent means of log collection and export.\n\nNotes:\n\n -\n\nThis recommendation assumes that recommendation 4.2.1.5, \"Ensure rsyslog is configured to send logs to a remote log host\" has been implemented.\n\n -\n\nThe main configuration file /etc/systemd/journald.conf is read before any of the custom *.conf files. If there are custom configs present, they override the main configuration parameters\n\n -\n\nAs noted in the journald man pages: journald logs may be exported to rsyslog either through the process mentioned here, or through a facility like systemd-journald.service There are trade-offs involved in each implementation, where ForwardToSyslog will immediately capture all events (and forward to an external log server, if properly configured), but may not capture all boot-up activities. Mechanisms such as systemd-journald.service on the other hand, will record bootup events, but may delay sending the information to rsyslog, leading to the potential for log manipulation prior to export. Be aware of the limitations of all tools employed to secure a system.\n\nStoring log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.",
        "solution": "Edit the /etc/systemd/journald.conf file and add the following line:\n\nForwardToSyslog=yes",
        "reference": "800-171|3.3.1,800-171|3.3.5,800-53|AU-6(3),800-53r5|AU-6(3),CN-L3|7.1.3.3(d),CSCv7|6.5,CSCv8|8.9,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6(3),LEVEL|1A,NESA|M5.2.5,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/systemd/journald.conf",
        "regex": "^[\\\\s]*ForwardToSyslog[\\\\s]*=",
        "expect": "^[\\\\s]*ForwardToSyslog[\\\\s]*=[\\\\s]*['\"]?yes[\"']?[\\\\s]*$"
    },
    "custom_item_346": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_347": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_348": {
        "description": "journald check - enabled",
        "cmd": "/bin/systemctl is-enabled systemd-journald.service",
        "expect": "^static$"
    },
    "custom_item_349": {
        "description": "4.2.2.2 Ensure journald is configured to compress large log files",
        "info": "The journald system includes the capability of compressing overly large files to avoid filling up the system with logs or making the log's size unmanageable.\n\nNote: The main configuration file /etc/systemd/journald.conf is read before any of the custom *.conf files. If there are custom configs present, they override the main configuration parameters\n\nUncompressed large files may unexpectedly fill a filesystem leading to resource unavailability. Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.",
        "solution": "Edit the /etc/systemd/journald.conf file and add the following line:\n\nCompress=yes",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/systemd/journald.conf",
        "regex": "^[\\\\s]*Compress[\\\\s]*=",
        "expect": "^[\\\\s]*Compress[\\\\s]*=[\\\\s]*['\"]?no[\"']?[\\\\s]*$"
    },
    "custom_item_350": {
        "description": "journald check - active",
        "cmd": "/bin/systemctl is-active systemd-journald.service",
        "expect": "^active$"
    },
    "custom_item_351": {
        "description": "active",
        "cmd": "/bin/systemctl is-active rsyslog",
        "expect": "^active$"
    },
    "custom_item_352": {
        "description": "journald check - enabled",
        "cmd": "/bin/systemctl is-enabled systemd-journald.service",
        "expect": "^static$"
    },
    "custom_item_353": {
        "description": "4.2.2.3 Ensure journald is configured to write logfiles to persistent disk",
        "info": "Data from journald may be stored in volatile memory or persisted locally on the server. Logs in memory will be lost upon a system reboot. By persisting logs to local disk on the server they are protected from loss.\n\nNote: The main configuration file /etc/systemd/journald.conf is read before any of the custom *.conf files. If there are custom configs present, they override the main configuration parameters\n\nWriting log data to disk will provide the ability to forensically reconstruct events which may have impacted the operations or security of a system even after a system crash or reboot.",
        "solution": "Edit the /etc/systemd/journald.conf file and add the following line:\n\nStorage=persistent",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",
        "regex": "^[\\\\s]*Storage[\\\\s]*=",
        "expect": "^[\\\\s]*Storage[\\\\s]*=[\\\\s]*['\"]?persistent[\"']?[\\\\s]*$",
        "min_occurrences": "1"
    },
    "custom_item_354": {
        "description": "4.2.3 Ensure permissions on all logfiles are configured",
        "info": "Log files stored in /var/log/ contain logged information from many services on the system, or on log hosts others as well.\n\nIt is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected. Other/world should not have the ability to view this information. Group should not have the ability to modify this information.",
        "solution": "Run the following commands to set permissions on all existing log files:\n\nfind /var/log -type f -exec chmod g-wx,o-rwx \"{}\" + -o -type d -exec chmod g-wx,o-rwx \"{}\" +\n\nNote: The configuration for your logging software or services may need to also be modified for any logs that had incorrect permissions, otherwise, the permissions may be reverted to the incorrect permissions",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/find /var/log -xdev -type f -perm /g+wx,o+rwx -ls | /bin/awk '{print} END {if (NR == 0) print\"pass\"; else print \"fail\"}'",
        "expect": "^pass$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_355": {
        "description": "Check if cron is installed",
        "rpm": "cron-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_356": {
        "description": "systemctl status cron",
        "cmd": "/bin/systemctl status cron | /bin/grep \"Active: \" | /bin/grep -v \"active (running) \" | /bin/awk '{print} END {if (NR == 0) print \"pass\";}'",
        "expect": "^pass$"
    },
    "custom_item_357": {
        "description": "systemctl is-enabled cron",
        "cmd": "/bin/systemctl is-enabled cron",
        "expect": "enabled"
    },
    "custom_item_358": {
        "description": "5.1.1 Ensure cron daemon is enabled and running",
        "info": "The cron daemon is used to execute batch jobs on the system.\n\nWhile there may not be user jobs that need to be run on the system, the system does have maintenance jobs that may include security monitoring that have to run. If another method for scheduling tasks is not being used, cron is used to execute them, and needs to be enabled and running.",
        "solution": "Run the following command to enable and start cron :\n\n# systemctl --now enable cron",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "cron-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_359": {
        "description": "Check if cron is installed",
        "rpm": "cron-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_360": {
        "description": "5.1.2 Ensure permissions on /etc/crontab are configured",
        "info": "The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.\n\nThis file contains information on what system jobs are run by cron. Write access to these files could provide unprivileged users with the ability to elevate their privileges. Read access to these files could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.",
        "solution": "Run the following commands to set ownership and permissions on /etc/crontab :\n\n# chown root:root /etc/crontab\n\n# chmod u-x,og-rwx /etc/crontab\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/crontab",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_361": {
        "description": "5.1.2 Ensure permissions on /etc/crontab are configured",
        "info": "The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.\n\nThis file contains information on what system jobs are run by cron. Write access to these files could provide unprivileged users with the ability to elevate their privileges. Read access to these files could provide users with the ability to gain insight on system jobs that run on the system and could provide them a way to gain unauthorized privileged access.",
        "solution": "Run the following commands to set ownership and permissions on /etc/crontab :\n\n# chown root:root /etc/crontab\n\n# chmod u-x,og-rwx /etc/crontab\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "rpm": "cron-0.0.0-0",
        "operator": "lte"
    },
    "custom_item_362": {
        "description": "Check if cronie is installed",
        "rpm": "cronie-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_363": {
        "description": "5.1.3 Ensure permissions on /etc/cron.hourly are configured",
        "info": "This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\n\nGranting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
        "solution": "Run the following commands to set ownership and permissions on the /etc/cron.hourly/ directory:\n\n# chown root:root /etc/cron.hourly/\n\n# chmod og-rwx /etc/cron.hourly/\n\nOR\n\nRun the following command to remove cron\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/cron.hourly",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_364": {
        "description": "Check if cronie is installed",
        "rpm": "cronie-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_365": {
        "description": "5.1.4 Ensure permissions on /etc/cron.daily are configured",
        "info": "The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\n\nGranting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
        "solution": "Run the following commands to set ownership and permissions on /etc/cron.daily directory:\n\n# chown root:root /etc/cron.daily\n\n# chmod og-rwx /etc/cron.daily\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/cron.daily",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_366": {
        "description": "Check if cronie is installed",
        "rpm": "cronie-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_367": {
        "description": "5.1.5 Ensure permissions on /etc/cron.weekly are configured",
        "info": "The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\n\nGranting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
        "solution": "Run the following commands to set ownership and permissions on /etc/cron.weekly/ directory:\n\n# chown root:root /etc/cron.weekly/\n\n# chmod og-rwx /etc/cron.weekly/\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/cron.weekly",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_368": {
        "description": "Check if cronie is installed",
        "rpm": "cronie-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_369": {
        "description": "5.1.6 Ensure permissions on /etc/cron.monthly are configured",
        "info": "The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\n\nGranting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
        "solution": "Run the following commands to set ownership and permissions on /etc/cron.monthly directory:\n\n# chown root:root /etc/cron.monthly\n\n# chmod og-rwx /etc/cron.monthly\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/cron.monthly",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_370": {
        "description": "Check if cronie is installed",
        "rpm": "cronie-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_371": {
        "description": "5.1.7 Ensure permissions on /etc/cron.d are configured",
        "info": "The /etc/cron.d/ directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\n\nGranting write access to this directory for non-privileged users could provide them the means for gaining unauthorized elevated privileges. Granting read access to this directory could give an unprivileged user insight in how to gain elevated privileges or circumvent auditing controls.",
        "solution": "Run the following commands to set ownership and permissions on /etc/cron.d directory:\n\n# chown root:root /etc/cron.d\n\n# chmod og-rwx /etc/cron.d\n\nOR\n\nRun the following command to remove cron :\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/cron.d",
        "owner": "root",
        "mask": "077",
        "group": "root"
    },
    "custom_item_372": {
        "description": "5.1.8 Ensure cron is restricted to authorized users",
        "info": "If cron is installed in the system, configure /etc/cron.allow to allow specific users to use these services. If /etc/cron.allow does not exist, then /etc/cron.deny is checked. Any user not specifically defined in those files is allowed to use cron. By removing the file, only users in /etc/cron.allow are allowed to use cron.\n\nNote: Even though a given user is not listed in cron.allow cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs.\n\nOn many systems, only the system administrator is authorized to schedule cron jobs. Using the cron.allow file to control who can run cron jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.",
        "solution": "Run the following command to remove /etc/cron.deny :\n\n# rm /etc/cron.deny\n\nRun the following command to create /etc/cron.allow\n\n# touch /etc/cron.allow\n\nRun the following commands to set the owner and permissions on /etc/cron.allow :\n\n# chown root:root /etc/cron.allow\n\n# chmod u-x,og-rwx /etc/cron.allow\n\nOR\n\nRun the following command to remove cron\n\n# zypper remove cronie",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n{\n   if rpm -q cronie >/dev/null; then\n      [ -e /etc/cron.deny ] && echo \"Fail: cron.deny exists\"\n      if [ ! -e /etc/cron.allow ]; then\n         echo \"Fail: cron.allow doesn't exist\"\n      else\n         ! stat -Lc \"%a\" /etc/cron.allow | grep -Eq \"[0,2,4,6]00\" && echo \"Fail: cron.allow mode too permissive\"\n         ! stat -Lc \"%u:%g\" /etc/cron.allow | grep -Eq \"^0:0$\" && echo \"Fail: cron.allow owner and/or group not root\"\n      fi\n      if [ ! -e /etc/cron.deny ] && [ -e /etc/cron.allow ] && stat -Lc \"%a\" /etc/cron.allow | grep -Eq \"[0,2,4,6]00\" \\\\\n         && stat -Lc \"%u:%g\" /etc/cron.allow | grep -Eq \"^0:0$\"; then\n         echo \"Pass\"\n      fi\n   else\n      echo \"Pass: cron is not installed on the system\"\n   fi\n}",
        "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*pass:?[\\\\s]*\\\\**$"
    },
    "custom_item_373": {
        "description": "5.1.9 Ensure at is restricted to authorized users",
        "info": "If at is installed in the system, configure /etc/at.allow to allow specific users to use these services. If /etc/at.allow does not exist, then /etc/at.deny is checked. Any user not specifically defined in those files is allowed to use at. By removing the file, only users in /etc/at.allow are allowed to use at.\n\nNote: Even though a given user is not listed in at.allow at jobs can still be run as that user. The at.allow file only controls administrative access to the at command for scheduling and modifying at jobs.\n\nOn many systems, only the system administrator is authorized to schedule at jobs. Using the at.allow file to control who can run at jobs enforces this policy. It is easier to manage an allow list than a deny list. In a deny list, you could potentially add a user ID to the system and forget to add it to the deny files.",
        "solution": "Run the following command to remove /etc/at.deny :\n\n# rm /etc/at.deny\n\nRun the following command to create /etc/at.allow\n\n# touch /etc/at.allow\n\nRun the following commands to set the owner and permissions on /etc/at.allow :\n\n# chown root:root /etc/at.allow\n\n# chmod u-x,og-rwx /etc/at.allow\n\nOR\n\nRun the following command to remove at :\n\n# zypper remove at",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n{\n   if rpm -q at >/dev/null; then\n      [ -e /etc/at.deny ] && echo \"Fail: at.deny exists\"\n      if [ ! -e /etc/at.allow ]; then\n         echo \"Fail: at.allow doesn't exist\"\n      else\n         ! stat -Lc \"%a\" /etc/at.allow | grep -Eq \"[0,2,4,6]00\" && echo \"Fail: at.allow mode too permissive\"\n         ! stat -Lc \"%u:%g\" /etc/at.allow | grep -Eq \"^0:0$\" && echo \"Fail: at.allow owner and/or group not root\"\n      fi\n      if [ ! -e /etc/at.deny ] && [ -e /etc/at.allow ] && stat -Lc \"%a\" /etc/at.allow | grep -Eq \"[0,2,4,6]00\" \\\\\n         && stat -Lc \"%u:%g\" /etc/at.allow | grep -Eq \"^0:0$\"; then\n         echo \"Pass\"\n      fi\n   else\n      echo \"Pass: at is not installed on the system\"\n   fi\n}",
        "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*pass:?"
    },
    "custom_item_374": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_375": {
        "description": "5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured",
        "info": "The /etc/ssh/sshd_config file contains configuration specifications for sshd The command below sets the owner and group of the file to root.\n\nThe /etc/ssh/sshd_config file needs to be protected from unauthorized changes by non-privileged users.",
        "solution": "Run the following commands to set ownership and permissions on /etc/ssh/sshd_config :\n\n# chown root:root /etc/ssh/sshd_config\n\n# chmod og-rwx /etc/ssh/sshd_config",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/ssh/sshd_config",
        "owner": "root",
        "mask": "177",
        "group": "root"
    },
    "custom_item_376": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_377": {
        "description": "5.2.10 Ensure SSH root login is disabled",
        "info": "The PermitRootLogin parameter specifies if the root user can log in using ssh. The default is no.\n\nDisallowing root logins over SSH requires system admins to authenticate using their own individual account, then escalating to root via sudo or su This in turn limits opportunity for non-repudiation and provides a clear audit trail in the event of a security incident",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nPermitRootLogin no",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^permitrootlogin)\"; done | /bin/awk 'BEGIN {f=0} /permitrootlogin/i { if ($NF == \"yes\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\"}'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_378": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_379": {
        "description": "5.2.11 Ensure SSH PermitEmptyPasswords is disabled",
        "info": "The PermitEmptyPasswords parameter specifies if the SSH server allows login to accounts with empty password strings.\n\nDisallowing remote shell access to accounts that have an empty password reduces the probability of unauthorized access to the system",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nPermitEmptyPasswords no",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|16.3,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^PermitEmptyPasswords)\"; done | /bin/awk 'BEGIN {f=0} /PermitEmptyPasswords/i { if ($NF == \"yes\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass"
    },
    "custom_item_380": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_381": {
        "description": "5.2.12 Ensure SSH PermitUserEnvironment is disabled",
        "info": "The PermitUserEnvironment option allows users to present environment options to the ssh daemon.\n\nPermitting users the ability to set environment variables through the SSH daemon could potentially allow users to bypass security controls (e.g. setting an execution path that has ssh executing a Trojan's programs)",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nPermitUserEnvironment no",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^permituserenvironment)\"; done | /bin/awk 'BEGIN {f=0} /permituserenvironment/i { if ($NF == \"yes\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_382": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_383": {
        "description": "5.2.13 Ensure only strong Ciphers are used",
        "info": "This variable limits the ciphers that SSH can use during communication.\n\nNotes:\n\n -\n\nSome organizations may have stricter requirements for approved ciphers. Ensure that ciphers used are in compliance with site policy\n\n -\n\nThe only \"strong\" ciphers currently FIPS 140-2 compliant are: aes256-ctr,aes192-ctr,aes128-ctr\n\n -\n\nCVE-2013-4548 referenced bellow applies to OpenSSH versions 6.2 and 6.3. If running these versions of Open SSH, Please upgrade to version 6.4 or later to fix the vulnerability, or disable AES-GCM in the server configuration\n\nThe Following are the supported ciphers in openSSH 7.9:\n\n3des-cbc\naes128-cbc\naes192-cbc\naes256-cbc\naes128-ctr\naes192-ctr\naes256-ctr\naes128-gcm@openssh.com\naes256-gcm@openssh.com\nchacha20-poly1305@openssh.com\n\nWeak ciphers that are used for authentication to the cryptographic module cannot be relied upon to provide confidentiality or integrity, and system data may be compromised.\n\n - The DES, Triple DES, and Blowfish ciphers, as used in SSH, have a birthday bound of approximately four billion blocks, which makes it easier for remote attackers to obtain cleartext data via a birthday attack against a long-duration encrypted session, aka a \"Sweet32\" attack\n - The RC4 algorithm, as used in the TLS protocol and SSL protocol, does not properly combine state data with key data during the initialization phase, which makes it easier for remote attackers to conduct plaintext-recovery attacks against the initial bytes of a stream by sniffing network traffic that occasionally relies on keys affected by the Invariance Weakness, and then using a brute-force approach involving LSB values, aka the \"Bar Mitzvah\" issue\n - The passwords used during an SSH session encrypted with RC4 can be recovered by an attacker who is able to capture and replay the session\n - Error handling in the SSH protocol; Client and Server, when using a block cipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for remote attackers to recover certain plaintext data from an arbitrary block of ciphertext in an SSH session via unknown vectors\n - The mm_newkeys_from_blob function in monitor_wrap.c, when an AES-GCM cipher is used, does not properly initialize memory for a MAC context data structure, which allows remote authenticated users to bypass intended ForceCommand and login-shell restrictions via packet data that provides a crafted callback address",
        "solution": "Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to contain a comma separated list of the site approved ciphers\n\nExample:\n\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n{\n\tports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ciphers)\"; done | /bin/awk 'BEGIN {f=0} /ciphers/i { if ($NF ~ \"(3des-cbc|aes128-cbc|aes192-cbc|aes256-cbc)\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n}",
        "expect": "^Pass$"
    },
    "custom_item_384": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_385": {
        "description": "5.2.14 Ensure only strong MAC algorithms are used",
        "info": "This variable limits the types of MAC algorithms that SSH can use during communication.\n\nNotes:\n\n -\n\nSome organizations may have stricter requirements for approved MACs. Ensure that MACs used are in compliance with site policy\n\n -\n\nThe only \"strong\" MACs currently FIPS 140-2 approved are hmac-sha2-256 and hmac-sha2-512\n\nThe Supported MACs are:\n\nhmac-md5\nhmac-md5-96\nhmac-sha1\nhmac-sha1-96\nhmac-sha2-256\nhmac-sha2-512\numac-64@openssh.com\numac-128@openssh.com\nhmac-md5-etm@openssh.com\nhmac-md5-96-etm@openssh.com\nhmac-sha1-etm@openssh.com\nhmac-sha1-96-etm@openssh.com\nhmac-sha2-256-etm@openssh.com\nhmac-sha2-512-etm@openssh.com\numac-64-etm@openssh.com\numac-128-etm@openssh.com\n\nMD5 and 96-bit MAC algorithms are considered weak and have been shown to increase exploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algorithm could take advantage of a MiTM position to decrypt the SSH tunnel and capture credentials and information",
        "solution": "Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma separated list of the site approved MACs\n\nExample:\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|14.4,CSCv7|16.5,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n{\nports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -Ei '^macs\\\\s')\"; done | /bin/awk 'BEGIN {f=0} /\\\\smacs\\\\s/i { if ($NF ~ \"(hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1|hmac-sha1-96|umac-64@openssh.com|umac-128@openssh.com|hmac-md5-etm@openssh.com|hmac-md5-96-etm@openssh.com|hmac-ripemd160-etm@openssh.com|hmac-sha1-etm@openssh.com|hmac-sha1-96-etm@openssh.com|umac-64-etm@openssh.com|umac-128-etm@openssh.com)\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n}",
        "expect": "^Pass$"
    },
    "custom_item_386": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_387": {
        "description": "5.2.15 Ensure only strong Key Exchange algorithms are used",
        "info": "Key exchange is any method in cryptography by which cryptographic keys are exchanged between two parties, allowing use of a cryptographic algorithm. If the sender and receiver wish to exchange encrypted messages, each must be equipped to encrypt messages to be sent and decrypt messages received\n\nNotes:\n\nKex algorithms have a higher preference the earlier they appear in the list\n\n - Some organizations may have stricter requirements for approved Key exchange algorithms. Ensure that Key exchange algorithms used are in compliance with site policy.\n - The only Key Exchange Algorithms currently FIPS 140-2 approved are: ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256\n\nThe Key Exchange algorithms supported by OpenSSH 7.9 are:\n\ncurve25519-sha256\ncurve25519-sha256@libssh.org\ndiffie-hellman-group1-sha1\ndiffie-hellman-group14-sha1\ndiffie-hellman-group14-sha256\ndiffie-hellman-group16-sha512\ndiffie-hellman-group18-sha512\ndiffie-hellman-group-exchange-sha1\ndiffie-hellman-group-exchange-sha256\necdh-sha2-nistp256\necdh-sha2-nistp384\necdh-sha2-nistp521\n\nKey exchange methods that are considered weak should be removed. A key exchange method may be weak because too few bits are used, or the hashing algorithm is considered too weak. Using weak algorithms could expose connections to man-in-the-middle attacks",
        "solution": "Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to contain a comma separated list of the site approved key exchange algorithms\n\nExample\n\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|14.4,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^kexalgorithms)\"; done | /bin/awk 'BEGIN {f=0} /kexalgorithms/i { if ($NF ~ \"(diffie-hellman-group1-sha1|diffie-hellman-group14-sha1|diffie-hellman-group-exchange-sha1)\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_388": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_389": {
        "description": "sshd -T clientaliveinterval",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^clientaliveinterval)\"; done | /bin/awk 'BEGIN {f=0} /clientaliveinterval/i { if ($NF !~ /^([1-9]|[1-8][0-9]|9[0-9]|[12][0-9]{2}|300)$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_390": {
        "description": "sshd -T clientalivecountmax",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^clientalivecountmax)\"; done | /bin/awk 'BEGIN {f=0} /clientalivecountmax/i { if ($NF !~ /^[0-3]$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_391": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_392": {
        "description": "5.2.17 Ensure SSH LoginGraceTime is set to one minute or less",
        "info": "The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.\n\nSetting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nLoginGraceTime 60",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^logingracetime)\"; done | /bin/awk 'BEGIN {f=0} /logingracetime/i { if ($NF !~ /^([1-9]|[1-5][0-9]|60|1m)$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_393": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_394": {
        "description": "5.2.18 Ensure SSH warning banner is configured",
        "info": "The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.\n\nBanners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nBanner /etc/issue.net",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^banner)\"; done | /bin/awk 'BEGIN {f=0} /banner/i { if ($NF != \"/etc/issue.net\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_395": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_396": {
        "description": "5.2.19 Ensure SSH PAM is enabled",
        "info": "UsePAM Enables the Pluggable Authentication Module interface. If set to \"yes\" this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types\n\nWhen usePAM is set to yes, PAM runs through account and session types properly. This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment variables on login or disallow access to the server",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nUsePAM yes\n\nImpact:\n\nIf UsePAM is enabled, you will not be able to run sshd(8) as a non-root user.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^usepam)\"; done | /bin/awk 'BEGIN {f=0} /usepam/i { if ($NF == \"no\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_397": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_398": {
        "description": "5.2.2 Ensure permissions on SSH private host key files are configured",
        "info": "An SSH private key is one of two files used in SSH public key authentication. In this authentication method, The possession of the private key is proof of identity. Only a private key that corresponds to a public key will be able to authenticate successfully. The private keys need to be stored and handled carefully, and no copies of the private key should be distributed.\n\nIf an unauthorized user obtains the private SSH host key file, the host could be impersonated",
        "solution": "Run the following commands to set permissions, ownership, and group on the private SSH host key files:\n\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod u-x,g-wx,o-rwx {} \\;\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:ssh_keys {} \\;",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec /bin/stat -c '\\%a \\%n \\%U \\%G' {} \\\\; | /bin/awk -F' ' 'BEGIN { f=0; print \"Octal, File, User, Group\"; } { printf \"%s, %s, %s, %s\",$1,$2,$3,$4; if($4 ~ \"root\"){ if ($3 ~ \"root\" && $1 ~ /[1-6]00/){ printf \" - pass\";} else { ++f; printf \" - fail\"; } } else if($4 ~ \"ssh_keys\"){ if ($3 ~ \"root\" &&  $1 ~ /[1-6][0-4]0/){ printf \" - pass\";} else { ++f; printf \" - fail\"; } } printf \"\\\\n\"; } END { if(f != 0){ print \"Failures found\"; } else { print \"All files pass\"; } }'",
        "expect": "^All files pass$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_399": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_400": {
        "description": "5.2.21 Ensure SSH MaxStartups is configured",
        "info": "The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.\n\nTo protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nmaxstartups 10:30:60",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^maxstartups)\"; done | /bin/awk 'BEGIN {f=0} /maxstartups/i { if ($NF !~ /^([1-9]|10):([1-9]|[12][0-9]|30):([1-9]|[1-5][0-9]|60)$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_401": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_402": {
        "description": "5.2.22 Ensure SSH MaxSessions is limited",
        "info": "The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.\n\nTo protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nMaxSessions 10",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^maxsessions)\"; done | /bin/awk 'BEGIN {f=0} /maxsessions/i { if ($NF !~ /^([0-9]|10)$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_403": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_404": {
        "description": "5.2.3 Ensure permissions on SSH public host key files are configured",
        "info": "An SSH public key is one of two files used in SSH public key authentication. In this authentication method, a public key is a key that can be used for verifying digital signatures generated using a corresponding private key. Only a public key that corresponds to a private key will be able to authenticate successfully.\n\nIf a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
        "solution": "Run the following commands to set permissions and ownership on the SSH host public key files\n\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod u-x,go-wx {} \\;\n#find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \\;",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/ssh/ssh_host_*_key.pub",
        "owner": "root",
        "mask": "7133",
        "group": "root"
    },
    "custom_item_405": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_406": {
        "description": "5.2.4 Ensure SSH access is limited",
        "info": "There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:\n\n - AllowUsers :\n - The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.\n\n - AllowGroups :\n - The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.\n\n - DenyUsers :\n - The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.\n\n - DenyGroups :\n - The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.\n\nRestricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.",
        "solution": "Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows:\n\nAllowUsersOR\n\nAllowGroupsOR\n\nDenyUsersOR\n\nDenyGroups",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.1.6,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|AC-6(2),800-53|AC-6(5),800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|AC-6(2),800-53r5|AC-6(5),800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.3,CSCv8|3.3,CSCv8|5.4,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.2.3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|AC-6(2),ITSG-33|AC-6(5),ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -Pi '^\\\\h*(allow|deny)(users|groups)\\\\h+\\\\H+(\\\\h+.*)?$')\"; done | /bin/awk 'BEGIN {f=0} /(allow|deny)(users|groups)/i { if ($NF ~ \":\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\"}'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_407": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_408": {
        "description": "5.2.5 Ensure SSH LogLevel is appropriate",
        "info": "INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.\n\nVERBOSE level specifies that login and logout activity as well as the key fingerprint for any SSH key used for login will be logged. This information is important for SSH key management, especially in legacy environments.\n\nSSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nLogLevel VERBOSE\n\nOR\n\nLogLevel INFO",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i loglevel)\"; done | /bin/awk 'BEGIN {f=0} /LogLevel/i { if ($NF !~ /^(INFO|VERBOSE)$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_409": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_410": {
        "description": "5.2.7 Ensure SSH MaxAuthTries is set to 4 or less",
        "info": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.\n\nSetting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nMaxAuthTries 4",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|16.13,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^maxauthtries)\"; done | /bin/awk 'BEGIN {f=0} /maxauthtries/i { if ($NF !~ /^[0-4]$/) f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_411": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_412": {
        "description": "5.2.8 Ensure SSH IgnoreRhosts is enabled",
        "info": "The IgnoreRhosts parameter specifies thatrhosts andshosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication\n\nSetting this parameter forces users to enter a password when authenticating with ssh.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nIgnoreRhosts yes",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|9.2,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^ignorerhosts)\"; done | /bin/awk 'BEGIN {f=0} /IgnoreRhosts/i { if ($NF == \"no\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass"
    },
    "custom_item_413": {
        "description": "openssh-server is installed",
        "rpm": "openssh-server-0.0.0-0",
        "operator": "gt"
    },
    "custom_item_414": {
        "description": "5.2.9 Ensure SSH HostbasedAuthentication is disabled",
        "info": "The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user ofrhosts or /etc/hosts.equiv along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.\n\nEven though therhosts files are ineffective if support is disabled in /etc/pam.conf disabling the ability to userhosts files in SSH provides an additional layer of protection.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nHostbasedAuthentication no",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|16.3,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  ports=$(/bin/grep -s -P \"^(Port|Match)\" /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf | /bin/grep -P -o \"(Port|LocalPort)[\\\\s]+[\\\\d]+\" | /bin/awk '{print $2}; END {if (NR == 0) print \"22\"}' | /usr/bin/uniq); for port in ${ports[@]}; do /usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /bin/awk '{print $1}')\" -C lport=$port | echo \"port $port: $(/bin/grep -i ^hostbasedauthentication)\"; done | /bin/awk 'BEGIN {f=0} /HostbasedAuthentication/i { if ($NF == \"yes\") f++; print $0} END {if (NR == 0) print \"Fail: no results returned\"; else if (f > 0) print \"Fail\"; else print \"Pass\" }'\n  }",
        "expect": "^Pass$"
    },
    "custom_item_415": {
        "description": "common-password ocredit",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*ocredit",
        "expect": "[\\\\s]+ocredit=@PASSWORD_OCREDIT@\\\\b"
    },
    "custom_item_416": {
        "description": "common-password lcredit",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*lcredit",
        "expect": "[\\\\s]+lcredit=@PASSWORD_LCREDIT@\\\\b"
    },
    "custom_item_417": {
        "description": "common-password minlen",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*minlen",
        "expect": "[\\\\s]+minlen=@PASSWORD_MINIMUM_LENGTH@\\\\b"
    },
    "custom_item_418": {
        "description": "common-password dcredit",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*dcredit",
        "expect": "[\\\\s]+dcredit=@PASSWORD_DCREDIT@\\\\b"
    },
    "custom_item_419": {
        "description": "common-password ucredit",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*ucredit",
        "expect": "[\\\\s]+ucredit=@PASSWORD_UCREDIT@\\\\b"
    },
    "custom_item_420": {
        "description": "login - deny",
        "file": "/etc/pam.d/login",
        "regex": "^[\\\\s]*auth[\\\\s]+required[\\\\s]+pam_tally2\\\\.so.*deny=",
        "expect": "^[\\\\s]*auth[\\\\s]+required[\\\\s]+pam_tally2\\\\.so.*deny=@PASSWORD_DENY@\\\\b"
    },
    "custom_item_421": {
        "description": "login - try_first_pass",
        "file": "/etc/pam.d/login",
        "regex": "^[\\\\s]*auth[\\\\s]+required[\\\\s]+pam_unix\\\\.so.*",
        "expect": "^[\\\\s]*auth[\\\\s]+required[\\\\s]+pam_unix\\\\.so.*try_first_pass\\\\b"
    },
    "custom_item_422": {
        "description": "common-account - pam_tally2",
        "file": "/etc/pam.d/common-account",
        "regex": "^[\\\\s]*account[\\\\s]+required[\\\\s]+pam_tally2\\\\.so",
        "expect": "^[\\\\s]*account[\\\\s]+required[\\\\s]+pam_tally2\\\\.so"
    },
    "custom_item_423": {
        "description": "5.3.3 Ensure password reuse is limited",
        "info": "The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.\n\nNotes:\n\n -\n\nAdditional module options may be set, recommendation only covers those listed here.\n\n -\n\nThis setting only applies to local accounts.\n\n -\n\nThis option is configured with the remember=\n\nn\n\nmodule option in /etc/pam.d/common-password\n\nForcing users not to reuse their past passwords make it less likely that an attacker will be able to guess the password.",
        "solution": "Run the following command:\n\n# pam-config -a --pwhistory --pwhistory-remember=5\n\nOR\n\nEdit the file /etc/pam.d/common-password to include the remember= option and conform to site policy as shown:\n\npassword required pam_pwhistory.so remember=5",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/pam.d/common-password",
        "regex": "^[\\\\s]*password[\\\\s]+(requisite|required).*remember",
        "expect": "remember[\\\\s]*=[\\\\s]*@PASSWORD_REUSE@"
    },
    "custom_item_424": {
        "description": "5.4.1.1 Ensure password hashing algorithm is SHA-512",
        "info": "Login passwords are hashed and stored in the /etc/shadow file.\n\nNote:\n\nThese changes only apply to accounts configured on the local system.\n\nThe SHA-512 algorithm provides much stronger hashing than MD5, thus providing additional protection to the system by increasing the level of effort for an attacker to successfully determine passwords.",
        "solution": "Edit the /etc/login.defs file and modify ENCRYPT_METHOD to SHA512 :\n\nENCRYPT_METHOD sha512\n\nNotes:\n\n -\n\nAny system accounts that need to be expired should be carefully done separately by the system administrator to prevent any potential problems\n\n -\n\nIf it is determined that the password algorithm being used is not SHA-512, once it is changed, it is recommended that all user ID's be immediately expired and forced to change their passwords on next login, In accordance with local site policies\n\n -\n\nTo accomplish this, the following command can be used\n\n# awk -F: '( $3<'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' && $1 != \"nfsnobody\" ) { print $1 }' /etc/passwd | xargs -n 1 chage -d 0",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*ENCRYPT_METHOD[\\\\s]+",
        "expect": "^[\\\\s]*ENCRYPT_METHOD[\\\\s]+@PASSWORD_ENCRYPTION@[\\\\s]*$"
    },
    "custom_item_425": {
        "description": "shadow password max days",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){4}@PASSWORD_MAX_DAYS@:"
    },
    "custom_item_426": {
        "description": "login.defs - PASSWORD_MAX_DAYS",
        "file": "/etc/login.defs",
        "regex": "(?i)^[\\\\s]*PASS_MAX_DAYS[\\\\s]+",
        "expect": "(?i)PASS_MAX_DAYS[\\\\s]+@PASSWORD_MAX_DAYS@[\\\\s]*$"
    },
    "custom_item_427": {
        "description": "shadow - password min days",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){3}@PASSWORD_MIN_DAYS@:"
    },
    "custom_item_428": {
        "description": "login.defs - PASS_MIN_DAYS",
        "file": "/etc/login.defs",
        "regex": "(?i)^[\\\\s]*PASS_MIN_DAYS[\\\\s]+",
        "expect": "(?i)PASS_MIN_DAYS[\\\\s]+@PASSWORD_MIN_DAYS@[\\\\s]*$"
    },
    "custom_item_429": {
        "description": "login.defs - PASSWORD_WARN_AGE",
        "file": "/etc/login.defs",
        "regex": "(?i)^[\\\\s]*PASS_WARN_AGE[\\\\s]+",
        "expect": "(?i)PASS_WARN_AGE[\\\\s]+@PASSWORD_WARN_AGE@[\\\\s]*$"
    },
    "custom_item_430": {
        "description": "shadow password warn age",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){5}@PASSWORD_WARN_AGE@:"
    },
    "custom_item_431": {
        "description": "useradd - INACTIVE",
        "cmd": "/usr/sbin/useradd -D | /bin/grep INACTIVE",
        "expect": "^[\\\\s]*INACTIVE[\\\\s]*=[\\\\s]*@INACTIVE_PASSWORD_LOCK@[\\\\s]*$"
    },
    "custom_item_432": {
        "description": "shadow inactive password lock",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){6}@INACTIVE_PASSWORD_LOCK@:"
    },
    "custom_item_433": {
        "description": "5.4.1.6 Ensure all users last password change date is in the past",
        "info": "All users should have a password change date in the past.\n\nIf a users recorded password change date is in the future then they could bypass any set password expiration.",
        "solution": "Investigate any users with a password change date in the future and correct them. Locking the account, expiring the password, or resetting the password manually may be appropriate.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n    for usr in $(cut -d: -f1 /etc/shadow); do [[ $(date -d \"$(chage --list $usr | grep '^Last password change' | cut -d: -f2)\" +%s) -gt $(date +%s) ]] && echo \"$usr :$(chage --list $usr | grep '^Last password change' | cut -d: -f2)\"; done\n  } | /bin/awk '{print} END {if (NR == 0) print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_434": {
        "description": "nologin",
        "cmd": "/bin/awk -F: '($1!~/^(root|halt|sync|shutdown|nfsnobody)$/ && ($3<'\"$(awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs)\"' || $3 == 65534) && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin$/) { print $1 }' /etc/passwd | /bin/awk '{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_435": {
        "description": "Disabled accounts",
        "cmd": "/bin/awk -F: '/nologin/ {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" && $2!=\"LK\") {print $1}' | /bin/awk '{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_436": {
        "description": "5.4.3 Ensure default group for the root account is GID 0",
        "info": "The usermod command can be used to specify which group the root user belongs to. This affects permissions of files that are created by the root user.\n\nUsing GID 0 for the root account helps prevent root -owned files from accidentally becoming accessible to non-privileged users.",
        "solution": "Run the following command to set the root user default group to GID 0 :\n\n# usermod -g 0 root",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/passwd",
        "regex": "^root:",
        "expect": "^root:x:0:0:"
    },
    "custom_item_437": {
        "description": "5.4.4 Ensure default user shell timeout is configured",
        "info": "TMOUT is an environmental setting that determines the timeout of a shell in seconds.\n\n - TMOUT=\n\nn\n\n- Sets the shell timeout to\n\nn\n\nseconds. A setting of TMOUT=0 disables timeout.\n - readonly TMOUT- Sets the TMOUT environmental variable as readonly, preventing unwanted modification during run-time.\n - export TMOUT - exports the TMOUT variable\n\nSystem Wide Shell Configuration Files:\n\n - /etc/profile - used to set system wide environmental variables on users shells. The variables are sometimes the same ones that are in thebash_profile however this file is used to set an initial PATH or PS1 for all shell users of the system. is only executed for interactive\n\nlogin\n\nshells, or shells executed with the --login parameter.\n - /etc/profile.d - /etc/profile will execute the scripts within /etc/profile.d/*.sh It is recommended to place your configuration in a shell script within /etc/profile.d to set your own system wide environmental variables.\n - /etc/bash.bashrc - System wide version ofbashrc etc/bashrc also invokes /etc/profile.d/*.sh if\n\nnon-login\n\nshell, but redirects output to /dev/null if\n\nnon-interactive.\n\nIs only executed for\n\ninteractive\n\nshells or if BASH_ENV is set to /etc/bash.bashrc\n\nSetting a timeout value reduces the window of opportunity for unauthorized user access to another user's shell session that has been left unattended. It also ends the inactive session and releases the resources associated with that session.\n\nNotes:\n\n - The audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files are also checked. Other methods of setting a timeout exist for other shells not covered here.\n - The TMOUT option applies to the active shell only. In case a user switches from one shell to another, it needs another full cycle to close the remaining shell.\n - /etc/profile may get updated by YaST2 Online Update\n - Ensure that the timeout conforms to your local policy.",
        "solution": "Review /etc/bash.bashrc /etc/profile and all files ending in *.sh in the /etc/profile.d/ directory and remove or edit all TMOUT=_n_ entries to follow local site policy. TMOUT should not exceed 900 or be equal to 0\n\nConfigure TMOUT in a file ending insh in the /etc/profile.d/ directory.\n\nTMOUT configuration examples:\n\n - As multiple lines:\n\nTMOUT=900\nreadonly TMOUT\nexport TMOUT\n - As a single line:\n\nreadonly TMOUT=900 ; export TMOUT",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|1A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n\n{\n   output1=\"\" output2=\"\"\n   [ -f /etc/bashrc ] && BRC=\"/etc/bashrc\"\n   for f in \"$BRC\" /etc/profile /etc/profile.d/*.sh ; do\n      grep -Pq '^\\\\s*([^#]+\\\\s+)?TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\\\b' \"$f\" && grep -Pq '^\\\\s*([^#]+;\\\\s*)?readonly\\\\s+TMOUT(\\\\s+|\\\\s*;|\\\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\\\b' \"$f\" && grep -Pq '^\\\\s*([^#]+;\\\\s*)?export\\\\s+TMOUT(\\\\s+|\\\\s*;|\\\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\\\b' \"$f\" &&\n   output1=\"$f\"\n   done\n   grep -Pq '^\\\\s*([^#]+\\\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\\\d{3,})\\\\b' /etc/profile /etc/profile.d/*.sh \"$BRC\" && output2=$(grep -Ps '^\\\\s*([^#]+\\\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\\\d{3,})\\\\b' /etc/profile /etc/profile.d/*.sh $BRC)\n   if [ -n \"$output1\" ] && [ -z \"$output2\" ]; then\n      echo -e \"\nPASSED\n\nTMOUT is configured in: \\\\\"$output1\\\\\"\n\"\n   else\n      [ -z \"$output1\" ] && echo -e \"\nFAILED\n\nTMOUT is not configured\n\"\n      [ -n \"$output2\" ] && echo -e \"\nFAILED\n\nTMOUT is incorrectly configured in: \\\\\"$output2\\\\\"\n\"\n   fi\n}",
        "expect": "(?i)^[\\\\s]*\\\\**[\\\\s]*passed:?[\\\\s]*\\\\**$"
    },
    "custom_item_438": {
        "description": "/etc/login.defs /etc/default/login /etc/profile* /etc/bash.bashrc* umask",
        "cmd": "/bin/grep -RPis '(^|^[^#]*)\\\\s*umask\\\\s+([0-7][0-7][01][0-7]\\\\b|[0-7][0-7][0-7][0-6]\\\\b|[0-7][01][0-7]\\\\b|[0-7][0-7][0-6]\\\\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\\\\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\\\\b)' /etc/login.defs /etc/default/login /etc/profile* /etc/bash.bashrc* | /bin/awk '{print} END {if (NR == 0) print \"pass\"; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_439": {
        "description": "/etc/login.defs /etc/default/login /etc/profile* /etc/bash.bashrc* UMASK",
        "cmd": "/bin/grep -RPis '^[\\\\s]*UMASK[\\\\s]+[\\\\s]*(0[0-7][2-7]7|[0-7][2-7]7|u=(r?|w?|x?)(r?|w?|x?)(r?|w?|x?),g=(r?x?|x?r?),o=)\\\\b' /etc/login.defs /etc/default/login /etc/profile* /etc/bash.bashrc* | /bin/awk '{print} END {if (NR == 0) print \"fail\"; else print \"pass\"}'",
        "expect": "^pass$"
    },
    "custom_item_440": {
        "description": "5.5 Ensure root login is restricted to system console",
        "info": "The file /etc/securetty contains a list of valid terminals that may be logged in directly as root.\n\nSince the system console has special properties to handle emergency situations, it is important to ensure that the console is in a physically secure location and that unauthorized consoles have not been defined.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove entries for any consoles that are not in a physically secure location.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|MA-4,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|MA-4,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSCv8|4.6,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|MA-4,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T2.3.4,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/securetty",
        "regex": ".*",
        "expect": "^Manual Review Required$"
    },
    "custom_item_441": {
        "description": "5.6 Ensure access to the su command is restricted",
        "info": "The su command allows a user to run a command or shell as another user. The program has been superseded by sudo which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su the su command will only allow users in a specific groups to execute su This group should be empty to reinforce the use of sudo for privileged access.\n\nRestricting the use of su and using sudo in its place, provides system administrators better control of the escalation of user privileges to execute privileged commands. The sudo utility also provides a better logging and audit mechanism, as it can log each command executed via sudo whereas su can only record that a user executed the su program.",
        "solution": "Create an empty group that will be specified for use of the su command. The group should be named according to site policy.\n\nExample\n\n# groupadd sugroup\n\nAdd the following line to the /etc/pam.d/su file, specifying the empty group:\n\nauth required pam_wheel.so use_uid group=sugroup",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "groupname=$(/bin/grep -E \"^\\\\s*auth\\\\s+required\\\\s+pam_wheel\\\\.so\\\\s+(\\\\S+\\\\s+)*use_uid\\\\s+(\\\\S+\\\\s+)*group=\\\\S+\\\\s*(\\\\S+\\\\s*)*(\\\\s+#.*)?$\" /etc/pam.d/su | /usr/bin/cut -d'=' -f2); /bin/grep \"${groupname}\" /etc/group",
        "expect": "^[\\\\s]*(\\\\S+):x:[0-9]+:[\\\\s]*$"
    },
    "custom_item_442": {
        "description": "6.1.2 Ensure permissions on /etc/passwd are configured",
        "info": "The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.\n\nIt is critical to ensure that the /etc/passwd file is protected from unauthorized write access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/passwd :\n\n# chown root:root /etc/passwd\n\n# chmod u-x,g-wx,o-wx /etc/passwd",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/passwd",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_443": {
        "system": "Linux",
        "description": "6.1.3 Ensure permissions on /etc/shadow are configured",
        "info": "The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.\n\nIf attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/shadow file (such as expiration) could also be useful to subvert the user accounts.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/shadow :\n\n# chown root:root /etc/shadow\n\n# chmod u-x,g-wx,o-rwx /etc/shadow",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/shadow",
        "owner": "root",
        "mask": "137",
        "group": "root"
    },
    "custom_item_444": {
        "description": "6.1.4 Ensure permissions on /etc/group are configured",
        "info": "The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.\n\nThe /etc/group file needs to be protected from unauthorized changes by non-privileged users, but needs to be readable as this information is used with many non-privileged programs.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/group :\n\n# chown root:root /etc/group\n\n# chmod u-x,g-wx,o-wx /etc/group",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/group",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_445": {
        "description": "6.1.5 Ensure permissions on /etc/passwd- are configured",
        "info": "The /etc/passwd- file contains backup user account information.\n\nIt is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/passwd- :\n\n# chown root:root /etc/passwd-\n\n# chmod u-x,go-wx /etc/passwd-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/passwd-",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_446": {
        "system": "Linux",
        "description": "6.1.6 Ensure permissions on /etc/shadow- are configured",
        "info": "The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.\n\nIt is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/shadow- :\n\n# chown root:shadow /etc/shadow-\n\n# chmod u-x,g-wx,o-rwx /etc/shadow-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/shadow-",
        "owner": "root",
        "mask": "137",
        "group": "root"
    },
    "custom_item_447": {
        "description": "6.1.7 Ensure permissions on /etc/group- are configured",
        "info": "The /etc/group- file contains a backup list of all the valid groups defined in the system.\n\nIt is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the following commands to set owner, group, and permissions on /etc/group- :\n\n# chown root:root /etc/group-\n\n# chmod u-x,go-wx /etc/group-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "/etc/group-",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_448": {
        "description": "6.2.1 Ensure accounts in /etc/passwd use shadowed passwords",
        "info": "Local accounts can uses shadowed passwords. With shadowed passwords, The passwords are saved in shadow password file, /etc/shadow encrypted by a salted one-way hash. Accounts with a shadowed password have an x in the second field in /etc/passwd\n\nThe /etc/passwd file also contains information like user ID's and group ID's that are used by many system programs. Therefore, the /etc/passwd file must remain world readable. In spite of encoding the password with a randomly-generated one-way hash function, an attacker could still break the system if they got access to the /etc/passwd file. This can be mitigated by using shadowed passwords, thus moving the passwords in the /etc/passwd file to /etc/shadow The /etc/shadow file is set so only root will be able to read and write. This helps mitigate the risk of an attacker gaining access to the encoded passwords with which to perform a dictionary attack.\n\nNotes:\n\n -\n\nAll accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.\n\n -\n\nA user account with an empty second field in /etc/passwd allows the account to be logged into by providing only the username.",
        "solution": "If any accounts in the /etc/passwd file do not have a single x in the password field, run the following command to set these accounts to use shadowed passwords:\n\n# sed -e 's/^\\([a-zA-Z0-9_]*\\):[^:]*:/\\1:x:/' -i /etc/passwd\n\nInvestigate to determine if the account is logged in and what it is being used for, to determine if it needs to be forced off.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|4.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/awk -F: '($2 != \"x\" ) { print $1 \" is not set to shadowed passwords \"}' /etc/passwd | /bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_449": {
        "description": "6.2.10 Ensure no users have .netrc files",
        "info": "Thenetrc file contains data for logging into a remote host for file transfers via FTP.\n\nThenetrc file presents a significant security risk since it stores passwords in unencrypted form. Even if FTP is disabled, user accounts may have brought overnetrc files from other systems which could pose a risk to those systems.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report usernetrc files and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|16.4,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1A,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "~/.netrc"
    },
    "custom_item_450": {
        "description": "6.2.11 Ensure users' .netrc Files are not group or world accessible",
        "info": "While the system administrator can establish secure permissions for users'netrc files, the users can easily override these.\n\nnetrc files may contain unencrypted passwords that may be used to attack other systems.\n\nNote: While the complete removal of .netrc files is recommended if any are required on the system secure permissions must be applied.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report usernetrc file permissions and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "~/.netrc",
        "mask": "0077"
    },
    "custom_item_451": {
        "description": "6.2.12 Ensure no users have .rhosts files",
        "info": "While norhosts files are shipped by default, users can easily create them.\n\nThis action is only meaningful ifrhosts support is permitted in the file /etc/pam.conf Even though therhosts files are ineffective if support is disabled in /etc/pam.conf they may have been brought over from other systems and could contain information useful to an attacker for those other systems.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report userrhosts files and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|16.4,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "~/.rhosts"
    },
    "custom_item_452": {
        "description": "6.2.18 Ensure shadow group is empty",
        "info": "The shadow group allows system programs which require access the ability to read the /etc/shadow file. No users should be assigned to the shadow group.\n\nAny users assigned to the shadow group would be granted read access to the /etc/shadow file. If attackers can gain read access to the /etc/shadow file, they can easily run a password cracking program against the hashed passwords to break them. Other security information that is stored in the /etc/shadow file (such as expiration) could also be useful to subvert additional user accounts.",
        "solution": "Remove all users from the shadow group, and change the primary group of any users with shadow as their primary group.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/awk -F: 'FILENAME == \"/etc/group\" && $1 == \"shadow\" { gid=$3; if ($4!=\"\") { print \"/etc/group fail: \"$4; f=1 } } FILENAME == \"/etc/passwd\" && $4 == gid && gid != \"\" { print \"/etc/passwd fail: \"$1; f=1; } END { if (!f) print \"shadow group empty\" }' /etc/group /etc/passwd",
        "expect": "^shadow group empty$"
    },
    "custom_item_453": {
        "description": "6.2.2 Ensure /etc/shadow password fields are not empty",
        "info": "An account with an empty password field means that anybody may log in as that user without providing a password.\n\nAll accounts must have passwords or be locked to prevent the account from being used by an unauthorized user.",
        "solution": "If any accounts in the /etc/shadow file do not have a password, run the following command to lock the account until it can be determined why it does not have a password:\n\n# passwd -lAlso, check to see if the account is logged in and investigate what it is being used for to determine if it needs to be forced off.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "/bin/awk -F : \\'($2 == \"\") { print $1 \" does not have a password.\"}\\' /etc/shadow | /bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "^none$"
    },
    "custom_item_454": {
        "description": "6.2.4 Ensure root PATH Integrity",
        "info": "The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.\n\nIncluding the current working directory (.) or other writable directory in root 's executable path makes it likely that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse program.",
        "solution": "Correct or justify any items discovered in the Audit step.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n  {\n  RPCV=\"$(/usr/bin/sudo -Hiu root env | /bin/grep '^PATH' | cut -d= -f2)\"; /bin/echo \"$RPCV\" | /bin/grep -q \"::\" && /bin/echo \"root's path contains a empty directory (::)\"; /bin/echo \"$RPCV\" | /bin/grep -q \":$\" && /bin/echo \"root's path contains a trailing (:)\"; for x in $(/bin/echo \"$RPCV\" | tr \":\" \" \"); do if [ -d \"$x\" ]; then ls -ldH \"$x\" | /bin/awk '$9 == \".\" {print \"PATH contains current working directory (.)\"}; $3 != \"root\" {print $9, \"is not owned by root\"}; substr($1,6,1) != \"-\" {print $9, \"is group writable\"}; substr($1,9,1) != \"-\" {print $9, \"is world writable\"}'; else /bin/echo \"$x is not a directory\"; fi; done | /bin/awk '{print} END {if (NR == 0) print \"All results passing\"; else print \"fail\"}'\n}",
        "expect": "All results passing"
    },
    "custom_item_455": {
        "description": "6.2.8 Ensure users' dot files are not group or world writable",
        "info": "While the system administrator can establish secure permissions for users' \"dot\" files, the users can easily override these.\n\nGroup or world-writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "cmd": "#!/bin/bash\n{\n  awk -F: '($1!~/(halt|sync|shutdown)/ && $7 !~ \"(/usr)?/sbin/nologin\" && $7 !~ \"(/usr)?/bin/false\") { print $1 \" \" $6 }' /etc/passwd | while read user dir; do\n  if [ ! -d \"$dir\" ]; then\n    echo \"The home directory ($dir) of user $user does not exist.\"\n  else\n    for file in $dir/.[A-Za-z0-9]*; do\n      if [ ! -h \"$file\" -a -f \"$file\" ]; then\n        fileperm=$(ls -ld $file | cut -f1 -d\" \")\n\n        if [ $(echo $fileperm | cut -c6)  != \"-\" ]; then\n          echo \"Group Write permission set on file $file\"\n        fi\n        if [ $(echo $fileperm | cut -c9)  != \"-\" ]; then\n          echo \"Other Write permission set on file $file\"\n        fi\n      fi\n    done\n  fi\ndone\n} | /bin/awk '{ print } END { if(NR==0) { print \"pass\" } }'",
        "expect": "^pass$"
    },
    "custom_item_456": {
        "description": "6.2.9 Ensure no users have .forward files",
        "info": "Theforward file specifies an email address to forward the user's mail to.\n\nUse of theforward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. Theforward file also poses a risk as it can be used to execute commands that may perform unintended actions.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report userforward files and determine the action to be taken in accordance with site policy.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3682",
        "file": "~/.forward"
    }
}