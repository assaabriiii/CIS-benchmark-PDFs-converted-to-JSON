{
    "custom_item_1": {
        "description": "Tomcat found",
        "cmd": "java -cp @LIB_DIR@/catalina.jar org.apache.catalina.util.ServerInfo | /bin/egrep 'version'",
        "expect": "@WEBSERVER_NAME@"
    },
    "custom_item_2": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/js-examples)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/js-examples"
    },
    "custom_item_3": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/servlet-example)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/servlet-example"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/webdav)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/webdav"
    },
    "custom_item_5": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/tomcat-docs)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/tomcat-docs"
    },
    "custom_item_6": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/balancer)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/balancer"
    },
    "custom_item_7": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/ROOT/admin)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/ROOT/admin"
    },
    "custom_item_8": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (WEBAPP_DIR/examples)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/examples"
    },
    "custom_item_9": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (SERVER_DIR/webapps/host-manager.xml)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@SERVER_DIR@/webapps/host-manager.xml"
    },
    "custom_item_10": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (SERVER_DIR/webapps/manager)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@SERVER_DIR@/webapps/manager"
    },
    "custom_item_11": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (CONFIG_DIR/Catalina/localhost/host-manager.xml)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/Catalina/localhost/host-manager.xml"
    },
    "custom_item_12": {
        "system": "Linux",
        "description": "1.1 Remove extraneous files and directories (CONFIG_DIR/Catalina/localhost/manager.xml)",
        "info": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
        "solution": "Perform the following to remove extraneous resources:\n                1. The following should yield no output:\n                    $ rm -rf $CATALINA_HOME/webapps/docs\n                    $CATALINA_HOME/webapps/examples\n                If the Manager application is not utilized, also remove the following resources:\n                    $ rm -rf $CATALINA_HOME/webapps/host-manager\n                    $CATALINA_HOME/webapps/manager\n                    $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/Catalina/localhost/manager.xml"
    },
    "custom_item_13": {
        "system": "Linux",
        "description": "10.17 Do not resolve hosts on logging valves",
        "info": "Setting enableLookups to true on Connector requires a DNS look-up before logging the information. This adds additional resources when logging. Allowing enableLookups adds additional overhead that is rarely needed.",
        "solution": "In Connector elements, set the enableLookups attribute to false or remove it.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "if [ $(/bin/grep 'java.util.logging.FileHandler.limit' @CONFIG_DIR@/logging.properties | /usr/bin/awk -F= '{print $2}') -lt $(/bin/df -P @CATALINA_CONF/logging.properties | /usr/bin/tail -1 | /usr/bin/cut -d' ' -f 8)*1024 ]; then /bin/echo 'FAIL -- Log files can exceed size of disk'; else /bin/echo 'PASS'; fi",
        "expect": "CONFIDENTIAL",
        "MEDIUMsystem": "Linux",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL",
        "regex": "CONFIDENTIAL"
    },
    "custom_item_14": {
        "system": "Linux",
        "description": "2.1 Alter the Advertised server.info String",
        "info": "The server.info attribute contains the name of the application service. This value is presented to Tomcat clients when clients connect to the Tomcat server.\n\n          NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to alter the server platform string that gets displayed when clients connect to the tomcat server.\n            1. Extract the ServerInfo.properties file from the catalina.jar file:\n                $ cd $CATALINA_HOME/lib\n                $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n            2. Navigate to the util directory that was created\n                cd org/apache/catalina/util\n            3. Open ServerInfo.properties in an editor\n            4. Update the server.info attribute in the ServerInfo.properties file.\n                server.info=5. Update the catalina.jar with the modified ServerInfo.properties file.\n                $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties",
        "reference": "800-53|SC-30(5),800-53r5|SC-30(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-30,ITSG-33|SC-30a.,LEVEL|2A,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "java -cp @LIB_DIR@/catalina.jar org.apache.catalina.util.ServerInfo | /bin/egrep 'version'",
        "expect": "^[\\\\s]*Server version: @WEBSERVER_NAME@/[0-9\\.]+"
    },
    "custom_item_15": {
        "system": "Linux",
        "description": "2.2 Alter the Advertised server.number String",
        "info": "The server.number attribute represents the specific version of Tomcat that is executing. This value is presented to Tomcat clients when connect.\n\n          NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to alter the server number string that gets displayed when clients connect to the tomcat server.\n            1. Extract the ServerInfo.properties file from the catalina.jar file:\n                $ cd $CATALINA_HOME/lib\n                $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n            2. Navigate to the util directory that was created\n                cd org/apache/catalina/util\n            3. Open ServerInfo.properties in an editor\n            4. Update the server.info attribute in the ServerInfo.properties file.\n                server.number=5. Update the catalina.jar with the modified ServerInfo.properties file.\n                $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties",
        "reference": "800-53|SC-30(5),800-53r5|SC-30(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-30,ITSG-33|SC-30a.,LEVEL|2A,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "java -cp @LIB_DIR@/catalina.jar org.apache.catalina.util.ServerInfo | /bin/egrep 'number'",
        "expect": "^[\\\\s]*Server number:\\s+[0-9\\.]+$"
    },
    "custom_item_16": {
        "system": "Linux",
        "description": "2.3 Alter the Advertised server.built Date",
        "info": "The server.built date represents the date which Tomcat was compiled and packaged. This value is presented to Tomcat clients when clients connect to the server.\n\n          NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Perform the following to alter the server built date that gets displayed when clients connect to the tomcat server.\n            1. Extract the ServerInfo.properties file from the catalina.jar file:\n                $ cd $CATALINA_HOME/lib\n                $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n            2. Navigate to the util directory that was created\n                cd org/apache/catalina/util\n            3. Open ServerInfo.properties in an editor\n            4. Update the server.info attribute in the ServerInfo.properties file.\n                server.built=\n            5. Update the catalina.jar with the modified ServerInfo.properties file.\n                $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties",
        "reference": "800-53|SC-30(5),800-53r5|SC-30(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-30,ITSG-33|SC-30a.,LEVEL|2A,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "java -cp @LIB_DIR@/catalina.jar org.apache.catalina.util.ServerInfo | /bin/egrep 'built'",
        "expect": "^[\\\\s]*Server built:\\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec]) [0-9]{1,2} [0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2}$"
    },
    "custom_item_17": {
        "description": "2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors",
        "info": "The xPoweredBy setting determines if Apache Tomcat will advertise its presence via the XPowered-By HTTP header. It is recommended that this value be set to false. The server attribute overrides the default value that is sent down in the HTTP header further masking Apache Tomcat.",
        "solution": "1. Add the xPoweredBy attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the xPoweredBy attributes value to false.Alternatively, ensure the xPoweredBy attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent.\n            2. Add the server attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the server attribute value to anything except a blank string.",
        "reference": "800-53|SC-30(5),800-53r5|SC-30(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-30,ITSG-33|SC-30a.,LEVEL|2A,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_18": {
        "description": "3.2 Disable the Shutdown port",
        "info": "Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. If this functionality is not used, it is recommended that the Shutdown port be disabled.",
        "solution": "Set the port to -1 in the $CATALINA_HOME/conf/server.xml file:",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "-1"
    },
    "custom_item_19": {
        "description": "5.1 Use secure Realms",
        "info": "A realm is a database of usernames and passwords used to identify valid users of web applications. Review the Realms configuration to ensure Tomcat is configured to use JDBCRealm, UserDatabaseRealm, or JAASRealm. Specifically, Tomcat should not utilize MemoryRealm.\n\n          According to the Tomcat documentation, MemoryRealm, JDBCRealm are not designed for production usage and could result in reduced availability, the UserDatabaseRealm is not intended for large-scale installations, the JAASRealm is not widely used and therefore the code is not as mature as the other realms.",
        "solution": "Set the Realm className setting in $CATALINA_HOME/conf/server.xml to one of the appropriate realms.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    },
    "custom_item_20": {
        "description": "5.2 Use LockOut Realms",
        "info": "A LockOut realm wraps around standard realms adding the ability to lock a user out after multiple failed logins.",
        "solution": "Create a lockout realm wrapping the main realm.",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,LEVEL|2A,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_21": {
        "description": "6.1 Setup Client-cert Authentication",
        "info": "Client-cert authentication requires that each client connecting to the server has a certificate used to authenticate. This is generally regarded as strong authentication than a password as it requires the client to have the cert and not just know a password.",
        "solution": "In the Connector element, set the clientAuth parameter to true.",
        "reference": "800-171|3.5.2,800-53|IA-5(2),800-53r5|IA-5(2),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    },
    "custom_item_22": {
        "system": "Linux",
        "description": "7.1 Application specific logging",
        "info": "By default, java.util.logging does not provide the capabilities to configure per-web application settings, only per VM. In order to overcome this limitation Tomcat implements JULI as a wrapper for java.util.logging. JULI provides additional configuration functionality so you can set each web application with different logging specifications.",
        "solution": "Create a logging.properties file and place that into your application WEB-INF\\classes directory. Note: By default, installing Tomcat places a logging.properties file in $CATALINA_HOME\\conf. This file can be used as base for an application specific logging properties file.",
        "reference": "LEVEL|2A",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/@WEBAPP_NAME@/WEB-INF/classes/logging.properties"
    },
    "custom_item_23": {
        "system": "Linux",
        "description": "7.7 Configure log file size limit (verify java.util.logging.FileHandler.limit is present)",
        "info": "By default, the logging.properties file will have no defined limit for the log file size. This is a potential denial of service attack as it would be possible to fill a drive or partition containing the log files.",
        "solution": "Create the following entry in your logging.properties file. This field is specified in bytes.\n            java.util.logging.FileHandler.limit=10000",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|2A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "/bin/grep 'java.util.logging.FileHandler.limit' @CONFIG_DIR@/logging.properties",
        "expect": "java.util.logging.FileHandler.limit=[0-9]+"
    },
    "custom_item_24": {
        "system": "Linux",
        "description": "7.7 Configure log file size limit (verify java.util.logging.FileHandler.limit is smaller than disk partition)",
        "info": "By default, the logging.properties file will have no defined limit for the log file size. This is a potential denial of service attack as it would be possible to fill a drive or partition containing the log files.",
        "solution": "Create the following entry in your logging.properties file. This field is specified in bytes.\n            java.util.logging.FileHandler.limit=10000",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|2A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "cmd": "if [ $(/bin/grep 'java.util.logging.FileHandler.limit' @CONFIG_DIR@/logging.properties | /usr/bin/awk -F= '{print $2}') -lt $(/bin/df -P @CATALINA_CONF/logging.properties | /usr/bin/tail -1 | /usr/bin/cut -d' ' -f 8)*1024 ]; then /bin/echo 'FAIL -- Log files can exceed size of disk'; else /bin/echo 'PASS'; fi",
        "expect": "PASS"
    },
    "custom_item_25": {
        "description": "9.2 Disabling auto deployment of applications",
        "info": "Tomcat allows auto deployment of applications while Tomcat is running. It is recommended that this capability be disabled.",
        "solution": "In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to false.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    },
    "custom_item_26": {
        "description": "9.3 Disable deploy on startup of applications",
        "info": "Tomcat allows auto deployment of applications. It is recommended that this capability be disabled.",
        "solution": "In the $CATALINA_HOME/conf/server.xml file, change deployOnStartup to false.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    },
    "custom_item_27": {
        "description": "10.2 Restrict access to the web administration",
        "info": "Limit access to the web administration application to only those with a required needed.",
        "solution": "For the administration application, edit $CATALINA_HOME/conf/server.xml and uncomment the following:Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped.",
        "reference": "800-171|3.1.5,800-53|AC-6(3),800-53r5|AC-6(3),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),LEVEL|2M,NESA|T5.1.1,NESA|T5.5.4,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_28": {
        "system": "Linux",
        "description": "10.5 Rename the manager application (localhost/manager.xml)",
        "info": "The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/Catalina/localhost/manager.xml"
    },
    "custom_item_29": {
        "system": "Linux",
        "description": "10.5 Rename the manager application (host-manager/manager.xml)",
        "info": "The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/host-manager/manager.xml"
    },
    "custom_item_30": {
        "system": "Linux",
        "description": "10.5 Rename the manager application (webapps/manager)",
        "info": "The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@WEBAPP_DIR@/manager"
    },
    "custom_item_31": {
        "system": "Linux",
        "description": "10.8 Do not allow additional path delimiters (ALLOW_BACKSLASH)",
        "info": "Being able to specify different path-delimiters on Tomcat creates the possibility that an attacker can access applications that were previously blocked a proxy like mod_proxy.",
        "solution": "Start Tomcat with ALLOW_BACKSLASH set to false and ALLOW_ENCODED_SLASH set to false. Add the following to your startup script:\n            -Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false\n            -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2A,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CATALINA_HOME@/bin/catalina.sh",
        "regex": "-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_BACKSLASH[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]",
        "expect": "-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_BACKSLASH[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]"
    },
    "custom_item_32": {
        "system": "Linux",
        "description": "10.8 Do not allow additional path delimiters (ALLOW_ENCODED_SLASH)",
        "info": "Being able to specify different path-delimiters on Tomcat creates the possibility that an attacker can access applications that were previously blocked a proxy like mod_proxy.",
        "solution": "Start Tomcat with ALLOW_BACKSLASH set to false and ALLOW_ENCODED_SLASH set to false. Add the following to your startup script:\n            -Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false\n            -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2A,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CATALINA_HOME@/bin/catalina.sh",
        "regex": "-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_ENCODED_SLASH[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]",
        "expect": "-Dorg\\.apache\\.catalina\\.connector\\.CoyoteAdapter\\.ALLOW_ENCODED_SLASH[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]"
    },
    "custom_item_33": {
        "system": "Linux",
        "description": "10.9 Do not allow custom header status messages",
        "info": "Being able to specify custom status messages opens up the possibility for additional headers to be injected. If custom header status messages are required, make sure it is only in US-ASCII and does not include any user-supplied data.",
        "solution": "Start Tomcat with USE_CUSTOM_STATUS_MSG_IN_HEADER set to false. Add the following to your startup script.\n            -Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false",
        "reference": "800-53|SC-30(5),800-53r5|SC-30(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-30,ITSG-33|SC-30a.,LEVEL|2A,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CATALINA_HOME@/bin/catalina.sh",
        "regex": "-Dorg\\.apache\\.coyote\\.USE_CUSTOM_STATUS_MSG_IN_HEADER[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]",
        "expect": "-Dorg\\.apache\\.coyote\\.USE_CUSTOM_STATUS_MSG_IN_HEADER[\\\\s]*=[\\\\s]*[Ff][Aa][Ll][Ss][Ee]"
    },
    "custom_item_34": {
        "description": "10.10 Configure connectionTimeout",
        "info": "The connectionTimeout setting allows Tomcat to close idle sockets after a specific amount of time to save system resources. Closing idle sockets reduces system resource usage thus can provide better performance and help protect against Denial of Service attacks.",
        "solution": "Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the connectionTimeout setting that is optimal based on hardware resources, load, and number of concurrent connections.",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,LEVEL|2A,NIAv2|NS49",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "expect": "PASS"
    },
    "custom_item_35": {
        "description": "10.11 Configure maxHttpHeaderSize",
        "info": "The maxHttpHeaderSize limits the size of the request and response headers defined in bytes. If not specified, the default is 8192 bytes. Limiting the size of the header request can help protect against Denial of Service requests",
        "solution": "Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the appropriate maxHttpHeaderSize setting.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|2A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    },
    "custom_item_36": {
        "system": "Linux",
        "description": "10.12 Force SSL for all applications",
        "info": "Use the transport-guarantee attribute to ensure SSL protection when accessing all applications. This can be overridden to be disabled on a per application basis in the application configuration.",
        "solution": "In $CATALINA_HOME/conf/web.xml, set the following:CONFIDENTIAL",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/web.xml",
        "regex": "CONFIDENTIAL",
        "expect": "CONFIDENTIAL"
    },
    "custom_item_37": {
        "description": "10.17 Do not resolve hosts on logging valves",
        "info": "Setting enableLookups to true on Connector requires a DNS look-up before logging the information. This adds additional resources when logging. Allowing enableLookups adds additional overhead that is rarely needed.",
        "solution": "In Connector elements, set the enableLookups attribute to false or remove it.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/266",
        "file": "@CONFIG_DIR@/server.xml",
        "xsl_stmt": "",
        "not_expect": "FAIL"
    }
}