{
    "custom_item_1": {
        "description": "AOSX-13-001145 - All setuid executables on the macOS system must be documented.",
        "info": "Very few of the executables that come preinstalled on the macOS host have the 'setuid' bit set, and administrators should never add the 'setuid' bit to any executable that does not already have it set by the vendor. Executables with the 'setuid' bit set allow anyone that executes them to be temporarily assigned the UID of the file owner. In practice, this almost always is the root account. While some vendors depend on this file attribute for proper operation, security problems can result if 'setuid' is assigned to programs allowing reading and writing of files, or shell escapes, as this could lead to unprivileged users gaining privileged access to files and directories on the system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Document all of the files with the 'setuid' bit set.\n\nRemove any undocumented files.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214908r609363_rule,STIG-ID|AOSX-13-001145,STIG-Legacy|SV-96409,STIG-Legacy|V-81695,SWIFT-CSCv1|2.3,Vuln-ID|V-214908",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "name": "find_suid_sgid_files",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_2": {
        "description": "MacOS 10.13",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_3": {
        "description": "AOSX-13-000005 - The macOS system must conceal, via the session lock, information previously visible on the display with a publicly viewable image.",
        "info": "A default screen saver must be configured for all users, as the screen saver will act as a session time-out lock for the system and must conceal the contents of the screen from unauthorized users. The screen saver must not display any sensitive information or reveal the contents of the locked session screen. Publicly viewable images can include static or dynamic images such as patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|III,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214802r609363_rule,STIG-ID|AOSX-13-000005,STIG-Legacy|SV-96177,STIG-Legacy|V-81463,Vuln-ID|V-214802",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | grep loginWindowModulePath | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"; else print \"loginWindowModulePath not found\"}\\'",
        "expect": "pass"
    },
    "custom_item_4": {
        "description": "AOSX-13-000006 - The macOS system must be configured to disable hot corners - wvous-tl-corner",
        "info": "Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214803r609363_rule,STIG-ID|AOSX-13-000006,STIG-Legacy|SV-96179,STIG-Legacy|V-81465,Vuln-ID|V-214803",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'wvous-bl-corner\\'",
        "expect": "\\\\\"wvous-bl-corner\\\\\"[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_5": {
        "description": "AOSX-13-000006 - The macOS system must be configured to disable hot corners - wvous-bl-corner",
        "info": "Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214803r609363_rule,STIG-ID|AOSX-13-000006,STIG-Legacy|SV-96179,STIG-Legacy|V-81465,Vuln-ID|V-214803",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'wvous-tl-corner\\'",
        "expect": "\\\\\"wvous-tl-corner\\\\\"[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_6": {
        "description": "AOSX-13-000006 - The macOS system must be configured to disable hot corners - wvous-br-corner",
        "info": "Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214803r609363_rule,STIG-ID|AOSX-13-000006,STIG-Legacy|SV-96179,STIG-Legacy|V-81465,Vuln-ID|V-214803",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'wvous-br-corner\\'",
        "expect": "\\\\\"wvous-br-corner\\\\\"[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_7": {
        "description": "AOSX-13-000006 - The macOS system must be configured to disable hot corners - wvous-tr-corner",
        "info": "Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11(1),800-53r5|AC-11(1),CAT|II,CCI|CCI-000060,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11(1),NIAv2|AM23c,NIAv2|AM23d,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214803r609363_rule,STIG-ID|AOSX-13-000006,STIG-Legacy|SV-96179,STIG-Legacy|V-81465,Vuln-ID|V-214803",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'wvous-tr-corner\\'",
        "expect": "\\\\\"wvous-tr-corner\\\\\"[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_8": {
        "description": "AOSX-13-000007 - The macOS system must be configured to prevent Apple Watch from terminating a session lock.",
        "info": "Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214804r609363_rule,STIG-ID|AOSX-13-000007,STIG-Legacy|SV-96181,STIG-Legacy|V-81467,Vuln-ID|V-214804",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'allowAutoUnlock = 0;\\'",
        "expect": "allowAutoUnlock[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_9": {
        "description": "AOSX-13-000010 - The macOS system must initiate a session lock after a 15-minute period of inactivity.",
        "info": "A screen saver must be enabled and set to require a password to unlock. The timeout should be set to 15 minutes of inactivity. This mitigates the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214805r609363_rule,STIG-ID|AOSX-13-000010,STIG-Legacy|SV-96183,STIG-Legacy|V-81469,Vuln-ID|V-214805",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[A-Za-z0-9_-]+[\\\\s]*=[\\\\s]*(900|[2-8][0-9][0-9]|1[8-9][0-9])$",
        "plist_item": "idleTime",
        "plist_name": "com.apple.screensaver",
        "plist_user": "all"
    },
    "custom_item_10": {
        "description": "AOSX-13-000020 - The macOS system must retain the session lock until the user reestablishes access using established identification and authentication procedures.",
        "info": "Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214806r609363_rule,STIG-ID|AOSX-13-000020,STIG-Legacy|SV-96185,STIG-Legacy|V-81471,Vuln-ID|V-214806",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "1$",
        "plist_item": "askForPassword",
        "plist_name": "com.apple.screensaver",
        "plist_user": "all"
    },
    "custom_item_11": {
        "description": "AOSX-13-000025 - The macOS system must initiate the session lock no more than five seconds after a screen saver is started.",
        "info": "A screen saver must be enabled and set to require a password to unlock. An excessive grace period impacts the ability for a session to be truly locked, requiring authentication to unlock.",
        "solution": "This setting is enforced using the 'Security and Privacy Policy' configuration profile.",
        "reference": "800-171|3.1.10,800-53|AC-11b.,800-53r5|AC-11b.,CAT|II,CCI|CCI-000056,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11b.,NIAv2|AM23e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214807r609363_rule,STIG-ID|AOSX-13-000025,STIG-Legacy|SV-96187,STIG-Legacy|V-81473,Vuln-ID|V-214807",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep askForPasswordDelay",
        "expect": "askForPasswordDelay[\\\\s]*=[\\\\s]*[0-5];"
    },
    "custom_item_12": {
        "description": "AOSX-13-000030 - The macOS system must monitor remote access methods and generate audit records when successful/unsuccessful attempts to access/modify privileges occur.",
        "info": "Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing successful and unsuccessful attempts to switch to another user account and the escalation of privileges mitigates this risk.\n\nSatisfies: SRG-OS-000032-GPOS-00013, SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206",
        "solution": "To ensure the appropriate flags are enabled for auditing, run the following command:\n\n/usr/bin/sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control' file.",
        "reference": "800-171|3.1.12,800-171|3.3.1,800-171|3.3.2,800-53|AC-17(1),800-53|AU-12c.,800-53r5|AC-17(1),800-53r5|AU-12c.,CAT|II,CCI|CCI-000067,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-3,CSF|PR.PT-1,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.4.4,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214808r609363_rule,STIG-ID|AOSX-13-000030,STIG-Legacy|SV-96189,STIG-Legacy|V-81475,SWIFT-CSCv1|2.6,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-214808",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*lo).*$"
    },
    "custom_item_13": {
        "description": "AOSX-13-000035 - The macOS system must implement DoD-approved encryption to protect the confidentiality and integrity of remote access sessions including transmitted data and data during preparation for transmission.",
        "info": "Without confidentiality and integrity protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nRemote access is access to DoD non-public information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection (e.g., Remote Desktop Protocol [RDP]), thereby providing a degree of confidentiality. The encryption strength of a mechanism is selected based on the security categorization of the information.\n\nSatisfies: SRG-OS-000033-GPOS-00014, SRG-OS-000423-GPOS-00187, SRG-OS-000424-GPOS-00188, SRG-OS-000425-GPOS-00189, SRG-OS-000426-GPOS-00190",
        "solution": "To enable the SSH service, run the following command:\n\n/usr/bin/sudo /bin/launchctl enable system/com.openssh.sshd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.13,800-171|3.13.8,800-53|AC-17(2),800-53|SC-8,800-53|SC-8(1),800-53|SC-8(2),800-53r5|AC-17(2),800-53r5|SC-8,800-53r5|SC-8(1),800-53r5|SC-8(2),CAT|I,CCI|CCI-000068,CCI|CCI-002418,CCI|CCI-002420,CCI|CCI-002421,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-214809r609363_rule,STIG-ID|AOSX-13-000035,STIG-Legacy|SV-96191,STIG-Legacy|V-81477,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,TBA-FIISB|29.1,Vuln-ID|V-214809",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.openssh.sshd | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"true\"}\\'",
        "expect": ".*false"
    },
    "custom_item_14": {
        "description": "AOSX-13-000050 - The macOS system must be configured to disable rshd service.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe 'rshd' service must be disabled.",
        "solution": "To disable the 'rshd' service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.rshd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|I,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214810r609363_rule,STIG-ID|AOSX-13-000050,STIG-Legacy|SV-96193,STIG-Legacy|V-81479,SWIFT-CSCv1|2.3,Vuln-ID|V-214810",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.rshd | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_15": {
        "description": "AOSX-13-000054 - The macOS system must implement approved Ciphers to protect the confidentiality of SSH connections.",
        "info": "Unapproved mechanisms for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity, resulting in the compromise of DoD data.\n\nOperating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nThe implementation of OpenSSH that is included with macOS does not utilize a FIPS 140-2 validated cryptographic module. While the listed ciphers are FIPS 140-2 approved algorithms, the module implementing them has not been validated.\n\nBy specifying a cipher list with the order of ciphers being in a 'strongest to weakest' orientation, the system will automatically attempt to use the strongest cipher for securing SSH connections.\n\nSatisfies: SRG-OS-000033-GPOS-00014, SRG-OS-000120-GPOS-00061, SRG-OS-000125-GPOS-00065, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173, SRG-OS-000394-GPOS-00174",
        "solution": "Configure SSH to use secure cryptographic algorithms.\n\nTo ensure that 'Ciphers' set correctly, run the following command:\n\n/usr/bin/sudo /usr/bin/grep -q '^Ciphers' /etc/ssh/sshd_config && /usr/bin/sudo /usr/bin/sed -i.bak  's/^Ciphers.*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/sshd_config || /usr/bin/sudo /usr/bin/sed -i.bak '/.*Ciphers and keying.*/a\\'$'\\n''Ciphers aes256-ctr,aes192-ctr,aes128-ctr'$'\\n' /etc/ssh/sshd_config\n\nThe SSH service must be restarted for changes to take effect.",
        "reference": "800-171|3.1.13,800-171|3.7.5,800-53|AC-17(2),800-53|IA-7,800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|IA-7,800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|II,CCI|CCI-000068,CCI|CCI-000803,CCI|CCI-000877,CCI|CCI-002890,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.MA-2,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T2.3.4,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.4.1,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-233625r609363_rule,STIG-ID|AOSX-13-000054,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-233625",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)Ciphers(?-i)",
        "expect": "^[\\\\s]*(?i)Ciphers(?-i)[\\\\s]+aes256-ctr,aes192-ctr,aes128-ctr[\\\\s]*$"
    },
    "custom_item_16": {
        "description": "AOSX-13-000055 - The macOS system must use only Message Authentication Codes (MACs) employing FIPS 140-2 validated cryptographic hash algorithms.",
        "info": "Unapproved mechanisms for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity, resulting in the compromise of DoD data.\n\nOperating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nThe implementation of OpenSSH that is included with macOS does not utilize a FIPS 140-2 validated cryptographic module. While the listed MACs are FIPS 140-2 approved algorithms, the module implementing them has not been validated.\n\nBy specifying a Keyed-Hash Message Authentication Code list with the order of hashes being in a 'strongest to weakest' orientation, the system will automatically attempt to use the strongest hash for securing SSH connections.\n\nSatisfies: SRG-OS-000033-GPOS-00014, SRG-OS-000120-GPOS-00061, SRG-OS-000125-GPOS-00065, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173, SRG-OS-000394-GPOS-00174",
        "solution": "Configure SSH to use secure Keyed-Hash Message Authentication Codes.\n\nTo ensure that 'MACs' set correctly, run the following command:\n\n/usr/bin/sudo /usr/bin/grep -q '^MACs' /etc/ssh/sshd_config && /usr/bin/sudo /usr/bin/sed -i.bak  's/^MACs.*/MACs hmac-sha2-256,hmac-sha2-512/' /etc/ssh/sshd_config || /usr/bin/sudo /usr/bin/sed -i.bak '/.*Ciphers and keying.*/a\\'$'\\n''MACs hmac-sha2-512,hmac-sha2-256'$'\\n' /etc/ssh/sshd_config\n\nThe SSH service must be restarted for changes to take effect.",
        "reference": "800-171|3.1.13,800-171|3.7.5,800-53|AC-17(2),800-53|IA-7,800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|IA-7,800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|II,CCI|CCI-000068,CCI|CCI-000803,CCI|CCI-000877,CCI|CCI-002890,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.MA-2,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T2.3.4,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.4.1,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-233626r609363_rule,STIG-ID|AOSX-13-000055,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-233626",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)MACs(?-i)",
        "expect": "^[\\\\s]*(?i)MACs(?-i)[\\\\s]+hmac-sha2-512,hmac-sha2-256[\\\\s]*$"
    },
    "custom_item_17": {
        "description": "AOSX-13-000056 - The macOS system must implement an approved Key Exchange Algorithm.",
        "info": "Unapproved mechanisms for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity, resulting in the compromise of DoD data.\n\nOperating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nThe implementation of OpenSSH that is included with macOS does not utilize a FIPS 140-2 validated cryptographic module. While the listed Key Exchange Algorithms are FIPS 140-2 approved, the module implementing them has not been validated.\n\nBy specifying a Key Exchange Algorithm list with the order of hashes being in a 'strongest to weakest' orientation, the system will automatically attempt to use the strongest Key Exchange Algorithm for securing SSH connections.\n\nSatisfies: SRG-OS-000033-GPOS-00014, SRG-OS-000120-GPOS-00061, SRG-OS-000125-GPOS-00065, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173,SRG-OS-000394-GPOS-00174",
        "solution": "Configure SSH to use a secure Key Exchange Algorithm.\n\nTo ensure that 'KexAlgorithms' set correctly, run the following command:\n\n/usr/bin/sudo /usr/bin/grep -q '^KexAlgorithms' /etc/ssh/sshd_config && /usr/bin/sudo /usr/bin/sed -i.bak  's/^KexAlgorithms.*",
        "reference": "800-171|3.1.13,800-171|3.7.5,800-53|AC-17(2),800-53|IA-7,800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|IA-7,800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|II,CCI|CCI-000068,CCI|CCI-000803,CCI|CCI-000877,CCI|CCI-002890,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.MA-2,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|IA-7,ITSG-33|IA-7a.,ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T2.3.4,NESA|T5.4.2,NESA|T5.4.4,NESA|T7.4.1,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-233627r609363_rule,STIG-ID|AOSX-13-000056,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-233627",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*(?i)KexAlgorithms(?-i)",
        "expect": "^[\\\\s]*(?i)KexAlgorithms(?-i)[\\\\s]+diffie-hellman-group-exchange-sha256[\\\\s]*$"
    },
    "custom_item_18": {
        "description": "AOSX-13-000057 - The macOS system must enforce requirements for remote connections to the information",
        "info": "The Screen Sharing feature allows remote users to view or control the desktop of the current user. A malicious user can take advantage of screen sharing to gain full access to the system remotely, either with stolen credentials or by guessing the username and password. Disabling Screen Sharing mitigates this risk.",
        "solution": "To disable the Screen Sharing service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-237767r648733_rule,STIG-ID|AOSX-13-000057,STIG-Legacy|SV-96195,STIG-Legacy|V-81481,SWIFT-CSCv1|2.3,Vuln-ID|V-237767",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.screensharing | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_19": {
        "description": "AOSX-13-000065 - The macOS system must be configured with Bluetooth turned off unless approved by the organization.",
        "info": "The Bluetooth kernel extension must be disabled, as wireless access introduces unnecessary security risks. Disabling Bluetooth support with a configuration profile mitigates this risk.",
        "solution": "This setting is enforced using the 'Bluetooth Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214812r609363_rule,STIG-ID|AOSX-13-000065,STIG-Legacy|SV-96197,STIG-Legacy|V-81483,SWIFT-CSCv1|2.3,Vuln-ID|V-214812",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableBluetooth | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"disabled\"}\\'",
        "expect": "(.*1|disabled)"
    },
    "custom_item_20": {
        "description": "AOSX-13-000070 - The macOS system must be configured with Wi-Fi support software disabled.",
        "info": "Use of Wi-Fi to connect to unauthorized networks may facilitate the exfiltration of mission data.\n\nSatisfies: SRG-OS-000300-GPOS-00118, SRG-OS-000480-GPOS-00227",
        "solution": "To disable the Wi-Fi network device, run the following command:\n\n/usr/bin/sudo /usr/sbin/networksetup -setnetworkserviceenabled 'Wi-Fi' off",
        "reference": "800-171|3.1.17,800-171|3.13.8,800-53|AC-18(1),800-53|SC-8,800-53r5|AC-18(1),800-53r5|SC-8,CAT|II,CCI|CCI-001443,CCI|CCI-001444,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|AC-18(1),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-214813r609363_rule,STIG-ID|AOSX-13-000070,STIG-Legacy|SV-96199,STIG-Legacy|V-81485,SWIFT-CSCv1|2.3,Vuln-ID|V-214813",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/System/Library/Extensions/IO80211Family.kext"
    },
    "custom_item_21": {
        "description": "AOSX-13-000075 - The macOS system must be configured with Infrared [IR] support disabled.",
        "info": "IR kernel support must be disabled to prevent users from controlling the system with IR devices. By default, if IR is enabled, the system will accept IR control from any remote device.",
        "solution": "To disable IR, run the following command:\n\n/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -bool FALSE",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214814r609363_rule,STIG-ID|AOSX-13-000075,STIG-Legacy|SV-96201,STIG-Legacy|V-81487,SWIFT-CSCv1|2.3,Vuln-ID|V-214814",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "0$",
        "plist_item": "DeviceEnabled",
        "plist_name": "/Library/Preferences/com.apple.driver.AppleIRController"
    },
    "custom_item_22": {
        "description": "AOSX-13-000085 - The macOS system must be configured with automatic actions disabled for blank CDs.",
        "info": "Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti-virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for blank CDs mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214815r609363_rule,STIG-ID|AOSX-13-000085,STIG-Legacy|SV-96203,STIG-Legacy|V-81489,SWIFT-CSCv1|2.3,Vuln-ID|V-214815",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[\\\\s]*action[\\\\s]*=[\\\\s]*1;",
        "plist_item": "com.apple.digihub.blank.cd.appeared",
        "plist_name": "com.apple.digihub",
        "plist_user": "all"
    },
    "custom_item_23": {
        "description": "AOSX-13-000090 - The macOS system must be configured with automatic actions disabled for blank DVDs.",
        "info": "Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti-virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for blank DVDs mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214816r609363_rule,STIG-ID|AOSX-13-000090,STIG-Legacy|SV-96205,STIG-Legacy|V-81491,SWIFT-CSCv1|2.3,Vuln-ID|V-214816",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[\\\\s]*action[\\\\s]*=[\\\\s]*1;",
        "plist_item": "com.apple.digihub.blank.dvd.appeared",
        "plist_name": "com.apple.digihub",
        "plist_user": "all"
    },
    "custom_item_24": {
        "description": "AOSX-13-000095 - The macOS system must be configured with automatic actions disabled for music CDs.",
        "info": "Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti-virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for music CDs mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214817r609363_rule,STIG-ID|AOSX-13-000095,STIG-Legacy|SV-96207,STIG-Legacy|V-81493,SWIFT-CSCv1|2.3,Vuln-ID|V-214817",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[\\\\s]*action[\\\\s]*=[\\\\s]*1;",
        "plist_item": "com.apple.digihub.cd.music.appeared",
        "plist_name": "com.apple.digihub",
        "plist_user": "all"
    },
    "custom_item_25": {
        "description": "AOSX-13-000100 - The macOS system must be configured with automatic actions disabled for picture CDs.",
        "info": "Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti-virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for picture CDs mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214818r609363_rule,STIG-ID|AOSX-13-000100,STIG-Legacy|SV-96211,STIG-Legacy|V-81497,SWIFT-CSCv1|2.3,Vuln-ID|V-214818",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[\\\\s]*action[\\\\s]*=[\\\\s]*1;",
        "plist_item": "com.apple.digihub.cd.picture.appeared",
        "plist_name": "com.apple.digihub",
        "plist_user": "all"
    },
    "custom_item_26": {
        "description": "AOSX-13-000105 - The macOS system must be configured with automatic actions disabled for video DVDs.",
        "info": "Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti-virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for video DVDs mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214819r609363_rule,STIG-ID|AOSX-13-000105,STIG-Legacy|SV-96213,STIG-Legacy|V-81499,SWIFT-CSCv1|2.3,Vuln-ID|V-214819",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "[\\\\s]*action[\\\\s]*=[\\\\s]*1;",
        "plist_item": "com.apple.digihub.dvd.video.appeared",
        "plist_name": "com.apple.digihub",
        "plist_user": "all"
    },
    "custom_item_27": {
        "description": "AOSX-13-000120 - The macOS system must generate audit records for all account creations, modifications, disabling, and termination events; privileged activities or other system-level access; all kernel module load, unload, and restart actions; all program initiations; and organizationally defined events for all non-local maintenance and diagnostic sessions.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. Audit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000327-GPOS-00127, SRG-OS-000392-GPOS-00172, SRG-OS-000471-GPOS-00215, SRG-OS-000471-GPOS-00216, SRG-OS-000476-GPOS-00221, SRG-OS-000477-GPOS-00222",
        "solution": "To ensure the appropriate flags are enabled for auditing, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control' file.",
        "reference": "800-171|3.1.1,800-171|3.1.7,800-171|3.3.1,800-171|3.3.2,800-171|3.7.5,800-53|AC-2(4),800-53|AC-6(9),800-53|AU-12c.,800-53|MA-4(1)(a),800-53r5|AC-2(4),800-53r5|AC-6(9),800-53r5|AU-12c.,800-53r5|MA-4(1)(a),CAT|II,CCI|CCI-000018,CCI|CCI-000172,CCI|CCI-001403,CCI|CCI-001404,CCI|CCI-001405,CCI|CCI-002234,CCI|CCI-002884,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.2(d),CN-L3|8.1.4.3(a),CN-L3|8.1.10.6(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.MA-2,CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.12.4.1,ISO/IEC-27001|A.12.4.3,ITSG-33|AC-2(4),ITSG-33|AC-6,ITSG-33|AU-12c.,ITSG-33|MA-4(1),NESA|T2.3.4,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,NIAv2|AM23f,NIAv2|SM8,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.1,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-214822r609363_rule,STIG-ID|AOSX-13-000120,STIG-Legacy|SV-96219,STIG-Legacy|V-81505,SWIFT-CSCv1|5.1,SWIFT-CSCv1|6.4,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|36.2.3,TBA-FIISB|45.1.1,TBA-FIISB|45.2.3,Vuln-ID|V-214822",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*ad).*$"
    },
    "custom_item_28": {
        "description": "AOSX-13-000139 - The macOS system must be configured to disable SMB File Sharing unless it is required.",
        "info": "File Sharing is usually non-essential and must be disabled if not required. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.",
        "solution": "To disable the SMB File Sharing service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.smbd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214823r609363_rule,STIG-ID|AOSX-13-000139,STIG-Legacy|SV-96221,STIG-Legacy|V-81507,SWIFT-CSCv1|2.3,Vuln-ID|V-214823",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.smbd | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_29": {
        "description": "AOSX-13-000140 - The macOS system must be configured to disable Apple File (AFP) Sharing.",
        "info": "File Sharing is non-essential and must be disabled. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.",
        "solution": "To disable the Apple File (AFP) Sharing service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.AppleFileServer\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214824r609363_rule,STIG-ID|AOSX-13-000140,STIG-Legacy|SV-96223,STIG-Legacy|V-81509,SWIFT-CSCv1|2.3,Vuln-ID|V-214824",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.AppleFileServer | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_30": {
        "description": "AOSX-13-000141 - The macOS system must be configured to disable the Network File System (NFS) daemon unless it is required.",
        "info": "If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is non-essential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.",
        "solution": "To disable the NFS daemon, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214825r609363_rule,STIG-ID|AOSX-13-000141,STIG-Legacy|SV-96225,STIG-Legacy|V-81511,SWIFT-CSCv1|2.3,Vuln-ID|V-214825",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.nfsd | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_31": {
        "description": "AOSX-13-000142 - The macOS system must be configured to disable the Network File System (NFS) lock daemon unless it is required.",
        "info": "If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is non-essential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.",
        "solution": "To disable the NFS lock daemon, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.lockd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214826r609363_rule,STIG-ID|AOSX-13-000142,STIG-Legacy|SV-96227,STIG-Legacy|V-81513,SWIFT-CSCv1|2.3,Vuln-ID|V-214826",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.lockd | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_32": {
        "description": "AOSX-13-000143 - The macOS system must be configured to disable the Network File System (NFS) stat daemon unless it is required.",
        "info": "If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is non-essential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.",
        "solution": "To disable the NFS stat daemon, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.statd.notify\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214827r609363_rule,STIG-ID|AOSX-13-000143,STIG-Legacy|SV-96229,STIG-Legacy|V-81515,SWIFT-CSCv1|2.3,Vuln-ID|V-214827",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.statd | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_33": {
        "description": "AOSX-13-000186 - The macOS system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the operating system.",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.",
        "solution": "Create a text file containing the required DoD text.\n\nName the file 'banner' and place it in '/etc/'.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|II,CCI|CCI-000048,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-214829r609363_rule,STIG-ID|AOSX-13-000186,STIG-Legacy|SV-96233,STIG-Legacy|V-81519,TBA-FIISB|45.2.4,Vuln-ID|V-214829",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/banner"
    },
    "custom_item_34": {
        "description": "AOSX-13-000187 - The macOS system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via SSH.",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000024-GPOS-00007",
        "solution": "For systems that allow remote access through SSH, modify the '/etc/ssh/sshd_config' file to add or update the following line:\n\nBanner /etc/banner",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53r5|AC-8a.,800-53r5|AC-8b.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-214830r609363_rule,STIG-ID|AOSX-13-000187,STIG-Legacy|SV-96235,STIG-Legacy|V-81521,TBA-FIISB|45.2.4,Vuln-ID|V-214830",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^Banner.*",
        "expect": "^Banner[\\\\s]+/etc/banner"
    },
    "custom_item_35": {
        "description": "Check PolicyBanner.rtf file exist",
        "file": "/Library/Security/PolicyBanner.rtf"
    },
    "custom_item_36": {
        "description": "AOSX-13-000195 - The macOS system must be configured so that any connection to the system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system - 'Banner file'",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000024-GPOS-00007, SRG-OS-000228-GPOS-00088",
        "solution": "Create an RTF file containing the required text. Name the file 'PolicyBanner.rtf' or 'PolicyBanner.rtfd' and place it in '/Library/Security/'.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8b.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-214831r609363_rule,STIG-ID|AOSX-13-000195,STIG-Legacy|SV-96237,STIG-Legacy|V-81523,TBA-FIISB|45.2.4,Vuln-ID|V-214831",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/Library/Security/PolicyBanner.rtf"
    },
    "custom_item_37": {
        "description": "AOSX-13-000195 - The macOS system must be configured so that any connection to the system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system - 'Banner text'",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000024-GPOS-00007, SRG-OS-000228-GPOS-00088",
        "solution": "Create an RTF file containing the required text. Name the file 'PolicyBanner.rtf' or 'PolicyBanner.rtfd' and place it in '/Library/Security/'.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8b.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-214831r609363_rule,STIG-ID|AOSX-13-000195,STIG-Legacy|SV-96237,STIG-Legacy|V-81523,TBA-FIISB|45.2.4,Vuln-ID|V-214831",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/awk '{ printf $0 }' /Library/Security/PolicyBanner.rtf",
        "expect": "@BANNER_TEXT@"
    },
    "custom_item_38": {
        "description": "AOSX-13-000195 - The macOS system must be configured so that any connection to the system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system - 'Banner file'",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000024-GPOS-00007, SRG-OS-000228-GPOS-00088",
        "solution": "Create an RTF file containing the required text. Name the file 'PolicyBanner.rtf' or 'PolicyBanner.rtfd' and place it in '/Library/Security/'.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8b.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-214831r609363_rule,STIG-ID|AOSX-13-000195,STIG-Legacy|SV-96237,STIG-Legacy|V-81523,TBA-FIISB|45.2.4,Vuln-ID|V-214831",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/Library/Security/PolicyBanner.rtfd"
    },
    "custom_item_39": {
        "description": "AOSX-13-000195 - The macOS system must be configured so that any connection to the system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system - 'Banner text'",
        "info": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\nSatisfies: SRG-OS-000023-GPOS-00006, SRG-OS-000024-GPOS-00007, SRG-OS-000228-GPOS-00088",
        "solution": "Create an RTF file containing the required text. Name the file 'PolicyBanner.rtf' or 'PolicyBanner.rtfd' and place it in '/Library/Security/'.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53|AC-8b.,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8a.,800-53r5|AC-8b.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-000048,CCI|CCI-000050,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,ITSG-33|AC-8b.,ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,NIAv2|AM10f,Rule-ID|SV-214831r609363_rule,STIG-ID|AOSX-13-000195,STIG-Legacy|SV-96237,STIG-Legacy|V-81523,TBA-FIISB|45.2.4,Vuln-ID|V-214831",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/awk '{ printf $0 }' /Library/Security/PolicyBanner.rtfd",
        "expect": "@BANNER_TEXT@"
    },
    "custom_item_40": {
        "description": "AOSX-13-000200 - The macOS system must generate audit records for DoD-defined events such as successful/unsuccessful logon attempts, successful/unsuccessful direct access attempts, starting and ending time for user access, and concurrent logons to the same account from different sources.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nSatisfies: SRG-OS-000470-GPOS-00214, SRG-OS-000472-GPOS-00217, SRG-OS-000473-GPOS-00218, SRG-OS-000475-GPOS-00220",
        "solution": "To ensure the appropriate flags are enabled for auditing, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control' file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214832r609363_rule,STIG-ID|AOSX-13-000200,STIG-Legacy|SV-96239,STIG-Legacy|V-81525,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-214832",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*aa).*$"
    },
    "custom_item_41": {
        "description": "AOSX-13-000230 - The macOS system must initiate session audits at system startup, using internal clocks with time stamps for audit records that meet a minimum granularity of one second and can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).",
        "info": "Without establishing what type of events occurred, when they occurred, and by whom it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured operating system.\n\nSatisfies: SRG-OS-000037-GPOS-00015, SRG-OS-000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018, SRG-OS-000041-GPOS-00019, SRG-OS-000042-GPOS-00020, SRG-OS-000042-GPOS-00021, SRG-OS-000055-GPOS-00026, SRG-OS-000254-GPOS-00095, SRG-OS-000255-GPOS-00096, SRG-OS-000255-GPOS-00096, SRG-OS-000299-GPOS-00117, SRG-OS-000303-GPOS-00120, SRG-OS-000358-GPOS-00145, SRG-OS-000359-GPOS-00146",
        "solution": "To enable the audit service, run the following command:\n\n/usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist",
        "reference": "800-171|3.1.1,800-171|3.1.17,800-171|3.3.1,800-171|3.3.2,800-171|3.3.7,800-53|AC-2(4),800-53|AC-18(1),800-53|AU-3,800-53|AU-3(1),800-53|AU-8a.,800-53|AU-8b.,800-53|AU-14(1),800-53r5|AC-2(4),800-53r5|AC-18(1),800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-8a.,800-53r5|AU-8b.,800-53r5|AU-14(1),CAT|II,CCI|CCI-000130,CCI|CCI-000131,CCI|CCI-000132,CCI|CCI-000133,CCI|CCI-000134,CCI|CCI-000135,CCI|CCI-000159,CCI|CCI-001444,CCI|CCI-001464,CCI|CCI-001487,CCI|CCI-001889,CCI|CCI-001890,CCI|CCI-002130,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),ITSG-33|AC-18(1),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-8,ITSG-33|AU-8a.,ITSG-33|AU-14,NESA|T3.6.2,NESA|T3.6.7,NESA|T5.2.2,NESA|T5.4.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-214833r609363_rule,STIG-ID|AOSX-13-000230,STIG-Legacy|SV-96241,STIG-Legacy|V-81527,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.4,TBA-FIISB|36.2.3,TBA-FIISB|37.4,Vuln-ID|V-214833",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl list | /usr/bin/grep com\\\\.apple\\\\.auditd | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"; else print \"auditd not found\"}\\'",
        "expect": "pass"
    },
    "custom_item_42": {
        "description": "AOSX-13-000240 - The macOS system must enable System Integrity Protection.",
        "info": "The System Integrity Protection is vital to prevent unauthorized and unintended information transfer via shared system resources, protect audit tools from unauthorized access, modification, and deletion, limit privileges to change software resident within software libraries, limit the ability of non-privileged users to grant other users direct access to the contents of their home directories/folders.\n\nSIP also ensures the presence of an audit record generation capability for DoD-defined auditable events for all operating system components, supports on-demand and after-the-fact reporting requirements, does not alter original content or time ordering of audit records.\n\nSatisfies: SRG-OS-000051-GPOS-00024, SRG-OS-000054-GPOS-00025, SRG-OS-000062-GPOS-00031, SRG-OS-000122-GPOS-00063, SRG-OS-000138-GPOS-00069, SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098, SRG-OS-000258-GPOS-00099, SRG-OS-000259-GPOS-00100, SRG-OS-000348-GPOS-00136, SRG-OS-000349-GPOS-00137, SRG-OS-000350-GPOS-00138, SRG-OS-000351-GPOS-00139, SRG-OS-000352-GPOS-00140, SRG-OS-000353-GPOS-00141, SRG-OS-000354-GPOS-00142, SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00230",
        "solution": "To reenable 'System Integrity Protection', boot the affected system into 'Recovery' mode, launch 'Terminal' from the 'Utilities' menu, and run the following command:\n\n/usr/bin/csrutil enable",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171|3.3.8,800-171|3.4.2,800-171|3.4.5,800-171|3.13.4,800-53|AU-6(4),800-53|AU-7a.,800-53|AU-7b.,800-53|AU-7(1),800-53|AU-9,800-53|AU-12a.,800-53|CM-5(6),800-53|CM-6b.,800-53|SC-4,800-53r5|AU-6(4),800-53r5|AU-7a.,800-53r5|AU-7b.,800-53r5|AU-7(1),800-53r5|AU-9,800-53r5|AU-12a.,800-53r5|CM-5(6),800-53r5|CM-6b.,800-53r5|SC-4,CAT|II,CCI|CCI-000154,CCI|CCI-000158,CCI|CCI-000169,CCI|CCI-000366,CCI|CCI-001090,CCI|CCI-001493,CCI|CCI-001494,CCI|CCI-001495,CCI|CCI-001499,CCI|CCI-001875,CCI|CCI-001876,CCI|CCI-001877,CCI|CCI-001878,CCI|CCI-001879,CCI|CCI-001880,CCI|CCI-001881,CCI|CCI-001882,CN-L3|7.1.2.3(c),CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CN-L3|8.1.10.6(d),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|DE.DP-4,CSF|PR.IP-1,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-6(4),ITSG-33|AU-7,ITSG-33|AU-7(1),ITSG-33|AU-9,ITSG-33|AU-12a.,ITSG-33|CM-5(6),ITSG-33|CM-6b.,ITSG-33|SC-4,ITSG-33|SC-4a.,NESA|M5.2.3,NESA|M5.2.5,NESA|M5.5.2,NESA|T3.2.1,NESA|T3.2.3,NESA|T3.6.3,NESA|T3.6.4,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,Rule-ID|SV-214834r609363_rule,STIG-ID|AOSX-13-000240,STIG-Legacy|SV-96243,STIG-Legacy|V-81529,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.4,Vuln-ID|V-214834",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/csrutil status",
        "expect": "System Integrity Protection status: enabled"
    },
    "custom_item_43": {
        "description": "AOSX-13-000295 - The macOS system must allocate audit record storage capacity to store at least one weeks worth of audit records when audit records are not immediately sent to a central audit record storage facility.",
        "info": "The audit service must be configured to require that records are kept for seven days or longer before deletion when there is no central audit record storage facility. When 'expire-after' is set to '7d', the audit service will not delete audit logs until the log data is at least seven days old.",
        "solution": "Edit the '/etc/security/audit_control' file and change the value for 'expire-after' to the amount of time audit logs should be kept for the system. Use the following command to set the 'expire-after' value to '7d':\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control' file.",
        "reference": "800-53|AU-4,800-53r5|AU-4,CAT|II,CCI|CCI-001849,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214835r609363_rule,STIG-ID|AOSX-13-000295,STIG-Legacy|SV-96245,STIG-Legacy|V-81531,Vuln-ID|V-214835",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^expire-after:",
        "expect": "^expire-after:[\\\\s]*([7-9]|[1-9][0-9]+)[Dd][\\\\s]*$"
    },
    "custom_item_44": {
        "description": "AOSX-13-000305 - The macOS system must provide an immediate warning to the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity.",
        "info": "The audit service must be configured to require a minimum percentage of free disk space in order to run. This ensures that audit will notify the administrator that action is required to free up more disk space for audit logs.\n\nWhen 'minfree' is set to 25 percent, security personnel are notified immediately when the storage volume is 75 percent full and are able to plan for audit record storage capacity expansion.",
        "solution": "Edit the '/etc/security/audit_control' file and change the value for 'minfree' to '25' using the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control file'.",
        "reference": "800-171|3.3.4,800-53|AU-5(1),800-53r5|AU-5(1),CAT|II,CCI|CCI-001855,CN-L3|7.1.3.7(e),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(1),NESA|T3.3.1,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214836r609363_rule,STIG-ID|AOSX-13-000305,STIG-Legacy|SV-96247,STIG-Legacy|V-81533,TBA-FIISB|37.3.2,Vuln-ID|V-214836",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^minfree:",
        "expect": "^minfree:[\\\\s]*25[\\\\s]*$"
    },
    "custom_item_45": {
        "description": "AOSX-13-000310 - The macOS system must provide an immediate real-time alert to the System Administrator (SA) and Information System Security Officer (ISSO), at a minimum, of all audit failure events requiring real-time alerts.",
        "info": "The audit service should be configured to immediately print messages to the console or email administrator users when an auditing failure occurs. It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.",
        "solution": "To make 'auditd' log errors to standard error as well as 'syslogd', run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/bin/sudo /usr/sbin/audit -s",
        "reference": "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|II,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214837r609363_rule,STIG-ID|AOSX-13-000310,STIG-Legacy|SV-96249,STIG-Legacy|V-81535,Vuln-ID|V-214837",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_warn",
        "regex": "^[\\\\s]*logger[\\\\s]+",
        "expect": "^[\\\\s]*logger[\\\\s]+(?=.*-p)(?=.*-s)"
    },
    "custom_item_46": {
        "description": "AOSX-13-000330 - The macOS system must, for networked systems, compare internal information system clocks at least every 24 hours with a server that is synchronized to one of the redundant United States Naval Observatory (USNO) time servers or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet) and/or the Global Positioning System (GPS).",
        "info": "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\nSatisfies: SRG-OS-000355-GPOS-00143, SRG-OS-000356-GPOS-00144",
        "solution": "To enable the NTP service, run the following command:\n\n/usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.timed.plist\n\nTo configure one or more time servers for use, edit '/etc/ntp.conf' and enter each hostname or IP address on a separate line, prefixing each one with the keyword 'server'.",
        "reference": "800-171|3.3.7,800-53|AU-8(1)(a),800-53|AU-8(1)(b),800-53r5|SC-45(1),CAT|II,CCI|CCI-001891,CCI|CCI-002046,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.2.1|10.4,PCI-DSSv3.2.1|10.4.1,PCI-DSSv3.2.1|10.4.3,PCI-DSSv4.0|10.6,PCI-DSSv4.0|10.6.1,PCI-DSSv4.0|10.6.2,PCI-DSSv4.0|10.6.3,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214838r609363_rule,STIG-ID|AOSX-13-000330,STIG-Legacy|SV-96251,STIG-Legacy|V-81537,TBA-FIISB|37.4,Vuln-ID|V-214838",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl list | /usr/bin/grep com\\\\.apple\\\\.timed | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"; else print \"ntpd not found\"}\\'",
        "expect": "pass"
    },
    "custom_item_47": {
        "description": "AOSX-13-000331 - The macOS system must be configured with audit log files owned by root.",
        "info": "The audit service must be configured to create log files with the correct ownership to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log file that returns an incorrect owner, run the following command:\n\n/usr/bin/sudo chown root [audit log file]\n\n[audit log file] is the full path to the log file in question.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214839r609363_rule,STIG-ID|AOSX-13-000331,STIG-Legacy|SV-96253,STIG-Legacy|V-81539,Vuln-ID|V-214839",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit/*",
        "owner": "root"
    },
    "custom_item_48": {
        "description": "AOSX-13-000332 - The macOS system must be configured with audit log folders owned by root.",
        "info": "The audit service must be configured to create log files with the correct ownership to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log folder that has an incorrect owner, run the following command:\n\n/usr/bin/sudo chown root [audit log folder]",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214840r609363_rule,STIG-ID|AOSX-13-000332,STIG-Legacy|SV-96255,STIG-Legacy|V-81541,Vuln-ID|V-214840",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit/*",
        "owner": "root"
    },
    "custom_item_49": {
        "description": "AOSX-13-000333 - The macOS system must be configured with audit log files group-owned by wheel.",
        "info": "The audit service must be configured to create log files with the correct group ownership to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log file that returns an incorrect group owner, run the following command:\n\n/usr/bin/sudo chgrp wheel [audit log file]\n\n[audit log file] is the full path to the log file in question.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214841r609363_rule,STIG-ID|AOSX-13-000333,STIG-Legacy|SV-96257,STIG-Legacy|V-81543,Vuln-ID|V-214841",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit/*",
        "group": "wheel"
    },
    "custom_item_50": {
        "description": "AOSX-13-000334 - The macOS system must be configured with audit log folders group-owned by wheel.",
        "info": "The audit service must be configured to create log files with the correct group ownership to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log folder that has an incorrect group, run the following command:\n\n/usr/bin/sudo chgrp wheel [audit log folder]",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214842r609363_rule,STIG-ID|AOSX-13-000334,STIG-Legacy|SV-96259,STIG-Legacy|V-81545,Vuln-ID|V-214842",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit/*",
        "group": "wheel"
    },
    "custom_item_51": {
        "description": "AOSX-13-000335 - The macOS system must be configured with audit log files set to mode 440 or less permissive.",
        "info": "The audit service must be configured to create log files with the correct permissions to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log file that returns an incorrect permission value, run the following command:\n\n/usr/bin/sudo chmod 440 [audit log file]\n\n[audit log file] is the full path to the log file in question.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214843r609363_rule,STIG-ID|AOSX-13-000335,STIG-Legacy|SV-96261,STIG-Legacy|V-81547,Vuln-ID|V-214843",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit/*",
        "mask": "337"
    },
    "custom_item_52": {
        "description": "AOSX-13-000336 - The macOS system must be configured with audit log folders set to mode 700 or less permissive.",
        "info": "The audit service must be configured to create log folders with the correct permissions to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\nSatisfies: SRG-OS-000057-GPOS-00027, SRG-OS-000058-GPOS-00028, SRG-OS-000059-GPOS-00029",
        "solution": "For any log folder that returns an incorrect permission value, run the following command:\n\n/usr/bin/sudo chmod 700 [audit log folder]",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214844r609363_rule,STIG-ID|AOSX-13-000336,STIG-Legacy|SV-96263,STIG-Legacy|V-81549,Vuln-ID|V-214844",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/var/audit",
        "mask": "077"
    },
    "custom_item_53": {
        "description": "AOSX-13-000337 - The macOS system must be configured so that log files must not contain access control lists (ACLs).",
        "info": "The audit service must be configured to create log files with the correct permissions to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log file that contains ACLs, run the following command:\n\n/usr/bin/sudo chmod -N [audit log file]",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214845r609363_rule,STIG-ID|AOSX-13-000337,STIG-Legacy|SV-96265,STIG-Legacy|V-81551,Vuln-ID|V-214845",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/ls -la /var/audit | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\\\\+ | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_54": {
        "description": "AOSX-13-000338 - The macOS system must be configured so that log folders must not contain access control lists (ACLs).",
        "info": "The audit service must be configured to create log folders with the correct permissions to prevent regular users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.",
        "solution": "For any log folder that contains ACLs, run the following command:\n\n/usr/bin/sudo chmod -N [audit log folder]",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214846r609363_rule,STIG-ID|AOSX-13-000338,STIG-Legacy|SV-96267,STIG-Legacy|V-81553,Vuln-ID|V-214846",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/ls -lde /var/audit | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\\\\+ | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_55": {
        "description": "AOSX-13-000430 - The macOS system must have the security assessment policy subsystem enabled.",
        "info": "Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.\n\nAccordingly, software defined by the organization as critical must be signed with a certificate that is recognized and approved by the organization.",
        "solution": "To enable the Security assessment policy subsystem, run the following command:\n\n/usr/bin/sudo /usr/sbin/spctl --master-enable",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|I,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-214847r609363_rule,STIG-ID|AOSX-13-000430,STIG-Legacy|SV-96269,STIG-Legacy|V-81555,Vuln-ID|V-214847",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/spctl --status",
        "expect": "^[\\\\s]*assessments[\\\\s]+enabled"
    },
    "custom_item_56": {
        "description": "AOSX-13-000505 - The macOS system must be configured to disable the iCloud Calendar services.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe application Calendar establishes connections to Apple's iCloud, despite using security controls to disable iCloud access.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|III,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214850r609363_rule,STIG-ID|AOSX-13-000505,STIG-Legacy|SV-96275,STIG-Legacy|V-81561,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214850",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'/Applications/Calendar.app/\\'",
        "expect": "\\\\\"/Applications/Calendar.app/\\\\\","
    },
    "custom_item_57": {
        "description": "AOSX-13-000507 - The macOS system must be configured to disable the iCloud Reminders services.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe application Reminders establishes connections to Apple's iCloud, despite using security controls to disable iCloud access.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|III,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214851r609363_rule,STIG-ID|AOSX-13-000507,STIG-Legacy|SV-96277,STIG-Legacy|V-81563,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214851",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'/Applications/Reminders.app/\\'",
        "expect": "\\\\\"/Applications/Reminders.app/\\\\\","
    },
    "custom_item_58": {
        "description": "AOSX-13-000510 - The macOS system must be configured to disable iCloud Address Book services.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe application Address Book establishes connections to Apple's iCloud, despite using security controls to disable iCloud access.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|III,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214852r609363_rule,STIG-ID|AOSX-13-000510,STIG-Legacy|SV-96279,STIG-Legacy|V-81565,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214852",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'/Applications/Contacts.app/\\'",
        "expect": "\\\\\"/Applications/Contacts.app/\\\\\","
    },
    "custom_item_59": {
        "description": "AOSX-13-000515 - The macOS system must be configured to disable the iCloud Mail services.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe application Mail establishes connections to Apple's iCloud, despite using security controls to disable iCloud access.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|III,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214853r609363_rule,STIG-ID|AOSX-13-000515,STIG-Legacy|SV-96281,STIG-Legacy|V-81567,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214853",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'/Applications/Mail.app/\\'",
        "expect": "\\\\\"/Applications/Mail.app/\\\\\","
    },
    "custom_item_60": {
        "description": "AOSX-13-000517 - The macOS system must be configured to disable the iCloud Notes services.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe application Notes establishes connections to Apple's iCloud, despite using security controls to disable iCloud access.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|III,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214854r609363_rule,STIG-ID|AOSX-13-000517,STIG-Legacy|SV-96283,STIG-Legacy|V-81569,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214854",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'/Applications/Notes.app/\\'",
        "expect": "\\\\\"/Applications/Notes.app/\\\\\","
    },
    "custom_item_61": {
        "description": "AOSX-13-000518 - The macOS system must cover or disable the built-in or attached camera when not in use.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nFailing to disconnect from collaborative computing devices (i.e. cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants actually carry out the disconnect activity without having to go through complex and tedious procedures.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214855r609363_rule,STIG-ID|AOSX-13-000518,STIG-Legacy|SV-96285,STIG-Legacy|V-81571,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214855",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'allowCamera\\'",
        "expect": "allowCamera[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_62": {
        "description": "AOSX-13-000520 - The macOS system must be configured to disable the system preference pane for iCloud.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system preference panes for iCloud and Internet Accounts must be disabled.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|I,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214856r609363_rule,STIG-ID|AOSX-13-000520,STIG-Legacy|SV-96287,STIG-Legacy|V-81573,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214856",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'DisabledPreferencePanes\\' | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\"}\\'",
        "expect": "DisabledPreferencePanes"
    },
    "custom_item_63": {
        "description": "AOSX-13-000521 - The macOS system must be configured to disable the system preference pane for Internet Accounts.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system preference panes for iCloud and Internet Accounts must be disabled.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214857r609363_rule,STIG-ID|AOSX-13-000521,STIG-Legacy|SV-96289,STIG-Legacy|V-81575,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214857",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep com.apple.preferences.internetaccounts | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\"}\\'",
        "expect": ".*com.apple.preferences.internetaccounts.*"
    },
    "custom_item_64": {
        "description": "AOSX-13-000522 - The macOS system must be configured to disable the system preference pane for Siri.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system preference panes for Siri and dictation must be disabled.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214858r609363_rule,STIG-ID|AOSX-13-000522,STIG-Legacy|SV-96291,STIG-Legacy|V-81577,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214858",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep com.apple.preference.speech | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\"}\\'",
        "expect": ".*com.apple.preference.speech.*"
    },
    "custom_item_65": {
        "description": "AOSX-13-000523 - The macOS system must be configured to disable Siri and dictation.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system preference panes for Siri and dictation must be disabled.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214859r609363_rule,STIG-ID|AOSX-13-000523,STIG-Legacy|SV-96293,STIG-Legacy|V-81579,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214859",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'(allowAssistant|IronwoodAllowed)\\'",
        "expect": "(allowAssistant|IronwoodAllowed)[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_66": {
        "description": "AOSX-13-000530 - The macOS system must be configured to disable sending diagnostic and usage data to Apple.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nSending diagnostic and usage data to Apple must be disabled.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.\n\nThe setting 'Share Mac Analytics' is found in System Preferences >> Security & Privacy >> Privacy >> Analytics.\n\nUncheck the box that says 'Share Mac Analytics'.\n\nTo apply the setting from the command line, run the following commands:\n\n/usr/bin/defaults read '/Library/Application Support/CrashReporter/DiagnosticMessagesHistory.plist' AutoSubmit\n/usr/bin/sudo /usr/bin/defaults write '/Library/Application Support/CrashReporter/DiagnosticMessagesHistory.plist' AutoSubmit -bool false\n/usr/bin/sudo /bin/chmod 644 /Library/Application\\ Support/CrashReporter/DiagnosticMessagesHistory.plist\n/usr/bin/sudo /usr/bin/chgrp admin /Library/Application\\ Support/CrashReporter/DiagnosticMessagesHistory.plist",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-214860r609363_rule,STIG-ID|AOSX-13-000530,STIG-Legacy|SV-96313,STIG-Legacy|V-81599,SWIFT-CSCv1|2.3,Vuln-ID|V-214860",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowDiagnosticSubmission",
        "expect": "^[\\\\s]*allowDiagnosticSubmission[\\\\s]*=[\\\\s]*0"
    },
    "custom_item_67": {
        "description": "AOSX-13-000531 - The macOS system must be configured to disable the iCloud Find My Mac service.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nFind My Mac must be disabled.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214861r609363_rule,STIG-ID|AOSX-13-000531,STIG-Legacy|SV-96315,STIG-Legacy|V-81601,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214861",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudFMM",
        "expect": "^[\\\\s]*allowCloudFMM[\\\\s]*=[\\\\s]*0;"
    },
    "custom_item_68": {
        "description": "AOSX-13-000535 - The macOS system must be configured to disable Location Services.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nLocation Services must be disabled.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.\n\nThe setting 'Enable Location Services' can be found in System Preferences >> Security & Privacy >> Privacy >> Location Services. Uncheck the box that says 'Enable Location Services'.\n\nIt can also be set with the following command:\n\n/usr/bin/sudo /usr/bin/defaults write /private/var/db/locationd/Library/Preferences/ByHost/com.apple.locationd.'/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep 'Hardware UUID' | /usr/bin/cut -c22-57' LocationServicesEnabled -bool false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214862r609363_rule,STIG-ID|AOSX-13-000535,STIG-Legacy|SV-96317,STIG-Legacy|V-81603,SWIFT-CSCv1|2.3,Vuln-ID|V-214862",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableLocationServices",
        "expect": "^[\\\\s]*DisableLocationServices[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_69": {
        "description": "AOSX-13-000545 - The macOS system must be configured to disable Bonjour multicast advertising.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nBonjour multicast advertising must be disabled on the system.",
        "solution": "To configure Bonjour to disable multicast advertising, run the following command:\n\n/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true\n\nThe system will need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214863r609363_rule,STIG-ID|AOSX-13-000545,STIG-Legacy|SV-96319,STIG-Legacy|V-81605,SWIFT-CSCv1|2.3,Vuln-ID|V-214863",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/grep ProgramArguments /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist -A 10 | /usr/bin/grep \\'NoMulticastAdvertisements\\'",
        "expect": ".*-NoMulticastAdvertisements.*"
    },
    "custom_item_70": {
        "description": "AOSX-13-000550 - The macOS system must be configured to disable the UUCP service.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system must not have the UUCP service active.",
        "solution": "To disable the UUCP service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.uucp\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214864r609363_rule,STIG-ID|AOSX-13-000550,STIG-Legacy|SV-96321,STIG-Legacy|V-81607,SWIFT-CSCv1|2.3,Vuln-ID|V-214864",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.uucp | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_71": {
        "description": "AOSX-13-000551 - The macOS system must disable the Touch ID feature.",
        "info": "The Touch ID feature permits users to add additional fingerprints to unlock the host. These fingerprints may be for the user or anyone else. Because unauthorized users may gain access to the system, the use of Touch ID must be limited.",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214865r609363_rule,STIG-ID|AOSX-13-000551,STIG-Legacy|SV-96323,STIG-Legacy|V-81609,SWIFT-CSCv1|2.3,Vuln-ID|V-214865",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowFingerprintForUnlock",
        "expect": "^[\\\\s]*allowFingerprintForUnlock[\\\\s]*=[\\\\s]*0"
    },
    "custom_item_72": {
        "description": "AOSX-13-000552 - The macOS system must obtain updates from a DoD-approved update server.",
        "info": "Software update configuration. Point to DOD approved update server. Configure for automatic install of critical updates.",
        "solution": "To remove the Apple software list from the system configuration run the following command:\n\nsudo defaults delete /Library/Preferences/com.apple.SoftwareUpdate.plist CatalogURL",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214866r609363_rule,STIG-ID|AOSX-13-000552,STIG-Legacy|SV-96325,STIG-Legacy|V-81611,SWIFT-CSCv1|2.3,Vuln-ID|V-214866",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist CatalogURL",
        "expect": "The domain/default pair of .*SoftwareUpdate.*CatalogURL.* does not exist"
    },
    "custom_item_73": {
        "description": "AOSX-13-000553 - The macOS system must not have a root account.",
        "info": "To assure individual accountability and prevent unauthorized access, organizational users must be individually identified and authenticated.",
        "solution": "Disable the root account with the following command:\n\n/usr/sbin/dsenableroot -d",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214867r609363_rule,STIG-ID|AOSX-13-000553,STIG-Legacy|SV-96327,STIG-Legacy|V-81613,SWIFT-CSCv1|2.3,Vuln-ID|V-214867",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/defaults read /var/db/dslocal/nodes/Default/users/root.plist passwd",
        "expect": "^[\\\\s]*\"\\\\*\"[\\\\s]*$"
    },
    "custom_item_74": {
        "description": "AOSX-13-000554 - The macOS system must not have a guest account - Guest account",
        "info": "Only authorized individuals should be allowed to obtain access to operating system components. Permitting access via a guest account provides unauthenticated access to any person.",
        "solution": "Remove the guest user with the following command:\n\nsudo dscl . delete /Users/Guest\n\n'This can also be managed with 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.4.5,800-53|CM-5(1),800-53r5|CM-5(1),CAT|I,CCI|CCI-001813,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-214868r609363_rule,STIG-ID|AOSX-13-000554,STIG-Legacy|SV-96329,STIG-Legacy|V-81615,Vuln-ID|V-214868",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/dscl . list /Users | grep -i Guest | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"; else print \"false\"}\\'",
        "expect": "^pass$"
    },
    "custom_item_75": {
        "description": "AOSX-13-000554 - The macOS system must not have a guest account - Guest fdesetup",
        "info": "Only authorized individuals should be allowed to obtain access to operating system components. Permitting access via a guest account provides unauthenticated access to any person.",
        "solution": "Remove the guest user with the following command:\n\nsudo dscl . delete /Users/Guest\n\n'This can also be managed with 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.4.5,800-53|CM-5(1),800-53r5|CM-5(1),CAT|I,CCI|CCI-001813,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-214868r609363_rule,STIG-ID|AOSX-13-000554,STIG-Legacy|SV-96329,STIG-Legacy|V-81615,Vuln-ID|V-214868",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/fdesetup list | /usr/bin/grep -i guest | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"; else print \"false\"}\\'",
        "expect": "^pass$"
    },
    "custom_item_76": {
        "description": "AOSX-13-000555 - The macOS system must unload tftpd.",
        "info": "The 'tftp' service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling ftp is one way to mitigate this risk. Administrators should be instructed to use an alternate service for data transmission that uses encryption, such as SFTP.\n\nAdditionally, the 'tftp' service uses UDP, which is not secure.",
        "solution": "To disable the 'tfpd' service, run the following command:\n\nsudo launchctl unload -w /System/Library/LaunchDaemons/tftp.plist",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|I,CCI|CCI-000197,CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214869r609363_rule,STIG-ID|AOSX-13-000555,STIG-Legacy|SV-96331,STIG-Legacy|V-81617,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-214869",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep -i tftp | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\";}\\'",
        "expect": "^[\\\\s]*\"com.apple.tftp\"[\\\\s]*=>[\\\\s]*true$"
    },
    "custom_item_77": {
        "description": "AOSX-13-000556 - The macOS system must disable Siri pop-ups.",
        "info": "Users (and any processes acting on behalf of users) need to be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization, which outlines specific user actions that can be performed on the Ubuntu operating system without identification or authentication.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Login Window' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214870r609363_rule,STIG-ID|AOSX-13-000556,STIG-Legacy|SV-96333,STIG-Legacy|V-81619,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214870",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep SkipSiriSetup",
        "expect": "^[\\\\s]*SkipSiriSetup[\\\\s]*=[\\\\s]*1;$"
    },
    "custom_item_78": {
        "description": "AOSX-13-000557 - The macOS system must disable iCloud Back to My Mac feature.",
        "info": "The Back to My Mac is an iCloud feature permitting users to connect to a Mac, AirPort Disk, or Time Capsule using another Mac or another Internet connected device. When connected users can transfer data and see a live version of the screen content.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214871r609363_rule,STIG-ID|AOSX-13-000557,STIG-Legacy|SV-96335,STIG-Legacy|V-81621,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214871",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudBTMM",
        "expect": "^[\\\\s]*allowCloudBTMM[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_79": {
        "description": "AOSX-13-000558 - The macOS system must disable iCloud Keychain synchronization.",
        "info": "Requiring individuals to be authenticated with an individual authenticator prior to using a group authenticator allows for traceability of actions, as well as adding an additional level of protection of the actions that can be taken with group account knowledge.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214872r609363_rule,STIG-ID|AOSX-13-000558,STIG-Legacy|SV-96337,STIG-Legacy|V-81623,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214872",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudKeychainSync",
        "expect": "^[\\\\s]*allowCloudKeychainSync[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_80": {
        "description": "AOSX-13-000559 - The macOS system must disable iCloud document synchronization.",
        "info": "Operating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214873r609363_rule,STIG-ID|AOSX-13-000559,STIG-Legacy|SV-96339,STIG-Legacy|V-81625,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214873",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudDocumentSync",
        "expect": "^[\\\\s]*allowCloudDocumentSync[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_81": {
        "description": "AOSX-13-000560 - The macOS system must disable iCloud bookmark synchronization.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214874r609363_rule,STIG-ID|AOSX-13-000560,STIG-Legacy|SV-96341,STIG-Legacy|V-81627,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214874",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudBookmarks",
        "expect": "^[\\\\s]*allowCloudBookmarks[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_82": {
        "description": "AOSX-13-000561 - The macOS system must disable iCloud Photo Library - allowCloudPhotoLibrary",
        "info": "To support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214875r609363_rule,STIG-ID|AOSX-13-000561,STIG-Legacy|SV-96343,STIG-Legacy|V-81629,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214875",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudPhotoLibrary",
        "expect": "^[\\\\s]*allowCloudPhotoLibrary[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_83": {
        "description": "AOSX-13-000561 - The macOS system must disable iCloud Photo Library - com.apple.preferences.icloud",
        "info": "To support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214875r609363_rule,STIG-ID|AOSX-13-000561,STIG-Legacy|SV-96343,STIG-Legacy|V-81629,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214875",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 5 DisabledPreferencePanes | /usr/bin/grep icloud",
        "expect": "^[\\\\s]*\"com.apple.preferences.icloud\"(,)?$"
    },
    "custom_item_84": {
        "description": "AOSX-13-000562 - The macOS system must disable iCloud Desktop And Documents.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nSatisfies: SRG-OS-000095-GPOS-00049, SRG-OS-000370-GPOS-00155",
        "solution": "This setting is enforced using the 'Restrictions' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.4.8,800-53|CM-7a.,800-53|CM-7(5)(b),800-53r5|CM-7a.,800-53r5|CM-7(5)(b),CAT|II,CCI|CCI-000381,CCI|CCI-001774,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7,ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214876r609363_rule,STIG-ID|AOSX-13-000562,STIG-Legacy|SV-96345,STIG-Legacy|V-81631,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-214876",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowCloudDesktopAndDocuments",
        "expect": "^[\\\\s]*allowCloudDesktopAndDocuments[\\\\s]*=[\\\\s]*0;$"
    },
    "custom_item_85": {
        "description": "AOSX-13-000565 - The macOS system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator.",
        "info": "Administrators must never log in directly as root. To assure individual accountability and prevent unauthorized access, logging in as root over a remote connection must be disabled. Administrators should only run commands as root after first authenticating with their individual user names and passwords.",
        "solution": "To ensure that 'PermitRootLogin' is disabled by sshd, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/^[\\#]*PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config",
        "reference": "800-171|3.5.1,800-53|IA-2(5),800-53r5|IA-2(5),CAT|II,CCI|CCI-000770,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(5),ITSG-33|IA-2(5)(a),ITSG-33|IA-2(5)(b),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214877r609363_rule,STIG-ID|AOSX-13-000565,STIG-Legacy|SV-96347,STIG-Legacy|V-81633,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-214877",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*[Pp][Ee][Rr][Mm][Ii][Tt][Rr][Oo][Oo][Tt][Ll][Oo][Gg][Ii][Nn][\\\\s]+",
        "expect": "^[\\\\s]*[Pp][Ee][Rr][Mm][Ii][Tt][Rr][Oo][Oo][Tt][Ll][Oo][Gg][Ii][Nn][\\\\s]+[Nn][Oo][\\\\s]*$"
    },
    "custom_item_86": {
        "description": "AOSX-13-000570 - The macOS system must implement NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.",
        "info": "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\nSatisfies: SRG-OS-000112-GPOS-00057, SRG-OS-000113-GPOS-00058, SRG-OS-000396-GPOS-00176",
        "solution": "To ensure that 'Protocol 2' is used by sshd, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*Protocol.*/Protocol 2/' /etc/ssh/sshd_config",
        "reference": "800-171|3.5.4,800-171|3.13.11,800-53|IA-2(8),800-53|IA-2(9),800-53|SC-13,800-53r5|IA-2(8),800-53r5|SC-13,CAT|II,CCI|CCI-001941,CCI|CCI-001942,CCI|CCI-002450,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.DS-5,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|IA-2(8),ITSG-33|IA-2(9),ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T7.4.1,NIAv2|AM18,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-214878r609363_rule,STIG-ID|AOSX-13-000570,STIG-Legacy|SV-96349,STIG-Legacy|V-81635,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-214878",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*[Pp][Rr][Oo][Tt][Oo][Cc][Oo][Ll][\\\\s]+",
        "expect": "^[\\\\s]*[Pp][Rr][Oo][Tt][Oo][Cc][Oo][Ll][\\\\s]+2[\\\\s]*$"
    },
    "custom_item_87": {
        "description": "AOSX-13-000585 - The macOS system must enforce password complexity by requiring that at least one numeric character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nTo set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor.\n\nIf the file does not yet contain any policy settings, replacewith; then insert the following text after the openingtag and before the closingtag.\n\nThe same text can also be used if the line 'policyCategoryPasswordContent' is not present.policyCategoryPasswordContentpolicyContentpolicyAttributePassword matches '(.*[0-9].*){1,}+'policyIdentifiercom.apple.policy.legacy.requiresNumericpolicyParametersminimumNumericCharacters1If the file does contain policy settings, and the line 'policyCategoryPasswordContent' does exist, insert the following text after the openingtag that comes right after it:policyContentpolicyAttributePassword matches '(.*[0-9].*){1,}+'policyIdentifiercom.apple.policy.legacy.requiresNumericpolicyParametersminimumNumericCharacters1After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214879r609363_rule,STIG-ID|AOSX-13-000585,STIG-Legacy|SV-96351,STIG-Legacy|V-81637,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-214879",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep requireAlphanumeric",
        "expect": ".*requireAlphanumeric[\\\\s]*=[\\\\s]*([1-9]|1[0-9]).*"
    },
    "custom_item_88": {
        "description": "AOSX-13-000587 - The macOS system must enforce password complexity by requiring that at least one special character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214880r609363_rule,STIG-ID|AOSX-13-000587,STIG-Legacy|SV-96353,STIG-Legacy|V-81639,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-214880",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep minComplexChars",
        "expect": ".*minComplexChars[\\\\s]*=[\\\\s]*([1-9]|1[0-9]).*"
    },
    "custom_item_89": {
        "description": "AOSX-13-000590 - The macOS system must enforce a minimum 15-character password length.",
        "info": "The minimum password length must be set to 15 characters. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.",
        "solution": "This setting is enforced using the 'Passcode Policy' configuration profile.\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214881r609363_rule,STIG-ID|AOSX-13-000590,STIG-Legacy|SV-96355,STIG-Legacy|V-81641,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-214881",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep minLength",
        "expect": ".*minLength[\\\\s]*=[\\\\s]*(15|1[6-9]|2[0-9])"
    },
    "custom_item_90": {
        "description": "AOSX-13-000605 - The macOS system must not use telnet.",
        "info": "The 'telnet' service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk. Administrators should be instructed to use an alternate service for remote access sessions, non-local maintenance sessions, and diagnostic communications that uses encryption, such as SSH.\n\nSatisfies: SRG-OS-000074-GPOS-00042, SRG-OS-000125-GPOS-00065, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173, SRG-OS-000394-GPOS-00174",
        "solution": "To disable the 'telnet' service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.1.13,800-171|3.5.10,800-171|3.7.5,800-53|AC-17(2),800-53|IA-5(1)(c),800-53|MA-4c.,800-53|MA-4(6),800-53r5|AC-17(2),800-53r5|IA-5(1)(c),800-53r5|MA-4c.,800-53r5|MA-4(6),CAT|I,CCI|CCI-000197,CCI|CCI-000877,CCI|CCI-001453,CCI|CCI-002890,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.MA-2,CSF|PR.PT-4,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),ITSG-33|IA-5(1)(c),ITSG-33|MA-4c.,ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.2.3,NESA|T5.4.2,NESA|T5.4.4,NIAv2|AM37,NIAv2|CY6,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214882r609363_rule,STIG-ID|AOSX-13-000605,STIG-Legacy|SV-96357,STIG-Legacy|V-81643,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,TBA-FIISB|45.2.3,Vuln-ID|V-214882",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_91": {
        "description": "AOSX-13-000606 - The macOS system must not use unencrypted FTP.",
        "info": "The 'ftp' service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling ftp is one way to mitigate this risk. Administrators should be instructed to use an alternate service for data transmission that uses encryption, such as SFTP.",
        "solution": "To disable the 'ftp' service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.ftpd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|I,CCI|CCI-000197,CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214883r609363_rule,STIG-ID|AOSX-13-000606,STIG-Legacy|SV-96359,STIG-Legacy|V-81645,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-214883",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.ftpd | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_92": {
        "description": "AOSX-13-000710 - The macOS system must allow only applications that have a valid digital signature to run - SPApplicationsDataType",
        "info": "Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.",
        "solution": "This setting is enforced using the 'Security and Privacy Policy' configuration profile.",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-214884r648720_rule,STIG-ID|AOSX-13-000710,STIG-Legacy|SV-96361,STIG-Legacy|V-81647,Vuln-ID|V-214884",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPApplicationsDataType | /usr/bin/grep -B 3 -A 4 -e \"Obtained from: Unknown\" | /usr/bin/grep -v -e \"Location: /Library/Application Support/Script Editor/Templates\" -e \"Location: /System/Library/\" | /usr/bin/awk -F \"Location: \" '{print $2}' | /usr/bin/sort -u | /usr/bin/awk '{ print } END {if (NR==0) { print \"No results found\" } }'",
        "expect": "No results found"
    },
    "custom_item_93": {
        "description": "AOSX-13-000710 - The macOS system must allow only applications that have a valid digital signature to run - AllowIdentifiedDevelopers",
        "info": "Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.",
        "solution": "This setting is enforced using the 'Security and Privacy Policy' configuration profile.",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-214884r648720_rule,STIG-ID|AOSX-13-000710,STIG-Legacy|SV-96361,STIG-Legacy|V-81647,Vuln-ID|V-214884",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep AllowIdentifiedDevelopers",
        "expect": "^[\\\\s]*AllowIdentifiedDevelopers[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_94": {
        "description": "AOSX-13-000710 - The macOS system must allow only applications that have a valid digital signature to run - EnableAssessment",
        "info": "Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.",
        "solution": "This setting is enforced using the 'Security and Privacy Policy' configuration profile.",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-214884r648720_rule,STIG-ID|AOSX-13-000710,STIG-Legacy|SV-96361,STIG-Legacy|V-81647,Vuln-ID|V-214884",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep EnableAssessment",
        "expect": "^[\\\\s]*EnableAssessment[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_95": {
        "description": "AOSX-13-000720 - The macOS system must be configured with the SSH daemon ClientAliveInterval option set to 900 or less.",
        "info": "SSH should be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.",
        "solution": "To ensure that 'ClientAliveInterval' is set correctly, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveInterval.*/ClientAliveInterval 900/' /etc/ssh/sshd_config",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-214886r609363_rule,STIG-ID|AOSX-13-000720,STIG-Legacy|SV-96365,STIG-Legacy|V-81651,SWIFT-CSCv1|2.6,Vuln-ID|V-214886",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*ClientAliveInterval[\\\\s]+",
        "expect": "^[\\\\s]*ClientAliveInterval[\\\\s]+(900|[1-8][0-9][0-9]|[1-9][0-9])[\\\\s]*$"
    },
    "custom_item_96": {
        "description": "AOSX-13-000721 - The macOS system must be configured with the SSH daemon ClientAliveCountMax option set to 0.",
        "info": "SSH should be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.",
        "solution": "To ensure that the SSH idle timeout occurs precisely when the 'ClientAliveCountMax' is set, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveCountMax.*/ClientAliveCountMax 0/' /etc/ssh/sshd_config",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-214887r609363_rule,STIG-ID|AOSX-13-000721,STIG-Legacy|SV-96367,STIG-Legacy|V-81653,SWIFT-CSCv1|2.6,Vuln-ID|V-214887",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*ClientAliveCountMax[\\\\s]+",
        "expect": "^[\\\\s]*ClientAliveCountMax[\\\\s]+0[\\\\s]*$"
    },
    "custom_item_97": {
        "description": "AOSX-13-000722 - The macOS system must be configured with the SSH daemon LoginGraceTime set to 30 or less.",
        "info": "SSH should be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.",
        "solution": "To ensure that 'LoginGraceTime' is configured correctly, run the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*LoginGraceTime.*/LoginGraceTime 30/' /etc/ssh/sshd_config",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|II,CCI|CCI-001133,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-214888r609363_rule,STIG-ID|AOSX-13-000722,STIG-Legacy|SV-96369,STIG-Legacy|V-81655,SWIFT-CSCv1|2.6,Vuln-ID|V-214888",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/ssh/sshd_config",
        "regex": "^[\\\\s]*[Ll][Oo][Gg][Ii][Nn][Gg][Rr][Aa][Cc][Ee][Tt][Ii][Mm][Ee][\\\\s]+",
        "expect": "^[\\\\s]*[Ll][Oo][Gg][Ii][Nn][Gg][Rr][Aa][Cc][Ee][Tt][Ii][Mm][Ee][\\\\s]+(30|[1-2][0-9]|[0-9])[\\\\s]*$"
    },
    "custom_item_98": {
        "description": "AOSX-13-000750 - The macOS system must issue or obtain public key certificates under an appropriate certificate policy from an approved service provider.",
        "info": "DoD-approved certificates must be installed to the System Keychain so they will be available to all users.\n\nFor user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice. This control focuses on certificates with a visibility external to the information system and does not include certificates related to internal system operations; for example, application-specific time services.\n\nSatisfies: SRG-OS-000066-GPOS-00034, SRG-OS-000478-GPOS-00223\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Obtain the approved DOD certificates from the appropriate authority. Use Keychain Access from '/Applications/Utilities' to add certificates to the System Keychain.",
        "reference": "800-171|3.5.2,800-171|3.13.11,800-53|IA-5(2)(a),800-53|SC-13,800-53r5|IA-5(2)(a),800-53r5|SC-13,CAT|II,CCI|CCI-000185,CCI|CCI-002450,CSF|PR.AC-1,CSF|PR.DS-5,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|IA-5(2)(a),ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T5.2.3,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-214889r609363_rule,STIG-ID|AOSX-13-000750,STIG-Legacy|SV-96371,STIG-Legacy|V-81657,Vuln-ID|V-214889",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/security dump-keychain | /usr/bin/grep labl | /usr/bin/awk -F\\\\\" \\'{ print $4 }\\'",
        "expect": ""
    },
    "custom_item_99": {
        "description": "AOSX-13-000780 - The macOS system must implement cryptographic mechanisms to protect the confidentiality and integrity of all information at rest.",
        "info": "Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. By encrypting the system hard drive, the confidentiality and integrity of any data stored on the system is ensured. FileVault Disk Encryption mitigates this risk.\n\nSatisfies: SRG-OS-000185-GPOS-00079, SRG-OS-000404-GPOS-00183, SRG-OS-000405-GPOS-00184\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Open System Preferences >> Security and Privacy and navigate to the 'FileVault' tab. Use this panel to configure full-disk encryption.\n\nAlternately, from the command line, run the following command to enable 'FileVault':\n\n/usr/bin/sudo /usr/bin/fdesetup enable\n\nAfter 'FileVault' is initially set up, additional users can be added.",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53|SC-28(1),800-53r5|SC-28,800-53r5|SC-28(1),CAT|II,CCI|CCI-001199,CCI|CCI-002475,CCI|CCI-002476,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-214890r609363_rule,STIG-ID|AOSX-13-000780,STIG-Legacy|SV-96373,STIG-Legacy|V-81659,TBA-FIISB|28.1,Vuln-ID|V-214890",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/fdesetup status",
        "expect": ""
    },
    "custom_item_100": {
        "description": "AOSX-13-000850 - The macOS system must restrict the ability of individuals to use USB storage devices - alert",
        "info": "External hard drives, such as USB, must be disabled for users. USB hard drives are a potential vector for malware and can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214892r609363_rule,STIG-ID|AOSX-13-000850,STIG-Legacy|SV-96377,STIG-Legacy|V-81663,SWIFT-CSCv1|2.3,Vuln-ID|V-214892",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 3 harddisk-external | /usr/bin/grep alert | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_101": {
        "description": "AOSX-13-000850 - The macOS system must restrict the ability of individuals to use USB storage devices - eject",
        "info": "External hard drives, such as USB, must be disabled for users. USB hard drives are a potential vector for malware and can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214892r609363_rule,STIG-ID|AOSX-13-000850,STIG-Legacy|SV-96377,STIG-Legacy|V-81663,SWIFT-CSCv1|2.3,Vuln-ID|V-214892",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 3 harddisk-external | /usr/bin/grep eject | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_102": {
        "description": "AOSX-13-000862 - The macOS system must be configured to not allow iTunes file sharing.",
        "info": "Connections to unauthorized iOS devices (e.g., iPhones, iPods, and iPads) open the system to possible compromise via exfiltration of system data. Disabling the iTunes file sharing blocks connections to iOS devices.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214893r609363_rule,STIG-ID|AOSX-13-000862,STIG-Legacy|SV-96379,STIG-Legacy|V-81665,SWIFT-CSCv1|2.3,Vuln-ID|V-214893",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep allowiTunesFileSharing",
        "expect": "^[\\\\s]*allowiTunesFileSharing[\\\\s]*=[\\\\s]*0"
    },
    "custom_item_103": {
        "description": "AOSX-13-000925 - The macOS system must not allow an unattended or automatic logon to the system.",
        "info": "When automatic logons are enabled, the default user account is automatically logged on at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer to log on. Disabling automatic logons mitigates this risk.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214894r609363_rule,STIG-ID|AOSX-13-000925,STIG-Legacy|SV-96381,STIG-Legacy|V-81667,SWIFT-CSCv1|2.3,Vuln-ID|V-214894",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableAutoLoginClient",
        "expect": "\\\\\"com.apple.login.mcx.DisableAutoLoginClient\\\\\"[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_104": {
        "description": "AOSX-13-000930 - The macOS system logon window must be configured to prompt for username and password, rather than show a list of users.",
        "info": "The logon window must be configured to prompt all users for both a username and a password. By default, the system displays a list of known users at the logon screen. This gives an advantage to an attacker with physical access to the system, as the attacker would only have to guess the password for one of the listed accounts.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214895r609363_rule,STIG-ID|AOSX-13-000930,STIG-Legacy|SV-96383,STIG-Legacy|V-81669,SWIFT-CSCv1|2.3,Vuln-ID|V-214895",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep SHOWFULLNAME",
        "expect": "^[\\\\s]*SHOWFULLNAME[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_105": {
        "description": "AOSX-13-000950 - The macOS firewall must have logging enabled.",
        "info": "Firewall logging must be enabled. This ensures that malicious network activity will be logged to the system.",
        "solution": "To enable the firewall logging, run the following command:\n\n/usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214896r609363_rule,STIG-ID|AOSX-13-000950,STIG-Legacy|SV-96385,STIG-Legacy|V-81671,SWIFT-CSCv1|2.3,Vuln-ID|V-214896",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getloggingmode | /usr/bin/grep on | /usr/bin/awk \\\\'{print} END {if (NR == 0) print \"fail\"}\\\\'",
        "expect": "Log mode is on"
    },
    "custom_item_106": {
        "description": "AOSX-13-000955 - The macOS system must be configured so that Bluetooth devices are not allowed to wake the computer.",
        "info": "A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined.\n\nRegardless of where the session lock is determined and implemented, once invoked, the session lock must remain in place until the user reauthenticates. No other activity aside from reauthentication must unlock the system.",
        "solution": "Manually change this control on the computer by opening System Preferences >> Bluetooth.\n\nClick 'Advanced' and ensure the 'Allow Bluetooth devices to wake this computer' is not checked. This control is not necessary if Bluetooth has been completely disabled.\n\nThe following can be run from the command line to disable 'Remote Wake' for the current user:\n\n/usr/bin/defaults write /Users/'whoami'/Library/Preferences/ByHost/com.apple.Bluetooth.'/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep 'Hardware UUID' | /usr/bin/cut -c22-57'.plist RemoteWakeEnabled 0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214897r609363_rule,STIG-ID|AOSX-13-000955,STIG-Legacy|SV-96387,STIG-Legacy|V-81673,SWIFT-CSCv1|2.3,Vuln-ID|V-214897",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "0$",
        "plist_item": "RemoteWakeEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_107": {
        "description": "AOSX-13-000965 - The macOS system must be configured with Bluetooth Sharing disabled.",
        "info": "Bluetooth sharing allows users to wirelessly transmit files between the macOS host and Bluetooth-enabled devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files. Disabling Bluetooth Sharing mitigates this risk.",
        "solution": "To disable Bluetooth Sharing, open System Preferences >> Sharing and uncheck the box next to 'Bluetooth Sharing'. This control is not necessary if Bluetooth has been completely disabled.\n\nThe following can be run from the command line to disable 'Bluetooth Sharing' for the current user:\n\n/usr/bin/defaults write /Users/'whoami'/Library/Preferences/ByHost/com.apple.Bluetooth.'/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep 'Hardware UUID' | /usr/bin/cut -c22-57'.plist PrefKeyServicesEnabled 0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214898r609363_rule,STIG-ID|AOSX-13-000965,STIG-Legacy|SV-96389,STIG-Legacy|V-81675,SWIFT-CSCv1|2.3,Vuln-ID|V-214898",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "regex": "0$",
        "plist_item": "PrefKeyServicesEnabled",
        "plist_name": "com.apple.Bluetooth",
        "plist_user": "all"
    },
    "custom_item_108": {
        "description": "AOSX-13-000975 - The macOS system must be configured to disable Remote Apple Events.",
        "info": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nRemote Apple Events must be disabled.",
        "solution": "To disable Remote Apple Events, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.AEServer\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-214899r609363_rule,STIG-ID|AOSX-13-000975,STIG-Legacy|SV-96391,STIG-Legacy|V-81677,SWIFT-CSCv1|2.3,Vuln-ID|V-214899",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.AEServer | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": ".*true"
    },
    "custom_item_109": {
        "description": "AOSX-13-000995 - The macOS system must be configured with the sudoers file configured to authenticate users on a per -tty basis.",
        "info": "The 'sudo' command must be configured to prompt for the administrator's password at least once in each newly opened Terminal window or remote logon session, as this prevents a malicious user from taking advantage of an unlocked computer or an abandoned logon session to bypass the normal password prompt requirement.\n\nWithout the 'tty_tickets' option, all open local and remote logon sessions would be authenticated to use sudo without a password for the duration of the configured password timeout window.",
        "solution": "Edit the '/etc/sudoers' file to contain the line:\n\nDefaults tty_tickets\n\nThis line can be placed in the defaults section or at the end of the file.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214900r609363_rule,STIG-ID|AOSX-13-000995,STIG-Legacy|SV-96393,STIG-Legacy|V-81679,SWIFT-CSCv1|2.3,Vuln-ID|V-214900",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/sudoers",
        "regex": "^[\\\\s]*Defaults[\\\\s]+tty_tickets[\\\\s]*$",
        "expect": "^[\\\\s]*Defaults[\\\\s]+tty_tickets[\\\\s]*$"
    },
    "custom_item_110": {
        "description": "AOSX-13-001080 - The macOS Application Firewall must be enabled.",
        "info": "The Application Firewall is the built-in firewall that comes with macOS and must be enabled. Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.",
        "solution": "To enable the firewall, run the following command:\n\n/usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214901r609363_rule,STIG-ID|AOSX-13-001080,STIG-Legacy|SV-96395,STIG-Legacy|V-81681,SWIFT-CSCv1|2.3,Vuln-ID|V-214901",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate | /usr/bin/grep disabled | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"; else print \"failed\"}\\'",
        "expect": "pass"
    },
    "custom_item_111": {
        "description": "AOSX-13-001110 - The macOS system must be configured with all public directories owned by root or an application account.",
        "info": "All public directories must be owned by 'root', the local admin user, or an application account. Directory owners have permission to delete any files contained in that directory, even if the files are owned by other user accounts. By setting the owner to an administrator or application account, regular users will not be permitted to delete each other's files.",
        "solution": "To change the ownership of any finding, run the following command:\n\n/usr/bin/sudo find / -type d -perm +o+w -not -uid 0 -exec chown root {} \\;",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214902r609363_rule,STIG-ID|AOSX-13-001110,STIG-Legacy|SV-96397,STIG-Legacy|V-81683,SWIFT-CSCv1|2.3,Vuln-ID|V-214902",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/find -x / -type d -perm -002 -exec ls -ld {} \\\\; | /usr/bin/grep -v \\'^[-d][-r][-w][-xS][-r][-w][-xS][-r][-w][Ttx][+@]*[ ]*[0-9]*[ ]*[Rr][Oo][Oo][Tt]\\' | /usr/bin/awk \\'{print} END {if (NR == 0) print \"none\"}\\'",
        "expect": "none",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_112": {
        "description": "AOSX-13-001115 - The macOS system must be configured with the finger service disabled.",
        "info": "The 'finger' service has had several security vulnerabilities in the past and is not a necessary service. It is disabled by default; enabling it would increase the attack surface of the system.",
        "solution": "To disable the 'finger' service, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.fingerd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214903r609363_rule,STIG-ID|AOSX-13-001115,STIG-Legacy|SV-96399,STIG-Legacy|V-81685,SWIFT-CSCv1|2.3,Vuln-ID|V-214903",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.fingerd | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\";}\\'",
        "expect": "^[\\\\s]*\"com.apple.fingerd\"[\\\\s]*=>[\\\\s]*true$"
    },
    "custom_item_113": {
        "description": "AOSX-13-001120 - The macOS system must be configured with the sticky bit set on all public directories.",
        "info": "The sticky bit must be set on all public directories, as it prevents users with write access to the directory from deleting or renaming files that belong to other users inside it.",
        "solution": "Run the following command to set the 'sticky bit' on all world-writable directories:\n\n/usr/bin/sudo /usr/bin/find / -type d \\( -perm -0002 -a ! -perm -1000 \\) -exec chmod +t {} \\;",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214904r609363_rule,STIG-ID|AOSX-13-001120,STIG-Legacy|SV-96401,STIG-Legacy|V-81687,SWIFT-CSCv1|2.3,Vuln-ID|V-214904",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/find -x / -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) -exec ls -ld {} \\\\; | /usr/bin/awk \\'{print} END {if (NR == 0) print \"none\"}\\'",
        "expect": "none",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_114": {
        "description": "AOSX-13-001125 - The macOS system must be configured with the prompt for Apple ID and iCloud disabled.",
        "info": "The prompt for Apple ID and iCloud must be disabled, as it might mislead new users into creating unwanted Apple IDs and iCloud storage accounts upon their first logon.",
        "solution": "This setting is enforced using the 'Login Window Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214905r609363_rule,STIG-ID|AOSX-13-001125,STIG-Legacy|SV-96403,STIG-Legacy|V-81689,SWIFT-CSCv1|2.3,Vuln-ID|V-214905",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep SkipCloudSetup | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\"}\\'",
        "expect": "^[\\\\s]*SkipCloudSetup[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_115": {
        "description": "AOSX-13-001130 - The macOS system must be configured so that users do not have Apple IDs signed into iCloud.",
        "info": "Users should not sign into iCloud, as this leads to the possibility that sensitive data could be saved to iCloud storage or that users could inadvertently introduce viruses or malware previously saved to iCloud from other systems.",
        "solution": "This must be resolved manually.\n\nWith the affected user logged on, open System Preferences >> iCloud.\n\nChoose 'Sign Out'.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214906r609363_rule,STIG-ID|AOSX-13-001130,STIG-Legacy|SV-96405,STIG-Legacy|V-81691,SWIFT-CSCv1|2.3,Vuln-ID|V-214906",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/find /Users/ -name 'MobileMeAccounts.plist' -exec defaults read '{}' \\\\; 2> /dev/null | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "^pass$",
        "timeout": "@FIND_TIMEOUT@"
    },
    "custom_item_116": {
        "description": "AOSX-13-001140 - The macOS system must be configured with iTunes Music Sharing disabled.",
        "info": "When iTunes Music Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet. Unnecessary network services should always be disabled because they increase the attack surface of the system. Disabling iTunes Music Sharing mitigates this risk.",
        "solution": "This setting is enforced using the 'Custom Policy' configuration profile.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214907r609363_rule,STIG-ID|AOSX-13-001140,STIG-Legacy|SV-96407,STIG-Legacy|V-81693,SWIFT-CSCv1|2.3,Vuln-ID|V-214907",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep disableSharedMusic | /usr/bin/awk \\'{print} END {if (NR == 0) print \"fail\"}\\'",
        "expect": "^[\\\\s]*disableSharedMusic[\\\\s]*=[\\\\s]*1"
    },
    "custom_item_117": {
        "description": "AOSX-13-001195 - The macOS system must not accept source-routed IPv4 packets.",
        "info": "A source-routed packet attempts to specify the network path the packet should take. If the system is not configured to block the incoming source-routed packets, an attacker can redirect the system's network traffic. Configuring the system to drop incoming source-routed IPv4 packets mitigates this risk.",
        "solution": "To configure the system to not accept 'source-routed' packets, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.ip.accept_sourceroute=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214909r609363_rule,STIG-ID|AOSX-13-001195,STIG-Legacy|SV-96411,STIG-Legacy|V-81697,SWIFT-CSCv1|2.3,Vuln-ID|V-214909",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.ip.sourceroute\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.ip\\\\.sourceroute[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_118": {
        "description": "AOSX-13-001200 - The macOS system must ignore IPv4 ICMP redirect messages.",
        "info": "ICMP redirects are broadcast to reshape network traffic. A malicious user could craft fake redirect packets and try to force all network traffic to pass through a network sniffer. If the system is not configured to ignore these packets, it could be susceptible to this kind of attack.",
        "solution": "To configure the system to ignore 'ICMP redirect' messages, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.icmp.drop_redirect=1",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214910r609363_rule,STIG-ID|AOSX-13-001200,STIG-Legacy|SV-96413,STIG-Legacy|V-81699,SWIFT-CSCv1|2.3,Vuln-ID|V-214910",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.icmp.drop_redirect\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.icmp\\\\.drop_redirect[\\\\s]*:[\\\\s]*1"
    },
    "custom_item_119": {
        "description": "AOSX-13-001205 - The macOS system must not have IP forwarding for IPv4 enabled.",
        "info": "IP forwarding for IPv4 must not be enabled, as only authorized systems should be permitted to operate as routers.",
        "solution": "To configure the system to disable 'IP forwarding', add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.ip.forwarding=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214911r609363_rule,STIG-ID|AOSX-13-001205,STIG-Legacy|SV-96415,STIG-Legacy|V-81701,SWIFT-CSCv1|2.3,Vuln-ID|V-214911",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.ip.forwarding\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.ip\\\\.forwarding[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_120": {
        "description": "AOSX-13-001206 - The macOS system must not have IP forwarding for IPv6 enabled.",
        "info": "IP forwarding for IPv6 must not be enabled, as only authorized systems should be permitted to operate as routers.",
        "solution": "To configure the system to disable 'IP forwarding', add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet6.ip6.forwarding=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214912r609363_rule,STIG-ID|AOSX-13-001206,STIG-Legacy|SV-96417,STIG-Legacy|V-81703,SWIFT-CSCv1|2.3,Vuln-ID|V-214912",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet6.ip6.forwarding\\'",
        "expect": "[\\\\s]*net\\\\.inet6\\\\.ip6\\\\.forwarding[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_121": {
        "description": "AOSX-13-001210 - The macOS system must not send IPv4 ICMP redirects by default.",
        "info": "ICMP redirects are broadcast to reshape network traffic. A malicious user could use the system to send fake redirect packets and try to force all network traffic to pass through a network sniffer. Disabling ICMP redirect broadcasts mitigates this risk.",
        "solution": "To configure the system to not send ICMP redirects, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.ip.redirect=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214913r609363_rule,STIG-ID|AOSX-13-001210,STIG-Legacy|SV-96419,STIG-Legacy|V-81705,SWIFT-CSCv1|2.3,Vuln-ID|V-214913",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.ip.redirect\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.ip\\\\.redirect[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_122": {
        "description": "AOSX-13-001211 - The macOS system must not send IPv6 ICMP redirects by default.",
        "info": "ICMP redirects are broadcast to reshape network traffic. A malicious user could use the system to send fake redirect packets and try to force all network traffic to pass through a network sniffer. Disabling ICMP redirect broadcasts mitigates this risk.",
        "solution": "To configure the system to not send ICMP redirects, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet6.ip6.redirect=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214914r609363_rule,STIG-ID|AOSX-13-001211,STIG-Legacy|SV-96421,STIG-Legacy|V-81707,SWIFT-CSCv1|2.3,Vuln-ID|V-214914",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet6.ip6.redirect\\'",
        "expect": "[\\\\s]*net\\\\.inet6\\\\.ip6\\\\.redirect[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_123": {
        "description": "AOSX-13-001215 - The macOS system must prevent local applications from generating source-routed packets.",
        "info": "A source-routed packet attempts to specify the network path that the system should take. If the system is not configured to block the sending of source-routed packets, an attacker can redirect the system's network traffic.",
        "solution": "To configure the system to not forward source-routed packets, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.ip.sourceroute=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214915r609363_rule,STIG-ID|AOSX-13-001215,STIG-Legacy|SV-96425,STIG-Legacy|V-81711,SWIFT-CSCv1|2.3,Vuln-ID|V-214915",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.ip.sourceroute\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.ip\\\\.sourceroute[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_124": {
        "description": "AOSX-13-001220 - The macOS system must not process Internet Control Message Protocol [ICMP] timestamp requests.",
        "info": "ICMP timestamp requests reveal information about the system and can be used to determine which operating system is installed. Precise time data can also be used to launch time-based attacks against the system. Configuring the system to drop incoming ICMPv4 timestamp requests mitigates these risks.",
        "solution": "To disable ICMP timestamp responses, add the following line to '/etc/sysctl.conf', creating the file if necessary:\n\nnet.inet.icmp.timestamp=0",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214916r609363_rule,STIG-ID|AOSX-13-001220,STIG-Legacy|SV-96427,STIG-Legacy|V-81713,SWIFT-CSCv1|2.3,Vuln-ID|V-214916",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/sysctl -a | /usr/bin/grep \\'net.inet.icmp.timestamp\\'",
        "expect": "[\\\\s]*net\\\\.inet\\\\.icmp\\\\.timestamp[\\\\s]*:[\\\\s]*0"
    },
    "custom_item_125": {
        "description": "AOSX-13-001235 - The macOS system must have unused network devices disabled.",
        "info": "If an unused network device is left enabled, a user might be able to activate it at a later time. Unused network devices should be disabled.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To disable a network device, run the following command, substituting the name of the device in place of '''':\n\n/usr/bin/sudo /usr/sbin/networksetup -setnetworkserviceenabled '' off",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214917r609363_rule,STIG-ID|AOSX-13-001235,STIG-Legacy|SV-96429,STIG-Legacy|V-81715,SWIFT-CSCv1|2.3,Vuln-ID|V-214917",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/networksetup -listallnetworkservices",
        "expect": ""
    },
    "custom_item_126": {
        "description": "AOSX-13-001270 - The macOS system must be configured to disable Internet Sharing.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nInternet Sharing must be disabled.",
        "solution": "To disable Internet Sharing, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.NetworkSharing\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214918r609363_rule,STIG-ID|AOSX-13-001270,STIG-Legacy|SV-96431,STIG-Legacy|V-81717,SWIFT-CSCv1|2.3,Vuln-ID|V-214918",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep com.apple.NetworkSharing | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": "true"
    },
    "custom_item_127": {
        "description": "AOSX-13-001275 - The macOS system must be configured to disable Web Sharing.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nWeb Sharing is non-essential and must be disabled.",
        "solution": "To disable Web Sharing, run the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/org.apache.httpd\n\nThe system may need to be restarted for the update to take effect.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214919r609363_rule,STIG-ID|AOSX-13-001275,STIG-Legacy|SV-96433,STIG-Legacy|V-81719,SWIFT-CSCv1|2.3,Vuln-ID|V-214919",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/launchctl print-disabled system | /usr/bin/grep org.apache.httpd | /usr/bin/cut -d \\' \\' -f 3 | /usr/bin/awk \\'{print} END {if (NR != 0); else print \"false\"}\\'",
        "expect": "true"
    },
    "custom_item_128": {
        "description": "AOSX-13-001324 - The macOS system must enforce an account lockout time period of 15 minutes in which a user makes three consecutive invalid logon attempts.",
        "info": "Setting a lockout time period of 15 minutes is an effective deterrent against brute forcing that also makes allowances for legitimate mistakes by users. When three invalid logon attempts are made, the account will be locked.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nThe following two lines within the configuration enforce lockout expiration to '15' minutes:autoEnableInSeconds900To set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor and ensure it contains the following text after the openingtag and before the closingtag.\n\nReplacefirst withif necessary.policyCategoryAuthenticationpolicyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3If the line 'policyCategoryAuthentication' already exists, the following text should be used instead and inserted after the firsttag that follows it:policyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CAT|II,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-214920r609363_rule,STIG-ID|AOSX-13-001324,STIG-Legacy|SV-96435,STIG-Legacy|V-81721,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-214920",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'minutesUntilFailedLoginReset\\'",
        "expect": "^[\\\\s]*minutesUntilFailedLoginReset[\\\\s]*=[\\\\s]*15"
    },
    "custom_item_129": {
        "description": "AOSX-13-001325 - The macOS system must enforce account lockout after the limit of three consecutive invalid logon attempts by a user.",
        "info": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nTo set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor and ensure it contains the following text after the openingtag and before the closingtag. Replacefirst withif necessary.policyCategoryAuthenticationpolicyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3If the line 'policyCategoryAuthentication' already exists, the following text should be used instead and inserted after the firsttag that follows it:policyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plistpolicyCategoryAuthenticationpolicyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3If the linepolicyCategoryAuthenticationalready exists, the following text should be used instead and inserted after the firsttag that follows it:policyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration or bugs in OS X may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.1.8,800-53|AC-7a.,800-53r5|AC-7a.,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7a.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.6,PCI-DSSv4.0|8.3.4,Rule-ID|SV-214921r609363_rule,STIG-ID|AOSX-13-001325,STIG-Legacy|SV-96437,STIG-Legacy|V-81723,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-214921",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'maxFailedAttempts\\'",
        "expect": "^[\\\\s]*maxFailedAttempts[\\\\s]*=[\\\\s]*3"
    },
    "custom_item_130": {
        "description": "AOSX-13-001327 - The macOS system must enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked.",
        "info": "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account. Setting a lockout expiration of 15 minutes is an effective deterrent against brute forcing that also makes allowances for legitimate mistakes by users.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nTo set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor and ensure it contains the following text after the openingtag and before the closingtag.\n\nReplacefirst withif necessary.policyCategoryAuthenticationpolicyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3If the line 'policyCategoryAuthentication' already exists, the following text should be used instead and inserted after the firsttag that follows it:policyContent(policyAttributeFailedAuthentications < policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime > (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))policyIdentifierAuthentication LockoutpolicyParametersautoEnableInSeconds900policyAttributeMaximumFailedAuthentications3After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration or bugs in OS X may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.1.8,800-53|AC-7b.,800-53r5|AC-7b.,CAT|II,CCI|CCI-002238,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-7b.,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2.1|8.1.7,PCI-DSSv4.0|8.3.4,Rule-ID|SV-214922r609363_rule,STIG-ID|AOSX-13-001327,STIG-Legacy|SV-96439,STIG-Legacy|V-81725,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-214922",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'minutesUntilFailedLoginReset\\'",
        "expect": "^[\\\\s]*minutesUntilFailedLoginReset[\\\\s]*=[\\\\s]*15"
    },
    "custom_item_131": {
        "description": "AOSX-13-001355 - The macOS system must shut down by default upon audit failure (unless availability is an overriding concern).",
        "info": "The audit service should shut down the computer if it is unable to audit system events. Once audit failure occurs, user and system activity is no longer recorded and malicious activity could go undetected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows:\n\n(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.",
        "solution": "Edit the '/etc/security/audit_control file' and change the value for policy to include the setting 'ahlt'. To do this programmatically, run the following command:\n\nsudo /usr/bin/sed -i.bak '/^policy/ s/$/,ahlt/' /etc/security/audit_control; sudo /usr/sbin/audit -s",
        "reference": "800-171|3.3.4,800-53|AU-5b.,800-53r5|AU-5b.,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5b.,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214923r609363_rule,STIG-ID|AOSX-13-001355,STIG-Legacy|SV-96441,STIG-Legacy|V-81727,Vuln-ID|V-214923",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^[\\\\s]*policy[\\\\s]*:",
        "expect": "^[\\\\s]*policy[\\\\s]*:.*(?=.*,ahlt)"
    },
    "custom_item_132": {
        "description": "AOSX-13-002050 - The macOS system must be configured to disable AirDrop.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nAirDrop must be disabled.",
        "solution": "Disabling AirDrop is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-214925r609363_rule,STIG-ID|AOSX-13-002050,STIG-Legacy|SV-96445,STIG-Legacy|V-81731,SWIFT-CSCv1|2.3,Vuln-ID|V-214925",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableAirDrop",
        "expect": "^[\\\\s]*DisableAirDrop[\\\\s]*=[\\\\s]*1[\\\\s]*;[\\\\s]*$"
    },
    "custom_item_133": {
        "description": "AOSX-13-002060 - The macOS system must be integrated into a directory services infrastructure.",
        "info": "Distinct user account databases on each separate system cause problems with username and password policy enforcement. Most approved directory services infrastructure solutions allow centralized management of users and passwords.",
        "solution": "Integrate the system into an existing directory services infrastructure.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-214926r609363_rule,STIG-ID|AOSX-13-002060,STIG-Legacy|SV-96447,STIG-Legacy|V-81733,SWIFT-CSCv1|2.3,Vuln-ID|V-214926",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/dscl localhost -list . | /usr/bin/grep -vE \\'(Contact | Search | Local)\\' | /usr/bin/awk \\'{print} END {if (NR != 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_134": {
        "description": "AOSX-13-002085 - The macOS system must enforce a 60-day maximum password lifetime restriction.",
        "info": "Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically.\n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nTo set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor.\n\nIf the file does not yet contain any policy settings, replacewith.\n\nIf there already is a policy block that refers to password expiration, ensure it is set to '60' days.\n\nIf the line 'policyCategoryPasswordChange' is not present in the file, add the following text immediately after the openingtag in the file:policyCategoryPasswordChangepolicyContentpolicyAttributeCurrentTime > policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)policyIdentifierPassword Change IntervalpolicyParameterspolicyAttributeExpiresEveryNDays60If the line 'policyCategoryPasswordChange' is already present in the file, the following text should be added just after the openingtag that follows the line instead:policyContentpolicyAttributeCurrentTime > policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)policyIdentifierPassword Change IntervalpolicyParameterspolicyAttributeExpiresEveryNDays60After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.5.2,800-53|IA-5(1)(d),800-53r5|IA-5(1)(d),CAT|II,CCI|CCI-000199,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(d),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214927r609363_rule,STIG-ID|AOSX-13-002085,STIG-Legacy|SV-96449,STIG-Legacy|V-81735,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-214927",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep maxPINAgeInDays",
        "expect": "^[\\\\s]*maxPINAgeInDays[\\\\s]*=[\\\\s]*([1-9]|[1-5][0-9]|60)"
    },
    "custom_item_135": {
        "description": "AOSX-13-002090 - The macOS system must prohibit password reuse for a minimum of five generations.",
        "info": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.",
        "solution": "This setting may be enforced using the 'Passcode Policy' configuration profile or by a directory service.\n\nTo set the password policy without a configuration profile, run the following command to save a copy of the current 'pwpolicy' account policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 > pwpolicy.plist\n\nOpen the generated file in a text editor. If the file does not yet contain any policy settings, replacewith. If there already is a policy block that refers to password history, ensure it is set to '5'. If the line 'policyCategoryPasswordContent' is not present in the file, add the following text immediately after the openingtag in the file:policyCategoryPasswordContentpolicyContentnone policyAttributePasswordHashes in policyAttributePasswordHistorypolicyIdentifierPassword HistorypolicyParameterspolicyAttributePasswordHistoryDepth5If the line 'policyCategoryPasswordContent' is already present in the file, the following text should be added just after the openingtag that follows the line instead:policyContentnone policyAttributePasswordHashes in policyAttributePasswordHistorypolicyIdentifierPassword HistorypolicyParameterspolicyAttributePasswordHistoryDepth5After saving the file and exiting to the command prompt, run the following command to load the new policy file:\n\n/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist\n\nNote: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as lock out all local users, including administrators.",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CAT|II,CCI|CCI-000200,CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214928r609363_rule,STIG-ID|AOSX-13-002090,STIG-Legacy|SV-96451,STIG-Legacy|V-81737,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-214928",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep pinHistory",
        "expect": "^[\\\\s]*pinHistory[\\\\s]*=[\\\\s]*([5-9]|[1-9][0-9])"
    },
    "custom_item_136": {
        "description": "AOSX-13-002105 - The macOS system must be configured with system log files owned by root and group-owned by wheel or admin - newsyslog",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct owner mitigates this risk.",
        "solution": "For any log file that returns an incorrect owner or group value, run the following command:\n\n/usr/bin/sudo chown root:wheel [log file]\n\n[log file] is the full path to the log file in question. If the file is managed by 'newsyslog', find the configuration line in the directory '/etc/newsyslog.d/' or the file '/etc/newsyslog.conf' and ensure that the owner:group column is set to 'root:wheel' or the appropriate service user account and group.\n\nIf the file is managed by 'aslmanager', find the configuration line in the directory '/etc/asl/' or the file '/etc/asl.conf' and ensure that 'uid' and 'gid' options are either not present or are set to a service user account and group respectively.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214929r609363_rule,STIG-ID|AOSX-13-002105,STIG-Legacy|SV-96453,STIG-Legacy|V-81739,Vuln-ID|V-214929",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/stat -f \\'%Su:%Sg:%N\\' $(/usr/bin/grep -v \\'^#\\' /etc/newsyslog.conf | /usr/bin/awk \\'{ print $1 }\\') 2> /dev/null | /usr/bin/grep -v \\'^root\\' | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_137": {
        "description": "AOSX-13-002105 - The macOS system must be configured with system log files owned by root and group-owned by wheel or admin - asl",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct owner mitigates this risk.",
        "solution": "For any log file that returns an incorrect owner or group value, run the following command:\n\n/usr/bin/sudo chown root:wheel [log file]\n\n[log file] is the full path to the log file in question. If the file is managed by 'newsyslog', find the configuration line in the directory '/etc/newsyslog.d/' or the file '/etc/newsyslog.conf' and ensure that the owner:group column is set to 'root:wheel' or the appropriate service user account and group.\n\nIf the file is managed by 'aslmanager', find the configuration line in the directory '/etc/asl/' or the file '/etc/asl.conf' and ensure that 'uid' and 'gid' options are either not present or are set to a service user account and group respectively.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214929r609363_rule,STIG-ID|AOSX-13-002105,STIG-Legacy|SV-96453,STIG-Legacy|V-81739,Vuln-ID|V-214929",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/stat -f \\'%Su:%Sg:%N\\' $(/usr/bin/grep -e \\'^>\\' /etc/asl.conf /etc/asl/* | /usr/bin/awk \\'{ print $2 }\\') 2> /dev/null | /usr/bin/grep -v \\'^root\\' | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_138": {
        "description": "AOSX-13-002106 - The macOS system must be configured with system log files set to mode 640 or less permissive - newsyslog",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.",
        "solution": "For any log file that returns an incorrect permission value, run the following command:\n\n/usr/bin/sudo chmod 640 [log file]\n\n[log file] is the full path to the log file in question. If the file is managed by 'newsyslog', find the configuration line in the directory '/etc/newsyslog.d/' or the file '/etc/newsyslog.conf' and edit the mode column to be '640' or less permissive.\n\nIf the file is managed by 'aslmanager', find the configuration line in the directory '/etc/asl/' or the file '/etc/asl.conf' and add or edit the mode option to be 'mode=0640' or less permissive.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214930r609363_rule,STIG-ID|AOSX-13-002106,STIG-Legacy|SV-96455,STIG-Legacy|V-81741,Vuln-ID|V-214930",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/stat -f \\'%A:%N\\' $(/usr/bin/grep -v \\'^#\\' /etc/newsyslog.conf | /usr/bin/awk \\'{ print $1 }\\') 2> /dev/null | /usr/bin/egrep -v \\'^[0-6][0-4]0\\' |/usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_139": {
        "description": "AOSX-13-002106 - The macOS system must be configured with system log files set to mode 640 or less permissive - asl",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.",
        "solution": "For any log file that returns an incorrect permission value, run the following command:\n\n/usr/bin/sudo chmod 640 [log file]\n\n[log file] is the full path to the log file in question. If the file is managed by 'newsyslog', find the configuration line in the directory '/etc/newsyslog.d/' or the file '/etc/newsyslog.conf' and edit the mode column to be '640' or less permissive.\n\nIf the file is managed by 'aslmanager', find the configuration line in the directory '/etc/asl/' or the file '/etc/asl.conf' and add or edit the mode option to be 'mode=0640' or less permissive.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214930r609363_rule,STIG-ID|AOSX-13-002106,STIG-Legacy|SV-96455,STIG-Legacy|V-81741,Vuln-ID|V-214930",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/stat -f \\'%A:%N\\' $(/usr/bin/grep -e \\'^>\\' /etc/asl.conf /etc/asl/* | /usr/bin/awk \\'{ print $2 }\\') 2> /dev/null | /usr/bin/egrep -v \\'^[0-6][0-4]0\\' |/usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_140": {
        "description": "AOSX-13-002107 - The macOS system must be configured with access control lists (ACLs) for system log files to be set correctly - newsyslog",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct ACLs mitigates this risk.",
        "solution": "For any log file that returns an ACL, run the following command:\n\n/usr/bin/sudo chmod -N [log file]\n\n[log file] is the full path to the log file in question.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214931r609363_rule,STIG-ID|AOSX-13-002107,STIG-Legacy|SV-96457,STIG-Legacy|V-81743,Vuln-ID|V-214931",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/ls -ld@ $(/usr/bin/grep -v \\'^#\\' /etc/newsyslog.conf | /usr/bin/awk \\'{ print $1 }\\') 2> /dev/null | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\\\\+ | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_141": {
        "description": "AOSX-13-002107 - The macOS system must be configured with access control lists (ACLs) for system log files to be set correctly - asl",
        "info": "System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct ACLs mitigates this risk.",
        "solution": "For any log file that returns an ACL, run the following command:\n\n/usr/bin/sudo chmod -N [log file]\n\n[log file] is the full path to the log file in question.",
        "reference": "800-53|SI-11b.,800-53r5|SI-11b.,CAT|II,CCI|CCI-001314,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11c.,Rule-ID|SV-214931r609363_rule,STIG-ID|AOSX-13-002107,STIG-Legacy|SV-96457,STIG-Legacy|V-81743,Vuln-ID|V-214931",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/bin/ls -ld@ $(/usr/bin/grep -e \\'^>\\' /etc/asl.conf /etc/asl/* | /usr/bin/awk \\'{ print $2 }\\') 2> /dev/null | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\\\\+ | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\"}\\'",
        "expect": "pass"
    },
    "custom_item_142": {
        "description": "AOSX-13-002110 - The macOS system must audit the enforcement actions used to restrict access associated with changes to the system.",
        "info": "By auditing access restriction enforcement, changes to application and OS configuration files can be audited. Without auditing the enforcement of access restrictions, it will be difficult to identify attempted attacks and an audit trail will not be available for forensic investigation.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.\n\nSatisfies: SRG-OS-000365-GPOS-00152, SRG-OS-000458-GPOS-00203, SRG-OS-000461-GPOS-00205, SRG-OS-000463-GPOS-00207, SRG-OS-000465-GPOS-00209, SRG-OS-000466-GPOS-00210, SRG-OS-000467-GPOS-00211, SRG-OS-000468-GPOS-00212, SRG-OS-000474-GPOS-00219",
        "solution": "To set the audit flags to the recommended setting, run the following command to add the flags 'fm', '-fr', and '-fw' all at once:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm,-fr,-fw/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the '/etc/security/audit_control' file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.4.5,800-53|AU-12c.,800-53|CM-5(1),800-53r5|AU-12c.,800-53r5|CM-5(1),CAT|II,CCI|CCI-000172,CCI|CCI-001814,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,ITSG-33|CM-5(1),NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-214932r609363_rule,STIG-ID|AOSX-13-002110,STIG-Legacy|SV-96459,STIG-Legacy|V-81745,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-214932",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*fm)(?=.*-fr)(?=.*-fw).*$"
    },
    "custom_item_143": {
        "description": "AOSX-13-030014 - The macOS system must be configured to lock the user session when a smart token is removed.",
        "info": "A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, operating systems need to provide users with the ability to manually invoke a session lock so users may secure their session should they need to temporarily vacate the immediate physical vicinity.",
        "solution": "This is now in the smartcard payload.tokenRemovalAction1",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CAT|II,CCI|CCI-000058,CN-L3|8.1.4.1(b),DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,Rule-ID|SV-214933r609363_rule,STIG-ID|AOSX-13-030014,STIG-Legacy|SV-96461,STIG-Legacy|V-81747,Vuln-ID|V-214933",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \\'tokenRemovalAction\\'",
        "expect": "tokenRemovalAction[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_144": {
        "description": "AOSX-13-067035 - The macOS system must enable certificate for smartcards.",
        "info": "To prevent untrusted certificates the certificates on a smartcard card must be valid in these ways: its issuer is system-trusted, the certificate is not expired, its 'valid-after' date is in the past, and it passes CRL and OCSP checking.",
        "solution": "This setting is enforced using the 'Smartcard' configuration profile.",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(b),800-53r5|IA-5(2)(b),CAT|II,CCI|CCI-000186,CSF|PR.AC-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(b),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-214934r609363_rule,STIG-ID|AOSX-13-067035,STIG-Legacy|SV-96463,STIG-Legacy|V-81749,Vuln-ID|V-214934",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep checkCertificateTrust",
        "expect": "^[\\\\s]*checkCertificateTrust[\\\\s]*=[\\\\s]*1;"
    },
    "custom_item_145": {
        "description": "AOSX-13-100001 - The macOS system must be a supported release.",
        "info": "An operating system release is considered 'supported' if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software.",
        "solution": "Upgrade to a supported version of the operating system.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-252706r819152_rule,STIG-ID|AOSX-13-100001,SWIFT-CSCv1|2.3,Vuln-ID|V-252706",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*(10\\.1[4-5]|11|12)"
    },
    "custom_item_146": {
        "description": "AOSX-13-362149 - The macOS system must prohibit user installation of software without explicit privileged status.",
        "info": "Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceeds the rights of a regular user.\n\nOperating system functionality will vary, and while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages, such as from an approved software repository.\n\nThe operating system or software configuration management utility must enforce control of software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization.",
        "solution": "This setting is enforced using the 'Restrictions Policy' configuration profile.",
        "reference": "800-171|3.4.9,800-53|CM-11(2),800-53r5|CM-11(2),CAT|II,CCI|CCI-001812,CSF|DE.CM-3,DISA_Benchmark|Apple_OS_X_10-13_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,QCSC-v1|8.2.1,Rule-ID|SV-214935r609363_rule,STIG-ID|AOSX-13-362149,STIG-Legacy|SV-96465,STIG-Legacy|V-81751,SWIFT-CSCv1|5.1,Vuln-ID|V-214935",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Apple_OS_X_10-13_V2R5_STIG.zip",
        "cmd": "/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 5 familyControlsEnabled",
        "expect": "^[\\\\s]*\"/Users/\"(,)?$"
    }
}