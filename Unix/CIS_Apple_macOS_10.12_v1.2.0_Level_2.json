{
    "custom_item_1": {
        "description": "MacOS 10.12 Sierra is installed",
        "cmd": "/usr/bin/sw_vers | /usr/bin/grep 'ProductVersion'",
        "expect": "^ProductVersion[\\\\s]*:[\\\\s]*@PLATFORM_VERSION@"
    },
    "custom_item_2": {
        "description": "2.3.2 Secure screen saver corners - top right corner",
        "info": "Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.\n\nRationale:\n\nSetting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect Mission Control\n\nSelect Hot Corners\n\nRemove any corners which are set to Disable Screen Saver",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|2A,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "not_regex": ".* = 6",
        "plist_item": "wvous-tr-corner",
        "plist_name": "com.apple.dock",
        "plist_user": "all"
    },
    "custom_item_3": {
        "description": "2.3.2 Secure screen saver corners - top left corner",
        "info": "Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.\n\nRationale:\n\nSetting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect Mission Control\n\nSelect Hot Corners\n\nRemove any corners which are set to Disable Screen Saver",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|2A,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "not_regex": ".* = 6",
        "plist_item": "wvous-tl-corner",
        "plist_name": "com.apple.dock",
        "plist_user": "all"
    },
    "custom_item_4": {
        "description": "2.3.2 Secure screen saver corners - bottom left corner",
        "info": "Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.\n\nRationale:\n\nSetting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect Mission Control\n\nSelect Hot Corners\n\nRemove any corners which are set to Disable Screen Saver",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|2A,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "not_regex": ".* = 6",
        "plist_item": "wvous-bl-corner",
        "plist_name": "com.apple.dock",
        "plist_user": "all"
    },
    "custom_item_5": {
        "description": "2.3.2 Secure screen saver corners - bottom right corner",
        "info": "Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.\n\nRationale:\n\nSetting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect Mission Control\n\nSelect Hot Corners\n\nRemove any corners which are set to Disable Screen Saver",
        "reference": "800-171|3.1.10,800-53|AC-11a.,800-53r5|AC-11a.,CN-L3|8.1.4.1(b),GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11a.,LEVEL|2A,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "not_regex": ".* = 6",
        "plist_item": "wvous-br-corner",
        "plist_name": "com.apple.dock",
        "plist_user": "all"
    },
    "custom_item_6": {
        "description": "2.6.6 Enable Location Services",
        "info": "macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. Users do not need to change the time or the time zone, the computer will do it for them. They do not need to specify their location for weather or travel times and even get alerts on travel times to meetings and appointment where location information is supplied.\n\nFor the purpose of asset management and time and log management with mobile computers location services simplify some processes.\n\nThere are some use cases where it is important that the computer not be able to report it's exact location. While the general use case is to enable Location Services, it should not be allowed if the physical location of the computer and the user should not be public knowledge.\n\nhttps://support.apple.com/en-us/HT204690\n\nRationale:\n\nLocation services are helpful in most use cases and can simplify log and time management where computers change time zones.",
        "solution": "Perform the following to ensure the system is configured as prescribed:\n\nIn Terminal, run the following command:\n\nsudo launchctl load /System/Library/LaunchDaemons/com.apple.locationd.plist\n\n\n\nThere should be no response\n\nIn some use cases organizations may not want Location Services running in those cases 'unload' rather than 'load' is the appropriate command\nPerform the following to ensure the system is configured as prescribed:\n\nIn Terminal, run the following command:\n\nsudo launchctl unload /System/Library/LaunchDaemons/com.apple.locationd.plist\n\n\n\nVerify that the results include: Could not find specified service",
        "reference": "800-171|3.4.1,800-53|CM-8(8),800-53r5|CM-8(8),CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/bin/launchctl load /System/Library/LaunchDaemons/com\\.apple\\.locationd\\.plist",
        "expect": "(Operation[\\\\s]+already[\\\\s]+in[\\\\s]+progress|service[\\\\s]+already[\\\\s]+loaded)"
    },
    "custom_item_7": {
        "description": "2.6.7 Monitor Location Services Access",
        "info": "macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. While location services may be very useful it may not be desirable to allow all applications that can use location services to use your location for Internet queries to provide tailored content based on your current location.\n\nEnsure that the applications that can use Location Services are authorized to use that information and provide that information where the application interacts with external systems. Apple provides feedback within System Preferences and may be enabled to provide information on the menu bar when Location Services are used.\n\nSafari can deny access from websites or prompt for access.\n\nApplications that support Location Services can be individually controlled in the Privacy tab in Security & Privacy under System Preferences.\n\nAccess should be evaluated to ensure that privacy controls are as expected.\n\nRationale:\n\nPrivacy controls should be monitored for appropriate settings\n\nImpact:\n\nMany macOS services rely on location services for tailored services. Users expect their time zone and weather to be relevant to where they are without manual intervention. Find my Mac does need to know where your Mac actually is. Where possible the tolerance between location privacy and convenience may be best left to the user when the location itself is not sensitive. If facility locations are not public location information should be tightly controlled",
        "solution": "Safari Configuration\nPerform the following to implement the prescribed state:\n\n1. Open Safari\n2. Select Safari from the menu bar\n3. Select Websites\n4. Select Location\n5. When visiting other websites should be set to Ask or Deny\n\nPerform the following to review applications in System Preferences:\n\n1. Open System Preferences\n2. Select Security & Privacy\n3. Select Privacy\n4. Select Location Services\n5. Uncheck applications that are not approved for access to location service information",
        "reference": "800-171|3.4.1,800-53|CM-8(8),800-53r5|CM-8(8),CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "0|1",
        "plist_item": "SafariGeolocationPermissionPolicy globalstate",
        "plist_name": "/Library/Preferences/com.apple.safari.plist"
    },
    "custom_item_8": {
        "description": "2.6.7 Monitor Location Services Access - evaluate application",
        "info": "macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. While location services may be very useful it may not be desirable to allow all applications that can use location services to use your location for Internet queries to provide tailored content based on your current location.\n\nEnsure that the applications that can use Location Services are authorized to use that information and provide that information where the application interacts with external systems. Apple provides feedback within System Preferences and may be enabled to provide information on the menu bar when Location Services are used.\n\nSafari can deny access from websites or prompt for access.\n\nApplications that support Location Services can be individually controlled in the Privacy tab in Security & Privacy under System Preferences.\n\nAccess should be evaluated to ensure that privacy controls are as expected.\n\nRationale:\n\nPrivacy controls should be monitored for appropriate settings\n\nImpact:\n\nMany macOS services rely on location services for tailored services. Users expect their time zone and weather to be relevant to where they are without manual intervention. Find my Mac does need to know where your Mac actually is. Where possible the tolerance between location privacy and convenience may be best left to the user when the location itself is not sensitive. If facility locations are not public location information should be tightly controlled\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Safari Configuration\nPerform the following to implement the prescribed state:\n\n1. Open Safari\n2. Select Safari from the menu bar\n3. Select Websites\n4. Select Location\n5. When visiting other websites should be set to Ask or Deny\n\nPerform the following to review applications in System Preferences:\n\n1. Open System Preferences\n2. Select Security & Privacy\n3. Select Privacy\n4. Select Location Services\n5. Uncheck applications that are not approved for access to location service information",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-6a.,800-53r5|AU-6a.,CN-L3|7.1.3.3(d),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6a.,LEVEL|2M,NESA|T3.6.3,NESA|T3.6.6,NESA|T8.3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/defaults read /var/db/locationd/clients.plist | /usr/bin/grep -i com.*",
        "expect": ""
    },
    "custom_item_9": {
        "description": "2.7.4 iCloud Drive Document sync",
        "info": "With macOS 10.12 Apple introduced the capability to have a user's Documents folder automatically synchronize to the user's iCloud Drive, providing they have enough room purchased through Apple on their iCloud drive. This capability mirrors what Microsoft is doing with the use of OneDrive and Office 365. There are concerns with using this capability.\n\nThe storage space that Apple provides for free is used by users with iCloud mail, all of a user's Photo Library created with the ever larger Multi-Pixel iPhone cameras and all of the iOS Backups. Adding a synchronization capability for users who have files going back a decade or more and storage may be tight without much larger Apple charges than the free 5GB. Users with multiple computers running 10.12 and above with unique content on each will have issues as well.\n\nEnterprise users may not be allowed to store Enterprise information in a third party public cloud. In previous implementations iCloud Drive or even DropBox the user selected what files were synchronized even if there were no other controls. The new feature synchronizes all files in a folder widely used to put working files.\n\nThe automatic synchronization of all files in a user's Documents folder should be disabled.\n\nhttps://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/\n\nRationale:\n\nAutomated Document synchronization should be planned and controlled to approved storage.\n\nImpact:\n\nUsers will not be able to use iCloud for automatic Documents sync.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect iCloud\n\nSelect iCloud Drive\n\nSelect Options next to iCloud Drive\n\nUncheck Desktop & Documents Folders",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/bin/ls -l ~/Library/Mobile\\\\ Documents/com~apple~CloudDocs/Documents/ | /usr/bin/wc -l",
        "expect": "[\\\\s]+0"
    },
    "custom_item_10": {
        "description": "2.7.5 iCloud Drive Desktop sync",
        "info": "With macOS 10.12 Apple introduced the capability to have a user's Desktop folder automatically synchronize to the user's iCloud Drive, providing they have enough room purchased through Apple on their iCloud drive. This capability mirrors what Microsoft is doing with the use of OneDrive and Office 365. There are concerns with using this capability.\n\nThe storage space that Apple provides for free is used by users with iCloud mail, all of a user's Photo Library created with the ever larger Multi-Pixel iPhone cameras and all of the iOS Backups. Adding a synchronization capability for users who have files going back a decade or more and storage may be tight without much larger Apple charges than the free 5GB. Users with multiple computers running 10.12 and above with unique content on each will have issues as well.\n\nEnterprise Users may not be allowed to store Enterprise information in a third party public cloud. In previous implementations iCloud Drive or even DropBox the user selected what files were synchronized even if there were no other controls. The new features synchronize all files in a folder widely used to put working files.\n\nThe automatic synchronization of all files in a user's Desktop folder should be disabled\n\nhttps://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/\n\nRationale:\n\nAutomated Desktop synchronization should be planned and controlled to approved storage.\n\nImpact:\n\nUsers will not be able to use iCloud for automatic Desktop sync.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen System Preferences\n\nSelect iCloud\n\nSelect iCloud Drive\n\nSelect Options next to iCloud Drive\n\nUncheck Desktop & Documents Folders",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/bin/ls -l ~/Library/Mobile\\\\ Documents/com~apple~CloudDocs/Desktop/ | /usr/bin/wc -l",
        "expect": "[\\\\s]+0"
    },
    "custom_item_11": {
        "description": "2.8.1 Time Machine Auto-Backup",
        "info": "Backup solutions are only effective if the backups run on a regular basis. The time to check for backups is before the hard drive fails or the computer goes missing. In order to simplify the user experience so that backups are more likely to occur Time Machine should be on and set to Back Up Automatically whenever the target volume is available.\n\nOperational staff should ensure that backups complete on a regular basis and the backups are tested to ensure that file restoration from backup is possible when needed.\n\nBackup dates are available even when the target volume is not available in the Time Machine plist.\n\nSnapshotDates = (\n\n'2012-08-20 12:10:22 +0000',\n\n'2013-02-03 23:43:22 +0000',\n\n'2014-02-19 21:37:21 +0000',\n\n'2015-02-22 13:07:25 +0000',\n\n'2016-08-20 14:07:14 +0000'\n\nWhen the backup volume is connected to the computer more extensive information is available through tmutil. See man tmutil\n\nRationale:\n\nBackups should automatically run whenever the backup drive is available.\n\nImpact:\n\nThe backup will run periodically in the background and could have user impact while running.",
        "solution": "Perform the following to configure the system as prescribed:\nRun the following command in Terminal:\n\ndefaults write /Library/Preferences/com.apple.TimeMachine.plist AutoBackup 1",
        "reference": "800-171|3.8.9,800-53|CP-9b.,800-53r5|CP-9b.,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9b.,LEVEL|2A,NESA|T3.5.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "[^0]+",
        "plist_item": "AutoBackup",
        "plist_name": "/Library/Preferences/com.apple.TimeMachine.plist"
    },
    "custom_item_12": {
        "description": "2.11 Java 6 is not the default Java runtime",
        "info": "Apple had made Java part of the core Operating System for macOS. Apple is no longer providing Java updates for macOS and updated JREs and JDK are made available by Oracle. The latest version of Java 6 made available by Apple has many unpatched vulnerabilities and should not be the default runtime for Java applets that request one from the Operating System\n\nRationale:\n\nJava has been one of the most exploited environments and Java 6, which was provided as an OS component by Apple, is no longer maintained by Apple or Oracle. The old versions provided by Apple are both unsupported and missing the more modern security controls that have limited current exploits. The EOL version may still be installed and should be removed from the computer or not be in the default path.\n\nImpact:\n\nOld applications may rely on either an Apple supplied version of Java 6 or an updated JDK.",
        "solution": "Java 6 can be removed completely or, if required Java applications will only work with Java 6, a custom path can be used. Apple is likely to finally pull the plug on Java 6 in upcoming macOS versions so any applications that still require Java 6 will likely soon be unavailable.",
        "reference": "800-171|3.4.1,800-53|CM-8a.,800-53r5|CM-8a.,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/java -version 2>&1 | /usr/bin/egrep -o '1\\.[456]\\.[^\"\\) ]+' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_13": {
        "description": "3.2 Configure Security Auditing Flags - 'audit successful/failed login/logout events'",
        "info": "Auditing is the capture and maintenance of information about security-related events.\n\nRationale:\n\nMaintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen a terminal session and edit the /etc/security/audit_control file\n\nFind the line beginning with 'flags'\n\nAdd the following flags: lo, ad, fd, fm, -all.\n\nSave the file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*lo).*$"
    },
    "custom_item_14": {
        "description": "3.2 Configure Security Auditing Flags - 'audit successful/failed administrative events'",
        "info": "Auditing is the capture and maintenance of information about security-related events.\n\nRationale:\n\nMaintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen a terminal session and edit the /etc/security/audit_control file\n\nFind the line beginning with 'flags'\n\nAdd the following flags: lo, ad, fd, fm, -all.\n\nSave the file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*ad).*$"
    },
    "custom_item_15": {
        "description": "3.2 Configure Security Auditing Flags - 'audit successful/failed file deletion events'",
        "info": "Auditing is the capture and maintenance of information about security-related events.\n\nRationale:\n\nMaintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen a terminal session and edit the /etc/security/audit_control file\n\nFind the line beginning with 'flags'\n\nAdd the following flags: lo, ad, fd, fm, -all.\n\nSave the file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*fd).*$"
    },
    "custom_item_16": {
        "description": "3.2 Configure Security Auditing Flags - 'audit successful/failed file attribute modification events'",
        "info": "Auditing is the capture and maintenance of information about security-related events.\n\nRationale:\n\nMaintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen a terminal session and edit the /etc/security/audit_control file\n\nFind the line beginning with 'flags'\n\nAdd the following flags: lo, ad, fd, fm, -all.\n\nSave the file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*fm).*$"
    },
    "custom_item_17": {
        "description": "3.2 Configure Security Auditing Flags - 'audit all failed events across all audit classes'",
        "info": "Auditing is the capture and maintenance of information about security-related events.\n\nRationale:\n\nMaintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen a terminal session and edit the /etc/security/audit_control file\n\nFind the line beginning with 'flags'\n\nAdd the following flags: lo, ad, fd, fm, -all.\n\nSave the file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/etc/security/audit_control",
        "regex": "^flags:",
        "expect": "^flags:.*(?=.*-all).*$"
    },
    "custom_item_18": {
        "description": "4.1 Disable Bonjour advertising service",
        "info": "Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on macOS is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.\n\nRationale:\n\nBonjour can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour's multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. Implementing this control disables the continuous broadcasting of 'I'm here!' messages. Typical end-user endpoints should not have to advertise services to other computers. This setting does not stop the computer from sending out service discovery messages when looking for services on an internal subnet, if the computer is looking for a printer or server and using service discovery. To block all Bonjour traffic except to approved devices the pf or other firewall would be needed.\n\nImpact:\n\nSome applications, like Final Cut Studio and AirPort Base Station management, may not operate properly if the mDNSResponder is turned off.",
        "solution": "Perform the following to implement the prescribed state:\nRun the following command in Terminal:\n\ndefaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements\n\nAdditional Information:\n\nAnything Bonjour discovers is already available on the network and probably discoverable with network scanning tools. The security benefit of disabling Bonjour for that reason is minimal.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2A,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "1",
        "plist_item": "NoMulticastAdvertisements",
        "plist_name": "/Library/Preferences/com.apple.mDNSResponder.plist"
    },
    "custom_item_19": {
        "description": "5.1.4 Check Library folder for world writable files",
        "info": "Software sometimes insists on being installed in the /Library Directory and have inappropriate world writable permissions.\n\nRationale:\n\nFolders in /Library should not be world writable. The audit check excludes the /Library/Caches folder where the sticky bit is set.",
        "solution": "Change permissions so that 'Others' can only execute. (Example Below)\n\nsudo chmod -R o-w /Bad/Directory",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|2A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/find /Library -type d -perm -2 -ls | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_20": {
        "description": "5.2.3 Complex passwords must contain an Alphabetic Character",
        "info": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.\n\nEnsure that an Alphabetic character is part of the password policy on the computer\n\nRationale:\n\nThe more complex a password the more resistant it will be against persons seeking unauthorized access to a system.\n\nImpact:\n\nPassword policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.",
        "solution": "Run the following command to set the that passwords must contain at least one letter:\n\n$ sudo pwpolicy -a-setaccountpolicies 'requiresAlpha='\n\nexample:\n\n$ sudo pwpolicy -a firstuser -setglobalpolicy 'requiresAlpha=1'",
        "reference": "LEVEL|2M",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumLetters | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1 | /usr/bin/awk '{print} END {if (NR == 0) print \"Not found\"}'",
        "expect": "@PASSWORD_ALPHA@"
    },
    "custom_item_21": {
        "description": "5.2.4 Complex passwords must contain a Numeric Character",
        "info": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.\n\nEnsure that a number or numeric value is part of the password policy on the computer.\n\nRationale:\n\nThe more complex a password the more resistant it will be against persons seeking unauthorized access to a system.\n\nImpact:\n\nPassword policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.",
        "solution": "Run the following command to set passwords to require at least one number:\n\n$ sudo pwpolicy -a-setaccountpolicies 'requiresNumeric==1>'\n\nexample:\n\n$ sudo pwpolicy -a test -setglobalpolicy 'requiresNumeric=2'",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),LEVEL|2M,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumNumericCharacters | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1 | /usr/bin/awk '{print} END {if (NR == 0) print \"Not found\"}'",
        "expect": "@PASSWORD_NUMERIC_CHARACTERS@"
    },
    "custom_item_22": {
        "description": "5.2.5 Complex passwords must contain a Special Character",
        "info": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer\n\nRationale:\n\nThe more complex a password the more resistant it will be against persons seeking unauthorized access to a system.\n\nImpact:\n\nPassword policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.",
        "solution": "Run the following command to set passwords to require at least one special character:\n\n$ sudo pwpolicy -a-setaccountpolicies 'requiresSymbol==1>'\n\nexample:\n\n$ sudo pwpolicy -a test -setglobalpolicy 'requiresSymbol=1'",
        "reference": "LEVEL|2M",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumSymbols | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1 | /usr/bin/awk '{print} END {if (NR == 0) print \"Not found\"}'",
        "expect": "@PASSWORD_MINIMUM_SYMBOLS@"
    },
    "custom_item_23": {
        "description": "5.2.6 Complex passwords must uppercase and lowercase letters",
        "info": "Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.\n\nEnsure that both uppercase and lowercase letters are part of the password policy on the computer\n\nRationale:\n\nThe more complex a password the more resistant it will be against persons seeking unauthorized access to a system.\n\nImpact:\n\nPassword policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.",
        "solution": "Run the following command to set passwords to require at upper and lower case letter:\n\n$ sudo pwpolicy -a-setaccountpolicies 'requiresMixedCase==1>'\n\nexample:\n\n$ sudo pwpolicy -a test -setglobalpolicy 'requiresMixedCase=1'",
        "reference": "LEVEL|2M",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/grep -A1 minimumMixedCaseCharacters | /usr/bin/tail -1 | /usr/bin/cut -d'>' -f2 | /usr/bin/cut -d '<' -f1 | /usr/bin/awk '{print} END {if (NR == 0) print \"Not found\"}'",
        "expect": "@PASSWORD_MIN_MIXED_CASE@"
    },
    "custom_item_24": {
        "description": "5.6 Ensure login keychain is locked when the computer sleeps",
        "info": "The login keychain is a secure database store for passwords and certificates and is created for each user account on macOS. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. The approach recommended here is that the login keychain be set to lock when when the computer sleeps to reduce the risk of password exposure. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.\n\nRationale:\n\nWhile logged in, the keychain does not prompt the user for passwords for various systems and/or programs. This can be exploited by unauthorized users to gain access to password protected programs and/or systems in the absence of the user.\n\nImpact:\n\nThe user may experience multiple prompts to unlock the keychain when waking from sleep.",
        "solution": "Perform the following to implement the prescribed state:\n\nOpen Utilities\n\nSelect Keychain Access\n\nSelect a keychain\n\nSelect Edit\n\nSelect Change Settings for keychainAuthenticate, if requested.\n\nSelect Lock when sleeping setting",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/security show-keychain-info 2>&1",
        "expect": "Keychain[\\\\s]*\"\\\\"
    },
    "custom_item_25": {
        "description": "5.7 Enable OCSP and CRL certificate checking - CRLStyle",
        "info": "Certificates should only be trusted if they have both a satisfactory trust chain and they have not been revoked. macOS check whether the certificate is still valid based on issued parameters within the certificate.\n\nRationale:\n\nA rogue or compromised certificate should not be trusted\n\nImpact:\n\nNetwork or connectivity issues could interfere with certificate checks for valid certificates",
        "solution": "Run the following commands to enforce the compliant state\nTo set the CRL settings:\n\ndefaults write com.apple.security.revocation CRLStyle -string RequireIfPresent\n\nTo set the OCSP settings:\n\ndefaults write com.apple.security.revocation OCSPStyle -string RequireIfPresent",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "RequireIfPresent",
        "plist_item": "CRLStyle",
        "plist_name": "com.apple.security.revocation",
        "plist_user": "all"
    },
    "custom_item_26": {
        "description": "5.7 Enable OCSP and CRL certificate checking - OCSPStyle",
        "info": "Certificates should only be trusted if they have both a satisfactory trust chain and they have not been revoked. macOS check whether the certificate is still valid based on issued parameters within the certificate.\n\nRationale:\n\nA rogue or compromised certificate should not be trusted\n\nImpact:\n\nNetwork or connectivity issues could interfere with certificate checks for valid certificates",
        "solution": "Run the following commands to enforce the compliant state\nTo set the CRL settings:\n\ndefaults write com.apple.security.revocation CRLStyle -string RequireIfPresent\n\nTo set the OCSP settings:\n\ndefaults write com.apple.security.revocation OCSPStyle -string RequireIfPresent",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(a),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "RequireIfPresent",
        "plist_item": "OCSPStyle",
        "plist_name": "com.apple.security.revocation",
        "plist_user": "all"
    },
    "custom_item_27": {
        "description": "5.11 Ensure system is set to hibernate",
        "cmd": "/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/egrep MacBook",
        "expect": "MacBook"
    },
    "custom_item_28": {
        "description": "5.11 Ensure system is set to hibernate",
        "info": "In order to use a computer with Full Disk Encryption (FDE) macOS must keep encryption keys in memory to allow the use of the disk that has been FileVault protected. The storage volume has been unlocked and acts as if it was not encrypted. When the system is not in use the volume is protected through encryption. When the system is sleeping and available to quickly resume the encryption keys remain in memory.\n\nIf an unauthorized party has possession of the computer and the computer is only slept there are known attack vectors that can be attempted against the RAM that has the encryption keys or the running operating system that is protected by a login screen. Network attacks if network interfaces are on as well as USB or other open device ports are possible. Most of these attacks require knowledge of unpatched vulnerabilities or a high level of sophistication if all the other controls function as intended.\n\nThere is little impact on hibernating the system rather than sleeping after an appropriate time period to remediate the risk of OS level attacks. Hibernation writes the keys to desk and requires FileVault to be unlocked prior to the OS being available. In the case of unauthorized personnel with access to the computer encryption would have to be broken prior to attacking the operating system in order to recover data from the system.\n\nhttps://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/\n\nMac systems should be set to hibernate after sleeping for a risk acceptable time period. The default value for 'standbydelay' is three hours (10800 seconds). This value is likely appropriate for most Desktops. If Mac desktops are deployed in unmonitored less physically secure areas with confidential data this value might be adjusted. The desktop or would have to retain power so that the running OS or physical RAM could be attacked however.\n\nMacBooks should be set so that the standbydelay is 15 minutes (900 seconds) or less. This setting should allow laptop users in most cases to stay within physically secured areas while going to a conference room, auditorium or other internal location without having to unlock the encryption. When the user goes home at night the laptop will auto-hibernate after 15 minutes and require the FileVault password to unlock prior to logging back in to system when it resumes.\n\nRationale:\n\nTo mitigate the risk of data loss the system should power down and lock the encrypted drive after a specified time. Laptops should hibernate 15 minutes or less after sleeping.\n\nImpact:\n\nThe laptop will take additional time to resume normal operation then if only sleeping rather than hibernating",
        "solution": "Perform the following to configure laptops as prescribed:\n\nRun the following command in Terminal:\n\nsudo pmset -a standbydelay 900\n\nAdditional Information:\n\nThere are several good references to the concerns about ensuring hibernation rather than sleep is in place. A selection below:\n\nhttp://mattwashchuk.com/articles/2016/01/08/maximizing-filevault-security\n\nhttps://www.zdziarski.com/blog/?p=6705\n\nhttps://www.howtogeek.com/260478/how-to-choose-when-your-mac-hibernates-or-enters-standby/\n\nhttps://www.lifewire.com/change-mac-sleep-settings-2260804",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/pmset -g | /usr/bin/egrep standbydelay",
        "expect": "standbydelay[\\\\s]+([1-9]|[1-9][0-9]|[1-8][0-9][0-9]|900)$"
    },
    "custom_item_29": {
        "description": "5.11 Ensure system is set to hibernate",
        "info": "In order to use a computer with Full Disk Encryption (FDE) macOS must keep encryption keys in memory to allow the use of the disk that has been FileVault protected. The storage volume has been unlocked and acts as if it was not encrypted. When the system is not in use the volume is protected through encryption. When the system is sleeping and available to quickly resume the encryption keys remain in memory.\n\nIf an unauthorized party has possession of the computer and the computer is only slept there are known attack vectors that can be attempted against the RAM that has the encryption keys or the running operating system that is protected by a login screen. Network attacks if network interfaces are on as well as USB or other open device ports are possible. Most of these attacks require knowledge of unpatched vulnerabilities or a high level of sophistication if all the other controls function as intended.\n\nThere is little impact on hibernating the system rather than sleeping after an appropriate time period to remediate the risk of OS level attacks. Hibernation writes the keys to desk and requires FileVault to be unlocked prior to the OS being available. In the case of unauthorized personnel with access to the computer encryption would have to be broken prior to attacking the operating system in order to recover data from the system.\n\nhttps://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/\n\nMac systems should be set to hibernate after sleeping for a risk acceptable time period. The default value for 'standbydelay' is three hours (10800 seconds). This value is likely appropriate for most Desktops. If Mac desktops are deployed in unmonitored less physically secure areas with confidential data this value might be adjusted. The desktop or would have to retain power so that the running OS or physical RAM could be attacked however.\n\nMacBooks should be set so that the standbydelay is 15 minutes (900 seconds) or less. This setting should allow laptop users in most cases to stay within physically secured areas while going to a conference room, auditorium or other internal location without having to unlock the encryption. When the user goes home at night the laptop will auto-hibernate after 15 minutes and require the FileVault password to unlock prior to logging back in to system when it resumes.\n\nRationale:\n\nTo mitigate the risk of data loss the system should power down and lock the encrypted drive after a specified time. Laptops should hibernate 15 minutes or less after sleeping.\n\nImpact:\n\nThe laptop will take additional time to resume normal operation then if only sleeping rather than hibernating",
        "solution": "Perform the following to configure laptops as prescribed:\n\nRun the following command in Terminal:\n\nsudo pmset -a standbydelay 900\n\nAdditional Information:\n\nThere are several good references to the concerns about ensuring hibernation rather than sleep is in place. A selection below:\n\nhttp://mattwashchuk.com/articles/2016/01/08/maximizing-filevault-security\n\nhttps://www.zdziarski.com/blog/?p=6705\n\nhttps://www.howtogeek.com/260478/how-to-choose-when-your-mac-hibernates-or-enters-standby/\n\nhttps://www.lifewire.com/change-mac-sleep-settings-2260804",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/egrep MacBook | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'",
        "expect": "none"
    },
    "custom_item_30": {
        "description": "5.15 Create a Login window banner",
        "info": "A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required\n\nRationale:\n\nAn access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.\n\nImpact:\n\nUsers will have to click on the window with the Login text before logging into the computer",
        "solution": "Place a file named PolicyBanner.txt in /Library/Security/",
        "reference": "800-171|3.1.9,800-53|AC-8,800-53r5|AC-8,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8,LEVEL|2A,NESA|M1.3.6,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "file": "/Library/Security/PolicyBanner.txt",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_31": {
        "description": "5.17 Disable Fast User Switching",
        "info": "Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user. In a large directory environment where it is difficult to limit login access many valid users can login to other user's assigned computers.\n\nRationale:\n\nFast user switching allows multiple users to run applications simultaneously at console. There can be information disclosed about processes running under a different user. Without a specific configuration to save data and log out users can have unsaved data running in a background session that is not obvious.\n\nImpact:\n\nWhere support staff visit users computers consoles they will not be able to log in to their own session if there is an active and locked session.",
        "solution": "In System Preferences: Accounts, Login Options, make sure the 'Enable fast user switching' checkbox is off.\n\nAdditional Information:\n\nmacOS is a multi-user operating system, and there are other similar methods that might provide the same kind of risk. The Remote Login service that can be turned on in the Sharing System Preferences pane is another.",
        "reference": "800-53|AC-10,800-53r5|AC-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-10,LEVEL|2M,NESA|T5.5.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "regex": "0",
        "plist_item": "MultipleSessionEnabled",
        "plist_name": "/Library/Preferences/.GlobalPreferences"
    },
    "custom_item_32": {
        "description": "6.4 Safari disable Internet Plugins for global use",
        "info": "Starting with Safari 10 and continuing with 11 Apple changed the model on how the built-in web browser handles Internet Plug-Ins. Instead of using a global approach where the Plug-in is either on or off for all sites the default decision is about allowing, not allowing, or allowing permanently for a specific site that is visited. Other browsers are moving to stop using Plug-ins altogether and insist on the use of HTML 5 for rich content. Only allowing Plug-in content from specific sites is a viable security option. In the Security Preferences, Plug-in settings it is possible to override the security feature and enable Plug-in content globally by Plug-in. With the controls planned in other macOS browsers allowing content globally is likely to put Safari users more at risk than other browser users.\n\nThere are three options for Internet Plug-ins with Safari 10 'When visiting other websites' Ask, Off or On. The on setting should not be used.\n\nhttps://support.apple.com/en-us/HT202819\n\nRationale:\n\nAllow Internet Plugins only on required sites\n\nImpact:\n\nUsers will have to approve Internet Plugin use by site.",
        "solution": "Select either ask to use or block",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2M,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/3092",
        "cmd": "/usr/bin/defaults read ~/Library/Preferences/com.apple.Safari.plist | /usr/bin/grep -i 'PlugInFirstVisitPolicy = *'",
        "expect": ".*= (PlugInPolicyAsk|PlugInPolicyBlock);"
    }
}