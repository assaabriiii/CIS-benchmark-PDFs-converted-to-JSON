{
    "custom_item_1": {
        "system": "Linux",
        "description": "Check root path variable",
        "name": "dot_in_root_path_variable"
    },
    "custom_item_2": {
        "system": "Linux",
        "description": "Check writable dirs in root path variable",
        "name": "writeable_dirs_in_root_path_variable"
    },
    "custom_item_3": {
        "system": "Linux",
        "description": "6.2.7 Ensure all users' home directories exist",
        "info": "Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.\n\nRationale:\n\nIf the user's home directory does not exist or is unassigned, the user will be placed in '/' and will not be able to write any files or have local environment variables set.",
        "solution": "If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users without an assigned home directory should be removed or assigned a home directory as appropriate.\n\nAdditional Information:\n\nThe audit script checks all users UID 500 and above except nfsnobody. Some distributions split at UID 1000 instead, consult your documentation and/or the UID_MIN setting in /etc/login.defs to determine which is appropriate for you.\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "name": "active_accounts_without_home_dir"
    },
    "custom_item_4": {
        "system": "Linux",
        "description": "6.2.8 Ensure users' home directories permissions are 750 or more restrictive",
        "info": "While the system administrator can establish secure permissions for users' home directories, the users can easily override these.\n\nRationale:\n\nGroup or world-writable user home directories may enable malicious users to steal or modify other users' data or to gain another user's system privileges.",
        "solution": "Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "name": "accounts_bad_home_permissions",
        "mask": "0027",
        "ignore_shell": "/usr/sbin/nologin /usr/bin/false /sbin/nologin /bin/false",
        "ignore_user": "halt sync shutdown nfsnobody"
    },
    "custom_item_5": {
        "system": "Linux",
        "description": "6.2.9 Ensure users own their home directories",
        "info": "The user home directory is space defined for the particular user to set local environment variables and to store personal files.\n\nRationale:\n\nSince the user is accountable for files stored in the user home directory, the user must be the owner of the directory.",
        "solution": "Change the ownership of any home directories that are not owned by the defined user to the correct user.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "name": "accounts_bad_home_permissions",
        "mask": "0000",
        "ignore_shell": "/usr/sbin/nologin /usr/bin/false /sbin/nologin /bin/false",
        "ignore_user": "halt sync shutdown nfsnobody"
    },
    "custom_item_6": {
        "system": "Linux",
        "description": "6.2.15 Ensure all groups in /etc/passwd exist in /etc/group",
        "info": "Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group .\n\nRationale:\n\nGroups defined in the /etc/passwd file but not in the /etc/group file pose a threat to system security since group permissions are not properly managed.",
        "solution": "Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.",
        "reference": "800-171|3.1.1,800-53|AC-2c.,800-53r5|AC-2c.,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2c.,LEVEL|2A,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|1.1.5,PCI-DSSv3.2.1|7.1.1,PCI-DSSv3.2.1|7.1.3,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "name": "passwd_invalid_gid"
    },
    "custom_item_7": {
        "description": "Google Container-Optimized found",
        "file": "/etc/os-release",
        "regex": "PRETTY_NAME=\"Container-Optimized OS from Google\"",
        "expect": "PRETTY_NAME=\"Container-Optimized OS from Google\""
    },
    "custom_item_8": {
        "system": "Linux",
        "description": "1.1.1.1 Ensure mounting of udf filesystems is disabled - modprobe",
        "info": "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats.\n\nRationale:\n\nRemoving support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
        "solution": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/udf.conf\nand add the following line:\n\ninstall udf /bin/true\n\nRun the following command to unload the udf module:\n\n# rmmod udf",
        "reference": "800-171|3.1.1,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-2,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(d),CSCv7|3.3,CSCv7|5.1,CSCv8|4.1,CSCv8|4.8,CSCv8|5.5,CSF|DE.AE-1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|2A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS8b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/modprobe -n -v udf | /usr/bin/awk '{print} END {if (NR == 0) print \"fail\"}'",
        "expect": "install[\\\\s]+/bin/true"
    },
    "custom_item_9": {
        "system": "Linux",
        "description": "1.1.1.1 Ensure mounting of udf filesystems is disabled - lsmod",
        "info": "The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats.\n\nRationale:\n\nRemoving support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it.",
        "solution": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/udf.conf\nand add the following line:\n\ninstall udf /bin/true\n\nRun the following command to unload the udf module:\n\n# rmmod udf",
        "reference": "800-171|3.1.1,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-2,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CN-L3|7.1.3.2(d),CSCv7|3.3,CSCv7|5.1,CSCv8|4.1,CSCv8|4.8,CSCv8|5.5,CSF|DE.AE-1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|2A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|AM28,NIAv2|GS8b,NIAv2|NS5j,NIAv2|SS3,NIAv2|SS14e,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/lsmod | /bin/grep udf | /usr/bin/awk \\'{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}\\'",
        "expect": "pass"
    },
    "custom_item_10": {
        "system": "Linux",
        "description": "1.1.6 Ensure nosuid option set on /var partition",
        "info": "The nosuid mount option specifies that the filesystem cannot contain setuid files.\n\nRationale:\n\nSince the /var filesystem is only intended for temporary dynamic data, set this option to ensure that users cannot create setuid files in /var.",
        "solution": "Run the following command to remount /var :\n\n# mount -o remount,nosuid /var\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/mount | /bin/grep 'on /var ' | /usr/bin/awk '{print} END {if (NR == 0) print \"not mounted\"}'",
        "expect": "([\\\\s]*[,]?nosuid|not mounted)"
    },
    "custom_item_11": {
        "system": "Linux",
        "description": "1.1.7 Ensure noexec option set on /var partition",
        "info": "The noexec mount option specifies that the filesystem cannot contain executable binaries.\n\nRationale:\n\nSince the /var filesystem is only intended for services to write data and not execute, set this option to ensure that users cannot run executable binaries from /var.",
        "solution": "Run the following command to remount /var :\n\n# mount -o remount,noexec /var\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.1,800-171|3.4.7,800-171|3.4.9,800-53|CM-7(2),800-53|CM-8(3),800-53|CM-10,800-53|CM-11,800-53r5|CM-7(2),800-53r5|CM-8(3),800-53r5|CM-10,800-53r5|CM-11,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.6,CSCv8|2.3,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,ITSG-33|CM-7(2),ITSG-33|CM-8(3),LEVEL|2A,NESA|T1.2.1,NESA|T1.2.2,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/mount | /bin/grep 'on /var ' | /usr/bin/awk '{print} END {if (NR == 0) print \"not mounted\"}'",
        "expect": "([\\\\s]*[,]?noexec|not mounted)"
    },
    "custom_item_12": {
        "system": "Linux",
        "description": "1.1.8 Ensure nodev option set on /var partition",
        "info": "The nodev mount option specifies that the filesystem cannot contain special devices.\n\nRationale:\n\nSince the /var filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var .",
        "solution": "Run the following command to remount /var :\n\n# mount -o remount,nodev /var\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/mount | /bin/grep 'on /var ' | /usr/bin/awk '{print} END {if (NR == 0) print \"not mounted\"}'",
        "expect": "([\\\\s]*[,]?nodev|not mounted)"
    },
    "custom_item_13": {
        "system": "Linux",
        "description": "1.4.1 Ensure core dumps are restricted - limits config",
        "info": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.\n\nRationale:\n\nSetting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5) ). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core.",
        "solution": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file:\n\n* hard core 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\n\nIf systemd-coredump@ is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\n\nStorage=none\nProcessSizeMax=0\n\nRun the command:\n\nsystemctl daemon-reload\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/grep -s -P '^[\\\\s]*\\\\*[\\\\s]+hard[\\\\s]+core[\\\\s]+0[\\\\s]*$' /etc/security/limits.conf /etc/security/limits.d/* |/usr/bin/awk '{print} END {if (NR != 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_14": {
        "system": "Linux",
        "description": "1.4.1 Ensure core dumps are restricted - sysctl",
        "info": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.\n\nRationale:\n\nSetting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5) ). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core.",
        "solution": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file:\n\n* hard core 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\n\nIf systemd-coredump@ is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\n\nStorage=none\nProcessSizeMax=0\n\nRun the command:\n\nsystemctl daemon-reload\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl fs.suid_dumpable",
        "expect": "^[\\\\s]*fs\\\\.suid_dumpable[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_15": {
        "description": "coredump.service is installed",
        "cmd": "/bin/systemctl is-enabled systemd-coredump | /usr/bin/awk \\'{print} END {if(NR==0) print \"not installed\" }\\'",
        "expect": "(enabled|masked|disabled)"
    },
    "custom_item_16": {
        "system": "Linux",
        "description": "1.4.1 Ensure core dumps are restricted - storage",
        "info": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.\n\nRationale:\n\nSetting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5) ). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core.",
        "solution": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file:\n\n* hard core 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\n\nIf systemd-coredump@ is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\n\nStorage=none\nProcessSizeMax=0\n\nRun the command:\n\nsystemctl daemon-reload\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/systemd/coredump.conf",
        "regex": "^[\\\\s]*Storage[\\\\s]*=",
        "expect": "^[\\\\s]*Storage[\\\\s]*=[\\\\s]*none[\\\\s]*$"
    },
    "custom_item_17": {
        "system": "Linux",
        "description": "1.4.1 Ensure core dumps are restricted - processsizemax",
        "info": "A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.\n\nRationale:\n\nSetting a hard limit on core dumps prevents users from overriding the soft variable. If core dumps are required, consider setting limits for user groups (see limits.conf(5) ). In addition, setting the fs.suid_dumpable variable to 0 will prevent setuid programs from dumping core.",
        "solution": "Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file:\n\n* hard core 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\n\nIf systemd-coredump@ is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\n\nStorage=none\nProcessSizeMax=0\n\nRun the command:\n\nsystemctl daemon-reload\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/systemd/coredump.conf",
        "regex": "^[\\\\s]*ProcessSizeMax[\\\\s]*=",
        "expect": "^[\\\\s]*ProcessSizeMax[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_18": {
        "system": "Linux",
        "description": "1.5.1.1 Ensure message of the day is configured properly - banner text",
        "info": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\n\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \\m - machine architecture \\r - operating system release \\s - operating system name \\v - operating system version\n\nRationale:\n\nWarning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the ' uname -a ' command once they have logged in.",
        "solution": "Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform\n/etc is stateless on Container-Optimized OS. Therefore, the steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/motd",
        "content": "@BANNER_TEXT@"
    },
    "custom_item_19": {
        "system": "Linux",
        "description": "1.5.1.1 Ensure message of the day is configured properly - platform flags",
        "info": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\n\nUnix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \\m - machine architecture \\r - operating system release \\s - operating system name \\v - operating system version\n\nRationale:\n\nWarning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the ' uname -a ' command once they have logged in.",
        "solution": "Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform\n/etc is stateless on Container-Optimized OS. Therefore, the steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/motd",
        "regex": "\\\\\\\\[mrsv]",
        "expect": "\\\\\\\\[mrsv]"
    },
    "custom_item_20": {
        "system": "Linux",
        "description": "1.5.1.4 Ensure permissions on /etc/motd are configured",
        "info": "The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.\n\nRationale:\n\nIf the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.",
        "solution": "Run the following commands to set permissions on /etc/motd :\n\n# chown root:root /etc/motd\n# chmod 644 /etc/motd\n\n/etc is stateless on Container-Optimized OS. Therefore, the steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/motd",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_21": {
        "system": "Linux",
        "description": "1.5.1.6 Ensure permissions on /etc/issue.net are configured",
        "info": "The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.\n\nRationale:\n\nIf the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.",
        "solution": "Run the following commands to set permissions on /etc/issue.net :\n\n# chown root:root /etc/issue.net\n# chmod 644 /etc/issue.net\n\n/etc is stateless on Container-Optimized OS. Therefore, the steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/issue.net",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_22": {
        "description": "chrony is enabled",
        "cmd": "/bin/systemctl is-enabled chrony",
        "expect": "enabled"
    },
    "custom_item_23": {
        "description": "chrony is running",
        "cmd": "/bin/systemctl is-active chrony",
        "expect": "active"
    },
    "custom_item_24": {
        "system": "Linux",
        "description": "2.1.1.2 Ensure chrony is configured - NTP server",
        "info": "chrony is a daemon which implements the Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/. chrony can be configured to be a client and/or a server.\n\nRationale:\n\nIf chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.\n\nThis recommendation only applies if chrony is in use on the system.",
        "solution": "Update to an OS image that has the correct chrony configuration.",
        "reference": "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/chrony/chrony.conf",
        "regex": "^[\\\\s]*(server|pool)[\\\\s]+@NTP_SERVER@",
        "expect": "^[\\\\s]*(server|pool)[\\\\s]+@NTP_SERVER@"
    },
    "custom_item_25": {
        "system": "Linux",
        "description": "2.1.1.2 Ensure chrony is configured - process",
        "info": "chrony is a daemon which implements the Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/. chrony can be configured to be a client and/or a server.\n\nRationale:\n\nIf chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.\n\nThis recommendation only applies if chrony is in use on the system.",
        "solution": "Update to an OS image that has the correct chrony configuration.",
        "reference": "800-171|3.3.6,800-171|3.3.7,800-53|AU-7,800-53|AU-8,800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(b),CSCv7|6.1,CSCv8|8.4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2A,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/ps -ef | /bin/grep chronyd | /bin/grep -v grep | /usr/bin/cut -d ' ' -f 1",
        "expect": "(chrony|ntp)"
    },
    "custom_item_26": {
        "system": "Linux",
        "description": "3.2.1 Ensure source routed packets are not accepted - net.ipv4.conf.all.accept_source_route",
        "info": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\n\nRationale:\n\nSetting net.ipv4.conf.all.accept_source_route, net.ipv4.conf.default.accept_source_route, net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_27": {
        "system": "Linux",
        "description": "3.2.1 Ensure source routed packets are not accepted - net.ipv4.conf.default.accept_source_route",
        "info": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\n\nRationale:\n\nSetting net.ipv4.conf.all.accept_source_route, net.ipv4.conf.default.accept_source_route, net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_28": {
        "system": "Linux",
        "description": "3.2.1 Ensure source routed packets are not accepted - net.ipv6.conf.all.accept_source_route",
        "info": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\n\nRationale:\n\nSetting net.ipv4.conf.all.accept_source_route, net.ipv4.conf.default.accept_source_route, net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_29": {
        "system": "Linux",
        "description": "3.2.1 Ensure source routed packets are not accepted - net.ipv6.conf.default.accept_source_route",
        "info": "In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\n\nRationale:\n\nSetting net.ipv4.conf.all.accept_source_route, net.ipv4.conf.default.accept_source_route, net.ipv6.conf.all.accept_source_route and net.ipv6.conf.default.accept_source_route to 0 disables the system from accepting source routed packets. Assume this system was capable of routing packets to Internet routable addresses on one interface and private addresses on another interface. Assume that the private addresses were not routable to the Internet routable addresses and vice versa. Under normal routing circumstances, an attacker from the Internet routable addresses could not use the system as a way to reach the private address systems. If, however, source routed packets were allowed, they could be used to gain access to the private address systems as the route could be specified, rather than rely on routing protocols that did not allow this routing.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_source_route",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_source_route[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_30": {
        "system": "Linux",
        "description": "3.2.2 Ensure ICMP redirects are not accepted - net.ipv4.conf.all.accept_redirects",
        "info": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.\n\nRationale:\n\nAttackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_31": {
        "system": "Linux",
        "description": "3.2.2 Ensure ICMP redirects are not accepted - net.ipv4.conf.default.accept_redirects",
        "info": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.\n\nRationale:\n\nAttackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_32": {
        "system": "Linux",
        "description": "3.2.2 Ensure ICMP redirects are not accepted - net.ipv6.conf.all.accept_redirects",
        "info": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.\n\nRationale:\n\nAttackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_33": {
        "system": "Linux",
        "description": "3.2.2 Ensure ICMP redirects are not accepted - net.ipv6.conf.default.accept_redirects",
        "info": "ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects and net.ipv6.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.\n\nRationale:\n\nAttackers could use bogus ICMP redirect messages to maliciously alter the system routing tables and get them to send packets to incorrect networks and allow your system packets to be captured.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_34": {
        "system": "Linux",
        "description": "3.2.3 Ensure secure ICMP redirects are not accepted - net.ipv4.conf.all.secure_redirects",
        "info": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.\n\nRationale:\n\nIt is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects to 0 protects the system from routing table updates by possibly compromised known gateways.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.secure_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_35": {
        "system": "Linux",
        "description": "3.2.3 Ensure secure ICMP redirects are not accepted - net.ipv4.conf.default.secure_redirects",
        "info": "Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.\n\nRationale:\n\nIt is still possible for even known gateways to be compromised. Setting net.ipv4.conf.all.secure_redirects to 0 protects the system from routing table updates by possibly compromised known gateways.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.secure_redirects",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.secure_redirects[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_36": {
        "system": "Linux",
        "description": "3.2.4 Ensure suspicious packets are logged - net.ipv4.conf.all.log_martians",
        "info": "When enabled, this feature logs packets with un-routable source addresses to the kernel log.\n\nRationale:\n\nEnabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.all.log_martians",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.all\\\\.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_37": {
        "system": "Linux",
        "description": "3.2.4 Ensure suspicious packets are logged - net.ipv4.conf.default.log_martians",
        "info": "When enabled, this feature logs packets with un-routable source addresses to the kernel log.\n\nRationale:\n\nEnabling this feature and logging these packets allows an administrator to investigate the possibility that an attacker is sending spoofed packets to their system.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv4.conf.default.log_martians",
        "expect": "^[\\\\s]*net\\\\.ipv4\\\\.conf\\\\.default\\\\.log_martians[\\\\s]*=[\\\\s]*1[\\\\s]*$"
    },
    "custom_item_38": {
        "system": "Linux",
        "description": "3.2.9 Ensure IPv6 router advertisements are not accepted - net.ipv6.conf.all.accept_ra",
        "info": "This setting disables the system's ability to accept IPv6 router advertisements.\n\nRationale:\n\nIt is recommended that systems do not accept router advertisements as they could be tricked into routing traffic to compromised machines. Setting hard routes within the system (usually a single default route to a trusted router) protects the system from bad routes.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.all.accept_ra",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_ra[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_39": {
        "system": "Linux",
        "description": "3.2.9 Ensure IPv6 router advertisements are not accepted - net.ipv6.conf.default.accept_ra",
        "info": "This setting disables the system's ability to accept IPv6 router advertisements.\n\nRationale:\n\nIt is recommended that systems do not accept router advertisements as they could be tricked into routing traffic to compromised machines. Setting hard routes within the system (usually a single default route to a trusted router) protects the system from bad routes.",
        "solution": "Run the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|5.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/sysctl net.ipv6.conf.default.accept_ra",
        "expect": "^[\\\\s]*net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_ra[\\\\s]*=[\\\\s]*0[\\\\s]*$"
    },
    "custom_item_40": {
        "system": "Linux",
        "description": "3.3.1.1 Ensure IPv6 default deny firewall policy - Chain INPUT",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# ip6tables -P INPUT DROP\n# ip6tables -P OUTPUT DROP\n# ip6tables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/ip6tables -L -n | /bin/grep 'Chain INPUT'",
        "expect": "^Chain INPUT \\\\(policy DROP\\\\)"
    },
    "custom_item_41": {
        "system": "Linux",
        "description": "3.3.1.1 Ensure IPv6 default deny firewall policy - Chain OUTPUT",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# ip6tables -P INPUT DROP\n# ip6tables -P OUTPUT DROP\n# ip6tables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/ip6tables -L -n | /bin/grep 'Chain OUTPUT'",
        "expect": "^Chain OUTPUT \\\\(policy DROP\\\\)"
    },
    "custom_item_42": {
        "system": "Linux",
        "description": "3.3.1.1 Ensure IPv6 default deny firewall policy - Chain FORWARD",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# ip6tables -P INPUT DROP\n# ip6tables -P OUTPUT DROP\n# ip6tables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/ip6tables -L -n | /bin/grep 'Chain FORWARD'",
        "expect": "^Chain FORWARD \\\\(policy DROP\\\\)"
    },
    "custom_item_43": {
        "system": "Linux",
        "description": "3.3.1.2 Ensure IPv6 loopback traffic is configured",
        "info": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network (::1).\n\nRationale:\n\nLoopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network (::1) traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following commands to implement the loopback rules:\n\n# ip6tables -A INPUT -i lo -j ACCEPT\n# ip6tables -A OUTPUT -o lo -j ACCEPT\n# ip6tables -A INPUT -s ::1 -j DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/ip6tables -L INPUT -v -n; /sbin/ip6tables -L OUTPUT -v -n",
        "expect": ""
    },
    "custom_item_44": {
        "system": "Linux",
        "description": "3.3.1.3 Ensure IPv6 outbound and established connections are configured",
        "info": "Configure the firewall rules for new outbound, and established IPv6 connections.\n\nRationale:\n\nIf rules are not in place for new outbound, and established connections all packets will be dropped by the default policy preventing network usage.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/iptables -L -v -n",
        "expect": ""
    },
    "custom_item_45": {
        "system": "Linux",
        "description": "3.3.1.4 Ensure IPv6 firewall rules exist for all open ports",
        "info": "Any ports that have been opened on non-loopback addresses need firewall rules to govern traffic.\n\nRationale:\n\nWithout a firewall rule configured for open ports default firewall policy will drop all packets to these ports.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections:\n\n# ip6tables -A INPUT -p--dport-m state --state NEW -j ACCEPT\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.\n\nThe remediation command opens up the port to traffic from all sources. Consult iptables documentation and set any restrictions in compliance with site policy.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/ss -4tuln; /sbin/iptables -L INPUT -v -n",
        "expect": ""
    },
    "custom_item_46": {
        "system": "Linux",
        "description": "3.3.2.1 Ensure default deny firewall policy - Chain INPUT",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/iptables -L -n | /bin/grep 'Chain INPUT'",
        "expect": "^Chain INPUT \\\\(policy DROP\\\\)"
    },
    "custom_item_47": {
        "system": "Linux",
        "description": "3.3.2.1 Ensure default deny firewall policy - Chain OUTPUT",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/iptables -L -n | /bin/grep 'Chain OUTPUT'",
        "expect": "^Chain OUTPUT \\\\(policy DROP\\\\)"
    },
    "custom_item_48": {
        "system": "Linux",
        "description": "3.3.2.1 Ensure default deny firewall policy - Chain FORWARD",
        "info": "A default deny all policy on connections ensures that any unconfigured network usage will be rejected.\n\nRationale:\n\nWith a default accept policy the firewall will accept any packet that is not configured to be denied. It is easier to white list acceptable usage than to black list unacceptable usage.",
        "solution": "Run the following commands to implement a default DROP policy:\n\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/sbin/iptables -L -n | /bin/grep 'Chain FORWARD'",
        "expect": "^Chain FORWARD \\\\(policy DROP\\\\)"
    },
    "custom_item_49": {
        "system": "Linux",
        "description": "3.3.2.2 Ensure loopback traffic is configured",
        "info": "Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network (127.0.0.0/8).\n\nRationale:\n\nLoopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network (127.0.0.0/8) traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Run the following commands to implement the loopback rules:\n\n# iptables -A INPUT -i lo -j ACCEPT\n# iptables -A OUTPUT -o lo -j ACCEPT\n# iptables -A INPUT -s 127.0.0.0/8 -j DROP\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/iptables -L INPUT -v -n; /sbin/iptables -L OUTPUT -v -n",
        "expect": ""
    },
    "custom_item_50": {
        "system": "Linux",
        "description": "3.3.2.3 Ensure outbound and established connections are configured",
        "info": "Configure the firewall rules for new outbound, and established connections.\n\nRationale:\n\nIf rules are not in place for new outbound, and established connections all packets will be dropped by the default policy preventing network usage.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n\nAdditional Information:\n\nChanging firewall settings while connected over network can result in being locked out of the system.\n\nRemediation will only affect the active system firewall, be sure to configure the default policy in your firewall management to apply on boot as well.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.4,CSCv8|4.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2M,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/iptables -L -v -n",
        "expect": "ManualReviewRequired"
    },
    "custom_item_51": {
        "system": "Linux",
        "description": "4.1.1.1 Ensure correct container image is set for stackdriver logging agent",
        "info": "stackdriver-logging service runs stackdriver container image to export logs to Cloud Logging.\n\nNote: This recommendation is not applicable for COS images using Fluent-bit as it isn't containerized.\n\nRationale:\n\nIf the logging agent is not set correctly, the logs cannot be exported to Cloud Logging.",
        "solution": "Edit the LOGGING_AGENT_DOCKER_IMAGE variable in the /etc/stackdriver/env_vars file to set the correct logging agent.\nRun the following command to restart stackdriver-logging service :\n\n# systemctl restart stackdriver-logging\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(a),CN-L3|8.1.4.3(b),CSCv7|6.2,CSCv7|6.3,CSCv8|8.2,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NESA|T3.6.2,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/stackdriver/env_vars",
        "regex": "^[\\\\s]*LOGGING_AGENT_DOCKER_IMAGE[\\\\s]*=[\\\\s]*",
        "expect": "^[\\\\s]*LOGGING_AGENT_DOCKER_IMAGE[\\\\s]*=[\\\\s]*@LOGGING_AGENT_DOCKER_IMAGE_VERSION@"
    },
    "custom_item_52": {
        "description": "Check if stackdriver-logging is enabled",
        "cmd": "/usr/bin/systemctl status stackdriver-logging",
        "expect": "^[\\\\s]*Active:[\\\\s]*active[\\\\s]*\\\\(running\\\\)"
    },
    "custom_item_53": {
        "description": "Check if fluent-bit is enabled",
        "cmd": "/usr/bin/systemctl status fluent-bit",
        "expect": "^[\\\\s]*Active:[\\\\s]*active[\\\\s]*\\\\(running\\\\)"
    },
    "custom_item_54": {
        "system": "Linux",
        "description": "4.1.2.1 Ensure journald is configured to compress large log files",
        "info": "The journald system includes the capability of compressing overly large files to avoid filling up the system with logs or making the logs unmanageably large.\n\nRationale:\n\nUncompressed large files may unexpectedly fill a filesystem leading to resource unavailability. Compressing logs prior to write can prevent sudden, unexpected filesystem impacts.",
        "solution": "Edit the /etc/systemd/journald.conf file and add the following line:\n\nCompress=yes\n\nReload the configuration to be effective.\n\n# systemctl force-reload systemd-journald\n\n/etc is stateless on Container-Optimized OS. Therefore, /etc cannot be used to make these changes persistent across reboots. The steps mentioned above needs to be performed after every boot.",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|2A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/grep -e ^[\\\\s]*Compress /etc/systemd/journald.conf | /usr/bin/awk '{print} END {if (NR == 0) print \"fail\"}'",
        "expect": "^[\\\\s]*Compress[\\\\s]*=[\\\\s]*yes[\\\\s]*$"
    },
    "custom_item_55": {
        "system": "Linux",
        "description": "4.1.3 Ensure permissions on all logfiles are configured",
        "info": "Log files stored in /var/log/ contain logged information from many services on the system, or on log hosts others as well.\n\nRationale:\n\nIt is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected.",
        "solution": "Run the following commands to set permissions on all existing log files:\n\nfind /var/log -type f -exec chmod g-wx,o-rwx '{}' + -o -type d -exec chmod g-w,o-rwx '{}' +\n\nAdditional Information:\n\nYou may also need to change the configuration for your logging software or services for any logs that had incorrect permissions.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "OUTPUT=$(ls -l /var/log); /usr/bin/find /var/log -type f -perm /g+wx,o+rwx -ls | /usr/bin/awk -v awkvar=\"${OUTPUT}\" '{print} END {if (NR == 0) print awkvar \"\\\\npass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_56": {
        "system": "Linux",
        "description": "5.1.7 Ensure SSH MaxAuthTries is set to 4 or less",
        "info": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the journald logs detailing the login failure.\n\nRationale:\n\nSetting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. While the recommended setting is 4, set the number based on site policy.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nMaxAuthTries 4\n\nDefault Value:\n\nMaxAuthTries 6",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|16.13,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|2A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep maxauthtries",
        "expect": "^[\\\\s]*(?i)MaxAuthTries(?-i)[\\\\s]+[1-4][\\\\s]*$"
    },
    "custom_item_57": {
        "system": "Linux",
        "description": "5.1.14 Ensure only strong MAC algorithms are used",
        "info": "This variable limits the types of MAC algorithms that SSH can use during communication.\n\nRationale:\n\nMD5 and 96-bit MAC algorithms are considered weak and have been shown to increase exploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algorithm could take advantage of a MiTM position to decrypt the SSH tunnel and capture credentials and information",
        "solution": "Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma separated list of the site approved MACs\nExample:\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n\nDefault Value:\n\nmacs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv7|16.5,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T | /bin/grep -i \"MACs\" | /bin/egrep '(hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1|hmac-sha1-96|umac-64@openssh.com|umac-128@openssh.com|hmac-md5-etm@openssh.com|hmac-md5-96-etm@openssh.com|hmac-ripemd160-etm@openssh.com|hmac-sha1-etm@openssh.com|hmac-sha1-96-etm@openssh.com|umac-64-etm@openssh.com|umac-128-etm@openssh.com)' | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\"; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_58": {
        "system": "Linux",
        "description": "5.1.16 Ensure SSH Idle Timeout Interval is configured - ClientAliveInterval",
        "info": "The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions. When the ClientAliveInterval variable is set, ssh sessions that have no activity for the specified length of time are terminated. When the ClientAliveCountMax variable is set, sshd will send client alive messages at every ClientAliveInterval interval. When the number of consecutive client alive messages are sent with no response from the client, the ssh session is terminated. For example, if the ClientAliveInterval is set to 15 seconds and the ClientAliveCountMax is set to 3, the client ssh session will be terminated after 45 seconds of idle time.\n\nRationale:\n\nHaving no timeout value associated with a connection could allow an unauthorized user access to another user's ssh session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value at least reduces the risk of this happening..\n\nWhile the recommended setting is 300 seconds (5 minutes), set this timeout value based on site policy. The recommended setting for ClientAliveCountMax is 0. In this case, the client session will be terminated after 5 minutes of idle time and no keepalive messages will be sent.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameters according to site policy:\n\nClientAliveInterval 300\n\nClientAliveCountMax 0\n\nDefault Value:\n\nClientAliveInterval 420\n\nClientAliveCountMax 3",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i clientaliveinterval",
        "expect": "^[\\\\s]*(?i)ClientAliveInterval(?-i)[\\\\s]+([1-9]|[1-9][0-9]|[12][0-9]{2}|300)[\\\\s]*$"
    },
    "custom_item_59": {
        "system": "Linux",
        "description": "5.1.16 Ensure SSH Idle Timeout Interval is configured - ClientAliveCountMax",
        "info": "The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions. When the ClientAliveInterval variable is set, ssh sessions that have no activity for the specified length of time are terminated. When the ClientAliveCountMax variable is set, sshd will send client alive messages at every ClientAliveInterval interval. When the number of consecutive client alive messages are sent with no response from the client, the ssh session is terminated. For example, if the ClientAliveInterval is set to 15 seconds and the ClientAliveCountMax is set to 3, the client ssh session will be terminated after 45 seconds of idle time.\n\nRationale:\n\nHaving no timeout value associated with a connection could allow an unauthorized user access to another user's ssh session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value at least reduces the risk of this happening..\n\nWhile the recommended setting is 300 seconds (5 minutes), set this timeout value based on site policy. The recommended setting for ClientAliveCountMax is 0. In this case, the client session will be terminated after 5 minutes of idle time and no keepalive messages will be sent.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameters according to site policy:\n\nClientAliveInterval 300\n\nClientAliveCountMax 0\n\nDefault Value:\n\nClientAliveInterval 420\n\nClientAliveCountMax 3",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i clientalivecountmax",
        "expect": "^[\\\\s]*(?i)ClientAliveCountMax(?-i)[\\\\s]+[1-3][\\\\s]*$"
    },
    "custom_item_60": {
        "system": "Linux",
        "description": "5.1.17 Ensure SSH LoginGraceTime is set to one minute or less",
        "info": "The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access.\n\nRationale:\n\nSetting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nLoginGraceTime 60\n\nDefault Value:\n\nLoginGraceTime 120",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep logingracetime",
        "expect": "^[\\\\s]*(?i)LoginGraceTime(?-i)[\\\\s]+([1-9]|[1-5][0-9]|60)[\\\\s]*$"
    },
    "custom_item_61": {
        "system": "Linux",
        "description": "5.1.18 Ensure SSH access is limited",
        "info": "There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:\n\nAllowUsers\n\nThe AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.\n\nAllowGroups\n\nThe AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.\n\nDenyUsers\n\nThe DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.\n\nDenyGroups\n\nThe DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.\n\nRationale:\n\nRestricting which users can remotely access the system via SSH will help ensure that only authorized users access the system.",
        "solution": "Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows:\n\nAllowUsersAllowGroupsDenyUsersDenyGroups",
        "reference": "800-171|3.1.5,800-171|3.1.6,800-53|AC-6(2),800-53|AC-6(5),800-53r5|AC-6(2),800-53r5|AC-6(5),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv7|4.3,CSCv8|5.4,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(2),ITSG-33|AC-6(5),LEVEL|2A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|AM32,NIAv2|AM33,NIAv2|SS13c,NIAv2|SS15c,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -Pi '^\\\\h*(allow|deny)(users|groups)\\\\h+\\\\H+(\\\\h+.*)?$'",
        "expect": "^[\\\\s]*(?i)(Allow|Deny)(Users|Groups)(?-i)[\\\\s]"
    },
    "custom_item_62": {
        "system": "Linux",
        "description": "5.1.19 Ensure SSH warning banner is configured",
        "info": "The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.\n\nRationale:\n\nBanners are used to warn connecting users of the particular site's policy regarding connection. Presenting a warning message prior to the normal user login may assist the prosecution of trespassers on the computer system.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nBanner /etc/issue.net",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i banner",
        "expect": "^[\\\\s]*(?i)Banner(?-i)[\\\\s]+/etc/issue\\\\.net[\\\\s]*$"
    },
    "custom_item_63": {
        "system": "Linux",
        "description": "5.1.21 Ensure SSH AllowTcpForwarding is disabled",
        "info": "SSH port forwarding is a mechanism in SSH for tunneling application ports from the client to the server, or servers to clients. It can be used for adding encryption to legacy applications, going through firewalls, and some system administrators and IT professionals use it for opening backdoors into the internal network from their home machines\n\nRationale:\n\nLeaving port forwarding enabled can expose the organization to security risks and back-doors.\n\nSSH connections are protected with strong encryption. This makes their contents invisible to most deployed network monitoring and traffic filtering solutions. This invisibility carries considerable risk potential if it is used for malicious purposes such as data exfiltration. Cybercriminals or malware could exploit SSH to hide their unauthorized communications, or to exfiltrate stolen data from the target network\n\nImpact:\n\nSSH tunnels are widely used in many corporate environments that employ mainframe systems as their application backends. In those environments the applications themselves may have very limited native support for security. By utilizing tunneling, compliance with SOX, HIPAA, PCI-DSS, and other standards can be achieved without having to modify the applications.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nAllowTcpForwarding no\n\nDefault Value:\n\nAllowTcpForwarding yes",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|2A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i allowtcpforwarding",
        "expect": "^[\\\\s]*(?i)AllowTcpForwarding(?-i)[\\\\s]+no[\\\\s]*$"
    },
    "custom_item_64": {
        "system": "Linux",
        "description": "5.1.22 Ensure SSH MaxStartups is configured",
        "info": "The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.\n\nRationale:\n\nTo protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nmaxstartups 10:30:60",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i maxstartups",
        "expect": "^[\\\\s]*(?i)MaxStartups(?-i)[\\\\s]+(((1[1-9]|[1-9][0-9][0-9]+):([0-9]+):([0- 9]+))|(([0-9]+):(3[1-9]|[4-9][0-9]|[1-9][0-9][0-9]+):([0-9]+))|(([0-9]+):([0- 9]+):(6[1-9]|[7-9][0-9]|[1-9][0-9][0-9]+)))[\\\\s]*$"
    },
    "custom_item_65": {
        "system": "Linux",
        "description": "5.1.23 Ensure SSH MaxSessions is set to 4 or less",
        "info": "The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection.\n\nRationale:\n\nTo protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.",
        "solution": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\nMaxSessions 4",
        "reference": "800-171|3.4.2,800-53|CM-6,800-53r5|CM-6,CSCv7|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,LEVEL|2A,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(/bin/grep $(hostname) /etc/hosts | /usr/bin/awk '{print $1}')\" | /bin/grep -i maxsessions",
        "expect": "^[\\\\s]*(?i)MaxSessions(?-i)[\\\\s]+[1-4][\\\\s]*$"
    },
    "custom_item_66": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - min",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*min[\\\\s]*=",
        "expect": "^[\\\\s]*min[\\\\s]*=[\\\\s]*disabled,disabled,disabled,disabled,14[\\\\s]*$"
    },
    "custom_item_67": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - max",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*max[\\\\s]*=",
        "expect": "^[\\\\s]*max[\\\\s]*=[\\\\s]*40[\\\\s]*$"
    },
    "custom_item_68": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - passphrase",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*passphrase[\\\\s]*=",
        "expect": "^[\\\\s]*passphrase[\\\\s]*=[\\\\s]*[3-9][\\\\s]*$"
    },
    "custom_item_69": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - match",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*match[\\\\s]*=",
        "expect": "^[\\\\s]*match[\\\\s]*=[\\\\s]*4[\\\\s]*$"
    },
    "custom_item_70": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - similar",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*similar[\\\\s]*=",
        "expect": "^[\\\\s]*similar[\\\\s]*=[\\\\s]*deny[\\\\s]*$"
    },
    "custom_item_71": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - random",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*random[\\\\s]*=",
        "expect": "^[\\\\s]*random[\\\\s]*=[\\\\s]*47[\\\\s]*$"
    },
    "custom_item_72": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - enforce",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*enforce[\\\\s]*=",
        "expect": "^[\\\\s]*enforce[\\\\s]*=[\\\\s]*everyone[\\\\s]*$"
    },
    "custom_item_73": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - retry",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/security/passwdqc.conf",
        "regex": "^[\\\\s]*retry[\\\\s]*=",
        "expect": "^[\\\\s]*retry[\\\\s]*=[\\\\s]*3[\\\\s]*$"
    },
    "custom_item_74": {
        "system": "Linux",
        "description": "5.2.1 Ensure password creation requirements are configured - system-auth",
        "info": "The pam_passwdqc.so module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more based on the following options set in the /etc/security/passwdqc.conf:\n\nmin=disabled,disabled,disabled,disabled,14 - The password must be 14 characters or more and consists of four character classes.\n\nmax=40 - The maximum allowed password length is 40.\n\npassphrase=3 - The number of words required for a passphrase is at least 3.\n\nmatch=4 - The length of common substring required to conclude that a password is at least partially based on information found in a character string is 4.\n\nsimilar=deny - The password that is similar to the old one is going to be denied.\n\nrandom=47 - The size of randomly-generated passphrases in bits is 47.\n\nenforce=everyone - Warn everyone for weak passwords.\n\nretry=3 - Let the user provide a password 3 times if the user fails to provide a sufficiently strong password and enter it twice the first time.\n\nFor more details, refer to pam_passwdqc module documentation. The settings shown above are one possible policy. Alter these values to conform to your own organization's password policies.\n\nRationale:\n\nStrong passwords protect systems from being hacked through brute force methods.",
        "solution": "Edit the file /etc/security/passwdqc.conf and add or modify the following lines for password length and complexity to conform to site policy:\n\nmin=disabled,disabled,disabled,disabled,14\nmax=40\npassphrase=3\nmatch=4\nsimilar=deny\nrandom=47\nenforce=everyone\nretry=3\n\nEdit the /etc/pam.d/system-auth files to include the appropriate options for pam_passwdqc.so and to conform to site policy:\n\npasswordrequiredpam_passwdqc.so config=/etc/security/passwdqc.conf\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation requirements only cover including try_first_pass and minlen set to 14 or more.\n\nSettings in /etc/security/pwquality.conf must use spaces around the = symbol.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/pam.d/system-auth",
        "regex": "pam_passwdqc.so",
        "expect": "^[\\\\s]*password[\\\\s]+required[\\\\s]+pam_passwdqc.so[\\\\s]+config=/etc/security/passwdqc.conf[\\\\s]*$"
    },
    "custom_item_75": {
        "system": "Linux",
        "description": "5.2.2 Ensure password reuse is limited - pam_pwhistory",
        "info": "The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.\n\nRationale:\n\nForcing users not to reuse their past 5 passwords make it less likely that an attacker will be able to guess the password.\n\nNote that these change only apply to accounts configured on the local system.",
        "solution": "Set remembered password history to conform to site policy. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate /etc/pam.d/ configuration file and add or modify the pam_pwhistory.so or pam_unix.so lines to include the remember option:\n\npassword required pam_pwhistory.so remember=5\npassword required pam_unix.so remember=5\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation only covers those listed here.",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),LEVEL|2M,NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/pam.d/common-password",
        "regex": "^\\\\s*password\\\\s+required\\\\s+pam_pwhistory.so.*$",
        "expect": "^\\\\s*password\\\\s+required\\\\s+pam_pwhistory.so\\\\s+(.*|\\\\s*)*remember=([5-9]|[1-9][0-9]+).*$"
    },
    "custom_item_76": {
        "system": "Linux",
        "description": "5.2.2 Ensure password reuse is limited - pam_unix.so",
        "info": "The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.\n\nRationale:\n\nForcing users not to reuse their past 5 passwords make it less likely that an attacker will be able to guess the password.\n\nNote that these change only apply to accounts configured on the local system.",
        "solution": "Set remembered password history to conform to site policy. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate /etc/pam.d/ configuration file and add or modify the pam_pwhistory.so or pam_unix.so lines to include the remember option:\n\npassword required pam_pwhistory.so remember=5\npassword required pam_unix.so remember=5\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation only covers those listed here.",
        "reference": "800-171|3.5.8,800-53|IA-5(1)(e),800-53r5|IA-5(1)(e),CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(e),LEVEL|2M,NESA|T5.2.3,NIAv2|AM22c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/pam.d/common-password",
        "regex": "^\\\\s*password\\\\s+required\\\\s+pam_unix.so.*$",
        "expect": "^\\\\s*password\\\\s+required\\\\s+pam_unix.so\\\\s+(.*|\\\\s*)*remember=([5-9]|[1-9][0-9]+).*$"
    },
    "custom_item_77": {
        "system": "Linux",
        "description": "5.2.3 Ensure password hashing algorithm is SHA-512",
        "info": "The commands below change password encryption from md5 to sha512 (a much stronger hashing algorithm). All existing accounts will need to perform a password change to upgrade the stored hashes to the new algorithm.\n\nRationale:\n\nThe SHA-512 algorithm provides much stronger hashing than MD5, thus providing additional protection to the system by increasing the level of effort for an attacker to successfully determine passwords.\n\nNote that these changes only apply to accounts configured on the local system.",
        "solution": "Set password hashing algorithm to sha512. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate /etc/pam.d/ configuration file and add or modify the pam_unix.so lines to include the sha512 option:\n\npassword required pam_unix.so sha512\n\nAdditional Information:\n\nConsult your documentation for the appropriate PAM file and module.\n\nAdditional module options may be set, recommendation only covers those listed here.\n\nIf it is determined that the password algorithm being used is not SHA-512, once it is changed, it is recommended that all user ID's be immediately expired and forced to change their passwords on next login. To accomplish that, the following commands can be used. Any system accounts that need to be expired should be carefully done separately by the system administrator to prevent any potential problems.\n\n# cat /etc/passwd | awk -F: '( $3 >= 500 && $1 != 'nfsnobody' ) { print $1 }' | xargs -n 1 chage -d 0\n\nThis command assumes a system UID split at 500. Some distributions split at UID 1000 instead, consult your documentation and/or the UID_MIN setting in /etc/login.defs to determine which is appropriate for you.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|2M,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/pam.d/common-password",
        "regex": "^password.*pam_unix\\.so",
        "expect": "sha512",
        "min_occurrences": "1"
    },
    "custom_item_78": {
        "system": "Linux",
        "description": "5.3.1.1 Ensure password expiration is 365 days or less - login.defs",
        "info": "The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.\n\nRationale:\n\nThe window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attacker's window of opportunity.",
        "solution": "Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs :\n\nPASS_MAX_DAYS 365\n\nModify user parameters for all users with a password set to match:\n\n# chage --maxdays 365Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 5th field should be 365 or less for all users with a password.\n\nNote: A value of -1 will disable password expiration. Additionally the password expiration must be greater than the minimum days between password changes or users will be unable to change their password.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s]*PASS_MAX_DAYS[\\\\s]",
        "expect": "^[\\\\s]*PASS_MAX_DAYS[\\\\s]+@PASSWORD_MAX_DAYS@[\\\\s]*$"
    },
    "custom_item_79": {
        "system": "Linux",
        "description": "5.3.1.1 Ensure password expiration is 365 days or less - users",
        "info": "The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days.\n\nRationale:\n\nThe window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attacker's window of opportunity.",
        "solution": "Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs :\n\nPASS_MAX_DAYS 365\n\nModify user parameters for all users with a password set to match:\n\n# chage --maxdays 365Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 5th field should be 365 or less for all users with a password.\n\nNote: A value of -1 will disable password expiration. Additionally the password expiration must be greater than the minimum days between password changes or users will be unable to change their password.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){4}@PASSWORD_MAX_DAYS@:"
    },
    "custom_item_80": {
        "system": "Linux",
        "description": "5.3.1.2 Ensure minimum days between password changes is 7 or more - login.defs",
        "info": "The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 7 or more days.\n\nRationale:\n\nBy restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls.",
        "solution": "Set the PASS_MIN_DAYS parameter to 7 in /etc/login.defs :\n\nPASS_MIN_DAYS 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --mindays 7Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 4th field should be 7 or more for all users with a password.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/login.defs",
        "regex": "^[\\\\s\\\\t]*PASS_MIN_DAYS[\\\\s]+",
        "expect": "PASS_MIN_DAYS[\\\\s]+@PASSWORD_MIN_DAYS@[\\\\s]*$"
    },
    "custom_item_81": {
        "system": "Linux",
        "description": "5.3.1.2 Ensure minimum days between password changes is 7 or more - users",
        "info": "The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 7 or more days.\n\nRationale:\n\nBy restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls.",
        "solution": "Set the PASS_MIN_DAYS parameter to 7 in /etc/login.defs :\n\nPASS_MIN_DAYS 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --mindays 7Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 4th field should be 7 or more for all users with a password.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "echo 'Username, Minimum number of days between password change'; output=\"\"; failures=0; for i in $(egrep \"^[^:]+:[^\\!*]\" /etc/shadow | cut -d: -f1); do change_date=$(chage --list \"$i\" | grep 'Minimum number of days between password change' | cut -d: -f2 | awk '{$1=$1};1'); output=\"${i}, ${change_date}\"; if [ $change_date -ge 7 ]; then output=\"${output} - Pass\"; else output=\"${output} - Fail\"; failures=$((failures+1)); fi; echo \"${output}\"; done; echo \"Number of failures: ${failures}\"",
        "expect": "^Number of failures: 0$"
    },
    "custom_item_82": {
        "system": "Linux",
        "description": "5.3.1.4 Ensure inactive password lock is 30 days or less - useradd",
        "info": "User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 30 days after password expiration be disabled.\n\nRationale:\n\nInactive accounts pose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.",
        "solution": "Run the following command to set the default password inactivity period to 30 days:\n\n# useradd -D -f 30\n\nModify user parameters for all users with a password set to match:\n\n# chage --inactive 30Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 7th field should be 30 or less for all users with a password.\n\nNote: A value of -1 would disable this setting.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/sbin/useradd -D | /bin/grep INACTIVE",
        "expect": "^INACTIVE=(30|[1-2][0-9]|[0-9])$"
    },
    "custom_item_83": {
        "system": "Linux",
        "description": "5.3.1.4 Ensure inactive password lock is 30 days or less - users",
        "info": "User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 30 days after password expiration be disabled.\n\nRationale:\n\nInactive accounts pose a threat to system security since the users are not logging in to notice failed login attempts or other anomalies.",
        "solution": "Run the following command to set the default password inactivity period to 30 days:\n\n# useradd -D -f 30\n\nModify user parameters for all users with a password set to match:\n\n# chage --inactive 30Additional Information:\n\nYou can also check this setting in /etc/shadow directly. The 7th field should be 30 or less for all users with a password.\n\nNote: A value of -1 would disable this setting.",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|2A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/shadow",
        "regex": "^[^:]+:[^!*]",
        "expect": "^([^:]*:){6}@INACTIVE_PASSWORD_LOCK@:"
    },
    "custom_item_84": {
        "system": "Linux",
        "description": "5.3.2 Ensure system accounts are secured - non login",
        "info": "There are a number of accounts provided with most distributions that are used to manage applications and are not intended to provide an interactive shell.\n\nRationale:\n\nIt is important to make sure that accounts that are not being used by regular users are prevented from being used to provide an interactive shell. By default, most distributions set the password field for these accounts to an invalid string, but it is also recommended that the shell field in the password file be set to the nologin shell. This prevents the account from potentially being used to run any commands.",
        "solution": "Run the commands appropriate for your distribution:\nSet the shell for any accounts returned by the audit to nologin:\n\n# usermod -s $(which nologin)Lock any non root accounts returned by the audit:\n\n# usermod -LThe following command will set all system accounts to a non login shell:\n\nawk -F: '($1!='root' && $1!='sync' && $1!='shutdown' && $1!='halt' && $1!~/^\\+/ && $3<''$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)'' && $7!='''$(which nologin)''' && $7!='/bin/false') {print $1}' /etc/passwd | while read user do usermod -s $(which nologin) $user done\n\nThe following command will automatically lock not root system accounts:\n\nawk -F: '($1!='root' && $1!~/^\\+/ && $3<''$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)'') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!='L' && $2!='LK') {print $1}' | while read user do usermod -L $user done\n\nAdditional Information:\n\nThe root, sync, shutdown, and halt users are exempted from requiring a non-login shell.",
        "reference": "800-171|3.1.1,800-171|3.5.2,800-171|3.5.5,800-171|3.5.6,800-53|AC-1,800-53|AC-2,800-53|IA-4,800-53|IA-5,800-53r5|AC-1,800-53r5|AC-2,800-53r5|IA-4,800-53r5|IA-5,CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv8|6.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|IA-4,ITSG-33|IA-5,LEVEL|2A,NESA|M1.2.2,NESA|T5.2.3,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $1!~\\/^\\\\+\\/ && $3<'\"$(/usr/bin/awk '\\/^[\\\\s]*UID_MIN\\/{print $2}' /etc/login\\.defs)\"' && $7!=\"'\"$(which nologin)\"'\" && $7!=\"\\/bin\\/false\" && $7 != \"/sbin/nologin\" && $7 != \"/usr/sbin/nologin\") {print}' /etc/passwd | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_85": {
        "system": "Linux",
        "description": "5.3.2 Ensure system accounts are secured - lock not root",
        "info": "There are a number of accounts provided with most distributions that are used to manage applications and are not intended to provide an interactive shell.\n\nRationale:\n\nIt is important to make sure that accounts that are not being used by regular users are prevented from being used to provide an interactive shell. By default, most distributions set the password field for these accounts to an invalid string, but it is also recommended that the shell field in the password file be set to the nologin shell. This prevents the account from potentially being used to run any commands.",
        "solution": "Run the commands appropriate for your distribution:\nSet the shell for any accounts returned by the audit to nologin:\n\n# usermod -s $(which nologin)Lock any non root accounts returned by the audit:\n\n# usermod -LThe following command will set all system accounts to a non login shell:\n\nawk -F: '($1!='root' && $1!='sync' && $1!='shutdown' && $1!='halt' && $1!~/^\\+/ && $3<''$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)'' && $7!='''$(which nologin)''' && $7!='/bin/false') {print $1}' /etc/passwd | while read user do usermod -s $(which nologin) $user done\n\nThe following command will automatically lock not root system accounts:\n\nawk -F: '($1!='root' && $1!~/^\\+/ && $3<''$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)'') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!='L' && $2!='LK') {print $1}' | while read user do usermod -L $user done\n\nAdditional Information:\n\nThe root, sync, shutdown, and halt users are exempted from requiring a non-login shell.",
        "reference": "800-171|3.1.1,800-171|3.5.2,800-171|3.5.5,800-171|3.5.6,800-53|AC-1,800-53|AC-2,800-53|IA-4,800-53|IA-5,800-53r5|AC-1,800-53r5|AC-2,800-53r5|IA-4,800-53r5|IA-5,CN-L3|7.1.2.7(b),CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv8|6.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|IA-4,ITSG-33|IA-5,LEVEL|2A,NESA|M1.2.2,NESA|T5.2.3,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!=\"root\" && $1!~\\/^\\\\+\\/ && $3<'\"$(/usr/bin/awk '\\/^[\\\\s]*UID_MIN\\/{print $2}' /etc/login\\.defs)\"') {print $1}' /etc/passwd | /usr/bin/xargs -I '{}' /usr/bin/passwd -S '{}' | /usr/bin/awk '($2!=\"L\" && $2!=\"LK\") {print $1}' | /usr/bin/awk '{print} END {if (NR == 0) print \"pass\" ; else print \"fail\"}'",
        "expect": "^pass$"
    },
    "custom_item_86": {
        "system": "Linux",
        "description": "5.3.4 Ensure default user umask is 027 or more restrictive - /etc/bash/bashrc",
        "info": "The default umask determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files ( .profile , .bashrc , etc.) in their home directories.\n\nRationale:\n\nSetting a very secure default value for umask ensures that users make a conscious choice about their file permissions. A default umask setting of 077 causes files and directories created by users to not be readable by any other user on the system. A umask of 027 would make files and directories readable by users in the same Unix group, while a umask of 022 would make files readable by every user on the system.",
        "solution": "Edit the /etc/bash/bashrc, /etc/profile and /etc/profile.d/*.sh files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\numask 027\n\nAdditional Information:\n\nThe audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked.\n\nOther methods of setting a default user umask exist however the shell configuration files are the last run and will override other settings if they exist therefor our recommendation is to configure in the shell configuration files. If other methods are in use in your environment they should be audited and the shell configs should be verified to not override.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/bash/bashrc",
        "regex": "^[\\\\s]*umask[\\\\s]",
        "expect": "^[\\\\s]*umask[\\\\s]+[0-7][2-7]7[\\\\s]*$"
    },
    "custom_item_87": {
        "system": "Linux",
        "description": "5.3.4 Ensure default user umask is 027 or more restrictive - /etc/profile /etc/profile.d",
        "info": "The default umask determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files ( .profile , .bashrc , etc.) in their home directories.\n\nRationale:\n\nSetting a very secure default value for umask ensures that users make a conscious choice about their file permissions. A default umask setting of 077 causes files and directories created by users to not be readable by any other user on the system. A umask of 027 would make files and directories readable by users in the same Unix group, while a umask of 022 would make files readable by every user on the system.",
        "solution": "Edit the /etc/bash/bashrc, /etc/profile and /etc/profile.d/*.sh files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\numask 027\n\nAdditional Information:\n\nThe audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked.\n\nOther methods of setting a default user umask exist however the shell configuration files are the last run and will override other settings if they exist therefor our recommendation is to configure in the shell configuration files. If other methods are in use in your environment they should be audited and the shell configs should be verified to not override.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|5.1,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/grep -E '^[[:space:]]*umask[[:space:]]' /etc/profile /etc/profile.d/*.sh",
        "expect": ":[\\\\s]*umask[\\\\s]+\\\\b([0-7][2-7]7)\\\\b[\\\\s]*$"
    },
    "custom_item_88": {
        "system": "Linux",
        "description": "5.3.5 Ensure default user shell timeout is 900 seconds or less - /etc/bash/bashrc",
        "info": "The default TMOUT determines the shell timeout for users. The TMOUT value is measured in seconds.\n\nRationale:\n\nHaving no timeout value associated with a shell could allow an unauthorized user access to another user's shell session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value at least reduces the risk of this happening.",
        "solution": "Edit the /etc/bash/bashrc and /etc/profile files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\nTMOUT=900\n\nAdditional Information:\n\nThe audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked. Other methods of setting a timeout exist for other shells not covered here.\n\nEnsure that the timeout conforms to your local policy.",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/bash.bashrc",
        "regex": "^[\\\\s]*TMOUT[\\\\s]*",
        "expect": "^[\\\\s]*TMOUT[\\\\s]*=[\\\\s]*([1-9][0-9]|[1-8][0-9][0-9]|900)[\\\\s]*$"
    },
    "custom_item_89": {
        "system": "Linux",
        "description": "5.3.5 Ensure default user shell timeout is 900 seconds or less - /etc/profile /etc/profile.d",
        "info": "The default TMOUT determines the shell timeout for users. The TMOUT value is measured in seconds.\n\nRationale:\n\nHaving no timeout value associated with a shell could allow an unauthorized user access to another user's shell session (e.g. user walks away from their computer and doesn't lock the screen). Setting a timeout value at least reduces the risk of this happening.",
        "solution": "Edit the /etc/bash/bashrc and /etc/profile files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\nTMOUT=900\n\nAdditional Information:\n\nThe audit and remediation in this recommendation apply to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked. Other methods of setting a timeout exist for other shells not covered here.\n\nEnsure that the timeout conforms to your local policy.",
        "reference": "800-171|3.1.1,800-171|3.1.10,800-171|3.1.11,800-53|AC-2(5),800-53|AC-11,800-53|AC-11(1),800-53|AC-12,800-53r5|AC-2(5),800-53r5|AC-11,800-53r5|AC-11(1),800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv7|16.11,CSCv8|4.3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-2(5),ITSG-33|AC-11,ITSG-33|AC-11(1),ITSG-33|AC-12,LEVEL|2A,NIAv2|AM23c,NIAv2|AM23d,NIAv2|AM28,NIAv2|NS5j,NIAv2|NS49,NIAv2|SS14e,PCI-DSSv3.2.1|8.1.8,PCI-DSSv4.0|8.2.8,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.1,TBA-FIISB|37.1.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/bin/grep -P '^[\\\\s]*TMOUT[\\\\s]*=' /etc/profile /etc/profile.d/*.sh",
        "expect": ":[\\\\s]*TMOUT[\\\\s]*=([1-9][0-9]|[1-8][0-9][0-9]|900)$"
    },
    "custom_item_90": {
        "system": "Linux",
        "description": "6.1.5 Ensure permissions on /etc/passwd- are configured",
        "info": "The /etc/passwd- file contains backup user account information.\n\nRationale:\n\nIt is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the following command to set permissions on /etc/passwd- :\n\n# chown root:root /etc/passwd-\n\n# chmod u-x,go-wx /etc/passwd-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.4,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/passwd-",
        "owner": "root",
        "mask": "133",
        "group": "root"
    },
    "custom_item_91": {
        "system": "Linux",
        "description": "6.1.6 Ensure permissions on /etc/shadow- are configured",
        "info": "The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.\n\nRationale:\n\nIt is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the one of the following chown commands as appropriate and the chmod to set permissions on /etc/shadow- :\n\n# chown root:root /etc/shadow-\n# chown root:shadow /etc/shadow-\n\n# chmod o-rwx,g-rw /etc/shadow-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.4,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/shadow-",
        "owner": "root",
        "mask": "137",
        "group": "root"
    },
    "custom_item_92": {
        "system": "Linux",
        "description": "6.1.8 Ensure permissions on /etc/gshadow- are configured",
        "info": "The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information.\n\nRationale:\n\nIt is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions.",
        "solution": "Run the one of the following chown commands as appropriate and the chmod to set permissions on /etc/gshadow- :\n\n# chown root:root /etc/gshadow-\n# chown root:shadow /etc/gshadow-\n\n# chmod o-rwx,g-rw /etc/gshadow-",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.4,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "file": "/etc/gshadow-",
        "owner": "root",
        "mask": "137",
        "group": "root"
    },
    "custom_item_93": {
        "system": "Linux",
        "description": "6.2.10 Ensure users' dot files are not group or world writable",
        "info": "While the system administrator can establish secure permissions for users' 'dot' files, the users can easily override these.\n\nRationale:\n\nGroup or world-writable user configuration files may enable malicious users to steal or modify other users' data or to gain another user's system privileges.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin(\\\\/)?$/ && $7!~/(\\\\/usr)?\\\\/bin\\\\/false(\\\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then for file in \"$dir\"/.*; do if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then fileperm=$(stat -L -c \"%A\" \"$file\"); if [ \"$(echo \"$fileperm\" | cut -c6)\" != \"-\" ] || [ \"$(echo \"$fileperm\" | cut -c9)\" != \"-\" ]; then echo \"User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" has permissions: \\\\\"$fileperm\\\\\"\"; fi; fi; done; fi; done | /usr/bin/awk '{ print } END { if (NR==0) print \"All dot files have proper permissions\" }'",
        "expect": "All dot files have proper permissions"
    },
    "custom_item_94": {
        "system": "Linux",
        "description": "6.2.11 Ensure no users have .forward files",
        "info": "The .forward file specifies an email address to forward the user's mail to.\n\nRationale:\n\nUse of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a risk as it can be used to execute commands that may perform unintended actions.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .forward files and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|2A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!~/(root|halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin(\\\\/)?$/ && $7!~/(\\\\/usr)?\\\\/bin\\\\/false(\\\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.forward\"; if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then echo \"User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" exists\"; fi; fi; done | /usr/bin/awk '{print} END {if (NR == 0) print \"No .forward files found\"; else print \"fail\"}'",
        "expect": "No .forward files found"
    },
    "custom_item_95": {
        "system": "Linux",
        "description": "6.2.12 Ensure no users have .netrc files",
        "info": "The .netrc file contains data for logging into a remote host for file transfers via FTP.\n\nRationale:\n\nThe .netrc file presents a significant security risk since it stores passwords in unencrypted form. Even if FTP is disabled, user accounts may have brought over .netrc files from other systems which could pose a risk to those systems.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc files and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|2A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!~/(root|halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin(\\\\/)?$/ && $7!~/(\\\\/usr)?\\\\/bin\\\\/false(\\\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.netrc\"; if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then echo \"User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" exists\"; fi; fi; done | /usr/bin/awk '{ print } END { if (NR==0) print \"No .netrc files found\" }'",
        "expect": "No .netrc files found"
    },
    "custom_item_96": {
        "system": "Linux",
        "description": "6.2.13 Ensure users' .netrc Files are not group or world accessible",
        "info": "While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.\n\nRationale:\n\n.netrc files may contain unencrypted passwords that may be used to attack other systems.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc file permissions and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nWhile the complete removal of .netrc files is recommended if any are required on the system secure permissions must be applied.\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|2A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!~/(halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin(\\\\/)?$/ && $7!~/(\\\\/usr)?\\\\/bin\\\\/false(\\\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.netrc\"; if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then if stat -L -c \"%A\" \"$file\" | cut -c4-10 | /bin/grep -Eq '[^-]+'; then echo \"FAILED: User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" exists with permissions: \\\\\"$(stat -L -c \"%a\" \"$file\")\\\\\", remove file or excessive permissions\"; else echo \"WARNING: User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" exists with permissions: \\\\\"$(stat -L -c \"%a\" \"$file\")\\\\\", remove file unless required\"; fi; fi; fi; done | /usr/bin/awk '{ print } END { if (NR==0) print \"All .netrc files are not group or world accessible\" }'",
        "expect": "All .netrc files are not group or world accessible"
    },
    "custom_item_97": {
        "system": "Linux",
        "description": "6.2.14 Ensure no users have .rhosts files",
        "info": "While no .rhosts files are shipped by default, users can easily create them.\n\nRationale:\n\nThis action is only meaningful if .rhosts support is permitted in the file /etc/pam.conf . Even though the .rhosts files are ineffective if support is disabled in /etc/pam.conf , they may have been brought over from other systems and could contain information useful to an attacker for those other systems.",
        "solution": "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .rhosts files and determine the action to be taken in accordance with site policy.\n\nAdditional Information:\n\nOn some distributions the /sbin/nologin should be replaced with /usr/sbin/nologin.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|16.4,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|2A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/8717",
        "cmd": "/usr/bin/awk -F: '($1!~/(root|halt|sync|shutdown|nfsnobody)/ && $7!~/^(\\\\/usr)?\\\\/sbin\\\\/nologin(\\\\/)?$/ && $7!~/(\\\\/usr)?\\\\/bin\\\\/false(\\\\/)?$/) { print $1 \" \" $6 }' /etc/passwd | while read -r user dir; do if [ -d \"$dir\" ]; then file=\"$dir/.rhosts\"; if [ ! -h \"$file\" ] && [ -f \"$file\" ]; then echo \"User: \\\\\"$user\\\\\" file: \\\\\"$file\\\\\" exists\"; fi; fi; done | /usr/bin/awk '{ print } END { if (NR==0) print \"No .rhosts files found\" }'",
        "expect": "No .rhosts files found"
    }
}