{
    "custom_item_1": {
        "description": "1.4 Ensure Guest Users Are Reviewed on a Regular Basis",
        "info": "Microsoft Entra ID is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data.\n\nWork with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources as a guest user.\n\nGuest users in every subscription should be review on a regular basis to ensure that inactive and unneeded accounts are removed.\n\nRationale:\n\nGuest users in the Microsoft Entra ID are generally required for collaboration purposes in Office 365, and may also be required for Azure functions in enterprises with multiple Azure tenants. Guest users are typically added outside your employee on-boarding/off-boarding process and could potentially be overlooked indefinitely, leading to a potential vulnerability. To prevent this, guest users should be reviewed on a regular basis. During this audit, guest users should also be determined to not have administrative privileges.\n\nImpact:\n\nBefore removing guest users, determine their use and scope. Like removing any user, there may be unforeseen consequences to systems if it is deleted.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Entra ID\n\nSelect Users\n\nClick on Add filter\n\nSelect User type\n\nSelect Guest from the Value dropdown\n\nClick Apply\n\nDelete all Guest users that are no longer required or are inactive\n\nFrom Azure CLI\nBefore deleting the user, set it to inactive using the ID from the Audit Procedure to determine if there are any dependent systems.\n\naz ad user update --id--account-enabled {false}\n\nAfter determining that there are no dependent systems delete the user.\n\nRemove-AzureADUser -ObjectIdFrom Azure PowerShell\nBefore deleting the user, set it to inactive using the ID from the Audit Procedure to determine if there are any dependent systems.\n\nSet-AzureADUser -ObjectId '' -AccountEnabled false\n\nAfter determining that there are no dependent systems delete the user.\n\nPS C:\\>Remove-AzureADUser -ObjectIdDefault Value:\n\nBy default no guest users are created.",
        "reference": "800-171|3.1.1,800-171|3.1.5,800-171|3.3.8,800-171|3.3.9,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AC-2(3),800-53|AC-3,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(7),800-53|AU-9(4),800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AC-2(3),800-53r5|AC-3,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(7),800-53r5|AU-9(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(e),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(c),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.1.10.6(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|16.6,CSCv7|16.8,CSCv8|5.1,CSCv8|5.3,CSCv8|6.2,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.2.6,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AC-2(3),ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1M,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM26,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,TBA-FIISB|36.2.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listGuestUsers"
    },
    "custom_item_2": {
        "description": "1.22 Ensure That No Custom Subscription Administrator Roles Exist",
        "info": "The principle of least privilege should be followed and only necessary privileges should be assigned instead of allowing full administrative access.\n\nRationale:\n\nClassic subscription admin roles offer basic access management and include Account Administrator, Service Administrator, and Co-Administrators. It is recommended the least necessary permissions be given initially. Permissions can be added as needed by the account holder. This ensures the account holder cannot perform actions which were not intended.\n\nImpact:\n\nSubscriptions will need to be handled by Administrators with permissions.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu.\n\nSelect Subscriptions.\n\nSelect Access control (IAM).\n\nSelect Roles.\n\nClick Type and select CustomRole from the drop down menu.\n\nCheck the box next to each role which grants subscription administrator privileges.\n\nSelect Remove.\n\nSelect Yes.\n\nFrom Azure CLI\nList custom roles:\n\naz role definition list --custom-role-only True\n\nCheck for entries with assignableScope of the subscription, and an action of *.\nTo remove a violating role:\n\naz role definition delete --nameNote that any role assignments must be removed before a custom role can be deleted.\nEnsure impact is assessed before deleting a custom role granting subscription administrator privileges.\n\nDefault Value:\n\nBy default, no custom owner roles are created.",
        "reference": "800-171|3.1.1,800-171|3.1.5,800-171|3.1.6,800-171|3.3.8,800-171|3.3.9,800-53|AC-2,800-53|AC-3,800-53|AC-6,800-53|AC-6(1),800-53|AC-6(2),800-53|AC-6(5),800-53|AC-6(7),800-53|AU-9(4),800-53r5|AC-2,800-53r5|AC-3,800-53r5|AC-6,800-53r5|AC-6(1),800-53r5|AC-6(2),800-53r5|AC-6(5),800-53r5|AC-6(7),800-53r5|AU-9(4),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(d),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|4.1,CSCv8|5.4,CSCv8|6.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.3,ISO/IEC-27001|A.9.2.5,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.4,ISO/IEC-27001|A.9.4.5,ISO/IEC-27001|A.12.4.2,ITSG-33|AC-2,ITSG-33|AC-3,ITSG-33|AC-6,ITSG-33|AC-6(1),ITSG-33|AC-6(2),ITSG-33|AC-6(5),ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|AM28,NIAv2|AM31,NIAv2|AM32,NIAv2|AM33,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|NS5j,NIAv2|SM5,NIAv2|SM6,NIAv2|SS13c,NIAv2|SS14e,NIAv2|SS15c,NIAv2|SS29,NIAv2|VL3a,NIAv2|VL3b,PCI-DSSv3.2.1|7.1.2,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,PCI-DSSv4.0|10.3.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listRoleDefinitions",
        "regex": "Subscription ID:",
        "not_expect": "Scope: /(subscriptions/[0-9a-f-]+)?,"
    },
    "custom_item_3": {
        "description": "2.1.14 Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'",
        "info": "Enable automatic provisioning of the monitoring agent to collect security data.\n\nRationale:\n\nWhen Log Analytics agent for Azure VMs is turned on, Microsoft Defender for Cloud provisions the Microsoft Monitoring Agent on all existing supported Azure virtual machines and any new ones that are created. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Defender for Cloud\n\nSelect Environment Settings\n\nSelect a subscription\n\nClick on Settings & Monitoring\n\nEnsure that Log Analytics agent for Azure VMs is set to On\n\nRepeat the above for any additional subscriptions.\nFrom Azure CLI\nUse the below command to set Automatic provisioning of monitoring agent to On.\n\naz account get-access-token --query '{subscription:subscription,accessToken:accessToken}' --out tsv | xargs -L1 bash -c 'curl -X PUT -H 'Authorization: Bearer $1' -H 'Content-Type: application/json' https://management.azure.com/subscriptions/subscriptionID/providers/Microsoft.Security/autoProvisioningSettings/default?api-version=2017-08-01-preview -d@'input.json''\n\nWhere input.json contains the Request body json data as mentioned below.\n\n   {\n  'id': '/subscriptions//providers/Microsoft.Security/autoProvisioningSettings/default',\n  'name': 'default',\n  'type': 'Microsoft.Security/autoProvisioningSettings',\n  'properties': {\n    'autoProvision': 'On'\n  }\n}\n\nDefault Value:\n\nBy default, Automatic provisioning of monitoring agent is set to On.",
        "reference": "800-171|3.11.2,800-171|3.11.3,800-53|RA-5,800-53r5|RA-5,CSCv7|3.1,CSCv8|7.5,CSCv8|7.6,CSF|DE.CM-8,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.IP-12,CSF|RS.CO-3,CSF|RS.MI-3,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.1,ITSG-33|RA-5,LEVEL|1A,NESA|M1.2.2,NESA|M5.4.1,NESA|T7.7.1,PCI-DSSv3.2.1|6.1,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.7",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAutoProvisioningSettings",
        "regex": "Auto Provisioning:",
        "not_expect": "Auto Provisioning: Off"
    },
    "custom_item_4": {
        "description": "2.1.13 Ensure that Microsoft Cloud Security Benchmark policies are not set to 'Disabled'",
        "info": "The Microsoft Cloud Security Benchmark (or 'MCSB') is an Azure Policy Initiative containing many security policies to evaluate resource configuration against best practice recommendations. If a policy in the MCSB is set with effect type Disabled, it is not evaluated and may prevent administrators from being informed of valuable security recommendations.\n\nRationale:\n\nA security policy defines the desired configuration of resources in your environment and helps ensure compliance with company or regulatory security requirements. The MCSB Policy Initiative a set of security recommendations based on best practices and is associated with every subscription by default. When a policy 'Effect' is set to Audit, policies in the MCSB ensure that Defender for Cloud evaluates relevant resources for supported recommendations. To ensure that policies within the MCSB are not being missed when the Policy Initiative is evaluated, none of the policies should have an Effect of Disabled.\n\nImpact:\n\nPolicies within the MCSB default to an effect of Audit and will evaluate - but not enforce - policy recommendations. Ensuring these policies are set to Audit simply ensures that the evaluation occurs to allow administrators to understand where an improvement may be possible. Administrators will need to determine if the recommendations are relevant and desirable for their environment, then manually take action to resolve the status if desired.",
        "solution": "From Azure Portal\nPart A - List all disabled policies\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Defender for Cloud\n\nThen Environment Settings\n\nSelect the appropriate Subscription\n\nClick on Security Policy in the left column.\n\nClick on Microsoft Cloud Security Benchmark\n\nClick Add Filter and select Effect\n\nCheck the Disabled box to search for all disabled policies\n\nClick Apply\n\nPart B - Remediate Policy Effect\nFor each policy that remains in the list:\n\nClick the blue ellipses ... to the right of the policy name\n\nClick Manage effect and parameters\n\nUnder Policy Effect, select the Audit radio button\n\nClick Save\n\nClick Refresh\n\nRepeat 'Part B - Remediate Policy Effect' until no more policies are listed.\n\nDefault Value:\n\nBy default, the MCSB policy initiative is associated to all subscriptions and most policies will have an effect of Audit. Some policies will have a default effect of Disabled.",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv7|5.5,CSCv8|4.1,CSCv8|4.2,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.2,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSecurityCenterBuiltIns",
        "regex": "Parameter: ",
        "not_expect": "Parameter: Disabled"
    },
    "custom_item_5": {
        "description": "2.1.18 Ensure 'Additional email addresses' is Configured with a Security Contact Email",
        "info": "Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.\n\nRationale:\n\nMicrosoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Defender for Cloud\n\nClick on Environment Settings\n\nClick on the appropriate Management Group, Subscription, or Workspace\n\nClick on Email notifications\n\nEnter a valid security contact email address (or multiple addresses separated by commas) in the Additional email addresses field\n\nClick Save\n\nFrom Azure CLI\nUse the below command to set Security contact emails to On.\n\naz account get-access-token --query '{subscription:subscription,accessToken:accessToken}' --out tsv | xargs -L1 bash -c 'curl -X PUT -H 'Authorization: Bearer $1' -H 'Content-Type: application/json' https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/securityContacts/default?api-version=2020-01-01-preview -d@'input.json''\n\nWhere input.json contains the data below, replacing validEmailAddress with a single email address or multiple comma-separated email addresses:\n\n    {\n      'id': '/subscriptions//providers/Microsoft.Security/securityContacts/default',\n      'name': 'default',\n      'type': 'Microsoft.Security/securityContacts',\n      'properties': {\n        'email': '',\n        'alertNotifications': 'On',\n        'alertsToAdmins': 'On'\n      }\n    }\n\nDefault Value:\n\nBy default, there are no additional email addresses entered.",
        "reference": "800-171|3.6.1,800-171|3.6.2,800-53|IR-6,800-53|IR-6(3),800-53r5|IR-6,800-53r5|IR-6(3),CSCv7|19.5,CSCv8|17.2,CSF|RS.CO-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|IR-6,LEVEL|1A,NESA|M1.3.3,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSecurityContacts",
        "regex": "Security Contacts:",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_6": {
        "description": "2.1.19 Ensure That 'Notify about alerts with the following severity' is Set to 'High'",
        "info": "Enables emailing security alerts to the subscription owner or other designated security contact.\n\nRationale:\n\nEnabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risk.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Defender for Cloud\n\nClick on Environment Settings\n\nClick on the appropriate Management Group, Subscription, or Workspace\n\nClick on Email notifications\n\nUnder Notification types, check the check box next to Notify about alerts with the following severity (or higher): and select High from the drop down menu\n\nClick Save\n\nFrom Azure CLI\nUse the below command to set Send email notification for high severity alerts to On.\n\naz account get-access-token --query '{subscription:subscription,accessToken:accessToken}' --out tsv | xargs -L1 bash -c 'curl -X PUT -H 'Authorization: Bearer $1' -H 'Content-Type: application/json' https://management.azure.com/subscriptions/<$0>/providers/Microsoft.Security/securityContacts/default1?api-version=2017-08-01-preview -d@'input.json''\n\nWhere input.json contains the data below, replacing validEmailAddress with a single email address or multiple comma-separated email addresses:\n\n       {\n      'id': '/subscriptions//providers/Microsoft.Security/securityContacts/default1',\n      'name': 'default1',\n      'type': 'Microsoft.Security/securityContacts',\n      'properties': {\n        'email': '',\n        'alertNotifications': 'On',\n        'alertsToAdmins': 'On'\n      }\n\nDefault Value:\n\nBy default, Notify about alerts with the following severity (or higher): is set to High.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|6.8,CSCv8|13.11,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSecurityContacts",
        "regex": "minimalSeverity:",
        "expect": "minimalSeverity: High State: on"
    },
    "custom_item_7": {
        "description": "2.1.17 Ensure That 'All users with the following roles' is set to 'Owner'",
        "info": "Enable security alert emails to subscription owners.\n\nRationale:\n\nEnabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nSelect Microsoft Defender for Cloud\n\nClick on Environment Settings\n\nClick on the appropriate Management Group, Subscription, or Workspace\n\nClick on Email notifications\n\nIn the drop down of the All users with the following roles field select Owner\n\nClick Save\n\nFrom Azure CLI\nUse the below command to set Send email also to subscription owners to On.\n\naz account get-access-token --query '{subscription:subscription,accessToken:accessToken}' --out tsv | xargs -L1 bash -c 'curl -X PUT -H 'Authorization: Bearer $1' -H 'Content-Type: application/json' https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/securityContacts/default1?api-version=2017-08-01-preview -d@'input.json''\n\nWhere input.json contains the data below, replacing validEmailAddress with a single email address or multiple comma-separated email addresses:\n\n    {\n      'id': '/subscriptions//providers/Microsoft.Security/securityContacts/default1',\n      'name': 'default1',\n      'type': 'Microsoft.Security/securityContacts',\n      'properties': {\n        'email': '',\n        'alertNotifications': 'On',\n        'alertsToAdmins': 'On',\n'notificationsByRole': 'Owner'\n      }\n    }\n\nDefault Value:\n\nBy default, Owner is selected",
        "reference": "800-171|3.6.1,800-171|3.6.2,800-53|IR-6,800-53|IR-6(3),800-53r5|IR-6,800-53r5|IR-6(3),CSCv7|19.5,CSCv8|17.2,CSF|RS.CO-2,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),ITSG-33|IR-6,LEVEL|1A,NESA|M1.3.3,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSecurityContacts",
        "regex": "Notifications By Role:",
        "expect": "Notifications By Role: .*Owner"
    },
    "custom_item_8": {
        "description": "Storage Accounts Exist",
        "request": "listStorageAccounts",
        "regex": ".*",
        "expect": ".+"
    },
    "custom_item_9": {
        "description": "3.1 Ensure that 'Secure transfer required' is set to 'Enabled'",
        "info": "Enable data encryption in transit.\n\nRationale:\n\nThe secure transfer option enhances the security of a storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access storage accounts, the connection must use HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn't support HTTPS for custom domain names, this option is not applied when using a custom domain name.",
        "solution": "From Azure Portal\n\nGo to Storage Accounts\n\nFor each storage account, go to Configuration\n\nSet Secure transfer required to Enabled\n\nFrom Azure CLI\nUse the below command to enable Secure transfer required for a Storage Account\n\naz storage account update --name--resource-group--https-only true\n\nDefault Value:\n\nBy default, Secure transfer required is set to Disabled.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Secure Transfer Required:",
        "not_expect": "Secure Transfer Required: false"
    },
    "custom_item_10": {
        "description": "3.3 Ensure that 'Enable key rotation reminders' is enabled for each Storage Account",
        "info": "Access Keys authenticate application access requests to data contained in Storage Accounts. A periodic rotation of these keys is recommended to ensure that potentially compromised keys cannot result in a long-term exploitable credential. The 'Rotation Reminder' is an automatic reminder feature for a manual procedure.\n\nRationale:\n\nReminders such as those generated by this recommendation will help maintain a regular and healthy cadence for activities which improve the overall efficacy of a security program.\n\nCryptographic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.'\n\nFor the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.\n\nImpact:\n\nThis recommendation only creates a periodic reminder to regenerate access keys. Regenerating access keys can affect services in Azure as well as the organization's applications that are dependent on the storage account. All clients that use the access key to access the storage account must be updated to use the new key.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nGo to Storage Accounts\n\nFor each Storage Account that is not compliant, go to Access keys\n\nClick Set rotation reminder\n\nCheck Enable key rotation reminders\n\nIn the Send reminders field select Custom, then set the Remind me every field to 90 and the period drop down to Days.\n\nClick Save\n\nFrom Powershell\n\n$rgName =$accountName =$account = Get-AzStorageAccount -ResourceGroupName $rgName -Name $accountName\nif ($account.KeyCreationTime.Key1 -eq $null -or $account.KeyCreationTime.Key2 -eq $null){\nWrite-output ('You must regenerate both keys at least once before setting expiration policy')\n} else {\n$account = Set-AzStorageAccount -ResourceGroupName $rgName -Name $accountName -KeyExpirationPeriodInDay 90\n}\n$account.KeyPolicy.KeyExpirationPeriodInDays\n\nDefault Value:\n\nBy default, Key rotation reminders is not configured.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.14.6,800-171|3.14.7,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53|SI-4,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,800-53r5|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|6.8,CSCv7|11.3,CSCv8|4.1,CSCv8|13.11,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.GV-1,CSF|ID.GV-3,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.IP-8,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,ITSG-33|SI-4,LEVEL|1M,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|7.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Key Creation Time:",
        "not_expect": "Key Creation Time: .+"
    },
    "custom_item_11": {
        "description": "3.4 Ensure that Storage Account Access Keys are Periodically Regenerated",
        "info": "For increased security, regenerate storage account access keys periodically.\n\nRationale:\n\nWhen a storage account is created, Azure generates two 512-bit storage access keys which are used for authentication when the storage account is accessed. Rotating these keys periodically ensures that any inadvertent access or exposure does not result from the compromise of these keys.\n\nCryptographic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.'\n\nFor the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.\n\nImpact:\n\nRegenerating access keys can affect services in Azure as well as the organization's applications that are dependent on the storage account. All clients who use the access key to access the storage account must be updated to use the new key.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nGo to Storage Accounts\n\nFor each Storage Account with outdated keys, go to Access keys\n\nClick Rotate key next to the outdated key, then click Yes to the prompt confirming that you want to regenerate the access key.\n\nAfter Azure regenerates the Access Key, you can confirm that Access keys reflects a Last rotated date of (0 days ago).\n\nDefault Value:\n\nBy default, access keys are not regenerated periodically.",
        "reference": "800-171|3.1.1,800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|CM-7,800-53|MA-4,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|CM-7,800-53r5|MA-4,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|4.6,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|1M,NESA|M1.2.2,NESA|T2.3.4,NESA|T5.4.4,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|NS5j,NIAv2|SS14e,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Key Creation Time:",
        "not_expect": "Key Creation Time: .+"
    },
    "custom_item_12": {
        "description": "3.7 Ensure that 'Public Network Access' is 'Disabled' for storage accounts",
        "info": "Disallowing public network access for a storage account overrides the public access settings for individual containers in that storage account for Azure Resource Manager Deployment Model storage accounts. Azure Storage accounts that use the classic deployment model will be retired on August 31, 2024.\n\nRationale:\n\nThe default network configuration for a storage account permits a user with appropriate permissions to configure public network access to containers and blobs in a storage account. Keep in mind that public access to a container is always turned off by default and must be explicitly configured to permit anonymous requests. It grants read-only access to these resources without sharing the account key, and without requiring a shared access signature. It is recommended not to provide public network access to storage accounts until, and unless, it is strongly desired. A shared access signature token or Azure AD RBAC should be used for providing controlled and timed access to blob containers.\n\nImpact:\n\nAccess will have to be managed using shared access signatures or via Azure AD RBAC.",
        "solution": "From Azure Portal\nFirst, follow Microsoft documentation and create shared access signature tokens for your blob containers. Then,\n\nGo to Storage Accounts\n\nFor each storage account, under the Security + networking section, click Networking\n\nSet Public Network Access to Disabled.\n\nFrom Azure CLI\nSet 'Public Network Access' to Disabled on the storage account\n\naz storage account update --name--resource-group--public-network-access Disabled\n\nFrom PowerShell\nFor each Storage Account, run the following to set the PublicNetworkAccess setting to Disabled\n\nSet-AzStorageAccount -ResourceGroupName-Name-PublicNetworkAccess Disabled\n\nDefault Value:\n\nBy default, Public Network Access is set to Enabled from all networks for the Storage Account.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": ".+",
        "expect": "Public Access: Disabled"
    },
    "custom_item_13": {
        "description": "3.8 Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
        "info": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.\n\nRationale:\n\nStorage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary for specific applications to be built. Access can also be granted to public internet IP address ranges to enable connections from specific internet or on-premises clients. When network rules are configured, only applications from allowed networks can access a storage account. When calling from an allowed network, applications continue to require proper authorization (a valid access key or SAS token) to access the storage account.\n\nImpact:\n\nAll allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.",
        "solution": "From Azure Console\n\nGo to Storage Accounts\n\nFor each storage account, Click on the Networking blade\n\nClick the Firewalls and virtual networks heading.\n\nEnsure that you have elected to allow access from Selected networks\n\nAdd rules to allow traffic from specific network.\n\nClick Save to apply your changes.\n\nFrom Azure CLI\nUse the below command to update default-action to Deny.\n\n    az storage account update --name--resource-group--default-action Deny\n\nDefault Value:\n\nBy default, Storage Accounts will accept connections from clients on any network.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|13.3,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|1A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Default Action:",
        "not_expect": "Default Action: Allow"
    },
    "custom_item_14": {
        "description": "3.10 Ensure Private Endpoints are used to access Storage Accounts",
        "info": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.\n\nRationale:\n\nSecuring traffic between services through encryption protects the data from easy interception and reading.\n\nImpact:\n\nThere is no cost in deploying VNets between Azure resources. If improperly implemented, it may result in loss of critical network traffic.",
        "solution": "From Azure Portal\n\nOpen the Storage Accounts blade\n\nFor each listed Storage Account, perform the following:\n\nUnder the Security + networking heading, click on Networking\n\nClick on the Private Endpoint Connections tab at the top of the networking window\n\nClick the +Private endpoint button\n\nIn the 1 - Basics tab/step:\n\nEnter a name that will be easily recognizable as associated with the Storage Account (Note: The 'Network Interface Name' will be automatically completed, but you can customize it if needed.)\n\nEnsure that the Region matches the region of the Storage Account\n\nClick Next\n\nIn the 2 - Resource tab/step:\n\nSelect the target sub-resource based on what type of storage resource is being made available\n\nClick Next\n\nIn the 3 - Virtual Network tab/step:\n\nSelect the Virtual network that your Storage Account will be connecting to\n\nSelect the Subnet that your Storage Account will be connecting to\n\n(Optional) Select other network settings as appropriate for your environment\n\nClick Next\n\nIn the 4 - DNS tab/step:\n\n(Optional) Select other DNS settings as appropriate for your environment\n\nClick Next\n\nIn the 5 - Tags tab/step:\n\n(Optional) Set any tags that are relevant to your organization\n\nClick Next\n\nIn the 6 - Review + create tab/step:\n\nA validation attempt will be made and after a few moments it should indicate Validation Passed - if it does not pass, double-check your settings before beginning more in depth troubleshooting.\n\nIf validation has passed, click Create then wait for a few minutes for the scripted deployment to complete.\n\nRepeat the above procedure for each Private Endpoint required within every Storage Account.\n\nFrom PowerShell\n\n$storageAccount = Get-AzStorageAccount -ResourceGroupName '' -Name ''\n\n\n$privateEndpointConnection = @{\n                                Name = 'connectionName'\n                                PrivateLinkServiceId = $storageAccount.Id\n                                GroupID = 'blob|blob_secondary|file|file_secondary|table|table_secondary|queue|queue_secondary|web|web_secondary|dfs|dfs_secondary'\n}\n\n\n$privateLinkServiceConnection = New-AzPrivateLinkServiceConnection @privateEndpointConnection\n\n\n$virtualNetDetails = Get-AzVirtualNetwork -ResourceGroupName '' -Name ''\n\n\n$privateEndpoint = @{\n                    ResourceGroupName = ''\n                    Name = ''\n                    Location = ''\n                    Subnet = $virtualNetDetails.Subnets[0]\n                    PrivateLinkServiceConnection = $privateLinkServiceConnection\n}\n\nNew-AzPrivateEndpoint @privateEndpoint\n\nFrom Azure CLI\n\naz network private-endpoint create --resource-group--name--vnet-name--subnet--private-connection-resource-id--connection-name--group-idDefault Value:\n\nBy default, Private Endpoints are not created for Storage Accounts.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|14.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|1A,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": ".*",
        "not_expect": ".+"
    },
    "custom_item_15": {
        "description": "3.15 Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "info": "In some cases, Azure Storage sets the minimum TLS version to be version 1.0 by default. TLS 1.0 is a legacy version and has known vulnerabilities. This minimum TLS version can be configured to be later protocols such as TLS 1.2.\n\nRationale:\n\nTLS 1.0 has known vulnerabilities and has been replaced by later versions of the TLS protocol. Continued use of this legacy protocol affects the security of data in transit.\n\nImpact:\n\nWhen set to TLS 1.2 all requests must leverage this version of the protocol. Applications leveraging legacy versions of the protocol will fail.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Minimum TLS Version:",
        "expect": "Minimum TLS Version: TLS1_2"
    },
    "custom_item_16": {
        "description": "3.16 Ensure 'Cross Tenant Replication' is not enabled",
        "info": "Cross Tenant Replication in Azure allows data to be replicated across multiple Azure tenants. While this feature can be beneficial for data sharing and availability, it also poses a significant security risk if not properly managed. Unauthorized data access, data leakage, and compliance violations are potential risks. Disabling Cross Tenant Replication ensures that data is not inadvertently replicated across different tenant boundaries without explicit authorization.\n\nRationale:\n\nDisabling Cross Tenant Replication minimizes the risk of unauthorized data access and ensures that data governance policies are strictly adhered to. This control is especially critical for organizations with stringent data security and privacy requirements, as it prevents the accidental sharing of sensitive information.\n\nImpact:\n\nDisabling Cross Tenant Replication may affect data availability and sharing across different Azure tenants. Ensure that this change aligns with your organizational data sharing and availability requirements.",
        "solution": "From Azure Portal\n\nNavigate to Storage Accounts\n\nFor each storage account, on the left blade under Data Management, click on Object replication\n\nClick on Advanced settings and untick Allow cross-tenant replication\n\nClick on OK\n\nFrom Azure CLI\nReplace the information within <> with appropriate values:\n\naz storage account update --name--resource-group--allow-cross-tenant-replication false\n\nDefault Value:\n\nFor new storage accounts created after Dec 15, 2023 cross tenant replication is not enabled.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|13.4,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Cross Tenant Replication:",
        "not_expect": "Cross Tenant Replication: true"
    },
    "custom_item_17": {
        "description": "3.17 Ensure that 'Allow Blob Anonymous Access' is set to 'Disabled'",
        "info": "The Azure Storage setting 'Allow Blob Anonymous Access' (aka 'allowBlobPublicAccess') controls whether anonymous access is allowed for blob data in a storage account. When this property is set to True, it enables public read access to blob data, which can be convenient for sharing data but may carry security risks. When set to False, it disallows public access to blob data, providing a more secure storage environment.\n\nRationale:\n\nIf 'Allow Blob Anonymous Access' is enabled, blobs can be accessed by adding the blob name to the URL to see the contents. An attacker can enumerate a blob using methods, such as brute force, and access them.\n\nExfiltration of data by brute force enumeration of items from a storage account may occur if this setting is set to 'Enabled'.\n\nImpact:\n\nAdditional consideration may be required for exceptional circumstances where elements of a storage account require public accessibility. In these circumstances, it is highly recommended that all data stored in the public facing storage account be reviewed for sensitive or potentially compromising data, and that sensitive or compromising data is never stored in these storage accounts.",
        "solution": "From Azure Portal:\n\nOpen the Storage Accounts blade\n\nClick on a Storage Account\n\nIn the storage account menu pane, under the Settings section, click Configuration.\n\nUnder Allow Blob Anonymous Access, select Disabled.\n\nRepeat these steps for each Storage Account.\nFrom Powershell:\nFor every storage account in scope, run the following:\n\n$storageAccount = Get-AzStorageAccount -ResourceGroupName '' -Name ''\n$storageAccount.AllowBlobPublicAccess = $false\nSet-AzStorageAccount -InputObject $storageAccount\n\nDefault Value:\n\nDisabled",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listStorageAccounts",
        "regex": "Allow Blob Anonymous Access:",
        "not_expect": "Allow Blob Anonymous Access: true"
    },
    "custom_item_18": {
        "description": "Test if SQL Servers exist",
        "request": "listSQLServers",
        "regex": "SQL Server:",
        "expect": "SQL Server: .+"
    },
    "custom_item_19": {
        "description": "4.1.1 Ensure that 'Auditing' is set to 'On'",
        "info": "Enable auditing on SQL Servers.\n\nRationale:\n\nThe Azure platform allows a SQL server to be created as a service. Enabling auditing at the server level ensures that all existing and newly created databases on the SQL server instance are audited. Auditing policy applied on the SQL database does not override auditing policy and settings applied on the particular SQL server where the database is hosted.\n\nAuditing tracks database events and writes them to an audit log in the Azure storage account. It also helps to maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
        "solution": "From Azure Portal\n\nGo to SQL servers\n\nSelect the SQL server instance\n\nUnder Security, click Auditing\n\nClick the toggle next to Enable Azure SQL Auditing\n\nSelect an Audit log destination\n\nClick Save\n\nFrom PowerShell\nGet the list of all SQL Servers\n\nGet-AzSqlServer\n\nFor each Server, enable auditing and set the retention for at least 90 days.\nLog Analytics Example\n\nSet-AzSqlServerAudit -ResourceGroupName-ServerName-RetentionInDays-LogAnalyticsTargetState Enabled -WorkspaceResourceId '/subscriptions//resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/Event Hub Example\n\nSet-AzSqlServerAudit -ResourceGroupName '' -ServerName '' -EventHubTargetState Enabled -EventHubName\n    '' -EventHubAuthorizationRuleResourceId ''\n\nBlob Storage Example*\n\nSet-AzSqlServerAudit -ResourceGroupName '' -ServerName '' -BlobStorageTargetState Enabled\n    -StorageAccountResourceId '/subscriptions//resourceGroups//providers/Microsoft.Stora\n    ge/storageAccounts/'\n\nDefault Value:\n\nBy default, Enable Azure SQL Auditing is set to Off.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "getSQLServerBlobAuditingPolicies",
        "regex": "Auditing State:",
        "not_expect": "Auditing State: Disabled"
    },
    "custom_item_20": {
        "description": "4.1.5 Ensure that 'Data encryption' is set to 'On' on a SQL Database",
        "info": "Enable Transparent Data Encryption on every SQL server.\n\nRationale:\n\nAzure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.",
        "solution": "From Azure Portal\n\nGo to SQL databases\n\nFor each DB instance\n\nClick on Transparent data encryption\n\nSet Data encryption to On\n\nFrom Azure CLI\nUse the below command to enable Transparent data encryption for SQL DB instance.\n\naz sql db tde set --resource-group--server--database--status Enabled\n\nFrom PowerShell\nUse the below command to enable Transparent data encryption for SQL DB instance.\n\nSet-AzSqlDatabaseTransparentDataEncryption -ResourceGroupName-ServerName-DatabaseName-State 'Enabled'\n\nNote:\n\nTDE cannot be used to encrypt the logical master database in SQL Database. The master database contains objects that are needed to perform the TDE operations on the user databases.\n\nAzure Portal does not show master databases per SQL server. However, CLI/API responses will show master databases.\n\nDefault Value:\n\nBy default, Data encryption is set to On.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|14.8,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "getSQLDBTransparentDataEncryptions",
        "regex": "Data Encryption Status:"
    },
    "custom_item_21": {
        "description": "4.1.6 Ensure that 'Auditing' Retention is 'greater than 90 days'",
        "info": "SQL Server Audit Retention should be configured to be greater than 90 days.\n\nRationale:\n\nAudit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.",
        "solution": "From Azure Portal\n\nGo to SQL servers\n\nFor each server instance\n\nClick on Auditing\n\nIf storage is selected, expand Advanced properties\n\nSet the Retention (days) setting greater than 90 days or 0 for unlimited retention.\n\nSelect Save\n\nFrom PowerShell\nFor each Server, set retention policy to more than 90 days\nLog Analytics Example\n\nSet-AzSqlServerAudit -ResourceGroupName-ServerName-RetentionInDays-LogAnalyticsTargetState Enabled -WorkspaceResourceId '/subscriptions//resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/Event Hub Example\n\nSet-AzSqlServerAudit -ResourceGroupName '' -ServerName '' -EventHubTargetState Enabled -EventHubName\n    '' -EventHubAuthorizationRuleResourceId ''\n\nBlob Storage Example*\n\nSet-AzSqlServerAudit -ResourceGroupName '' -ServerName '' -BlobStorageTargetState Enabled\n    -StorageAccountResourceId '/subscriptions//resourceGroups//providers/Microsoft.Stora\n    ge/storageAccounts/'\n\nDefault Value:\n\nBy default, SQL Server audit storage is disabled.",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "getSQLServerAuditingPolicies",
        "regex": "Retention:"
    },
    "custom_item_22": {
        "description": "4.1.4 Ensure that Microsoft Entra authentication is Configured for SQL Servers",
        "info": "Use Microsoft Entra authentication for authentication with SQL Database to manage credentials in a single place.\n\nRationale:\n\nMicrosoft Entra authentication is a mechanism to connect to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in the Microsoft Entra ID directory. With Entra ID authentication, identities of database users and other Microsoft services can be managed in one central location. Central ID management provides a single place to manage database users and simplifies permission management.\n\nIt provides an alternative to SQL Server authentication.\n\nHelps stop the proliferation of user identities across database servers.\n\nAllows password rotation in a single place.\n\nCustomers can manage database permissions using external (Entra ID) groups.\n\nIt can eliminate storing passwords by enabling integrated Windows authentication and other forms of authentication supported by Microsoft Entra.\n\nEntra ID authentication uses contained database users to authenticate identities at the database level.\n\nEntra ID supports token-based authentication for applications connecting to SQL Database.\n\nEntra ID authentication supports ADFS (domain federation) or native user/password authentication for a local Active Directory without domain synchronization.\n\nEntra ID supports connections from SQL Server Management Studio that use Active Directory Universal Authentication, which includes Multi-Factor Authentication (MFA). MFA includes strong authentication with a range of easy verification options - phone call, text message, smart cards with pin, or mobile app notification.\n\nImpact:\n\nThis will create administrative overhead with user account and permission management. For further security on these administrative accounts, you may want to consider licensing which supports features like Multi Factor Authentication.",
        "solution": "From Azure Portal\n\nGo to SQL servers\n\nFor each SQL server, click on Microsoft Entra admin\n\nClick on Set admin\n\nSelect an admin\n\nClick Save\n\nFrom Azure CLI\n\naz ad user show --id\n\nFor each Server, set AD Admin\n\naz sql server ad-admin create --resource-group--server--display-name--object-idFrom PowerShell\nFor each Server, set Entra ID Admin\n\nSet-AzSqlServerActiveDirectoryAdministrator -ResourceGroupName-ServerName-DisplayName ''\n\nDefault Value:\n\nEntra ID Authentication for SQL Database/Server is not enabled by default",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSQLServerAdmins",
        "regex": "AD Admin"
    },
    "custom_item_23": {
        "description": "Firewall Rules exist",
        "request": "listSQLServerFirewallRules",
        "regex": "-- Start Address:"
    },
    "custom_item_24": {
        "description": "4.1.2 Ensure no Azure SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)",
        "info": "Ensure that no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP).\n\nRationale:\n\nAzure SQL Server includes a firewall to block access to unauthorized connections. More granular IP addresses can be defined by referencing the range of addresses available from specific datacenters.\n\nBy default, for a SQL server, a Firewall exists with StartIp of 0.0.0.0 and EndIP of 0.0.0.0 allowing access to all the Azure services.\n\nAdditionally, a custom rule can be set up with StartIp of 0.0.0.0 and EndIP of 255.255.255.255 allowing access from ANY IP over the Internet.\n\nIn order to reduce the potential attack surface for a SQL server, firewall rules should be defined with more granular IP addresses by referencing the range of addresses available from specific datacenters.\n\nImpact:\n\nDisabling Allow Azure services and resources to access this server will break all connections to SQL server and Hosted Databases unless custom IP specific rules are added in Firewall Policy.",
        "solution": "From Azure Portal\n\nGo to SQL servers\n\nFor each SQL server\n\nClick on Networking\n\nUncheck the checkbox for Allow Azure services and resources to access this server\n\nSet firewall rules to limit access to only authorized connections\n\nFrom Azure CLI\nDisable default firewall rule Allow access to Azure services:\n\naz sql server firewall-rule delete --resource-group--server--name 'AllowAllWindowsAzureIps'\n\nRemove a custom firewall rule:\n\naz sql server firewall-rule delete --resource-group--server--nameCreate a firewall rule:\n\naz sql server firewall-rule create --resource-group--server--name--start-ip-address '' --end-ip-address ''\n\nUpdate a firewall rule:\n\naz sql server firewall-rule update --resource-group--server--name--start-ip-address '' --end-ip-address ''\n\nFrom PowerShell\nDisable Default Firewall Rule Allow access to Azure services :\n\nRemove-AzSqlServerFirewallRule -FirewallRuleName 'AllowAllWindowsAzureIps' -ResourceGroupName-ServerNameRemove a custom Firewall rule:\n\nRemove-AzSqlServerFirewallRule -FirewallRuleName '' -ResourceGroupName-ServerNameSet the appropriate firewall rules:\n\nSet-AzSqlServerFirewallRule -ResourceGroupName-ServerName-FirewallRuleName '' -StartIpAddress '' -EndIpAddress ''\n\nDefault Value:\n\nBy default, Allow access to Azure Services is set to NO.",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv7|14.6,CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listSQLServerFirewallRules",
        "regex": "-- Start Address:"
    },
    "custom_item_25": {
        "description": "MySQL Database Server exists",
        "request": "listMYSQLServersByResourceGroup",
        "regex": ".+"
    },
    "custom_item_26": {
        "description": "4.4.1 Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server",
        "info": "Enable SSL connection on MYSQL Servers.\n\nRationale:\n\nSSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to Azure Database for MySQL servers\n\nFor each database, click on Connection security\n\nIn SSL settings, click on ENABLED to Enforce SSL connections\n\nFrom Azure CLI\nUse the below command to set MYSQL Databases to Enforce SSL connection.\n\n    az mysql server update --resource-group--name--ssl-enforcement Enabled\n\nDefault Value:\n\nAzure Database for MySQL when provisioned through the Azure portal or CLI will require SSL connections by default.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listMYSQLServersByResourceGroup",
        "regex": "SSLEnforcement: "
    },
    "custom_item_27": {
        "description": "MySQL flexible Database Servers exist",
        "request": "listMYSQLFlexibleServersConfigurations",
        "regex": ".+"
    },
    "custom_item_28": {
        "description": "4.4.2 Ensure 'TLS Version' is set to 'TLSV1.2' (or higher) for MySQL flexible Database Server",
        "info": "Ensure TLS version on MySQL flexible servers is set to use TLS version 1.2 or higher.\n\nRationale:\n\nTLS connectivity helps to provide a new layer of security by connecting database server to client applications using Transport Layer Security (TLS). Enforcing TLS connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to Azure Database for MySQL flexible servers\n\nFor each database, click on Server parameters under Settings\n\nIn the search box, type in tls_version\n\nClick on the VALUE dropdown, and ensure only TLSV1.2 (or higher) is selected for tls_version\n\nFrom Azure CLI\nUse the below command to set MYSQL flexible databases to used version 1.2 for the tls_version parameter.\n\n    az mysql flexible-server parameter set --name tls_version --resource-group--server-name--value TLSV1.2\n\nDefault Value:\n\nBy default, TLS is set to v1.2 for MySQL Flexible servers.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listMYSQLFlexibleServersConfigurations",
        "regex": "TLS Version: ",
        "expect": "TLS Version: TLSv1.2"
    },
    "custom_item_29": {
        "description": "PostgreSQL Servers exist",
        "request": "listPostgreSQLServersByResourceGroup",
        "regex": ".+"
    },
    "custom_item_30": {
        "description": "4.3.1 Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server",
        "info": "Enable SSL connection on PostgreSQL Servers.\n\nRationale:\n\nSSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to Azure Database for PostgreSQL server\n\nFor each database, click on Connection security\n\nIn SSL settings, click on ENABLED to enforce SSL connections\n\nClick Save\n\nFrom Azure CLI\nUse the below command to enforce ssl connection for PostgreSQL Database.\n\naz postgres server update --resource-group--name--ssl-enforcement Enabled\n\nFrom PowerShell\n\nUpdate-AzPostgreSqlServer -ResourceGroupName-ServerName-SslEnforcement Enabled\n\nDefault Value:\n\nBy default, secure connectivity is enforced, but some application frameworks may not enable it during deployment.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServersByResourceGroup",
        "regex": "SSLEnforcement: "
    },
    "custom_item_31": {
        "description": "4.3.2 Ensure Server Parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server",
        "info": "Enable log_checkpoints on PostgreSQL Servers.\n\nRationale:\n\nEnabling log_checkpoints helps the PostgreSQL Database to Log each checkpoint in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu.\n\nGo to Azure Database for PostgreSQL servers.\n\nFor each database, click on Server parameters.\n\nSearch for log_checkpoints.\n\nClick ON and save.\n\nFrom Azure CLI\nUse the below command to update log_checkpoints configuration.\n\naz postgres server configuration set --resource-group--server-name--name log_checkpoints --value on\n\nFrom PowerShell\n\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName-ServerName-Name log_checkpoints -Value on\n\nDefault Value:\n\nBy default log_checkpoints is enabled (set to on).",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServerConfigurations",
        "regex": "Enabled:"
    },
    "custom_item_32": {
        "description": "4.3.3 Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server",
        "info": "Enable log_connections on PostgreSQL Servers.\n\nRationale:\n\nEnabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com.\n\nGo to Azure Database for PostgreSQL servers.\n\nFor each database, click on Server parameters.\n\nSearch for log_connections.\n\nClick ON and save.\n\nFrom Azure CLI\nUse the below command to update log_connections configuration.\n\naz postgres server configuration set --resource-group--server-name--name log_connections --value on\n\nFrom PowerShell\nUse the below command to update log_connections configuration.\n\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName-ServerName-Name log_connections -Value on\n\nDefault Value:\n\nBy default log_connections is enabled (set to on).",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServerConfigurations",
        "regex": "Enabled:"
    },
    "custom_item_33": {
        "description": "4.3.4 Ensure server parameter 'log_disconnections' is set to 'ON' for PostgreSQL Database Server",
        "info": "Enable log_disconnections on PostgreSQL Servers.\n\nRationale:\n\nEnabling log_disconnections helps PostgreSQL Database to Logs end of a session, including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\nImpact:\n\nEnabling this setting will enable a log of all disconnections. If this is enabled for a high traffic server, the log may grow exponentially.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu\n\nGo to Azure Database for PostgreSQL servers\n\nFor each database, click on Server parameters\n\nSearch for log_disconnections.\n\nClick ON and save.\n\nFrom Azure CLI\nUse the below command to update log_disconnections configuration.\n\naz postgres server configuration set --resource-group--server-name--name log_disconnections --value on\n\nFrom PowerShell\nUse the below command to update log_disconnections configuration.\n\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName-ServerName-Name log_disconnections -Value on\n\nDefault Value:\n\nBy default log_disconnections is disabled (set to off).",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServerConfigurations",
        "regex": "Enabled:"
    },
    "custom_item_34": {
        "description": "4.3.5 Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
        "info": "Enable connection_throttling on PostgreSQL Servers.\n\nRationale:\n\nEnabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages. This in turn generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com.\n\nGo to Azure Database for PostgreSQL servers.\n\nFor each database, click on Server parameters.\n\nSearch for connection_throttling.\n\nClick ON and save.\n\nFrom Azure CLI\nUse the below command to update connection_throttling configuration.\n\naz postgres server configuration set --resource-group--server-name--name connection_throttling --value on\n\nFrom PowerShell\nUse the below command to update connection_throttling configuration.\n\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName-ServerName-Name connection_throttling -Value on\n\nDefault Value:\n\nBy default, connection_throttling is enabled (set to on).",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServerConfigurations",
        "regex": "Enabled:"
    },
    "custom_item_35": {
        "description": "4.3.6 Ensure Server Parameter 'log_retention_days' is greater than 3 days for PostgreSQL Database Server",
        "info": "Ensure log_retention_days on PostgreSQL Servers is set to an appropriate value.\n\nRationale:\n\nConfiguring log_retention_days determines the duration in days that Azure Database for PostgreSQL retains log files. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\nImpact:\n\nConfiguring this setting will result in logs being retained for the specified number of days. If this is configured on a high traffic server, the log may grow quickly to occupy a large amount of disk space. In this case you may want to set this to a lower number.",
        "solution": "From Azure Portal\n\nFrom Azure Home select the Portal Menu.\n\nGo to Azure Database for PostgreSQL servers.\n\nFor each database, click on Server parameters.\n\nSearch for log_retention_days.\n\nInput a value between 4 and 7 (inclusive) and click Save.\n\nFrom Azure CLI\nUse the below command to update log_retention_days configuration.\n\naz postgres server configuration set --resource-group--server-name--name log_retention_days --value <4-7>\n\nFrom Powershell\nUse the below command to update log_retention_days configuration.\n\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName-ServerName-Name log_retention_days -Value <4-7>\n\nDefault Value:\n\nBy default log_retention_days is set to 3.",
        "reference": "800-53|AU-4,800-53r5|AU-4,CSCv7|6.4,CSCv8|8.3,CSF|PR.DS-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,LEVEL|1A,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServerConfigurations",
        "regex": "Days:"
    },
    "custom_item_36": {
        "description": "4.3.8 Ensure 'Infrastructure double encryption' for PostgreSQL Database Server is 'Enabled'",
        "info": "Azure Database for PostgreSQL servers should be created with 'infrastructure double encryption' enabled.\n\nRationale:\n\nIf Double Encryption is enabled, another layer of encryption is implemented at the hardware level before the storage or network level. Information will be encrypted before it is even accessed, preventing both interception of data in motion if the network layer encryption is broken and data at rest in system resources such as memory or processor cache. Encryption will also be in place for any backups taken of the database, so the key will secure access the data in all forms. For the most secure implementation of key based encryption, it is recommended to use a Customer Managed asymmetric RSA 2048 Key in Azure Key Vault.\n\nImpact:\n\nThe read and write speeds to the database will be impacted if both default encryption and Infrastructure Encryption are checked, as a secondary form of encryption requires more resource overhead for the cryptography of information. This cost is justified for information security. Customer managed keys are recommended for the most secure implementation, leading to overhead of key management. The key will also need to be backed up in a secure location, as loss of the key will mean loss of the information in the database.",
        "solution": "It is not possible to enable 'infrastructure double encryption' on an existing Azure Database for PostgreSQL server.\nThe remediation steps detail the creation of a new Azure Database for PostgreSQL server with 'infrastructure double encryption' enabled.\nFrom Azure Portal\n\nGo through the normal process of database creation.\n\nOn step 2 titled 'Additional settings' ensure that 'Infrastructure double encryption enabled' is 'checked'.\n\nAcknowledge that you understand this will impact database performance.\n\nFinish database creation as normal.\n\nFrom Azure CLI\n\naz postgres server create --resource-group--name--location--admin-user--admin-password--sku-name GP_Gen4_2 --version 11 --infrastructure-encryption Enabled\n\nDefault Value:\n\nBy Default, Double Encryption is disabled.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|14.8,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listPostgreSQLServersByResourceGroup",
        "regex": "Infrastructure Encryption: "
    },
    "custom_item_37": {
        "description": "5.1.2 Ensure Diagnostic Setting captures appropriate categories",
        "info": "Prerequisite: A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recommendation will not be available. Please review the recommendation at the beginning of this subsection titled: 'Ensure that a 'Diagnostic Setting' exists.'\n\nThe diagnostic setting should be configured to log the appropriate activities from the control/management plane.\n\nRationale:\n\nA diagnostic setting controls how the diagnostic log is exported. Capturing the diagnostic setting categories for appropriate control/management plane activities allows proper alerting.",
        "solution": "From Azure Portal\n\nGo to Azure Monitor\n\nClick Activity log\n\nClick on Export Activity Logs\n\nSelect the Subscription from the drop down menu\n\nClick on Add diagnostic setting\n\nEnter a name for your new Diagnostic Setting\n\nCheck the following categories: Administrative, Alert, Policy, and Security\n\nChoose the destination details according to your organization's needs.\n\nFrom Az CLI\n\naz monitor diagnostic-settings subscription create --subscription--name--location<[--event-hub--event-hub-auth-rule] [--storage-account] [--workspace] --logs '[{category:Security,enabled:true},{category:Administrative,enabled:true},{category:Alert,enabled:true},{category:Policy,enabled:true}]'\n\nFrom PowerShell\n\n$logCategories = @();\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject -Category Administrative -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject -Category Security -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject -Category Alert -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject -Category Policy -Enabled $true\n\nNew-AzSubscriptionDiagnosticSetting -SubscriptionId-Name<[-EventHubAuthorizationRule-EventHubName] [-StorageAccountId] [-WorkSpaceId] [-MarketplacePartner ID]> -Log $logCategories\n\nDefault Value:\n\nWhen the diagnostic setting is created using Azure Portal, by default no categories are selected.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listDiagnosticSetting",
        "regex": "Subscription ID:",
        "expect": "Administrative: true, Alert: true, Policy: true, Security: true"
    },
    "custom_item_38": {
        "description": "5.1.4 Ensure that logging for Azure Key Vault is 'Enabled'",
        "info": "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.\n\nRationale:\n\nMonitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information, keys, and certificates managed by Azure Key Vault. Enabling logging for Key Vault saves information in a user provided destination of either an Azure storage account or Log Analytics workspace. The same destination can be used for collecting logs for multiple Key Vaults.",
        "solution": "From Azure Portal\n\nGo to Key vaults.\n\nSelect a Key vault.\n\nSelect Diagnostic settings.\n\nClick Edit setting to update an existing diagnostic setting, or Add diagnostic setting to create a new one.\n\nIf creating a new diagnostic setting, provide a name.\n\nConfigure an appropriate destination.\n\nUnder Category groups, check audit and allLogs.\n\nClick Save.\n\nFrom Azure CLI\nTo update an existing Diagnostic Settings\n\naz monitor diagnostic-settings update --name '' --resourceTo create a new Diagnostic Settings\n\naz monitor diagnostic-settings create --name '' --resource--logs '[{category:audit,enabled:true},{category:allLogs,enabled:true}]' --metrics '[{category:AllMetrics,enabled:true}]' <[--event-hub--event-hub-rule| --storage-account|--workspace| --marketplace-partner-id]>\n\nFrom PowerShell\nCreate the Log settings object\n\n$logSettings = @()\n$logSettings += New-AzDiagnosticSettingLogSettingsObject -Enabled $true -Category audit\n$logSettings += New-AzDiagnosticSettingLogSettingsObject -Enabled $true -Category allLogs\n\nCreate the Metric settings object\n\n$metricSettings = @()\n$metricSettings += New-AzDiagnosticSettingMetricSettingsObject -Enabled $true -Category AllMetrics\n\nCreate the Diagnostic Settings for each Key Vault\n\nNew-AzDiagnosticSetting -Name '' -ResourceId-Log $logSettings -Metric $metricSettings [-StorageAccountId| -EventHubName-EventHubAuthorizationRuleId| -WorkSpaceId| -MarketPlacePartnerId]\n\nDefault Value:\n\nBy default, Diagnostic AuditEvent logging is not enabled for Key Vault instances.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVaultDiagnosticSetting",
        "regex": "AuditEvent Retention Policy Days:",
        "expect": "AuditEvent Retention Policy Days: [0-9]+"
    },
    "custom_item_39": {
        "description": "Key Vault Exists",
        "request": "listVaultsByResourceGroup",
        "regex": "Key vaults",
        "expect": "Key vaults exist"
    },
    "custom_item_40": {
        "description": "8.1 Ensure that the Expiration Date is set for all Keys in RBAC Key Vaults",
        "info": "Ensure that all Keys in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nRationale:\n\nAzure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The exp (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for encryption of new data, wrapping of new keys, and signing. By default, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys to help enforce the key rotation. This ensures that the keys cannot be used beyond their assigned lifetimes.\n\nImpact:\n\nKeys cannot be used beyond their assigned expiration dates respectively. Keys need to be rotated periodically wherever they are used.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal:\n\nGo to Key vaults.\n\nFor each Key vault, click on Keys.\n\nIn the main pane, ensure that an appropriate Expiration date is set for any keys that are Enabled.\n\nFrom Azure CLI:\nUpdate the Expiration date for the key using the below command:\n\naz keyvault key set-attributes --name--vault-name--expires Y-m-d'T'H:M:S'Z'\n\nNote:\nTo view the expiration date on all keys in a Key Vault using Microsoft API, the 'List' Key permission is required.\nTo update the expiration date for the keys:\n\nGo to the Key vault, click on Access Control (IAM).\n\nClick on Add role assignment and assign the role of Key Vault Crypto Officer to the appropriate user.\n\nFrom PowerShell:\n\nSet-AzKeyVaultKeyAttribute -VaultName-Name-ExpiresDefault Value:\n\nBy default, keys do not expire.",
        "reference": "800-171|3.1.1,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AU-11,800-53|SI-12,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AU-11,800-53r5|SI-12,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|3.1,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|NS5j,NIAv2|SM7,NIAv2|SS14e,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVaultsByResourceGroup",
        "regex": ".+",
        "not_expect": ".+"
    },
    "custom_item_41": {
        "description": "8.2 Ensure that the Expiration Date is set for all Keys in Non-RBAC Key Vaults.",
        "info": "Ensure that all Keys in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nRationale:\n\nAzure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The exp (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for a cryptographic operation. By default, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys. This ensures that the keys cannot be used beyond their assigned lifetimes.\n\nImpact:\n\nKeys cannot be used beyond their assigned expiration dates respectively. Keys need to be rotated periodically wherever they are used.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal:\n\nGo to Key vaults.\n\nFor each Key vault, click on Keys.\n\nIn the main pane, ensure that the status of the key is Enabled.\n\nFor each enabled key, ensure that an appropriate Expiration date is set.\n\nFrom Azure CLI:\nUpdate the Expiration date for the key using the below command:\n\naz keyvault key set-attributes --name--vault-name--expires Y-m-d'T'H:M:S'Z'\n\nNote:\nTo view the expiration date on all keys in a Key Vault using Microsoft API, the 'List' Key permission is required.\nTo update the expiration date for the keys:\n\nGo to Key vault, click on Access policies.\n\nClick on Create and add an access policy with the Update permission (in the Key Permissions - Key Management Operations section).\n\nFrom PowerShell\n\nSet-AzKeyVaultKeyAttribute -VaultName-Name-ExpiresDefault Value:\n\nBy default, keys do not expire.",
        "reference": "800-171|3.1.1,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AU-11,800-53|SI-12,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AU-11,800-53r5|SI-12,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|3.1,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|NS5j,NIAv2|SM7,NIAv2|SS14e,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVaultsByResourceGroup",
        "regex": ".+",
        "not_expect": ".+"
    },
    "custom_item_42": {
        "description": "8.3 Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
        "info": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nRationale:\n\nThe Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.\n\nImpact:\n\nSecrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal:\n\nGo to Key vaults.\n\nFor each Key vault, click on Secrets.\n\nIn the main pane, ensure that the status of the secret is Enabled.\n\nFor each enabled secret, ensure that an appropriate Expiration date is set.\n\nFrom Azure CLI:\nUpdate the Expiration date for the secret using the below command:\n\naz keyvault secret set-attributes --name--vault-name--expires Y-m-d'T'H:M:S'Z'\n\nNote:\nTo view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required.\nTo update the expiration date for the secrets:\n\nGo to the Key vault, click on Access Control (IAM).\n\nClick on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user.\n\nFrom PowerShell:\n\nSet-AzKeyVaultSecretAttribute -VaultName-Name-ExpiresDefault Value:\n\nBy default, secrets do not expire.",
        "reference": "800-171|3.1.1,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AU-11,800-53|SI-12,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AU-11,800-53r5|SI-12,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|3.1,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|NS5j,NIAv2|SM7,NIAv2|SS14e,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVaultsByResourceGroup",
        "regex": ".+",
        "not_expect": ".+"
    },
    "custom_item_43": {
        "description": "8.4 Ensure that the Expiration Date is set for all Secrets in Non-RBAC Key Vaults",
        "info": "Ensure that all Secrets in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nRationale:\n\nThe Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.\n\nImpact:\n\nSecrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal:\n\nGo to Key vaults.\n\nFor each Key vault, click on Secrets.\n\nIn the main pane, ensure that the status of the secret is Enabled.\n\nSet an appropriate Expiration date on all secrets.\n\nFrom Azure CLI:\nUpdate the Expiration date for the secret using the below command:\n\naz keyvault secret set-attributes --name--vault-name--expires Y-m-d'T'H:M:S'Z'\n\nNote: To view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required.\n\nTo update the expiration date for the secrets:\n\nGo to Key vault, click on Access policies.\n\nClick on Create and add an access policy with the Update permission (in the Secret Permissions - Secret Management Operations section).\n\nFrom PowerShell:\nFor each Key vault with the EnableRbacAuthorization setting set to False or empty, run the following command.\n\nSet-AzKeyVaultSecret -VaultName-Name-ExpiresDefault Value:\n\nBy default, secrets do not expire.",
        "reference": "800-171|3.1.1,800-53|AC-1,800-53|AC-2,800-53|AC-2(1),800-53|AU-11,800-53|SI-12,800-53r5|AC-1,800-53r5|AC-2,800-53r5|AC-2(1),800-53r5|AU-11,800-53r5|SI-12,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(e),CN-L3|8.1.10.6(c),CSCv7|16.7,CSCv8|3.1,CSCv8|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.1.1,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-1,ITSG-33|AC-2,ITSG-33|AC-2(1),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|AM28,NIAv2|AM29,NIAv2|AM30,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|NS5j,NIAv2|SM7,NIAv2|SS14e,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVaultsByResourceGroup",
        "regex": ".+",
        "not_expect": ".+"
    },
    "custom_item_44": {
        "description": "8.5 Ensure the Key Vault is Recoverable",
        "info": "The Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects.\n\nIt is recommended the Key Vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.\n\nWARNING: A current limitation is that role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.\n\nRationale:\n\nThere could be scenarios where users accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible.\n\nThere is a Key Vault property that plays a role in permanent unavailability of a Key Vault:\n\nenablePurgeProtection: Setting this parameter to 'true' for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, the key vault and its objects will subsequently be purged.\n\nEnabling the enablePurgeProtection parameter on Key Vaults ensures that Key Vaults and their objects cannot be deleted/purged permanently.\n\nImpact:\n\nOnce purge-protection and soft-delete are enabled for a Key Vault, the action is irreversible."
    },
    "custom_item_45": {
        "description": "5.2.1 Ensure that Activity Log Alert exists for Create Policy Assignment",
        "info": "Create an activity log alert for the Create Policy Assignment event.\n\nRationale:\n\nMonitoring for create policy assignment events gives insight into changes done in 'Azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Create policy assignment (Policy assignment).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/write and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Authorization/policyAssignments/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nGet the Action Group information and store it in a variable, then create a new Action object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope variable.\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Authorization/policyAssignments/write\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_46": {
        "description": "5.2.2 Ensure that Activity Log Alert exists for Delete Policy Assignment",
        "info": "Create an activity log alert for the Delete Policy Assignment event.\n\nRationale:\n\nMonitoring for delete policy assignment events gives insight into changes done in 'azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Delete policy assignment (Policy assignment).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/delete and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the conditions object\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Authorization/policyAssignments/delete -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Action object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope variable.\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Authorization/policyAssignments/delete.\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_47": {
        "description": "5.2.3 Ensure that Activity Log Alert exists for Create or Update Network Security Group",
        "info": "Create an Activity Log Alert for the Create or Update Network Security Group event.\n\nRationale:\n\nMonitoring for Create or Update Network Security Group events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Create or Update Network Security Group (Network Security Group).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/write and level=verbose --scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Network/networkSecurityGroups/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Network/networkSecurityGroups/write\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_48": {
        "description": "5.2.4 Ensure that Activity Log Alert exists for Delete Network Security Group",
        "info": "Create an activity log alert for the Delete Network Security Group event.\n\nRationale:\n\nMonitoring for 'Delete Network Security Group' events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Delete Network Security Group (Network Security Group).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/delete and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Network/networkSecurityGroups/delete -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Network/networkSecurityGroups/delete\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_49": {
        "description": "5.2.5 Ensure that Activity Log Alert exists for Create or Update Security Solution",
        "info": "Create an activity log alert for the Create or Update Security Solution event.\n\nRationale:\n\nMonitoring for Create or Update Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Create or Update Security Solutions (Security Solutions).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/write and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Security/securitySolutions/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Security/securitySolutions/write\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_50": {
        "description": "5.2.6 Ensure that Activity Log Alert exists for Delete Security Solution",
        "info": "Create an activity log alert for the Delete Security Solution event.\n\nRationale:\n\nMonitoring for Delete Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
        "solution": "From Azure Console\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Delete Security Solutions (Security Solutions).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/delete and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Security/securitySolutions/delete -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Security/securitySolutions/delete\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_51": {
        "description": "5.2.8 Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule",
        "info": "Create an activity log alert for the 'Delete SQL Server Firewall Rule.'\n\nRationale:\n\nMonitoring for Delete SQL Server Firewall Rule events gives insight into SQL network access changes and may reduce the time it takes to detect suspicious activity.\n\nImpact:\n\nThere will be a substantial increase in log size if there are a large number of administrative actions on a server.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Delete server firewall rule (Server Firewall Rule).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/delete and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Sql/servers/firewallRules/delete -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Sql/servers/firewallRules/delete\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created or active.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_52": {
        "description": "5.2.7 Ensure that Activity Log Alert exists for Create or Update SQL Server Firewall Rule",
        "info": "Create an activity log alert for the Create or Update SQL Server Firewall Rule event.\n\nRationale:\n\nMonitoring for Create or Update SQL Server Firewall Rule events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\nImpact:\n\nThere will be a substantial increase in log size if there are a large number of administrative actions on a server.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Create/Update server firewall rule (Server Firewall Rule).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/write and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Sql/servers/firewallRules/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Sql/servers/firewallRules/write\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created or active.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_53": {
        "description": "5.2.9 Ensure that Activity Log Alert exists for Create or Update Public IP Address rule",
        "info": "Create an activity log alert for the Create or Update Public IP Addresses rule.\n\nRationale:\n\nMonitoring for Create or Update Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\nImpact:\n\nThere will be a substantial increase in log size if there are a large number of administrative actions on a server.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Create or Update Public Ip Address (Public Ip Address).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Network/publicIPAddresses/write and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Network/publicIPAddresses/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Network/publicIPAddresses/write\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created or active.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_54": {
        "description": "5.2.10 Ensure that Activity Log Alert exists for Delete Public IP Address rule",
        "info": "Create an activity log alert for the Delete Public IP Address rule.\n\nRationale:\n\nMonitoring for Delete Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\nImpact:\n\nThere will be a substantial increase in log size if there are a large number of administrative actions on a server.",
        "solution": "From Azure Portal\n\nNavigate to the Monitor blade.\n\nSelect Alerts.\n\nSelect Create.\n\nSelect Alert rule.\n\nChoose a subscription.\n\nSelect Apply.\n\nSelect the Condition tab.\n\nClick See all signals.\n\nSelect Delete Public Ip Address (Public Ip Address).\n\nClick Apply.\n\nSelect the Actions tab.\n\nClick Select action groups to select an existing action group, or Create action group to create a new action group.\n\nFollow the prompts to choose or create an action group.\n\nSelect the Details tab.\n\nSelect a Resource group, provide an Alert rule name and an optional Alert rule description.\n\nClick Review + create.\n\nClick Create.\n\nFrom Azure CLI\n\naz monitor activity-log alert create --resource-group '' --condition category=Administrative and operationName=Microsoft.Network/publicIPAddresses/delete and level=--scope '/subscriptions/' --name '' --subscription--action-groupFrom PowerShell\nCreate the Conditions object.\n\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Microsoft.Network/publicIPAddresses/delete -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject -Equal Verbose -Field level\n\nRetrieve the Action Group information and store in a variable, then create the Actions object.\n\n$actionGroup = Get-AzActionGroup -ResourceGroupName-Name$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n\nCreate the Scope object\n\n$scope = '/subscriptions/'\n\nCreate the Activity Log Alert Rule for Microsoft.Network/publicIPAddresses/delete\n\nNew-AzActivityLogAlert -Name '' -ResourceGroupName '' -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription-Enabled $true\n\nDefault Value:\n\nBy default, no monitoring alerts are created or active.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listActivityLogAlertBySubscription",
        "regex": "Sub ID:",
        "expect": "Names: \\[.+\\]"
    },
    "custom_item_55": {
        "description": "Security Group Rules are present",
        "request": "listNetworkSecurityGroups",
        "regex": "Access:"
    },
    "custom_item_56": {
        "description": "6.1 Ensure that RDP access from the Internet is evaluated and restricted",
        "info": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nRationale:\n\nThe potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.",
        "solution": "Where RDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\nExpressRoute\nSite-to-site VPN\nPoint-to-site VPN\n\nDefault Value:\n\nBy default, RDP access from internet is not enabled.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSCv8|13.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listNetworkSecurityGroups",
        "regex": "Access:"
    },
    "custom_item_57": {
        "description": "6.2 Ensure that SSH access from the Internet is evaluated and restricted",
        "info": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nRationale:\n\nThe potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
        "solution": "Where SSH is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\nExpressRoute\nSite-to-site VPN\nPoint-to-site VPN\n\nDefault Value:\n\nBy default, SSH access from internet is not enabled.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSCv8|13.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listNetworkSecurityGroups",
        "regex": "Access:"
    },
    "custom_item_58": {
        "description": "6.3 Ensure that UDP access from the Internet is evaluated and restricted",
        "info": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nRationale:\n\nThe potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
        "solution": "Where UDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\nExpressRoute\nSite-to-site VPN\nPoint-to-site VPN\n\nDefault Value:\n\nBy default, UDP access from internet is not enabled.",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSCv8|13.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listNetworkSecurityGroups",
        "regex": "Protocol:"
    },
    "custom_item_59": {
        "description": "6.4 Ensure that HTTP(S) access from the Internet is evaluated and restricted",
        "info": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.\n\nRationale:\n\nThe potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.",
        "solution": "From Azure Portal\n\nGo to Virtual machines.\n\nFor each VM, open the Networking blade.\n\nClick on Inbound port rules.\n\nDelete the rule with:\n\nPort = 80/443 OR [port range containing 80/443]\n\nProtocol = TCP OR Any\n\nSource = Any (*) OR IP Addresses(0.0.0.0/0) OR Service Tag(Internet)\n\nAction = Allow\n\nFrom Azure CLI\n\nRun below command to list network security groups:\n\naz network nsg list --subscription--output table\n\nFor each network security group, run below command to list the rules associated with the specified port:\n\naz network nsg rule list --resource-group--nsg-name--query '[?destinationPortRange=='80 or 443']'\n\nRun the below command to delete the rule with:\n\nPort = 80/443 OR [port range containing 80/443]\n\nProtocol = TCP OR '*'\n\nSource = Any (*) OR IP Addresses(0.0.0.0/0) OR Service Tag(Internet)\n\nAction = Allow\n\naz network nsg rule delete --resource-group--nsg-name--name",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-171|3.13.6,800-53|CA-9,800-53|SC-7,800-53|SC-7(5),800-53r5|CA-9,800-53r5|SC-7,800-53r5|SC-7(5),CN-L3|7.1.2.2(c),CN-L3|8.1.10.6(j),CSCv7|9.2,CSCv8|4.4,CSCv8|4.5,CSCv8|13.4,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.d,GDPR|32.2,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,ITSG-33|SC-7(5),LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listNetworkSecurityGroups",
        "regex": "Access:"
    },
    "custom_item_60": {
        "description": "Test if VMs exist",
        "request": "listVMs"
    },
    "custom_item_61": {
        "description": "7.2 Ensure Virtual Machines are utilizing Managed Disks",
        "info": "Migrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include:\n\nDefault Disk Encryption\n\nResilience, as Microsoft will managed the disk storage and move around if underlying hardware goes faulty\n\nReduction of costs over storage accounts\n\nRationale:\n\nManaged disks are by default encrypted on the underlying hardware, so no additional encryption is required for basic protection. It is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.\n\nFor ARM-deployed Virtual Machines, Azure Adviser will at some point recommend moving VHDs to managed disks both from a security and cost management perspective.\n\nImpact:\n\nThere are additional costs for managed disks based off of disk space allocated. When converting to managed disks, VMs will be powered off and back on.",
        "solution": "From Azure Portal\n\nUsing the search feature, go to Virtual Machines\n\nSelect the virtual machine you would like to convert\n\nSelect Disks in the menu for the VM\n\nAt the top select Migrate to managed disks\n\nYou may follow the prompts to convert the disk and finish by selecting Migrate to start the process\n\nNOTE VMs will be stopped and restarted after migration is complete.\nFrom PowerShell\n\nStop-AzVM -ResourceGroupName $rgName -Name $vmName -Force\nConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName\nStart-AzVM -ResourceGroupName $rgName -Name $vmName\n\nDefault Value:\n\nManaged disks or are an option upon the creation of VMs.",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|14.8,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|1A,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVMs"
    },
    "custom_item_62": {
        "description": "7.5 Ensure that Only Approved Extensions Are Installed",
        "info": "For added security, only install organization-approved extensions on VMs.\n\nRationale:\n\nAzure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.\n\nImpact:\n\nFunctionality by unsupported extensions will be disabled.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nGo to Virtual machines\n\nFor each virtual machine, go to Settings\n\nClick on Extensions + applications\n\nIf there are unapproved extensions, uninstall them.\n\nFrom Azure CLI\nFrom the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM.\n\naz vm extension delete --resource-group--vm-name--nameFrom PowerShell\nFor each VM and each insecure extension from the Audit Procedure run the following command.\n\nRemove-AzVMExtension -ResourceGroupName-Name-VMNameDefault Value:\n\nBy default, no extensions are added to the virtual machines.",
        "reference": "800-171|3.4.1,800-171|3.4.7,800-171|3.7.1,800-171|3.7.2,800-53|CM-7(1),800-53|CM-8,800-53|MA-3,800-53r5|CM-7(1),800-53r5|CM-8,800-53r5|MA-3,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|2.1,CSCv8|2.1,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.MA-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(1),ITSG-33|CM-8,ITSG-33|MA-3,ITSG-33|MA-3a.,LEVEL|1M,NESA|T1.2.1,NESA|T1.2.2,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.3,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listVMInstanceView",
        "regex": ".+",
        "not_expect": ".+"
    },
    "custom_item_63": {
        "description": "7.9 Ensure Trusted Launch is enabled on Virtual Machines",
        "info": "When Secure Boot and vTPM are enabled together, they provide a strong foundation for protecting your VM from boot attacks. For example, if an attacker attempts to replace the bootloader with a malicious version, Secure Boot will prevent the VM from booting. If the attacker is able to bypass Secure Boot and install a malicious bootloader, vTPM can be used to detect the intrusion and alert you.\n\nRationale:\n\nSecure Boot and vTPM work together to protect your VM from a variety of boot attacks, including bootkits, rootkits, and firmware rootkits. Not enabling Trusted Launch in Azure VM can lead to increased vulnerability to rootkits and boot-level malware, reduced ability to detect and prevent unauthorized changes to the boot process, and a potential compromise of system integrity and data security.\n\nImpact:\n\nSecure Boot and vTPM are not currently supported for Azure Generation 1 VMs.\n\nIMPORTANT: Before enabling Secure Boot and vTPM on a Generation 2 VM which does not already have both enabled, it is highly recommended to create a restore point of the VM prior to remediation.",
        "solution": "From Azure Portal\n\nGo to Virtual Machines\n\nFor each VM, under Settings, click on Configuration on the left blade\n\nUnder Security Type, select 'Trusted Launch Virtual Machines'\n\nMake sure Enable Secure Boot & Enable vTPM are checked\n\nClick on Apply.\n\nNote: Trusted launch on existing virtual machines (VMs) is currently not supported for Azure Generation 1 VMs\n\nDefault Value:\n\nOn Azure Generation 2 VMs, vTPM is enabled by default. Secure Boot is not enabled by default.",
        "reference": "800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-53|CM-1,800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|SA-3,800-53|SA-8,800-53|SA-10,800-53r5|CM-1,800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|SA-3,800-53r5|SA-8,800-53r5|SA-10,CSCv7|5.1,CSCv8|4.1,CSF|DE.AE-1,CSF|ID.GV-1,CSF|ID.GV-3,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-3,CSF|PR.PT-3,GDPR|32.1.b,GDPR|32.4,HIPAA|164.306(a)(1),ITSG-33|CM-1,ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|SA-3,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SA-10,LEVEL|1A,NESA|M1.2.2,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.2.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NESA|T7.6.5,NIAv2|GS8b,NIAv2|SS3,NIAv2|SS15a,NIAv2|SS16,NIAv2|VL2,NIAv2|VL7a,NIAv2|VL7b,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|7.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "getVM",
        "regex": "Secure Boot:",
        "expect": "Secure Boot: true VTPm: true"
    },
    "custom_item_64": {
        "description": "Web Apps exist",
        "request": "listWebApps",
        "regex": ".*",
        "expect": ".+"
    },
    "custom_item_65": {
        "description": "9.2 Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Service",
        "info": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.\n\nRationale:\n\nEnabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is therefore important to support HTTPS for the security benefits.\n\nImpact:\n\nWhen it is enabled, every incoming HTTP request is redirected to the HTTPS port. This means an extra level of security will be added to the HTTP requests made to the app.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to App Services\n\nClick on each App\n\nClick on configuration\n\nUnder the HTTPS Only heading select 'On' to enable https only\n\nClick Save at the top\n\nFrom Azure CLI\nTo set HTTPS-only traffic value for an existing app, run the following command:\n\naz webapp update --resource-group--name--set httpsOnly=true\n\nFrom PowerShell\n\nSet-AzWebApp -ResourceGroupName-Name-HttpsOnly $true\n\nDefault Value:\n\nBy default, HTTPS-only feature will be disabled when a new app is created using the command-line tool or Azure Portal console.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listWebApps",
        "regex": "HTTPS Only: ",
        "expect": "HTTPS Only: true"
    },
    "custom_item_66": {
        "description": "9.3 Ensure Web App is using the latest version of TLS encryption",
        "info": "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.\n\nRationale:\n\nApp service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to App Services\n\nClick on each App\n\nUnder Setting section, Click on SSL settings\n\nUnder the Bindings pane, set Minimum TLS Version to 1.2 under Protocol Settings section\n\nFrom Azure CLI\nTo set TLS Version for an existing app, run the following command:\n\naz webapp config set --resource-group--name--min-tls-version 1.2\n\nFrom PowerShell\n\nSet-AzWebApp -ResourceGroupName-Name-MinTlsVersion 1.2\n\nDefault Value:\n\nBy default, TLS Version feature will be set to 1.2 when a new app is created using the command-line tool or Azure Portal console.",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "TLS Min Version: ",
        "expect": "TLS Min Version: 1\\.2"
    },
    "custom_item_67": {
        "description": "9.4 Ensure that Register with Entra ID is enabled on App Service",
        "info": "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering an App Service with Entra ID, the app will connect to other Azure services securely without the need for usernames and passwords.\n\nRationale:\n\nApp Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to App Services\n\nClick on each App\n\nUnder Setting section, Click on Identity\n\nUnder the System assigned pane, set Status to On\n\nFrom Azure CLI\nTo register with Entra ID for an existing app, run the following command:\n\naz webapp identity assign --resource-group--nameFrom PowerShell\nTo register with Entra ID for an existing app, run the following command:\n\nSet-AzWebApp -AssignIdentity $True -ResourceGroupName-NameDefault Value:\n\nBy default, Managed service identity via Entra ID is disabled.",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CN-L3|7.1.3.2(d),CSCv7|16.2,CSCv8|5.6,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "Managed Identity: ",
        "not_expect": "Managed Identity: null"
    },
    "custom_item_68": {
        "description": "9.5 Ensure That 'PHP version' is the Latest, If Used to Run the Web App",
        "info": "Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.\n\nRationale:\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\nImpact:\n\nIf your app is written using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, research the impact thoroughly. Upgrading may have unforeseen consequences that could result in downtime.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nFrom Azure Home open the Portal Menu in the top left\n\nGo to App Services\n\nClick on each App\n\nUnder Settings section, click on Configuration\n\nClick on the General settings pane, ensure that for a Stack of PHP the Major Version and Minor Version reflect the latest stable and supported release.\n\nNOTE: No action is required If PHP version is set to Off or is set with an empty value as PHP is not used by your web app.\n\nFrom Azure CLI\nList the available PHP runtimes:\n\naz webapp list-runtimes\n\nTo set latest PHP version for an existing app, run the following command:\n\naz webapp config set --resource-group--name[--linux-fx-version][--php-version]\n\nFrom PowerShell\nTo set latest PHP version for an existing app, run the following command:\n\nSet-AzWebApp -ResourceGroupName-Name-phpVersionNOTE: Currently there is no way to update an existing web app Linux FX Version setting using PowerShell, nor is there a way to create a new web app using PowerShell that configures the PHP runtime in the Linux FX Version setting.\n\nDefault Value:\n\nThe version of PHP is whatever was selected upon App creation.",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1M",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "PHP Version:",
        "expect": "PHP Version: MANUAL_REVIEW"
    },
    "custom_item_69": {
        "description": "9.6 Ensure that 'Python version' is the Latest Stable Version, if Used to Run the Web App",
        "info": "Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.\n\nRationale:\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. Using the latest full version will keep your stack secure to vulnerabilities and exploits.\n\nImpact:\n\nIf your app is written using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, research the impact thoroughly. Upgrading may have unforeseen consequences that could result in downtime.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nFrom Azure Home open the Portal Menu in the top left\n\nGo to App Services\n\nClick on each App\n\nUnder Settings section, click on Configuration\n\nClick on the General settings pane and ensure that the Major Version and the Minor Version is set to the latest stable version available (Python 3.11, at the time of writing)\n\nNOTE: No action is required if Python version is set to Off, as Python is not used by your web app.\n\nFrom Azure CLI\nTo see the list of supported runtimes:\n\naz webapp list-runtimes\n\nTo set latest Python version for an existing app, run the following command:\n\naz webapp config set --resource-group--name[--windows-fx-version 'PYTHON|3.11'] [--linux-fx-version 'PYTHON|3.11']\n\nFrom PowerShell\nAs of this writing, there is no way to update an existing application's SiteConfig or set the a new application's SiteConfig settings during creation via PowerShell.\n\nDefault Value:\n\nThe version of Python is whatever was selected upon App creation.",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1M",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "Python Version: ",
        "expect": "Python Version: MANUAL_REVIEW"
    },
    "custom_item_70": {
        "description": "9.7 Ensure that 'Java version' is the latest, if used to run the Web App",
        "info": "Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the newer version.\n\nRationale:\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\nImpact:\n\nIf your app is written using version-dependent features or libraries, they may not be available on the latest version. If you wish to upgrade, research the impact thoroughly. Upgrading may have unforeseen consequences that could result in downtime.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to App Services\n\nClick on each App\n\nUnder Settings section, click on Configuration\n\nClick on the General settings pane and ensure that for a Stack of Java the Major Version and Minor Version reflect the latest stable and supported release, and that the Java web server version is set to the auto-update option.\n\nNOTE: No action is required if Java version is set to Off, as Java is not used by your web app.\n\nFrom Azure CLI\nTo see the list of supported runtimes:\n\naz webapp list-runtimes\n\nTo set latest Java version for an existing app, run the following command:\n\naz webapp config set --resource-group--name[--java-version--java-container--java-container-version[--windows-fx-version] [--linux-fx-version]\n\nIf creating a new web application to use a currently supported version of Java, run the following commands.\nTo create an app service plan:\n\naz appservice plan create --resource-group--name--location[--is-linux --number-of-workers--sku] [--hyper-v --sku]\n\nGet the app service plan ID:\n\naz appservice plan list --query '[].{Name:name, ID:id, SKU:sku, Location:location}'\n\nTo create a new Java web application using the retrieved app service ID:\n\naz webapp create --resource-group--plan--name[--linux-fx-version] [--windows-fx-version]\n\nFrom PowerShell\nAs of this writing, there is no way to update an existing application's SiteConfig or set a new application's SiteConfig settings during creation via PowerShell.\n\nDefault Value:\n\nThe default setting is whichever setting was chosen in the creation of the webapp.",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1M",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "Java Version: ",
        "expect": "Java Version: MANUAL_REVIEW"
    },
    "custom_item_71": {
        "description": "9.8 Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App",
        "info": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.\n\nRationale:\n\nNewer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\nHTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "From Azure Portal\n\nLogin to Azure Portal using https://portal.azure.com\n\nGo to App Services\n\nClick on each App\n\nUnder Setting section, Click on Configuration\n\nSet HTTP version to 2.0 under General settings\n\nNOTE: Most modern browsers support HTTP 2.0 protocol over TLS only, while non-encrypted traffic continues to use HTTP 1.1. To ensure that client browsers connect to your app with HTTP/2, either buy an App Service Certificate for your app's custom domain or bind a third party certificate.\n\nFrom Azure CLI\nTo set HTTP 2.0 version for an existing app, run the following command:\n\naz webapp config set --resource-group--name--http20-enabled true\n\nFrom PowerShell\nTo enable HTTP 2.0 version support, run the following command:\n\nSet-AzWebApp -ResourceGroupName-Name-Http20Enabled $true",
        "reference": "800-53|SA-22,800-53r5|SA-22,CSCv7|2.2,CSCv8|2.2,GDPR|32.1.b,HIPAA|164.306(a)(1),LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "HTTP 2.0: ",
        "expect": "HTTP 2.0: MANUAL_REVIEW"
    },
    "custom_item_72": {
        "description": "9.9 Ensure FTP deployments are Disabled",
        "info": "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.\n\nRationale:\n\nAzure FTP deployment endpoints are public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.\n\nImpact:\n\nAny deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.",
        "solution": "From Azure Portal\n\nGo to the Azure Portal\n\nSelect App Services\n\nClick on an app\n\nSelect Settings and then Configuration\n\nUnder General Settings, for the Platform Settings, the FTP state should be set to Disabled or FTPS Only\n\nFrom Azure CLI\nFor each out of compliance application, run the following choosing either 'disabled' or 'FtpsOnly' as appropriate:\n\naz webapp config set --resource-group--name--ftps-state [disabled|FtpsOnly]\n\nFrom PowerShell\nFor each out of compliance application, run the following:\n\nSet-AzWebApp -ResourceGroupName-Name-FtpsStateDefault Value:\n\nBy default, FTP based deployment is All allowed",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv7|16.5,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12346",
        "request": "listAppConfig",
        "regex": "FTP State: ",
        "not_expect": "FTP State: AllAllowed"
    }
}