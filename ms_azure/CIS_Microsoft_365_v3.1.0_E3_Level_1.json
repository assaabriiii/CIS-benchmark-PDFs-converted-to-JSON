{
    "custom_item_1": {
        "description": "1.1.3 Ensure that between two and four global admins are designated",
        "info": "More than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.\n\nRationale:\n\nIf there is only one global tenant administrator, he or she can perform malicious activity without the possibility of being discovered by another admin. If there are numerous global tenant administrators, the more likely it is that one of their accounts will be successfully breached by an external attacker.\n\nImpact:\n\nThe potential impact associated with ensuring compliance with this requirement is dependent upon the current number of global administrators configured in the tenant. If there is only one global administrator in a tenant, an additional global administrator will need to be identified and configured. If there are more than four global administrators, a review of role requirements for current global administrators will be required to identify which of the users require global administrator access.",
        "solution": "To correct the number of global tenant administrators:\n\nNavigate to the Microsoft 365 admin center https://admin.microsoft.com\n\nSelect Users > Active Users.\n\nIn the Search field enter the name of the user to be made a Global Administrator.\n\nTo create a new Global Admin:\n\nSelect the user's name.\n\nA window will appear to the right.\n\nSelect Manage roles.\n\nSelect Admin center access.\n\nCheck Global Administrator.\n\nClick Save changes.\n\nTo remove Global Admins:\n\nSelect User.\n\nUnder Roles select Manage roles\n\nDe-Select the appropriate role.\n\nClick Save changes.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53r5|AC-2,CN-L3|7.1.3.2(d),CSCv7|4.1,CSCv8|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1A,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listSecureScores",
        "regex": "You currently have [0-9]+ global admins",
        "expect": "You currently have [2-4] global admins"
    },
    "custom_item_2": {
        "description": "1.1.4 Ensure Guest Users are reviewed at least biweekly",
        "info": "Guest users can be set up for those users not in the organization to still be granted access to resources. It is important to maintain visibility for what guest users are established in the tenant.\n\nEnsure Guest Users are reviewed no less frequently than biweekly.\n\nNote: With the E5 license an access review can be configured to review guest accounts automatically on a reoccurring basis. This is the preferred method if the licensing is available.\n\nRationale:\n\nPeriodic review of guest users ensures proper access to resources.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To review guest users in the UI:\n\nNavigate to Microsoft 365 admin center https://admin.microsoft.com/.\n\nClick to expand Users and select Guest Users.\n\nReview the list of users.\n\nTo verify Microsoft 365 audit log search is enabled using Microsoft Graph PowerShell:\n\nConnect using Connect-MgGraph -Scopes 'User.Read.All'\n\nRun the following PowerShell command:\n\nGet-MgUser -All -Property UserType,UserPrincipalName |\n    Where {$_.UserType -ne 'Member'} |\n    Format-Table UserPrincipalName, UserType\n\nReview the list of users. If nothing is returned then there are no guest users.",
        "reference": "800-171|3.1.1,800-53|AC-2,800-53|AC-2(3),800-53r5|AC-2,800-53r5|AC-2(3),CN-L3|7.1.3.2(d),CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv7|6.2,CSCv7|16.6,CSCv8|5.1,CSCv8|5.3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2,ITSG-33|AC-2(3),LEVEL|1M,NIAv2|AM26,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,TBA-FIISB|36.2.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listGuestUsers"
    },
    "custom_item_3": {
        "description": "1.3.1 Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)'",
        "info": "Microsoft cloud-only accounts have a pre-defined password policy that cannot be changed. The only items that can change are the number of days until a password expires and whether or whether passwords expire at all.\n\nRationale:\n\nOrganizations such as NIST and Microsoft have updated their password policy recommendations to not arbitrarily require users to change their passwords after a specific amount of time, unless there is evidence that the password is compromised, or the user forgot it. They suggest this even for single factor (Password Only) use cases, with a reasoning that forcing arbitrary password changes on users actually make the passwords less secure. Other recommendations within this Benchmark suggest the use of MFA authentication for at least critical accounts (at minimum), which makes password expiration even less useful as well as password protection for Entra ID.\n\nImpact:\n\nWhen setting passwords not to expire it is important to have other controls in place to supplement this setting. See below for related recommendations and user guidance.\n\nBan common passwords.\n\nEducate users to not reuse organization passwords anywhere else.\n\nEnforce Multi-Factor Authentication registration for all users.",
        "solution": "To set Office 365 passwords are set to never expire:\n\nNavigate to Microsoft 365 admin center https://admin.microsoft.com.\n\nClick to expand Settings select Org Settings.\n\nClick on Security & privacy.\n\nCheck the Set passwords to never expire (recommended) box.\n\nClick Save.\n\nTo set Office 365 Passwords Are Not Set to Expire, use the Microsoft Graph PowerShell module:\n\nConnect to the Microsoft Graph service using Connect-MgGraph -Scopes 'Domain.ReadWrite.All'.\n\nRun the following Microsoft Graph PowerShell command:\n\nUpdate-MgDomain -DomainId-PasswordValidityPeriodInDays 2147483647 -PasswordNotificationWindowInDays 30\n\nDefault Value:\n\nIf the property is not set, a default value of 90 days will be used",
        "reference": "800-171|3.5.2,800-53|IA-5(1),800-53r5|IA-5(1),CSCv7|4.4,CSCv8|5.2,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1),LEVEL|1A,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listDomains",
        "regex": "Password Validity Period In Days:",
        "expect": "Password Validity Period In Days: 2147483647"
    },
    "custom_item_4": {
        "description": "5.1.1.1 Ensure Security Defaults is disabled on Azure Active Directory",
        "info": "Security defaults in Microsoft Entra ID make it easier to be secure and help protect the organization. Security defaults contain preconfigured security settings for common attacks.\n\nBy default, Microsoft enables security defaults. The goal is to ensure that all organizations have a basic level of security enabled. The security default setting is manipulated in the Azure Portal.\n\nThe use of security defaults, however, will prohibit custom settings which are being set with more advanced settings from this benchmark.\n\nRationale:\n\nSecurity defaults provide secure default settings that are managed on behalf of organizations to keep customers safe until they are ready to manage their own identity security settings.\n\nFor example, doing the following:\n\nRequiring all users and admins to register for MFA.\n\nChallenging users with MFA - mostly when they show up on a new device or app, but more often for critical roles and tasks.\n\nDisabling authentication from legacy authentication clients, which can't do MFA.\n\nImpact:\n\nThe potential impact associated with disabling of Security Defaults is dependent upon the security controls implemented in the environment. It is likely that most organizations disabling Security Defaults plan to implement equivalent controls to replace Security Defaults.\n\nIt may be necessary to check settings in other Microsoft products, such as Azure, to ensure settings and functionality are as expected when disabling security defaults for MS365.",
        "solution": "To disable security defaults:\n\nNavigate to the Microsoft Entra admin center https://entra.microsoft.com.\n\nClick to expand Identity select Overview\n\nClick Properties.\n\nClick Manage security defaults.\n\nSet the Security defaults dropdown to Disabled.\n\nSelect Save.\n\nTo configure security defaults using Microsoft Graph PowerShell:\n\nConnect to the Microsoft Graph service using Connect-MgGraph -Scopes 'Policy.ReadWrite.ConditionalAccess'.\n\nRun the following Microsoft Graph PowerShell command:\n\n$params = @{ IsEnabled = $false }\nUpdate-MgPolicyIdentitySecurityDefaultEnforcementPolicy -BodyParameter $params\n\nWarning: It is recommended not to disable security defaults until you are ready to implement conditional access rules in the benchmark. Rules such as requiring MFA for all users and blocking legacy protocols are required in CA to make up for the gap created by disabling defaults. Plan accordingly. See the reference section for more details on what coverage Security Defaults provide.\n\nDefault Value:\n\nEnabled.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1M,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listIdentitySecurityDefaultsEnforcementPolicy",
        "regex": "Enabled:",
        "expect": "Enabled: false"
    },
    "custom_item_5": {
        "description": "5.1.2.3 Ensure 'Restrict non-admin users from creating tenants' is set to 'Yes'",
        "info": "Non-privileged users can create tenants in the Entra administration portal under Manage tenant. The creation of a tenant is recorded in the Audit log as category 'DirectoryManagement' and activity 'Create Company'. Anyone who creates a tenant becomes the Global Administrator of that tenant. The newly created tenant doesn't inherit any settings or configurations.\n\nRationale:\n\nRestricting tenant creation prevents unauthorized or uncontrolled deployment of resources and ensures that the organization retains control over its infrastructure. User generation of shadow IT could lead to multiple, disjointed environments that can make it difficult for IT to manage and secure the organization's data, especially if other users in the organization began using these tenants for business purposes under the misunderstanding that they were secured by the organization's security team.\n\nImpact:\n\nNon-admin users will need to contact I.T. if they have a valid reason to create a tenant.",
        "solution": "To remediate using the UI:\n\nNavigate to Microsoft Entra admin center https://entra.microsoft.com/\n\nClick to expand Identity> Users > User settings.\n\nSet Restrict non-admin users from creating tenants to Yes then Save.\n\nTo remediate using PowerShell:\n\nConnect to Microsoft Graph using Connect-MgGraph -Scopes 'Policy.ReadWrite.Authorization'\n\nRun the following commands.\n\n# Create hashtable and update the auth policy\n$params = @{ AllowedToCreateTenants = $false }\nUpdate-MgPolicyAuthorizationPolicy -DefaultUserRolePermissions $params\n\nDefault Value:\n\nNo - Non-administrators can create tenants.\n\nAllowedToCreateTenants is True",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listAuthorizationPolicy",
        "regex": "Default User Role Permissions - Allowed To Create Tenants:",
        "expect": "Default User Role Permissions - Allowed To Create Tenants: false"
    },
    "custom_item_6": {
        "description": "5.2.2.1 Ensure multifactor authentication is enabled for all users in administrative roles",
        "info": "Multi-factor authentication is a process that requires an additional form of identification during the sign-in process, such as a code from a mobile device or a fingerprint scan, to enhance security.\n\nEnsure users in administrator roles have MFA capabilities enabled.\n\nRationale:\n\nMultifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.\n\nImpact:\n\nImplementation of multifactor authentication for all users in administrative roles will necessitate a change to user routine. All users in administrative roles will be required to enroll in multifactor authentication using phone, SMS, or an authentication application. After enrollment, use of multifactor authentication will be required for future access to the environment.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To enable multifactor authentication for administrators:\n\nNavigate to the Microsoft Entra admin center https://entra.microsoft.com.\n\nClick expand Protection > Conditional Access select Policies.\n\nClick New policy.\n\nGo to Assignments > Users and groups > Include > Select users and groups > check Directory roles.\n\nAt a minimum, select the Directory roles listed below in this section of the document.\n\nGo to Cloud apps or actions > Cloud apps > Include > select All cloud apps (and don't exclude any apps).\n\nUnder Access controls > Grant > select Grant access > check Require multi-factor authentication (and nothing else).\n\nLeave all other conditions blank.\n\nMake sure the policy is enabled.\n\nCreate.\n\nAt minimum these directory roles should be included for MFA:\n\nApplication administrator\n\nAuthentication administrator\n\nBilling administrator\n\nCloud application administrator\n\nConditional Access administrator\n\nExchange administrator\n\nGlobal administrator\n\nGlobal reader\n\nHelpdesk administrator\n\nPassword administrator\n\nPrivileged authentication administrator\n\nPrivileged role administrator\n\nSecurity administrator\n\nSharePoint administrator\n\nUser administrator",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CSCv7|16.3,CSCv8|6.5,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),LEVEL|1M,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listSecureScores",
        "regex": "You have [0-9]+ out of [0-9]+ users with administrative roles",
        "expect": "You have 0 out of [0-9]+ users with administrative roles"
    },
    "custom_item_7": {
        "description": "5.2.2.3 Enable Conditional Access policies to block legacy authentication",
        "info": "Entra ID supports the most widely used authentication and authorization protocols including legacy authentication. This authentication pattern includes basic authentication, a widely used industry-standard method for collecting username and password information.\n\nThe following messaging protocols support legacy authentication:\n\nAuthenticated SMTP - Used to send authenticated email messages.\n\nAutodiscover - Used by Outlook and EAS clients to find and connect to mailboxes in Exchange Online.\n\nExchange ActiveSync (EAS) - Used to connect to mailboxes in Exchange Online.\n\nExchange Online PowerShell - Used to connect to Exchange Online with remote PowerShell. If you block Basic authentication for Exchange Online PowerShell, you need to use the Exchange Online PowerShell Module to connect. For instructions, see Connect to Exchange Online PowerShell using multifactor authentication.\n\nExchange Web Services (EWS) - A programming interface that's used by Outlook, Outlook for Mac, and third-party apps.\n\nIMAP4 - Used by IMAP email clients.\n\nMAPI over HTTP (MAPI/HTTP) - Primary mailbox access protocol used by Outlook 2010 SP2 and later.\n\nOffline Address Book (OAB) - A copy of address list collections that are downloaded and used by Outlook.\n\nOutlook Anywhere (RPC over HTTP) - Legacy mailbox access protocol supported by all current Outlook versions.\n\nPOP3 - Used by POP email clients.\n\nReporting Web Services - Used to retrieve report data in Exchange Online.\n\nUniversal Outlook - Used by the Mail and Calendar app for Windows 10.\n\nOther clients - Other protocols identified as utilizing legacy authentication.\n\nRationale:\n\nLegacy authentication protocols do not support multi-factor authentication. These protocols are often used by attackers because of this deficiency. Blocking legacy authentication makes it harder for attackers to gain access.\n\nNOTE: As of October 2022 Microsoft began disabling basic authentication in all tenants, except for those who requested special exceptions it should no longer be available in most tenants beyond Dec 31, 2022. Despite this CIS recommends the CA policy to remain in place to act as a defense in depth measure.\n\nImpact:\n\nEnabling this setting will prevent users from connecting with older versions of Office, ActiveSync or using protocols like IMAP, POP or SMTP and may require upgrades to older versions of Office, and use of mobile mail clients that support modern authentication.\n\nThis will also cause multifunction devices such as printers from using scan to e-mail function if they are using a legacy authentication method. Microsoft has mail flow best practices in the link below which can be used to configure a MFP to work with modern authentication:\n\nhttps://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365",
        "solution": "To setup a conditional access policy to block legacy authentication, use the following steps:\n\nNavigate to the Microsoft Entra admin center https://entra.microsoft.com.\n\nClick expand Protection > Conditional Access select Policies.\n\nCreate a new policy by selecting New policy.\n\nSet the following conditions within the policy.\n\nSelect Conditions then Client apps enable the settings for and Exchange ActiveSync clients and other clients.\n\nUnder Access controls set the Grant section to Block access\n\nUnder Assignments enable All users\n\nUnder Assignments and Users and groups set the Exclude to be at least one low risk account or directory role. This is required as a best practice.\n\nDefault Value:\n\nBasic authentication is disabled by default as of January 2023.",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv7|9.2,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1M,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listSecureScores",
        "regex": "You have [0-9]+ of [0-9]+ users that don't have legacy authentication blocked",
        "expect": "You have 0 of [0-9]+ users that don't have legacy authentication blocked"
    },
    "custom_item_8": {
        "description": "7.2.1 Ensure modern authentication for SharePoint applications is required",
        "info": "Modern authentication in Microsoft 365 enables authentication features like multifactor authentication (MFA) using smart cards, certificate-based authentication (CBA), and third-party SAML identity providers.\n\nRationale:\n\nStrong authentication controls, such as the use of multifactor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.\n\nImpact:\n\nImplementation of modern authentication for SharePoint will require users to authenticate to SharePoint using modern authentication. This may cause a minor impact to typical user behavior.\n\nThis may also prevent third-party apps from accessing SharePoint Online resources. Also, this will also block apps using the SharePointOnlineCredentials class to access SharePoint Online resources.",
        "solution": "To remediate using the UI:\n\nNavigate to SharePoint admin center https://admin.microsoft.com/sharepoint.\n\nClick to expand Policies select Access control.\n\nSelect Apps that don't use modern authentication.\n\nSelect the radio button for Block access.\n\nClick Save.\n\nTo remediate using PowerShell:\n\nConnect to SharePoint Online using Connect-SPOService -Url https://tenant-admin.sharepoint.com replacing tenant with your value.\n\nRun the following SharePoint Online PowerShell command:\n\nSet-SPOTenant -LegacyAuthProtocolsEnabled $false\n\nDefault Value:\n\nTrue (Apps that don't use modern authentication are allowed)",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|16.3,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listSharePointTenantSettings",
        "regex": "Legacy Auth Protocols Enabled:",
        "expect": "Legacy Auth Protocols Enabled: false"
    },
    "custom_item_9": {
        "description": "7.2.3 Ensure external content sharing is restricted",
        "info": "The external sharing settings govern sharing for the organization overall. Each site has its own sharing setting that can be set independently, though it must be at the same or more restrictive setting as the organization.\n\nThe new and existing guests option requires people who have received invitations to sign in with their work or school account (if their organization uses Microsoft 365) or a Microsoft account, or to provide a code to verify their identity. Users can share with guests already in your organization's directory, and they can send invitations to people who will be added to the directory if they sign in.\n\nThe recommended state is New and existing guests or less permissive.\n\nRationale:\n\nForcing guest authentication on the organization's tenant enables the implementation of controls and oversight over external file sharing. When a guest is registered with the organization, they now have an identity which can be accounted for. This identity can also have other restrictions applied to it through group membership and conditional access rules.\n\nImpact:\n\nWhen using B2B integration, Entra ID external collaboration settings, such as guest invite settings and collaboration restrictions apply.",
        "solution": "To remediate using the UI:\n\nNavigate to SharePoint admin center https://admin.microsoft.com/sharepoint\n\nClick to expand Policies > Sharing.\n\nLocate the External sharing section.\n\nUnder SharePoint, move the slider bar to New and existing guests or a less permissive level.\n\nOneDrive will also be moved to the same level and can never be more permissive than SharePoint.\n\nTo remediate using PowerShell:\n\nConnect to SharePoint Online service using Connect-SPOService.\n\nRun the following cmdlet to establish the minimum recommended state:\n\nSet-SPOTenant -SharingCapability ExternalUserSharingOnly\n\nNote: Other acceptable values for this parameter that are more restrictive include: Disabled and ExistingExternalUserSharingOnly.\n\nDefault Value:\n\nAnyone (ExternalUserAndGuestSharing)",
        "reference": "800-171|3.1.1,800-171|3.1.4,800-171|3.1.5,800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|AC-3,800-53|AC-5,800-53|AC-6,800-53|MP-2,800-53r5|AC-3,800-53r5|AC-5,800-53r5|AC-6,800-53r5|MP-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv8|3.3,CSF|PR.AC-4,CSF|PR.DS-5,CSF|PR.PT-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.1.2,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AC-5,ITSG-33|AC-6,ITSG-33|MP-2,ITSG-33|MP-2a.,LEVEL|1A,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/15279",
        "request": "listSharePointTenantSettings",
        "regex": "Sharing Capability:",
        "expect": "Sharing Capability: (externalUserSharingOnly|existingExternalUserSharingOnly|disabled)"
    }
}