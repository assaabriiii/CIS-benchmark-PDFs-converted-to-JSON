{
    "custom_item_1": {
        "description": "SYMP-AG-000010 - If Symantec ProxySG filters externally initiated traffic, reverse proxy services must be configured.",
        "info": "Automated monitoring of remote access traffic allows organizations to detect cyber attacks and also ensure ongoing compliance with remote access policies by inspecting connection activities of remote access capabilities.\n\nRemote access methods include both unencrypted and encrypted traffic (e.g., web portals, web content filter, TLS, and webmail). With inbound TLS inspection, the traffic must be inspected prior to being allowed on the enclave's web servers hosting TLS or HTTPS applications.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to monitor and control inbound traffic by configuring reverse proxy services. This provides SSL proxy in reverse proxy mode.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Services >> Proxy Services.\n3. Click 'New Service'.\n4. Enter information into the various service boxes in accordance with site architecture, operational requirements, and SSP requirements for which web servers are to be monitored and controlled.",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104171r1_rule,STIG-ID|SYMP-AG-000010,SWIFT-CSCv1|2.6,Vuln-ID|V-94217",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "proxy-services ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_2": {
        "description": "SYMP-AG-000020 - Symantec ProxySG providing intermediary services for remote access communications traffic must ensure outbound traffic is monitored for compliance with remote access security policies.",
        "info": "Automated monitoring of remote access traffic allows organizations to detect cyber attacks and also ensure ongoing compliance with remote access policies by inspecting connection activities of remote access capabilities.\n\nRemote access methods include both unencrypted and encrypted traffic (e.g., web portals, web content filter, TLS, and webmail). With outbound traffic inspection, traffic must be inspected prior to being forwarded to destinations outside of the enclave, such as external email traffic.",
        "solution": "Configure the ProxySG to inspect internally initiated traffic.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer (transparent proxy architectures) or Add Web Access Layer (explicit proxy architectures).\n4. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.12,800-53|AC-17(1),800-53r5|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|8.1.4.4(c),CN-L3|8.1.10.6(i),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(1),NESA|T5.4.4,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104173r1_rule,STIG-ID|SYMP-AG-000020,SWIFT-CSCv1|2.6,Vuln-ID|V-94219",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "regex": ";; Tab: \\[SSL Access Layer \\(1\\)\\]|;; Tab: \\[Web Access Layer \\(1\\)\\]",
        "expect": ";; Tab: \\[SSL Access Layer \\(1\\)\\]|;; Tab: \\[Web Access Layer \\(1\\)\\]"
    },
    "custom_item_3": {
        "description": "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52 - client.connection.negotiated_ssl_version",
        "info": "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\nThis requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.\n\nNIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers.",
        "solution": "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4 to 9 for the 'Destination' field, using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": "client.connection.negotiated_ssl_version",
        "expect": "client.connection.negotiated_ssl_version=@CLIENT_NEG_SSL_VER@"
    },
    "custom_item_4": {
        "description": "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52 - client.connection.negotiated_cipher",
        "info": "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\nThis requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.\n\nNIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers.",
        "solution": "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4 to 9 for the 'Destination' field, using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": "client.connection.negotiated_cipher",
        "expect": "client.connection.negotiated_cipher=@CLIENT_NEG_CIPHER@"
    },
    "custom_item_5": {
        "description": "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52 - server.connection.negotiated_cipher",
        "info": "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\nThis requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.\n\nNIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers.",
        "solution": "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4 to 9 for the 'Destination' field, using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": "server.connection.negotiated_cipher",
        "expect": "server.connection.negotiated_cipher=@SERVER_NEG_CIPHER@"
    },
    "custom_item_6": {
        "description": "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52 - server.connection.negotiated_ssl_version",
        "info": "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\nThis requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.\n\nNIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers.",
        "solution": "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4 to 9 for the 'Destination' field, using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": "server.connection.negotiated_ssl_version",
        "expect": "server.connection.negotiated_ssl_version=@SERVER_NEG_SSL_VER@"
    },
    "custom_item_7": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - DoS incidents are detected. Rules",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "Track:",
        "expect": "Track: Email.*",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none",
        "context": "",
        "MEDIUMdescription": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Rules"
    },
    "custom_item_8": {
        "description": "SYMP-AG-000050 - Symantec ProxySG storing secret or private keys must use FIPS-approved key management technology and processes in the production and control of private/secret cryptographic keys.",
        "info": "Private key data is used to prove that the entity presenting a public key certificate is the certificate's rightful owner. Compromise of private key data allows an adversary to impersonate the key holder.\n\nPrivate key data associated with software certificates, including those issued to an ALG, must be generated and protected in at least a FIPS 140-2 Level 1 validated cryptographic module. For Proxy SG, as long as the FIPS-compliant suite is configured for use and configured in compliance with the FIPS cert manual requirements, key management should be in compliance using the following instructions. Symantec HSM may be used; however, it may require an additional license.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "As long as the FIPS-compliant suite is configured for use and configured in compliance with the FIPS cert manual requirements, key management should be in compliance using the following instructions.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> SSL >> HSM.\n3. Click the 'HSM' and 'HSM Keyring' tabs and configure these options per the guidance in the ProxySG Administration Guide, Chapter 9: Managing the SSL Proxy, Section G: Working with an HSM Appliance.\n4. Click Configuration >> Proxy Settings >> SSL Proxy.\n5. Select the HSM Keyring in the Issuer Keyring field and click 'Apply'.\n\nNote: As long as the FIPS-compliant suite is being used and configured in compliance with the FIPS cert manual requirements, key management should be in compliance as part of this.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-104179r2_rule,STIG-ID|SYMP-AG-000050,SWIFT-CSCv1|2.6,Vuln-ID|V-94225",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show ssl hsm-keyring",
        "regex": "^[\\s]*HSM-keyring:[\\s]*",
        "expect": "^[\\s]*HSM-keyring:[\\s]*@HSM_KEYRING@[\\s]*"
    },
    "custom_item_9": {
        "description": "SYMP-AG-000060 - Symantec ProxySG must implement security policies that enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies.",
        "info": "Successful authentication must not automatically give an entity access to an asset or security boundary. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.\n\nAuthorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. ALGs must use these policies and mechanisms to control access on behalf of the application for which it is acting as intermediary.",
        "solution": "Obtain the SSP with the site's security policy. Configure the ProxySG to enforce approved authorizations by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.\n\n1. Log on to the web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'.\n4. For each Web Access Layer that is configured, right-click the 'Source' of each column and click 'Set'.\n5. Select the users, groups, roles, and attributes as required by the site's security policy.\n6. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|I,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104181r1_rule,STIG-ID|SYMP-AG-000060,TBA-FIISB|31.1,Vuln-ID|V-94227",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Source:Source: Nothing Found",
        "not_expect": "Source: Any"
    },
    "custom_item_10": {
        "description": "SYMP-AG-000070 - Symantec ProxySG must restrict or block harmful or suspicious communications traffic by controlling the flow of information between interconnected networks based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic - Web Access",
        "info": "Information flow control regulates where information is allowed to travel within a network and between interconnected networks. Blocking or restricting detected harmful or suspicious communications between interconnected networks enforces approved authorizations for controlling the flow of traffic.\n\nThis requirement applies to the flow of information between the ALG when used as a gateway or boundary device that allows traffic flow between interconnected networks of differing security policies.\n\nThe ALG is installed and configured to restrict or block information flows based on guidance in the PPSM regarding restrictions for boundary crossing for ports, protocols, and services. Information flow restrictions may be implemented based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.\n\nThe ALG must be configured with policy filters (e.g., security policy, rules, and/or signatures) that restrict or block information system services, provide a packet-filtering capability based on header information, and/or perform message-filtering based on message content. The policy filters used depend on the type of application gateway (e.g., web, email, or TLS).",
        "solution": "Configure ProxySG to restrict access to suspicious or harmful web traffic. Destination security policy must be configured to filter based on destination, headers, geolocation, protocol characteristics, and other available security objects.\n\n1. Log on to the web Management Console.\n2. Click Configuration >> Content Filtering.\n3. Under 'General,' ensure that at least one 'Provider' is enabled.\n4. Click Configuration >> Visual Policy Manager.\n5. Click 'Launch'. While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.\n6. Within each layer above, right-click the 'Destination' fields of each rule, click 'set', and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CAT|I,CCI|CCI-001414,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-104183r1_rule,STIG-ID|SYMP-AG-000070,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-94229",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_11": {
        "description": "SYMP-AG-000070 - Symantec ProxySG must restrict or block harmful or suspicious communications traffic by controlling the flow of information between interconnected networks based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic - SSL",
        "info": "Information flow control regulates where information is allowed to travel within a network and between interconnected networks. Blocking or restricting detected harmful or suspicious communications between interconnected networks enforces approved authorizations for controlling the flow of traffic.\n\nThis requirement applies to the flow of information between the ALG when used as a gateway or boundary device that allows traffic flow between interconnected networks of differing security policies.\n\nThe ALG is installed and configured to restrict or block information flows based on guidance in the PPSM regarding restrictions for boundary crossing for ports, protocols, and services. Information flow restrictions may be implemented based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.\n\nThe ALG must be configured with policy filters (e.g., security policy, rules, and/or signatures) that restrict or block information system services, provide a packet-filtering capability based on header information, and/or perform message-filtering based on message content. The policy filters used depend on the type of application gateway (e.g., web, email, or TLS).",
        "solution": "Configure ProxySG to restrict access to suspicious or harmful web traffic. Destination security policy must be configured to filter based on destination, headers, geolocation, protocol characteristics, and other available security objects.\n\n1. Log on to the web Management Console.\n2. Click Configuration >> Content Filtering.\n3. Under 'General,' ensure that at least one 'Provider' is enabled.\n4. Click Configuration >> Visual Policy Manager.\n5. Click 'Launch'. While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.\n6. Within each layer above, right-click the 'Destination' fields of each rule, click 'set', and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CAT|I,CCI|CCI-001414,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-104183r1_rule,STIG-ID|SYMP-AG-000070,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-94229",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_12": {
        "description": "SYMP-AG-000080 - Symantec ProxySG must enforce approved authorizations for controlling the flow of information within the network based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.",
        "info": "Information flow control regulates where information is allowed to travel within a network. The flow of all network traffic must be monitored and controlled so it does not introduce any unacceptable risk to the network infrastructure or data.\n\nInformation flow control policies and enforcement mechanisms are commonly employed by organizations to control the flow of information between designated sources and destinations (e.g., networks, individuals, devices) within information systems. Examples of information flow control restrictions include keeping export-controlled information from being transmitted in the clear to the Internet or blocking information marked as classified that is being transported to an unapproved destination.\n\nALGs enforce approved authorizations by employing security policy and/or rules that restrict information system services or provide packet filtering capability based on header or protocol information and/or message filtering capability based on data content (e.g., implementing keyword searches or using document characteristics).",
        "solution": "Obtain the SSP with the site's security policy. Configure the ProxySG to enforce approved authorizations by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.\n\n1. Log on to the web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'.\n4. For each Web Access Layer that is configured, right-click the 'Source' of each column and click 'Set'.\n5. Select objects based on traffic attributes, content, source, or headers as required by the site's security policy.\n6. For each Web Access Layer that is configured, right-click the 'Destination' of each column and click 'Set'.\n7. Select objects based on traffic attributes, content, destination, or headers as required by the site's security policy.\n8. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CAT|II,CCI|CCI-001368,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-104185r1_rule,STIG-ID|SYMP-AG-000080,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-94231",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Source:Source: Nothing Found",
        "not_expect": "Source: Any"
    },
    "custom_item_13": {
        "description": "SYMP-AG-000090 - Symantec ProxySG must immediately use updates made to policy enforcement mechanisms such as policies and rules - Web Access",
        "info": "Information flow policies regarding dynamic information flow control include, for example, allowing or disallowing information flows based on changes to the PPSM CAL, vulnerability assessments, or mission conditions. Changing conditions include changes in the threat environment and detection of potentially harmful or adverse events.\n\nChanges to the ALG must take effect when made by an authorized administrator and the new configuration is put in place or committed, including upon restart of the application or reboot of the system. With some devices, the changes take effect as the configuration is changed, while with others, the new configuration must be submitted to the device. In any case, the behavior of the ALG must immediately be affected to reflect the configuration change.\n\nIn the ProxySG platform, a policy contains one or more layers that provide functionality, such as SSL interception, authentication, and web access. Each layer contains rules that define source and destination criteria and an action to take for each set of criteria.",
        "solution": "Configure ProxySG to restrict access to suspicious or harmful communications.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Content Filtering.\n3. Under 'General,' verify that at least one 'Provider' is enabled.\n4. Click Configuration >> Visual Policy Manager.\n5. Click 'Launch'. While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.\n6. Within each layer above, right-click the 'Destination' fields of each rule, click 'set', and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CAT|II,CCI|CCI-001414,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-104187r1_rule,STIG-ID|SYMP-AG-000090,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-94233",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_14": {
        "description": "SYMP-AG-000090 - Symantec ProxySG must immediately use updates made to policy enforcement mechanisms such as policies and rules - SSL",
        "info": "Information flow policies regarding dynamic information flow control include, for example, allowing or disallowing information flows based on changes to the PPSM CAL, vulnerability assessments, or mission conditions. Changing conditions include changes in the threat environment and detection of potentially harmful or adverse events.\n\nChanges to the ALG must take effect when made by an authorized administrator and the new configuration is put in place or committed, including upon restart of the application or reboot of the system. With some devices, the changes take effect as the configuration is changed, while with others, the new configuration must be submitted to the device. In any case, the behavior of the ALG must immediately be affected to reflect the configuration change.\n\nIn the ProxySG platform, a policy contains one or more layers that provide functionality, such as SSL interception, authentication, and web access. Each layer contains rules that define source and destination criteria and an action to take for each set of criteria.",
        "solution": "Configure ProxySG to restrict access to suspicious or harmful communications.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Content Filtering.\n3. Under 'General,' verify that at least one 'Provider' is enabled.\n4. Click Configuration >> Visual Policy Manager.\n5. Click 'Launch'. While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.\n6. Within each layer above, right-click the 'Destination' fields of each rule, click 'set', and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.3,800-53|AC-4,800-53r5|AC-4,CAT|II,CCI|CCI-001414,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,Rule-ID|SV-104187r1_rule,STIG-ID|SYMP-AG-000090,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-94233",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_15": {
        "description": "SYMP-AG-000100 - Symantec ProxySG providing user access control intermediary services must display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to the network.",
        "info": "Display of a standardized and approved use notification before granting access to the network ensures that privacy and security notification verbiage used is consistent with applicable Federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. This requirement applies to network elements that have the concept of a user account and have the logon function residing on the network element.\n\nThe banner must be formatted in accordance with DTM-08-060. Use the following verbiage for network elements that can accommodate banners of 1300 characters:\n\n'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n'I've read & consent to terms in IS user agreem't.'\n\nThis policy only applies to ALGs (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services.",
        "solution": "Configure the Standard Mandatory DoD Banner to be displayed.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, create a new Web Access Layer, positioned in front (farthest left) of all other existing Web Access Layers and perform the following:\ni. Click 'edit' and select 'add rule'.\nii. Right-click the 'Actions' field of the new rule and select 'set'. Click 'New' and select 'NotifyUser' from the list and click 'OK'.\niii. Input the correct banner text in the 'Body' field and click 'OK'.\niv. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CAT|II,CCI|CCI-000048,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-104189r2_rule,STIG-ID|SYMP-AG-000100,TBA-FIISB|45.2.4,Vuln-ID|V-94235",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Action:Action: Nothing Found",
        "regex": "Action:",
        "expect": "Action: @NOTIFY_USER_NAME@.*"
    },
    "custom_item_16": {
        "description": "SYMP-AG-000110 - Symantec ProxySG providing user access control intermediary services for publicly accessible applications must display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to the system.",
        "info": "Display of a standardized and approved use notification before granting access to the publicly accessible network element ensures privacy and security notification verbiage used is consistent with applicable Federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. This requirement applies to network elements that have the concept of a user account and have the logon function residing on the network element.\n\nThe banner must be formatted in accordance with DoD requirements. Use the following verbiage for network elements that can accommodate banners of 1300 characters:\n\n'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n'I've read & consent to terms in IS user agreem't.'\n\nThis policy only applies to gateways (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services off-loaded from the application. Publicly accessible systems are used in DoD to provide benefit information, pay information, or public services. These gateways may also provide self-registration and authorization services.",
        "solution": "Configure the Standard Mandatory DoD Banner to be displayed.\n\nThe banner must be formatted in accordance with DoD requirements. Use the following verbiage for network elements that can accommodate banners of 1300 characters:\n\n'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n'I've read & consent to terms in IS user agreem't.'\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, select each Web Access Layer that is configured and perform the following:\n    i. Click 'edit' and select 'add rule'.\n    ii. Right-click the 'Actions' field of the new rule and select 'set'. Click 'New' and select 'NotifyUser' from the list and click 'OK'.\n    iii. Input the correct banner text in the 'Body' field and click 'OK'.\n    iv. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.1.9,800-53|AC-8c.1.,800-53|AC-8c.2.,800-53|AC-8c.3.,800-53r5|AC-8c.1.,800-53r5|AC-8c.2.,800-53r5|AC-8c.3.,CAT|II,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8c.a.,ITSG-33|AC-8c.b.,ITSG-33|AC-8c.c.,NESA|M5.2.5,NESA|T5.5.1,Rule-ID|SV-104191r1_rule,STIG-ID|SYMP-AG-000110,TBA-FIISB|45.2.4,Vuln-ID|V-94237",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Action:Action: Nothing Found",
        "regex": "Action:",
        "expect": "Action: @NOTIFY_USER_NAME@.*"
    },
    "custom_item_17": {
        "description": "SYMP-AG-000120 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful logon attempts occur - enabled",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).",
        "solution": "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access and Web Authentication Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104193r1_rule,STIG-ID|SYMP-AG-000120,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94239",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "access-log  ;mode",
        "regex": "^enable$",
        "expect": "^enable$"
    },
    "custom_item_18": {
        "description": "SYMP-AG-000120 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful logon attempts occur - policy rules",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).",
        "solution": "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access and Web Authentication Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104193r1_rule,STIG-ID|SYMP-AG-000120,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94239",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_19": {
        "description": "SYMP-AG-000130 - Symantec ProxySG providing user access control intermediary services must generate audit records showing starting and ending time for user access to the system.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThis requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management).",
        "solution": "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access and Web Authentication Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104195r1_rule,STIG-ID|SYMP-AG-000130,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94241",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_20": {
        "description": "SYMP-AG-000140 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful attempts to access web resources occur.",
        "info": "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter). Security objects are data objects that are controlled by security policy and bound to security attributes.\n\nThis requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management).",
        "solution": "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access and Web Authentication Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104197r1_rule,STIG-ID|SYMP-AG-000140,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94243",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_21": {
        "description": "SYMP-AG-000150 - Symantec ProxySG must produce audit records containing information to establish what type of events occurred.",
        "info": "Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the gateway logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes the event type.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging. Check 'Enable Access Logging' and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the HTTP protocol ('main' by default).\n4. Click 'Formats,' select the Default Log from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the following variables:\n  cs-method\n  cs-protocol\n  cs-uri-scheme\n  cs-uri-path\n  cs-uri-query\n  sc-status\n  s-action\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000130,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104199r1_rule,STIG-ID|SYMP-AG-000150,SWIFT-CSCv1|6.4,Vuln-ID|V-94245",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*cs-method)(?=.*cs-protocol)(?=.*cs-uri-scheme)(?=.*cs-uri-path)(?=.*cs-uri-query)(?=.*sc-status)(?=.*s-action)"
    },
    "custom_item_22": {
        "description": "SYMP-AG-000160 - Symantec ProxySG must produce audit records containing information to establish when (date and time) the events occurred.",
        "info": "Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nIn order to compile an accurate risk assessment and provide forensic analysis of network traffic patterns, it is essential for security personnel to know when flow control events occurred within the infrastructure.\n\nAssociating event types with detected events in the network audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes the date/time of the event.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging. Check 'Enable Access Logging' and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the HTTP protocol ('main' by default).\n4. Click 'Formats,' select the Default Log from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the 'date' and 'time' variables.\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000131,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104201r1_rule,STIG-ID|SYMP-AG-000160,SWIFT-CSCv1|6.4,Vuln-ID|V-94247",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*time)(?=.*date)"
    },
    "custom_item_23": {
        "description": "SYMP-AG-000170 - Symantec ProxySG must produce audit records containing information to establish where the events occurred.",
        "info": "Without establishing where events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nIn order to compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as network element components, modules, device identifiers, node names, and functionality.\n\nAssociating information about where the event occurred within the network provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes where the event occurred.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration', click 'Access Logging', check 'Enable Access Logging', and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the HTTP protocol ('main' by default).\n4. Click 'Formats', select the 'Default Log' from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the following variables:\n  c-ip\n  r-ip\n  s-ip\n  s-supplier-country\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000132,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104203r1_rule,STIG-ID|SYMP-AG-000170,SWIFT-CSCv1|6.4,Vuln-ID|V-94249",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*c-ip)(?=.*r-ip)(?=.*s-ip)(?=.*s-supplier-country)"
    },
    "custom_item_24": {
        "description": "SYMP-AG-000180 - Symantec ProxySG must produce audit records containing information to establish the source of the events.",
        "info": "Without establishing the source of the event, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack. In order to compile an accurate risk assessment and provide forensic analysis, security personnel need to know the source of the event.\n\nIn addition to logging where events occur within the network, the audit records must also identify sources of events such as IP addresses, processes, and node or device names.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes the source of the event.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check 'Enable Access Logging' and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the HTTP protocol ('main' by default).\n4. Click 'Formats,' select the Default Log from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the 'c-ip' variable.\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000133,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104205r1_rule,STIG-ID|SYMP-AG-000180,SWIFT-CSCv1|6.4,Vuln-ID|V-94251",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*c-ip)"
    },
    "custom_item_25": {
        "description": "SYMP-AG-000190 - Symantec ProxySG must produce audit records containing information to establish the outcome of the events.",
        "info": "Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the network.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the network after the event occurred). They also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes information about the outcome of the event.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check 'Enable Access Logging' and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the HTTP protocol ('main' by default).\n4. Click 'Formats', select the Default Log from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the following variables:\n  s-action\n  rs-response-line\n  rs-status\n  sc-status\n  x-exception-reason\n duration\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-000134,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104207r1_rule,STIG-ID|SYMP-AG-000190,SWIFT-CSCv1|6.4,Vuln-ID|V-94253",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*s-action)(?=.*rs-response-line)(?=.*rs-status)(?=.*sc-status)(?=.*x-exception-reason)(?=.*duration)"
    },
    "custom_item_26": {
        "description": "SYMP-AG-000200 - Symantec ProxySG must generate audit records containing information to establish the identity of any individual or process associated with the event.",
        "info": "Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.\n\nAssociating information about where the event occurred within the network provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.\n\nThis requirement does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to log user web traffic for auditing that includes information to establish the identity of any individual or process associated with the event.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging. Check 'Enable Access Logging' and click 'Apply'.\n3. Browse to 'Access Logging', click 'General', and note which Default Log is indicated for the 'HTTP' protocol ('main' by default).\n4. Click 'Formats,' select the Default Log from step 3, and click 'Edit/View'.\n5. Edit the log format string to include at least the 'c-ip' and 'cs-username' variables.\n6. Click OK >> Apply.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-001487,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104209r1_rule,STIG-ID|SYMP-AG-000200,SWIFT-CSCv1|6.4,Vuln-ID|V-94255",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit format main ;mode",
        "regex": "type elff",
        "expect": ".*(?=.*c-ip)(?=.*cs-username)"
    },
    "custom_item_27": {
        "description": "SYMP-AG-000210 - Symantec ProxySG must use a centralized log server.",
        "info": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOff-loading is a common process in information systems with limited audit storage capacity.\n\nThis does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure audit log off-loading.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Access Logging >> Logs.\n3. Configure the 'Upload Client' and 'Upload Schedule' capabilities. (All client types use TCP for communication to the site's event server.)",
        "reference": "800-53|AU-4(1),800-53r5|AU-4(1),CAT|II,CCI|CCI-001851,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104211r1_rule,STIG-ID|SYMP-AG-000210,Vuln-ID|V-94257",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit log main ;mode",
        "regex": "client-type",
        "expect": "client-type"
    },
    "custom_item_28": {
        "description": "SYMP-AG-000220 - Symantec ProxySG must be configured to send the access logs to the centralized log server continuously.",
        "info": "Off-loading ensures audit information does not get overwritten if the limited audit storage capacity is reached and also protects the audit record in case the system/component being audited is compromised.\n\nOff-loading is a common process in information systems with limited audit storage capacity. The audit storage on the ALG is used only in a transitory fashion until the system can communicate with the centralized log server designated for storing the audit records, at which point the information is transferred. However, DoD requires that the log be transferred in real time, which indicates that the time from event detection to off-loading is seconds or less.\n\nThis does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure continuous audit log off-loading.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Access Logging >> Logs.\n3. Click 'Upload Schedule' and select 'Upload the access log continuously' option.\n4. Click 'Apply'.",
        "reference": "800-53|AU-4(1),800-53r5|AU-4(1),CAT|II,CCI|CCI-001851,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104213r1_rule,STIG-ID|SYMP-AG-000220,Vuln-ID|V-94259",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit log main ;mode",
        "regex": "continuous-upload",
        "expect": "continuous-upload enable"
    },
    "custom_item_29": {
        "description": "SNMP v1 disabled",
        "context": "snmp ;mode",
        "regex": "protocol snmpv1 disable",
        "expect": "protocol snmpv1 disable"
    },
    "custom_item_30": {
        "description": "SNMP v2c disabled",
        "context": "snmp ;mode",
        "regex": "protocol snmpv2c disable",
        "expect": "protocol snmpv2c disable"
    },
    "custom_item_31": {
        "description": "SNMP v3 disabled",
        "context": "snmp ;mode",
        "regex": "protocol snmpv3 disable",
        "expect": "protocol snmpv3 disable"
    },
    "custom_item_32": {
        "description": "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server - Server",
        "info": "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.\n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).\n\nThis does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to send real-time alerts via SMTP and SNMP.\n\n1. Log on to the Web Management Console.\n2. Browse to Maintenance >> SNMP.\n3. Check the 'Enable SNMPv3' box.\n4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.\n5. Browse to 'Event Logging'.\n6. Click 'Mail' and check the 'Send Event Logs' box.\n7. Click 'New' and add all desired recipients to the 'Names' list.\n8. Enter the correct SMTP server and port into the proper fields.\n9. Click 'Apply'.\n\nFor more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance.",
        "reference": "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|II,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,Vuln-ID|V-94261",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "smtp ;mode",
        "regex": "server",
        "expect": "server.*"
    },
    "custom_item_33": {
        "description": "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server - From",
        "info": "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.\n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).\n\nThis does not apply to audit logs generated on behalf of the device itself (management).",
        "solution": "Configure the ProxySG to send real-time alerts via SMTP and SNMP.\n\n1. Log on to the Web Management Console.\n2. Browse to Maintenance >> SNMP.\n3. Check the 'Enable SNMPv3' box.\n4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.\n5. Browse to 'Event Logging'.\n6. Click 'Mail' and check the 'Send Event Logs' box.\n7. Click 'New' and add all desired recipients to the 'Names' list.\n8. Enter the correct SMTP server and port into the proper fields.\n9. Click 'Apply'.\n\nFor more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance.",
        "reference": "800-171|3.3.4,800-53|AU-5(2),800-53r5|AU-5(2),CAT|II,CCI|CCI-001858,CN-L3|7.1.3.3(e),CSF|PR.PT-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-5(2),NESA|T3.6.2,NIAv2|GS7f,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,Vuln-ID|V-94261",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "smtp ;mode",
        "regex": "from",
        "expect": "from.*"
    },
    "custom_item_34": {
        "description": "SYMP-AG-000240 - The reverse proxy Symantec ProxySG providing intermediary services for FTP must inspect inbound FTP communications traffic for protocol compliance and protocol anomalies - Review Proxies",
        "info": "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nBecause protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure FTP reverse proxy intermediary services.\n\nSee the ProxySG Reverse Proxy WebGuide for details.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Services >> Proxy Services.\n3. Click 'New Service' and create new FTP proxy services with the Action set to 'intercept'.\n4. Browse to Configuration >> Forwarding Hosts. Click 'New' and create an entry for the desired back-end FTP server. Click 'Apply'.\n5. Browse to Policy >> Visual Policy Manager and click 'Launch'.\n6. Click Policy >> Add Forwarding Layer. In the default rule, set the Action to be the Forwarding Host configured in step 4.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104217r1_rule,STIG-ID|SYMP-AG-000240,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94263",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_35": {
        "description": "SYMP-AG-000240 - The reverse proxy Symantec ProxySG providing intermediary services for FTP must inspect inbound FTP communications traffic for protocol compliance and protocol anomalies - Forwarding Host",
        "info": "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nBecause protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure FTP reverse proxy intermediary services.\n\nSee the ProxySG Reverse Proxy WebGuide for details.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Services >> Proxy Services.\n3. Click 'New Service' and create new FTP proxy services with the Action set to 'intercept'.\n4. Browse to Configuration >> Forwarding Hosts. Click 'New' and create an entry for the desired back-end FTP server. Click 'Apply'.\n5. Browse to Policy >> Visual Policy Manager and click 'Launch'.\n6. Click Policy >> Add Forwarding Layer. In the default rule, set the Action to be the Forwarding Host configured in step 4.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104217r1_rule,STIG-ID|SYMP-AG-000240,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94263",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show forwarding",
        "regex": "^[\\s]*@FTP_SERVER@[\\s]*",
        "expect": "^[\\s]*@FTP_SERVER@[\\s]*"
    },
    "custom_item_36": {
        "description": "SYMP-AG-000240 - The reverse proxy Symantec ProxySG providing intermediary services for FTP must inspect inbound FTP communications traffic for protocol compliance and protocol anomalies - Policy Rules",
        "info": "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nBecause protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.",
        "solution": "Configure FTP reverse proxy intermediary services.\n\nSee the ProxySG Reverse Proxy WebGuide for details.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Services >> Proxy Services.\n3. Click 'New Service' and create new FTP proxy services with the Action set to 'intercept'.\n4. Browse to Configuration >> Forwarding Hosts. Click 'New' and create an entry for the desired back-end FTP server. Click 'Apply'.\n5. Browse to Policy >> Visual Policy Manager and click 'Launch'.\n6. Click Policy >> Add Forwarding Layer. In the default rule, set the Action to be the Forwarding Host configured in step 4.\n7. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104217r1_rule,STIG-ID|SYMP-AG-000240,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94263",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Action:Action: Nothing Found",
        "regex": "Action:",
        "expect": "Action: @FORWARDING_LIST_NAME@"
    },
    "custom_item_37": {
        "description": "SYMP-AG-000250 - Symantec ProxySG providing intermediary services for FTP must inspect outbound FTP communications traffic for protocol compliance and protocol anomalies.",
        "info": "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.",
        "solution": "Enable outbound FTP proxying to inspect this traffic for compliance and anomalies.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Click the 'Standard', 'Predefined Service Group' and set FTP service to 'Intercept'.\n4. Click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104219r1_rule,STIG-ID|SYMP-AG-000250,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94265",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"FTP\" ;mode",
        "regex": "intercept",
        "expect": "intercept.*"
    },
    "custom_item_38": {
        "description": "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies - Explicit",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nAll inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94267",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"Explicit HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_39": {
        "description": "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies - External",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nAll inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94267",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"External HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_40": {
        "description": "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies - Internal",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nAll inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94267",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"Internal HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_41": {
        "description": "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies - Explicit",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94269",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"Explicit HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_42": {
        "description": "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies - Internal",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94269",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"Internal HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_43": {
        "description": "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies - External",
        "info": "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.\n\nSince protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.\n\nFix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)\n1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.\n2. Using '-F', perform a search for the exact terms 'detect_protocol(no)'.\n3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.\n\nFix 2\n1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click 'Edit Service'.\n2. Select the 'Detect Protocol' checkbox and click 'OK'.\n3. Once all services have been modified, click 'Apply'.",
        "reference": "800-171|3.4.2,800-171|3.13.1,800-53|CM-6b.,800-53|SC-7(17),800-53r5|CM-6b.,800-53r5|SC-7(17),CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CN-L3|8.1.10.6(j),CSF|PR.IP-1,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-6b.,ITSG-33|SC-7(17),NESA|T3.2.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,SWIFT-CSCv1|2.3,TBA-FIISB|43.1,Vuln-ID|V-94269",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit \"External HTTP\" ;mode",
        "regex": "attribute detect-protocol enable",
        "expect": "attribute detect-protocol enable"
    },
    "custom_item_44": {
        "description": "SYMP-AG-000280 - Symantec ProxySG must not have unnecessary services and functions enabled.",
        "info": "Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the ALG. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nThe primary function of an ALG is to provide application-specific content filtering and/or proxy services. The ALG application suite may integrate related content filtering and analysis services and tools (e.g., IPS, proxy, malware inspection, blacklists, whitelists). Some gateways may also include email scanning, decryption, caching, and DLP services. However, services and capabilities that are unrelated to this primary functionality must not be installed (e.g., DNS, email client or server, FTP server, or web server).\n\nNext Generation ALGs (NGFW) and Unified Threat Management (UTM) ALGs integrate functions that have been traditionally separated. These products integrate content filtering features to provide more granular policy filtering. There may be operational drawbacks to combining these services into one device. Another issue is that NGFW and UTM products vary greatly with no current definitive industry standard.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Disable/remove unnecessary proxy services on the ProxySG. In particular, reverse proxy services should not configured if not used.\n\n1. Log on to the Web Management Console\n2. Browse to Configuration >> Services >> Proxy Services\n3. Review each service and service group specified in the list with the ProxySG administrator.\n4. Remove any unnecessary services or service groups by selecting them and clicking 'Delete'\n5. Click 'Apply' once all unnecessary services or groups have been removed.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-104225r1_rule,STIG-ID|SYMP-AG-000280,SWIFT-CSCv1|2.3,Vuln-ID|V-94271",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_45": {
        "description": "SYMP-AG-000290 - Symantec ProxySG must be configured to remove or disable unrelated or unneeded application proxy services.",
        "info": "Unrelated or unneeded proxy services increase the attack vector and add excessive complexity to the securing of the ALG. Multiple application proxies can be installed on many ALGs. However, proxy types must be limited to related functions. At a minimum, the web and email gateway represent different security domains/trust levels. Organizations should also consider separation of gateways that service the DMZ and the trusted network.\n\nPossible services that may be configured on the ProxySG:\nAOL IM\nDNS Proxy\nFTP\nFTPS\nHTTPS\nHTTPS Reverse Proxy\nMMS\nMSN IM\nRMTP\nRTSP\nSOCKS\nTLS\nTCP Tunnel\nTELNET\nYahoo IM\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Disable/remove unnecessary proxy services on the ProxySG. In particular, reverse proxy services should not configured if not used.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Review each service and service group specified in the list with the ProxySG administrator.\n4. Remove any unnecessary services or service groups by selecting them and clicking 'delete'.\n5. Click 'Apply' once all unnecessary services or groups have been removed.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-104227r1_rule,STIG-ID|SYMP-AG-000290,SWIFT-CSCv1|2.3,Vuln-ID|V-94273",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "proxy-services ;mode",
        "regex": "edit.*mode",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_46": {
        "description": "SYMP-AG-000300 - Symantec ProxySG must be configured to prohibit or restrict the use of network services as defined in the PPSM CAL and vulnerability assessments. - Source",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nALGs are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. DoD continually assesses the ports, protocols, and services that can be used for network communications. Some ports, protocols, and services have known exploits or security weaknesses. Network traffic using these ports, protocols, and services must be prohibited or restricted in accordance with DoD policy. The ALG is a key network element for preventing these noncompliant ports, protocols, and services from causing harm to DoD information systems.\n\nThe network ALG must be configured to prevent or restrict the use of prohibited ports, protocols, and services throughout the network by filtering the network traffic and disallowing or redirecting traffic as necessary. Default and updated policy filters from the vendors will disallow older versions of protocols and applications and will address most known nonsecure ports, protocols, and/or services. However, sources for further policy filters are the IAVMs and the PPSM requirements.",
        "solution": "Obtain the SSP and PPSMCAL and vulnerability assessments with the site's security policy. Configure the ProxySG to perform resources by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'.\n4. For each Web Access Layer that is configured, right-click the 'Source' and 'destination' of each column and click 'Set'.\n5. Select the users, groups, roles, ports, protocols, and attributes as required by the PPSMCAL.\n6. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|I,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-104229r1_rule,STIG-ID|SYMP-AG-000300,SWIFT-CSCv1|2.3,Vuln-ID|V-94275",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Source:Source: Nothing Found",
        "not_expect": "Source: Any"
    },
    "custom_item_47": {
        "description": "SYMP-AG-000300 - Symantec ProxySG must be configured to prohibit or restrict the use of network services as defined in the PPSM CAL and vulnerability assessments. - Destination",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nALGs are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. DoD continually assesses the ports, protocols, and services that can be used for network communications. Some ports, protocols, and services have known exploits or security weaknesses. Network traffic using these ports, protocols, and services must be prohibited or restricted in accordance with DoD policy. The ALG is a key network element for preventing these noncompliant ports, protocols, and services from causing harm to DoD information systems.\n\nThe network ALG must be configured to prevent or restrict the use of prohibited ports, protocols, and services throughout the network by filtering the network traffic and disallowing or redirecting traffic as necessary. Default and updated policy filters from the vendors will disallow older versions of protocols and applications and will address most known nonsecure ports, protocols, and/or services. However, sources for further policy filters are the IAVMs and the PPSM requirements.",
        "solution": "Obtain the SSP and PPSMCAL and vulnerability assessments with the site's security policy. Configure the ProxySG to perform resources by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'.\n4. For each Web Access Layer that is configured, right-click the 'Source' and 'destination' of each column and click 'Set'.\n5. Select the users, groups, roles, ports, protocols, and attributes as required by the PPSMCAL.\n6. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|I,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-104229r1_rule,STIG-ID|SYMP-AG-000300,SWIFT-CSCv1|2.3,Vuln-ID|V-94275",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_48": {
        "description": "Radius In Use",
        "regex": "security radius edit-realm .* ;mode",
        "expect": "security radius edit-realm .* ;mode"
    },
    "custom_item_49": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - RADIUS",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security radius edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_50": {
        "description": "LDAP In Use",
        "regex": "security ldap edit-realm .* ;mode",
        "expect": "security ldap edit-realm .* ;mode"
    },
    "custom_item_51": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - LDAP",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security ldap edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_52": {
        "description": "XML In Use",
        "regex": "security xml edit-realm .* ;mode",
        "expect": "security xml edit-realm .* ;mode"
    },
    "custom_item_53": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - xml",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security xml edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_54": {
        "description": "IWA In Use",
        "regex": "security iwa-bcaaa edit-realm .* ;mode",
        "expect": "security iwa-bcaaa edit-realm .* ;mode"
    },
    "custom_item_55": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - iwa",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security iwa-bcaaa edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_56": {
        "description": "siteminder In Use",
        "regex": "security siteminder edit-realm .* ;mode",
        "expect": "security siteminder edit-realm .* ;mode"
    },
    "custom_item_57": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - siteminder",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security siteminder edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_58": {
        "description": "coreid In Use",
        "regex": "security coreid edit-realm .* ;mode",
        "expect": "security coreid edit-realm .* ;mode"
    },
    "custom_item_59": {
        "description": "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication - coreid",
        "info": "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nIn addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:\n\n1. When authenticators change\n2. When roles change\n3. When security categories of information systems change\n4. When the execution of privileged functions occurs\n5. After a fixed period of time\n6. Periodically\n\nWithin the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).",
        "solution": "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to the organization-defined time period.\n5. Click 'Apply'.",
        "reference": "800-53|IA-11,800-53r5|IA-11,CAT|II,CCI|CCI-002038,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),QCSC-v1|13.2,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security coreid edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_60": {
        "description": "SYMP-AG-000320 - Symantec ProxySG must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users) - Domain Exists",
        "info": "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.\n\nBy default, the ProxySG operates as an un-authenticated proxy. Authentication of users must be explicitly configured as described here and in in the ProxySG Administration Guide, Chapter 49: Controlling Access to the Internet and Intranet.",
        "solution": "Configure the ProxySG to perform unique identification of organizational users.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104233r1_rule,STIG-ID|SYMP-AG-000320,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94279",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": "create",
        "expect": "create.*"
    },
    "custom_item_61": {
        "description": "SYMP-AG-000320 - Symantec ProxySG must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users) - Domain Joined",
        "info": "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.\n\nBy default, the ProxySG operates as an un-authenticated proxy. Authentication of users must be explicitly configured as described here and in in the ProxySG Administration Guide, Chapter 49: Controlling Access to the Internet and Intranet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to perform unique identification of organizational users.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104233r1_rule,STIG-ID|SYMP-AG-000320,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94279",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_62": {
        "description": "SYMP-AG-000330 - Symantec ProxySG must be configured with a pre-established trust relationship and mechanisms with appropriate authorities that validate user account access authorizations and privileges - Domain Exists",
        "info": "User account and privilege validation must be centralized to prevent unauthorized access using changed or revoked privileges.\n\nALGs can implement functions such as traffic filtering, authentication, access, and authorization functions based on computer and user privileges. However, the directory service (e.g., Active Directory or LDAP) must not be installed on the ALG, particularly if the gateway resides on the untrusted zone of the enclave.",
        "solution": "Configure the ProxySG with pre-established trust relationships with the appropriate authorities.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104235r1_rule,STIG-ID|SYMP-AG-000330,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94281",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": "create",
        "expect": "create.*"
    },
    "custom_item_63": {
        "description": "SYMP-AG-000330 - Symantec ProxySG must be configured with a pre-established trust relationship and mechanisms with appropriate authorities that validate user account access authorizations and privileges - Domain joined",
        "info": "User account and privilege validation must be centralized to prevent unauthorized access using changed or revoked privileges.\n\nALGs can implement functions such as traffic filtering, authentication, access, and authorization functions based on computer and user privileges. However, the directory service (e.g., Active Directory or LDAP) must not be installed on the ALG, particularly if the gateway resides on the untrusted zone of the enclave.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG with pre-established trust relationships with the appropriate authorities.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104235r1_rule,STIG-ID|SYMP-AG-000330,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94281",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_64": {
        "description": "SYMP-AG-000340 - Symantec ProxySG providing user authentication intermediary services must restrict user authentication traffic to specific authentication servers - Domain exists",
        "info": "User authentication can be used as part of the policy filtering rule sets. Some URLs or network resources can be restricted to authenticated users only. Users are prompted by the application or browser for credentials. Authentication service may be provided by the ProxySG as an intermediary for the application; however, the authentication credential must be stored in the site's directory services server.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., proxy capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).\n\nThe ProxySG will not use any other authentication server that has not been explicitly configured, such as the primary and backup authentication servers.",
        "solution": "Configure the ProxySG for user authentication.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104237r1_rule,STIG-ID|SYMP-AG-000340,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94283",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": "create",
        "expect": "create.*"
    },
    "custom_item_65": {
        "description": "SYMP-AG-000340 - Symantec ProxySG providing user authentication intermediary services must restrict user authentication traffic to specific authentication servers - Domain joined",
        "info": "User authentication can be used as part of the policy filtering rule sets. Some URLs or network resources can be restricted to authenticated users only. Users are prompted by the application or browser for credentials. Authentication service may be provided by the ProxySG as an intermediary for the application; however, the authentication credential must be stored in the site's directory services server.\n\nThis requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., proxy capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).\n\nThe ProxySG will not use any other authentication server that has not been explicitly configured, such as the primary and backup authentication servers.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG for user authentication.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication >> Windows Domain.\n3. Click 'Add New Domain' and follow prompts to join the Windows Domain.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104237r1_rule,STIG-ID|SYMP-AG-000340,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94283",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security windows-domains ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_66": {
        "description": "SYMP-AG-000380 - Symantec ProxySG providing user authentication intermediary services must implement replay-resistant authentication mechanisms for network access to nonprivileged accounts.",
        "info": "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.\n\nA nonprivileged account is any account with the authorizations of a nonprivileged user. Privileged roles are organization-defined roles assigned to individuals that allow those individuals to perform certain security-relevant functions that ordinary users are not authorized to perform. Security-relevant roles include key management, account management, network and system administration, database administration, and web administration.\n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one time use) or challenges (e.g., TLS). Additional techniques include time-synchronous or challenge-response one-time authenticators.",
        "solution": "Configure the ProxySG to use only FIPS-compliant HMAC algorithms.\n\n1. Log on to the ProxySG SSH CLI.\n2. Type 'enable' and enter the enable password.\n3. Type 'configure terminal' and press 'Enter'.\n4. Type 'management-services,' press 'Enter'. Type 'edit HTTPS-Console' and press 'Enter'.\n5. Type 'view' to display the list of configured cipher suites.\n6. Type 'attribute cipher-suite' followed by a space-delimited list of only cipher suites from step 5 that use FIPS-compliant HMAC algorithms.\n7. Press 'Enter'.",
        "reference": "800-171|3.5.4,800-53|IA-2(9),800-53r5|IA-2(8),CAT|II,CCI|CCI-001942,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(9),NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM18,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104245r1_rule,STIG-ID|SYMP-AG-000380,SWIFT-CSCv1|4.2,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-94291",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show management-services",
        "regex": "Cipher Suite",
        "expect": "@APPROVED_CIPHERS@"
    },
    "custom_item_67": {
        "description": "Radius In Use",
        "regex": "security radius edit-realm .* ;mode",
        "expect": "security radius edit-realm .* ;mode"
    },
    "custom_item_68": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - RADIUS",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security radius edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_69": {
        "description": "LDAP In Use",
        "regex": "security ldap edit-realm .* ;mode",
        "expect": "security ldap edit-realm .* ;mode"
    },
    "custom_item_70": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - LDAP",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security ldap edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_71": {
        "description": "XML In Use",
        "regex": "security xml edit-realm .* ;mode",
        "expect": "security xml edit-realm .* ;mode"
    },
    "custom_item_72": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - xml",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security xml edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_73": {
        "description": "IWA In Use",
        "regex": "security iwa-bcaaa edit-realm .* ;mode",
        "expect": "security iwa-bcaaa edit-realm .* ;mode"
    },
    "custom_item_74": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - iwa",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security iwa-bcaaa edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_75": {
        "description": "siteminder In Use",
        "regex": "security siteminder edit-realm .* ;mode",
        "expect": "security siteminder edit-realm .* ;mode"
    },
    "custom_item_76": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - siteminder",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security siteminder edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_77": {
        "description": "coreid In Use",
        "regex": "security coreid edit-realm .* ;mode",
        "expect": "security coreid edit-realm .* ;mode"
    },
    "custom_item_78": {
        "description": "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum - coreid",
        "info": "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.\n\nThis requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click each of the above authentication mechanisms and select the 'General' tab (e.g., Radius General or LDAP General).\n4. Set the 'Credential Refresh' time to 300 at a minimum.\n5. Click 'Apply'.",
        "reference": "800-171|3.5.2,800-53|IA-5(13),800-53r5|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security coreid edit-realm .* ;mode",
        "regex": "refresh-time credential-refresh",
        "expect": "refresh-time credential-refresh @CREDENTIAL_REFRESH_TIME@"
    },
    "custom_item_79": {
        "description": "SYMP-AG-000410 - Symantec ProxySG, when configured for reverse proxy/WAF services and providing PKI-based user authentication intermediary services, must map the client certificate to the authentication server store.",
        "info": "Authorization for access to any network element requires an approved and assigned individual account identifier. To ensure only the assigned individual is using the account, the account must be bound to a user certificate when PKI-based authentication is implemented.\n\nThis requirement applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). It does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Configure the ProxySG to map PKI user credentials to user identities in a reverse proxy configuration.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Click each HTTPS Reverse Proxy service and click 'Edit Service'.\n4. Check the 'Verify Client' option and click 'Apply'.\n5. Configure all remaining options in accordance with the site's SSP.",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(c),800-53r5|IA-5(2)(c),CAT|II,CCI|CCI-000187,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(c),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104249r1_rule,STIG-ID|SYMP-AG-000410,Vuln-ID|V-94295",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services services name @HTTPS_REVERSE_PROXY@",
        "regex": "^[\\s]*Attributes:[\\s]*",
        "expect": "^[\\s]*Attributes:.*verify-client-cert.*"
    },
    "custom_item_80": {
        "description": "SYMP-AG-000420 - Symantec ProxySG providing user authentication intermediary services using PKI-based user authentication must implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network.",
        "info": "Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nThe intent of this requirement is to require support for a secondary certificate validation method using a locally cached revocation data, such as Certificate Revocation List (CRL), in case access to OCSP (required by CCI-000185) is not available. Based on a risk assessment, an alternate mitigation is to configure the system to deny access when revocation data is unavailable.\n\nThis requirement applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management).",
        "solution": "Configure PKI Certificate Revocation lists.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> SSL >> CRLs.\n3. Click 'New' and configure in accordance the setting required by site guidance.",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(d),800-53r5|IA-5(2)(d),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104251r1_rule,STIG-ID|SYMP-AG-000420,Vuln-ID|V-94297",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "ssl ;mode",
        "regex": "create crl",
        "expect": "create crl.*"
    },
    "custom_item_81": {
        "description": "SYMP-AG-000430 - Symantec ProxySG providing user authentication intermediary services must conform to Federal Identity, Credential, and Access Management (FICAM)-issued profiles.",
        "info": "Without conforming to FICAM-issued profiles, the information system may not be interoperable with FICAM-authentication protocols, such as SAML 2.0 and OpenID 2.0.\n\nUse of FICAM-issued profiles addresses open identity management standards.\n\nThis only applies to components where this is specific to the function of the device or has the concept of a nonorganizational user (e.g., ALG capability that is the front end for an application in a DMZ).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure ProxySG to conform to a FICAM-authentication protocol and configure it to use SAML authentication.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. Click 'SAML' and configure.",
        "reference": "800-53|IA-8(4),800-53r5|IA-8(4),CAT|II,CCI|CCI-002014,CSF|PR.AC-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T4.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-104253r1_rule,STIG-ID|SYMP-AG-000430,SWIFT-CSCv1|2.8,Vuln-ID|V-94299",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "security saml edit-realm .* ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_82": {
        "description": "SYMP-AG-000440 - Symantec ProxySG must terminate all network connections associated with a communications session at the end of the session or terminate user sessions (nonprivileged session) after 15 minutes of inactivity.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the ProxySG.\n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level and deallocating networking assignments at the application level if multiple application sessions are using a single operating system level network connection.\n\nALGs may provide session control functionality as part of content filtering, load balancing, or proxy services. Symantec ProxySG manages sessions automatically and terminates them once they become idle. The idle period is governed by parameters such as the TCP segment lifetime (default is 120 seconds) and authentication credential inactivity timeout (default is 900 seconds for all authentication types).",
        "solution": "Configure the two user-configurable parameters that affect session termination (TCP segment lifetime and authentication credential inactivity timeout).\n\nConfigure the TCP segment lifetime setting (default is 120 seconds).\n1. SSH into the ProxySG console and type 'enable' and then 'configure'.\n2. Type 'tcp-ip tcp 2msl 900', for example, to set the timeout to 900 seconds (the default).\n\nConfigure the authentication credential inactivity timeouts.\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Authentication.\n3. For each authentication method listed, click it and then the 'General' tab and set the 'Inactivity timeout' to 600 seconds or less (default is 900 seconds).\n4. Click 'Apply'.",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|I,CCI|CCI-001133,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-104255r1_rule,STIG-ID|SYMP-AG-000440,SWIFT-CSCv1|2.6,Vuln-ID|V-94301",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show tcp-ip",
        "regex": "TCP 2MSL timeout:",
        "expect": "TCP 2MSL timeout: ([0-9]|[0-9][0-9]|0-5][0-9][0-9]|600)[\\s]*$"
    },
    "custom_item_83": {
        "description": "SYMP-AG-000450 - Symantec ProxySG providing forward proxy encryption intermediary services must use NIST FIPS-validated cryptography to implement encryption services. - Source",
        "info": "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.\n\nThis requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC).",
        "solution": "Configure TLS intermediary services to comply with NIST FIPS-validated cryptography.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all NIST FIPS-validated SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4-9 for the 'Destination' field using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-104257r1_rule,STIG-ID|SYMP-AG-000450,Vuln-ID|V-94303",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Source:Source: Nothing Found",
        "not_expect": "Source: Any"
    },
    "custom_item_84": {
        "description": "SYMP-AG-000450 - Symantec ProxySG providing forward proxy encryption intermediary services must use NIST FIPS-validated cryptography to implement encryption services. - Destination",
        "info": "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.\n\nThis requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC).",
        "solution": "Configure TLS intermediary services to comply with NIST FIPS-validated cryptography.\n\n1. Log on to the Web Management Console.\n2. Click Configuration >> Visual Policy Manager.\n3. Click 'Launch'. While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.\n4. Right-click the 'Source' field of the existing rule and select 'Set'. Click 'New' and select 'Combined Source Object'.\n5. Click 'New' and select 'Client Negotiated Cipher'. Select all ciphers that should be permitted and click 'OK'.\n6. Click the upper 'Add' button and click the 'Negate' checkbox.\n7. Click 'New' and select 'Client Negotiated SSL Version'. Select all NIST FIPS-validated SSL versions that should be permitted and click 'OK'.\n8. Click the upper 'Add' button.\n9. Click 'OK' and then 'OK' again.\n10. Repeat steps 4-9 for the 'Destination' field using the 'Server Negotiated Cipher' and 'Server Negotiated SSL Version' objects.\n11. Right-click the 'Action' field of the rule, click 'Set', and select 'Deny'.\n12. Click File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2,Rule-ID|SV-104257r1_rule,STIG-ID|SYMP-AG-000450,Vuln-ID|V-94303",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Destination:Destination: Nothing Found",
        "not_expect": "Destination: Any"
    },
    "custom_item_85": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - DoS incidents are detected. Rules",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "Track:",
        "expect": "Track: Email.*",
        "MEDIUMdescription": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Rules",
        "context": "",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_86": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - DoS incidents are detected. Rules",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "Track:",
        "expect": "Track: Email.*",
        "MEDIUMdescription": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Rules",
        "context": "",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_87": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - DoS incidents are detected. Rules",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "Track:",
        "expect": "Track: Email.*",
        "MEDIUMdescription": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Rules",
        "context": "",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_88": {
        "description": "SYMP-AG-000490 - Symantec ProxySG must use Transport Layer Security (TLS) to protect the authenticity of communications sessions.",
        "info": "Authenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThis requirement focuses on communications protection for the application session rather than for the network packet and establishes grounds for confidence at both ends of communications sessions in ongoing identities of other parties and in the validity of information transmitted. Depending on the required degree of confidentiality and integrity, web services/SOA will require the use of mutual authentication (two-way/bidirectional).",
        "solution": "Configure the ProxySG to use only FIPS-compliant HMAC algorithms.\n\n1. Log on to the ProxySG SSH CLI.\n2. Type 'enable' and enter the enable password.\n3. Type 'configure terminal' and press 'Enter'.\n 4. Type 'management-services' and press 'Enter'. Type 'edit HTTPS-Console' and press 'Enter'.\n 5. Type 'view' to display the list of configured cipher suites.\n 6. Type 'attribute cipher-suite' followed by a space-delimited list of only cipher suites from step 5 that use FIPS-compliant HMAC algorithms and press 'Enter'.",
        "reference": "800-171|3.13.15,800-53|SC-23,800-53r5|SC-23,CAT|I,CCI|CCI-001184,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-104265r1_rule,STIG-ID|SYMP-AG-000490,Vuln-ID|V-94311",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": "Cipher Suite",
        "expect": "@APPROVED_CIPHERS@"
    },
    "custom_item_89": {
        "description": "SYMP-AG-000500 - If reverse proxy is used for validating and restricting certs from external entities, and this function is required by the SSP, Symantec ProxySG providing user authentication intermediary services using PKI-based user authentication must only accept end entity certificates issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) for the establishment of protected sessions.",
        "info": "Non-DoD-approved PKIs have not been evaluated to ensure they have security controls and identity vetting procedures in place that are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.\n\nThe authoritative list of DoD-approved PKIs is published at http://iase.disa.mil/pki-pke/interoperability. DoD-approved PKI CAs may include Category I, II, and III certificates. Category I DoD-Approved External PKIs are PIV issuers. Category II DoD-Approved External PKIs are Non-Federal Agency PKIs cross-certified with the Federal Bridge Certification Authority (FBCA). Category III DoD-Approved External PKIs are Foreign, Allied, or Coalition Partner PKIs.\n\nDeploying the ALG with TLS enabled will require the installation of DoD and/or DoD-Approved CA certificates in the trusted root certificate store of each proxy to be used for TLS traffic.\n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure reverse proxy services to only trust DoD-approved Certificate Authorities.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Browse to SSL >> CA Certificates >> CA Certificate Lists.\n4. Click 'Import,' provide a 'Name,' and paste in the first DoD CA certificate in PEM format and click 'OK'. Repeat for each DoD CA certificate desired.\n5. Click CA Certificate Lists >> New.\n6. Provide a 'Name,' click each DoD CA certificate created in step 4, and click 'Add'. Once all certificates have been added, click 'OK'.\n7. Browse to Configuration >> Services >> Proxy Services.\n8. Select each HTTPS Reverse Proxy service and click 'Edit Service'.\n9. Select the CCL created in step 6, click 'OK,' and then click 'Apply'.",
        "reference": "800-171|3.13.15,800-53|SC-23(5),800-53r5|SC-23(5),CAT|II,CCI|CCI-002470,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-104267r1_rule,STIG-ID|SYMP-AG-000500,Vuln-ID|V-94313",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_90": {
        "description": "SYMP-AG-000510 - Symantec ProxySG must fail to a secure state upon failure of initialization, shutdown, or abort actions.",
        "info": "Failure to a known safe state helps prevent systems from failing to a state that may cause loss of data or unauthorized access to system resources. Network elements that fail suddenly and with no incorporated failure state planning may leave the hosting system available but with a reduced security protection capability. Preserving system state information also facilitates system restart and return to the operational mode of the organization with less disruption to mission-essential processes.\n\nAn example is a firewall that blocks all traffic rather than allowing all traffic when a firewall component fails (e.g., fail closed and do not forward traffic). This prevents an attacker from forcing a failure of the system to obtain access.\n\nDepending on the deployment architecture, there are many configurations to check external to the ProxySG to ensure that failures of initialization, shutdown, or abort actions result in a secure state. With these external configurations in place, the ProxySG meets this requirement inherently. However, if a ProxySG hardware appliance is configured in a transparent, physically in-path manner, the check and fix apply.",
        "solution": "Configure the transparent, physically in-line hardware ProxySG appliance to fail securely in the event of failures of initialization, shutdown, or abort actions.\n\n1. Browse to Configuration >> Network >> Adapters >> Bridges.\n2. Select the appropriate bridge-pair (whichever is in use) and click 'Edit'.\n3. Select the 'fail-closed' radio button and click 'Apply'.",
        "reference": "800-53|SC-24,800-53r5|SC-24,CAT|II,CCI|CCI-001190,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-24,ITSG-33|SC-24a.,QCSC-v1|5.2.1,Rule-ID|SV-104269r1_rule,STIG-ID|SYMP-AG-000510,Vuln-ID|V-94315",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "bridge ;mode",
        "regex": "mode",
        "expect": "mode fail-closed"
    },
    "custom_item_91": {
        "description": "SYMP-AG-000520 - Symantec ProxySG providing content filtering must protect against known and unknown types of denial-of-service (DoS) attacks by employing rate-based attack prevention behavior analysis.",
        "info": "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users.\n\nInstallation of content filtering gateways and application layer firewalls at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.\n\nDetection components that use rate-based behavior analysis can detect attacks when signatures for the attack do not exist or are not installed. These attacks include zero-day attacks, which are new attacks for which vendors have not yet developed signatures. Rate-based behavior analysis can detect sophisticated, Distributed DoS (DDoS) attacks by correlating traffic information from multiple network segments or components.",
        "solution": "Configure denial-of-service attack detection/mitigation.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. Type 'client', press 'Enter', type 'enable-limits', and press 'Enter'.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-104271r1_rule,STIG-ID|SYMP-AG-000520,Vuln-ID|V-94317",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "client limits enabled",
        "expect": "client limits enabled:[\\s]*true"
    },
    "custom_item_92": {
        "description": "SYMP-AG-000530 - Symantec ProxySG must implement load balancing to limit the effects of known and unknown types of denial-of-service (DoS) attacks.",
        "info": "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users. Load balancing provides service redundancy, which reduces the susceptibility of the ALG to many DoS attacks.\n\nThe ALG must be configured to prevent or mitigate the impact on network availability and traffic flow of DoS attacks that have occurred or are ongoing.\n\nThis requirement applies to the network traffic functionality of the device as it pertains to handling network traffic. Some types of attacks may be specialized to certain network technologies, functions, or services. For each technology, known and potential DoS attacks must be identified and solutions for each type implemented.\n\nFor detailed information, see the ProxySG Administration Guide, Chapter 39: Configuring Failover.",
        "solution": "Configure redundancy on the ProxySG.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Network >> Advanced.\n3. Select the 'Failover' tab and configure using the SSP requirements.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-104273r1_rule,STIG-ID|SYMP-AG-000530,Vuln-ID|V-94319",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "failover ;mode",
        "regex": "enable",
        "expect": "enable"
    },
    "custom_item_93": {
        "description": "SYMP-AG-000540 - Symantec ProxySG must block outbound traffic containing known and unknown denial-of-service (DoS) attacks to protect against the use of internal information systems to launch any DoS attacks against other networks or endpoints.",
        "info": "DoS attacks can take multiple forms but have the common objective of overloading or blocking a network or host to deny or seriously degrade performance. If the network does not provide safeguards against DoS attack, network resources will be unavailable to users.\n\nInstallation of an ALG at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.\n\nThe ALG must include protection against DoS attacks that originate from inside the enclave that can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave. These attacks can be simple 'floods' of traffic to saturate circuits or devices, malware that consumes CPU and memory on a device or causes it to crash, or a configuration issue that disables or impairs the proper function of a device. For example, an accidental or deliberate misconfiguration of a routing table can misdirect traffic for multiple networks.\n\nThe appliance can reduce the effects of DoS and distributed-DoS (DDoS) attacks. DoS and DDoS attacks occur when one or more machines coordinate an attack on a specific website to cripple or disrupt host services. As the attack progresses, the target host shows decreased responsiveness and often stops responding. Legitimate HTTP traffic is unable to proceed because the infected system no longer has the resources to process new requests.\n\nProxySG appliances prevent attacks by limiting the number of simultaneous TCP connections and/or excessive repeated requests from each client IP address that can be established within a specified time frame. If these limits are met, the appliance either does not respond to connection attempts from a client already at this limit or resets the connection. It can also be configured to limit the number of active connections to prevent server overloading.\n\nIf the appliance starts seeing a large number of failed requests, and that number exceeds the configured error limit, subsequent requests are blocked and the proxy returns a warning page.\n\nFailed requests, by default, include various HTTP response failures such as 4xx client errors (excluding 401 and 407) and 5xx server errors. The HTTP responses that should be treated as failures can be defined by creating policy.\n\nIf the requests continue despite the warnings, and the rate exceeds the warning limits that have been specified for the client, the client is then blocked at the TCP level.",
        "solution": "Enable the Attack Detection function.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'configure terminal'.\n3. Press 'Enter' and type 'attack-detection'.\n4. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n\nNote: See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding. Fine-tune the default client limits if there is an operational impact.",
        "reference": "800-53|SC-5(1),800-53r5|SC-5(1),CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(1),NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-104275r1_rule,STIG-ID|SYMP-AG-000540,Vuln-ID|V-94321",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "client limits enabled",
        "expect": "client limits enabled:[\\s]*true"
    },
    "custom_item_94": {
        "description": "SYMP-AG-000550 - Symantec ProxySG must allow incoming communications only from organization-defined authorized sources routed to organization-defined authorized destinations - Proxy Services",
        "info": "Unrestricted traffic may contain malicious traffic that poses a threat to an enclave or to other connected networks. Additionally, unrestricted traffic may transit a network, which uses bandwidth and other resources.\n\nAccess control policies and access control lists implemented on devices that control the flow of network traffic (e.g., application-level firewalls and web content filters) ensure the flow of traffic is only allowed from authorized sources to authorized destinations. Networks with different levels of trust (e.g., the Internet or CDS) must be kept separate.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure proxy services.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.\n4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.\n5. Click each layer and right-click the 'Source' and 'Destination' fields for each rule. Select 'Set' and set each to the organizationally defined values in accordance with the site's SSP.",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CAT|II,CCI|CCI-002403,CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104277r1_rule,STIG-ID|SYMP-AG-000550,TBA-FIISB|31.3,Vuln-ID|V-94323",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_95": {
        "description": "SYMP-AG-000550 - Symantec ProxySG must allow incoming communications only from organization-defined authorized sources routed to organization-defined authorized destinations - Rules",
        "info": "Unrestricted traffic may contain malicious traffic that poses a threat to an enclave or to other connected networks. Additionally, unrestricted traffic may transit a network, which uses bandwidth and other resources.\n\nAccess control policies and access control lists implemented on devices that control the flow of network traffic (e.g., application-level firewalls and web content filters) ensure the flow of traffic is only allowed from authorized sources to authorized destinations. Networks with different levels of trust (e.g., the Internet or CDS) must be kept separate.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure proxy services.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.\n4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.\n5. Click each layer and right-click the 'Source' and 'Destination' fields for each rule. Select 'Set' and set each to the organizationally defined values in accordance with the site's SSP.",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CAT|II,CCI|CCI-002403,CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104277r1_rule,STIG-ID|SYMP-AG-000550,TBA-FIISB|31.3,Vuln-ID|V-94323",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "||",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_96": {
        "description": "SYMP-AG-000560 - Symantec ProxySG must fail securely in the event of an operational failure.",
        "info": "If a boundary protection device fails in an unsecure manner (open), information external to the boundary protection device may enter, or the device may permit unauthorized information release.\n\nSecure failure ensures that when a boundary control device fails, all traffic will be subsequently denied.\n\nFail secure is a condition achieved by employing information system mechanisms to ensure that in the event of operational failures of boundary protection devices at managed interfaces (e.g., routers, firewalls, guards, and application gateways residing on protected subnetworks commonly referred to as demilitarized zones), information systems do not enter into unsecure states where intended security properties no longer hold.\n\nDepending on the deployment architecture, there are many configurations to check that are external to the ProxySG to ensure that an operational failure results in a secure state. With these external configurations in place, the ProxySG meets this requirement inherently. However, if a ProxySG hardware appliance is configured in a transparent, physically in-path manner, the check and fix on the ProxySG will apply.",
        "solution": "Configure the transparent, physically in-line hardware ProxySG appliance to fail securely in the event of an operational failure.\n\n1. Browse to Configuration >> Network >> Adapters >> Bridges.\n2. Select the appropriate bridge-pair (whichever is in use) and click 'Edit'.\n3. Select the 'fail-closed' radio button and click 'Apply'.",
        "reference": "800-171|3.13.1,800-53|SC-7(18),800-53r5|SC-7(18),CAT|II,CCI|CCI-001126,CN-L3|8.1.10.6(j),CSF|PR.DS-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(18),NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104279r1_rule,STIG-ID|SYMP-AG-000560,TBA-FIISB|43.1,Vuln-ID|V-94325",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "bridge ;mode",
        "regex": "mode",
        "expect": "mode fail-closed"
    },
    "custom_item_97": {
        "description": "SYMP-AG-000570 - Symantec ProxySG must deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception).",
        "info": "A deny-all, permit-by-exception network communications traffic policy ensures that only connections that are essential and approved are allowed.\n\nAs a managed interface, the ALG must block all inbound and outbound network communications traffic to the application being managed and controlled unless a policy filter is installed to explicitly allow the traffic. The allow policy filters must comply with the site's security policy.\n\nThis requirement applies to both inbound and outbound network communications traffic. All inbound and outbound traffic for which the ALG is acting as an intermediary or proxy must be denied by default.",
        "solution": "Configure the ProxySG to deny all traffic by default.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Policy >> Policy Options.\n3. Set the 'Default Proxy Policy' to 'Deny' and click 'Apply'.",
        "reference": "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),800-53r5|SC-7(5),CAT|II,CCI|CCI-001109,CN-L3|7.1.2.2(c),CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(5),NESA|T4.5.4,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104281r1_rule,STIG-ID|SYMP-AG-000570,TBA-FIISB|43.1,Vuln-ID|V-94327",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show policy proxy-default",
        "expect": "^[\\s]*deny[\\s]*$"
    },
    "custom_item_98": {
        "description": "SYMP-AG-000580 - Symantec ProxySG must identify and log internal users associated with denied outgoing communications traffic posing a threat to external information systems - Access Logging Enabled",
        "info": "Without identifying the users who initiated the traffic, it would be difficult to identify those responsible for the denied communications.\n\nThis requirement applies to network elements that perform Data Leakage Prevention (DLP) (e.g., ALGs, proxies, or application level firewalls).",
        "solution": "Configure the ProxySG to log user web traffic for auditing.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule that has 'Action' set to 'Deny' and 'Destination' defined as a restricted set of potentially threatening destinations and select 'Set'.\n5. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.13.1,800-53|SC-7(9)(b),800-53r5|SC-7(9)(b),CAT|II,CCI|CCI-002400,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(9),NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104283r1_rule,STIG-ID|SYMP-AG-000580,TBA-FIISB|43.1,Vuln-ID|V-94329",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show access-log",
        "regex": "^[\\s]*Access[\\s]+logging",
        "expect": "^[\\s]*Access[\\s]+logging[\\s]+is[\\s]+enabled[\\s]*"
    },
    "custom_item_99": {
        "description": "SYMP-AG-000580 - Symantec ProxySG must identify and log internal users associated with denied outgoing communications traffic posing a threat to external information systems - Policy",
        "info": "Without identifying the users who initiated the traffic, it would be difficult to identify those responsible for the denied communications.\n\nThis requirement applies to network elements that perform Data Leakage Prevention (DLP) (e.g., ALGs, proxies, or application level firewalls).\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to log user web traffic for auditing.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule that has 'Action' set to 'Deny' and 'Destination' defined as a restricted set of potentially threatening destinations and select 'Set'.\n5. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.13.1,800-53|SC-7(9)(b),800-53r5|SC-7(9)(b),CAT|II,CCI|CCI-002400,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(9),NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,Rule-ID|SV-104283r1_rule,STIG-ID|SYMP-AG-000580,TBA-FIISB|43.1,Vuln-ID|V-94329",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_100": {
        "description": "SYMP-AG-000600 - Symantec ProxySG providing content filtering must be configured to integrate with a system-wide intrusion detection system.",
        "info": "Without coordinated reporting between separate devices, it is not possible to identify the true scale and possible target of an attack.\n\nIntegration of the ALG with a system-wide intrusion detection system supports continuous monitoring and incident response programs. This requirement applies to monitoring at internal boundaries using TLS gateways, web content filters, email gateways, and other types of ALGs.\n\nALGs can work as part of the network monitoring capabilities to off-load inspection functions from the external boundary IDPS by performing more granular content inspection of protocols at the upper layers of the OSI reference model.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure the ProxySG to log to an intrusion detection system.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging. Check the 'Enable Access Logging' option.\n3. Click Logs >> Upload Client and ensure that the Client Type parameters are set to send logs to the intrusion detection system.",
        "reference": "800-171|3.14.7,800-53|SI-4(1),800-53r5|SI-4(1),CAT|II,CCI|CCI-002656,CN-L3|8.1.4.4(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(1),NESA|M1.2.2,NIAv2|NS5i,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104287r1_rule,STIG-ID|SYMP-AG-000600,SWIFT-CSCv1|6.5,TBA-FIISB|45.2.6,Vuln-ID|V-94333",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "edit log main ;mode",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_101": {
        "description": "SYMP-AG-000610 - Symantec ProxySG providing content filtering must detect use of network services that have not been authorized or approved by the ISSM and ISSO, at a minimum.",
        "info": "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.\n\nExamples of network services include service-oriented architectures (SOAs), cloud-based services (e.g., infrastructure as a service, platform as a service, or software as a service), cross-domain, Voice over Internet Protocol, Instant Messaging, auto-execute, and file sharing.\n\nTo comply with this requirement, the ALG may be configured to detect services either directly or indirectly (i.e., by detecting traffic associated with a service). This requirement applies to gateways/firewalls that perform content inspection or have higher-layer proxy functionality.\n\nProxySG is a default-deny device and only permits authorized/approved network services to be used.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Enable network proxy services on the ProxySG.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Click 'New Service'.",
        "reference": "800-171|3.14.7,800-53|SI-4(22),800-53r5|SI-4(22),CAT|II,CCI|CCI-002683,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104289r1_rule,STIG-ID|SYMP-AG-000610,SWIFT-CSCv1|2.3,Vuln-ID|V-94335",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_102": {
        "description": "SYMP-AG-000620 - Symantec ProxySG providing content filtering must generate a log record when access attempts to unauthorized websites and/or services are detected.",
        "info": "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.\n\nExamples of network services include service-oriented architectures (SOAs), cloud-based services (e.g., infrastructure as a service, platform as a service, or software as a service), cross-domain, Voice over Internet Protocol, Instant Messaging, auto-execute, and file sharing.",
        "solution": "Configure the ProxySG to log access attempts to unauthorized websites and/or services.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule and select 'Set'.\n5. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.14.7,800-53|SI-4(22),800-53r5|SI-4(22),CAT|II,CCI|CCI-002684,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104291r1_rule,STIG-ID|SYMP-AG-000620,SWIFT-CSCv1|2.3,Vuln-ID|V-94337",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_103": {
        "description": "SYMP-AG-000630 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when access attempts to unauthorized websites and/or services are detected.",
        "info": "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.\n\nAutomated mechanisms can be used to send automatic alerts or notifications. Such automatic alerts or notifications can be conveyed in a variety of ways (e.g., telephonically, via electronic mail, via text message, or via websites). The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.",
        "solution": "Configure the ProxySG to generate alerts for access attempts to unauthorized websites and/or services.\n\nEmail may be used to send alerts directly to the ISSO/ISSM. However, use caution and be selective when choosing on which Web Access rules to enable email notification.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New,' and select 'Email'.\n5. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n6. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n7. Click 'OK' and click 'OK' again. Create message text, and click 'OK'.\n8. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.7,800-53|SI-4(22),800-53r5|SI-4(22),CAT|II,CCI|CCI-002684,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104293r1_rule,STIG-ID|SYMP-AG-000630,SWIFT-CSCv1|2.3,Vuln-ID|V-94339",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "regex": "Track:",
        "expect": "Track: Email.*"
    },
    "custom_item_104": {
        "description": "SYMP-AG-000640 - Reverse proxy Symantec ProxySG providing content filtering must continuously monitor inbound communications traffic crossing internal security boundaries for unusual or unauthorized activities or conditions.",
        "info": "If inbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.\n\nInternal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses.",
        "solution": "Configure the ProxySG to monitor inbound communication traffic for unusual or unauthorized activities or conditions.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule and select 'Set'.\n5. Click 'New' and select 'Event Log'.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CAT|II,CCI|CCI-002661,CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104295r1_rule,STIG-ID|SYMP-AG-000640,SWIFT-CSCv1|6.5,Vuln-ID|V-94341",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "not_expect": "Track: none"
    },
    "custom_item_105": {
        "description": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Proxy Services",
        "info": "If outbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.\n\nInternal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure proxy services.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.\n4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.\n5. Click each layer and right-click the 'Source' and 'Destination' fields for each rule. Select 'Set' and set each to the organizationally defined values in accordance with the site's SSP.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CAT|II,CCI|CCI-002662,CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104297r1_rule,STIG-ID|SYMP-AG-000650,SWIFT-CSCv1|6.5,Vuln-ID|V-94343",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show proxy-services",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_106": {
        "description": "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions - Rules",
        "info": "If outbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.\n\nInternal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure proxy services.\n\n1. Log on to the Web Management Console.\n2. Browse to Configuration >> Services >> Proxy Services.\n3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.\n4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.\n5. Click each layer and right-click the 'Source' and 'Destination' fields for each rule. Select 'Set' and set each to the organizationally defined values in accordance with the site's SSP.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(4),800-53r5|SI-4(4),CAT|II,CCI|CCI-002662,CN-L3|7.1.2.2(c),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(4),NESA|M1.2.2,NIAv2|NS32,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104297r1_rule,STIG-ID|SYMP-AG-000650,SWIFT-CSCv1|6.5,Vuln-ID|V-94343",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "context": "",
        "regex": ".*",
        "expect": "MANUAL_REVIEW"
    },
    "custom_item_107": {
        "description": "SYMP-AG-000660 - Symantec ProxySG providing content filtering must send an alert to, at a minimum, the ISSO and ISSM when detection events occur.",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nSince these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nThese systems must generate an alert when detection events from real-time monitoring occur. Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.",
        "solution": "Configure the ProxySG to generate alerts for access attempts to unauthorized websites and/or services.\n\nEmail may be used to send alerts directly to the ISSO/ISSM. However, use caution and be selective when choosing which Web Access rules on which to enable email notification.\n\n1. Log on to the Web Management Console.\n2. Browse to 'Configuration' and click 'Access Logging'. Check the 'Enable Access Logging' option and click 'Apply'.\n3. Click Policy >> Visual Policy Manager >> Launch.\n4. For each Web Access Layer, right-click the 'Track' column for each rule and select 'Set'. Click 'New' and select 'Email'.\n5. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n6. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n7. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n8. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104299r1_rule,STIG-ID|SYMP-AG-000660,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94345",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "regex": "Track:",
        "expect": "Track: Email.*"
    },
    "custom_item_108": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - Client limits",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "cmd": "show attack-detection configuration",
        "regex": "client limits enabled",
        "expect": "client limits enabled:[\\s]*true"
    },
    "custom_item_109": {
        "description": "Attack Detection Identified",
        "xsl_stmt": "Action:Action: Nothing Found",
        "regex": "Action:",
        "expect": "Action: Attack Detection.*"
    },
    "custom_item_110": {
        "description": "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected - DoS incidents are detected. Rules",
        "info": "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.\n\nThe ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.\n\nCJCSM 6510.01B, 'Cyber Incident Handling Program', lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.\n\nAlerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel.",
        "solution": "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.\n\n1. SSH into the ProxySG console and type 'enable'.\n2. Enter the correct password and type 'config'.\n3. Press 'Enter' and type 'attack-detection'.\n4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.\n5. Type 'client' and press 'Enter'. Type 'enable-limits' and press 'Enter'.\n6. Log on to the Web Management Console.\n7. Browse to Maintenance >> Event Logging and click the 'Mail' tab. Ensure that the ISSO and ISSM email addresses are specified.\n8. Browse to Configuration >> Policy >> Visual Policy Manager. Click 'Launch'.\n9. In one Web Access Layer, create a new rule. Right-click the 'Action' of that rule and select 'Set'. Click 'New' and select 'Set Attack Detection'. Provide a 'Failure Weight' per local security policy requirements.\n10. Click 'OK' and click 'OK' again.\n11. Right-click the 'Track' column for this rule and select 'Set'. Click 'New' and select 'Email'.\n12. Select 'Custom Recipients' and click 'Configure Custom Recipients Lists'.\n13. Click 'New,' provide a name for the list, and enter the ISSO and ISSM email addresses in the 'List Members' field.\n14. Click 'OK' and click 'OK' again. Create message text and click 'OK'.\n15. Click 'OK' and click 'OK' again. Select File >> Install Policy on SG Appliance.",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CAT|II,CCI|CCI-002664,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,DISA_Benchmark|Symantec_ProxySG_ALG_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94347",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_SYM_ProxySG_Y20M04_STIG.zip",
        "xsl_stmt": "Track:Track: Nothing Found",
        "regex": "Track:",
        "expect": "Track: Email.*"
    }
}