{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "2.4 Ensure an industry standard authentication mechanism is used - clusterAuthMode",
        "info": "Using one or more industry standard authentication mechanisms helps organizations enforce their account and password policies for their MongoDB users.\n\nRationale:\n\nWithout an industry standard authentication mechanism in place, account and password management is more tedious, and authentication may not align with the organization's policies.",
        "solution": "In order to implement an industry standard authentication mechanism, use the corresponding sample from the list below as a model for specifying the authentication mechanisms in the MongoDB configuration file.\n\nx.509 Certificates for Client Authentication:\n\nsecurity:\n\nclusterAuthMode: x509\n\nnet:\n\nssl:\n\nmode: requireSSL\n\nPEMKeyFile:CAFile:See the reference section for a link to a detailed procedure for generating the PEMKeyFile and CAFile.\n\nMongoDB with Kerberos Authentication on Linux:\n\nsecurity:\n\n   authorization: enabled\n\nsetParameter:\n\n   authenticationMechanisms: GSSAPI\n\nstorage:\n\n   dbPath: /opt/mongodb/data\n\nSee the reference section for a link to a detailed procedure for establishing the Kerberos service principal and keytab file.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|16,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|2S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*clusterAuthMode[\\s]*:",
        "expect": "^[\\s]*clusterAuthMode[\\s]*:[\\s]*.+"
    },
    "custom_item_3": {
        "description": "2.4 Ensure an industry standard authentication mechanism is used - mode",
        "info": "Using one or more industry standard authentication mechanisms helps organizations enforce their account and password policies for their MongoDB users.\n\nRationale:\n\nWithout an industry standard authentication mechanism in place, account and password management is more tedious, and authentication may not align with the organization's policies.",
        "solution": "In order to implement an industry standard authentication mechanism, use the corresponding sample from the list below as a model for specifying the authentication mechanisms in the MongoDB configuration file.\n\nx.509 Certificates for Client Authentication:\n\nsecurity:\n\nclusterAuthMode: x509\n\nnet:\n\nssl:\n\nmode: requireSSL\n\nPEMKeyFile:CAFile:See the reference section for a link to a detailed procedure for generating the PEMKeyFile and CAFile.\n\nMongoDB with Kerberos Authentication on Linux:\n\nsecurity:\n\n   authorization: enabled\n\nsetParameter:\n\n   authenticationMechanisms: GSSAPI\n\nstorage:\n\n   dbPath: /opt/mongodb/data\n\nSee the reference section for a link to a detailed procedure for establishing the Kerberos service principal and keytab file.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|16,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|2S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*mode[\\s]*:",
        "expect": "^[\\s]*mode[\\s]*:[\\s]*.+"
    },
    "custom_item_4": {
        "description": "2.4 Ensure an industry standard authentication mechanism is used - authorization",
        "info": "Using one or more industry standard authentication mechanisms helps organizations enforce their account and password policies for their MongoDB users.\n\nRationale:\n\nWithout an industry standard authentication mechanism in place, account and password management is more tedious, and authentication may not align with the organization's policies.",
        "solution": "In order to implement an industry standard authentication mechanism, use the corresponding sample from the list below as a model for specifying the authentication mechanisms in the MongoDB configuration file.\n\nx.509 Certificates for Client Authentication:\n\nsecurity:\n\nclusterAuthMode: x509\n\nnet:\n\nssl:\n\nmode: requireSSL\n\nPEMKeyFile:CAFile:See the reference section for a link to a detailed procedure for generating the PEMKeyFile and CAFile.\n\nMongoDB with Kerberos Authentication on Linux:\n\nsecurity:\n\n   authorization: enabled\n\nsetParameter:\n\n   authenticationMechanisms: GSSAPI\n\nstorage:\n\n   dbPath: /opt/mongodb/data\n\nSee the reference section for a link to a detailed procedure for establishing the Kerberos service principal and keytab file.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|16,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|2S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*authorization[\\s]*:",
        "expect": "^[\\s]*authorization[\\s]*:[\\s]*.+"
    },
    "custom_item_5": {
        "description": "2.4 Ensure an industry standard authentication mechanism is used - authenticationMechanisms",
        "info": "Using one or more industry standard authentication mechanisms helps organizations enforce their account and password policies for their MongoDB users.\n\nRationale:\n\nWithout an industry standard authentication mechanism in place, account and password management is more tedious, and authentication may not align with the organization's policies.",
        "solution": "In order to implement an industry standard authentication mechanism, use the corresponding sample from the list below as a model for specifying the authentication mechanisms in the MongoDB configuration file.\n\nx.509 Certificates for Client Authentication:\n\nsecurity:\n\nclusterAuthMode: x509\n\nnet:\n\nssl:\n\nmode: requireSSL\n\nPEMKeyFile:CAFile:See the reference section for a link to a detailed procedure for generating the PEMKeyFile and CAFile.\n\nMongoDB with Kerberos Authentication on Linux:\n\nsecurity:\n\n   authorization: enabled\n\nsetParameter:\n\n   authenticationMechanisms: GSSAPI\n\nstorage:\n\n   dbPath: /opt/mongodb/data\n\nSee the reference section for a link to a detailed procedure for establishing the Kerberos service principal and keytab file.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|16,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*authenticationMechanisms[\\s]*:",
        "expect": "^[\\s]*authenticationMechanisms[\\s]*:[\\s]*.+"
    },
    "custom_item_6": {
        "description": "5.3 Ensure that logging captures as much information as possible",
        "info": "The SystemLog.quiet option stops logging of information such as:\n\n connection events\n\n authentication events\n\n replication sync activities\n\n evidence of some potentially impactful commands being run (eg: drop, dropIndexes, validate)\n\nThis information should be logged whenever possible. This check is only for Enterprise editions.\n\nRationale:\n\nThe use of SystemLog.quiet makes troubleshooting problems and investigating possible security incidents much more difficult.",
        "solution": "Set SystemLog.quiet to false in the /etc/mongod.conf file to disable it.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2NS,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*quiet[\\s]*:",
        "expect": "^[\\s]*quiet[\\s]*:[\\s]*false"
    },
    "custom_item_7": {
        "description": "5.4 Ensure that new entries are appended to the end of the log file",
        "info": "By default, new log entries will overwrite old entries after a restart of the mongod or Mongols service. Enabling the systemLog.logAppend setting causes new entries to be appended to the end of the log file rather than overwriting the existing content of the log when the mongos or mongod instance restarts.\n\nRationale:\n\nAllowing old entries to be overwritten by new entries instead of appending new entries to the end of the log may destroy old log data that is needed for a variety of purposes.",
        "solution": "Set systemLog.logAppend to true in the /etc/mongod.conf file.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6.3,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|2NS,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*logAppend[\\s]*:",
        "expect": "^[\\s]*logAppend[\\s]*:[\\s]*true"
    },
    "custom_item_8": {
        "description": "6.4 Ensure that server-side scripting is disabled if not needed",
        "info": "MongoDB supports the execution of JavaScript code for certain server-side operations: mapReduce, group, and $where. If you do not use these operations, server-side scripting should be disabled.\n\nRationale:\n\nIf server-side scripting is not needed and is not disabled, this introduces unnecessary risk that an attacker may take advantage of insecure coding.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If server-side scripting is not required, disable it by using the --noscripting option on the command line.\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|18.9,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,LEVEL|2NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/1725",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*javascriptEnabled[\\s]*:",
        "expect": "^[\\s]*javascriptEnabled[\\s]*:"
    }
}