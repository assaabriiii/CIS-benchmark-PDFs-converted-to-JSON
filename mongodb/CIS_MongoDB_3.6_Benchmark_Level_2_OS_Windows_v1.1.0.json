{
    "custom_item_1": {
        "description": "Check for MongoDB 3.6",
        "value_data": "^3.6",
        "powershell_args": "Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*, HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Where-Object { $_.DisplayName -Clike 'Mongo*'} | Select-Object DisplayVersion"
    },
    "custom_item_2": {
        "description": "2.3 Ensure authentication is enabled in the sharded cluster",
        "info": "Authentication is enabled in a sharded cluster when the certificate or key files are created and configured for all components. This ensures that every client that accesses the cluster must provide credentials, to include MongoDB instances that access each other within the cluster.\n\nWith keyfile authentication, each mongod or mongos instance in the sharded cluster uses the contents of the keyfile as the shared password for authenticating other members in the deployment. Only mongod or mongos instances with the correct keyfile can join the sharded cluster.\n\nFor Production Environment: x.509 certificate authentication with secure TSL/SSL connection must be used for authentication.\n\nFor Development Purpose: Key file can be used as an authentication mechanism between the shared cluster. Keyfiles are bare-minimum forms of security and are best suited for testing or development environments.\n\nRationale:\n\nEnforcing a key or certificate on a sharded cluster prevents unauthorized access to the MongoDB database and provides traceability of database activities to a specific user or component. A MongoDB sharded cluster can enforce user authentication as well as internal authentication of its components to secure against unauthorized access.",
        "solution": "To authenticate to servers, clients can use x.509 certificates instead of usernames and passwords.\nMongoDB supports x.509 certificate authentication for use with a secure TLS/SSL connection. The x.509 client authentication allows clients to authenticate to servers with certificates rather than with a username and password.\nChange the configuration file /etc/mongod.conf on each host, adding the following rows:\n\nnet:\n  port: 27017\n  ssl:\n      mode: requireSSL\n      PEMKeyFile: /etc/mongodb/ssl/server1.pem\n      CAFile: /etc/mongodb/ssl/mongoCA.crt\n      clusterFile: /etc/mongodb/ssl/server1.pem\n  security:\n      authorization: enabled\n      clusterAuthMode: x509\n\nRestart the daemon\n\nsudo service mongodb restart\n\n\n\n\nTo enable authentication in the sharded cluster, perform the following steps:(Only for Development Purpose)\n\n\nGenerate A Key File\n\nOn each component in the shared cluster, enable authentication by editing the configuration file /etc/mongod.conf. Set the keyFile option to the key file's path and then start the component with this command:\n\nkeyFile = /srv/mongodb/keyfile\n\nWhen starting the component, set --keyFile option, which is an option for both mongos instances and mongod instances. Set the --keyFile to the key file's path.\n\nDefault Value:\n\nNot configured",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv7|1.8,CSCv8|6.6,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/3560",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "regex": "^[\\s]*keyFile[\\s]*=",
        "expect": "^[\\s]*keyFile[\\s]*=[\\s]*.+"
    },
    "custom_item_3": {
        "description": "4.2 Ensure Federal Information Processing Standard (FIPS) is enabled",
        "info": "The Federal Information Processing Standard (FIPS) is a computer security standard used to certify software modules and libraries that encrypt and decrypt data securely. You can configure MongoDB to run with a FIPS 140-2 certified library for OpenSSL.\n\nFIPS is a property of the encryption system and not the access control system. However, the environment requires FIPS compliant encryption and access control. Organizations must ensure that the access control system uses only FIPS-compliant encryption.\n\nRationale:\n\nFIPS is an industry standard which dictates how data should be encrypted at rest and during transmission.",
        "solution": "Configuring FIPS mode, ensure that your certificate is FIPS compliant. Run mongod or mongos instance in FIPS mode.\nMake changes to configuration file, to configure your mongod or mongos instance to use FIPS mode, shut down the instance and update the configuration file with the following setting:\n\nnet:\n   ssl:\n      FIPSMode: true\n\nStart mongod or mongos instance with a configuration file.\n\nmongod --config /etc/mongod.conf\n\nDefault Value:\n\nNot configured",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-171|3.13.16,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53|SC-28,800-53|SC-28(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(a),CN-L3|8.1.4.8(b),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv7|14.8,CSCv8|3.10,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-1,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|2A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|28.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/files/3560",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "expect": "^[\\s]*FIPSMode[\\s]*:[\\s]*[Tt][Rr][Uu][Ee]"
    },
    "custom_item_4": {
        "description": "4.3 Ensure Encryption of Data at Rest",
        "info": "Encryption of data at rest must be enabled to ensure compliance with security and privacy standards including HIPAA, PCI-DSS, and FERPA.\n\nEncryption at rest, when used in conjunction with transport encryption and good security policies that protect relevant accounts, passwords, and encryption keys.\n\nRationale:\n\nUnauthorized users, such as intruders who are attempting security attacks, cannot read the data from storage and back up media unless they have the master encryption key to decrypt it.",
        "solution": "It is recommended to enable the data at rest encryption to protect the data.\nProtecting Data at Rest Including following steps.\n\nGenerating a master key.\n\nGenerating keys for each database.\n\nEncrypting data with the database keys.\n\nEncrypting the database keys with the master key.\n\nOnly the master key is external to the server and requires external management. To manage the master key, MongoDB's encrypted storage engine supports two key management options:\n\nIntegration with a third-party key management appliance via the Key Management Interoperability Protocol (KMIP). Recommended\n\nUse of local key management via a keyfile.\n\nThe encryption occurs transparently in the storage layer; i.e. all data files are fully encrypted from a filesystem perspective, and data only exists in an unencrypted state in memory and during transmission.\nTo enable Encryption on Database follow below step mentioned in below Link\nhttps://docs.mongodb.com/v3.6/tutorial/configure-encryption/\nRotation of Key is also important. This can be enabled by following mentioned steps in below link.\nhttps://docs.mongodb.com/v3.6/tutorial/rotate-encryption-key/",
        "reference": "800-171|3.5.2,800-171|3.13.16,800-53|IA-5(1),800-53|SC-28,800-53|SC-28(1),800-53r5|IA-5(1),800-53r5|SC-28,800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSCv7|14.8,CSCv8|3.11,CSF|PR.AC-1,CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(d),HIPAA|164.312(e)(2)(ii),ITSG-33|IA-5(1),ITSG-33|SC-28,ITSG-33|SC-28a.,ITSG-33|SC-28(1),LEVEL|2M,NESA|T5.2.3,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/3560",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "expect": "^[\\s]*enableEncryption[\\s]*:[\\s]*[Tt][Rr][Uu][Ee]"
    },
    "custom_item_5": {
        "description": "6.3 Ensure that server-side scripting is disabled if not needed",
        "info": "MongoDB supports the execution of JavaScript code for certain server-side operations: mapReduce, group, and $where. If you do not use these operations, server-side scripting should be disabled.\n\nRationale:\n\nIf server-side scripting is not needed and is not disabled, this introduces unnecessary risk which may allow an attacker to take advantage of insecure coding.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If server-side scripting is not required, disable it by using the --noscripting option on the command line.\n\nDefault Value:\n\nEnabled",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|CM-7(1),800-53|SI-7,800-53|SI-7(1),800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|SI-7,800-53r5|SI-7(1),CN-L3|7.1.3.5(b),CSCv7|9.2,CSCv8|2.7,CSF|PR.DS-6,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(c)(1),HIPAA|164.312(c)(2),HIPAA|164.312(e)(2)(i),ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|SI-7,ITSG-33|SI-7a.,ITSG-33|SI-7(1),LEVEL|2M,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|10.5.5,QCSC-v1|3.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/3560",
        "value_data": "@MONGOD_CONF_FULL_PATH@",
        "expect": "^[\\s]*javascriptEnabled[\\s]*:"
    }
}