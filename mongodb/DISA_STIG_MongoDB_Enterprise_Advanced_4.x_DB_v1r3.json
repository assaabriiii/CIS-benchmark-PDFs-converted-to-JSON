{
    "custom_item_1": {
        "description": "MongoDB version 4.x is installed",
        "regex": "\"version\"",
        "expect": "\"version\" : \"@MONGODB_VERSION@\".*"
    },
    "custom_item_2": {
        "description": "MongoDB enterprise module is installed",
        "regex": "enterprise"
    },
    "custom_item_3": {
        "description": "MD4X-00-000700 - MongoDB must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).",
        "info": "Non-organizational users include all information system users other than organizational users, which include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations).\n\nNon-organizational users must be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access, such as accessing a web server.\n\nAccordingly, a risk assessment is used in determining the authentication needs of the organization.\n\nScalability, practicality, and security are simultaneously considered in balancing the need to ensure ease of use for access to federal information and information systems with the need to protect and adequately mitigate risk to organizational operations, organizational assets, individuals, other organizations, and the Nation.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Administrators using MongoDB should document the appropriate privileges for various roles appropriate to the application.\n\nFor each database, identify the user's roles for the database.\n\n use database\n db.getUser(%username%)\n\nThe server will return a document with the user's roles.\n\nTo revoke a user's role from a database, run the following:\n\n db.revokeRolesFromUser( %username%, [ roles ], { writeConcern } )\n\nTo grant a role to a user run the following:\n\n db.grantRolesToUser( %username%, [ roles ], { writeConcern } )",
        "reference": "800-171|3.13.3,800-53|SC-2,800-53r5|SC-2,CAT|II,CCI|CCI-001082,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-2,ITSG-33|SC-2a.,NESA|T3.4.1,NIAv2|SS15b,Rule-ID|SV-252140r879631_rule,STIG-ID|MD4X-00-000700,Vuln-ID|V-252140",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_4": {
        "description": "MD4X-00-001100 - MongoDB must associate organization-defined types of security labels having organization-defined security label values with information in storage and transmission.",
        "info": "Without the association of security labels to information, there is no basis for MongoDB to make security-related access-control decisions.\n\nSecurity labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information.\n\nThese labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies, reflect special dissemination, handling, or distribution instructions, or support other aspects of the information security policy.\n\nOne example includes marking data as classified or CUI. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.\n\nThe mechanism used to support security labeling may be a feature of MongoDB product, a third-party product, or custom application code.\n\nSatisfies: SRG-APP-000311-DB-000308, SRG-APP-000313-DB-000309, SRG-APP-000314-DB-000310\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If security labeling is required then ensure the following:\n\n1. Organizational or site-specific documentation and guidance is available or developed.\n2. Ensure that security labels are or have been applied to those MongoDB collection(s) requiring them in accordance with the organization or site specific documentation.\n3. Create a Security Label Tag Viewer role (SLTagViewer) with find privileges on the specific database and collection that requires security labeling.\n\nThe example below shows three databases and collections in those databases where security labels are required.\n\n use admin\n db.createRole(\n   {\n     role: 'SLTagViewer',\n     privileges: [\n       { resource: { db: 'db1', collection: 'coll1' }, actions: [ 'find' ] },\n       { resource: { db: 'db1', collection: 'coll2' }, actions: [ 'find' ] },\n       { resource: { db: 'db1', collection: 'coll3' }, actions: [ 'find' ] },\n       { resource: { db: 'db2', collection: 'coll1' }, actions: [ 'find' ] },\n       { resource: { db: 'db2', collection: 'coll5' }, actions: [ 'find' ] },\n       { resource: { db: 'db2', collection: 'coll9' }, actions: [ 'find' ] },\n       { resource: { db: 'db3', collection: 'coll81' }, actions: [ 'find' ] }\n     ],\n     roles: [ ]\n   },\n   { w: 'majority' , wtimeout: 5000 }\n)\n\n4. Ensure that any query that targets the databases/collections that have security labeling have the appropriate MongoDB $redact operation applied.\n\nThe $redact operator is applied through trusted middleware. This trusted middleware configuration is purpose-built (custom) code and integrations and is organizational or site-specific. Information on the basics of how this is can be constructed can be found here: https://docs.mongodb.com/v4.4/reference/operator/aggregation/redact/",
        "reference": "800-53|AC-16a.,800-53r5|AC-16a.,CAT|II,CCI|CCI-002262,CCI|CCI-002263,CCI|CCI-002264,CSF|PR.AC-4,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.8.2.1,ISO/IEC-27001|A.8.2.2,ITSG-33|AC-16a.,NESA|T1.3.2,NESA|T1.3.3,NIAv2|SS28,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-252144r879689_rule,STIG-ID|MD4X-00-001100,Vuln-ID|V-252144",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_5": {
        "description": "MD4X-00-001200 - MongoDB must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.",
        "info": "Discretionary Access Control (DAC) is based on the notion that individual users are 'owners' of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled table permissions.\n\nWhen discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects.\n\nA subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level.\n\nThe policy is bound by the information system boundary. Once the information is passed outside of the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.\n\nSatisfies: SRG-APP-000328-DB-000301, SRG-APP-000340-DB-000304\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Enable authentication for MongoDB by following the instructions here: https://docs.mongodb.com/v4.4/tutorial/enable-authentication/\n\nCreate an administrative user in MongoDB:\n\n use admin\n db.createUser(\n  {\n    user: 'UserAdmin',\n    pwd: passwordPrompt(), // or cleartext password\n    roles: [ { role: 'userAdminAnyDatabase', db: 'admin' }, 'readWriteAnyDatabase' ]\n  }\n)\n\nEnable authorization by adding the following entry to the %MongoDB configuration file%:\n\nsecurity:\n    authorization: enabled\n\nRestart the MongoDB service from the OS.\n\n sudo service mongod restart\n\nThe createUser and createRole MongoDB commands will be used to add the required users and roles per organizational or site-specific documentation.\n\nhttps://docs.mongodb.com/v4.4/reference/command/createUser/\nhttps://docs.mongodb.com/v4.4/reference/command/createRole/",
        "reference": "800-171|3.1.1,800-171|3.1.7,800-53|AC-3(4),800-53|AC-6(10),800-53r5|AC-3(4),800-53r5|AC-6(10),CAT|II,CCI|CCI-002165,CCI|CCI-002235,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(4),ITSG-33|AC-6,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-252145r879705_rule,STIG-ID|MD4X-00-001200,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-252145",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_6": {
        "description": "MD4X-00-001700 - MongoDB must enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.",
        "info": "MongoDB must enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use\ncreateRole(),\nupdateRole(),\ndropRole(),\ngrantRole() statements\nto add and remove permissions on MongoDB serverl securables, bringing them into line with the documented requirements.\n\nMongoDB commands for role management can be found here:\nhttps://docs.mongodb.com/v4.4/reference/method/js-role-management/",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|I,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-252150r879530_rule,STIG-ID|MD4X-00-001700,TBA-FIISB|31.1,Vuln-ID|V-252150",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_7": {
        "description": "MD4X-00-002300 - Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to MongoDB, etc.) must be owned by database/DBMS principals authorized for ownership.",
        "info": "Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.\n\nConversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each user where the role of dbOwner is found verify whether or not the user is authorized for this role on the resources listed.\n\nThis information will be found in the organizational or site-specific documentation.\n\nIf a user if found not authorized to have the role dbOwner the remove that role from the user with the\ndb.revokeRolesFromUser() command\n\nhttps://docs.mongodb.com/v4.4/reference/command/revokeRolesFromUser/",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-252154r879586_rule,STIG-ID|MD4X-00-002300,Vuln-ID|V-252154",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_8": {
        "description": "MD4X-00-002400 - The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to MongoDB, etc.) must be restricted to authorized users.",
        "info": "If MongoDB were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nUnmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use the following commands to remove unauthorized access to a MongoDB database.\n\ndb.revokePrivilegesFromRole()\ndb. revokeRolesFromUser()\n\nMongoDB commands for role management can be found here:\nhttps://docs.mongodb.com/v4.4/reference/method/js-role-management/",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-252155r879586_rule,STIG-ID|MD4X-00-002400,Vuln-ID|V-252155",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_9": {
        "description": "MD4X-00-003200 - MongoDB must map the PKI-authenticated identity to an associated user account.",
        "info": "The DoD standard for authentication is DoD-approved PKI certificates. Once a PKI certificate has been validated, it must be mapped to a DBMS user account for the authenticated identity to be meaningful to MongoDB and useful for authorization decisions.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Add x.509 Certificate subject as an authorized user.\n\nTo authenticate with a client certificate, first add the value of the subject from the client certificate as a MongoDB user.\n\nEach unique x.509 client certificate corresponds to a single MongoDB user; meaning it cannot use a single-client certificate to authenticate more than one MongoDB user.\n\nNote: The RDNs in the subject string must be compatible with the RFC2253 standard.\n\nRetrieve the RFC2253 formatted subject from the client certificate with the following command:\n\nopenssl x509 -in pathToClient PEM -inform PEM -subject -nameopt RFC2253\n\nThe command returns the subject string as well as certificate:\n\nsubject= CN=myName,OU=myOrgUnit,O=myOrg,L=myLocality,ST=myState,C=myCountry\n-----BEGIN CERTIFICATE-----\n# ...\n-----END CERTIFICATE-----\n\nAdd the RFC2253 compliant value of the subject as a user. Omit spaces as needed.\n\nFor example, in the mongo shell, to add the user with both the readWrite role in the test database and the userAdminAnyDatabase role which is defined only in the admin database:\n\n db.getSiblingDB('$external').runCommand(\n  {\n    createUser: 'CN=myName,OU=myOrgUnit,O=myOrg,L=myLocality,ST=myState,C=myCountry',\n    roles: [\n             { role: readWrite, db: test },\n             { role: userAdminAnyDatabase, db: admin }\n           ],\n    writeConcern: { w: 'majority' , wtimeout: 5000 }\n  }\n)\n\nIn the above example, to add the user with the readWrite role in the test database, the role specification document specified test in the db field.\n\nTo add userAdminAnyDatabase role for the user, the above example specified admin in the db field.\n\nNote: Some roles are defined only in the admin database, including: clusterAdmin, readAnyDatabase, readWriteAnyDatabase, dbAdminAnyDatabase, and userAdminAnyDatabase.\n\nTo add a user with these roles, specify admin in the db field. See Manage Users and Roles for details on adding a user with roles.\n\nTo remove a user that is not authorized run the following command:\n\n use $external\n db.dropUser(%RDN of user%)",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(c),800-53r5|IA-5(2)(c),CAT|II,CCI|CCI-000187,CSF|PR.AC-1,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(c),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-252161r879614_rule,STIG-ID|MD4X-00-003200,Vuln-ID|V-252161",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_10": {
        "description": "MD4X-00-003400 - MongoDB must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).",
        "info": "Non-organizational users include all information system users other than organizational users, which include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations).\n\nNon-organizational users must be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access, such as accessing a web server.\n\nAccordingly, a risk assessment is used in determining the authentication needs of the organization.\n\nScalability, practicality, and security are simultaneously considered in balancing the need to ensure ease of use for access to federal information and information systems with the need to protect and adequately mitigate risk to organizational operations, organizational assets, individuals, other organizations, and the Nation.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Administrators using MongoDB should document the appropriate privileges for various roles appropriate to the application.\n\nPrereq: To view a user's roles, must have the viewUser privilege.\n\nConnect to MongoDB.\n\nFor each database, identify the user's roles for the database.\n\nuse database\ndb.getUser(%username%)\n\nThe server will return a document with the user's roles.\n\nTo revoke a user's role from a database use the db.revokeRolesFromUser() method.\n\nTo grant a role to a user use the db.grantRolesToUser(...) method.",
        "reference": "800-53|IA-8,800-53r5|IA-8,CAT|II,CCI|CCI-000804,CSF|PR.AC-1,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-8,ITSG-33|IA-8a.,NESA|T4.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-252163r879617_rule,STIG-ID|MD4X-00-003400,SWIFT-CSCv1|2.8,Vuln-ID|V-252163",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_11": {
        "description": "MD4X-00-005300 - MongoDB must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.",
        "info": "Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user.\n\nDBMS functionality and the nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research.\n\nMongoDB must enforce software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization).\n\nIn the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Document and obtain approval for any non-administrative users to have roles that contain createCollections or changeSteam actions on resources.\n\nFor any non-administrative user that does not have approval, revoke these specific privileges  from that non-administrative users role.\n\nRun the following commands in each database and for each non-administrative user that does not have approval to use the createCollections or changeStream actions on MongoDB resources:\n\n use database\n db.revokePrivilegesFromRole(\n    rolename,\n    [\n        { resource: { resource }, actions: [ action, ... ] },\n        ...\n    ],\n    { writeConcern }\n)\n\nIn the above command the action will be either createCollections or changeStream.\n\nThere may be several resources in a role that contain these privileges and the removal process will require running the following command for each one.",
        "reference": "800-171|3.4.9,800-53|CM-11(2),800-53r5|CM-11(2),CAT|II,CCI|CCI-001812,CSF|DE.CM-3,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,QCSC-v1|8.2.1,Rule-ID|SV-252174r879751_rule,STIG-ID|MD4X-00-005300,SWIFT-CSCv1|5.1,Vuln-ID|V-252174",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_12": {
        "description": "MD4X-00-005400 - MongoDB must enforce access restrictions associated with changes to the configuration of MongoDB or database(s).",
        "info": "Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Verify that authentication has been enabled in the %MongoDB configuration file%:\n\nhttps://docs.mongodb.com/v4.4/reference/configuration-options/.\n\nIf authorization is enabled, review the following to list existing user permissions.\n\nhttps://docs.mongodb.com/v4.4/reference/privilege-actions/\n\nConnect to MongoDB.\n\nFor each database (show dbs), identify the user's roles for the database.\n\n use database\n db.getUser(%username%)\n\nThe server will return a document with the user's roles.\n\nTo revoke a user's role from a database, use the method below:\n\n db.revokeRolesFromUser( %username%, [ roles ], { writeConcern } )\n\nhttps://docs.mongodb.com/v4.4/reference/method/db.revokeRolesFromUser/\n\nTo grant a role to a user, use the method below:\n\n db.grantRolesToUser( %username%, [ roles ], { writeConcern } )\n\nhttps://docs.mongodb.com/v4.4/reference/method/db.grantRolesToUser/",
        "reference": "800-171|3.4.5,800-53|CM-5(1),800-53r5|CM-5(1),CAT|II,CCI|CCI-001813,CSF|PR.IP-1,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-252175r879753_rule,STIG-ID|MD4X-00-005400,Vuln-ID|V-252175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_13": {
        "description": "MD4X-00-006500 - MongoDB products must be a version supported by the vendor.",
        "info": "Unsupported commercial and database systems should not be used because fixes to newly identified bugs will not be implemented by the vendor. The lack of support can result in potential vulnerabilities.\n\nSystems at unsupported servicing levels or releases will not receive security updates for new vulnerabilities, which leaves them subject to exploitation.\n\nWhen maintenance updates and patches are no longer available, the database software is no longer considered supported and should be upgraded or decommissioned.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove or decommission all unsupported software products.\n\nUpgrade unsupported DBMS or unsupported components to a supported version of the product.",
        "reference": "800-53|SA-22a.,800-53r5|SA-22a.,CAT|I,CCI|CCI-003376,DISA_Benchmark|MongoDB_Enterprise_Advanced_4-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),Rule-ID|SV-252184r944388_rule,STIG-ID|MD4X-00-006500,Vuln-ID|V-252184",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_4-x_V1R3_STIG.zip",
        "regex": "\"version\"",
        "expect": "^Manual Review Required$"
    }
}