{
    "custom_item_1": {
        "description": "MongoDB version 3.x is installed",
        "regex": "\"version\"",
        "expect": "\"version\" : \"3\\.[0-9]+\\.[0-9]+\".*"
    },
    "custom_item_2": {
        "description": "MongoDB enterprise module is installed",
        "regex": "enterprise"
    },
    "custom_item_3": {
        "description": "MD3X-00-000020 - MongoDB must enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.",
        "info": "MongoDB must enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use createRole(), updateRole(), dropRole(), grantRole() statements to add and remove permissions on server-level securables, bringing them into line with the documented requirements.\n\nMongoDB commands for role management can be found here:\nhttps://docs.mongodb.com/v3.4/reference/method/js-role-management/",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|I,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-221159r879530_rule,STIG-ID|MD3X-00-000020,STIG-Legacy|SV-96559,STIG-Legacy|V-81845,TBA-FIISB|31.1,Vuln-ID|V-221159",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_4": {
        "description": "MD3X-00-000270 - The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to MongoDB, etc.) must be restricted to authorized users.",
        "info": "If MongoDB were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.\n\nUnmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Use the following commands to remove unauthorized access to a MongoDB database.\n\ndb.revokePrivilegesFromRole()\ndb. revokeRolesFromUser()\n\nMongoDB commands for role management can be found here:\nhttps://docs.mongodb.com/v3.4/reference/method/js-role-management/",
        "reference": "800-171|3.4.5,800-53|CM-5(6),800-53r5|CM-5(6),CAT|II,CCI|CCI-001499,CSF|PR.IP-1,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(6),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-221165r879586_rule,STIG-ID|MD3X-00-000270,STIG-Legacy|SV-96571,STIG-Legacy|V-81857,Vuln-ID|V-221165",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_5": {
        "description": "MD3X-00-000310 - MongoDB must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).",
        "info": "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts, for detailed accountability of individual activity.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Prereq: To drop a user from a database, must have the 'dropUser' action on the database.\n\nFor any user not a member of an appropriate organization and has access to a database in the system run the following command:\n\n// Change to the appropriate database\nusedb.dropUser(, {w: 'majority', wtimeout: 5000}\n\nIf the MongoDB configuration file (default location: /etc/mongod.conf) does not contain\n\nsecurity: authorization: 'enabled'\n\nEdit the MongoDB configuration file, add these parameters, stop/start (restart) any mongod or mongos process using this MongoDB configuration file.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-221168r879589_rule,STIG-ID|MD3X-00-000310,STIG-Legacy|SV-96577,STIG-Legacy|V-81863,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-221168",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_6": {
        "description": "MD3X-00-000370 - MongoDB must map the PKI-authenticated identity to an associated user account.",
        "info": "The DoD standard for authentication is DoD-approved PKI certificates. Once a PKI certificate has been validated, it must be mapped to a DBMS user account for the authenticated identity to be meaningful to MongoDB and useful for authorization decisions.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Add x.509 Certificate subject as an authorized user.\n\nTo authenticate with a client certificate, you must first add the value of the subject from the client certificate as a MongoDB user.\n\nEach unique x.509 client certificate corresponds to a single MongoDB user; i.e. you cannot use a single client certificate to authenticate more than one MongoDB user.\n\nNote: The RDNs in the subject string must be compatible with the RFC2253 standard.\n\nRetrieve the RFC2253 formatted subject from the client certificate with the following command:\nopenssl x509 -in-inform PEM -subject -nameopt RFC2253\n\nThe command returns the subject string as well as certificate:\nsubject= CN=myName,OU=myOrgUnit,O=myOrg,L=myLocality,ST=myState,C=myCountry\n-----BEGIN CERTIFICATE-----\n# ...\n-----END CERTIFICATE-----\n\nAdd the RFC2253 compliant value of the subject as a user. Omit spaces as needed.\n\nFor example, in the mongo shell, to add the user with both the 'readWrite' role in the test database and the 'userAdminAnyDatabase' role which is defined only in the admin database:\ndb.getSiblingDB('$external').runCommand(\n{\ncreateUser: 'CN=myName,OU=myOrgUnit,O=myOrg,L=myLocality,ST=myState,C=myCountry',\nroles: [\n{ role: 'readWrite', db: 'test' },\n{ role: 'userAdminAnyDatabase', db: 'admin' }\n],\nwriteConcern: { w: 'majority' , wtimeout: 5000 }\n}\n)\n\nIn the above example, to add the user with the 'readWrite' role in the test database, the role specification document specified 'test' in the 'db' field. To add 'userAdminAnyDatabase' role for the user, the above example specified 'admin' in the 'db' field.\n\nNote: Some roles are defined only in the admin database, including: clusterAdmin, readAnyDatabase, readWriteAnyDatabase, dbAdminAnyDatabase, and userAdminAnyDatabase. To add a user with these roles, specify 'admin' in the 'db' field. See Manage Users and Roles for details on adding a user with roles.\n\nTo remove a user that is not authorized run the following command:\n\nuse $external\ndb.dropUser('')",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(c),800-53r5|IA-5(2)(c),CAT|II,CCI|CCI-000187,CSF|PR.AC-1,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(c),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-221173r879614_rule,STIG-ID|MD3X-00-000370,STIG-Legacy|SV-96587,STIG-Legacy|V-81873,Vuln-ID|V-221173",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_7": {
        "description": "MD3X-00-000390 - MongoDB must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).",
        "info": "Non-organizational users include all information system users other than organizational users, which include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations).\n\nNon-organizational users must be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access, such as accessing a web server.\n\nAccordingly, a risk assessment is used in determining the authentication needs of the organization.\n\nScalability, practicality, and security are simultaneously considered in balancing the need to ensure ease of use for access to federal information and information systems with the need to protect and adequately mitigate risk to organizational operations, organizational assets, individuals, other organizations, and the Nation.\n\nSatisfies: SRG-APP-000180-DB-000115, SRG-APP-000211-DB-000122, SRG-APP-000211-DB-000124\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Prereq: To view a user's roles, must have the 'viewUser' privilege.\n\nConnect to MongoDB.\n\nFor each database, identify the user's roles for the database.\n\nusedb.getUser('[username]')\n\nThe server will return a document with the user's roles.\n\nTo revoke a user's role from a database use the db.revokeRolesFromUser() method.\n\nTo grant a role to a user use the db.grantRolesToUser() method.",
        "reference": "800-171|3.13.3,800-53|IA-8,800-53|SC-2,800-53|SC-3,800-53r5|IA-8,800-53r5|SC-2,800-53r5|SC-3,CAT|II,CCI|CCI-000804,CCI|CCI-001082,CCI|CCI-001084,CSF|PR.AC-1,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-8,ITSG-33|IA-8a.,ITSG-33|SC-2,ITSG-33|SC-2a.,ITSG-33|SC-3,ITSG-33|SC-3a.,NESA|T3.4.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NIAv2|SS15b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-221175r879617_rule,STIG-ID|MD3X-00-000390,STIG-Legacy|SV-96591,STIG-Legacy|V-81877,SWIFT-CSCv1|2.8,Vuln-ID|V-221175",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_8": {
        "description": "MD3X-00-000570 - MongoDB must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.",
        "info": "Discretionary Access Control (DAC) is based on the notion that individual users are 'owners' of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled table permissions.\n\nWhen discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects.\n\nA subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level.\n\nThe policy is bounded by the information system boundary. Once the information is passed outside of the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.\n\nSatisfies: SRG-APP-000328-DB-000301, SRG-APP-000340-DB-000304\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Revoke any roles with unnecessary privileges to privileged functionality by executing the revoke command as documented here:\nhttps://docs.mongodb.com/v3.4/reference/method/db.revokeRolesFromUser/\n\nRevoke any unnecessary privileges from any roles by executing the revoke command as document here:\nhttps://docs.mongodb.com/v3.4/reference/method/db.revokePrivilegesFromRole/\n\nIf a new role with associated privileges needs to be created, follow the documentation here:\nhttps://docs.mongodb.com/v3.4/reference/command/createRole/",
        "reference": "800-171|3.1.1,800-171|3.1.7,800-53|AC-3(4),800-53|AC-6(10),800-53r5|AC-3(4),800-53r5|AC-6(10),CAT|II,CCI|CCI-002165,CCI|CCI-002235,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.1.10.6(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(4),ITSG-33|AC-6,NESA|T4.2.1,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM3,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,NIAv2|SS29,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,Rule-ID|SV-221186r879705_rule,STIG-ID|MD3X-00-000570,STIG-Legacy|SV-96613,STIG-Legacy|V-81899,SWIFT-CSCv1|5.1,TBA-FIISB|31.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-221186",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_9": {
        "description": "MD3X-00-000650 - MongoDB must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.",
        "info": "Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user.\n\nDBMS functionality and the nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research.\n\nMongoDB must enforce software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization).\n\nIn the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Revoke any roles with unnecessary privileges to privileged functionality by executing the revoke command.\n\nRevoke any unnecessary privileges from any roles by executing the revoke command.\n\nCreate, as needed, new role(s) with associated privileges.",
        "reference": "800-171|3.4.9,800-53|CM-11(2),800-53r5|CM-11(2),CAT|II,CCI|CCI-001812,CSF|DE.CM-3,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,QCSC-v1|8.2.1,Rule-ID|SV-221191r879751_rule,STIG-ID|MD3X-00-000650,STIG-Legacy|SV-96623,STIG-Legacy|V-81909,SWIFT-CSCv1|5.1,Vuln-ID|V-221191",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_10": {
        "description": "MD3X-00-000670 - MongoDB must enforce access restrictions associated with changes to the configuration of MongoDB or database(s).",
        "info": "Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Prereq: To view a user's roles, must have the 'viewUser' privilege.\nhttps://docs.mongodb.com/v3.4/reference/privilege-actions/\n\nConnect to MongoDB.\n\nFor each database, identify the user's roles for the database.\n\nusedb.getUser('[username]')\n\nThe server will return a document with the user's roles.\n\nTo revoke a user's role from a database use the db.revokeRolesFromUser() method.\nhttps://docs.mongodb.com/v3.4/reference/method/db.revokeRolesFromUser/\n\nTo grant a role to a user use the db.grantRolesToUser() method. https://docs.mongodb.com/v3.4/reference/method/db.grantRolesToUser/",
        "reference": "800-171|3.4.5,800-53|CM-5(1),800-53r5|CM-5(1),CAT|II,CCI|CCI-001813,CSF|PR.IP-1,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(1),NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.3,QCSC-v1|7.2,Rule-ID|SV-221192r879753_rule,STIG-ID|MD3X-00-000670,STIG-Legacy|SV-96625,STIG-Legacy|V-81911,Vuln-ID|V-221192",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "expect": ".*",
        "collection": "admin.system.users"
    },
    "custom_item_11": {
        "description": "MD3X-00-001200 - MongoDB products must be a version supported by the vendor.",
        "info": "Unsupported commercial and database systems should not be used because fixes to newly identified bugs will not be implemented by the vendor. The lack of support can result in potential vulnerabilities.\n\nSystems at unsupported servicing levels or releases will not receive security updates for new vulnerabilities, which leaves them subject to exploitation.\n\nWhen maintenance updates and patches are no longer available, the database software is no longer considered supported and should be upgraded or decommissioned.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove or decommission all unsupported software products.\n\nUpgrade unsupported DBMS or unsupported components to a supported version of the product.",
        "reference": "800-53|SA-22a.,800-53r5|SA-22a.,CAT|I,CCI|CCI-003376,DISA_Benchmark|MongoDB_3-x_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),Rule-ID|SV-259797r947233_rule,STIG-ID|MD3X-00-001200,Vuln-ID|V-259797",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MDB_Enterprise_Advanced_3-x_V2R2_STIG.zip",
        "regex": "\"version\"",
        "expect": "^Manual Review Required$"
    }
}