{
    "custom_item_1": {
        "description": "Windows is installed",
        "value_data": "HKLM\\SOFTWARE\\Microsoft\\Windows NT"
    },
    "custom_item_2": {
        "description": "EP11-00-000700 - The EDB Postgres Advanced Server must integrate with an organization-level authentication/access mechanism providing account management and automation for all users, groups, roles, and any other principals.",
        "info": "Enterprise environments make account management for applications and databases challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. Managing accounts for the same person in multiple places is inefficient and prone to problems with consistency and synchronization.\n\nA comprehensive application account management process that includes automation helps to ensure that accounts designated as requiring attention are consistently and promptly addressed.\n\nExamples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended, or terminated, or by disabling accounts located in non-centralized account stores, such as multiple servers. Account management functions can also include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephone notification to report atypical system account usage.\n\nThe EDB Postgres Advanced Server must be configured to automatically utilize organization-level account management functions, and these functions must immediately enforce the organization's current account policy.\n\nAutomation may be comprised of differing technologies that when placed together contain an overall mechanism supporting an organization's automated account management requirements.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Identify any user using 'trust', 'sha-256-scram', md5', 'ident', 'peer' or 'password' as allowable access methods.\n\nTo identify users in the pg_hba.conf file using the methods listed above, open the pg_hba.conf file in a text editor, and inspect the contents of the file, looking for uncommented lines with these methods. Optionally, the following command can be run from a Windows command prompt to identify any uncommented lines in the pg_hba.conf file that may be using these methods:\n\n type\\pg_hba.conf | findstr /N 'scram-sha-256 md5 trust password peer ident' | find /V /N '#'\n\nNote: If the path to the pg_hba.conf file contains spaces in it, the path to the file (including the file name) should be placed in double quotes.\n\nDocument any rows that have 'trust', 'sha-256-scram', 'md5', 'ident', 'peer', or 'password' specified for the 'METHOD' column and obtain appropriate approval for each user specified in the 'USER' column (i.e., all DBMS managed accounts).\n\nFor any users not documented and approved as DBMS managed accounts, change the 'METHOD' column to one of the externally managed (not 'trust', 'sha-256-scram', 'md5', 'ident', 'peer' or 'password') options defined here:\n\nhttps://www.postgresql.org/docs/current/static/auth-methods.html",
        "reference": "800-171|3.1.1,800-53|AC-2(1),800-53r5|AC-2(1),CAT|I,CCI|CCI-000015,CN-L3|7.1.3.2(d),CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-224131r879522_rule,STIG-ID|EP11-00-000700,STIG-Legacy|SV-109393,STIG-Legacy|V-100289,Vuln-ID|V-224131",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*[^#]*[\\s]*(trust|md5|scram-sha-256|password|peer|ident)([\\s]|$)",
        "expect": "^[\\s]*[^#]*[\\s]*(trust|md5|scram-sha-256|password|peer|ident)([\\s]|$)"
    },
    "custom_item_3": {
        "description": "data dir",
        "value_data": "^Manual Review Required$",
        "powershell_args": "$f='@PG_DATA_DIR@';icacls $f;"
    },
    "custom_item_4": {
        "description": "data\\*",
        "value_data": "^Manual Review Required$",
        "powershell_args": "$f='@PG_DATA_DIR@\\*';icacls $f;"
    },
    "custom_item_5": {
        "description": "postgresql.conf",
        "value_data": "^Manual Review Required$",
        "powershell_args": "$f='@PG_DATA_DIR@\\postgresql.conf';icacls $f;"
    },
    "custom_item_6": {
        "description": "EP11-00-002600 - The audit information produced by the EDB Postgres Advanced Server must be protected from unauthorized read access.",
        "info": "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\nThis requirement can be achieved through multiple methods which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections and limiting log data location.\n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224148r879576_rule,STIG-ID|EP11-00-002600,STIG-Legacy|SV-109427,STIG-Legacy|V-100323,Vuln-ID|V-224148",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_7": {
        "description": "EP11-00-002700 - The audit information produced by the EDB Postgres Advanced Server must be protected from unauthorized modification.",
        "info": "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized modification.\n\nThis requirement can be achieved through multiple methods that will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions and limiting log data locations.\n\nApplications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make access decisions regarding the modification of audit data.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nModification of database audit data could mask the theft of, or the unauthorized modification of, sensitive data stored in the database.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224149r879577_rule,STIG-ID|EP11-00-002700,STIG-Legacy|SV-109429,STIG-Legacy|V-100325,Vuln-ID|V-224149",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_8": {
        "description": "EP11-00-002800 - The audit information produced by the EDB Postgres Advanced Server must be protected from unauthorized deletion.",
        "info": "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods which will depend upon system architecture and design.\n\nSome commonly employed methods include: ensuring log files enjoy the proper file system permissions utilizing file system protections; restricting access; and backing up log data to ensure log data is retained.\n\nApplications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys to make access decisions regarding the deletion of audit data.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nDeletion of database audit data could mask the theft of, or the unauthorized modification of, sensitive data stored in the database.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224150r879578_rule,STIG-ID|EP11-00-002800,STIG-Legacy|SV-109431,STIG-Legacy|V-100327,Vuln-ID|V-224150",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_9": {
        "description": "EP11-00-002900 - The EDB Postgres Advanced Server must protect its audit features from unauthorized access.",
        "info": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data.\n\nDepending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data. It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized access.\n\nApplications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, OS-provided audit tools, vendor-provided audit tools, and open source audit tools needed to successfully view and manipulate audit information system activity and records.\n\nIf an attacker were to gain access to audit tools, he could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001493,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224151r879579_rule,STIG-ID|EP11-00-002900,STIG-Legacy|SV-109433,STIG-Legacy|V-100329,Vuln-ID|V-224151",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_10": {
        "description": "EP11-00-003000 - The EDB Postgres Advanced Server must protect its audit configuration from unauthorized modification.",
        "info": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.\n\nApplications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys to make access decisions regarding the modification of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001494,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224152r879580_rule,STIG-ID|EP11-00-003000,STIG-Legacy|SV-109435,STIG-Legacy|V-100331,Vuln-ID|V-224152",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_11": {
        "description": "EP11-00-003100 - The EDB Postgres Advanced Server must protect its audit features from unauthorized removal.",
        "info": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.\n\nApplications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys to make access decisions regarding the deletion of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.",
        "solution": "1) Change ownership of EDB Audit directory and its contents to the database service account if they are not owned by the database service account.\n\nIf the EDB Audit directory and its contents are not owned by the database service account, change ownership to the service account responsible for running the Advanced Server database service.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', select the 'Securities' tab, and select the 'Advanced' button.\n Select the 'Change' link shown next to the owner of the folder to change the folder's owner.\n\nAlternatively, the Windows TAKEOWN command or the ICACLS command (with the /SETOWNER option) may be used to change ownership of folders and files using the Windows command prompt.\n\n2) Modify permissions on the EDB Audit directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Read)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CAT|II,CCI|CCI-001495,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-224153r879581_rule,STIG-ID|EP11-00-003100,STIG-Legacy|SV-109437,STIG-Legacy|V-100333,Vuln-ID|V-224153",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\edb_audit\\' | Select-Object Owner | Format-List"
    },
    "custom_item_12": {
        "description": "EP11-00-003800 - Unused database components, EDB Postgres Advanced Server software, and database objects must be removed.",
        "info": "Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nDBMSs must adhere to the principles of least functionality by providing only essential capabilities.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Open Control Program >> Programs >> Programs and Features. Select any programs that should not be installed, click 'uninstall', and then follow the prompts to uninstall the software.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-224161r879587_rule,STIG-ID|EP11-00-003800,STIG-Legacy|SV-109453,STIG-Legacy|V-100349,SWIFT-CSCv1|2.3,Vuln-ID|V-224161",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "^Manual Review Required$",
        "powershell_args": "Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-List"
    },
    "custom_item_13": {
        "description": "EP11-00-003900 - Unused database components which are integrated in the EDB Postgres Advanced Server and cannot be uninstalled must be disabled.",
        "info": "Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nDBMSs must adhere to the principles of least functionality by providing only essential capabilities.\n\nUnused, unnecessary DBMS components increase the attack vector for the DBMS by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced. Components of the system that are unused and cannot be uninstalled must be disabled. The techniques available for disabling components will vary by DBMS product, OS, and the nature of the component, and may include DBMS configuration settings, OS service settings, OS file access security, and DBMS user/role permissions.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Open Control Program >> Programs >> Programs and Features. Select any programs that should not be installed, click 'uninstall', and then follow the prompts to uninstall the software.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-224162r879587_rule,STIG-ID|EP11-00-003900,STIG-Legacy|SV-109455,STIG-Legacy|V-100351,SWIFT-CSCv1|2.3,Vuln-ID|V-224162",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "^Manual Review Required$",
        "powershell_args": "Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-List"
    },
    "custom_item_14": {
        "description": "EP11-00-004000 - Access to external executables must be disabled or restricted.",
        "info": "Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nApplications must adhere to the principles of least functionality by providing only essential capabilities.\n\nEDB Postgres Advanced Server may spawn additional external processes to execute procedures that are defined in EDB Postgres Advanced Server but stored in external host files (external procedures). The spawned process used to execute the external procedure may operate within a different OS security context than EDB Postgres Advanced Server and provide unauthorized access to the host system.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To uninstall programs that are not approved, open Control Program | Programs | Programs and Features. Select any programs that should not be installed, click the 'uninstall' button, and follow the prompts to uninstall the software.\n\nTo remove the SUPERUSER privilege from a role, execute the following SQL statement in psql or another Postgres SQL client as enterprisedb:\n\n ALTER ROLEWITH NOSUPERUSER;\n\nTo remove a role that has been granted to another role, execute the following SQL statement in psql or another Postgres SQL client as enterprisedb:\n\n REVOKE ROLEFROM;\n\nTo remove an extension from a Postgres database, execute the following SQL statement in psql or another Postgres SQL client as enterprisedb:\n\n DROP EXTENSION;\n\nTo remove a function from a Postgres database, execute the following SQL statement in psql or another Postgres SQL client as enterprisedb:\n\n DROP FUNCTION;\n\nIf the unapproved function is contained in an EDB-SPL database package, drop the package specification and body or replace the package specification and package body source with an updated version of the source that does not include the unapproved function.\n\nTo drop a package, execute the following SQL statements in psql or another EDB Postgres Advanced Server SQL client as enterprisedb:\n\n DROP PACKAGE BODY;\n DROP PACKAGE;\n\nTo update a package, execute the 'CREATE OR REPLACE PACKAGE' and 'CREATE OR REPLACE PACKAGE BODY' SQL statements in psql or another EDB Postgres Advanced Server SQL client. See the EnterpriseDB 'Database Compatibility for Oracle Developers Reference Guide' for more information about the commands for creating, replacing, and dropping database packages.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-224163r879587_rule,STIG-ID|EP11-00-004000,STIG-Legacy|SV-109457,STIG-Legacy|V-100353,SWIFT-CSCv1|2.3,Vuln-ID|V-224163",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "^Manual Review Required$",
        "powershell_args": "Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-List"
    },
    "custom_item_15": {
        "description": "EP11-00-004200 - The EDB Postgres Advanced Server must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).",
        "info": "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.",
        "solution": "Open '\\pg_hba.conf' in an editor.\n\nNote that the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running postgres instance can be found using the following command run from a Windows command prompt:\n\n psql -d-U-c 'SHOW hba_file'\n\nwhere,is any database in the EDB postgres instance andis a database superuser. By default, a database named 'edb' and a superuser named 'enterprisedb' are installed with EDB Postgres Advanced Server (EPAS).\n\nIf any rows have 'trust' specified for the 'METHOD' column that are not documented and approved, delete the rows or change them to other authentication methods.\n\nPermitted methods in preferred order are: peer (local only), cert, ldap, sspi, pam, sha-256-scram, md5",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-224165r879589_rule,STIG-ID|EP11-00-004200,STIG-Legacy|SV-109461,STIG-Legacy|V-100357,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-224165",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*[^#]*[\\s]*trust([\\s]|$)",
        "expect": "^[\\s]*[^#]*[\\s]*trust([\\s]|$)"
    },
    "custom_item_16": {
        "description": "EP11-00-004400 - If passwords are used for authentication, the EDB Postgres Advanced Server must transmit only encrypted representations of passwords.",
        "info": "The DoD standard for authentication is DoD-approved PKI certificates.\n\nAuthentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval.\n\nIn such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.\n\nDBMS passwords sent in clear text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.",
        "solution": "Open '\\pg_hba.conf' in an editor.\n\nNote that the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running postgres instance can be found using the following command run from a Windows command prompt:\n\n psql -d-U-c 'SHOW hba_file'\n\nwhere,is any database in the EDB postgres instance andis a database superuser. By default, a database named 'edb' and a superuser named 'enterprisedb' are installed with EDB Postgres Advanced Server (EPAS).\n\nFor any rows that have 'password' specified for the 'METHOD' column, change the value to 'sha-256-scram' or 'md5'.",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|I,CCI|CCI-000197,CSF|PR.AC-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-224168r879609_rule,STIG-ID|EP11-00-004400,STIG-Legacy|SV-109467,STIG-Legacy|V-100363,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-224168",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*[^#]*[\\s]*password([\\s]|$)",
        "expect": "^[\\s]*[^#]*[\\s]*password([\\s]|$)"
    },
    "custom_item_17": {
        "description": "EP11-00-004500 - The EDB Postgres Advanced Server, when utilizing PKI-based authentication, must validate certificates by performing RFC 5280-compliant certification path validation.",
        "info": "The DoD standard for authentication is DoD-approved PKI certificates.\n\nA certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.\n\nDatabase Management Systems that do not validate certificates by performing RFC 5280-compliant certification path validation are in danger of accepting certificates that are invalid and/or counterfeit. This could allow unauthorized access to the database.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Open the '\\pg_hba.conf' in an editor.\n\nNote that the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running postgres instance can be found using the following command run from a Windows command prompt:\n\n psql -d-U-c 'SHOW hba_file'\n\nwhere,is any database in the EDB postgres instance andis a database superuser. By default, a database named 'edb' and a superuser named 'enterprisedb' are installed with EDB Postgres Advanced Server (EPAS).\n\nFor any rows that have TYPE of 'hostssl', append 'clientcert=1' in the OPTIONS column at the end of the line.",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(a),800-53r5|IA-5(2)(a),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(a),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-224169r879612_rule,STIG-ID|EP11-00-004500,STIG-Legacy|SV-109469,STIG-Legacy|V-100365,Vuln-ID|V-224169",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*[\\s]clientcert=1([\\s]|$)"
    },
    "custom_item_18": {
        "description": "EP11-00-004600 - The EDB Postgres Advanced Server must enforce authorized access to all PKI private keys stored/utilized by the EDB Postgres Advanced Server.",
        "info": "The DoD standard for authentication is DoD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the DBMS-stored private keys are used to authenticate the DBMS to the system's clients, loss of the corresponding private keys would allow an attacker to successfully perform undetected man in the middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 or 140-3 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.",
        "solution": "Right-click and select 'Properties' on\\server.key\n\nGive the database administrator (default 'enterprisedb') full control of the file.",
        "reference": "800-171|3.5.2,800-53|IA-5(2)(b),800-53r5|IA-5(2)(b),CAT|I,CCI|CCI-000186,CSF|PR.AC-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(2)(b),NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-224170r879613_rule,STIG-ID|EP11-00-004600,STIG-Legacy|SV-109471,STIG-Legacy|V-100367,Vuln-ID|V-224170",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@\\server.key' | Select-Object Owner | Format-List"
    },
    "custom_item_19": {
        "description": "EP11-00-004850 - The EDB Postgres Advanced Server password file must not be used.",
        "info": "The EDB Postgres password file can contain passwords to be used if the connection allows a password (and no password has been specified otherwise).\n\nThis file contain lines of the following format:\nhostname:port:database:username:password\n\nIt is critically important to system security that use of a password file be avoided as it stores passwords in plain text. Any user with access to these could potentially compromise the security of the database.",
        "solution": "Remove any password files present on the server and implement a  more secure form of authentication.\n\nThe DoD standard for authentication is DoD-approved PKI certificates.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-224173r879887_rule,STIG-ID|EP11-00-004850,STIG-Legacy|SV-110213,STIG-Legacy|V-101109,SWIFT-CSCv1|2.3,Vuln-ID|V-224173",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@APP_DATA@\\postgresql\\pgpass.conf"
    },
    "custom_item_20": {
        "description": "hostssl",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*"
    },
    "custom_item_21": {
        "description": "openssl_conf",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*openssl_conf[\\s]*=",
        "expect": "^[\\s]*openssl_conf[\\s]*=[\\s]*openssl_conf_section[\\s]*"
    },
    "custom_item_22": {
        "description": "alg_section",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*alg_section[\\s]*=",
        "expect": "^[\\s]*alg_section[\\s]*=[\\s]*evp_settings[\\s]*"
    },
    "custom_item_23": {
        "description": "fips_mode",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*fips_mode[\\s]*=",
        "expect": "^[\\s]*fips_mode[\\s]*=[\\s]*yes[\\s]*"
    },
    "custom_item_24": {
        "description": "EP11-00-006100 - Access to database files must be limited to relevant processes and to authorized, administrative users.",
        "info": "Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. Permitting only DBMS processes and authorized, administrative users to have access to the files where the database resides helps ensure that those files are not shared inappropriately and are not open to backdoor access and manipulation.",
        "solution": "If the postgresql data directory and its contents are not owned by the database service account or other user as documented and approved in the system documentation, change ownership to an authorized user.\n\nModify permissions on the data directory and its contents to meet the requirement to protect against unauthorized access.\n\nThis may be done using Windows Explorer:\n Browse to the directory where the EDB audit directory folder is located.\n Select and right-click on the folder, select 'Properties', and select the 'Security' tab.\n Modify the security permissions to:\n NT AUTHORITY/NetworkService (or configured database service account) (Full Control)\n Administrators (Full Control)\n Users (none)\n\nAlternatively, the Windows ICACLS command may be used to modify permissions on folders and files using the Windows command prompt.\n\nIf other permissions have been granted to other users or groups, ensure that the system documentation is updated to note the organizationally approved permission setting and corresponding justification of the permission settings for this requirement.",
        "reference": "800-171|3.13.4,800-53|SC-4,800-53r5|SC-4,CAT|II,CCI|CCI-001090,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-4,ITSG-33|SC-4a.,Rule-ID|SV-224181r879649_rule,STIG-ID|EP11-00-006100,STIG-Legacy|SV-109489,STIG-Legacy|V-100385,Vuln-ID|V-224181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_USER@",
        "powershell_args": "Get-Acl '@PG_DATA_DIR@' | Select-Object Owner | Format-List"
    },
    "custom_item_25": {
        "description": "EP11-00-008700 - The EDB Postgres Advanced Server must disable network functions, ports, protocols, and services deemed by the organization to be nonsecure, in accord with the Ports, Protocols, and Services Management (PPSM) guidance.",
        "info": "Use of nonsecure network functions, ports, protocols, and services exposes the system to avoidable threats.\n\nA database cluster listens on a single port (usually 5444 for Postgres Plus Advanced Server). The Postgres Enterprise Manager (PEM) agents do not listen on ports, they only act as clients to the PEM server. The PEM server has two components (a repository which is a Postgres database) and an Apache HTTPD application. The Apache HTTPD application listens on a port configured in Apache, generally 8080 or 8443.\n\nThe ports to check are:\n1) The primary Postgres cluster port,\n2) If PEM is in use, the PEM Apache HTTPD port, and\n3) The PEM Repository DB port.\n\nGenerally 2 and 3 should be installed on an isolated management machine without access from anyone other than administrators.",
        "solution": "Disable each prohibited network function, port, protocol, or service prohibited by the PPSM guidance.\n\nOpen the pg_hba.conf file in an editor and change the TYPE of any rows not starting with a '#' to be 'hostssl'. The METHOD for the hostssl rows should be one of these (in preferred order): cert, sspi, ldap, scram-sha-256\n\nNote that the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running postgres instance can be found using the following command run from a Windows command prompt:\n\n psql -d-U-c 'SHOW hba_file'\n\nwhere,is any database in the EDB postgres instance andis a database superuser. By default, a database named 'edb' and a superuser named 'enterprisedb' are installed with EDB Postgres Advanced Server (EPAS).\n\nExecute the following SQL as enterprisedb:\n\n ALTER SYSTEM SET port =;\n\nRestart the database service. For EDB Postgres Advanced Server, the default service name for an instance will be 'edb-as-' with a default display name of 'edb-as-- Advanced Server', where '' is the major version number of the EDB Postgres Advanced Server that is installed:\n\nTo restart the database service, using the Windows Services Control Manager:\n 1. Open the Windows Services Control Manager.\n 2. Select the database service from the list of services, right-click it, and select 'Restart'.\n\nAlternatively, the database can be restarted via the Windows command line using either the NET or SC command as follows:\n\n NET STOPNET STARTor\n\n SC STOPSC STARTIn the above commands, replacewith the actual service name corresponding to the EDB Postgres instance.\n\nNote that if pgAgent is installed and running, the corresponding pgAgent service is dependent on the EDB Postgres database service and must first be stopped to restart the database service. After restarting the database service, the pgAgent service may be started again.",
        "reference": "800-171|3.4.7,800-53|CM-7(1)(b),800-53r5|CM-7(1)(b),CAT|II,CCI|CCI-001762,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(1),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-224203r879756_rule,STIG-ID|EP11-00-008700,STIG-Legacy|SV-109531,STIG-Legacy|V-100427,SWIFT-CSCv1|2.3,Vuln-ID|V-224203",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*(host|hostnossl)[\\s]",
        "expect": "^[\\s]*(host|hostnossl)[\\s]"
    },
    "custom_item_26": {
        "description": "EP11-00-009100 - The EDB Postgres Advanced Server must only accept end entity certificates issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) for the establishment of all encrypted sessions.",
        "info": "Only DoD-approved external PKIs evaluated to ensure security controls and identity vetting procedures are in place that are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.\n\nThe authoritative list of DoD-approved PKIs is published at https://cyber.mil/pki-pke/interoperability/.\n\nThis requirement focuses on communications protection for the DBMS session rather than for the network packet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Contact your program security office to request DoD issued certificates:\n\nroot.crt (CA Certificate)\nserver.crt\nserver.key",
        "reference": "800-171|3.13.15,800-53|SC-23(5),800-53r5|SC-23(5),CAT|II,CCI|CCI-002470,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23,ITSG-33|SC-23a.,NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-224205r879798_rule,STIG-ID|EP11-00-009100,STIG-Legacy|SV-109535,STIG-Legacy|V-100431,Vuln-ID|V-224205",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "^Manual Review Required$",
        "powershell_args": "CertUtil @PG_DATA_DIR@\\server.crt"
    },
    "custom_item_27": {
        "description": "EP11-00-009500 - The EDB Postgres Advanced Server must maintain the confidentiality and integrity of information during preparation for transmission.",
        "info": "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.\n\nUse of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process.\n\nWhen transmitting data, the DBMS, associated applications, and infrastructure must leverage transmission protection mechanisms.\n\nEDB Postgres Advanced Server provides native support for using SSL connections to encrypt client/server communications. To enable the use of SSL, the postgres 'ssl' configuration parameter must be set to 'on' and the database instance needs to be configured to use a valid server certificate and private key installed on the server. With SSL enabled, connections made to the database server will default to being encrypted. However, it is possible for clients to override the default and attempt to establish an unencrypted connection. To prevent connections made from non-local hosts from being unencrypted, the postgres host-based authentication settings should be configured to only allow hostssl (i.e., encrypted) connections. The hostssl connections can be further configured to require the client present a valid (trusted) SSL certificate for a connection.",
        "solution": "To configure EDB Postgres Advanced Server to use SSL, open the 'postgresql.conf' file in an editor. Note the default location for the postgresql.conf file is in the postgresql data directory. The location of the postgresql.conf for a running EDB Postgres instance can be found by connecting to the database as a database superuser using psql and executing the following command:\n\n   SHOW config_file;\n\nIn the postgresql.conf file, set the 'ssl' parameter as follows:\n\n   ssl = on\n\nMake sure the parameter is uncommented.\n\nIn order to start an EDB Postgres Advance Server instance in SSL mode, files containing the server certificate and private key must exist. By default, these files are expected to exist in the Postgres data directory and are expected to be named server.crt and server.key, respectively. Update the ssl_cert_file and ssl_cert_key parameters in the postgresql.conf file if the files are placed in a different location or are named differently.\nNote that changes to the ssl parameter setting and any of the other ssl related parameters require a reload of the database server configuration to put the changes into effect.\nTo reload the database server configuration, connect to the database as a database superuser using psql and execute the following command:\n   SELECT pg_reload_conf();\nAfter verifying that SSL is enabled for the database, open the pg_hba.conf file in an editor to configure the host-based authentication settings. Note the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running EDB postgres instance can be found by connecting to the database as a database superuser using psql and execute the following command:\n   SHOW hba_file;\n\nObtain approval and document any uncommented entries with corresponding justification that are not of type hostssl and do not include the 'clientcert=1' option.\n\nFor any entries that are not of type hostssl authentication with the 'clientcert=1' option and not documented and approved, change the 'TYPE' column to 'hostssl' and add the 'clientcert=1' authentication method option.\n\nNote on Microsoft Windows systems, changes to the host-based authentication settings in the pg_hba.conf file are immediately applied by subsequent new connections.\n\nFor more information on configuring PostgreSQL to use SSL, consult the following documentation:\nhttps://www.postgresql.org/docs/current/ssl-tcp.html\n\nFor more information on configuring the postgresql pg_hba.conf file, consult the following documentation:\nhttps://www.postgresql.org/docs/current/auth-pg-hba-conf.html",
        "reference": "800-171|3.13.8,800-53|SC-8(2),800-53r5|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-224208r879812_rule,STIG-ID|EP11-00-009500,STIG-Legacy|SV-109541,STIG-Legacy|V-100437,SWIFT-CSCv1|2.1,Vuln-ID|V-224208",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*[\\s]clientcert[\\s]*=[\\s]*1([\\s]|$)"
    },
    "custom_item_28": {
        "description": "EP11-00-009600 - The EDB Postgres Advanced Server must maintain the confidentiality and integrity of information during reception.",
        "info": "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.\n\nThis requirement applies only to those applications that are either distributed or can allow access to data non-locally. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process.\n\nWhen receiving data, the DBMS, associated applications, and infrastructure must leverage protection mechanisms.\n\nEDB Postgres Advanced Server provides native support for using SSL connections to encrypt client/server communications. To enable the use of SSL, the postgres 'ssl' configuration parameter must be set to 'on' and the database instance needs to be configured to use a valid server certificate and private key installed on the server. With SSL enabled, connections made to the database server will default to being encrypted. However, it is possible for clients to override the default and attempt to establish an unencrypted connection. To prevent connections made from non-local hosts from being unencrypted, the postgres host-based authentication settings should be configured to only allow hostssl (i.e., encrypted) connections. The hostssl connections can be further configured to require the client present a valid (trusted) SSL certificate for a connection.",
        "solution": "To configure EDB Postgres Advanced Server to use SSL, open the 'postgresql.conf' file in an editor. Note the default location for the postgresql.conf file is in the postgresql data directory. The location of the postgresql.conf for a running EDB Postgres instance can be found by connecting to the database as a database superuser using psql and executing the following command:\n\n   SHOW config_file;\n\nIn the postgresql.conf file, set the 'ssl' parameter as follows:\n\n   ssl = on\n\nMake sure the parameter is uncommented.\n\nIn order to start an EDB Postgres Advanced Server instance in SSL mode, files containing the server certificate and private key must exist. By default, these files are expected to exist in the Postgres data directory and are expected to be named server.crt and server.key, respectively. Update the ssl_cert_file and ssl_cert_key parameters in the postgresql.conf file if the files are placed in a different location or are named differently.\nNote changes to the ssl parameter setting and any of the other ssl related parameters require a reload of the database server configuration to put the changes into effect.\nTo reload the database server configuration, connect to the database as a database superuser using psql and execute the following command:\n   SELECT pg_reload_conf();\nAfter verifying SSL is enabled for the database, open the pg_hba.conf file in an editor to configure the host-based authentication settings. Note the default location for the pg_hba.conf file is in the postgresql data directory. The location of the pg_hba.conf file for a running EDB postgres instance can be found by connecting to the database as a database superuser using psql and execute the following command:\n   SHOW hba_file;\nObtain approval and document any uncommented entries with corresponding justification that are not of type hostssl and do not include the 'clientcert=1' option.\n\nFor any entries that are not of type hostssl authentication with the 'clientcert=1' option and not documented and approved, change the 'TYPE' column to 'hostssl' and add the 'clientcert=1' authentication method option.\n\nNote that on Microsoft Windows systems, changes to the host-based authentication settings in the pg_hba.conf file are immediately applied by subsequent new connections.\n\nFor more information on configuring PostgreSQL to use SSL, consult the following documentation:\nhttps://www.postgresql.org/docs/current/ssl-tcp.html\n\nFor more information on configuring the postgresql pg_hba.conf file, consult the following documentation:\nhttps://www.postgresql.org/docs/current/auth-pg-hba-conf.html",
        "reference": "800-171|3.13.8,800-53|SC-8(2),800-53r5|SC-8(2),CAT|II,CCI|CCI-002422,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|EDB_Postgres_Advanced_Server_v11_on_Windows_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-224209r879813_rule,STIG-ID|EP11-00-009600,STIG-Legacy|SV-109543,STIG-Legacy|V-100439,SWIFT-CSCv1|2.1,Vuln-ID|V-224209",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_EDB_PGS_Advanced_Server_v11_Windows_V2R3_STIG.zip",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*[\\s]clientcert[\\s]*=[\\s]*1([\\s]|$)"
    },
    "custom_item_29": {
        "description": "hostssl",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*"
    },
    "custom_item_30": {
        "description": "openssl_conf",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*openssl_conf[\\s]*=",
        "expect": "^[\\s]*openssl_conf[\\s]*=[\\s]*openssl_conf_section[\\s]*"
    },
    "custom_item_31": {
        "description": "alg_section",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*alg_section[\\s]*=",
        "expect": "^[\\s]*alg_section[\\s]*=[\\s]*evp_settings[\\s]*"
    },
    "custom_item_32": {
        "description": "fips_mode",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*fips_mode[\\s]*=",
        "expect": "^[\\s]*fips_mode[\\s]*=[\\s]*yes[\\s]*"
    },
    "custom_item_33": {
        "description": "hostssl",
        "value_data": "@PG_DATA_DIR@\\pg_hba.conf",
        "regex": "^[\\s]*hostssl[\\s]",
        "expect": "^[\\s]*hostssl[\\s].*"
    },
    "custom_item_34": {
        "description": "openssl_conf",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*openssl_conf[\\s]*=",
        "expect": "^[\\s]*openssl_conf[\\s]*=[\\s]*openssl_conf_section[\\s]*"
    },
    "custom_item_35": {
        "description": "alg_section",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*alg_section[\\s]*=",
        "expect": "^[\\s]*alg_section[\\s]*=[\\s]*evp_settings[\\s]*"
    },
    "custom_item_36": {
        "description": "fips_mode",
        "value_data": "@OPENSSL_CONF_FILE@",
        "regex": "^[\\s]*fips_mode[\\s]*=",
        "expect": "^[\\s]*fips_mode[\\s]*=[\\s]*yes[\\s]*"
    }
}