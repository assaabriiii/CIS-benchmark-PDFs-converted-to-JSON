{
    "custom_item_1": {
        "description": "1.4 Ensure Databases running on RDS have encryption at rest enabled",
        "info": "Amazon RDS instances and snapshots can be encrypted at rest by enabling the encryption option on the Amazon RDS DB instance. Data that is encrypted at rest includes the underlying storage for a DB instance, its automated backups, read replicas, and snapshots. It is recommended that encryption at rest be enabled.\nEnabling encryption at rest will help ensure that the confidentiality of data stored in RDS, snapshots, and backups, is maintained.",
        "solution": "Using the Amazon unified CLI:\n\n* Perform a snapshot of the DB instance:\n\n  aws rds create-db-snapshot --db-snapshot-identifier __ --db-instance-identifier __\n\n* Confirm created snapshot is available (once snapshot process has completed):\n\n  aws rds describe-db-snapshots --query 'DBSnapshots[*].{DBSnapshotIdentifier:DBSnapshotIdentifier, DBInstanceIdentifier:DBInstanceIdentifier, Snapshotstatus:Status}'\n\n* List all KMS Customer Managed Keys:\n\n  aws kms list-aliases\n\n* Copy to source RDS snapshot (from previous step) to a destination snapshot which will be encrypted:\n\n  aws rds copy-db-snapshot --source-db-snapshot-identifier __ --target-db-snapshot-identifier __ --kms-key-id __\n\n* Restore a snapshot to the target DB instance(from previous step) with same values as original db instance with additional encrypted storage values:\n\n  aws rds restore-db-instance-from-db-snapshot --db-instance-identifier __ --db-snapshot-identifier __",
        "reference": "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeDBInstances",
        "xsl_stmt": "",
        "regex": ".+ : Storage Encrypted =",
        "not_expect": ".+ : Storage Encrypted = false"
    },
    "custom_item_2": {
        "description": "1.5 Ensure all EBS volumes for Web-Tier are encrypted",
        "info": "Elastic Block Storage (EBS) volumes can be encrypted using AWS Key Management Service (KMS). In this configuration, encryption and decryption are handled transparently and require no additional action from the user, an Amazon EC2 instance, or application. When an encrypted Amazon EBS volume is attached to a supported Amazon EC2 instance type, the data stored at rest on the volume, disk I/O, and snapshots created from the volume are all encrypted. The encryption occurs on the servers that host Amazon EC2 instances. Additionally, snapshots of encrypted volumes are automatically encrypted, and volumes that are created from encrypted snapshots are also automatically encrypted. It is recommended that all EBS volumes for the web tier be encrypted.\nEnabling encryption on EBS volumes will help ensure the confidentiality of data stored on those volumes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Note all the volume id's of unencrypted EBS volumes and create a snapshot for each of them:\n\n  aws ec2 create-snapshot --volume-id __ --description \"Snapshot for encryption operation\"\n\n* Note the SnapshotIdelement from the output of step 1 and copy the snapshot to an encrypted snapshot using the KMS key created for the Web-tier:\n\n  aws ec2 copy-snapshot --source-region __ --source-snapshot-id __ --description \"Encrypted snapshot.\" --encrypted --kms-key-id*\n\n  Note the SnapshotId element from the output of step 2 and create a new EBS volume from the encrypted snapshot in the same Availability Zone as the unencrypted volume:\n\n  aws ec2 create-volume --availability-zone __ --snapshot-id* Tag the newly created EBS volume using the Volume Id from the previous step_:_\n\n\n  aws ec2 create-tags --resources--tags Key=,Value=* Delete unencrypted EBS volume:\n\n  aws ec2 delete-volume --volume-id",
        "reference": "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeVolumes",
        "xsl_stmt": "",
        "not_expect": "Encrypted Volume ID ="
    },
    "custom_item_3": {
        "description": "1.6 Ensure all EBS volumes for App-Tier are encrypted",
        "info": "Elastic Block Storage (EBS) volumes can be encrypted using AWS Key Management Service (KMS). In this configuration, encryption and decryption are handled transparently and require no additional action from the user, an Amazon EC2 instance, or application. When an encrypted Amazon EBS volume is attached to a supported Amazon EC2 instance type, the data stored at rest on the volume, disk I/O, and snapshots created from the volume are all encrypted. The encryption occurs on the servers that host Amazon EC2 instances. Additionally, snapshots of encrypted volumes are automatically encrypted, and volumes that are created from encrypted snapshots are also automatically encrypted. It is recommended that all EBS volumes for the app tier be encrypted.\nEnabling encryption on EBS volumes will help ensure the confidentiality of data stored on those volumes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Note all the volume id's of unencrypted EBS volumes and create a snapshot for each of them:\n\n  aws ec2 create-snapshot --volume-id __ --description \"Snapshot for encryption operation\"\n\n* Note the SnapshotIdelement from the output of step 1 and copy the snapshot to an encrypted snapshot using the KMS key created for the Web-tier:\n\n  aws ec2 copy-snapshot --source-region __ --source-snapshot-id __ --description \"Encrypted snapshot.\" --encrypted --kms-key-id*\n\n  Note the SnapshotId element from the output of step 2 and create a new EBS volume from the encrypted snapshot in the same Availability Zone as the unencrypted volume:\n\n  aws ec2 create-volume --availability-zone __ --snapshot-id* Tag the newly created EBS volume using the Volume Id from the previous step_:_\n\n\n  aws ec2 create-tags --resources--tags Key=,Value=* Delete unencrypted EBS volume:\n\n  aws ec2 delete-volume --volume-id",
        "reference": "800-171|3.13.16,800-53|SC-28(1),800-53r5|SC-28(1),CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,TBA-FIISB|28.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeVolumes",
        "xsl_stmt": "",
        "not_expect": "Encrypted Volume ID ="
    },
    "custom_item_4": {
        "description": "1.7 Ensure all Customer owned Amazon Machine Images for Web Tier are not shared publicly",
        "info": "Amazon Machine Images (AMI) are an exact duplicate of the instance they were created from and will allow anyone with access to create a complete replica of the original instance. The original instance may contain intellectual property, proprietary applications, and configuration information that can be used to exploit or compromise any running instance in the web tier.\nAllowing public access to the Web Tier AMI may aid an adversary in identifying weaknesses in the application use or configuration.",
        "solution": "Using the Amazon unified command line interface:\n\n* For each AMI that is public remove group ALL from the launch permissions:\n\n  aws ec2 modify-image-attribute --image-id __ --launch-permission \"{\\\\",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeImages",
        "xsl_stmt": "",
        "regex": "Image ID = .* - Public Access =",
        "expect": "Image ID = .* - Public Access = false"
    },
    "custom_item_5": {
        "description": "1.8 Ensure all Customer owned Amazon Machine Images for Application Tier are not shared publicly",
        "info": "Amazon Machine Images are an exact duplicate of the instance they were created from and will allow anyone with access to create a complete replica of the original instance. The original instance may contain intellectual property, proprietary applications, and configuration information that can be used to exploit or compromise any running instance in the web tier.\nAllowing public access to the Application Tier AMI may aid an adversary in identifying weaknesses in the application use or configuration.",
        "solution": "Using the Amazon unified command line interface:\n\n* For each AMI that is public remove group ALL from the launch permissions:\n\n  aws ec2 modify-image-attribute --image-id __ --launch-permission \"{\\\\",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeImages",
        "xsl_stmt": "",
        "regex": "Image ID = .* - Public Access =",
        "expect": "Image ID = .* - Public Access = false"
    },
    "custom_item_6": {
        "description": "1.9 Describe Load Balancers - SSL certificate",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "@WEB_TIER_ELB@ : Certificate ARN =",
        "expect": "@WEB_TIER_ELB@ : Certificate ARN = .*"
    },
    "custom_item_7": {
        "description": "1.9 Describe Load Balancers - TCP pass-through",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "@WEB_TIER_ELB@ : Protocol =",
        "expect": "@WEB_TIER_ELB@ : Protocol = TCP"
    },
    "custom_item_8": {
        "description": "1.10 Ensure Web Tier ELB have the latest SSL Security Policies configured",
        "info": "Elastic Load Balancing uses an Secure Socket Layer (SSL) negotiation configuration, known as a security policy, to negotiate SSL/TLS connections between a client and the load balancer. A security policy is a combination of SSL/TLS protocols, ciphers, and the Server Order Preference option.\n\n  Elastic Load Balancing supports configuring your load balancer to use either predefined or custom security policies.\n\n  Secure Sockets Layer (SSL) and Transport Layer Security (TLS) are cryptographic protocols that are used to encrypt confidential data over insecure networks such as the Internet. The TLS protocol is a newer version of the SSL protocol. In the Elastic Load Balancing documentation, we refer to both SSL and TLS protocols as the SSL protocol.\n\n* Note: an SSL certificate configured on the ELB and an SSL Security Policy is not mandatory if you are terminating SSL connections directly on the Web Tier EC2 instances, and using a TCP listener on the ELB (TCP pass-through)\nMaking sure the latest ELB SSL Security Policy is used will ensure the SSL/TLS connection will be negotiated using only the appropriate cryptographic protocols deemed safe with no proven vulnerabilities.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n  (Note that you should replacewith your Web-tier ELB name, and __ with the proper policy name)\n\n  aws elb set-load-balancer-policies-of-listener --load-balancer-name--load-balancer-port 443 --policy-names __",
        "reference": "800-53|SC-17,800-53r5|SC-17,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-17,ITSG-33|SC-17a.,LEVEL|1A,NESA|T7.4.2,NIAv2|CY5a,NIAv2|CY10,NIAv2|CY12,NIAv2|SS25",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "Policy Name =",
        "expect": "Policy Name = .*"
    },
    "custom_item_9": {
        "description": "1.16 Ensure all S3 buckets have policy to require server-side and in transit encryption for all objects stored in bucket.",
        "info": "Data in transit is data being accessed over the network, and therefore could be intercepted by someone else on the network or with access to the physical media the network uses. On an ethernet network, that could be someone with the ability to tap a cable, configure a switch to mirror traffic, or fool your client or a router into directing traffic to them before it moves on to the final destination.\n\n  Server-side encryption (SSE) is about data encryption at rest--that is, Amazon S3 encrypts your data at the object level as it writes it to disks in its data centers and decrypts it for you when you access it.\n\n  Amazon S3 offers 3 options of encrypting data at rest, depending on how you choose to manage the encryption keys:\n\n* Use SSE with Amazon S3-Managed Keys\n* Use SSE with AWS KMS-Managed Keys\n* Use SSE with Customer-Provided Keys\n\n  At the time of object creation--that is, when you are uploading a new object or making a copy of an existing object--you can specify if you want Amazon S3 to encrypt your data by adding the \"x-amz-server-side-encryptionheader\" to the request. Set the value of the header to the encryption algorithm AES256 that Amazon S3 supports. Amazon S3 confirms that your object is stored using server-side encryption by returning the response header \"x-amz-server-side-encryption\".\n\n  No matter which of the three options you choose, you can create and attach a S3 bucket policy, that will deny any object creation S3 API (PUT Object, PUT Object - Copy, POST Object, Initiate Multipart Upload), if the request does not include the \"x-amz-server-side-encryption\" header requesting server-side encryption, and if the request was not done using SSL\\TLS.\nWhen it comes to data at rest, if kept unencrypted, there are a few threats that one can think of, especially when the data is stored in the cloud:\n\n* the threat that attackers are able to compromise Amazon S3 and gain access to the data that is stored in the Amazon S3 buckets.\n* the \"insider threat\" where a malicious or rogue administrator steals a physical disk drive or server that contains data a customer has in the Amazon S3 buckets.\n* the threat that a government uses a subpoena or warrant to get access to a customer's data in Amazon S3 without their knowledge.\n\n  If data in transit is kept unencrypted:\n\n* Malicious users may intercept or monitor plaintext data transmitting across unencrypted network and gain unauthorized access to that jeopardize the confidentiality of the sensitive data.\n\n  In all of these scenarios, encrypting data at rest and in transit, and properly managing the encryption keys can help mitigate the risk of unauthorized access to that data.",
        "solution": "Perform the following to ensure all objects placed in S3 are encrypted in transit and at rest:\n\n* Create a new file, add the following to it, and save it as policy.json:\n\n\n   {\n \"Version\":\"2012-10-17\",\n \"Id\":\"PutObjPolicy\",\n \"Statement\":{\n \"Sid\":\"DenyUnEncryptedObjectUploads\",\n \"Effect\":\"Deny\",\n \"Principal\":\"*\",\n \"Action\":\"s3:PutObject\",\n \"Resource\":\"arn:aws:s3:::__/*\",\n \"Condition\":{\n \"Null\":{ \"s3:x-amz-server-side-encryption\":\"true\" },\n \"Bool\": { \"aws:SecureTransport\": \"false\" }\n }\n }\n}\n\n* Attach the above bucket policy to each S3 bucket:\n\n  aws s3api put-bucket-policy --bucket __ --policy file://policy.json",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetBucketPolicy",
        "regex": "full encryption configured",
        "expect": "full encryption configured",
        "bucket_name": "@S3_BUCKET_NAME@"
    },
    "custom_item_10": {
        "description": "2.1 Ensure IAM Policy for EC2 IAM Roles for Web tier is configured",
        "info": "By default, IAM users, groups, and roles have no access to AWS resources.\n\n  IAM policies are the means by which privileges are granted to users, groups, or roles defined with AWS Identity Access Management.\n\n  An IAM policy is a document that formally states one or more permissions using the following structure:\n\n* Actions: what actions are allowed (each AWS service has its own set of actions)\n* Resources: which resources will be affected by the action\n* Effect: what effect will be when the subject (user/group/roles) requests access\n\n  Policies are documents that are created using JSON. A policy consists of one or more statements, each of which describes one set of permissions.\nEnsure IAM policy defines a minimum level of access to AWS services : S3, Cloudwatch, KMS\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* If doesn't exist, create an instance profile for Web tier instances:\n\n  aws iam create-instance-profile --instance-profile-name __\n\n* If doesn't exist, create an IAM role for the instance profile:\n\n* Create a trust relationship policy document and save it locally as /tmp/TrustPolicy.json:\n\n  {\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n {\n \"Effect\": \"Allow\",\n \"Principal\": {\n \"Service\": \"ec2.amazonaws.com\"\n },\n \"Action\": \"sts:AssumeRole\"\n }\n ]\n}\n\n* Create the IAM role using the above trust policy:\n\n  aws iam create-role --role-name <_web_tier_iam_role_> --assume-role-policy-document file:///tmp/TrustPolicy.json\n\n* Add the IAM role created to the Instance profile:\n\n  aws iam add-role-to-instance-profile --role-name <_web_tier_iam_role_> --instance-profile-name __\n\n* If doesn't exist, create an IAM managed policy for Web tier instances, and note the policy ARN:\n\n  aws iam create-policy --policy-name __ --policy-document file://policy\n\n* Attach the IAM policy created to the Web tier IAM role:\n\n  aws iam attach-role-policy --policy-arn--role-name <_web_tier_iam_role_>",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),800-53r5|AC-3(3),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(3),LEVEL|1A,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSSv3.2.1|7.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetRolePolicy",
        "json_transform": ".[]|.PolicyDocument",
        "policy_name": "@WEB_TIER_ROLE_POLICY@",
        "role_name": "@WEB_TIER_ROLE@"
    },
    "custom_item_11": {
        "description": "2.2 Ensure IAM Policy for EC2 IAM Roles for App tier is configured",
        "info": "By default, IAM users, groups, and roles have no access to AWS resources.\n\n  IAM policies are the means by which privileges are granted to users, groups, or roles defined with AWS Identity Access Management.\n\n  An IAM policy is a document that formally states one or more permissions using the following structure:\n\n* Actions: what actions are allowed (each AWS service has its own set of actions)\n* Resources: which resources will be affected by the action\n* Effect: what effect will be when the subject (user/group/roles) requests access\n\n  Policies are documents that are created using JSON. A policy consists of one or more statements, each of which describes one set of permissions.\nEnsure IAM policy defines a minimum level of access to AWS services : S3, Cloudwatch, KMS\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* If doesn't exist, create an instance profile for App tier instances:\n\n  aws iam create-instance-profile --instance-profile-name <_app_tier_instance_profile_>\n\n* If doesn't exist, create an IAM role for the instance profile:\n\n* Create a trust relationship policy document and save it locally as /tmp/TrustPolicy.json:\n\n  {\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n {\n \"Effect\": \"Allow\",\n \"Principal\": {\n \"Service\": \"ec2.amazonaws.com\"\n },\n \"Action\": \"sts:AssumeRole\"\n }\n ]\n}\n\n* Create the IAM role using the above trust policy:\n\n  aws iam create-role --role-name <_app_tier_iam_role_> --assume-role-policy-document file:///tmp/TrustPolicy.json\n\n\n\n* Add the IAM role created to the Instance profile:\n\n  aws iam add-role-to-instance-profile --role-name <_app_tier_iam_role_> --instance-profile-name <_app_tier_instance_profile_>\n\n* If doesn't exist, create an IAM managed policy for Web tier instances, and note the policy ARN:\n\n  aws iam create-policy --policy-name <_iam_policy_name_> --policy-document file://policy\n\n* Attach the IAM policy created to the App tier IAM role:\n\n  aws iam attach-role-policy --policy-arn <_iam_policy_arn_> --role-name <_app_tier_iam_role_>",
        "reference": "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),800-53r5|AC-3(3),CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3(3),LEVEL|1A,NESA|T5.5.4,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSSv3.2.1|7.2,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetRolePolicy",
        "json_transform": ".[]|.PolicyDocument",
        "policy_name": "@APP_TIER_ROLE_POLICY@",
        "role_name": "@APP_TIER_ROLE@"
    },
    "custom_item_12": {
        "description": "2.3 Ensure an IAM Role for Amazon EC2 is created for Web Tier",
        "info": "An IAM role is similar to a user, in that it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it.\n\n  Also, a role does not have any credentials (password or access keys) associated with it. Instead, if a user is assigned to a role, access keys are created dynamically and provided to the user.\n\nYou can use roles to delegate access to users, applications, or services that don't normally have access to your AWS resources. Applications must sign their API requests with AWS credentials. Therefore, if you are an application developer, you need a strategy for managing credentials for your applications that run on EC2 instances.\n\n  IAM Roles for EC2 allow application running within an EC2 instance assume the role applied to the instance.\nProvides dynamic authentication credentials to which can be used with Web-Tier EC Instances once launched with the IAM Role for EC2",
        "solution": "Using the Amazon unified command line interface:\n\n* If doesn't exist, create an instance profile for Web tier instances:\n\n  aws iam create-instance-profile --instance-profile-name __\n\n* If doesn't exist, create an IAM role for the instance profile:\n\n* Create a trust relationship policy document and save it locally as /tmp/TrustPolicy.json:\n\n  {\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n {\n \"Effect\": \"Allow\",\n \"Principal\": {\n \"Service\": \"ec2.amazonaws.com\"\n },\n \"Action\": \"sts:AssumeRole\"\n }\n ]\n}\n\n* Create the IAM role using the above trust policy:\n\n  aws iam create-role --role-name <_web_tier_iam_role_> --assume-role-policy-document file:///tmp/TrustPolicy.json\n\n\n\n* Add the IAM role created to the Instance profile:\n\n  aws iam add-role-to-instance-profile --role-name <_web_tier_iam_role_> --instance-profile-name __",
        "reference": "800-171|3.1.1,800-53|AC-3(7),800-53r5|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListRoles",
        "xsl_stmt": "",
        "regex": "Web Tier Role Name =",
        "expect": "Web Tier Role Name = @WEB_TIER_ROLE@"
    },
    "custom_item_13": {
        "description": "2.4 Ensure an IAM Role for Amazon EC2 is created for App Tier",
        "info": "An IAM role is similar to a user, in that it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it.\n\n  Also, a role does not have any credentials (password or access keys) associated with it. Instead, if a user is assigned to a role, access keys are created dynamically and provided to the user.\n\nYou can use roles to delegate access to users, applications, or services that don't normally have access to your AWS resources. Applications must sign their API requests with AWS credentials. Therefore, if you are an application developer, you need a strategy for managing credentials for your applications that run on EC2 instances.\n\n  IAM Roles for EC2 allow application running within an EC2 instance assume the role applied to the instance.\nProvides dynamic authentication credentials to which can be used with Application Tier EC2-Instances once launched with the IAM Role for EC2",
        "solution": "Using the Amazon unified command line interface:\n\n* If doesn't exist, create an instance profile for App tier instances:\n\n  aws iam create-instance-profile --instance-profile-name <_app_tier_instance_profile_>\n\n* If doesn't exist, create an IAM role for the instance profile:\n\n* Create a trust relationship policy document and save it locally as /tmp/TrustPolicy.json:\n\n  {\n \"Version\": \"2012-10-17\",\n \"Statement\": [\n {\n \"Effect\": \"Allow\",\n \"Principal\": {\n \"Service\": \"ec2.amazonaws.com\"\n },\n \"Action\": \"sts:AssumeRole\"\n }\n ]\n}\n\n* Create the IAM role using the above trust policy:\n\n  aws iam create-role --role-name <_app_tier_iam_role_> --assume-role-policy-document file:///tmp/TrustPolicy.json\n\n\n\n* Add the IAM role created to the Instance profile:\n\n  aws iam add-role-to-instance-profile --role-name <_app_tier_iam_role_> --instance-profile-name <_app_tier_instance_profile_>",
        "reference": "800-171|3.1.1,800-53|AC-3(7),800-53r5|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListRoles",
        "xsl_stmt": "",
        "regex": "App Tier Role Name =",
        "expect": "App Tier Role Name = @APP_TIER_ROLE@"
    },
    "custom_item_14": {
        "description": "2.5 Ensure AutoScaling Group Launch Configuration for Web Tier is configured to use a customer created Web-Tier IAM Role",
        "info": "An IAM role is similar to a user, in that it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it.\n\n  Also, a role does not have any credentials (password or access keys) associated with it. Instead, if a user is assigned to a role, access keys are created dynamically and provided to the user.\n\nYou can use roles to delegate access to users, applications, or services that don't normally have access to your AWS resources. Applications must sign their API requests with AWS credentials. Therefore, if you are an application developer, you need a strategy for managing credentials for your applications that run on EC2 instances.\n\n  IAM Roles for EC2 allow application running within an EC2 instance assume the role applied to the instance.\nEnsures all EC2 instances within the Web-Tier auto scaling group have been launched with an IAM Role for EC2",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the Web tier using the Web tier IAM instance profile :\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_web_tier_launch_config_> --image-id <_web_tier_ami_> --key-name <_your_key_pair_> --security-groups--instance-type--iam-instance-profile <_web_tier_instance_profile_>",
        "reference": "800-171|3.1.1,800-53|AC-3(7),800-53r5|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListRoles",
        "xsl_stmt": "",
        "regex": "Web Tier Launch Config Role Name =",
        "expect": "Web Tier Launch Config Role Name = @WEB_TIER_LAUNCH_ROLE_NAME@"
    },
    "custom_item_15": {
        "description": "2.6 Ensure AutoScaling Group Launch Configuration for App Tier is configured to use an App-Tier IAM Role",
        "info": "An IAM role is similar to a user, in that it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it.\n\n  Also, a role does not have any credentials (password or access keys) associated with it. Instead, if a user is assigned to a role, access keys are created dynamically and provided to the user.\n\nYou can use roles to delegate access to users, applications, or services that don't normally have access to your AWS resources. Applications must sign their API requests with AWS credentials. Therefore, if you are an application developer, you need a strategy for managing credentials for your applications that run on EC2 instances.\n\n  IAM Roles for EC2 allow application running within an EC2 instance assume the role applied to the instance.\nEnsures all EC2 instances within the App-Tier auto scaling group have been launched with an IAM Role for EC2",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the App tier using the App tier IAM instance profile :\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_app_tier_launch_config_> --image-id <_app_tier_ami>_ --key-name <_your_key_pair>_ --security-groups_ --instance-type <_desired_instance_type>_ --iam-instance-profile <_app_tier_instance_profile>_",
        "reference": "800-171|3.1.1,800-53|AC-3(7),800-53r5|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1A,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListRoles",
        "xsl_stmt": "",
        "regex": "App Tier Launch Config Role Name =",
        "expect": "App Tier Launch Config Role Name = @APP_TIER_LAUNCH_ROLE_NAME@"
    },
    "custom_item_16": {
        "description": "2.7 Ensure an IAM group for administration purposes is created",
        "info": "An IAM group is a collection of IAM users. You can use groups to specify permissions for a collection of users, which can make those permissions easier to manage for those users. For example, you could have a group called Admins and give that group the types of permissions that administrators typically need. Any user in that group automatically has the permissions that are assigned to the group. If a new user joins your organization and should have administrator privileges, you can assign the appropriate permissions by adding the user to that group. Similarly, if a person changes jobs in your organization, instead of editing that user's permissions, you can remove him or her from the old groups and add him or her to the appropriate new groups.\nThe IAM group will allow you to add or remove IAM users that require administrative privileges to the resources.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a new IAM group for administration purposes:\n\n  aws iam create-group --group-name <_iam_admin_group_name>_\n\n* Attach the Admin policy to the administration IAM group:\n\n  aws iam attach-group-policy --policy-arn <_admin_policy_arn>_ --group-name <_iam_admin_group_name>_",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListGroups",
        "xsl_stmt": "",
        "regex": "Admin Group Name =",
        "expect": "Admin Group Name = @ADMIN_GROUP_NAME@"
    },
    "custom_item_17": {
        "description": "2.8 Ensure an IAM policy that allows admin privileges for all services used is created - Policy Exist",
        "info": "A policy is a document that formally states one or more permissions.\n\n  Managed policies are standalone policies that you can attach to multiple users, groups, and roles in your AWS account. Managed policies apply only to identities (users, groups, and roles) - not resources. You must ensure that you have an IAM managed policy created with admin permissions for all the AWS services used by the application.\nAn IAM admin policy with permissions for all the AWS services used by the application must exist for administration purposes.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create an IAM managed admin policy for all AWS services used:\n\n  aws iam create-policy --policy-name <_admin_policy_name>_ --policy-document file://policy",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListPolicies",
        "xsl_stmt": "",
        "regex": "Admin Policy Name =",
        "expect": "Admin Policy Name = @ADMIN_POLICY_NAME@"
    },
    "custom_item_18": {
        "description": "2.8 Ensure an IAM policy that allows admin privileges for all services used is created - Review Policy Document",
        "info": "A policy is a document that formally states one or more permissions.\n\n  Managed policies are standalone policies that you can attach to multiple users, groups, and roles in your AWS account. Managed policies apply only to identities (users, groups, and roles) - not resources. You must ensure that you have an IAM managed policy created with admin permissions for all the AWS services used by the application.\nAn IAM admin policy with permissions for all the AWS services used by the application must exist for administration purposes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create an IAM managed admin policy for all AWS services used:\n\n  aws iam create-policy --policy-name <_admin_policy_name>_ --policy-document file://policy",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetPolicyVersion",
        "policy_arn": "@ADMIN_POLICY_ARN@"
    },
    "custom_item_19": {
        "description": "2.9 Ensure SNS Topics do not Allow Everyone To Publish",
        "info": "Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients--publishers and subscribers--also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic.\n\n  The entities who can publish messages to a SNS topic can be controlled by modifying the topic policy, and they can be:\n\n* The topic owner\n* Everyone\n* Specific AWS users or resources\n\n  From the above message publisher options you should make sure that \"Everyone\" is not used with any SNS topic in the AWS account.\nIf a SNS topic policy allows \"Everyone\" to publish messages to a specific topic, this could pose a security risk as any unauthenticated entity could send malicious messages to all the topic subscribers.",
        "solution": "Edit your existing policy by deleting the above snippet or replacing \"Principal\":{\"AWS\" : \"*\"} with \"Principal\":{\"AWS\" : \"__\"}, and save it locally as a .json file named policy.json.\n\n  Using the Amazon unified command line interface:\n\n* Set the new policy to the SNS topic\n\n  aws sns set-topic-attributes --topic-arn <_sns_topic_arn>_ --attribute-name Policy --attribute-value file://policy.json",
        "reference": "800-171|3.1.5,800-53|AC-6(7)(b),800-53r5|AC-6(7)(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.5,ITSG-33|AC-6,LEVEL|1A,NESA|M1.1.3,NESA|T5.1.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetPolicyVersion",
        "not_expect": "SNS Topics Allow Everyone To Publish"
    },
    "custom_item_20": {
        "description": "2.10 Ensure SNS Topics do not Allow Everyone To Subscribe",
        "info": "Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients. In Amazon SNS, there are two types of clients--publishers and subscribers--also referred to as producers and consumers. Publishers communicate asynchronously with subscribers by producing and sending a message to a topic, which is a logical access point and communication channel. Subscribers (i.e., web servers, email addresses, Amazon SQS queues, AWS Lambda functions) consume or receive the message or notification over one of the supported protocols (i.e., Amazon SQS, HTTP/S, email, SMS, Lambda) when they are subscribed to the topic.\n\n  The entities who can subscribe to a SNS topic can be controlled by modifying the topic policy, and they can be:\n\n* The topic owner\n* Everyone\n* Specific AWS users or resources\n* Users whose endpoint URL,protocol, email address, or ARN from a Subscriberequest match a specified value\n\n  From the above topic subscribers, you should make sure that \"Everyone\" is not used with any SNS topic in the AWS account.\nIf a SNS topic policy allows \"Everyone\" to subscribe to a specific topic, this could pose a security risk as any unauthenticated entity could subscribe and receive messages from the topic publishers, messages that should be destined only to specific, known subscribers.",
        "solution": "Edit your existing policy by deleting the above snippet or replacing \"Principal\":{\"AWS\" : \"*\"} with \"Principal\":{\"AWS\" : \"__\"}, and save it locally as a .json file named policy.json.\n\n  Using the Amazon unified command line interface:\n\n* Set the new policy to the SNS topic\n\n  aws sns set-topic-attributes --topic-arn <_sns_topic_arn>_ --attribute-name Policy --attribute-value file://policy.json",
        "reference": "800-171|3.1.5,800-53|AC-6(7)(b),800-53r5|AC-6(7)(b),CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.5,ITSG-33|AC-6,LEVEL|1A,NESA|M1.1.3,NESA|T5.1.1,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetPolicyVersion",
        "not_expect": "SNS Topics Allow Everyone To Subscribe"
    },
    "custom_item_21": {
        "description": "3.1 Ensure each Auto-Scaling Group has an associated Elastic Load Balancer",
        "info": "Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC.\n\n  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC.\n\n  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure.\nIntegrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling.\n\n  Through Auto-Scaling Group configuration you can define:\n\n* minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group\n* Availability Zones / subnets used",
        "solution": "Using the Amazon unified command line interface:\n\n* List existing load balancers:\n\n  aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}'\n\n  or\n\n* Create new load balancer:\n\n  aws elb create-load-balancer --load-balancer-name __ --listeners __ --subnets--security-groups __\n\n* Attached load balancer from previous steps to autoscaling group:\n\n  aws autoscaling attach-load-balancers --load-balancer-names--auto-scaling-group-name",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|1A,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeAutoScalingGroups",
        "xsl_stmt": "",
        "regex": "Load Balancer Name =",
        "not_expect": "Load Balancer Name =$"
    },
    "custom_item_22": {
        "description": "3.2 Ensure each Auto-Scaling Group is configured for multiple Availability Zones",
        "info": "Auto Scaling helps maintain application availability and allows you to scale your Amazon EC2 capacity up or down automatically according to conditions you define.\n\n  You can use Auto Scaling to help ensure that you are running your desired number of Amazon EC2 instances or can automatically increase the number of Amazon EC2 instances during demand spikes to maintain performance and decrease capacity during lulls to reduce costs.\n\n  These properties can be defined within the Auto-Scaling Group configuration.\nEnsures high availability of the application and web tiers in the event of a host or Availability Zone failure.",
        "solution": "Using the Amazon Unified CLI:\n\n* List all the subnets and the associated Availability Zones from the application VPC:\n\n  aws ec2 describe-subnets --query \"Subnets[?VpcId == '__'].{VPC:VpcId, Subnet:SubnetId, AZ:AvailabilityZone, CIDR:CidrBlock}\"\n\n* Update AutoScaling Group to include more than 1 Availability Zones within the same VPC:\n\n  aws autoscaling update-auto-scaling-group --auto-scaling-group-name __ --availability-zones __",
        "reference": "800-53|SI-13(5),800-53r5|SI-13(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-13(5),LEVEL|1A,TBA-FIISB|39.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeAutoScalingGroups",
        "xsl_stmt": "",
        "regex": ".* - Availability Zone 1 =",
        "not_expect": ".* - Availability Zone 1 =.* Availability Zone 2 =$"
    },
    "custom_item_23": {
        "description": "3.3 Ensure Auto-Scaling Launch Configuration for Web-Tier is configured to use an approved Amazon Machine Image",
        "info": "Auto Scaling helps maintain application availability and allows you to scale your Amazon EC2 capacity up or down automatically according to conditions you define.\n\n  You can use Auto Scaling to help ensure that you are running your desired number of Amazon EC2 instances or can automatically increase the number of Amazon EC2 instances during demand spikes to maintain performance and decrease capacity during lulls to reduce costs.\n\n  These properties can be defined within the Auto-Scaling Group configuration.\n\n  Additional properties can be defined through the launch configuration such as:\n\n* Instance Type\n* Amazon Machine Image (Pre-configured Operating System Images - allows for O.S Hardening)\n* IAM Role\n* Security Groups\n\n  Your Organization must maintain a list of approved AMIs. Use these when creating Auto-Scaling Groups.\nInstances within an Auto-Scaling Group are launched from an Amazon Machine Image (AMI) which itself is defined within the Launch Configuration. AMIs should be configured to follow security best practices as is defined within the CIS Benchmark for Amazon Linux or your other desired operating system.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the Web tier using the approved Web tier AMI from your organization's list:\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_new_web_tier_launch_config_> --image-id <_web_tier_ami_> --key-name <_your_key_pair_> --security-groups--instance-type--iam-instance-profile <_web_tier_instance_profile_>",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "regex": ".* - Image ID =",
        "expect": ".* - Image ID = .*"
    },
    "custom_item_24": {
        "description": "3.4 Ensure Auto-Scaling Launch Configuration for App-Tier is configured to use an approved Amazon Machine Image",
        "info": "Auto Scaling helps maintain application availability and allows you to scale your Amazon EC2 capacity up or down automatically according to conditions you define.\n\n  You should use Auto Scaling to help ensure that you are running your desired number of Amazon EC2 instances or can automatically increase the number of Amazon EC2 instances during demand spikes to maintain performance and decrease capacity during lulls to reduce costs.\n\n  These properties can be defined within the Auto-Scaling Group configuration.\n\n  Additional properties can be defined through the launch configuration such as:\n\n* Instance Type\n* Amazon Machine Image (Pre-configured Operating System Images - allows for O.S Hardening)\n* IAM Role\n* Security Groups\n\n  Your organization must maintain a list of approved AMIs. Use these when creating Auto-Scaling Groups.\nInstances within an Auto-Scaling Group are launched from an Amazon Machine Image (AMI) which itself is defined within the Launch Configuration. The AMI should be configured to follow security best practices as is defined within the CIS Benchmark for Amazon Linux or your other desired operating system.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the App tier using the approved App tier AMI from your organization's list:\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_new_app_tier_launch_config_> --image-id <_app_tier_ami>_ --key-name <_your_key_pair>_ --security-groups_ --instance-type <_desired_instance_type>_ --iam-instance-profile <_app_tier_instance_profile>_",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "regex": ".* - Image ID =",
        "expect": ".* - Image ID = .*"
    },
    "custom_item_25": {
        "description": "3.5 Ensure Relational Database Service is Multi-AZ Enabled",
        "info": "Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.\n\n  There are 6 database engines available for customer to run their database workloads on:\n\n* Amazon Aurora (MySQL Compatible)\n* MySQL\n* MariaDB\n* Oracle\n* Microsoft SQL Server\n* PostgreSQL\nProvides AWS managed high availability of the Database Tier across 2 availability zones within a region through asynchronous replication at the data layer.",
        "solution": "Using the Amazon unified command line interface:\n\n* Modify each no-multi-az DB instance, and make it Multi-AZ enabled:\n\n  aws rds modify-db-instance --db-instance-identifier--multi-az",
        "reference": "800-53|SI-13(5),800-53r5|SI-13(5),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-13(5),LEVEL|1A,TBA-FIISB|39.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeDBInstances",
        "xsl_stmt": "",
        "regex": ".* : MultiAZ =",
        "expect": ".* : MultiAZ = true"
    },
    "custom_item_26": {
        "description": "3.6 Ensure Relational Database Service Instances have Auto Minor Version Upgrade Enabled",
        "info": "Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.\n\n  There are 6 database engines available for customer to run their database workloads on:\n\n* Amazon Aurora (MySQL Compatible)\n* MySQL\n* MariaDB\n* Oracle\n* Microsoft SQL Server\n* PostgreSQL\n\n  If the database engine used by your application supports it, ensure that the RDS Instances have Auto Minor Version Upgrade Enabled.\nEnsures automated patch management is in place on the RDS instance to ensure the database engine has all the latest patches applied.",
        "solution": "Using the Amazon unified command line interface:\n\n* Modify each DB instance with auto-minor-version-upgrade set to False, and enable auto-minor-version-upgrade:\n\n  aws rds modify-db-instance --db-instance-identifier--auto-minor-version-upgrade",
        "reference": "800-171|3.14.1,800-53|SI-2(5),800-53r5|SI-2(5),CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,LEVEL|1A,NESA|T7.6.2,NESA|T7.7.1,NIAv2|NS26b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeDBInstances",
        "xsl_stmt": "",
        "regex": ".* : Auto Minor Version Upgrade =",
        "expect": ".* : Auto Minor Version Upgrade = true"
    },
    "custom_item_27": {
        "description": "3.7 Ensure Relational Database Service backup retention policy is set",
        "info": "Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.\n\n  There are 6 database engines available for customer to run their database workloads on:\n\n* Amazon Aurora (MySQL Compatible)\n* MySQL\n* MariaDB\n* Oracle\n* Microsoft SQL Server\n* PostgreSQL\nProvides a managed backup function of the RDS Database, it is possible to define the backup window and retention period of the backup. Each customer should have a retention policy set for the type of data being stored. Recommend setting this to at least 7.\n\n  Possible values are from 0 to 35 days.",
        "solution": "Using the Amazon unified command line interface:\n\n* Modify each DB instance with Backup Retention Period of 0, and set a desired Backup Retention Period in days (recommended value = 7):\n\n  aws rds modify-db-instance --db-instance-identifier--backup-retention-period __",
        "reference": "800-171|3.8.9,800-53|CP-9,800-53r5|CP-9,CSF|PR.IP-4,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,LEVEL|1S,NESA|M5.2.3,NESA|T2.2.4",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeDBInstances",
        "xsl_stmt": ": Backup Retention Period =DaysBackup Retention Period Not Found",
        "regex": ".* : Backup Retention Period =",
        "expect": ".* : Backup Retention Period = ([7-9]|[1-2][0-9]|3[0-5])"
    },
    "custom_item_28": {
        "description": "3.8 Ensure Web Tier Elastic Load Balancer has application layer Health Check Configured",
        "info": "By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance.\n\n  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance.\n\n  Amazon ELB will periodically sends pings, attempts connections, or sends requests to test the EC2 instances, these tests are called health checks.\n\n  The status of the instances that are healthy at the time of the health check is InService.\n\n  The status of any instances that are unhealthy at the time of the health check is OutOfService.\n\n  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state.\n\nThe load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state\nEnsures availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:\n\n  {\n \"Target\": \"__\",\n \"Interval\": __,\n \"Timeout\": __,\n \"UnhealthyThreshold\": _,_\n \"HealthyThreshold\": __\n}\n\n* Modify Web tier ELB to include appropriate health check:\n\n  aws elb configure-health-check --load-balancer-name __ --health-check file:///tmp/ELBhealthcheck.json",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-6,800-53r5|AU-6,CN-L3|7.1.3.3(d),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6,LEVEL|1S,NESA|M5.2.5,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "Health Check =",
        "expect": "Health Check = .*"
    },
    "custom_item_29": {
        "description": "3.9 Ensure App Tier Elastic Load Balancer has application layer Health Check Configured",
        "info": "By default, an Auto-Scaling Group periodically uses the results of the EC2 instance status checks to determine the health status of each instance. If an instance fails the EC2 instance status checks, Auto-Scaling marks the instance as unhealthy and replaces the instance.\n\n  However, if you have attached one or more Elastic Load Balancing (ELB) load balancers to your Auto-Scaling Group and the instance fails the ELB health checks, Auto-Scaling does not replace the instance.\n\n  Amazon ELB will periodically sends pings, attempts connections, or sends requests to test the EC2 instances, these tests are called health checks.\n\n  The status of the instances that are healthy at the time of the health check is InService.\n\n  The status of any instances that are unhealthy at the time of the health check is OutOfService.\n\n  The load balancer performs health checks on all registered instances, whether the instance is in a healthy state or an unhealthy state.\n\nThe load balancer routes requests only to the healthy instances. When the load balancer determines that an instance is unhealthy, it stops routing requests to that instance. The load balancer resumes routing requests to the instance when it has been restored to a healthy state\nEnsures availability of back-end EC2 instances associated with an Amazon ELB through application layer health check (ex: http) instead of TCP health checks.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a JSON file containing the attributes you want to modify and save it locally as /tmp/ELBhealthcheck.json:\n\n  {\n \"Target\": \"__\",\n \"Interval\": __,\n \"Timeout\": __,\n \"UnhealthyThreshold\": _,_\n \"HealthyThreshold\": __\n}\n\n* Modify App tier ELB to include appropriate health check:\n\n  aws elb configure-health-check --load-balancer-name __ --health-check file:///tmp/ELBhealthcheck.json",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-6,800-53r5|AU-6,CN-L3|7.1.3.3(d),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.DP-4,CSF|PR.PT-1,CSF|RS.AN-1,CSF|RS.CO-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6,LEVEL|1S,NESA|M5.2.5,QCSC-v1|5.2.3,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "Health Check =",
        "expect": "Health Check = .*"
    },
    "custom_item_30": {
        "description": "3.10 Ensure S3 buckets have versioning enabled",
        "info": "Amazon S3 can further protect your data using versioning. Be sure to enable this feature.\n\n  Versioning is a means of keeping multiple variants of an object in the same bucket. You can use versioning to preserve, retrieve, and restore every version of every object stored in your Amazon S3 bucket. With versioning, you can easily recover from both unintended user actions and application failures. By default, requests retrieve the most recently written version. You can retrieve older versions of an object by specifying a version of the object in a request.\nVersioning-enabled buckets enable you to recover objects from accidental deletion or overwrite. For example:*\n\n  If you delete an object, instead of removing it permanently, Amazon S3 inserts a delete marker, which becomes the current object version. You can always restore the previous version.\n*\n\n  If you overwrite an object, it results in a new object version in the bucket. You can always restore the previous version.",
        "solution": "Using the Amazon unified command line interface:\n\n* Enable versioning for all the S3 buckets that does not have this feature enabled\n\n  aws s3api put-bucket-versioning --bucket_ --versioning-configuration Status=Enabled",
        "reference": "800-53|CP-10,800-53r5|CP-10,CSF|RC.RP-1,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.c,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(ii),ITSG-33|CP-10,ITSG-33|CP-10a.,LEVEL|1S,NESA|T2.2.4,QCSC-v1|5.2.3,QCSC-v1|10.2.1,QCSC-v1|11.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetBucketVersioning",
        "xsl_stmt": "",
        "regex": "Versioning Status =",
        "expect": "Versioning Status = Enabled",
        "bucket_name": "@S3_BUCKET_NAME@"
    },
    "custom_item_31": {
        "description": "3.13 Ensure Web Tier Auto-Scaling Group has an associated Elastic Load Balancer",
        "info": "Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC.\n\n  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC.\n\n  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure.\nIntegrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling.\n\n  Through Auto-Scaling Group configuration you can define:\n\n* minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group\n* Availability Zones / subnets used",
        "solution": "Using the Amazon unified command line interface:\n\n* List existing load balancers:\n\n  aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}'\n\n  or\n\n* Create new load balancer:\n\n  aws elb create-load-balancer --load-balancer-name--listeners __ --subnets--security-groups* Attached load balancer from previous steps to autoscaling group:\n\n  aws autoscaling attach-load-balancers --load-balancer-names--auto-scaling-group-name",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|1S,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "Load Balancer Name =",
        "expect": "Load Balancer Name = @WEB_TIER_AUTOSCALING_ELB@"
    },
    "custom_item_32": {
        "description": "3.14 Ensure App Tier Auto-Scaling Group has an associated Elastic Load Balancer",
        "info": "Elastic Load Balancing automatically distributes incoming application traffic across multiple Amazon EC2 instances within a VPC.\n\n  It enables greater levels of fault tolerance in your applications, seamlessly providing the required amount of load balancing capacity needed to distribute application traffic across 1 or more Availability Zones within a VPC.\n\n  Elastic Load Balancing must be integrated with Auto Scaling Groups to ensure that you have availability of compute resources in the event of a failure.\nIntegrating Auto Scaling Groups with an Elastic Load Balancer will help provide high availability and back-end EC2 instance scaling.\n\n  Through Auto-Scaling Group configuration you can define:\n\n* minimum / maximum number of EC2 instances to be launched by the Auto-Scaling Group\n* Availability Zones / subnets used",
        "solution": "Using the Amazon unified command line interface:\n\n* List existing load balancers:\n\n  aws elb describe-load-balancers --query 'LoadBalancerDescriptions[*].{ELBName:LoadBalancerName}'\n\n  or\n\n* Create new load balancer:\n\n  aws elb create-load-balancer --load-balancer-name--scheme internal --listeners <_listener_config_> --subnets __ --security-groups* Attached load balancer from previous steps to autoscaling group:\n\n  aws autoscaling attach-load-balancers --load-balancer-names--auto-scaling-group-name",
        "reference": "800-171|3.4.1,800-53|CM-8,800-53r5|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-8,LEVEL|1S,NESA|T1.2.1,NESA|T1.2.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "Load Balancer Name =",
        "expect": "Load Balancer Name = @APP_TIER_AUTOSCALING_ELB@"
    },
    "custom_item_33": {
        "description": "4.1 Ensure a SNS topic is created for sending out notifications from Cloudtwatch Alarms and Auto-Scaling Groups - CloudwatchAlarms",
        "info": "For the Cloudwatch alarms and Auto-Scaling Groups to be able to send out notifications, a SNS topic should be created.\n\n  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients.\n\n  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic.\nCloudwatch alarms and certain actions inside Auto-Scaling Groups needs to be sent out to administrators, in order to be acted upon.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new topic, and note the topic-arn value:\n\n  aws sns create-topic --name __\n\n* Create a subscription to the new topic:\n\n  aws sns subscribe --topic-arn--protocol __ --notification-endpoint __",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeAlarms",
        "xsl_stmt": "",
        "not_expect": "Alarm Name ="
    },
    "custom_item_34": {
        "description": "4.1 Ensure a SNS topic is created for sending out notifications from Cloudtwatch Alarms and Auto-Scaling Groups - List SNS Subscriptions",
        "info": "For the Cloudwatch alarms and Auto-Scaling Groups to be able to send out notifications, a SNS topic should be created.\n\n  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients.\n\n  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic.\nCloudwatch alarms and certain actions inside Auto-Scaling Groups needs to be sent out to administrators, in order to be acted upon.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new topic, and note the topic-arn value:\n\n  aws sns create-topic --name __\n\n* Create a subscription to the new topic:\n\n  aws sns subscribe --topic-arn--protocol __ --notification-endpoint __",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListSubscriptionsByTopic",
        "xsl_stmt": "",
        "not_expect": "SNS Subscription:"
    },
    "custom_item_35": {
        "description": "4.2 Ensure a SNS topic is created for sending out notifications from RDS events - RDS Event Subscriptions",
        "info": "For the RDS event subscriptions to be able to send out notifications, a SNS topic should be created.\n\n  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients.\n\n  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic.\nRDS events generaged through defined RDS event subscriptions needs to be sent out to administrators, in order to be acted upon.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new topic, and note the topic-arn value:\n\n  aws sns create-topic --name __\n\n* Create a subscription to the new topic:\n\n  aws sns subscribe --topic-arn--protocol __ --notification-endpoint __",
        "reference": "800-171|3.14.6,800-171|3.14.7,800-53|SI-4(5),800-53r5|SI-4(5),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|SI-4(5),LEVEL|1A,NESA|M1.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeEventSubscriptions",
        "xsl_stmt": "",
        "not_expect": "RDS Subscription:"
    },
    "custom_item_36": {
        "description": "4.2 Ensure a SNS topic is created for sending out notifications from RDS events - List SNS Subscriptions",
        "info": "For the RDS event subscriptions to be able to send out notifications, a SNS topic should be created.\n\n  Amazon Simple Notification Service (Amazon SNS) is a web service that coordinates and manages the delivery or sending of messages to subscribing endpoints or clients.\n\n  When using Amazon SNS, you (as the owner) create a topic and control access to it by defining policies that determine which publishers and subscribers can communicate with the topic.\nRDS events generaged through defined RDS event subscriptions needs to be sent out to administrators, in order to be acted upon.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new topic, and note the topic-arn value:\n\n  aws sns create-topic --name __\n\n* Create a subscription to the new topic:\n\n  aws sns subscribe --topic-arn--protocol __ --notification-endpoint __",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListSubscriptionsByTopic",
        "xsl_stmt": "",
        "not_expect": "SNS Subscription:"
    },
    "custom_item_37": {
        "description": "4.3 Ensure RDS event subscriptions are enabled for Instance level events",
        "info": "AWS Relational Database Services offers customers a managed database engine solution for hosting customer created databases which can allow for a reduction in operational burden on customers.\n\n  RDS event subscriptions provide notification of selected event changes at Data Base engine level such as:\n\n* Deletion\n* Failure\n* Failover\n* Low Storage\n* Maintentance\nEvent subscriptions are designed to provide incident notification of events which may affect the availability of a RDS database instance.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new event subscription for DB instance level events:\n\n  aws rds create-event-subscription --subscription-name--sns-topic-arn--source-type db-instance --event-categories __ --source-ids __ --enabled",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,LEVEL|1A,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeEventSubscriptions",
        "xsl_stmt": "",
        "not_expect": "RDS Source Type:"
    },
    "custom_item_38": {
        "description": "4.4 Ensure RDS event subscriptions are enabled for DB security groups",
        "info": "AWS Relational Database Services offers customers a managed database engine solution for hosting customer created databases which can allow for a reduction in operational burden on customers.\n\n  RDS event subscriptions provide notification of selected event changes at a DB security group level.\nEvent subscriptions are designed to provide incident notification of events which may affect the network availability of the RDS instance.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified CLI:\n\n* Create a new event subscription for DB Security Group events:\n\n  aws rds create-event-subscription --subscription-name--sns-topic-arn--source-type db-security-group --event-categories __ --source-ids __ --enabled",
        "reference": "800-171|3.3.8,800-53|AU-9,800-53r5|AU-9,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,LEVEL|1A,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeEventSubscriptions",
        "xsl_stmt": "",
        "not_expect": "RDS Source Type:"
    },
    "custom_item_39": {
        "description": "4.6 Ensure that a log metric filter for the Cloudwatch group assigned to the \"VPC Flow Logs\" is created",
        "info": "This recommendation builds upon the Foundation benchmark recommendation: \"Ensure VPC Flow Logging is Enabled in all Applicable Regions\"\n\n  VPC FLOW LOGS is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. Flow log data is stored using Amazon CloudWatch Logs. VPC flow logs can capture accepted traffic, rejected traffic, or all traffic.\n\n  METRIC FILTERS can be used to express how the service would extract metric observations from ingested events and transform them to data points in a CloudWatch metric. Metric filters are assigned to log groups, and all of the filters assigned to a log group are applied to their log streams.\n\n  A metric filter should be created for counting how many IP packets are rejected in the VPC flow logs.\nFor being able to quantify and have an accurate image of the rejected IP packets in the VPC, a metric filter must be assigned to the Cloudwatch log group created by the \"VPC Flow Logs\".",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a metric filter for the Cloudwatch Log group assigned to the \"VPC Flow Logs\":\n\n  aws logs put-metric-filter --log-group-name <_vpc_flow_log_group_name_> --filter-name <_vpc_flow_log___filter_name>_ --filter-pattern \"{ $.errorCode = \\\\",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeMetricFilters",
        "expect": "Metric Filter Established"
    },
    "custom_item_40": {
        "description": "4.7 Ensure that a Cloudwatch Alarm is created for the \"VPC Flow Logs\" metric filter, and an Alarm Action is configured",
        "info": "A Cloudwatch alarm watches a single metric over a time period you specify, and performs one or more actions based on the value of the metric relative to a given threshold over a number of time periods. The action is a notification sent to an Amazon SNS topic.\n\n  The Cloudwatch Alarm will trigger a notification being sent to the administrators every time the \"REJECT packets\" specified threshold is reached. The alarm should be created for the \"VPC Flow Logs\" metric, and the action should have a SNS topic configured.\nFor the administrators subscribed to a SNS topic to be able to receive notifications when IP packets are rejected inside the VPC, a Cloudwatch alarm must be configured for the \"VPC Flow Logs\" metric.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a Cloudwatch alarm for the VPC Flow Logs metric, and configure an Alarm Action:\n\n  aws cloudwatch put-metric-alarm --alarm-name <_vpc_flow_log_alarm_name>_ --alarm-actions _<__sns_topic__arn> --metric-name--namespace LogMetrics --statistic __ --period _--evaluation-periods _--threshold __ --comparison-operator __",
        "reference": "LEVEL|1S",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeAlarms",
        "xsl_stmt": "",
        "regex": "Alarm Name =",
        "expect": "Alarm Name = @VPC_FLOW_LOG_ALARM_NAME@ - Alarm Actions = @SNS_TOPIC_ARN@"
    },
    "custom_item_41": {
        "description": "5.3 Ensure AWS Cloudfront Logging is enabled",
        "info": "Amazon CloudFront is a web service that speeds up distribution of your static and dynamic web content, for example, .html, .css, .php, image, and media files, to end users. CloudFront delivers your content through a worldwide network of edge locations. When an end user requests content that you're serving with CloudFront, the user is routed to the edge location that provides the lowest latency, so content is delivered with the best possible performance. If the content is already in that edge location, CloudFront delivers it immediately. If the content is not currently in that edge location, CloudFront retrieves it from a customer defined Origin, such as AWS S3, AWS ELB or EC2.\nAccess logs are activity records that show you detailed information about each request made for your content. These logs can be used for security analysis regarding vulnerability and availability threats",
        "solution": "Using the Amazon unified command line interface:\n\n* For enabling logging first save locally the current distribution config:\n\n  aws cloudfront get-distribution-config --id--query \"DistributionConfig\" > /tmp/cf-distribution.json\n\n* Edit and replace \"Logging\" element in /tmp/cf-distribution.json with the below section:\n\n  \"Logging\": {\n \"Bucket\": \"\",\n \"Prefix\": \"cloudfrontlogs\",\n \"Enabled\": true,\n \"IncludeCookies\": false\n },\n\n* Retrieve the current ETag of your CloudFront distribution:\n\n  aws cloudfront get-distribution-config --id--query \"ETag\"\n\n* Update the CloudFront distribution using the edited config and the above Etag:\n\n  aws cloudfront update-distribution --id--distribution-config file:///tmp/cf-distribution.json --if-match",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "GetDistributionConfig",
        "xsl_stmt": "",
        "regex": "Logging =",
        "expect": "Logging = true",
        "distribution_id": "@APP_DISTRIBUTION_ID@"
    },
    "custom_item_42": {
        "description": "5.4 Ensure Cloudwatch Log Group is created for Web Tier",
        "info": "AWS CloudWatch Log groups define groups of log streams that share the same retention, monitoring, and access control settings. Each log stream has to belong to one log group.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nSeparating log group destinations on a per tier basis allows unique settings to be applied on a per group basis for:\n\n* Retention of logs\n* Access Controls\n\n* Export/Stream of data to other AWS Services for analysis/processing\n\n* AWS S3\n* AWS Lambda\n* AWS Elastic Search",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a Cloudwatch log group for the Web tier:\n\n  aws logs create-log-group --log-group-name __",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLogGroups",
        "json_transform": ".[] | .logGroups[].logGroupName",
        "expect": "@WEB_TIER_LOG_GROUP@"
    },
    "custom_item_43": {
        "description": "5.5 Ensure Cloudwatch Log Group is created for App Tier",
        "info": "AWS CloudWatch Log groups define groups of log streams that share the same retention, monitoring, and access control settings. Each log stream has to belong to one log group.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nSeparating log group destinations on a per tier basis allows unique settings to be applied on a per group basis for:\n\n* Retention of logs\n* Access Controls\n\n* Export/Stream of data to other AWS Services for analysis/processing\n\n* AWS S3\n* AWS Lambda\n* AWS Elastic Search",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a Cloudwatch log group for the App tier:\n\n  aws logs create-log-group --log-group-name <_app_tier_log_group>_",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1A,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLogGroups",
        "json_transform": ".[] | .logGroups[].logGroupName",
        "expect": "@APP_TIER_LOG_GROUP@"
    },
    "custom_item_44": {
        "description": "5.6 Ensure Cloudwatch Log Group for Web Tier has a retention period",
        "info": "Retention period should be used to specify how long log events are kept in CloudWatch Logs. Expired log events get deleted automatically. Just like metric filters, retention settings are also assigned to log groups, and the retention assigned to a log group is applied to their log streams.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nDifferent log groups may require different retention periods, depending on operational and regulatory constraints.",
        "solution": "Using the Amazon unified command line interface:\n\n* Put a retention policy for your Web tier Cloudwatch log group:\n\n  aws logs put-retention-policy --log-group-name <_web_tier_log_group>_ --retention-in-days __",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLogGroups",
        "regex": "^Retention Period Exist",
        "expect": "^Retention Period Exist"
    },
    "custom_item_45": {
        "description": "5.7 Ensure Cloudwatch Log Group for App Tier has a retention period",
        "info": "Retention period should be used to specify how long log events are kept in CloudWatch Logs. Expired log events get deleted automatically. Just like metric filters, retention settings are also assigned to log groups, and the retention assigned to a log group is applied to their log streams.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nDifferent log groups may require different retention periods, depending on operational and regulatory constraints.",
        "solution": "Using the Amazon unified command line interface:\n\n* Put a retention policy for your App tier Cloudwatch log group:\n\n  aws logs put-retention-policy --log-group-name <_app_tier_log_group>_ --retention-in-days __",
        "reference": "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),800-53r5|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9(4),ITSG-33|AU-9(4)(a),ITSG-33|AU-9(4)(b),LEVEL|1A,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.2.1|10.5,PCI-DSSv3.2.1|10.5.2,PCI-DSSv4.0|10.3.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|5.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLogGroups",
        "regex": "^Retention Period Exist",
        "expect": "^Retention Period Exist"
    },
    "custom_item_46": {
        "description": "5.8 Ensure an agent for AWS Cloudwatch Logs is installed within Auto-Scaling Group for Web-Tier",
        "info": "You can use CloudWatch Logs to monitor, store and access log files from an Amazon EC2 instance (application or system data).\n\n  With CloudWatch Logs, you can monitor your logs, in near real-time, for specific phrases, values or patterns (metrics). For example, you could set an alarm on the number of errors that occur in your system logs or view graphs of web request latency from your application logs. Log data can be stored and accessed for as long as you need using highly durable, low-cost storage so you don't have to worry about filling up hard drives.\n\n  A Cloudwatch agent needs to run within the Guest Operating System of each EC2 instance you wish to ship logs from.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nAllows for centralized logging, monitoring and incident reporting of both System level events and Application level events within EC2 instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a sample agent configuration file for Amazon Linux and save it as a text file (for example, awslogs.cfg) either on the AMI's filesystem, in a publicly accessible http/https location, or an Amazon S3 location (for example, s3:///__):\n\n  [general]\nstate_file = /var/awslogs/state/agent-state\n\n[/var/log/messages]\nfile = /var/log/messages\nlog_group_name = /var/log/messages\nlog_stream_name = {instance_id}\ndatetime_format = %b %d %H:%M:%S\n\n* Create a new Web tier Autoscaling Launch Configuration with UserData populated for installing Cloudwatch Logs agent:\n\n* Create and save locally a file containing the UserData, for example /tmp/UserData.txt:\n\n  #!/bin/bashcurl https://s3.amazonaws.com/aws-cloudwatch/downloads/latest/awslogs-agent-setup.py -Ochmod +x ./awslogs-agent-setup.py./awslogs-agent-setup.py -n -r us-east-1 -c s3:///__\n\n*NOTE:\n\n  You can install the CloudWatch Logs agent by specifying the us-east-1, us-west-1, us-west-2, eu-west-1, eu-central-1, ap-southeast-1, ap-southeast-2, ap-northeast-1, or sa-east-1 regions.aws autoscaling create-launch-configuration --launch-configuration-name <_web_tier_launch_config>_ --image-id <_web_tier_ami>_ --key-name <_your_key_pair>_ --security-groups--instance-type <_desired_instance_type>_ --iam-instance-profile <_web_tier_instance_profile>_ --user-data file:///tmp/UserData.txt",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-2d.,800-53r5|AU-2d.,CN-L3|8.1.4.3(a),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2d.,LEVEL|1M,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|GS7e,NIAv2|SM4,PCI-DSSv3.2.1|10.2,PCI-DSSv3.2.1|10.2.1,PCI-DSSv3.2.1|10.2.2,PCI-DSSv3.2.1|10.2.3,PCI-DSSv3.2.1|10.2.4,PCI-DSSv3.2.1|10.2.5,PCI-DSSv3.2.1|10.2.6,PCI-DSSv3.2.1|10.2.7,PCI-DSSv4.0|10.2.1,PCI-DSSv4.0|10.2.1.1,PCI-DSSv4.0|10.2.1.2,PCI-DSSv4.0|10.2.1.3,PCI-DSSv4.0|10.2.1.4,PCI-DSSv4.0|10.2.1.5,PCI-DSSv4.0|10.2.1.6,PCI-DSSv4.0|10.2.1.7,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "not_expect": "User Data ="
    },
    "custom_item_47": {
        "description": "5.9 Ensure an agent for AWS Cloudwatch Logs is installed within Auto-Scaling Group for App-Tier",
        "info": "You can use CloudWatch Logs to monitor, store and access log files from an Amazon EC2 instance (application or system data).\n\n  With CloudWatch Logs, you can monitor your logs, in near real-time, for specific phrases, values or patterns (metrics). For example, you could set an alarm on the number of errors that occur in your system logs or view graphs of web request latency from your application logs. Log data can be stored and accessed for as long as you need using highly durable, low-cost storage so you don't have to worry about filling up hard drives.\n\n  A Cloudwatch agent needs to run within the Guest Operating System of each EC2 instance you wish to ship logs from.\n\n  Note:\n\n* You can also use any third party log management tools (like Splunk, Loggly, AlertLogic Log Manager, etc.) as long as the recommendation goal is achieved.\n* The below Audit and Remediation steps need to be modified for your specific log management tool, as they are provided in the benchmark only for Amazon Cloudwatch\nAllows for centralized logging, monitoring and incident reporting of both System level events and Application level events within EC2 instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a sample agent configuration file for Amazon Linux and save it as a text file (for example, awslogs.cfg) either on the AMI's filesystem, in a publicly accessible http/https location, or an Amazon S3 location (for example, s3:///__):\n\n  [general]\nstate_file = /var/awslogs/state/agent-state\n\n[/var/log/messages]\nfile = /var/log/messages\nlog_group_name = /var/log/messages\nlog_stream_name = {instance_id}\ndatetime_format = %b %d %H:%M:%S\n\n* Create a new App tier Autoscaling Launch Configuration with UserData populated for installing Cloudwatch Logs agent:\n\n* Create and save locally a file containing the UserData, for example /tmp/UserData.txt:\n\n  #!/bin/bash\ncurl https://s3.amazonaws.com/aws-cloudwatch/downloads/latest/awslogs-agent-setup.py -O\nchmod +x ./awslogs-agent-setup.py\n./awslogs-agent-setup.py -n -r us-east-1 -c s3:///__\n\n*NOTE:\n\n  You can install the CloudWatch Logs agent by specifying the us-east-1, us-west-1, us-west-2, eu-west-1, eu-central-1, ap-southeast-1, ap-southeast-2, ap-northeast-1, or sa-east-1 regions.aws autoscaling create-launch-configuration --launch-configuration-name <_app_tier_launch_config>_ --image-id <_app_tier_ami>_ --key-name <_your_key_pair>_ --security-groups_ --instance-type <_desired_instance_type>_ --iam-instance-profile _<app_tier__instance_profile>--user-data file:///tmp/UserData.txt",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-2d.,800-53r5|AU-2d.,CN-L3|8.1.4.3(a),CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2d.,LEVEL|1M,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|GS7e,NIAv2|SM4,PCI-DSSv3.2.1|10.2,PCI-DSSv3.2.1|10.2.1,PCI-DSSv3.2.1|10.2.2,PCI-DSSv3.2.1|10.2.3,PCI-DSSv3.2.1|10.2.4,PCI-DSSv3.2.1|10.2.5,PCI-DSSv3.2.1|10.2.6,PCI-DSSv3.2.1|10.2.7,PCI-DSSv4.0|10.2.1,PCI-DSSv4.0|10.2.1.1,PCI-DSSv4.0|10.2.1.2,PCI-DSSv4.0|10.2.1.3,PCI-DSSv4.0|10.2.1.4,PCI-DSSv4.0|10.2.1.5,PCI-DSSv4.0|10.2.1.6,PCI-DSSv4.0|10.2.1.7,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "not_expect": "User Data ="
    },
    "custom_item_48": {
        "description": "5.10 Ensure an AWS Managed Config Rule for encrypted volumes is applied to Web Tier - Encryption",
        "info": "AWS Config provides you with a detailed inventory of your AWS resources and their current configuration, and continuously records configuration changes to these resources.\n\n  You can evaluate these configurations and changes for compliance with ideal configurations as defined by AWS Config Rules.\nEvaluation of Elastic Block Storage volume configuration to ensure encryption at rest is enabled which have been tagged as Web-Tier",
        "solution": "Using the Amazon unified command line interface:\n\n* Create locally a json file (similar with the below sample) with the configuration of the Config Rule, and save it as /tmp/ConfigRule.json:\n\n  {\n \"Description\": \"Checks whether Web Tier EBS volumes that are in an attached state are encrypted.\",\n \"ConfigRuleName\": \"encrypted-volumes-web-tier\",\n \"Source\": {\n \"Owner\": \"AWS\",\n \"SourceIdentifier\": \"ENCRYPTED_VOLUMES\"\n },\n \"InputParameters\": \"{\\\\",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeConfigRules",
        "regex": "Encrypted Volumes",
        "expect": "Encrypted Volumes Found"
    },
    "custom_item_49": {
        "description": "5.10 Ensure an AWS Managed Config Rule for encrypted volumes is applied to Web Tier - KMS ID",
        "info": "AWS Config provides you with a detailed inventory of your AWS resources and their current configuration, and continuously records configuration changes to these resources.\n\n  You can evaluate these configurations and changes for compliance with ideal configurations as defined by AWS Config Rules.\nEvaluation of Elastic Block Storage volume configuration to ensure encryption at rest is enabled which have been tagged as Web-Tier",
        "solution": "Using the Amazon unified command line interface:\n\n* Create locally a json file (similar with the below sample) with the configuration of the Config Rule, and save it as /tmp/ConfigRule.json:\n\n  {\n \"Description\": \"Checks whether Web Tier EBS volumes that are in an attached state are encrypted.\",\n \"ConfigRuleName\": \"encrypted-volumes-web-tier\",\n \"Source\": {\n \"Owner\": \"AWS\",\n \"SourceIdentifier\": \"ENCRYPTED_VOLUMES\"\n },\n \"InputParameters\": \"{\\\\",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeConfigRules",
        "regex": "KMS ID =",
        "not_expect": "KMS ID = Not Found"
    },
    "custom_item_50": {
        "description": "5.11 Ensure an AWS Managed Config Rule for encrypted volumes is applied to App Tier - Encryption",
        "info": "AWS Config provides you with a detailed inventory of your AWS resources and their current configuration, and continuously records configuration changes to these resources.\n\n  You can evaluate these configurations and changes for compliance with ideal configurations as defined by AWS Config Rules.\nEvaluation of Elastic Block Storage volume configuration to ensure encryption at rest is enabled which have been tagged as App-Tier",
        "solution": "Using the Amazon unified command line interface:\n\n* Create locally a json file (similar with the below sample) with the configuration of the Config Rule, and save it as /tmp/ConfigRule.json:\n\n  {\n \"Description\": \"Checks whether App Tier EBS volumes that are in an attached state are encrypted.\",\n \"ConfigRuleName\": \"encrypted-volumes-app-tier\",\n \"Source\": {\n \"Owner\": \"AWS\",\n \"SourceIdentifier\": \"ENCRYPTED_VOLUMES\"\n },\n \"InputParameters\": \"{\\\\",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeConfigRules",
        "regex": "Encrypted Volumes",
        "expect": "Encrypted Volumes Found"
    },
    "custom_item_51": {
        "description": "5.11 Ensure an AWS Managed Config Rule for encrypted volumes is applied to App Tier - KMS ID",
        "info": "AWS Config provides you with a detailed inventory of your AWS resources and their current configuration, and continuously records configuration changes to these resources.\n\n  You can evaluate these configurations and changes for compliance with ideal configurations as defined by AWS Config Rules.\nEvaluation of Elastic Block Storage volume configuration to ensure encryption at rest is enabled which have been tagged as App-Tier",
        "solution": "Using the Amazon unified command line interface:\n\n* Create locally a json file (similar with the below sample) with the configuration of the Config Rule, and save it as /tmp/ConfigRule.json:\n\n  {\n \"Description\": \"Checks whether App Tier EBS volumes that are in an attached state are encrypted.\",\n \"ConfigRuleName\": \"encrypted-volumes-app-tier\",\n \"Source\": {\n \"Owner\": \"AWS\",\n \"SourceIdentifier\": \"ENCRYPTED_VOLUMES\"\n },\n \"InputParameters\": \"{\\\\",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,LEVEL|1A,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeConfigRules",
        "regex": "KMS ID =",
        "not_expect": "KMS ID = Not Found"
    },
    "custom_item_52": {
        "description": "5.12 Ensure an AWS Managed Config Rule for EIPs attached to EC2 instances within VPC",
        "info": "AWS Config provides you with a detailed inventory of your AWS resources and their current configuration, and continuously records configuration changes to these resources.\n\n  You can evaluate these configurations and changes for compliance with ideal configurations as defined by AWS Config Rules.\nEvaluation of EC2 instance configuration to ensure there are no publicly addressable IP's attached which would violate the defence in depth model",
        "solution": "Using the Amazon unified command line interface:\n\n* Create locally a json file (similar with the below sample) with the configuration of the Config Rule, and save it as /tmp/ConfigRule.json:\n\n  \"Description\": \"Checks whether all EIP addresses allocated to a VPC are attached to EC2 instances or in-use ENIs.\",\n\"ConfigRuleName\": \"eip-attached\",\n\"Source\": {\n \"Owner\": \"AWS\",\n \"SourceIdentifier\": \"EIP_ATTACHED\"\n},\n\"Scope\": {\n \"ComplianceResourceTypes\": [\n \"AWS::EC2::EIP\"\n ]\n }\n}\n\n* Create a Config Rule using the configuration saved earlier:\n\n  aws configservice put-config-rule --config-rule file:///tmp/ConfigRule.json",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeConfigRules",
        "regex": "EIP_ATTACHED",
        "expect": "EIP_ATTACHED"
    },
    "custom_item_53": {
        "description": "6.3 Use CloudFront Content Distribution Network",
        "info": "Amazon CloudFront can be used to deliver either the entire website, including dynamic, static, streaming, and interactive content using a global network of edge locations. Requests for your content are automatically routed to the nearest edge location, so content is delivered with the best possible performance. Amazon CloudFront is optimized to work with other Amazon Web Services, like Amazon Simple Storage Service (Amazon S3), Amazon Elastic Compute Cloud (Amazon EC2), Amazon Elastic Load Balancing, and Amazon Route 53.\n\n  Amazon CloudFront gives you three options for accelerating your entire website while delivering your content securely over HTTPS from all of CloudFront's edge locations. In addition to delivering securely from the edge, you can also configure CloudFront to use HTTPS connections for origin fetches so that your data is encrypted end-to-end from your origin to your end users.\nUsing the Amazon CloudFront content delivery network will provide improved performance with the application as the content is delivered from the closest edge location in terms of DNS resolution latency.\n\n  It improves the ability of the application to absorb and mitigate potential distributed denial of service (DDOS) attacks and keep the application available for legitimate users.\n\n  The content can be delivered securely over HTTPS from all edge location between the customer and between the edge locations and the origin.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* You can either create a Cloudfront distribution only by specifying the origin domain name (ELB, S3 bucket or web server):\n\n  aws cloudfront create-distribution --origin-domain-name <_your_original_domain_name>_ --default-root-object index.html\n\n* Or by creating locally a distribution config file distconfig.json with all the Cloudfront distribution parameters:\n\n  aws cloudfront create-distribution --distribution-config file://distconfig.json",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "ListDistributions",
        "xsl_stmt": "",
        "not_expect": ".* : Domain Name ="
    },
    "custom_item_54": {
        "description": "6.5 Ensure subnets for the Web tier ELB are created",
        "info": "You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add one or more subnets in each Availability Zone. Each subnet must reside entirely within one Availability Zone and cannot span zones. Availability Zones are distinct locations that are engineered to be isolated from failures in other Availability Zones. By launching instances in separate Availability Zones, you can protect your applications from the failure of a single location. AWS assigns a unique ID to each subnet.\n\n  When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet in a VPC, the CIDR blocks of the subnets must not overlap.\n\n  Some AWS regions have more than 2 availability zones and it is recommended to use more than 2 where possible.\nAt least 2 subnets in 2 different availability zones (AZ) should be created in order to have fault tolerance and high availability from the perspective of resource deployment.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create subnets for Web tier ELB, and note the subnet id:\n\n  aws ec2 create-subnet --vpc-id--cidr-block* Tag the above subnets with the Web tier ELB tags:\n\n  aws ec2 create-tags --resources--tags Key=,Value=",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "@WEB_TIER_ELB@ : Subnet 1 =",
        "expect": "@WEB_TIER_ELB@ : Subnet 1 = .* : Subnet 2 = .*"
    },
    "custom_item_55": {
        "description": "6.6 Ensure subnets for the Web tier are created",
        "info": "You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add one or more subnets in each Availability Zone. Each subnet must reside entirely within one Availability Zone and cannot span zones. Availability Zones are distinct locations that are engineered to be isolated from failures in other Availability Zones. By launching instances in separate Availability Zones, you can protect your applications from the failure of a single location. AWS assigns a unique ID to each subnet.\n\n  When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet in a VPC, the CIDR blocks of the subnets must not overlap.\n\n  Some AWS regions have more than 2 availability zones and it is recommended to use more than 2 where possible.\nAt least 2 subnets in 2 different availability zones (AZ) should be created in order to have fault tolerance and high availability from the perspective of resource deployment.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create subnets for Web tier, and note the subnet id:\n\n  aws ec2 create-subnet --vpc-id--cidr-block* Tag the above subnets with the Web tier tags:\n\n  aws ec2 create-tags --resources--tags Key=,Value=",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSubnets",
        "xsl_stmt": "",
        "not_expect": "Subnet ID ="
    },
    "custom_item_56": {
        "description": "6.7 Ensure subnets for the App tier are created",
        "info": "You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add one or more subnets in each Availability Zone. Each subnet must reside entirely within one Availability Zone and cannot span zones. Availability Zones are distinct locations that are engineered to be isolated from failures in other Availability Zones. By launching instances in separate Availability Zones, you can protect your applications from the failure of a single location. AWS assigns a unique ID to each subnet.\n\n  When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet in a VPC, the CIDR blocks of the subnets must not overlap.\n\n  Some AWS regions have more than 2 availability zones and it is recommended to use more than 2 where possible.\nAt least 2 subnets in 2 different availability zones (AZ) should be created in order to have fault tolerance and high availability from the perspective of resource deployment.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create subnets for App tier, and note the subnet id:\n\n  aws ec2 create-subnet --vpc-id--cidr-block* Tag the above subnets with the App tier tags:\n\n  aws ec2 create-tags --resources--tags Key=,Value=",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSubnets",
        "xsl_stmt": "",
        "not_expect": "Subnet ID ="
    },
    "custom_item_57": {
        "description": "6.8 Ensure subnets for the Data tier are created",
        "info": "You can create a VPC that spans multiple Availability Zones. After creating a VPC, you can add one or more subnets in each Availability Zone. Each subnet must reside entirely within one Availability Zone and cannot span zones. Availability Zones are distinct locations that are engineered to be isolated from failures in other Availability Zones. By launching instances in separate Availability Zones, you can protect your applications from the failure of a single location. AWS assigns a unique ID to each subnet.\n\n  When you create a subnet, you specify the CIDR block for the subnet. The CIDR block of a subnet shouldn't be the same as the CIDR block for the VPC (for a single subnet in the VPC). The allowed block size is between a /28 netmask and /16 netmask. If you create more than one subnet in a VPC, the CIDR blocks of the subnets must not overlap.\n\n  Some AWS regions have more than 2 availability zones and it is recommended to use more than 2 where possible.\nAt least 2 subnets in 2 different availability zones (AZ) should be created in order to have fault tolerance and high availability from the perspective of resource deployment.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create subnets for Data tier, and note the subnet id:\n\n  aws ec2 create-subnet --vpc-id--cidr-block* Tag the above subnets with the Data tier tags:\n\n  aws ec2 create-tags --resources SubnetId1 SubnetId2 --tags Key=,Value=",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSubnets",
        "xsl_stmt": "",
        "not_expect": "Subnet ID ="
    },
    "custom_item_58": {
        "description": "6.9 Ensure Elastic IPs for the NAT Gateways are allocated",
        "info": "An Elastic IP address is a static, public IP address designed for dynamic cloud computing. You can associate an Elastic IP address with any instance, network interface for your VPC or a NAT Gateway. With an Elastic IP address, you can mask the failure of an instance by rapidly remapping the address to another instance in your VPC.\nIn order to be able to create NAT Gateways that allow Internet access from the private subnet of the VPC, Elastic IPs should be allocated for each NAT Gateway.\n\n  Some AWS Regions have more than 2 Availability Zones, in this case it is recommended to allocate an Elastic IP to each NAT Gateway in each of the public subnets used.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Allocate Elastic IP addreses for the number of NAT Gateways that you want to deploy:\n\n  aws ec2 allocate-address --domain vpc",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(21),800-53r5|SC-7(21),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.3,NIAv2|VL6,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeAddresses",
        "xsl_stmt": "",
        "not_expect": "Public IP ="
    },
    "custom_item_59": {
        "description": "6.10 Ensure NAT Gateways are created in at least 2 Availability Zones - Subnet1",
        "info": "You can use a network address translation (NAT) gateway to enable instances in a private subnet to connect to the Internet or other AWS services, but prevent the Internet from initiating a connection with those instances.\n\n  To create a NAT gateway, you must specify the public subnet in which the NAT gateway will reside. You must also specify an Elastic IP address to associate with the NAT gateway when you create it. This enables instances in your private subnets to communicate with the Internet.\n\n  Each NAT gateway is created in a specific Availability Zone and implemented with redundancy in that zone\nIn order to enable instances in a private subnets to connect to the Internet or other AWS services, but prevent the Internet from initiating a connection with those instances, NAT Gateways should be created in at least 2 Availability Zones.\n\n  Some AWS Regions have more than 2 Availability Zones, in this case it is recommended to create a NAT Gateway in each of the public subnets used.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a NAT Gateway in a public subnet from a different Availability Zone:\n\n  aws ec2 create-nat-gateway --subnet-id __ --allocation-id __\n\n  and/or\n\n  aws ec2 create-nat-gateway --subnet-id __ --allocation-id __",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSubnets",
        "xsl_stmt": "",
        "not_expect": "Availability Zone ="
    },
    "custom_item_60": {
        "description": "6.10 Ensure NAT Gateways are created in at least 2 Availability Zones - Subnet2",
        "info": "You can use a network address translation (NAT) gateway to enable instances in a private subnet to connect to the Internet or other AWS services, but prevent the Internet from initiating a connection with those instances.\n\n  To create a NAT gateway, you must specify the public subnet in which the NAT gateway will reside. You must also specify an Elastic IP address to associate with the NAT gateway when you create it. This enables instances in your private subnets to communicate with the Internet.\n\n  Each NAT gateway is created in a specific Availability Zone and implemented with redundancy in that zone\nIn order to enable instances in a private subnets to connect to the Internet or other AWS services, but prevent the Internet from initiating a connection with those instances, NAT Gateways should be created in at least 2 Availability Zones.\n\n  Some AWS Regions have more than 2 Availability Zones, in this case it is recommended to create a NAT Gateway in each of the public subnets used.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a NAT Gateway in a public subnet from a different Availability Zone:\n\n  aws ec2 create-nat-gateway --subnet-id __ --allocation-id __\n\n  and/or\n\n  aws ec2 create-nat-gateway --subnet-id __ --allocation-id __",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(22),800-53r5|SC-7(22),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSubnets",
        "xsl_stmt": "",
        "not_expect": "Availability Zone ="
    },
    "custom_item_61": {
        "description": "6.11 Ensure a route table for the public subnets is created",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nOnce a route table for the public subnet is created, all the subnets which should be public in the Web ELB tier can be associated with the public subnet.\n\n  The private subnet should only contain the default route (0.0.0.0/0) pointing to the Internet Gateway (IGW).\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a route table for your public subnets, and note the RouteTableId in the output:\n\n  aws ec2 create-route-table --vpc-id* Associate the new route table with the public subnets:\n\n  aws ec2 associate-route-table --route-table-id--subnet-idaws ec2 associate-route-table --route-table-id--subnet-id",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_62": {
        "description": "6.12 Ensure a route table for the private subnets is created",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nOnce a route table for the private subnet is created, all the subnets which should be private in the Web, App and Data tiers can be associated with the route table.\n\n  The route table should only contain the default route (0.0.0.0/0) pointing to the NAT Gateway.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create a route table for your private subnets, and note the RouteTableId in the output:\n\n* aws ec2 create-route-table --vpc-id* Associate the new route table with the private subnets:\n\n  aws ec2 associate-route-table --route-table-id--subnet-idaws ec2 associate-route-table --route-table-id--subnet-id",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_63": {
        "description": "6.13 Ensure Routing Table associated with Web tier ELB subnet have the default route (0.0.0.0/0) defined to allow connectivity",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nThe default route (0.0.0.0/0) should be pointing to the Internet Gateway in order to provide internet connectivity for the Web tier ELB.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* For the above route tables, if the default route (0.0.0.0/0) exists but it doesn't have an IGW configured as gateway:\n\n  aws ec2 replace-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __\n\n* For the above route tables, if the default route (0.0.0.0/0) doesn't exist:\n\n  aws ec2 create-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_64": {
        "description": "6.14 Ensure Routing Table associated with Web tier subnet have the default route (0.0.0.0/0) defined to allow connectivity",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nThe default route (0.0.0.0/0) should be pointing to the NAT Gateway in order to provide internet connectivity for the Web tier instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* For the above route tables, if the default route (0.0.0.0/0) exists but it doesn't have a NAT GW configured as gateway:\n\n  aws ec2 replace-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __\n\n* For the above route tables, if the default route (0.0.0.0/0) doesn't exist:\n\n  aws ec2 create-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_65": {
        "description": "6.15 Ensure Routing Table associated with App tier subnet have the default route (0.0.0.0/0) defined to allow connectivity",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nThe default route (0.0.0.0/0) should be pointing to the NAT Gateway in order to provide internet connectivity for the App tier instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* For the above route tables, if the default route (0.0.0.0/0) exists but it doesn't have a NAT GW configured as gateway:\n\n* aws ec2 replace-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __\n\n\n\n* For the above route tables, if the default route (0.0.0.0/0) doesn't exist:\n\n* aws ec2 create-route --route-table-id __ --destination-cidr-block 0.0.0.0/0 --gateway-id __",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_66": {
        "description": "6.16 Ensure Routing Table associated with Data tier subnet have NO default route (0.0.0.0/0) defined to allow connectivity",
        "info": "A _route table_ contains a set of rules, called _routes_, that are used to determine where network traffic is directed.\n\n  Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.\nThe default route (0.0.0.0/0) should not exist pointing to the NAT Gateway in order to restrict internet connectivity for the Data tier instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* For the above route tables, if the default route (0.0.0.0/0) exists and it has a NAT GW configured as gateway:\n\n* aws ec2 delete-route --route-table-id __ --destination-cidr-block 0.0.0.0/0",
        "reference": "800-171|3.13.1,800-53|SC-7(15),800-53r5|SC-7(15),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(15),LEVEL|1A,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeRouteTables",
        "xsl_stmt": ""
    },
    "custom_item_67": {
        "description": "6.17 Use a Web-Tier ELB Security Group to accept only HTTP/HTTPS",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\nThe SG associated with the Web tier ELB should allow connectivity from any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports.",
        "solution": "Using the Amazon unified command line interface:\n\n* First remove all the ingress rules for the security group associated with the Web tier ELB:\n\n  aws ec2 describe-security-groups --group-id <_security_group_id>_ --query \"SecurityGroups[0].IpPermissions\" > /tmp/IpPermissions.json\naws ec2 revoke-security-group-ingress --group-id <_security_group_id>_ --ip-permissions file:///tmp/IpPermissions.json\n\n* create locally the below json file containing ingress rules for any source IP (0.0.0.0/0) only for the HTTP (TCP 80) and HTTPS (TCP 443) ports and name it IpPermissions.json:\n\n  [\n {\n \"PrefixListIds\": [],\n \"FromPort\": 80,\n \"IpRanges\": [\n {\n \"CidrIp\": \"0.0.0.0/0\"\n }\n ],\n \"ToPort\": 80,\n \"IpProtocol\": \"tcp\",\n \"UserIdGroupPairs\": []\n },\n {\n \"PrefixListIds\": [],\n \"FromPort\": 443,\n \"IpRanges\": [\n {\n \"CidrIp\": \"0.0.0.0/0\"\n }\n ],\n \"ToPort\": 443,\n \"IpProtocol\": \"tcp\",\n \"UserIdGroupPairs\": []\n }\n]\n\n* Add to the security group associated with the Web tier ELB the above ingress rules:\n\n  aws ec2 authorize-security-group-ingress --group-id <_security_group_id>_ --ip-permissions file:///PathTo/IpPermissions.json",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": "",
        "regex": "Security Group: @WEB_TIER_SECURITY_GROUP@ \\| Source: .*",
        "expect": "Security Group: @WEB_TIER_SECURITY_GROUP@ \\| Source: 0\\.0\\.0\\.0.* \\| Port: (80|443)$"
    },
    "custom_item_68": {
        "description": "6.18 Ensure Web tier ELB Security Group is not used in the Auto Scaling launch configuration of any other tier (Web, App)",
        "info": "When you use the AWS Management Console to create a load balancer in a VPC, you can choose an existing security group for the VPC or create a new security group for the VPC. If you choose an existing security group, it must allow traffic in both directions to the listener and health check ports for the load balancer. If you choose to create a security group, the console automatically adds rules to allow all traffic on these ports.\n\n  Be sure to review the security group rules to ensure that they allow traffic on the listener and health check ports for the new load balancer. When you delete your load balancer, this security group is not deleted automatically.\n\n  If you add a listener to an existing load balancer, you must review your security groups to ensure they allow traffic on the new listener port in both directions.\nThe web-tier ELB is the only one public facing and should have rules to allow inbound traffic the application ports (ex: HTTP and HTTPS) from any IP source (0.0.0.0/0).\n\n  The outbound security group rules for the web-tier ELB should be restricted to only the backend web-server instances for the appropriate application ports.\n\n  Associating the web-tier ELB security group to any other instances that shouldn't be publicly accessible exposes them to unauthorized access.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration using the correct security groups for Web and/or App tier:\n\n  aws autoscaling create-launch-configuration --launch-configuration-name __ --image-id __ --key-name __ --security-groups _/_ --instance-type __ --iam-instance-profile/_<_app_tier_instance_profile>_",
        "reference": "LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "regex": "Web Tier ELB Security Group =",
        "not_expect": "Web Tier ELB Security Group = @WEB_TIER_SECURITY_GROUP@"
    },
    "custom_item_69": {
        "description": "6.19 Create the Web tier Security Group and ensure it allows inbound connections from Web tier ELB Security Group for explicit ports",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\n\n  This is required for both the configured port and protocol for the listener on the back-end instance and the port and protocol used for the health check.\nThis protects the Web-server tier from unauthorized access, it is recommended to add inbound security group rules that allow traffic for the specific application protocol and ports by referencing as source the security group associated with the Web tier ELB.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* First remove all the ingress rules for the Web tier security group (use the \"WebTierSecurityGroup\" element from Audit procedure):\n\n  aws ec2 describe-security-groups --group-id _<__web_tier_security_group_> --query \"SecurityGroups[0].IpPermissions\" > /tmp/IpPermissions.json\naws ec2 revoke-security-group-ingress --group-id _<__web_tier_security_group_> --ip-permissions file:///tmp/IpPermissions.json\n\n* Add an ingress rule for a specific port, using --source-group option to specify the Web tier ELB security group as the source of the connections:\n\n  aws ec2 authorize-security-group-ingress --group-id _<__web_tier_security_group_> --protocol tcp --port __ --source-group __",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_70": {
        "description": "6.20 Ensure Web tier Security Group has no inbound rules for CIDR of 0 (Global Allow)",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\nConsidering any of the non-public tiers receive requests only either from the upper tier or from resources inside the same VPC, any inbound rules that allow traffic from any source (0.0.0.0/0) are not necessary and should be removed.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Remove the ingress rules for CIDR 0.0.0.0/0 (use the \"WebTierSecurityGroup\" element from Audit procedure):\n\n  aws ec2 revoke-security-group-ingress --group-id _<__web_tier_security_group_> --protocol tcp/udp --port __ --cidr 0.0.0.0/0",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_71": {
        "description": "6.21 Create the App tier ELB Security Group and ensure only accepts HTTP/HTTPS",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\nThe SG associated with the App tier ELB should allow connectivity from the security group associated with Web tier instances only for the HTTP (TCP 80) and HTTPS (TCP 443) ports.\n\n  The defaults for HTTP and HTTPS are used as an example, any other ports would apply depending on the application design.",
        "solution": "Using the Amazon unified command line interface:\n\n* First remove all the ingress rules for the security group associated with the App tier ELB:\n\n  aws ec2 describe-security-groups --group-id <_app_tier_elb_security_group_> --query \"SecurityGroups[0].IpPermissions\" > /tmp/IpPermissions.json\naws ec2 revoke-security-group-ingress --group-id <_app_tier_elb_security_group_> --ip-permissions file:///tmp/IpPermissions.json\n\n* create locally the below json file containing ingress rules for HTTP (TCP 80) and HTTPS (TCP 443) ports only fromand name it IpPermissions.json:\n\n  [\n {\n \"PrefixListIds\": [],\n \"FromPort\": 80,\n \"IpRanges\": [],\n \"ToPort\": 80,\n \"IpProtocol\": \"tcp\",\n \"UserIdGroupPairs\": [\n {\n \"UserId\": \"<_aws_account_number>_\",\n \"GroupId\": \"\"\n }\n ]\n },\n {\n \"PrefixListIds\": [],\n \"FromPort\": 443,\n \"IpRanges\": [],\n \"ToPort\": 443,\n \"IpProtocol\": \"tcp\",\n \"UserIdGroupPairs\": [\n {\n \"UserId\": \"<_aws_account_number>_\",\n \"GroupId\": \"\"\n }\n ]\n }\n]\n\n* Add to the security group associated with the App tier ELB the above ingress rules:\n\n  aws ec2 authorize-security-group-ingress --group-id <_app_tier_elb_security_group_> --ip-permissions file:///PathTo/IpPermissions.json",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": "",
        "regex": "Security Group: @APP_TIER_SECURITY_GROUP@ \\| Source: .*",
        "expect": "Security Group: @APP_TIER_SECURITY_GROUP@ \\| Source: 0\\.0\\.0\\.0.* \\| Port: (80|443)$"
    },
    "custom_item_72": {
        "description": "6.22 Create the App tier Security Group and ensure it allows inbound connections from App tier ELB Security Group for explicit ports",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\n\n  This is required for both the configured port and protocol for the listener on the back-end instance and the port and protocol used for the health check.\nThis protects the App-server tier from unauthorized access, it is recommended to add inbound security group rules that allow traffic for the specific application protocol and ports by referencing as source the security group associated with the App tier ELB.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* First remove all the ingress rules for the App tier security group (use the \"AppTierSecurityGroup\" element from Audit procedure):\n\n  aws ec2 describe-security-groups --group-id _<__app_tier_security_group_> --query \"SecurityGroups[0].IpPermissions\" > /tmp/IpPermissions.json\naws ec2 revoke-security-group-ingress --group-id _<__app_tier_security_group_> --ip-permissions file:///tmp/IpPermissions.json\n\n* Add an ingress rule for a specific port, using --source-group option to specify the App tier ELB security group as the source of the connections:\n\n  aws ec2 authorize-security-group-ingress --group-id _<__app_tier_security_group_> --protocol tcp --port __ --source-group _<__app_tier_elb_security_group_>",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_73": {
        "description": "6.23 Ensure App tier Security Group has no inbound rules for CIDR of 0 (Global Allow)",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\nConsidering any of the non-public tiers receive requests only either from the upper tier or from resources inside the same VPC, any inbound rules that allow traffic from any source (0.0.0.0/0) are not necessary and should be removed.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Remove the ingress rules for CIDR 0.0.0.0/0 (use the \"AppTierSecurityGroup\" element from Audit procedure) :\n\n  aws ec2 revoke-security-group-ingress --group-id _<__app_tier_security_group_> --protocol tcp/udp --port __ --cidr 0.0.0.0/0",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_74": {
        "description": "6.24 Create the Data tier Security Group and ensure it allows inbound connections from App tier Security Group for explicit ports",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\n\n  The port for these inbound rules would depend on the Database engine used and the configured port.\n\n  The default values are:\n\n  MySQL - TCP 3306\n\n  MSSQL - TCP 1433\n\n  Oracle SQL - TCP 1521\n\n  PostgreSQL - TCP 5432\n\n  MariaDB - TCP 3306\n\n  Amazon Aurora DB - TCP 3306\nThis protects the Data tier from unauthorized access, it is recommended to add inbound security group rules that allow traffic for the specific database protocol and ports by referencing as source the security group associated with the App tier instances.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* First remove all the ingress rules for the security group configured for your RDS DB instance:\n\n  aws ec2 describe-security-groups --group-id __ --query \"SecurityGroups[0].IpPermissions\" > /tmp/IpPermissions.json\naws ec2 revoke-security-group-ingress --group-id __ --ip-permissions file:///tmp/IpPermissions.json\n\n* Add an ingress rule for a specific port, using --source-group option to specify the App tier security group as the source of the connections:\n\n  aws ec2 authorize-security-group-ingress --group-id __ --protocol tcp --port __ --source-group __",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_75": {
        "description": "6.25 Ensure Data tier Security Group has no inbound rules for CIDR of 0 (Global Allow)",
        "info": "A _security group_ acts as a virtual firewall for your instance to control inbound and outbound traffic. When you launch an instance in the AWS Virtual Private Cloud (VPC), you can assign the instance to up to five security groups. Security groups act at the instance level, not the subnet level. Therefore, each instance in a subnet in your VPC could be assigned to a different set of security groups. If you don't specify a particular group at launch time, the instance is automatically assigned to the default security group for the VPC.\n\n  For each security group, you add _rules_ that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.\nConsidering any of the non-public tiers receive requests only either from the upper tier or from resources inside the same VPC, any inbound rules that allow traffic from any source (0.0.0.0/0) are not necessary and should be removed.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Remove the ingress rules for CIDR 0.0.0.0/0:\n\n  aws ec2 revoke-security-group-ingress --group-id __ --protocol tcp/udp --port __ --cidr 0.0.0.0/0",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeSecurityGroups",
        "xsl_stmt": ""
    },
    "custom_item_76": {
        "description": "6.26 Ensure the App tier ELB is created as Internal",
        "info": "An internal load balancer routes traffic to your EC2 instances in private subnets using private IP addresses.\n\n  Create an internal load balancer and register the database servers with it. The web servers receive requests from the Internet-facing load balancer and send requests for the database servers to the internal load balancer. The database servers receive requests from the internal load balancer.\n\n  When an internal load balancer is created, it receives a public DNS name with the following form:\n\n  internal-_name_-_123456789_._region_.elb.amazonaws.com\n\n  The DNS servers resolve the DNS name of your load balancer to the private IP addresses of the load balancer nodes for your internal load balancer. Each load balancer node is connected to the private IP addresses of the back-end instances that are in its Availability Zone using elastic network interfaces.\nCreating the App tier ELB as internal will prevent access to the app tier from the Internet and will allow access from the Web tier instances.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new internal ELB for your App tier:\n\n  aws elb create-load-balancer --load-balancer-name--scheme internal --listeners <_listener_config_> --subnets __ __ --security-groups* Register App tier instances with the new App tier ELB:\n\n  aws elb register-instances-with-load-balancer --load-balancer-name--instances __",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLoadBalancers",
        "xsl_stmt": "",
        "regex": "@APP_TIER_ELB@ : Scheme =",
        "expect": "@APP_TIER_ELB@ : Scheme = internal"
    },
    "custom_item_77": {
        "description": "6.27 Ensure EC2 instances within Web Tier have no Elastic / Public IP addresses associated",
        "info": "All subnets have an attribute that determines whether instances launched into that subnet receive a public IP address. The public IP address is assigned to the default network interface (eth0). By default, instances launched into a default subnet are assigned a public IP address. A public IP address is mapped to the primary private IP address through network address translation (NAT).\n\n  An Elastic IP address is a static, public IP address designed for dynamic cloud computing. You can associate an Elastic IP address with any instance or network interface for your VPC. With an Elastic IP address, you can mask the failure of an instance by rapidly remapping the address to another instance in your VPC.\nWithout any Public or Elastic IP associated on the EC2 instance in the Web tier, no inbound traffic can reach the instance from the Internet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* If in the above output the \"IpOwnerId\" is \"amazon\" the public Ip is not an Elastic IP and it cannot be manually disassociated from the instance after launch:\n\n* Make sure that the Web tier subnet doesn't assign public Ip's at launch (run the command for all Web tier subnets)\n\n  aws ec2 modify-subnet-attribute --subnet-id--no-map-public-ip-on-launch\n\n* Create an AMI from the instance and launch a replacement instance in the same subnet\n\n\n\n* If in the above output the \"IpOwnerId\" is an AWS account number, this is an Elastic IP and it can be disassociated:\n\n  aws ec2 disassociate-address --public-ip __",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeInstances",
        "xsl_stmt": "",
        "not_expect": "Public IP:"
    },
    "custom_item_78": {
        "description": "6.28 Ensure EC2 instances within App Tier have no Elastic / Public IP addresses associated",
        "info": "All subnets have an attribute that determines whether instances launched into that subnet receive a public IP address. The public IP address is assigned to the default network interface (eth0). By default, instances launched into a default subnet are assigned a public IP address. A public IP address is mapped to the primary private IP address through network address translation (NAT).\n\n  An Elastic IP address is a static, public IP address designed for dynamic cloud computing. You can associate an Elastic IP address with any instance or network interface for your VPC. With an Elastic IP address, you can mask the failure of an instance by rapidly remapping the address to another instance in your VPC.\nWithout any Public or Elastic IP associated on the EC2 instance in the App tier, no inbound traffic can reach the instance from the Internet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* If in the above output the \"IpOwnerId\" is \"amazon\" the public Ip is not an Elastic IP and it cannot be manually disassociated from the instance after launch:\n\n* Make sure that the App tier subnet doesn't assign public Ip's at launch (run the command for all App tier subnets)\n\n  aws ec2 modify-subnet-attribute --subnet-id __ --no-map-public-ip-on-launch\n\n* Create an AMI from the instance and launch a replacement instance in the same subnet\n\n\n\n* If in the above output the \"IpOwnerId\" is an AWS account number, this is an Elastic IP and it can be disassociated:\n\n  aws ec2 disassociate-address --public-ip __",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeInstances",
        "xsl_stmt": "",
        "not_expect": "Public IP:"
    },
    "custom_item_79": {
        "description": "6.29 Ensure EC2 instances within Data Tier have no Elastic / Public IP addresses associated",
        "info": "All subnets have an attribute that determines whether instances launched into that subnet receive a public IP address. The public IP address is assigned to the default network interface (eth0). By default, instances launched into a default subnet are assigned a public IP address. A public IP address is mapped to the primary private IP address through network address translation (NAT).\n\n  An Elastic IP address is a static, public IP address designed for dynamic cloud computing. You can associate an Elastic IP address with any instance or network interface for your VPC. With an Elastic IP address, you can mask the failure of an instance by rapidly remapping the address to another instance in your VPC.\nWithout any Public or Elastic IP associated on the EC2 instance in the Data tier, no inbound traffic can reach the instance from the Internet.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Using the Amazon unified command line interface:\n\n* If in the above output the \"IpOwnerId\" is \"amazon\" the public Ip is not an Elastic IP and it cannot be manually disassociated from the instance after launch:\n\n* Make sure that the Data tier subnets doesn't assign public Ip's at launch (run the command for all Data tier subnets)\n\n  aws ec2 modify-subnet-attribute --subnet-id __ --no-map-public-ip-on-launch\n\n* Create an AMI from the instance and launch a replacement instance in the same subnet\n\n\n\n* If in the above output the \"IpOwnerId\" is an AWS account number, this is an Elastic IP and it can be disassociated:\n\n  aws ec2 disassociate-address --public-ip __",
        "reference": "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|1A,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeInstances",
        "xsl_stmt": "",
        "not_expect": "Public IP:"
    },
    "custom_item_80": {
        "description": "6.32 Ensure Auto-Scaling Launch Configuration for Web Tier is configured to use the Web Tier Security Group",
        "info": "Auto Scaling helps maintain application availability and allows you to scale your Amazon EC2 capacity up or down automatically according to conditions you define.\n\n  You can use Auto Scaling to help ensure that you are running your desired number of Amazon EC2 instances or can automatically increase the number of Amazon EC2 instances during demand spikes to maintain performance and decrease capacity during lulls to reduce costs.\n\n  These properties can be defined within the Auto-Scaling Group configuration.\n\n  Additional properties can be defined through the launch configuration such as:\n\n* Instance Type\n* Amazon Machine Image (Pre-configured Operating System Images - allows for O.S Hardening)\n* IAM Role\n* Security Groups\nInstances within the Web Tier Auto-Scaling Group, are launched using the Security Group configured in the Auto-Scaling Launch Configuration. This Security Group allows only traffic specific to the Web Tier, and you must ensure that only this Web Tier Security Group is configured in the Launch Configuration.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the Web tier using the Web Tier Security Group:\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_new_web_tier_launch_config_> --image-id <_web_tier_ami_> --key-name <_your_key_pair_> --security-groups--instance-type--iam-instance-profile <_web_tier_instance_profile_>",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "regex": ".* - Security Group =",
        "expect": ".* - Security Group = .*"
    },
    "custom_item_81": {
        "description": "6.33 Ensure Auto-Scaling Launch Configuration for App Tier is configured to use the App Tier Security Group",
        "info": "Auto Scaling helps maintain application availability and allows you to scale your Amazon EC2 capacity up or down automatically according to conditions you define.\n\n  You can use Auto Scaling to help ensure that you are running your desired number of Amazon EC2 instances or can automatically increase the number of Amazon EC2 instances during demand spikes to maintain performance and decrease capacity during lulls to reduce costs.\n\n  These properties can be defined within the Auto-Scaling Group configuration.\n\n  Additional properties can be defined through the launch configuration such as:\n\n* Instance Type\n* Amazon Machine Image (Pre-configured Operating System Images - allows for O.S Hardening)\n* IAM Role\n* Security Groups\nInstances within the App Tier Auto-Scaling Group, are launched using the Security Group configured in the Auto-Scaling Launch Configuration. This Security Group allows only traffic specific to the App Tier, and you must ensure that only this App Tier Security Group is configured in the Launch Configuration.",
        "solution": "Using the Amazon unified command line interface:\n\n* Create new launch configuration for the App tier using the App Tier Security Group :\n\n  aws autoscaling create-launch-configuration --launch-configuration-name <_new_app_tier_launch_config_> --image-id <_app_tier_ami>_ --key-name <_your_key_pair>_ --security-groups_ --instance-type <_desired_instance_type>_ --iam-instance-profile <_app_tier_instance_profile>_",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeLaunchConfigurations",
        "xsl_stmt": "",
        "regex": ".* - Security Group =",
        "expect": ".* - Security Group = .*"
    },
    "custom_item_82": {
        "description": "6.34 Ensure RDS Database is configured to use the Data Tier Security Group",
        "info": "Amazon Relational Database Service (RDS) is a managed relational database service which handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair.\n\n  There are 6 database engines available for customer to run their database workloads on:\n\n* Amazon Aurora (MySQL Compatible)\n* MySQL\n* MariaDB\n* Oracle\n* Microsoft SQL Server\n* PostgreSQL\n\n  Customers can deploy RDS databases within a VPC through the configuration of:\n\n* Subnet Group for RDS, this group will be used for deployment of single or Multi-AZ RDS instances.\n* Network access through configuration of Security Groups for RDS\n* Access from outside the VPC hosting the DB instance by enabling/disabling a Public IP address\nNetwork access to the managed Data-Tier must be tightly controlled using Security Groups for RDS and non local accessibility of the DB instance.",
        "solution": "Using the Amazon unified command line interface:\n\n* Modify each non-compliant DB instance, and configure it to use the Data Tier Security Group:\n\n\n  aws rds modify-db-instance --db-instance-identifier <_your_db_instance_> --vpc-security-group-ids <_data_tier_security_group_>",
        "reference": "800-171|3.1.5,800-53|AC-6(5),800-53r5|AC-6(5),CN-L3|8.1.10.6(a),CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|1.2,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/260",
        "aws_action": "DescribeDBInstances",
        "xsl_stmt": "",
        "regex": "Security Group =",
        "expect": "Security Group = .*"
    }
}