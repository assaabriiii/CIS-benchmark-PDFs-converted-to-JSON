{
    "custom_item_1": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_2": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_3": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_4": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_5": {
        "description": "user",
        "context": "config log eventfilter",
        "expect": "set[\\s]+user[\\s]+enable"
    },
    "custom_item_6": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_7": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_8": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_9": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_10": {
        "description": "admin-lockout-duration",
        "context": "config system global",
        "regex": "set[\\\\s]+admin-lockout-duration",
        "expect": "set[\\\\s]+admin-lockout-duration[\\\\s]+900[\\\\s]*$"
    },
    "custom_item_11": {
        "description": "admin-lockout-threshold",
        "context": "config system global",
        "regex": "set[\\\\s]+admin-lockout-threshold",
        "expect": "set[\\\\s]+admin-lockout-threshold[\\\\s]+3[\\\\s]*$"
    },
    "custom_item_12": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_13": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_14": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_15": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_16": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_17": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_18": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_19": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_20": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_21": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_22": {
        "description": "event",
        "context": "config log eventfilter",
        "expect": "set[\\s]+event[\\s]+enable"
    },
    "custom_item_23": {
        "description": "system",
        "context": "config log eventfilter",
        "expect": "set[\\s]+system[\\s]+enable"
    },
    "custom_item_24": {
        "description": "FGFW-ND-000095 - The FortiGate device must generate audit records containing information that establishes the identity of any individual or process associated with the event.",
        "info": "Without information that establishes the identity of the subjects (i.e., administrators or processes acting on behalf of administrators) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.\n\nEvent identifiers (if authenticated or otherwise known) include, but are not limited to, user database tables, primary key values, user names, or process identifiers.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following commands:\n     # config log setting\n     # set user-anonymize disable\n     # end",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,800-53r5|AU-3,CAT|II,CCI|CCI-001487,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234178r879568_rule,STIG-ID|FGFW-ND-000095,SWIFT-CSCv1|6.4,Vuln-ID|V-234178",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config log setting",
        "expect": "set[\\s]+user-anonymize[\\s]+disable"
    },
    "custom_item_25": {
        "description": "FGFW-ND-000100 - The FortiGate device must generate audit records containing the full-text recording of privileged commands.",
        "info": "Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nOrganizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n   # config system global\n   #      set cli-audit-log enable\n   # end",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-3(1),800-53r5|AU-3(1),CAT|II,CCI|CCI-000135,CN-L3|7.1.3.3(b),CSF|PR.PT-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3(1),NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234179r879569_rule,STIG-ID|FGFW-ND-000100,SWIFT-CSCv1|6.4,Vuln-ID|V-234179",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system global",
        "expect": "set[\\s]+cli-audit-log[\\s]+enable"
    },
    "custom_item_26": {
        "description": "max-log-file-size",
        "context": "config log disk setting",
        "expect": "set[\\s]+max-log-file-size[\\s]+([1-9]|[1-9][0-9]|100)"
    },
    "custom_item_27": {
        "description": "diskfull overwrite",
        "context": "config log disk setting",
        "expect": "set[\\s]+diskfull[\\s]+overwrite"
    },
    "custom_item_28": {
        "description": "FGFW-ND-000110 - The FortiGate device must off-load audit records on to a different system or media than the system being audited.",
        "info": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOffloading is a common process in information systems with limited audit storage capacity.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Login via the GUI with super-admin privileges.\n\n1. Click Log and Report.\n2. Click Log Settings.\n\nTo add a FortiAnalyzer:\n- In the Remote Logging and Archiving, enable logging to FortiAnalyzer and provide the IP address.\n\nTo add a Syslog server:\n- In the Remote Logging and Archiving, enable Send logs to Syslog and provide the IP address.\n\n3. Apply changes.\n\nor\n\n1. Open a CLI console via SSH or from the 'CLI Console' button in the GUI.\n\n2. Configure a fortianalyzer or syslog server with the following commands:\n\nFortiAnalyzer:\n# config log fortianalyzer setting\n#    set status enable\n#    set server {IP Address}\n#    set upload-option realtime\n# end\n\nSyslog:\n# config log syslogd setting\n#    set status enable\n#    set server {IP Address}\n#    set mode reliable\n# end",
        "reference": "800-53|AU-4(1),800-53r5|AU-4(1),CAT|II,CCI|CCI-001851,CSF|PR.DS-4,CSF|PR.PT-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234181r879886_rule,STIG-ID|FGFW-ND-000110,Vuln-ID|V-234181",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config log (fortianalyzer|syslogd).* setting",
        "expect": "(status|server)"
    },
    "custom_item_29": {
        "description": "ntp server 1",
        "context": "config system ntp",
        "expect": "set[\\s]+server[\\s]+@NTP_SERVER_1@"
    },
    "custom_item_30": {
        "description": "ntp server 2",
        "context": "config system ntp",
        "expect": "set[\\s]+server[\\s]+@NTP_SERVER_2@"
    },
    "custom_item_31": {
        "description": "FGFW-ND-000125 - The FortiGate device must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).",
        "info": "If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Go to Settings.\n3. On Time Zone, select the time zone in which the FortiGate device is located.\n4. Click Apply.\n\nor\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n\n     # config system global\n     #    set timezone {TIMEZONE INDEX}\n     #    end",
        "reference": "800-171|3.3.7,800-53|AU-8b.,800-53r5|AU-8b.,CAT|II,CCI|CCI-001890,CN-L3|8.1.4.3(b),CSF|PR.PT-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-8,NESA|T3.6.7,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234184r879747_rule,STIG-ID|FGFW-ND-000125,TBA-FIISB|37.4,Vuln-ID|V-234184",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system global",
        "expect": "set[\\s]+timezone[\\s]+[^ ]+"
    },
    "custom_item_32": {
        "description": "log setting",
        "context": "config log setting",
        "expect": "set[\\s]+.*"
    },
    "custom_item_33": {
        "description": "eventfilter",
        "context": "config log eventfilter",
        "expect": "set[\\s]+.*"
    },
    "custom_item_34": {
        "description": "FGFW-ND-000200 - The FortiGate device must prohibit the use of all unnecessary and/or non-secure functions, ports, protocols, and/or services.",
        "info": "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n1. Click Policy and Objects.\n2. Click IPv4 or IPv6 Policy.\n3. Click +Create New.\n4. Name the policy, and then select Incoming and Outgoing Interfaces.\n5. Create policies with authorized sources and destinations.\n6. Set action to DENY.\n7. Ensure Enable this policy is toggled to right.\n8. Click OK.\n9. Ensure a policy is created for each interface and that every PPSM CAL and VA mitigation is covered.\n\nTraffic is denied by default and policies must be configured to allow traffic that meets PPSM CAL and VA guidelines.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following\n  # config system interface\n      # edit {INTERFACE-NAME}\n         # set {DHCP-RELAY-SERVICE | PPTP-CLIENT | ARPFORWARD | BROADCAST-FORWARD | L2FORWARD | ICMP-REDIRECT | VLANFORWARD | STPFORWARD  | LLDP-TRANSMISSION} disable\n      # end\nCreate a new line for each service in {} that needs to be removed.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7b.,800-53r5|CM-7b.,CAT|I,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|2.2.4,QCSC-v1|3.2,Rule-ID|SV-234199r879588_rule,STIG-ID|FGFW-ND-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-234199",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system interface",
        "expect": ".*"
    },
    "custom_item_35": {
        "description": "admin-https-ssl-versions tlsv1-2 tlsv1-3",
        "context": "config system global",
        "regex": "set[\\s]+admin-https-ssl-versions[\\s]+",
        "expect": "set[\\s]+admin-https-ssl-versions[\\s]+tlsv1-2[\\s]+tlsv1-3"
    },
    "custom_item_36": {
        "description": "admin-ssh-v1 disable",
        "context": "config system global",
        "regex": "set[\\s]+admin-ssh-v1[\\s]+",
        "expect": "set[\\s]+admin-ssh-v1[\\s]+disable"
    },
    "custom_item_37": {
        "description": "ssl-min-proto-version TLSv1-2",
        "context": "config system global",
        "regex": "set[\\s]+ssl-min-proto-version[\\s]+",
        "expect": "set[\\s]+ssl-min-proto-version[\\s]+tlsv1-2"
    },
    "custom_item_38": {
        "description": "security-level",
        "context": "config system snmp user",
        "expect": "set[\\s]+security-level[\\s]+auth"
    },
    "custom_item_39": {
        "description": "auth-proto",
        "context": "config system snmp user",
        "expect": "set[\\s]+auth-proto[\\s]+sha256"
    },
    "custom_item_40": {
        "description": "Fortigate - Admin password policy is enabled",
        "context": "config system password-policy",
        "regex": "set[\\s]+status",
        "expect": "set[\\s]+status[\\s]+enable$"
    },
    "custom_item_41": {
        "description": "FGFW-ND-000220 - The FortiGate device must enforce a minimum 15-character password length.",
        "info": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Navigate to Password Policy.\n4. On the Password scope option, click Admin.\n5. Enter the Minimum length value of 15.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system password-policy\n           # set status enable\n          # set minimum-length 15\n     # end--+",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234203r879601_rule,STIG-ID|FGFW-ND-000220,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-234203",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+minimum-length[\\s]+(1[5-9]|[2-9][0-9])"
    },
    "custom_item_42": {
        "description": "FGFW-ND-000225 - The FortiGate device must enforce password complexity by requiring that at least one uppercase character be used.",
        "info": "Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Navigate to Password Policy.\n4. On the Password scope option, click Admin.\n5. Toggle Character requirements to right.\n6. Enter the Uppercase value of 1 or greater.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following commands:\n    # config system password-policy\n        # set min-upper-case-letter 1 (or greater)\n    # end",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234204r879603_rule,STIG-ID|FGFW-ND-000225,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-234204",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+min-upper-case-letter[\\s]+([1-9]|[1-9][0-9]|1[01][0-9]|12[0-8])$"
    },
    "custom_item_43": {
        "description": "FGFW-ND-000230 - The FortiGate device must enforce password complexity by requiring that at least one lowercase character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Navigate to Password Policy.\n4. On the Password scope option, click Admin.\n5. Toggle Character requirements to right.\n6. Enter the Lowercase value of 1.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system password-policy\n           # set min-lower-case-letter 1\n     # end",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234205r917456_rule,STIG-ID|FGFW-ND-000230,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-234205",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+min-lower-case-letter[\\s]+([1-9]|[1-9][0-9]|1[01][0-9]|12[0-8])$"
    },
    "custom_item_44": {
        "description": "FGFW-ND-000235 - The FortiGate device must enforce password complexity by requiring at least one numeric character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Navigate to Password Policy.\n4. On the Password scope option, click Admin.\n5. Toggle Character requirements to right.\n6. Enter the Numbers value of 1 or greater.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following commands:\n    # config system password-policy\n        # set min-number 1 (or greater)\n    # end",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234206r879605_rule,STIG-ID|FGFW-ND-000235,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-234206",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+min-number[\\s]+([1-9]|[1-9][0-9]|1[01][0-9]|12[0-8])$"
    },
    "custom_item_45": {
        "description": "FGFW-ND-000240 - The FortiGate device must enforce password complexity by requiring that at least one special character be used.",
        "info": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Navigate to Password Policy.\n4. On the Password scope option, click Admin.\n5. Toggle Character requirements to right.\n6. Enter the Special value of 1 or greater.\n\nor\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following commands:\n     # config system password-policy\n          # set min-non-alphanumeric 1 (or greater)\n     # end",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(a),800-53r5|IA-5(1)(a),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(a),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234207r879606_rule,STIG-ID|FGFW-ND-000240,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-234207",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+min-non-alphanumeric[\\s]+([1-9]|[1-9][0-9]|1[01][0-9]|12[0-8])$"
    },
    "custom_item_46": {
        "description": "FGFW-ND-000245 - The FortiGate device must use LDAPS for the LDAP connection.",
        "info": "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\nNetwork devices can accomplish this by making direct function calls to encryption modules or by leveraging operating system encryption capabilities.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config user ldap\n           # edit {ldap_server_name}\n           # set server {server_ip}\n           # set cnid {cn}\n           # set dn {dc=XYZ,dc=fortinet,dc=COM}\n           # set type regular\n           # set username {cn=Administrator,dc=XYA, dc=COM}\n           # set password {bind password}\n           # set secure ldaps\n           #    set ca-cert {CA certificate name}\n      # next\n  # end",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CAT|I,CCI|CCI-000197,CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234208r879609_rule,STIG-ID|FGFW-ND-000245,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-234208",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config user ldap",
        "expect": "set[\\s]+secure[\\s]+ldaps"
    },
    "custom_item_47": {
        "description": "FGFW-ND-000255 - The FortiGate device must use FIPS 140-2 approved algorithms for authentication to a cryptographic module.",
        "info": "Unapproved mechanisms that are used for authentication to the cryptographic module are not validated and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNetwork devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system fips-cc\n          # set status enable\n     # end",
        "reference": "800-53|IA-7,800-53r5|IA-7,CAT|I,CCI|CCI-000803,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(d),ITSG-33|IA-7,ITSG-33|IA-7a.,NESA|M5.2.1,NESA|M5.2.6,NESA|M5.3.1,NESA|T7.4.1,QCSC-v1|13.2,Rule-ID|SV-234210r879616_rule,STIG-ID|FGFW-ND-000255,Vuln-ID|V-234210",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "cmd": "get system status",
        "expect": "FIPS-CC[\\s]+mode:[\\s]+enable"
    },
    "custom_item_48": {
        "description": "FGFW-ND-000260 - The FortiGate devices must use FIPS-validated Keyed-Hash Message Authentication Code (HMAC) to protect the integrity of nonlocal maintenance and diagnostic communications.",
        "info": "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.\n\nCurrently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.\n\nSeparate requirements for configuring applications and protocols used by each application (e.g., SNMPv3, SSHv2, NTP, HTTPS, and other protocols and applications that require server/client authentication) are required to implement this requirement. Where SSH is used, the SSHv2 protocol suite is required because it includes Layer 7 protocols such as SCP and SFTP, which can be used for secure file transfers.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click Network, Interfaces\n2. Click the interface designated for device management traffic and pick Edit.\n3. On Administrative Access, select HTTPS and SSH. Deselect HTTP.\n4. Click OK.\n\nor\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system interface\n     #    edit port{Management Port Integer #}\n     #    set allowaccess ping https ssh\n     # end\n\nNote: When adding or removing a protocol, the entire list of protocols must be typed again. For example, in an existing access list of HTTPS and SSH, if HTTP needs to be added, use the following CLI command:\n     #   set allowaccess https ssh ping http",
        "reference": "800-171|3.7.5,800-53|MA-4(6),800-53r5|MA-4(6),CAT|I,CCI|CCI-002890,CSF|PR.MA-2,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-234211r879784_rule,STIG-ID|FGFW-ND-000260,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-234211",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "edit \"@MANAGEMENT_PORT_INTEGER@\"",
        "expect": "set[\\s]+allowaccess[\\s]+ping[\\s]+https[\\s]+ssh"
    },
    "custom_item_49": {
        "description": "FGFW-ND-000265 - The FortiGate device must implement cryptographic mechanisms using a FIPS 140-2 approved algorithm to protect the confidentiality of remote maintenance sessions.",
        "info": "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to eavesdropping, potentially putting sensitive data (including administrator passwords) at risk of compromise and potentially allowing hijacking of maintenance sessions.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click Network, Interfaces.\n2. Click the interface designated for device management traffic and pick Edit.\n3. On Administrative Access, select HTTPS and SSH. Deselect HTTP.\n4. Click OK.\n\nor\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command for all low privileged admin users:\n     # config system interface\n     #    edit port{Management Port Integer #}\n     #    set allowaccess ping https ssh\n     # end\n\nNote: When a protocol is added or removed, the entire list of protocols must be typed in again. For example, to add PING to an access list of HTTPS and SSH, use the following CLI command:\n     #   set allowaccess https ssh ping",
        "reference": "800-171|3.7.5,800-53|MA-4(6),800-53r5|MA-4(6),CAT|I,CCI|CCI-003123,CSF|PR.MA-2,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4(6),NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-234212r879785_rule,STIG-ID|FGFW-ND-000265,SWIFT-CSCv1|2.6,TBA-FIISB|45.2.3,Vuln-ID|V-234212",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "edit \"@MANAGEMENT_PORT_INTEGER@\"",
        "expect": "set[\\s]+allowaccess[\\s]+ping[\\s]+https[\\s]+ssh"
    },
    "custom_item_50": {
        "description": "FGFW-ND-000270 - The FortiGate device must terminate idle sessions after 10 minutes of inactivity.",
        "info": "If a device management session or connection remains open after management is completed, it may be hijacked by an attacker and used to compromise or damage the network device.\n\nNonlocal device management and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.\n\nIn the event the remote node has abnormally terminated or an upstream link from the managed device is down, the management session will be terminated, thereby freeing device resources and eliminating any possibility of an unauthorized user being orphaned to an open idle session of the managed device.",
        "solution": "To configure the device to terminate all network connections when non-local maintenance is complete:\n\nLog in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Go to Administrative Settings.\n4. Enter the Idle Timeout value of 10.\n5. Click Apply.\n\nor\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system global\n          # set admintimeout 10\n     # end",
        "reference": "800-171|3.7.5,800-53|MA-4e.,800-53r5|MA-4e.,CAT|II,CCI|CCI-000879,CSF|PR.MA-2,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|MA-4e.,NESA|T2.3.4,NESA|T5.4.4,QCSC-v1|5.2.2,Rule-ID|SV-234213r879621_rule,STIG-ID|FGFW-ND-000270,TBA-FIISB|45.2.3,Vuln-ID|V-234213",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system global",
        "expect": "set[\\s]+admintimeout[\\s]+10$"
    },
    "custom_item_51": {
        "description": "FGFW-ND-000275 - The FortiGate device must terminate idle sessions after 10 minutes of inactivity.",
        "info": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Click System.\n2. Click Settings.\n3. Go to Administrative Settings.\n4. Enter the Idle Timeout value of 10.\n5. Click Apply.\n\nor\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system global\n          # set admintimeout 10\n     # end",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,CAT|I,CCI|CCI-001133,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,Rule-ID|SV-234214r916342_rule,STIG-ID|FGFW-ND-000275,SWIFT-CSCv1|2.6,Vuln-ID|V-234214",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system global",
        "expect": "set[\\s]+admintimeout[\\s]+10$"
    },
    "custom_item_52": {
        "description": "FGFW-ND-000280 - The FortiGate device must generate unique session identifiers using a FIPS 140-2-approved random number generator.",
        "info": "Sequentially generated session IDs can be easily guessed by an attacker. Employing the concept of randomness in the generation of unique session identifiers helps to protect against brute-force attacks to determine future session identifiers.\n\nUnique session IDs address man-in-the-middle attacks, including session hijacking or insertion of false information into a session. If the attacker is unable to identify or guess the session information related to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating valid sessions.\n\nThis requirement is applicable to devices that use a web interface for device management.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n      # config system fips-cc\n            # set status enable\n     # end",
        "reference": "800-171|3.13.15,800-53|SC-23(3),800-53r5|SC-23(3),CAT|II,CCI|CCI-001188,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-23(3),NESA|T4.5.1,QCSC-v1|5.2.1,Rule-ID|SV-234215r879639_rule,STIG-ID|FGFW-ND-000280,Vuln-ID|V-234215",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "cmd": "get system status",
        "expect": "FIPS-CC[\\s]+mode:[\\s]+enable"
    },
    "custom_item_53": {
        "description": "FGFW-ND-000285 - The FortiGate device must only allow authorized administrators to view or change the device configuration, system files, and other files stored either in the device or on removable media (such as a flash drive).",
        "info": "This requirement is intended to address the confidentiality and integrity of system information at rest (e.g., network device rule sets) when it is located on a storage device within the network device or as a component of the network device. This protection is required to prevent unauthorized alteration, corruption, or disclosure of information when not stored directly on the network device.\n\nFiles on the network device or on removable media used by the device must have their permissions set to allow read or write access to those accounts that are specifically authorized to access or change them. Note that different administrative accounts or roles will have varying levels of access.\n\nFile permissions must be set so that only authorized administrators can read or change their contents. Whenever files are written to removable media and the media removed from the device, the media must be handled appropriately for the classification and sensitivity of the data stored on the device.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. First edit the admin profile by running the following command:\n\n     # config system accprofile\n           # edit {PROFILE NAME}\n                 # set sysgrp read-write\n          # next\n     # end\nThen, assign appropriate admin profiles to the administrator account.\n     # config system admin\n          # edit {ADMIN NAME}\n          # set accprofile  {PROFILE NAME}\n          # next\n     # end\n\nThis profile should only be assigned to administrators authorized to change system configurations.",
        "reference": "800-171|3.13.16,800-53|SC-28,800-53r5|SC-28,CAT|I,CCI|CCI-001199,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,ITSG-33|SC-28a.,PCI-DSSv3.2.1|3.4,PCI-DSSv4.0|3.3.2,PCI-DSSv4.0|3.5.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-234216r879642_rule,STIG-ID|FGFW-ND-000285,Vuln-ID|V-234216",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "edit \".*\"",
        "expect": "set[\\s]+sysgrp[\\s]+.+"
    },
    "custom_item_54": {
        "description": "FGFW-ND-000295 - The FortiGate device must be configured to send log data to a central log server for the purpose of forwarding alerts to the administrators and the ISSO.",
        "info": "The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can be used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, is important in showing whether someone is an internal employee or an outside threat.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Log in via the GUI with super-admin privileges.\n\n1. Click Log and Report.\n2. Click Log Settings.\n3. Locate the Remote Logging and Archiving section.\n4. Configure FortiGate to log to a FortiAnalyzer or syslog server.\n- Enable logging to FortiAnalyzer and provide the IP address. Additional FortiAnalyzer logging destinations can be configured in the CLI.\n- Enable the 'Send logs to syslog' toggle and provide the IP address. Additional syslog logging destinations can be configured in the CLI.\n5. Apply changes.\n\nor\n\n1. Open a CLI console via SSH or from the 'CLI Console' button in the GUI.\n2. Configure a FortiAnalyzer or syslog server with the following commands:\n\nFortiAnalyzer Logging:\nconfig log fortianalyzer setting\n   set status enable\n   set server {IP Address}\n   set upload-option realtime\nend\n\nsyslog Logging:\nconfig log syslogd setting\n   set status enable\n   set server {IP Address}\n   set mode reliable\nend",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CAT|I,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-234218r917639_rule,STIG-ID|FGFW-ND-000295,SWIFT-CSCv1|2.2,Vuln-ID|V-234218",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config log (fortianalyzer|syslogd).* setting",
        "expect": "server"
    },
    "custom_item_55": {
        "description": "admin-concurrent",
        "context": "config system global",
        "expect": "set[\\s]+admin-concurrent[\\s]+disable"
    },
    "custom_item_56": {
        "description": "admin-login-max",
        "context": "config system global",
        "expect": "set[\\s]+admin-login-max[\\s]+@LOGON_SESSION@"
    },
    "custom_item_57": {
        "description": "Fortigate - Admin password policy is enabled",
        "context": "config system password-policy",
        "regex": "set[\\s]+status",
        "expect": "set[\\s]+status[\\s]+enable$"
    },
    "custom_item_58": {
        "description": "FGFW-ND-000311 - The FortiGate device must require that when a password is changed, the characters are changed in at least eight of the positions within the password.",
        "info": "If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.",
        "solution": "Log in to the FortiGate GUI with Super-Admin privilege.\n\n1. Open a CLI console, via SSH or available from the GUI.\n2. Run the following command:\n     # config system password-policy\n           # set change-4-characters enable\n     # end\n\nNote that this setting only mitigates the requirement to a CAT III finding, as this is a mitigation to change at least four characters when changing the account of last resort. This is a limitation of the device. It is not possible to mitigate to 'Not A Finding'.",
        "reference": "800-171|3.5.7,800-53|IA-5(1)(b),800-53r5|IA-5(1)(b),CAT|II,CCI|CCI-000195,CSF|PR.AC-1,DISA_Benchmark|FN_FortiGate_Firewall_NDM_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1)(b),NESA|T5.2.3,NIAv2|AM22d,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234221r879607_rule,STIG-ID|FGFW-ND-000311,SWIFT-CSCv1|4.1,Vuln-ID|V-234221",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_FN_FortiGate_Firewall_Y23M07_STIG.zip",
        "context": "config system password-policy",
        "expect": "set[\\s]+change-4-characters[\\s]+enable"
    }
}