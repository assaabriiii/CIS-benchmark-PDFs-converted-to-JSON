{
    "custom_item_1": {
        "description": "Test secure string",
        "value_data": ".*",
        "powershell_args": "hostname",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_2": {
        "description": "DISA_STIG_Microsoft_Exchange_2013_Client_Access_Server_v2r1.audit from DISA Microsoft Exchange 2013 Client Access Server v2r1 STIG",
        "info": "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "[\\s]+15\\.0[\\s]+.*[\\s]+True",
        "powershell_args": "If (Get-ExchangeServer) { Get-ExchangeServer | Format-Table Name, AdminDisplayVersion, IsClientAccessServer } Else { 'No Exchange servers found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_3": {
        "description": "Platform check",
        "value_data": "[\\s]+15\\.0[\\s]+.*[\\s]+True",
        "powershell_args": "If (Get-ExchangeServer) { Get-ExchangeServer | Format-Table Name, AdminDisplayVersion, IsClientAccessServer } Else { 'No Exchange servers found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_4": {
        "description": "EX13-CA-000005 - Exchange must use Encryption for RPC client access.",
        "info": "This setting controls whether client machines are forced to use secure channels to communicate with the server. If this feature is enabled, clients will only be able to communicate with the server over secure communication channels.\n\nFailure to require secure connections to the client access server increases the potential for unintended eavesdropping or data loss.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-RpcClientAccess -Server-EncryptionRequired $true",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-234765r617236_rule,STIG-ID|EX13-CA-000005,STIG-Legacy|SV-84337,STIG-Legacy|V-69715,SWIFT-CSCv1|2.6,Vuln-ID|V-234765",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-RpcClientAccess; $settings | Format-List Server, Name, EncryptionRequired; If ($settings | Where {$_.EncryptionRequired -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_5": {
        "description": "EX13-CA-000010 - Exchange must use Encryption for OWA access.",
        "info": "This setting controls whether client machines should be forced to use secure channels to communicate with this virtual directory. If this feature is enabled, clients will only be able to communicate with the directory if they are capable of supporting secure communication with the server.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between servers and clients. The network and DMZ STIG identify criteria for OWA and Public Folder configuration in the network, including CAC enabled pre-authentication through an application firewall proxy.\n\nFailure to require secure connections on a web site increases the potential for unintended eavesdropping or data loss.",
        "solution": "Configure the OWA site to require SSL port 443.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-234766r617239_rule,STIG-ID|EX13-CA-000010,STIG-Legacy|SV-84339,STIG-Legacy|V-69717,SWIFT-CSCv1|2.6,Vuln-ID|V-234766",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "Ssl,Ssl128",
        "powershell_args": "Get-WebConfigurationProperty -PSPath 'IIS:\\Sites\\Default Web Site' -Filter /system.webServer/security/access -Name sslflags",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_6": {
        "description": "EX13-CA-000015 - Exchange must have Forms-based Authentication disabled.",
        "info": "Identification and Authentication provide the foundation for access control. Access to email services applications in the DoD requires authentication using DoD Public Key Infrastructure (PKI) certificates. Authentication for Outlook Web App (OWA) is used to enable web access to user email mailboxes and should assume that certificate-based authentication has been configured. This setting controls whether forms-based logon should be used by the OWA website.\n\nBecause the DoD requires Common Access Card (CAC)-based authentication to applications, OWA access must be brokered through an application proxy or other pre-authenticator, which performs CAC authentication prior to arrival at the CA server. The authenticated request is then forwarded directly to OWA, where authentication is repeated without requiring the user to repeat authentication steps. For this scenario to work, the Application Proxy server must have forms-based authentication enabled, and Exchange must have forms-based Authentication disabled.\n\nIf forms-based Authentication is enabled on the Exchange CA server, it is evidence that the application proxy server is either not correctly configured, or it may be missing.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OwaVirtualDirectory -Identity <'IdentityName'> -FormsAuthentication $false\n\nNotemust be in quotes.\n\nExample for the Identity Name:\\owa (Default Web site)\n\nRestart the ISS service.",
        "reference": "800-171|3.1.13,800-53|AC-17(2),800-53r5|AC-17(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSSv3.2.1|2.3,PCI-DSSv4.0|2.2.7,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,Rule-ID|SV-234767r617242_rule,STIG-ID|EX13-CA-000015,STIG-Legacy|SV-84341,STIG-Legacy|V-69719,SWIFT-CSCv1|2.6,Vuln-ID|V-234767",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OwaVirtualDirectory; $settings | Format-List ServerName, Name, Identity, FormsAuthentication; If ($settings | Where {$_.FormsAuthentication -ne $false}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_7": {
        "description": "EX13-CA-000020 - Exchange must have authenticated access set to Integrated Windows Authentication only.",
        "info": "To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system.\n\nThis requirement is applicable to access control enforcement applications (e.g., authentication servers) and other applications that perform information and system access control functions.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OwaVirtualDirectory -Identity '' -WindowsAuthentication $true\n\nNote: Thevalue must be in quotes.\n\nExample for the Identity Name:\\owa (Default Web site)",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234768r617245_rule,STIG-ID|EX13-CA-000020,STIG-Legacy|SV-84343,STIG-Legacy|V-69721,TBA-FIISB|31.1,Vuln-ID|V-234768",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OwaVirtualDirectory ; $settings | Format-List ServerName, Name, Identity, WindowsAuthentication; If ($settings | Where {$_.WindowsAuthentication -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_8": {
        "description": "EX13-CA-000025 - Exchange must have Administrator audit logging enabled.",
        "info": "Unauthorized or malicious data changes can compromise the integrity and usefulness of the data. Automated attacks or malicious users with elevated privileges have the ability to affect change using the same mechanisms as email administrators.\n\nAuditing changes to access mechanisms not only supports accountability and non-repudiation for those authorized to define the environment but also enables investigation of changes made by others who may not be authorized.\n\nNote: This administrator auditing feature audits all exchange changes regardless of the users' assigned role or permissions.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig -AdminAuditLogEnabled $true",
        "reference": "800-171|3.1.1,800-53|AC-2(4),800-53r5|AC-2(4),CAT|II,CCI|CCI-001403,CN-L3|7.1.3.2(d),CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(4),NESA|T5.2.2,NIAv2|AM9a,NIAv2|AM9b,NIAv2|AM9c,NIAv2|AM9d,NIAv2|AM9e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2,Rule-ID|SV-234769r617248_rule,STIG-ID|EX13-CA-000025,STIG-Legacy|SV-84345,STIG-Legacy|V-69723,TBA-FIISB|36.2.3,Vuln-ID|V-234769",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-AdminAuditLogConfig ; $settings | Format-List Name, AdminAuditLogEnabled; If ($settings | Where {$_.AdminAuditLogEnabled -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_9": {
        "description": "EX13-CA-000030 - Exchange Servers must use approved DoD certificates.",
        "info": "Server certificates are required for many security features in Exchange; without them the server cannot engage in many forms of secure communication. Failure to implement valid certificates makes it virtually impossible to secure Exchange's communications.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Remove the non-DoD certificate and import the correct DoD certificates.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234770r617251_rule,STIG-ID|EX13-CA-000030,STIG-Legacy|SV-84347,STIG-Legacy|V-69725,TBA-FIISB|31.1,Vuln-ID|V-234770",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "Get-ExchangeCertificate | Format-List CertificateDomains, Issuer",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_10": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - BasicAuthEnabled",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, BasicAuthEnabled; If ($settings | Where {$_.BasicAuthEnabled -ne $false}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_11": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - WindowsAuthEnabled",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, WindowsAuthEnabled; If ($settings | Where {$_.WindowsAuthEnabled -ne $false}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_12": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - ClientCertAuth",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, ClientCertAuth; If ($settings | Where {$_.ClientCertAuth -ne 'Required'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_13": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - WebSiteSSLEnabled",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, WebSiteSSLEnabled; If ($settings | Where {$_.WebSiteSSLEnabled -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_14": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - InternalAuthenticationMethods",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, InternalAuthenticationMethods; If ($settings | Where-Object {$_.InternalAuthenticationMethods -Contains 'Certificate' -And ($_.InternalAuthenticationMethods | Measure).Count -eq 1}) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_15": {
        "description": "EX13-CA-000035 - Exchange ActiveSync (EAS) must only use certificate-based authentication to access email - ExternalAuthenticationMethods",
        "info": "Identification and Authentication provide the foundation for access control. For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ActiveSyncVirtualDirectory -Identity '\\Microsoft-Server-ActiveSync (Default Web Site)' -BasicAuthEnabled $False -WindowsAuthEnabled $False -ClientCertAuth 'Required' -WebSites-InternalAuthenticationMethods 'Certificate' -ExternalAuthenticationMethods 'Certificate'\n\nNote: TheMicrosoft-Server-ActiveSync (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234771r617254_rule,STIG-ID|EX13-CA-000035,STIG-Legacy|SV-84349,STIG-Legacy|V-69727,TBA-FIISB|31.1,Vuln-ID|V-234771",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory ; $settings | Format-List Name, Identity, ExternalAuthenticationMethods; If ($settings | Where-Object {$_.ExternalAuthenticationMethods -Contains 'Certificate' -And ($_.ExternalAuthenticationMethods | Measure).Count -eq 1}) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_16": {
        "description": "EX13-CA-000040 - Exchange must have IIS map client certificates to an approved certificate server.",
        "info": "For EAS to be used effectively on DoD networks, client certificate authentication must be used for communications between the MEM and email server. Identification and Authentication provide the foundation for access control. IIS must be mapped to an approved certificate server for client certificates. Additionally, the internal and external URLs must be set to the same address, since all EAS traffic must be tunneled to the device from the MEM.\n\nThe risk associated with email synchronization with CMD should be mitigated by the introduction of MEM products and is specified in the DoD CIO memo dated 06 Apr 2011. The memo states specifically, 'Email redirection from the email server (e.g., Exchange Server) to the device shall be controlled via centrally managed server.' When EAS is used on DoD networks, the devices must be managed by an MEM.",
        "solution": "Open a command window and enter the following commands:\n\ncd C:\\Windows\\SysWOW64\\InetSrv\n\nappcmd unlock config /section:clientCertificateMappingAuthentication\nappcmd set config 'Default Web Site/Microsoft-Server-ActiveSync' -section:clientCertificateMappingAuthentication /enabled:true",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CAT|II,CCI|CCI-000213,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234772r617257_rule,STIG-ID|EX13-CA-000040,STIG-Legacy|SV-84351,STIG-Legacy|V-69729,TBA-FIISB|31.1,Vuln-ID|V-234772",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "True",
        "powershell_args": "(Get-WebConfigurationProperty -Filter /system.webServer/security/authentication/clientCertificateMappingAuthentication -Name enabled -PSPath 'IIS:\\Sites\\Default Web Site/Microsoft-Server-ActiveSync').Value",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_17": {
        "description": "EX13-CA-000045 - Exchange Email Diagnostic log level must be set to lowest level.",
        "info": "Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. Diagnostic logging, however, characteristically produces large volumes of data and requires care in managing the logs to prevent risk of disk capacity denial of service conditions.\n\nExchange diagnostic logging is broken up into 29 main 'services', each of which has anywhere from 2 to 26 'categories' of events to be monitored. Moreover, each category may be set to one of four levels of logging: Lowest, Low, Medium, and High, depending on how much detail one desires. The higher the level of detail, the more disk space required to store the audit material.\n\nDiagnostic logging is intended to help administrators debug problems with their systems, not as a general purpose auditing tool. Because the diagnostic logs collect a great deal of information, the log files may grow large very quickly. Diagnostic log levels may be raised for limited periods of time when attempting to debug relevant pieces of Exchange functionality. Once debugging has finished, diagnostic log levels should be reduced again.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-EventLogLevel -Identity <'IdentityName\\EventlogName'> -Level Lowest\n\nNote: Thevalue must be in quotes.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234773r617260_rule,STIG-ID|EX13-CA-000045,STIG-Legacy|SV-84353,STIG-Legacy|V-69731,SWIFT-CSCv1|6.4,Vuln-ID|V-234773",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-EventLogLevel ; $settings | Format-List Identity, EventLevel; If ($settings | Where {$_.EventLevel -ne 'Lowest'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_18": {
        "description": "EX13-CA-000050 - Exchange must have Audit record parameters set.",
        "info": "Log files help establish a history of activities, and can be useful in detecting attack attempts. This item declares the fields that must be available in the audit log file in order to adequately research events that are logged.\n\nAudit records should include the following fields to supply useful event accounting:\nObject modified, Cmdlet name, Cmdlet parameters, Modified parameters, Caller, Succeeded, and Originating server.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig -AdminAuditLogParameters *",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12a.,800-53r5|AU-12a.,CAT|III,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-12a.,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,Rule-ID|SV-234774r617263_rule,STIG-ID|EX13-CA-000050,STIG-Legacy|SV-84355,STIG-Legacy|V-69733,SWIFT-CSCv1|6.4,Vuln-ID|V-234774",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "AdminAuditLogParameters[\\s]+:[\\s]+\\{\\*\\}",
        "powershell_args": "Get-AdminAuditLogConfig | Format-List -property AdminAuditLogParameters",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_19": {
        "description": "EX13-CA-000060 - Exchange must have Send Fatal Errors to Microsoft disabled.",
        "info": "Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. This setting enables an automated log entry to be sent to Microsoft giving general details about the nature and location of the error. Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of debugging information would not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of problems in your Exchange organization. At the very least, it could alert them to (possibly) advantageous timing to mount an attack. At worst, it may provide them with information as to which aspects of Exchange are causing problems and might be vulnerable (or at least sensitive) to attack.\n\nAll system errors in Exchange will result in outbound traffic that may be identified by an eavesdropper. For this reason, the 'Report Fatal Errors to Microsoft' feature must be disabled.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ExchangeServer -Identity-ErrorReportingEnabled $false\n\nNote: Thevalue must be in quotes.\n\nRepeat the procedure for each Identity.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234776r617269_rule,STIG-ID|EX13-CA-000060,STIG-Legacy|SV-84359,STIG-Legacy|V-69737,SWIFT-CSCv1|2.3,Vuln-ID|V-234776",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ExchangeServer -status ; $settings | Format-List Name, Identity, ErrorReportingEnabled; If ($settings | Where {$_.ErrorReportingEnabled -ne $false}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_20": {
        "description": "EX13-CA-000070 - Exchange must not send Customer Experience reports to Microsoft.",
        "info": "It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OrganizationConfig -CustomerFeedbackEnabled $false",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234778r617275_rule,STIG-ID|EX13-CA-000070,STIG-Legacy|SV-84363,STIG-Legacy|V-69741,SWIFT-CSCv1|2.3,Vuln-ID|V-234778",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OrganizationConfig; $settings | Format-List CustomerFeedbackEnabled; If ($settings | Where {$_.CustomerFeedbackEnabled -ne $false}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_21": {
        "description": "EX13-CA-000090 - Exchange Local machine policy must require signed scripts.",
        "info": "Scripts often provide a way for attackers to infiltrate a system, especially those downloaded from untrusted locations. By setting machine policy to prevent unauthorized script executions, unanticipated system impacts can be avoided. Failure to allow only signed remote scripts reduces the attack vector vulnerabilities from unsigned remote scripts.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-ExecutionPolicy RemoteSigned",
        "reference": "800-171|3.4.5,800-53|CM-5(3),800-53r5|CM-14,CAT|II,CCI|CCI-001749,CSF|PR.IP-1,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-5(3),NESA|T3.2.3,NESA|T5.1.1,NESA|T5.6.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.3,QCSC-v1|7.2,Rule-ID|SV-234782r617287_rule,STIG-ID|EX13-CA-000090,STIG-Legacy|SV-84373,STIG-Legacy|V-69751,Vuln-ID|V-234782",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "RemoteSigned",
        "powershell_args": "Get-ExecutionPolicy",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_22": {
        "description": "EX13-CA-000095 - Exchange IMAP4 service must be disabled.",
        "info": "The IMAP4 protocol is not approved for use within the DoD. It uses a clear text-based user name and password and does not support the DoD standard for PKI for email access. User name and password could easily be captured from the network, allowing malicious users to access other system features. Uninstalling or disabling the service will prevent the use of the IMAP4 protocol.",
        "solution": "Open the Windows PowerShell and enter the following command:\n\nservices.msc\n\nNavigate to and double-click on Microsoft Exchange IMAP4 Backend.\n\nClick on the General tab.\n\nIn the Startup Type: dropdown, select Disabled.\n\nClick the OK button.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234783r617290_rule,STIG-ID|EX13-CA-000095,STIG-Legacy|SV-84375,STIG-Legacy|V-69753,SWIFT-CSCv1|2.3,Vuln-ID|V-234783",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-Service | Where {$_.Name -eq 'MSExchangeIMAP4'} ; $settings | Format-List Name, StartType; If ($settings | Where {$_.StartType -ne 'Disabled'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_23": {
        "description": "EX13-CA-000100 - Exchange POP3 service must be disabled.",
        "info": "The POP3 protocol is not approved for use within the DoD. It uses a clear text based user name and password and does not support the DoD standard for PKI for email access. User name and password could easily be captured from the network allowing malicious users to access other system features. Uninstalling or disabling the service will prevent the use of the POP3 protocol.",
        "solution": "Open the Windows PowerShell and enter the following command:\n\nservices.msc\n\nNavigate to and double-click on Microsoft Exchange POP3 Backend.\n\nClick on the General tab.\n\nIn the Startup Type: dropdown, select Disabled.\n\nClick the OK button.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234784r617293_rule,STIG-ID|EX13-CA-000100,STIG-Legacy|SV-84377,STIG-Legacy|V-69755,SWIFT-CSCv1|2.3,Vuln-ID|V-234784",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-Service | Where {$_.Name -eq 'MSExchangePOP3'} ; $settings | Format-List Name, StartType; If ($settings | Where {$_.StartType -ne 'Disabled'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_24": {
        "description": "EX13-CA-000105 - Exchange must have the Public Folder virtual directory removed if not in use by the site.",
        "info": "To reduce the vectors through which a server can be attacked, unneeded application components should be disabled or removed.\n\nBy default, a virtual directory is installed for Public Folders. If an attacker were to intrude into an Exchange CA server and be able to access the Public Folder website, it would provide an additional attack vector, provided the virtual directory was present.\n\nOnce removed, the Public functionality cannot be used without restoring the virtual directory.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nRemove-PublicFolder -Identity 'IdentityName' -Recurse:$True\n\nNote: This command deletes the public folder Directory Folder and all its child public folders.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234785r617296_rule,STIG-ID|EX13-CA-000105,STIG-Legacy|SV-84379,STIG-Legacy|V-69757,SWIFT-CSCv1|2.3,Vuln-ID|V-234785",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "Public folders not used",
        "powershell_args": "If (Get-PublicFolder -ErrorAction Ignore) { Get-PublicFolder | Format-List Name, Identity } Else { 'Public folders not used' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_25": {
        "description": "EX13-CA-000110 - Exchange must have the Microsoft Active Sync directory removed.",
        "info": "To reduce the vectors through which a server can be attacked, unneeded application components should be disabled or removed. By default, a virtual directory is installed for Active Sync, and the Exchange application default has Active Sync disabled.\n\nIf an attacker were to intrude into an Exchange CA server and reactivate Active Sync, this attack vector could once again be open, provided the virtual directory is present.\n\nOnce removed, the Active Sync functionality cannot be used without restoring the virtual directory, not a trivial process.",
        "solution": "Open an Exchange Command Shell and enter the following command:\n\nRemove-ActiveSyncVirtualDirectory\\Microsoft-Server-ActiveSync -Confirm $true\n\nNote: The physical directory must also be deleted.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7a.,800-53r5|CM-7a.,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7a.,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.1,PCI-DSSv4.0|2.2.3,QCSC-v1|3.2,Rule-ID|SV-234786r617299_rule,STIG-ID|EX13-CA-000110,STIG-Legacy|SV-84381,STIG-Legacy|V-69759,SWIFT-CSCv1|2.3,Vuln-ID|V-234786",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ActiveSyncVirtualDirectory; $settings | Format-List Server, Name, Identity, Path; If ($settings | Where {$_.Path -ne ''}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_26": {
        "description": "EX13-CA-000115 - Exchange application directory must be protected from unauthorized access.",
        "info": "Default product installations may provide more generous access permissions than are necessary to run the application. By examining and tailoring access permissions to more closely provide the least amount of privilege possible, attack vectors that align with user permissions are less likely to access more highly secured areas.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update the EDSP.\n\nRemove or modify the group or user access permissions.",
        "reference": "800-171|3.4.9,800-53|CM-11(2),800-53r5|CM-11(2),CAT|II,CCI|CCI-001812,CSF|DE.CM-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.6.2,QCSC-v1|8.2.1,Rule-ID|SV-234787r617302_rule,STIG-ID|EX13-CA-000115,STIG-Legacy|SV-84383,STIG-Legacy|V-69761,SWIFT-CSCv1|5.1,Vuln-ID|V-234787",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "Manual Review Required",
        "powershell_args": "$d = $env:exchangeinstallpath -Replace '\\\\$'; icacls $d",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_27": {
        "description": "EX13-CA-000130 - Exchange services must be documented and unnecessary services must be removed or disabled.",
        "info": "Unneeded but running services offer attackers an enhanced attack profile, and attackers are constantly watching to discover open ports with running services. By analyzing and disabling unneeded services, the associated open ports become unresponsive to outside queries, and servers become more secure as a result.\n\nExchange Server has role-based server deployment to enable protocol path control and logical separation of network traffic types.\n\nFor example, a server implemented in the Client Access role (i.e., Outlook Web App [OWA]) is configured and tuned as a web server using web protocols. A client access server exposes only web protocols (HTTP/HTTPS), enabling system administrators to optimize the protocol path and disable all services unnecessary for Exchange web services. Similarly, servers created to host mailboxes are dedicated to that task and must operate only the services needed for mailbox hosting. (Exchange servers must also operate some Web services, but only to the degree that Exchange requires the IIS engine in order to function).\n\nBecause POP3 and IMAP4 clients are not included in the standard desktop offering, they must be disabled.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update the EDSP with the services required for the system to function.\n\nRemove or disable any services that are not required.",
        "reference": "800-171|3.4.7,800-53|CM-7(1)(b),800-53r5|CM-7(1)(b),CAT|II,CCI|CCI-001762,CSF|PR.IP-1,CSF|PR.PT-3,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7(1),NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,Rule-ID|SV-234790r617311_rule,STIG-ID|EX13-CA-000130,STIG-Legacy|SV-84389,STIG-Legacy|V-69767,SWIFT-CSCv1|2.3,Vuln-ID|V-234790",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "Manual Review Required",
        "powershell_args": "Get-Service | Where-Object {$_.status -eq 'running'}",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_28": {
        "description": "EX13-CA-000135 - Exchange Outlook Anywhere (OA) clients must use NTLM authentication to access email.",
        "info": "Identification and authentication provide the foundation for access control. Access to email services applications requires NTLM authentication. Outlook Anywhere, if authorized for use by the site, must use NTLM authentication when accessing email.\n\nNote: There is a technical restriction in Exchange OA that requires a direct SSL connection from Outlook to the CA server. There is also a constraint where Microsoft supports that the CA server must participate in the AD domain inside the enclave. For this reason, Outlook Anywhere must be deployed only for enclave-sourced Outlook users.",
        "solution": "Open the Exchange Management Shell and enter the following commands:\n\nFor InternalClientAuthenticationMethod:\n\nSet-OutlookAnywhere -Identity '-InternalClientAuthenticationMethod NTLM\n\nFor ExternalClientAuthenticationMethod:\n\nSet-OutlookAnywhere -Identity '-ExternalClientAuthenticationMethod NTLM",
        "reference": "800-171|3.5.1,800-53|IA-2(12),800-53r5|IA-2(12),CAT|II,CCI|CCI-001953,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,Rule-ID|SV-234791r617314_rule,STIG-ID|EX13-CA-000135,STIG-Legacy|SV-84391,STIG-Legacy|V-69769,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-234791",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OutlookAnywhere; $settings | Format-List Name, Identity, InternalClientAuthenticationMethod, ExternalClientAuthenticationMethod; If ($settings | Where {$_.InternalClientAuthenticationMethod -ne 'NTLM' -or $_.ExternalClientAuthenticationMethod -ne 'NTLM'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_29": {
        "description": "EX13-CA-000140 - Exchange software must be installed on a separate partition from the OS.",
        "info": "In the same way that added security layers can provide a cumulative positive effect on security posture, multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to the host system can most likely lead to a compromise of all applications hosted by the same system.\n\nEmail services should be installed on a partition that does not host other applications. Email services should never be installed on a Domain Controller/Directory Services server.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Update the EDSP.\n\nInstall Exchange on a dedicated application directory or partition separate than that of the OS.",
        "reference": "800-53|SC-39,800-53r5|SC-39,CAT|II,CCI|CCI-002530,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),QCSC-v1|5.2.1,Rule-ID|SV-234792r617317_rule,STIG-ID|EX13-CA-000140,STIG-Legacy|SV-84393,STIG-Legacy|V-69771,Vuln-ID|V-234792",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "Manual Review Required",
        "powershell_args": "'OS Path: ' + $env:systemroot; 'Exchange Path: ' + $env:exchangeinstallpath;",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_30": {
        "description": "EX13-CA-000145 - Exchange must provide redundancy.",
        "info": "Load balancing is a way to manage which Exchange servers receive traffic. Load balancing helps distribute incoming client connections over a variety of endpoints. This ensures that no one endpoint takes on a disproportional share of the load. Load balancing provides failover redundancy in case one or more endpoints fails. By using load balancing, users continue to receive Exchange service in case of a computer failure. Load balancing also enables Exchange to handle more traffic than one server can process while offering a single host name for your clients.",
        "solution": "Update the EDSP.\n\nConfigure two or more CAS servers for load balancing.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1,Rule-ID|SV-234793r617320_rule,STIG-ID|EX13-CA-000145,STIG-Legacy|SV-84395,STIG-Legacy|V-69773,Vuln-ID|V-234793",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ExchangeServer | Where {$_.IsClientAccessServer -eq $true}; $settings | Format-List Name, Identity, IsClientAccessServer; If (($settings | Measure).Count -lt 2) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_31": {
        "description": "Check for internal OWA services",
        "value_data": "yes",
        "powershell_args": "$value = '@INTERNAL_OWA_ENABLED@'; $value"
    },
    "custom_item_32": {
        "description": "EX13-CA-000150 - Exchange OWA must use https - Internal",
        "info": "Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OWAVirtualDirectory -Identity '\\owa (Default Web Site)' -ExternalUrl 'https://URL' -InternalUrl 'https://URL'\n\nNote: The\\owa (default web site) value must be in quotes.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|I,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-234794r617323_rule,STIG-ID|EX13-CA-000150,STIG-Legacy|SV-84397,STIG-Legacy|V-69775,Vuln-ID|V-234794",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OwaVirtualDirectory ; $settings | Format-List Internalurl; If ($settings | Where {($_.Internalurl -NotLike 'https://*')}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_33": {
        "description": "Check for external OWA services",
        "value_data": "yes",
        "powershell_args": "$value = '@EXTERNAL_OWA_ENABLED@'; $value"
    },
    "custom_item_34": {
        "description": "EX13-CA-000150 - Exchange OWA must use https - External",
        "info": "Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OWAVirtualDirectory -Identity '\\owa (Default Web Site)' -ExternalUrl 'https://URL' -InternalUrl 'https://URL'\n\nNote: The\\owa (default web site) value must be in quotes.",
        "reference": "800-171|3.13.8,800-53|SC-8,800-53r5|SC-8,CAT|I,CCI|CCI-002418,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ITSG-33|SC-8,ITSG-33|SC-8a.,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-234794r617323_rule,STIG-ID|EX13-CA-000150,STIG-Legacy|SV-84397,STIG-Legacy|V-69775,Vuln-ID|V-234794",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OwaVirtualDirectory ; $settings | Format-List Internalurl; If ($settings | Where {($_.Externalurl -NotLike 'https://*')}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_35": {
        "description": "EX13-CA-000155 - Exchange OWA must have S/MIME Certificates enabled.",
        "info": "Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered.\n\nThis requirement applies only to those applications that are either distributed or can allow access to data non-locally. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, applications need to leverage transmission protection mechanisms, such as TLS, SSL VPNs, or IPsec.\n\nCommunication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.",
        "solution": "Open the Exchange Management Shell and enter the following command:\n\nSet-OWAVirtualDirectory -Identity '\\owa (Default Web Site)' -SmimeEnabled $true\n\nNote: The\\owa (Default Web Site) value must be in quotes.",
        "reference": "800-171|3.13.8,800-53|SC-8(1),800-53r5|SC-8(1),CAT|II,CCI|CCI-002421,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,Rule-ID|SV-234795r617326_rule,STIG-ID|EX13-CA-000155,STIG-Legacy|SV-84399,STIG-Legacy|V-69777,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-234795",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-OWAVirtualDirectory ; $settings | Format-List Name, Identity, SmimeEnabled; If ($settings | Where {$_.SmimeEnabled -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_36": {
        "description": "EX13-CA-000160 - Exchange must have the most current, approved service pack installed.",
        "info": "Failure to install the most current Exchange service pack leaves a system vulnerable to exploitation. Current service packs correct known security and system vulnerabilities.",
        "solution": "Install the most current, approved service pack.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CAT|II,CCI|CCI-002605,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,Rule-ID|SV-234796r811165_rule,STIG-ID|EX13-CA-000160,STIG-Legacy|SV-84401,STIG-Legacy|V-69779,SWIFT-CSCv1|2.2,Vuln-ID|V-234796",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "$pass = $true; Get-ExchangeServer | Format-List Name, AdminDisplayVersion; foreach ($item in (Get-ExchangeServer).AdminDisplayVersion -Replace '.* ' -Replace '\\..*' ) { if (([int]$item) -lt 1497) { $pass = $false } }; If ($pass) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_37": {
        "description": "EX13-CA-000165 - Exchange must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.",
        "info": "Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.",
        "solution": "Configure web ports to be 80, 81 and 443, 444, as specified by PPSM standards.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,DISA_Benchmark|MS_Exchange_2013_CAS_STIG,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,NESA|T3.2.1,Rule-ID|SV-234797r617332_rule,STIG-ID|EX13-CA-000165,STIG-Legacy|SV-84403,STIG-Legacy|V-69781,SWIFT-CSCv1|2.3,Vuln-ID|V-234797",
        "see_also": "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Exchange_2013_Y21M12_STIG.zip",
        "value_data": "All policies compliant",
        "powershell_args": "Get-Website | Where {$_.Name -ne 'Exchange Back End'}; If (((Get-Website | Where {$_.Name -ne 'Exchange Back End'}).Bindings).Collection | Where {(($_.protocol -eq 'http' -and_.bindingInformation -notlike '*:80:*') -or ($_.protocol -eq 'https' -and $_.bindingInformation -notlike '*:443:*'))}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    }
}