{
    "custom_item_1": {
        "description": "Test secure string",
        "value_data": ".*",
        "powershell_args": "hostname",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_2": {
        "description": "CIS_Microsoft_Exchange_Server_2019_v1.0.0_Level_1_Mailbox.audit from CIS Microsoft Exchange Server 2019 Benchmark v1.0.0",
        "info": "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "reference": "800-171|3.14.1,800-53|SI-2c.,800-53r5|SI-2c.,CN-L3|8.1.4.4(e),CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|SS14b,PCI-DSSv3.2.1|6.2,PCI-DSSv4.0|6.3,PCI-DSSv4.0|6.3.3,QCSC-v1|11.2,SWIFT-CSCv1|2.2",
        "value_data": "[\\s]+15\\.2[\\s]+.*[\\s]+True",
        "powershell_args": "If (Get-ExchangeServer) { Get-ExchangeServer -Identity $ENV:COMPUTERNAME | Format-Table Name, AdminDisplayVersion, IsMailboxServer } Else { 'No Exchange servers found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_3": {
        "description": "Platform check",
        "value_data": "[\\s]+15\\.2[\\s]+.*[\\s]+True",
        "powershell_args": "If (Get-ExchangeServer) { Get-ExchangeServer -Identity $ENV:COMPUTERNAME | Format-Table Name, AdminDisplayVersion, IsMailboxServer } Else { 'No Exchange servers found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_4": {
        "description": "2.1.1 Ensure 'Mailbox quotas: Issue warning at' is set to ''",
        "info": "This policy setting can automatically warn mailbox users that their mailbox is approaching its storage limit. It's suggested that this warning be set up when 90% of the mailbox size has been reached. For example, if the mailbox size is 100GB, set the warning to 90GB or 94,371,840 KB.\n\nA value between 0 and 2,147,483,647 KB (2.1 terabytes) can be set depending on the user's mailbox size.\n\nRationale:\n\nUnlimited mailbox sizes can cause the Exchange database to grow uncontrollably and consume all available disk space, potentially preventing the database from mounting properly. This can disrupt not only email services, but also other security measures that depend on timely communication.\n\nImpact:\n\nUsers will receive a warning when their mailboxes reach the specified value.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-MailboxDatabase 'Mailbox Database' -IssueWarningQuotaKB\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nChange Issue a warning at (GB): toand click Save.\n\nDefault Value:\n\n1.899 GB (2,039,480,320 bytes)",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$pass = $true; Get-MailboxDatabase | Format-List Identity, IssueWarningQuota; foreach ($item in (Get-MailboxDatabase).IssueWarningQuota -Replace '.*\\(' -Replace ' .*' ) { if (([int64]$item)/1KB -gt 1991680) { $pass = $false } }; If ($pass) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_5": {
        "description": "2.1.2 Ensure 'Retain deleted items for the specified number of days' is set to '14'",
        "info": "This policy setting specifies how long deleted messages are retained before they are permanently removed from the database.\n\nRationale:\n\nDefining a reasonable retention period facilitates recovering accidentally deleted messages while controlling the volume of storage that retained messages require.\n\nImpact:\n\nNone - This is the default behavior.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-MailboxDatabase 'Mailbox Database' -DeletedItemRetention 14\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nChange Keep deleted items for (days): to 14 and click Save.\n\nDefault Value:\n\n14",
        "reference": "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|SI-12,CSCv8|3.4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "DeletedItemRetention[\\s]+:[\\s]+14\\.00:00:00",
        "powershell_args": "Get-MailboxDatabase | Format-List -property DeletedItemRetention",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_6": {
        "description": "2.1.3 Ensure 'Mailbox quotas: Prohibit send and receive at' is set to ''",
        "info": "This policy setting can automatically prevent users from sending and receiving e-mail messages after their mailbox size reaches the specified limit. It's suggested that this warning be set up when 98% of the mailbox size has been reached. For example, if the mailbox size is 100 GB, set the warning to 98 GB or 102,760,448 KB.\n\nA value between 0 and 2,147,483,647 KB (2.1 terabytes) can be set depending on the user's mailbox size.\n\nRationale:\n\nUnlimited mailbox sizes can cause the Exchange database to grow uncontrollably and consume all available disk space, potentially preventing the database from mounting properly. This can disrupt not only email services but also other security measures that depend on timely communication.\n\nImpact:\n\nUsers will be unable to send or receive messages when their mailboxes reach the specified value.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-MailboxDatabase 'Mailbox Database' -ProhibitSendReceiveQuotaGB\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nChange Prohibit send and receive at (GB): toand click Save.\n\nDefault Value:\n\n2.3 GB (2,469,396,480 bytes)",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$pass = $true; Get-MailboxDatabase | Format-List Identity, ProhibitSendReceiveQuota; foreach ($item in (Get-MailboxDatabase).ProhibitSendReceiveQuota -Replace '.*\\(' -Replace ' .*' ) { if (([int64]$item)/1KB -gt 2411520) { $pass = $false } }; If ($pass) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_7": {
        "description": "2.1.4 Ensure 'Mailbox quotas: Prohibit send at' is set to ''",
        "info": "This policy setting can automatically prevent users from sending new e-mail messages after their mailboxes reach a specified limit. It's suggested that this warning be set up when 95% of the mailbox size has been reached. For example, if the mailbox size is 100 GB, set the warning to 95 GB or 99,614,720 KB.\n\nA value between 0 and 2,147,483,647 KB (2.1 terabytes) can be set depending on the user's mailbox size.\n\nRationale:\n\nUnlimited mailbox sizes can cause the Exchange database to grow uncontrollably and consume all available disk space, potentially preventing the database from mounting properly. This can disrupt not only email services but also other security measures that depend on timely communication.\n\nImpact:\n\nUsers will be unable to send messages when their mailboxes reach the specified value.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-MailboxDatabase 'Mailbox Database'  -ProhibitSendQuotaOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nChange Prohibit send at (GB): toand click Save.\n\nDefault Value:\n\n2 GB (2,147,483,648 bytes)",
        "reference": "800-53|SC-6,800-53r5|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-6,ITSG-33|SC-6a.,LEVEL|1A,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$pass = $true; Get-MailboxDatabase | Format-List Identity, ProhibitSendQuota; foreach ($item in (Get-MailboxDatabase).ProhibitSendQuota -Replace '.*\\(' -Replace ' .*' ) { if (([int64]$item)/1KB -gt 2097152) { $pass = $false } }; If ($pass) { 'All policies compliant' } Else { 'Non compliant policies found' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_8": {
        "description": "2.1.5 Ensure 'Keep deleted mailboxes for the specified number of days' is set to '30'",
        "info": "This policy setting specifies how long deleted mailboxes are retained before they are permanently removed from the database.\n\nRationale:\n\nDefining a reasonable retention period facilitates recovering accidentally or deliberately deleted mailboxes while controlling the volume of storage that retained mailboxes require.\n\nImpact:\n\nNone - This is the default behavior.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-Mailboxdatabase 'Mailbox Database' -MailboxRetention 30.00:00:00\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nChange Keep deleted mailboxes for (days): to 30 and click Save.\n\nDefault Value:\n\n30",
        "reference": "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|SI-12,CSCv8|3.4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "MailboxRetention[\\s]+:[\\s]+30\\.00:00:00",
        "powershell_args": "Get-Mailboxdatabase | Format-List -property MailboxRetention",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_9": {
        "description": "2.1.6 Ensure 'Do not permanently delete items until the database has been backed up' is set to 'True'",
        "info": "This policy setting can prohibit items from being permanently deleted until the database has been backed up.\n\nRationale:\n\nTo ensure that accidentally deleted items can be recovered, they should not be permanently deleted until the database is backed up.\n\nImpact:\n\nAdditional storage space will be required until any pending items are permanently deleted.\n\nIf using a 3rd party backup solution that does not set the backup parameters on the Mailbox database as it is backed up then this setting should be skipped. Native backup solutions will update the database bits properly, allowing for the RetainDeletedItemsUntilBackup parameter work as intended.\n\nFailure to evaluate the organization's backup solution in conjunction with this setting will result in increased database growth. To see the backup parameters mentioned above run Get-MailboxDatabase | fl *backup*",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-MailboxDatabase 'Mailbox Database' -RetainDeletedItemsUntilBackup $true\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Databases' tab.\n\nDouble-click the database and go to the 'Limits' settings.\n\nEnsure the Don't permanently delete items until the database is backed up box is checked and click Save.\n\nDefault Value:\n\nFalse",
        "reference": "800-53|AU-11,800-53|SI-12,800-53r5|AU-11,800-53r5|SI-12,CSCv8|3.4,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-11,ITSG-33|SI-12,ITSG-33|SI-12a.,LEVEL|1A,NESA|M5.2.3,NESA|M5.2.4,NESA|M5.3.1,NESA|T3.6.2,NIAv2|DR1,NIAv2|DR1a,NIAv2|DR1b,NIAv2|DR1c,NIAv2|DR2,NIAv2|DR3,NIAv2|DR4,NIAv2|DR5,NIAv2|DR6,NIAv2|SM7,PCI-DSSv3.2.1|3.1,PCI-DSSv3.2.1|10.7,PCI-DSSv4.0|3.2.1,PCI-DSSv4.0|10.5.1,QCSC-v1|8.2.1,QCSC-v1|13.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "RetainDeletedItemsUntilBackup[\\s]+:[\\s]+True",
        "powershell_args": "Get-MailboxDatabase | Format-List -property RetainDeletedItemsUntilBackup",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_10": {
        "description": "2.2.1 Ensure 'Transport Pickup Directory Path' is not set",
        "info": "The Pickup directory is used by the Transport service on Mailbox servers and Edge Transport servers to insert message files directly into the transport pipeline. When properly formatted email message files are copied to the Pickup directory, they are submitted for delivery automatically. It is a legacy feature that can be used by administrators for mail flow testing, or by applications that must create and submit their own messages.\n\nEnsure PickupDirectoryPath is set to $null\n\nRationale:\n\nDisabling the Pickup directory is recommended to prevent potential abuse by attackers or insiders seeking to exploit side channel attacks. Dropping a file in the Pickup folder bypasses the normal authentication process of Exchange, creating a risk of sensitive data leakage or malicious email distribution through this unauthenticated side channel.\n\nImpact:\n\nThe directory will be unavailable for testing purposes unless an administrator explicitly enables it and then later disables it. If an application requires access to this directory, then additional controls should be enabled such as restricting NTFS permissions on the folder.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet to disable the Pickup Directory on all servers with the Mailbox role\n\nGet-TransportService | Set-TransportService -PickupDirectoryPath $null\n\nNOTE: Edge Transport Servers must be configured directly.\n\nDefault Value:\n\n%programfiles%\\Microsoft\\Exchange Server\\V15\\TransportRoles\\Pickup",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53r5|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "PickupDirectoryPath[\\s]*:[\\s]*$",
        "powershell_args": "Get-TransportService | Format-List -property PickupDirectoryPath",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_11": {
        "description": "2.2.2 Ensure 'Maximum send size: Organization level' is set to '25'",
        "info": "This policy setting limits the size of a message a user can send. Send size includes the header, the message body, and any attachments.\n\nFor internal message flow, Exchange Server uses the custom X-MS-Exchange-Organization-OriginalSize message header to record the original message size of the message as it enters the Exchange Server organization. Whenever the message is checked against the specified message size limits, the lower value of the current message size or the original message size header is used. The size of the message can change because of content conversion, encoding, and agent processing.\n\nRationale:\n\nThis setting limits the impact that a malicious user or a system with malware can have on the Exchange infrastructure by restricting the size of outgoing messages.\n\nImpact:\n\nUsers will not be able to send a message larger than the limit.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-TransportConfig -MaxSendSize 25MB\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Send Connectors' tab.\n\nClick on '...' and select 'Organization Transport Settings'.\n\nChange the Maximum send message size (MB): to 25 and click Save.\n\nDefault Value:\n\n10 MB (10,485,760 bytes)",
        "reference": "800-53|SC-5(1),800-53r5|SC-5(1),CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(1),LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "MaxSendSize[\\s]+:[\\s]+25[^0-9]",
        "powershell_args": "Get-TransportConfig | Format-List -property MaxSendSize",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_12": {
        "description": "2.2.3 Ensure 'Maximum receive size: Organization level' is set to '25'",
        "info": "This policy setting can limit the size of messages received by the user. The message size includes the header, body, and any attachments for the email.\n\nFor internal message flow, Exchange Server uses the custom X-MS-Exchange-Organization-OriginalSize message header to record the original message size of the message as it enters the Exchange Server organization. Whenever the message is checked against the specified message size limits, either the lower value of the current message size or the original message size header is used. The size of the message can change because of content conversion, encoding, and agent processing.\n\nRationale:\n\nThis setting limits the impact that a malicious user or a computer with malware can have on the Exchange infrastructure by restricting the size of incoming messages.\n\nImpact:\n\nUsers will not be able to receive messages larger than the limit.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-TransportConfig -MaxReceiveSize 25MB\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Receive Connectors' tab.\n\nClick on '...' and select 'Organization Transport Settings'\n\nChange the Maximum receive message size (MB): to 25 and click Save.\n\nDefault Value:\n\n10 MB (10,485,760 bytes)",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "MaxReceiveSize[\\s]+:[\\s]+25[^0-9]",
        "powershell_args": "Get-TransportConfig | Format-List -property MaxReceiveSize",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_13": {
        "description": "2.2.4 Ensure 'Maximum send size: Connector level' is set to '25'",
        "info": "This policy setting can limit the size of messages that are be sent by the user at the connector level. The message size includes the header, body, and any attachments for the email.\n\nFor internal message flow, Exchange Server uses the custom X-MS-Exchange-Organization-OriginalSize message header to record the original message size of the message as it enters the Exchange Server organization. Whenever the message is checked against the specified message size limits, the lower value of the current message size or the original message size header is used. The size of the message can change because of content conversion, encoding, and agent processing.\n\nRationale:\n\nThis setting somewhat limits the impact a malicious user or a computer with malware can have on the Exchange infrastructure by restricting the size of incoming messages.\n\nImpact:\n\nUsers will not be able to send messages larger than the limit.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector 'Connection to Contoso.com' -MaxMessageSize 25MB\n\nOR\n\nPerform the following actions via the GUI:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Send Connectors' tab.\n\nDouble-click on the send connector to be modified.\n\nChange the Maximum send message size (MB): to 25 and click Save.\n\nDefault Value:\n\n10 MB (10,485,760 bytes)",
        "reference": "800-53|SC-5(1),800-53r5|SC-5(1),CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5(1),LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-SendConnector; $settings | Format-List Name, MaxMessageSize; If ($settings | Where {$_.MaxMessageSize -NotLike '25 MB*'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_14": {
        "description": "2.2.5 Ensure 'Maximum receive size: Connector level' is set to '25'",
        "info": "This setting limits the size of a message a user can receive. Receive size includes the header This includes the message header, the message body, and any attachments. For internal message flow, Exchange Server uses the custom X-MS-Exchange-Organization-OriginalSize message header to record the original message size of the message as it enters the Exchange Server organization. Whenever the message is checked against the specified message size limits, the lower value of the current message size or the original message size header is used. The size of the message can change because of content conversion, encoding, and agent processing.\n\nRationale:\n\nThis setting somewhat limits the impact a malicious user or a computer with malware can have on the Exchange infrastructure by restricting the size of incoming messages.\n\nImpact:\n\nUsers will not be able to receive messages larger than the limit.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-ReceiveConnector 'Connection from Contoso.com' -MaxMessageSize 25MB\n\nTo set MaxMessageSize on all receive connectors this command can be executed:\n\nGet-ReceiveConnector | Set-ReceiveConnector -MaxMessageSize 25MB\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Receive Connectors' tab.\n\nDouble-click on the receive connector to be modified.\n\nChange the Maximum receive message size (MB): to25and click Save.\n\nDefault Value:\n\n36 MB (37,748,736 bytes)",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ReceiveConnector; $settings | Format-List Name, MaxMessageSize; If ($settings | Where {$_.MaxMessageSize -NotLike '25 MB*'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_15": {
        "description": "2.2.6 Ensure 'Send connector timeout' is set to '10'",
        "info": "This parameter controls the number of idle minutes before the connection to the Send connector is dropped, even if data is being actively transmitted.\n\nNote: The ConnectionTimeout parameter must be higher than the ConnectionInactivityTimeout parameter.\n\nRationale:\n\nConnections may suffer from delays in message transfer once established. In order to allow new connections to be established, the timeout period should be reduced so that connections are not maintained for unnecessary periods of time.\n\nImpact:\n\nValid connections could be dropped.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector -Identity <'IdentityName'> -ConnectionInactivityTimeOut 00:10:00\n\nDefault Value:\n\n00:10:00 (10 minutes)",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,LEVEL|1A,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,SWIFT-CSCv1|2.6",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$limit = New-TimeSpan -Minutes 10; $settings = Get-SendConnector; $settings | Format-List Name, Identity, ConnectionInactivityTimeOut; If ($settings | Where {$_.ConnectionInactivityTimeOut -gt $limit}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_16": {
        "description": "2.2.7 Ensure 'Receive connector timeout' is set to '5'",
        "info": "This parameter controls the number of idle minutes before the connection to the Receive connector is dropped, even if data is being actively transmitted.\n\nNote: The ConnectionTimeout parameter must be higher than the ConnectionInactivityTimeout parameter.\n\nRationale:\n\nConnections may suffer from delays in message transfer once established. In order to allow new connections to be established, the timeout period should be reduced so that connections are not maintained for unnecessary periods of time.\n\nImpact:\n\nValid connections could be dropped.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-ReceiveConnector -Identity-ConnectionTimeout 00:05:00\n\nRepeat the procedures for each Receive connector.\n\nDefault Value:\n\n00:10:00 (10 minutes)",
        "reference": "800-171|3.13.9,800-53|SC-10,800-53r5|SC-10,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-10,ITSG-33|SC-10a.,LEVEL|1A,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,SWIFT-CSCv1|2.6",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$limit = New-TimeSpan -Minutes 5; $settings = Get-ReceiveConnector; $settings | Format-List Name, Identity, ConnectionTimeout; If ($settings | Where {$_.ConnectionTimeout -gt $limit}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_17": {
        "description": "2.2.8 Ensure 'External send connector authentication: DNS routing' is set to 'True'",
        "info": "This policy setting determines if DNS is used to route outbound mail via the send connector.\n\nRationale:\n\nIn order to enable mutual Transport Layer Security (TLS) authentication for the domains serviced by this send connector, multiple parameters must be configured. Configuring these parameters enables the use of TLS instead of basic authentication where credentials are sent across the network in plaintext.\n\nThe following parameters are addressed in separate recommendations in this benchmark.\n\nDomainSecureEnabled to $true\n\nIgnoreStartTLS to $false\n\nImpact:\n\nThe organization's servers will only be able to send e-mail to remote servers that are located through DNS routing. This is the default value.\n\nWarning: If a SmartHosts parameter is specified, the DNSRoutingEnabled parameter must be set to $false.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector 'Connection to Contoso.com' -DNSRoutingEnabled $true\n\nDefault Value:\n\nTrue",
        "reference": "800-53|SC-11,800-53r5|SC-11,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-11,ITSG-33|SC-11a.,LEVEL|1A,NIAv2|NS8,QCSC-v1|5.2.2,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-SendConnector ; $settings | Format-List Name, DNSRoutingEnabled; If ($settings | Where {($_.DNSRoutingEnabled -ne $true)}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_18": {
        "description": "2.2.9 Ensure 'External send connector authentication: IgnoreStartTLS' is set to 'False'",
        "info": "This policy setting specifies whether to ignore the StartTLS option offered by a remote sending server. StartTLS is a protocol command used to inform the email server that the email client wants to upgrade from an insecure connection to a secure one using TLS or SSL.\n\nRationale:\n\nIn order to enable mutual Transport Layer Security (TLS) authentication for the domains serviced by this send connector, multiple parameters must be configured (see below).\n\nConfiguring these parameters enables the use of TLS instead of basic authentication where credentials are sent across the network in plaintext.\n\nThe following parameters are addressed in separate recommendations in this benchmark.\n\nDomainSecureEnabled to$true\n\nDNSRoutingEnabled to $true\n\nImpact:\n\nThe organization's servers will only be able to send e-mail to remote servers that support Domain Security (Mutual Auth TLS).",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector 'Connector Name' -IgnoreSTARTTLS $false\n\nDefault Value:\n\nNone",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-SendConnector ; $settings | Format-List Name, IgnoreSTARTTLS; If ($settings | Where {($_.IgnoreSTARTTLS -ne $false)}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_19": {
        "description": "2.2.10 Ensure 'External send connector authentication: Domain security' is set to 'True'",
        "info": "This setting is part of the process to enable mutual Transport Layer Security (TLS) authentication for the domains serviced by this send connector. If this parameter is enabled, the Send connector will attempt to establish a mutual Transport Layer Security (TLS) connection with remote servers when sending mail.\n\nRationale:\n\nIn order to enable mutual Transport Layer Security (TLS) authentication for the domains serviced by this send connector, multiple parameters must be configured (see below).\n\nConfiguring these parameters enables the use of TLS instead of basic authentication where credentials are sent across the network in plaintext.\n\nThe following parameters are addressed in separate recommendations in this benchmark.\n\nDNSRoutingEnabled to $true\n\nIgnoreStartTLS to $false\n\nImpact:\n\nThe organization's servers will only be able to send e-mail to remote servers that support Domain Security (Mutual Auth TLS).",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector 'Connector name' -DomainSecureEnabled $true\n\nDefault Value:\n\nTrue",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-SendConnector ; $settings | Format-List Name, DomainSecureEnabled; If ($settings | Where {($_.DomainSecureEnabled -ne $true)}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_20": {
        "description": "2.3.3 Ensure 'Enable automatic replies to remote domains' is set to 'False'",
        "info": "This policy setting is used to determine if the server automatically replies to remote domains. The AutoReplyEnabled parameter specifies whether to allow messages that are automatic replies from client email programs in an organization (for example, automatic reply messages that are generated by rules in Outlook).\n\nRationale:\n\nAttackers can use automated messages to determine whether a user is active, in the office, traveling etc. and can use this information to conduct other types of attacks.\n\nImpact:\n\nRemote users will not receive automated replies.\n\nNote: If Microsoft Exchange is being used as HUB, this setting is applicable. If not, an exception to this recommendation might be required.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-RemoteDomain 'RemoteDomain' -AutoReplyEnabled $false\n\nDefault Value:\n\nFalse",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "AutoReplyEnabled[\\s]+:[\\s]+False",
        "powershell_args": "Get-RemoteDomain | Format-List -property AutoReplyEnabled",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_21": {
        "description": "2.3.4 Ensure 'Enable automatic forwards to remote domains' is set to 'False'",
        "info": "This policy setting is used to determine if the server can send automatic forwards to remote domains.\n\nRationale:\n\nData leakage can occur if an email with sensitive data is forwarded to an account that is not secure or sanctioned by the organization.\n\nImpact:\n\nRemote users will not receive automated forward messages.\n\nNote: If Microsoft Exchange is being used as HUB, this setting is applicable. If not, an exception to this recommendation might be required.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-RemoteDomain 'RemoteDomain' -AutoForwardEnabled $false\n\nDefault Value:\n\nFalse",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "AutoForwardEnabled[\\s]+:[\\s]+False",
        "powershell_args": "Get-RemoteDomain | Format-List -property AutoForwardEnabled",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_22": {
        "description": "2.3.5 Ensure 'Enable S/MIME for OWA' is set to 'True'",
        "info": "This policy setting is used to control whether users are allowed to download the Secure/Multipurpose Internet Mail Extensions (S/MIME) control to read and create signed and encrypted messages.\n\nRationale:\n\nS/MIME uses digital signatures and encryption to protect against several classes of attacks including eavesdropping, impersonation, and tampering.\n\nImpact:\n\nUsers will be able to use the S/MIME control when accessing their e-mail via OWA.\n\nThis is the default value.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-OWAVirtualDirectory 'owa (Default Web Site)' -SMimeEnabled $true\n\nDefault Value:\n\nTrue",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "SMimeEnabled[\\s]+:[\\s]+True",
        "powershell_args": "Get-OWAVirtualDirectory 'owa (Default Web Site)' | Format-List -property SMimeEnabled",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_23": {
        "description": "2.3.6 Ensure 'Require client MAPI encryption' is set to 'True'",
        "info": "This policy setting specifies whether encryption is required for Remote Procedure call (RPC) client connections.\n\nNote: This recommendation only applies if RPC over HTTP is enabled in the organization. In Exchange 2019 MAPI over HTTP is enabled by default.\n\nRationale:\n\nCommunications between Outlook and Exchange that are sent unencrypted are vulnerable to being captured by a malicious actor.\n\nImpact:\n\nClient computers running earlier versions of Outlook or Outlook with profiles set to not use encryption will be blocked from connecting to your Exchange servers. This is the default behavior so the impact is minimal to nothing.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-RpcClientAccess -Server 'Server' -EncryptionRequired $true\n\nDefault Value:\n\nTrue",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1A,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "EncryptionRequired[\\s]+:[\\s]+True",
        "powershell_args": "Get-RpcClientAccess | Format-List -property EncryptionRequired",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_24": {
        "description": "2.4.1 Ensure 'POP3' Windows services are 'Disabled'",
        "info": "Post Office Protocol 3 (POP3) is an email protocol for receiving email messages from a server and transferring to a client device. On Exchange Server 2019 with the Mailbox role installed, it is set to manual startup by default.\n\nRationale:\n\nPOP3 is an outdated protocol that has a number of weaknesses versus MAPI and Exchange ActiveSync. POP3 can send credentials in the clear if not configured properly, has limited authentication capabilities, and a lack of proper message handling can result in misplaced or lost e-mails and folders when moving between devices. This may result in data loss for the end user. ActiveSync and MAPI, in contrast, offer superior security by default, provide an enhanced user experience, and are Microsoft's primary focus for support and improvement.\n\nImpact:\n\nDevices that require POP3 to function will be unable to receive e-mail from the Exchange Server. This should not be a problem for most client applications as Outlook 2013 and newer support modern authentication methods (OAuth) and protocols.\n\nIf an organization is required to use POP3 then care must be taken to only enable POP3, the PopEnabled parameter, for the mailbox in question.",
        "solution": "To implement the recommended state, execute the following PowerShell commands:\n\nStop-Service MSExchangePop3,MSExchangePop3BE\nGet-Service MSExchangePOP3,MSExchangePOP3BE | Set-Service -StartupType Disabled\n\nDefault Value:\n\nStartType: Manual",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-Service MSExchangePop3*; $settings | Format-List Name, StartType; If ($settings | Where {($_.StartType -ne 'Disabled')}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_25": {
        "description": "2.4.2 Ensure 'IMAP4' Windows services are 'Disabled'",
        "info": "Internet Message Access Protocol version 4 (IMAP4) is an email protocol for sending and receiving email between a client and server. Unlike POP3 it can synchronize email and folders between the client and server. On Exchange Server 2019 with the Mailbox role installed, it is set to manual startup by default.\n\nRationale:\n\nIMAP4 by default is configured to use basic authentication, which can potentially expose credentials in plain text. While it can be configured to use SSL/TLS for encryption, it is important to disable unnecessary services that duplicate the functionality of more widely used and supported protocols. ActiveSync and MAPI, in contrast, offer superior security by default, provide an enhanced user experience, and are Microsoft's primary focus for support and improvement. By disabling IMAP4, organizations can reduce their attack surface and prioritize the use of more secure and feature-rich protocols.\n\nImpact:\n\nDevices that require IMAP4 to function will be unable to send or receive email from the Exchange Server. This should not be a problem for most client applications as Outlook 2013 and newer support modern authentication methods (OAuth) and protocols.\n\nIf an organization is required to use IMAP4 then care must be taken to only enable IMAP4, the ImapEnabled parameter, for the mailbox in question.",
        "solution": "To implement the recommended state, execute the following PowerShell commands:\n\nStop-Service MSExchangeImap4,MSExchangeIMAP4BE\nGet-Service MSExchangeImap4,MSExchangeIMAP4BE | Set-Service -StartupType Disabled\n\nDefault Value:\n\nStartType: Manual",
        "reference": "800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,800-53r5|CM-6,800-53r5|CM-7,CSCv8|4.8,CSF|PR.IP-1,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6,ITSG-33|CM-7,LEVEL|1A,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-Service MSExchangeImap4*; $settings | Format-List Name, StartType; If ($settings | Where {($_.StartType -ne 'Disabled')}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_26": {
        "description": "2.4.3 Ensure 'Receive connector' is set to 'TLS'",
        "info": "This policy setting configures the advertised and accepted authentication mechanisms for the receive connector.\n\nThe primary function of receive connectors in the front-end transport service is to accept anonymous and authenticated Simple Mail Transfer Protocol (SMTP) connections in the Exchange environment.\n\nNote: Some available values have dependencies and exclusions:\n\nNone is not compatible with other values.\n\nBasicAuthRequireTLS requires BasicAuth and Tls.\n\nExternalAuthoritative can only be combined with Tls.\n\nTls is required when RequireTLS parameter is $true.\n\nExternalAuthoritative, requires PermissionGroups parameter to be ExchangeServers.\n\nRationale:\n\nConfiguring this setting enables the encryption of email between client and servers. This reduces the risk of eavesdropping, interception, and alteration of the email and adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.\n\nImpact:\n\nNo impact is expected.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-ReceiveConnector -Identity <'IdentityName'> -AuthMechanism 'Tls'\n\nNote: If more than one receive connector exists on the mailbox server, run this command to update all receive connectors.\n\nGet-ReceiveConnector | Set-ReceiveConnector -AuthMechanism 'Tls'\n\nDefault Value:\n\nN/A",
        "reference": "800-171|3.1.13,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|14.4,CSCv8|3.10,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|1M,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|SS24,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ReceiveConnector ; $settings | Format-List Name, Identity, AuthMechanism; If ($settings | Where {$_.AuthMechanism -ne 'Tls'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_27": {
        "description": "2.4.5 Ensure 'SMTP automated banner response' is set to '220 SMTP Server Ready'",
        "info": "This policy setting specifies a custom SMTP 220 banner which is displayed to remote messaging servers that connect to the receive connector.\n\nRationale:\n\nThe default value could disclose information that can be used by a third-party to determine operating system and product release levels on the target server. This information can then be used for an attack.\n\nImpact:\n\nN/A",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-ReceiveConnector -Identity <'IdentityName'> -Banner '220 SMTP Server Ready'\n\nDefault Value:\n\n220Microsoft ESMTP MAIL service ready at",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ReceiveConnector ; $settings | Format-List Name, Identity, Banner; If ($settings | Where {$_.Banner -ne '220 SMTP Server Ready'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_28": {
        "description": "4.1 Ensure 'Receive connector: Configure protocol logging' is set to 'Verbose'",
        "info": "A protocol log is a record of the SMTP activity between messaging servers as part of message delivery. This SMTP activity occurs on Send connectors and Receive connectors that are configured with the transport service on Mailbox servers and Edge Transport servers.\n\nRationale:\n\nIf events are not recorded, it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nImpact:\n\nAdditional storage space will be required for the log file.\n\nNote: The default file size for the protocol log is 10MB and is stored for a maximum of 30 days. This may need to be adjusted to adhere to company retention policies.\n\nWarning: Do not enable Protocol logging on an Edge Transport server that has been subscribed to the Exchange organization by using EdgeSync. Those changes need to be made in the Transport service on the Mailbox server. The changes are then replicated to the Edge Transport server the next time EdgeSync synchronization occurs.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-ReceiveConnector 'IDENTITY' -ProtocolLoggingLevel Verbose\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Receive Connectors' tab.\n\nDouble-click on the receive connector to be modified.\n\nChange the Protocol logging level to Verbose and click Save.\n\nDefault Value:\n\nNone",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-ReceiveConnector ; $settings | Format-List Name, ProtocolLoggingLevel; If ($settings | Where {$_.ProtocolLoggingLevel -ne 'Verbose'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_29": {
        "description": "4.2 Ensure 'Turn on administrator audit logging' is set to ''",
        "info": "Administrator audit logging is used to provide a log of the settings that are changed by administrators anywhere in the system.\n\nThis recommendation incorporates the following parameters into one setting:\n\nAdminAuditLogEnabled\n\nAdminAuditLogCmdlets\n\nAdminAuditLogParameters\n\nAdminAuditLogExcludedCmdlets\n\nAdminAuditLogAgeLimit\n\nLogLevel\n\nNote: Changes to the audit log configuration may take up to 60 minutes to be applied on computers that have the Exchange Management Shell open at the time a configuration change is made. For changes to apply immediately, close and reopen the Exchange Management Shell on each computer.\n\nRationale:\n\nAdministrators may be able to reconfigure the system to expose a vulnerability with no record of the changes made.\n\nImpact:\n\nAdditional storage space will be required when setting LogLevel to verbose, but the increase is minimal even for very large environments.",
        "solution": "To implement the recommended state, execute the following PowerShell script:\n\n$params = @{\n    AdminAuditLogEnabled = $True\n    AdminAuditLogCmdlets = '*'\n    AdminAuditLogParameters = '*'\n    AdminAuditLogExcludedCmdlets = $null\n    AdminAuditLogAgeLimit = '90.00:00:00'\n    LogLevel = 'Verbose'\n}\n\nSet-AdminAuditLogConfig @params\n\nDefault Value:\n\nAdminAuditLogEnabled - True\n\nAdminAuditLogCmdlets - *\n\nAdminAuditLogParameters - *\n\nAdminAuditLogExcludedCmdlets - None\n\nAdminAuditLogAgeLimit - 90 days\n\nLogLevel - None The CmdletName, ObjectName, Parameters (values), and the Caller, Succeeded and RunDate properties are included in log entries.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-AdminAuditLogConfig ; $settings | Format-List Name, AdminAuditLog*,LogLevel; If ($settings | Where {($_.AdminAuditLogEnabled -ne $true) -Or ($_.AdminAuditLogCmdlets -ne '*') -Or ($_.AdminAuditLogParameters -ne '*') -Or ($_.AdminAuditLogExcludedCmdlets -ne $null) -Or ($_.AdminAuditLogAgeLimit -ne '90.00:00:00') -Or ($_.LogLevel -ne 'Verbose') }) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_30": {
        "description": "4.3 Ensure 'Turn on connectivity logging' is set to 'True'",
        "info": "A connectivity log is a record of the SMTP connection activity of the outbound message delivery queues to the destination Mailbox server, smart host, or domain. Connectivity logging can be configured with the transport service on Mailbox servers and Edge Transport servers.\n\nRationale:\n\nIf events are not recorded, it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nImpact:\n\nAdditional storage space will be required for the log file.\n\nNote: The default file size for the protocol log is 10MB and is stored for a maximum of 30 days. This may need to be adjusted to adhere to company retention policies.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-TransportService 'EXCHANGE1' -ConnectivityLogEnabled $true\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Servers' on the left and click on the 'Servers' tab.\n\nDouble-click the server and go to the 'Transport logs' settings.\n\nEnsure the Enable connectivity log box is checked and click Save.\n\nDefault Value:\n\nFalse",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|6.2,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-TransportService ; $settings | Format-List Name, ConnectivityLogEnabled; If ($settings | Where {$_.ConnectivityLogEnabled -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_31": {
        "description": "4.4 Ensure 'Send connector: Configure protocol logging' is set to 'Verbose'",
        "info": "A protocol log is a record of the SMTP activity between messaging servers as part of message delivery. This SMTP activity occurs on Send connectors and Receive connectors that are configured with the transport service on Mailbox servers and Edge Transport servers.\n\nRationale:\n\nIf events are not recorded, it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nImpact:\n\nAdditional storage space will be required for the log file.\n\nNote: The default file size for the protocol log is 10MB and is stored for a maximum of 30 days. This may need to be adjusted to adhere to company retention policies.\n\nWarning: Do not enable Protocol logging on an Edge Transport server that has been subscribed to the Exchange organization by using EdgeSync. Those changes need to be made in the Transport service on the Mailbox server. The changes are then replicated to the Edge Transport server the next time EdgeSync synchronization occurs.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-SendConnector 'IDENTITY' -ProtocolLoggingLevel Verbose\n\nOR\n\nPerform the following actions:\n\nLaunch the EAC (Exchange Administrative Center).\n\nGo to 'Mail Flow' on the left and click on the 'Send Connectors' tab.\n\nDouble-click on the send connector to be modified.\n\nChange the Protocol logging level to Verbose and click Save.\n\nDefault Value:\n\nNone",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-3,800-53|AU-3(1),800-53|AU-7,800-53|AU-12,800-53r5|AU-3,800-53r5|AU-3(1),800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|8.1.4.3(b),CSCv7|6.3,CSCv8|8.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-3,ITSG-33|AU-3(1),ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.2.1|10.1,PCI-DSSv3.2.1|10.3,PCI-DSSv3.2.1|10.3.1,PCI-DSSv3.2.1|10.3.2,PCI-DSSv3.2.1|10.3.3,PCI-DSSv3.2.1|10.3.4,PCI-DSSv3.2.1|10.3.5,PCI-DSSv3.2.1|10.3.6,PCI-DSSv4.0|10.2.2,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-SendConnector ; $settings | Format-List Name, ProtocolLogginglevel; If ($settings | Where {$_.ProtocolLogginglevel -ne 'Verbose'}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    },
    "custom_item_32": {
        "description": "4.5 Ensure 'Message tracking logging' is set to 'True'",
        "info": "A message tracking log provides a detailed log of all message activity as messages are transferred to and from a computer running Exchange. The message tracking log can be configured with the transport service on Mailbox servers and Edge Transport servers.\n\nRationale:\n\nIf events are not recorded it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nImpact:\n\nNone - This is the default behavior.",
        "solution": "To implement the recommended state, execute the following PowerShell cmdlet:\n\nSet-TransportService 'EXCHANGE1' -MessageTrackingLogEnabled $true\n\nDefault Value:\n\nTrue",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-53|AU-2,800-53|AU-7,800-53|AU-12,800-53r5|AU-2,800-53r5|AU-7,800-53r5|AU-12,CN-L3|7.1.2.3(c),CN-L3|8.1.4.3(a),CSCv7|8.6,CSCv8|8.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-2,ITSG-33|AU-7,ITSG-33|AU-12,LEVEL|1A,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM7,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/12442",
        "value_data": "All policies compliant",
        "powershell_args": "$settings = Get-TransportService ; $settings | Format-List Name, MessageTrackingLogEnabled; If ($settings | Where {$_.MessageTrackingLogEnabled -ne $true}) { 'Non compliant policies found' } Else { 'All policies compliant' }",
        "secure_string": "@SECURE_STRING@"
    }
}