{
    "custom_item_1": {
        "description": "Microsoft SharePoint Server 2016 is installed",
        "value_data": "@PLATFORM_VERSION@",
        "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Office16.OSERVER",
        "reg_item": "DisplayName"
    },
    "custom_item_2": {
        "description": "1.1 Ensure access to SharePointEmailws.asmx is limited to only the server farm account",
        "info": "Restrict access to the Microsoft SharePoint Directory Management Service by securing the file associated with this service, which is SharePointEmailws.asmx. Only the SharePoint server farm account requires access.\nRationale:\nSharePoint 2016 includes an internal service, the Microsoft SharePoint Directory Management Service, for creating e-mail distribution groups. When you configure e-mail integration, you have the option to enable the Directory Management Service feature, which lets users create distribution lists. When users create a SharePoint group and they select the option to create a distribution list, the Microsoft SharePoint Directory Management Service creates the corresponding Active Directory dist ribution list in the Active Directory environment. Creating distribution lists in Active Directory should be limited to only this account.",
        "solution": "Navigate to the directory %CommonProgramFiles%\\Microsoft Shared\\Web Server Extensions\\16\\ISAPI\n1. Find the SharePointEmailws.asmx file used by the Microsoft SharePoint Directory Management Service in the following\n2. Right-click on the File and view the Properties.\n3. On the Security tab verify that only the WSS_RESTRICTED_WPG has access to modify the file.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|5.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1M,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "SharePointEmailws",
        "file": "%COMMONPROGRAMFILES%\\Microsoft Shared\\web server extensions\\16\\ISAPI\\SharePointEmailws.asmx"
    },
    "custom_item_3": {
        "description": "1.2 Ensure that the SharePoint Central Administration Site is TLS-enabled - HTTPS",
        "info": "Transport Layer Security (TLS) provides protection when communicating over the internet. Traffic is encrypted for portions of information transportation. Ensure that the Central Administration site is configured to be used with TLS.\nRationale:\nThe SharePoint Central Administration site allows an administrator to manage settings for the Web server and virtual servers. TLS protects this critical data by encrypting the traffic that is transmitted over the network.",
        "solution": "An SSL certificate must be acquired before enabling TLS. For more information about SSL certificates, see related topics in IIS Help.\nThe Central Administration site must also be first configured to use port 443 and HTTPS. To configure this, execute the following Windows PowerShell command:\nSet-SPCentralAdministration -Port-SecureSocketsLayer\nNOTE: If the server certificate is for an FQDN update the AAM URL of the Central Administration web site:\nSet-SPAlternateUrl -Identity https://servername:443 -Url https://fully.qualified.domain.name:443 -Zone Default\nNavigate to Internet Information Services (IIS) Manager.\n1. Locate the SharePoint Central Administration v4 from the Sites category and verify that it is configured with an HTTPS binding.\n2. Locate the SharePoint Central Administration v4 from the Sites category.\n3. Double click on the Actions pane, in the Edit Site section.\n4. Click the Bindings link.\n5. In the Site Bindings dialog, select the HTTPS binding and click Edit.\n6. In the Edit Site Binding dialog, ensure that the Port, Hostname and SSL Certificate settings fields accordingly.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSCv6|14.2,CSCv6|14.4,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "https",
        "powershell_args": "Get-WebBinding -name 'SharePoint Central Administration v4' -protocol https | Format-List"
    },
    "custom_item_4": {
        "description": "1.2 Ensure that the SharePoint Central Administration Site is TLS-enabled - Port 443",
        "info": "Transport Layer Security (TLS) provides protection when communicating over the internet. Traffic is encrypted for portions of information transportation. Ensure that the Central Administration site is configured to be used with TLS.\nRationale:\nThe SharePoint Central Administration site allows an administrator to manage settings for the Web server and virtual servers. TLS protects this critical data by encrypting the traffic that is transmitted over the network.",
        "solution": "An SSL certificate must be acquired before enabling TLS. For more information about SSL certificates, see related topics in IIS Help.\nThe Central Administration site must also be first configured to use port 443 and HTTPS. To configure this, execute the following Windows PowerShell command:\nSet-SPCentralAdministration -Port-SecureSocketsLayer\nNOTE: If the server certificate is for an FQDN update the AAM URL of the Central Administration web site:\nSet-SPAlternateUrl -Identity https://servername:443 -Url https://fully.qualified.domain.name:443 -Zone Default\nNavigate to Internet Information Services (IIS) Manager.\n1. Locate the SharePoint Central Administration v4 from the Sites category and verify that it is configured with an HTTPS binding.\n2. Locate the SharePoint Central Administration v4 from the Sites category.\n3. Double click on the Actions pane, in the Edit Site section.\n4. Click the Bindings link.\n5. In the Site Bindings dialog, select the HTTPS binding and click Edit.\n6. In the Edit Site Binding dialog, ensure that the Port, Hostname and SSL Certificate settings fields accordingly.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSCv6|14.2,CSCv6|14.4,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": ":443:",
        "powershell_args": "Get-WebBinding -name 'SharePoint Central Administration v4' -protocol https | Format-List"
    },
    "custom_item_5": {
        "description": "7.4 Ensure the SharePoint CallStack and AllowPageLevelTrace 'SafeMode' parameters are set to false - AllowPageLevelTrace",
        "info": "The CallStack and PageLevelTrace parameters are used when debugging a problem and displays detailed additional information.\nRationale:\nThe detailed additional information provided by the CallStack and PageLevelTrace parameters can be used by a malicious actor to gain sensitive information about the system parameters and application.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Locate the Web.configfile in your application root directory and edit it.\nEdit the following SafeMode entry in the Web.config file:\n1. Edit parameter CallStack='false'.\n2. Edit parameter AllowPageLevelTrace='false'.\n3. Close the Web.config file and save it.\nImpact:\nSystem sensitive information can be compromised.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,CSCv6|18.5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string AllowPageLevelTrace); foreach-object { if(!$output){ $result='AllowPageLevelTrace not found in any web.config files' } else { $result=$output }; $result };",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1",
        "CHECK_REGEXdescription": "2.7 Ensure a separate organizational unit (OU) in Active Directory exists for SharePoint 2016 objects.",
        "MEDIUMdescription": "5.2 Ensure that remote sessions for accessing security functions and security-relevant information are audited",
        "CAN_BE_NULLdescription": "3.9 Ensure that SharePoint application servers are protected by a reverse proxy"
    },
    "custom_item_6": {
        "description": "1.4 Ensure that the underlying Internet Information Services (IIS) Authentication module is set to use Kerberos as its Auth Provider",
        "info": "The Kerberos protocol is a more secure protocol than NTLM and is based on ticketing. In this scheme, a user provides a valid user name and password to an authentication server. Then, the authentication server grants the user a ticket. The ticket can be used on the network to request network resources.\nRationale:\nThe NTLM protocol has a number of vulnerabilities where a malicious attacker can use a pass the hash attack to gain access to user credentials. The Kerberos protocol is a more secure protocol based on a ticketing system and is recommended.",
        "solution": "Navigate to the Inetpub\\Adminscripts folder using a Command Prompt window on the server that is running IIS\n1. Enter the command cd Drive:\\inetpub\\adminscripts in the command prompt window.\nNote In this command, Drive is the drive where Microsoft Windows is installed.\n2. Enter the command cscript adsutil.vbs get w3svc/##/root/NTAuthenticationProviders in the command prompt window.\nNote In this command, ## is the virtual server ID number. The virtual server ID number of the Default Web site in IIS is 1.\n3. Enter the command cscript adsutil.vbs set w3svc/##/root/NTAuthenticationProviders Negotiate,NTLM\nNote In this command, ## is the virtual server ID number.\n4. Enter the following command in the command prompt window iisreset to reset IIS.\nImpact:\nA malicious attacker could exploit vulnerabilities in old NTLM protocols and gain access to user and administrative credentials.\nDefault Value:\nNTLM",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSCv6|16.9,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1NS,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "powershell_args": "cscript %SystemDrive%\\inetpub\\AdminScripts\\adsutil.vbs get w3svc/@VIRTUAL_SERVER_ID@/root/NTAuthenticationProviders | Select-String NTAuthenticationProviders"
    },
    "custom_item_7": {
        "description": "2.1 Ensure 'Block File Types' is configured to match the enterprise blacklist",
        "info": "A common tactic of malware is to identify the type of malicious code protection software running on the system and deactivate it. Malicious code includes viruses, worms, Trojan horses, and Spyware.\nRationale:\nMalicious code protection software must be protected to prevent a non-privileged user or malicious piece of software from disabling the protection mechanism.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Navigate to Central Administration.\n1. Click Security, and then click Define blocked file type.\n2. To change the web application, click the link next to Web Application: and then click Change Web Application.\n3. In the Select Web Application dialog, click an app.\n4. On the Blocked File Types page to add a file to block, type a file extension (with the period), one per line.\n5. Add all file types listed in the enterprise blacklist.\n6. Repeat check for each web application.",
        "reference": "800-171|3.13.13,800-53|SC-18(3),800-53r5|SC-18(3),CSCv6|8,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18(3),LEVEL|1A,NIAv2|NS26f,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_8": {
        "description": "2.2 Ensure the SharePoint farm service account (database access account) is configured with the minimum privileges for the local server.",
        "info": "The SharePoint farm service account (database access account) must be configured with the minimum privileges for the local server.\nRationale:\nSeparation of duties is a prevalent Information Technology control implemented at different layers of the information system including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires the person accountable for approving an action not be the same person who is tasked with implementing the action.\nThis requirement is intended to limit exposure due to user accounts being used to operate from within a privileged account or role. Limiting the access and permissions of privileged accounts to the minimum required, reduces exposure if the account is compromised and provides forensic history of activity when operating from these accounts.\nThis policy limits the Farm Account privileges in AD. However, default permissions for this account are configured by the SharePoint Products Configuration Wizard during product installation. This account is referred to during the installation as the Database Access account. By default, the account is used as the service account for the SharePoint Timer Service and the SharePoint Central Administration Web Site Application Pool. These settings should not be changed. Furthermore, this account should not be used as the service account for non-privileged services, applications, or application pools.",
        "solution": "1. On the server(s) where the SharePoint software is installed, navigate to Server Manager > Local Users and Groups.\n2. Select the Member of tab and ensure this account is only a member of the WSS_RESTRICTED_WPG, WSS_ADMIN_WPG, and WSS_WPG groups.\n3. Select the other tabs in this area to ensure there are no other services or permissions are configured for this account.",
        "reference": "800-171|3.1.1,800-53|AC-2c.,800-53r5|AC-2c.,CN-L3|7.1.3.2(d),CSCv6|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2c.,LEVEL|1A,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSSv3.2.1|1.1.5,PCI-DSSv3.2.1|7.1.1,PCI-DSSv3.2.1|7.1.3,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,QCSC-v1|15.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_9": {
        "description": "2.3 Ensure the SharePoint setup account is configured with the minimum privileges in Active Directory.",
        "info": "The SharePoint setup account must be configured with the minimum privileges in Active Directory.\nRationale:\nSeparation of duties is a prevalent Information Technology control implemented at different layers of the information system including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires the person accountable for approving an action not be the same person who is tasked with implementing the action.\nThis requirement is intended to limit exposure due to user accounts being used to operate from within a privileged account or role. Limiting the access and permissions of privileged accounts to the minimum required, reduces exposure if the account is compromised and provides forensic history of activity when operating from these accounts.\nThis policy limits the setup account privileges in AD. However, default permissions for this account are configured by the SharePoint Products Configuration Wizard during product installation. This account is referred to during the installation as the 'Database Access' account. By default, the account is used as the service account for the SharePoint Timer Service and the SharePoint Central Administration Web Site Application Pool. These settings should not be changed. Furthermore, this account should not be used as the service account for non-privileged services, applications, or application pools.\nNOTE: The setup account does need to be a member of the local Administrators group on the SharePoint server for installation and configuration.",
        "solution": "1. Navigate to Active Directory Users and Computers > Users.\n2. Double click on the setup user account to view the account properties.\n3. Select the Members of tab and remove and group that is not Domain Users.\n4. Select the other tabs in this area to verify no other services or permissions are configured for this account.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1M,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_10": {
        "description": "2.4 Ensure SharePoint provides the ability to prohibit the transfer of unsanctioned information in accordance with security policy.",
        "info": "SharePoint must provide the ability to prohibit the transfer of unsanctioned information in accordance with security policy.\nRationale:\nThe application enforces approved authorizations for controlling the flow of information within the system and between interconnected systems in accordance with applicable policy.\nInformation flow control regulates where information is allowed to travel within an information system and between information systems (as opposed to who is allowed to access the information) and without explicit regard to subsequent accesses to that information.\nSpecific examples of flow control enforcement can be found in boundary protection devices (e.g., proxies, gateways, guards, encrypted tunnels, firewalls, and routers) employing rule sets or establishing configuration settings restricting information system services, providing a packet-filtering capability based on header information or message-filtering capability based on content (e.g., using key word searches or document characteristics).\nActions to support this requirement include, but are not limited to checking all transferred information for malware, implementing dirty word list searches on transferred information, and applying the same protection measures to metadata (e.g., security attributes) that is applied to the information payload.",
        "solution": "An IRM must be enabled in SharePoint. The Windows Rights Management Services (RMS) (or a comparable IRM product) can either be located through Active Directory or specified.",
        "reference": "800-53|SC-16,800-53r5|SC-16,CSCv6|14,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-16,ITSG-33|SC-16a.,LEVEL|1M,NESA|T1.3.2,NESA|T1.3.3,NESA|T4.2.1,QCSC-v1|3.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "IrmRMSEnabled[\\s]*:[\\s]*True",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_11": {
        "description": "2.8 Ensure the SharePoint Central Administration site is not accessible from Extranet or Internet connections",
        "info": "The SharePoint central administration site should be configured so that its ports and interfaces are not accessible to untrusted external or internet connections.\nRationale:\nThe central administration site is a critical component to the management of the SharePoint platform, allowing administrators to perform a variety of administration tasks, including creating and managing SharePoint Web Applications, Site Collections and Service Applications. Minimizing unnecessary exposure to this site would certainly help mitigate risks to the SharePoint platform.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "* On the system where your SharePoint platform is installed, open a command-line window and type the following command:\ncd %CommonProgramFiles%\\Microsoft Shared\\Web Server Extensions\\16\\bin\n\n* Determine the current port number for the Central Administration Web site, by typing the following command:\n\nstsadm -o getadminport\n\n* Configure your firewall so that the SharePoint system and the identified port is not exposed to external connections.",
        "reference": "800-171|3.13.1,800-53|SC-7(11),800-53r5|SC-7(11),CN-L3|8.1.10.6(j),CSCv6|9.4,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|1A,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2.1|1.3.1,PCI-DSSv3.2.1|1.3.2,PCI-DSSv3.2.1|1.3.3,PCI-DSSv3.2.1|1.3.5,PCI-DSSv4.0|1.3.1,PCI-DSSv4.0|1.4.2,PCI-DSSv4.0|1.4.3,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_12": {
        "description": "2.10 Ensure that the SharePoint Online Web Part Gallery component is configured with limited access",
        "info": "For each SharePoint web application, the platform should be configured to prevent users from accessing the Online Web Part Gallery.\nRationale:\nWeb parts are reusable components that render sections of a SharePoint Web page. The available web parts are displayed in the Web Parts Gallery, which is a collection of web parts located on the internet. The Online Gallery could contain Web Parts from unknown third parties, which could increase the risk of a malicious code execution attack. Preventing users from accessing the Online Web Part Gallery decreases the system's attack surface.",
        "solution": "Login to Central Administration.\nNavigate to Security > Manage Web Part Security\nFor each web application in the web application section, perform the following:\n* Select the correct web application in the web application section.\n* Select the 'Prevents users from accessing the Online Web Part Gallery, and helps to\nimprove security and performance' option in the Online Web Part Gallery section.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSCv6|14,CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|1A,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_13": {
        "description": "3.1 Ensure a secondary SharePoint site collection administrator has been defined on each site collection.",
        "info": "A secondary SharePoint site collection administrator must be defined when creating a new site collection.\nRationale:\nIf a site reaches its maximum size, users will be denied access until an administrator fixes the problem. Having a secondary administrator reduces the risk of having a Denial-of-Service on a site. If the site reaches its maximum size, the secondary administrator can fix the problem if the primary administrator is not available. In some situations, having a secondary site administrator could be inappropriate for reasons of control or confidentiality.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "1. Log on to SharePoint Central Administration as a member of the Farm Administration Group.\n2. In Central Administration, click Application Management.\n3. On the Site Collection Administrators page, click the arrow next to the site collection name, and then select Change Site Collection if the site collection you want is not already selected.\n4. Select the URL of the site collection, and then click OK. If the site collection is not listed, click the arrow next to the web application name, click Change Web Application, select the name of the web application that contains the site collection, select the URL of the site collection, and then click OK.\n5. In the secondary site collection administrator area, either type the name of the user whom you want to add by using the format\\or select the user by using the address book.\n6. Click OK",
        "reference": "800-171|3.5.3,800-53|IA-2(1),800-53|SC-5,800-53r5|IA-2(1),800-53r5|SC-5,CN-L3|7.1.2.7(b),CSCv6|5,CSF|DE.CM-1,CSF|PR.AC-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1A,NESA|T3.3.1,NESA|T5.4.2,NIAv2|AM36,NIAv2|GS8e,NIAv2|GS10c,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1",
        "powershell_args": "Get-SPSite | foreach-object {$_.RootWeb.SiteAdministrators} | select @{name='Url';expr={$_.ParentWeb.Url}}, LoginName, Email|format-list"
    },
    "custom_item_14": {
        "description": "3.2 Ensure SharePoint implements an information system isolation boundary that minimizes the number of non-security functions.",
        "info": "Review the SharePoint server configuration to ensure an information system isolation boundary that minimizes the number of non-security functions included within the boundary containing security functions are implemented.\nRationale:\nThe information system isolates security functions from non-security functions by means of an isolation boundary (implemented via partitions and domains) controlling access to and protecting the integrity of, the hardware, software, and firmware that perform those security functions. The information system maintains a separate execution domain (e.g., address space) for each executing process.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "1. In the server hosting the farm's Central Administration website Open 'IIS Manager'.\n2. Expand Sites tree view and right-click the web application named SharePoint Central Administration.\n3. Select Edit Bindings ....\n4. Change the site is bound to an out-of-band (OOB) IP address.",
        "reference": "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),800-53r5|SC-7(13),CN-L3|8.1.10.6(h),CSCv6|11.7,CSF|PR.AC-5,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|1NS,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "Import-Module Webadministration; Get-ChildItem -Path 'IIS:\\Sites'"
    },
    "custom_item_15": {
        "description": "3.4 Ensure SharePoint identifies data type, specification, and usage when transferring information between different security domains.",
        "info": "SharePoint must identify data type, specification, and usage when transferring information between different security domains so policy restrictions may be applied.\nRationale:\nInformation flow control regulates where information is allowed to travel within an information system and between information systems (as opposed to who is allowed to access the information) and without explicit regard to subsequent accesses to that information.\nFlow control is based on the characteristics of the information and/or the information path. Applications providing flow control must identify data type, specification, and usage when transferring information between different security domains so policy restrictions may be applied.\nA security domain is defined as a domain implementing a security policy and administered by a single authority.\nData type, specification, and usage includes using file naming to reflect the type of data being transferred and limiting data transfer based on file type.",
        "solution": "1. In Central Administration, click on Security.\n2. On the Security page, in the Information policy list, click Configure information rights management.\n3. Ensure Do not use IRM on this server is not selected.",
        "reference": "800-53|SC-16,800-53r5|SC-16,CSCv6|14,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-16,ITSG-33|SC-16a.,LEVEL|1NS,NESA|T1.3.2,NESA|T1.3.3,NESA|T4.2.1,QCSC-v1|3.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "IrmRMSEnabled[\\s]*:[\\s]*True",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_16": {
        "description": "3.5 Ensure that SharePoint specific malware (i.e. anti-virus) protection software is integrated and configured - Scan on upload",
        "info": "SharePoint-specific malware (i.e. anti-virus) protection software must be integrated and configured.\nRationale:\nConfiguring anti-virus settings ensures documents will be scanned for viruses upon download from and upload to the SharePoint server. Anti-virus settings are not configured by default, therefore leaving the documents downloaded from or uploaded to SharePoint open to potential malware.",
        "solution": "1. Log on to the Central Administration website.\n2. Navigate to Operations > Security Configuration.\n3. Select Anti-virus.\n4. SharePoint specific malware (i.e. anti-virus) protection software must be integrated and configured for each of the following:\no Scan documents on upload.\no Scan documents on download.\no Attempt to clean infected documents.",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3a.,800-53r5|SI-3a.,CN-L3|7.1.3.6(a),CSCv6|8.1,CSCv6|8.6,CSF|DE.CM-4,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3a.,ITSG-33|SI-3a.a.,ITSG-33|SI-3a.b.,LEVEL|1A,NESA|T3.4.1,NIAv2|GS10b,NIAv2|IE11,NIAv2|SU7,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_17": {
        "description": "3.5 Ensure that SharePoint specific malware (i.e. anti-virus) protection software is integrated and configured - Scan on download",
        "info": "SharePoint-specific malware (i.e. anti-virus) protection software must be integrated and configured.\nRationale:\nConfiguring anti-virus settings ensures documents will be scanned for viruses upon download from and upload to the SharePoint server. Anti-virus settings are not configured by default, therefore leaving the documents downloaded from or uploaded to SharePoint open to potential malware.",
        "solution": "1. Log on to the Central Administration website.\n2. Navigate to Operations > Security Configuration.\n3. Select Anti-virus.\n4. SharePoint specific malware (i.e. anti-virus) protection software must be integrated and configured for each of the following:\no Scan documents on upload.\no Scan documents on download.\no Attempt to clean infected documents.",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3a.,800-53r5|SI-3a.,CN-L3|7.1.3.6(a),CSCv6|8.1,CSCv6|8.6,CSF|DE.CM-4,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3a.,ITSG-33|SI-3a.a.,ITSG-33|SI-3a.b.,LEVEL|1A,NESA|T3.4.1,NIAv2|GS10b,NIAv2|IE11,NIAv2|SU7,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_18": {
        "description": "3.5 Ensure that SharePoint specific malware (i.e. anti-virus) protection software is integrated and configured - Attempt to clean",
        "info": "SharePoint-specific malware (i.e. anti-virus) protection software must be integrated and configured.\nRationale:\nConfiguring anti-virus settings ensures documents will be scanned for viruses upon download from and upload to the SharePoint server. Anti-virus settings are not configured by default, therefore leaving the documents downloaded from or uploaded to SharePoint open to potential malware.",
        "solution": "1. Log on to the Central Administration website.\n2. Navigate to Operations > Security Configuration.\n3. Select Anti-virus.\n4. SharePoint specific malware (i.e. anti-virus) protection software must be integrated and configured for each of the following:\no Scan documents on upload.\no Scan documents on download.\no Attempt to clean infected documents.",
        "reference": "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3a.,800-53r5|SI-3a.,CN-L3|7.1.3.6(a),CSCv6|8.1,CSCv6|8.6,CSF|DE.CM-4,CSF|DE.DP-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3a.,ITSG-33|SI-3a.a.,ITSG-33|SI-3a.b.,LEVEL|1A,NESA|T3.4.1,NIAv2|GS10b,NIAv2|IE11,NIAv2|SU7,PCI-DSSv3.2.1|5.1,PCI-DSSv3.2.1|5.1.1,PCI-DSSv4.0|5.2.1,QCSC-v1|3.2,QCSC-v1|5.2.3,QCSC-v1|8.2.1,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_19": {
        "description": "3.6 Ensure that SharePoint is configured with 'Strict' browser file handling settings",
        "info": "SharePoint must prevent the execution of prohibited mobile code.\nRationale:\nDecisions regarding the utilization of mobile code within organizational information systems need to include evaluations that help determine the potential for the code to cause damage to the system if used maliciously.\nMobile code technologies include, for example, Java, JavaScript, ActiveX, PDF, Postscript, Shockwave movies, Flash animations, and VBScript. Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed on organizational servers and mobile code downloaded and executed on individual workstations.\nApplications can prevent the execution of prohibited mobile code by leveraging architectures that provide a virtual execution environment sometimes referred to as a 'sandbox'. The mobile code is executed within this isolated environment apart from the host's indigenous operating environment that allows for mobile code capability restrictions and helps to prevent malicious code from accessing system resources and data.\nThe application must prevent the execution of prohibited mobile code.",
        "solution": "1. Navigate to Central Administration website.\n2. Click Manage Web Applications.\n3. For each Web Application in the Farm:\n* Click on the Web Application to configure.\n* Click on the drop-down box below General Settings.\n* Click on General Settings in the drop down box.\n* Under Browser File Handling, select Strict.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|2,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_20": {
        "description": "3.7 Ensure that SharePoint is set to reject or delay network traffic generated above traffic volume thresholds - maxConnections",
        "info": "SharePoint must reject or delay, as defined by the organization, network traffic generated above configurable traffic volume thresholds.\nRationale:\nIt is critical when a system is at risk of failing to process audit logs as required; actions are automatically taken to mitigate the failure or risk of failure.\nOne method used to thwart the auditing system is for an attacker to attempt to overwhelm the auditing system with large amounts of irrelevant data. Consequently, either audit logs are being overwritten or disk space is being exhausted. In such cases, activity is either being erased from the logs or not recorded at all due to the lack of disk space.\nIn many system configurations, the disk space allocated to the auditing system is separate from the disks allocated for the operating system; therefore, this may not result in a system outage.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Access the Internet Information Service Manager on the appropriate SharePoint server.\n1. For each site IIS site subject to user traffic, select the site.\n2. Click Advanced Settings.\n3. Expand Connection Limits.\n4. Ensure the following settings possess a value:\n* Connection Time-Out\n* Maximum Bandwidth\n* Maximum Concurrent Connections\n5. Repeat steps for each site subject to user traffic.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSCv6|9,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1NS,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/2031"
    },
    "custom_item_21": {
        "description": "3.7 Ensure that SharePoint is set to reject or delay network traffic generated above traffic volume thresholds - connectionTimeout",
        "info": "SharePoint must reject or delay, as defined by the organization, network traffic generated above configurable traffic volume thresholds.\nRationale:\nIt is critical when a system is at risk of failing to process audit logs as required; actions are automatically taken to mitigate the failure or risk of failure.\nOne method used to thwart the auditing system is for an attacker to attempt to overwhelm the auditing system with large amounts of irrelevant data. Consequently, either audit logs are being overwritten or disk space is being exhausted. In such cases, activity is either being erased from the logs or not recorded at all due to the lack of disk space.\nIn many system configurations, the disk space allocated to the auditing system is separate from the disks allocated for the operating system; therefore, this may not result in a system outage.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Access the Internet Information Service Manager on the appropriate SharePoint server.\n1. For each site IIS site subject to user traffic, select the site.\n2. Click Advanced Settings.\n3. Expand Connection Limits.\n4. Ensure the following settings possess a value:\n* Connection Time-Out\n* Maximum Bandwidth\n* Maximum Concurrent Connections\n5. Repeat steps for each site subject to user traffic.",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|9,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,LEVEL|1NS,NIAv2|NS49",
        "see_also": "https://workbench.cisecurity.org/files/2031"
    },
    "custom_item_22": {
        "description": "3.7 Ensure that SharePoint is set to reject or delay network traffic generated above traffic volume thresholds - maxBandwidth",
        "info": "SharePoint must reject or delay, as defined by the organization, network traffic generated above configurable traffic volume thresholds.\nRationale:\nIt is critical when a system is at risk of failing to process audit logs as required; actions are automatically taken to mitigate the failure or risk of failure.\nOne method used to thwart the auditing system is for an attacker to attempt to overwhelm the auditing system with large amounts of irrelevant data. Consequently, either audit logs are being overwritten or disk space is being exhausted. In such cases, activity is either being erased from the logs or not recorded at all due to the lack of disk space.\nIn many system configurations, the disk space allocated to the auditing system is separate from the disks allocated for the operating system; therefore, this may not result in a system outage.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Access the Internet Information Service Manager on the appropriate SharePoint server.\n1. For each site IIS site subject to user traffic, select the site.\n2. Click Advanced Settings.\n3. Expand Connection Limits.\n4. Ensure the following settings possess a value:\n* Connection Time-Out\n* Maximum Bandwidth\n* Maximum Concurrent Connections\n5. Repeat steps for each site subject to user traffic.",
        "reference": "800-53|SC-5,800-53r5|SC-5,CSCv6|9,CSF|DE.CM-1,CSF|PR.DS-4,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-5,ITSG-33|SC-5a.,LEVEL|1NS,NESA|T3.3.1,NIAv2|GS8e,NIAv2|GS10c,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/2031"
    },
    "custom_item_23": {
        "description": "3.8 Ensure that On-Premise SharePoint servers is configured without OneDrive redirection linkages.",
        "info": "Disable OneDrive Redirection for On-Premise SharePoint servers\nRationale:\nOneDrive Redirection allows users and organizations to redirect their SharePoint sites to the cloud which may potentially increase the risk exposure to any sensitive information.",
        "solution": "1. Navigate to the Central Administration Menu in SharePoint.\n2. Click on Configure OneDrive and Site links.\n3. Remove any URLs in the My Site URL field.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|13,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_24": {
        "description": "4.1 Ensure SharePoint displays an approved system use notification message or banner before granting access to the system.",
        "info": "SharePoint web applications must display an approved system use notification message or banner before granting access.\nRationale:\nApplications are required to display an approved system use notification message or banner before granting access to the system providing privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure all SharePoint web applications to display the authorized warning banner text at session start. There are many ways to ensure that a warning banner text is shown to the user when using the web application. The following is only one such method of doing so.\nFor each existing SharePoint site or web application:\n1. Verify that a global.asax file exists in each SharePoint web application root directory.\n2. Create a back-up on the global.asax file in a safe location.\n3. Create a banner page resource file within the web application directories, created to display the authorized warning banner text and redirects the user back to the web application afterwards.\n4. Modify the web application global.asax file to add a Session_Start method that redirects the user to the banner page resource created from step 3.\n\nThe created banner page resource should successfully display the banner upon the start of a new session and redirect the user to the web application afterwards.",
        "reference": "800-171|3.1.9,800-53|AC-8a.,800-53r5|AC-8a.,CSCv6|16,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|AC-8a.,LEVEL|1A,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include global.asax | select-string Session_Start); foreach-object { if(!$output){ $result='Session_Start not found in any global.asax files' } else { $result=$output }; $result };"
    },
    "custom_item_25": {
        "description": "4.2 Ensure claims-based authentication is used for all web applications and zones of a SharePoint 2016 farm",
        "info": "Claims-based authentication enables systems and applications to authenticate a user without requiring the user to disclose more personal information than necessary. SharePoint continues to offer support for both claims and classic authentication modes. Claims-based identity is an identity model in SharePoint that includes features such as authentication across users of Windows-based systems and systems that are not Windows-based, multiple authentication types, stronger real-time authentication, a wider set of principal types, and delegation of user identity between applications.\nWhen a user signs in to SharePoint, the user's token is validated and then used to sign in to SharePoint. The user's token is a security token issued by a claims provider. When you build claims-aware applications, the user presents an identity to the application as a set of claims. One claim could be the user's name, another might be an email address. The external identity system is configured to give your application all the information that it needs about the user with each request, along with cryptographic assurance that the identity data received by the application comes from a trusted source.\nRationale:\nClaims-based identity allows you to factor out the authentication logic from individual applications. Instead of the application determining who the user is, it receives claims that identify the user.\nIn software, this bundle of claims is called a security token. Each security token is signed by the issuer who created it. A claims-based application considers users to be authenticated if they present a valid, signed security token from a trusted issuer which is a lot more secure than classic authentication.",
        "solution": "1. Navigate to Central Administration website.\n2. Click on Manage web applications.\n3. Click on the site you're planning to verify Claims Based Authentication.\n4. Under Web Applications tab click on the Authentication Providers icon.\n5. Under the small window pop-up verify if the default value is set to Windows.\n6. Create a PowerShell (.ps1) file and paste the following code into it:\n$setcba = Get-SPWebApplication 'http://'\n$setcba.UseClaimsAuthentication = 1;\n$setcba.Update()\n7. Save the Code as SetClaimsBasedAuthentication.ps1 on the SharePoint server.\n8. Execute the PowerShell script from the SharePoint Management Shell using the following command ./SetClaimsBasedAuthentication.ps1\nDefault Value:\nDefault value is set to Windows.",
        "reference": "800-171|3.5.1,800-53|IA-2,800-53r5|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|16.9,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-2,ITSG-33|IA-2a.,LEVEL|1A,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "True",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_26": {
        "description": "4.3 Ensure Windows Authentication uses Kerberos and not the NT Lan Manager (NTLM) authentication protocol",
        "info": "If Windows Authentication mechanisms are used on SharePoint, the system should be configured to use the Kerberos authentication protocol rather than the NT Lan Manager (NTLM) equivalent.\nRationale:\nThere are a few factors in which Kerberos is superior to NTLM authentication and is indeed preferred. First, Kerberos offers faster authentication because it does not require multiple servers and components to complete authentication tasks, as in the case of NTLM authentication. Second, Kerberos offers mutual authentication. Kerberos can authenticate the client to the server and importantly, also the server to the client.",
        "solution": "1. Launch Central Administration.\n2. Click on Application Management then Manage web applications.\n3. In Authentication Providers click each available zone.\n4. Under Authentication Providers - Zone popup check Integrated Windows authentication\nand select Negotiate (Kerberos).",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSCv6|16.9,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "False",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_27": {
        "description": "4.4 Ensure Anonymous authentication is denied",
        "info": "SharePoint web applications should be configured to disallow anonymous authentication, which would allow users to authenticate and use the applications without confirming their identity.\nRationale:\nAllowing anonymous authentication to SharePoint web applications will nullify the effectiveness of the authentication control. Furthermore, any activity performed in the anonymous session would also not be linkable to a particular account. Such linkages are often critical in post-incident investigations and audits.",
        "solution": "1. Navigate to Central Administration website.\n2. Click on Manage web applications.\n3. Click the web application name.\n4. Click the Authentication Providers button in the Web Applications ribbon.\n5. Click each Zone, and uncheck Enable anonymous access.\n6. Repeat for each web application.",
        "reference": "800-171|3.1.1,800-53|AC-3,800-53r5|AC-3,CN-L3|8.1.4.2(f),CN-L3|8.1.4.11(b),CN-L3|8.1.10.2(c),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSCv6|16,CSF|PR.AC-4,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,LEVEL|1M,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|31.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "False",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_28": {
        "description": "5.1 Ensure that auditable events and diagnostic tracking settings within SharePoint is consistent with the organization's security plans",
        "info": "SharePoint must allow designated organizational personnel to select which auditable events are to be audited by specific components of the system.\nRationale:\nAudit records can be generated from various components within the information system, such as network interfaces, hard disks, modems, etc. From an application perspective, certain specific application functionalities may be audited as well.\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records (i.e., auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked).\nOrganizations may define the organizational personnel accountable for determining which application components shall provide auditable events.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Navigate to Central Administration.\n1. Click Monitoring.\n2. Click Configure Diagnostic Logging.\n\nConfigure the event categories and trace levels to match those defined by the organization's system security plan.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-53|AU-12c.,800-53r5|AU-12c.,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12c.,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2.1|10.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_29": {
        "description": "6.2 Ensure SharePoint is configured with HTTPS connections",
        "info": "By default, communication between Web servers and service applications within a farm takes place by using HTTP with a binding to TCP 32843. Configurations should be changed to enable SSL/TLS based HTTPS connections with a binding to TCP port 32844 instead.\nRationale:\nForcing communication over HTTPS TCP 32844 hardens the communication between service applications will help to secure the communications against potential compromise\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "On the Service Applications page in Central Administration, select the service application, and then click Publish.",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSCv6|9,CSCv6|14.2,CSCv6|14.4,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|1A,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_30": {
        "description": "6.3 Ensure that SharePoint user sessions are terminated upon user logoff and when the idle time limit is exceeded",
        "info": "The SharePoint platform should be configured with a user session idle time limit of 15 minutes.\nRationale:\nWhenever a SharePoint user sessions is started, a unique session ID and other session information are generated. Such information can be used be a malicious user to hijack the session. By terminating sessions upon user logoff and idle time limit, the underlying session information is invalidated. Therefore, the potential for the session to be hijacked is removed.",
        "solution": "Review the SharePoint server configuration to ensure user sessions are terminated upon user logoff, and when idle time limit is exceeded.\nNavigate to Central Administration website.\nClick Application Management.\nClick Manage Web Applications.\nRepeat the following steps for each web application:\n* Select the Web Application.\n* Click General Settings in the Web Application ribbon.\n* In the Web Page Security Validation section, verify that Security Validation is: is set to On and that the Security Validation Expires: setting is set to 15 minutes",
        "reference": "800-171|3.1.11,800-53|AC-12,800-53r5|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|3.1,CSCv6|5.1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,LEVEL|1M,NIAv2|NS49",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "",
        "powershell_console_file": "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\16\\Config\\Powershell\\Registration\\Psconsole.Psc1"
    },
    "custom_item_31": {
        "description": "7.1 Ensure that the MaxZoneParts setting for Web Part limits is set to 100.",
        "info": "Limit the number of web parts in SharePoint to 100.\nRationale:\nA user can create too many personal views. With personal views, SharePoint actually adds each view as a web part on the page. If a user has 10 personal views, there are actually 10 web parts on the page. 9 of those web parts are hidden depending on the personal view selected. When SharePoint reaches the default maximum of 50 web parts on the page, it will throw an error.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Navigate to the IIS Manager on the Web Front End (WFE) servers\n1. Click on the Sites folder.\n2. Highlight the site (web application).\n3. On the right-hand navigation bar, Click on Explore.\n4. Open the web.config file with Notepad.\n5. Find the following phrase:.\n6. Change the value for MaxZoneParts from 50 to 100.\n7. Save the file.\n8. Open a command prompt as Administrator and type in iisreset to restart IIS.\n9. Repeat for the remaining Web Front End servers.\nImpact:\nSharePoint will throw errors if the number of web parts is not limited.\nDefault Value:\n50 web parts per page",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|18,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|1A,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string MaxZoneParts); foreach-object { if(!$output){ $result='MaxZoneParts not found in any web.config files' } else { $result=$output }; $result };"
    },
    "custom_item_32": {
        "description": "7.2 Ensure that the SafeControls list is set to the minimum set of controls needed for your sites",
        "info": "The Safe Controls list contains the names of controls and Web Parts, specific to your SharePoint site, that server administrators can designate as safe for use on any .aspx page within a site. This list is part of the Web.config file in your Web application root.\nRationale:\nA fundamental assumption of the Windows SharePoint Services technology is that 'untrusted users' can upload and create ASPX pages within the system on which Windows SharePoint Services is running. These users should be prevented from adding server-side code within ASPX pages, but there should be a list of approved controls that those untrusted users can use. One way to provide these controls is to create a Safe Controls list.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "1. Copy the.dll assembly in the project's Bin directory to the Bin directory in your Web application root directory. For example: C:\\inetpub\\wwwroot\\wss\\VirtualDirectories\\80\\.\n2. Locate the Web.config file in your application root directory and open it for editing.\n3. Add the following safe-control entry for your custom assembly to the Web.config file:is the name of the Web Part that is being deployed.is the namespace that is associated with your Web Part.\nImpact:\nMalicious users can upload and create ASPX pages.",
        "reference": "800-171|3.13.13,800-53|SC-18b.,800-53r5|SC-18b.,CSCv6|18,CSF|DE.CM-5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SC-18b.,LEVEL|1A,NIAv2|NS26a,NIAv2|NS26d,QCSC-v1|3.2,QCSC-v1|8.2.1",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string SafeControl); foreach-object { if(!$output){ $result='SafeControl not found in any web.config files' } else { $result=$output }; $result };"
    },
    "custom_item_33": {
        "description": "7.3 Ensure compilation or scripting of database pages via the PageParserPaths elements is not allowed",
        "info": "Allowing compilation or scripting of database pages via the 'PageParserPaths' elements can lead to disclosure of compilation error messages containing server info and source code exposed to the user.\n\n  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Do not allow compilation or scripting of database pages via the PageParserPaths elements in Web.Config file\nImpact:\nInformation Disclosure of server path, Operating system info and source code to the user by compilation error messages.\nDefault Value:\nBy default, the tag in application wab.config file is empty.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,CSCv6|18,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string PageParserPath); foreach-object { if(!$output){ $result='PageParserPath not found in any web.config files' } else { $result=$output }; $result };"
    },
    "custom_item_34": {
        "description": "7.4 Ensure the SharePoint CallStack and AllowPageLevelTrace 'SafeMode' parameters are set to false - CallStack",
        "info": "The CallStack and PageLevelTrace parameters are used when debugging a problem and displays detailed additional information.\nRationale:\nThe detailed additional information provided by the CallStack and PageLevelTrace parameters can be used by a malicious actor to gain sensitive information about the system parameters and application.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Locate the Web.configfile in your application root directory and edit it.\nEdit the following SafeMode entry in the Web.config file:\n1. Edit parameter CallStack='false'.\n2. Edit parameter AllowPageLevelTrace='false'.\n3. Close the Web.config file and save it.\nImpact:\nSystem sensitive information can be compromised.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,CSCv6|18.5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string CallStack); foreach-object { if(!$output){ $result='CallStack not found in any web.config files' } else { $result=$output }; $result };"
    },
    "custom_item_35": {
        "description": "7.4 Ensure the SharePoint CallStack and AllowPageLevelTrace 'SafeMode' parameters are set to false - AllowPageLevelTrace",
        "info": "The CallStack and PageLevelTrace parameters are used when debugging a problem and displays detailed additional information.\nRationale:\nThe detailed additional information provided by the CallStack and PageLevelTrace parameters can be used by a malicious actor to gain sensitive information about the system parameters and application.\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Locate the Web.configfile in your application root directory and edit it.\nEdit the following SafeMode entry in the Web.config file:\n1. Edit parameter CallStack='false'.\n2. Edit parameter AllowPageLevelTrace='false'.\n3. Close the Web.config file and save it.\nImpact:\nSystem sensitive information can be compromised.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,CSCv6|18.5,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|1A",
        "see_also": "https://workbench.cisecurity.org/files/2031",
        "value_data": "Manual Review Required",
        "powershell_args": "$output = (get-childitem -recurse @INETPUB_ROOT@ -include web.config | select-string AllowPageLevelTrace); foreach-object { if(!$output){ $result='AllowPageLevelTrace not found in any web.config files' } else { $result=$output }; $result };"
    }
}