{
    "custom_item_1": {
        "description": "IIS is installed",
        "value_data": "HKLM\\Software\\Microsoft\\Inetstp"
    },
    "custom_item_2": {
        "description": "IIS Major version 7",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp",
        "reg_item": "MajorVersion"
    },
    "custom_item_3": {
        "description": "IIS Minor version 0 or 5",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp",
        "reg_item": "MinorVersion"
    },
    "custom_item_4": {
        "description": "Verify .net extensibility is installed - NetFxExtensibility",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp\\Components",
        "reg_item": "NetFxExtensibility"
    },
    "custom_item_5": {
        "description": "Verify .net extensibility is installed - ASPNET",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp\\Components",
        "reg_item": "ASPNET"
    },
    "custom_item_6": {
        "description": "2.4 Ensure 'forms authentication' is set to use cookies - Default",
        "info": "Forms Authentication can be configured to maintain the site visitor's session identifier in either a URI or cookie. It is recommended that Forms Authentication be set to use cookies.\n\nUsing cookies to manage session state may help mitigate the risk of session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL. Moving session information identifiers into the URL may cause session IDs to show up in proxy logs, browsing history, and be accessible to client scripting via document.location.",
        "solution": " 1. Open IIS Manager and navigate to the level where Forms Authentication is enabled\n 2. In Features View, double-click Authentication\n 3. On the Authentication page, select Forms Authentication\n 4. In the Actions pane, click Edit\n 5. In the Cookie settings section, select Use cookies from the Mode dropdown",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "UseCookies",
        "appcmd_args": "list config /section:system.web/authentication /text:forms.cookieless"
    },
    "custom_item_7": {
        "description": "2.4 Ensure 'forms authentication' is set to use cookies - Applications",
        "info": "Forms Authentication can be configured to maintain the site visitor's session identifier in either a URI or cookie. It is recommended that Forms Authentication be set to use cookies.\n\nUsing cookies to manage session state may help mitigate the risk of session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL. Moving session information identifiers into the URL may cause session IDs to show up in proxy logs, browsing history, and be accessible to client scripting via document.location.",
        "solution": " 1. Open IIS Manager and navigate to the level where Forms Authentication is enabled\n 2. In Features View, double-click Authentication\n 3. On the Authentication page, select Forms Authentication\n 4. In the Actions pane, click Edit\n 5. In the Cookie settings section, select Use cookies from the Mode dropdown",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "UseCookies",
        "appcmd_args": "list config {} /section:system.web/authentication /text:forms.cookieless",
        "appcmd_filter": "list config {} /section:system.web/authentication /text:mode",
        "appcmd_filter_value": "Forms",
        "appcmd_list": "list apps"
    },
    "custom_item_8": {
        "description": "2.8 Ensure 'credentials' are not stored in configuration files - Default",
        "info": "Theelement of theelement allows optional definitions of name and password for IIS Manager User accounts within the configuration file. Forms based authentication also uses these elements to define the users. IIS Manager Users can use the administration interface to connect to sites and applications in which they've been granted authorization. Note that theelement only applies when the default provider, ConfigurationAuthenticationProvider, is configured as the authentication provider. It is recommended that passwordFormat be set to a value other than Clear, such as SHA1 or MD5.\n\nAuthentication credentials should always be protected to reduce the risk of stolen authentication credentials. For security reasons, it is recommended that user credentials not be stored an any IIS configuration files.",
        "solution": "Authentication mode is configurable at the machine.config, root-level web.config, or application-level web.config:\n\n1. Locate and open the configuration file where the credentials are stored\n2. Find theelement\n3. If present, remove the section\n\nThis will remove all references to stored users in the configuration files.",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),LEVEL|2S,NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": ".*user.*",
        "appcmd_args": "list config /section:system.web/authentication"
    },
    "custom_item_9": {
        "description": "2.8 Ensure 'credentials' are not stored in configuration files - Applications",
        "info": "Theelement of theelement allows optional definitions of name and password for IIS Manager User accounts within the configuration file. Forms based authentication also uses these elements to define the users. IIS Manager Users can use the administration interface to connect to sites and applications in which they've been granted authorization. Note that theelement only applies when the default provider, ConfigurationAuthenticationProvider, is configured as the authentication provider. It is recommended that passwordFormat be set to a value other than Clear, such as SHA1 or MD5.\n\nAuthentication credentials should always be protected to reduce the risk of stolen authentication credentials. For security reasons, it is recommended that user credentials not be stored an any IIS configuration files.",
        "solution": "Authentication mode is configurable at the machine.config, root-level web.config, or application-level web.config:\n\n1. Locate and open the configuration file where the credentials are stored\n2. Find theelement\n3. If present, remove the section\n\nThis will remove all references to stored users in the configuration files.",
        "reference": "800-171|3.5.10,800-53|IA-5(1)(c),800-53r5|IA-5(1)(c),CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ITSG-33|IA-5(1)(c),LEVEL|2S,NESA|T5.2.3,NIAv2|CY6,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1,TBA-FIISB|26.1",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": ".*user.*",
        "appcmd_args": "list config /section:system.web/authentication",
        "appcmd_filter": "list config {} /section:system.web/authentication /text:mode",
        "appcmd_filter_value": "Forms",
        "appcmd_list": "list apps"
    },
    "custom_item_10": {
        "description": "Verify .net extensibility is installed - ASPNET",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp\\Components",
        "reg_item": "ASPNET"
    },
    "custom_item_11": {
        "description": "Verify .net extensibility is installed - NetFxExtensibility",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp\\Components",
        "reg_item": "NetFxExtensibility"
    },
    "custom_item_12": {
        "description": "3.2 Ensure 'debug' is turned off - Default",
        "info": "Developers often enable the debug mode during active ASP.NET development so that they do not have to continually clear their browsers cache every time they make a change to a resource handler. The problem would arise from this being left 'on' or set to 'true'. Compilation debug output is displayed to the end user, allowing malicious persons to obtain detailed information about applications.\nThis is a defense in depth recommendation due to thein the machine.config configuration file overriding any debug settings. It is recommended that debugging still be turned off.\n\nSettingto false ensures that detailed error information does not inadvertently display during live application usage, mitigating the risk of application information leakage falling into unscrupulous hands.",
        "solution": "To use the UI to make this change:\n 1. Open IIS Manager and navigate desired server, site, or application\n 2. In Features View, double-click .NET Compilation\n 3. On the .NET Compilation page, in the Behavior section, ensure the Debug field is set to False\n 4. When finished, click Apply in the Actions pane\nNote: Theswitch will not be present in the web.config file unless it has been added manually, or has previously been configured using the IIS Manager GUI.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config /section:system.web/compilation /text:debug"
    },
    "custom_item_13": {
        "description": "3.2 Ensure 'debug' is turned off - Applications",
        "info": "Developers often enable the debug mode during active ASP.NET development so that they do not have to continually clear their browsers cache every time they make a change to a resource handler. The problem would arise from this being left 'on' or set to 'true'. Compilation debug output is displayed to the end user, allowing malicious persons to obtain detailed information about applications.\nThis is a defense in depth recommendation due to thein the machine.config configuration file overriding any debug settings. It is recommended that debugging still be turned off.\n\nSettingto false ensures that detailed error information does not inadvertently display during live application usage, mitigating the risk of application information leakage falling into unscrupulous hands.",
        "solution": "To use the UI to make this change:\n 1. Open IIS Manager and navigate desired server, site, or application\n 2. In Features View, double-click .NET Compilation\n 3. On the .NET Compilation page, in the Behavior section, ensure the Debug field is set to False\n 4. When finished, click Apply in the Actions pane\nNote: Theswitch will not be present in the web.config file unless it has been added manually, or has previously been configured using the IIS Manager GUI.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config {} /section:system.web/compilation /text:debug",
        "appcmd_list": "list apps"
    },
    "custom_item_14": {
        "description": "3.3 Ensure Custom Error Messages are not Off - Default",
        "info": "When an ASP.NET application fails and causes an HTTP/1.x 500 Internal Server Error, or a feature configuration (such as Request Filtering) prevents a page from being displayed, an error message will be generated. Administrators can choose whether or not the application should display a friendly message to the client, detailed error message to the client, or detailed error message to localhost only. Thetag in the web.config has three modes:\n . On: Specifies that custom errors are enabled. If no defaultRedirect attribute is specified, users see a generic error. The custom errors are shown to the remote clients and to the local host\n . Off: Specifies that custom errors are disabled. The detailed ASP.NET errors are shown to the remote clients and to the local host\n . RemoteOnly: Specifies that custom errors are shown only to the remote clients, and that ASP.NET errors are shown to the local host. This is the default value\nThis is a defense in depth recommendation due to thein the machine.config file overriding any settings for customErrors to be turned Off. It is recommended that customErrors still be turned to On or RemoteOnly.\n\ncustomErrors can be set to On or RemoteOnly without leaking detailed application information to the client. Ensuring that customErrors is not set to Off will help mitigate the risk of malicious persons learning detailed application error and server configuration information.",
        "solution": "customErrors may be set for a server, site, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the customErrors mode to RemoteOnly or On for a Web Site in the IIS Manager GUI:\n 1. Open the IIS Manager GUI and navigate to the site to be configured\n 2. In Features View, find and double-click .NET Error Pages icon\n 3. In the Actions Pane, click Edit Feature Settings\n 4. In modal dialog, choose On or Remote Only for Mode settings\n 5. Click OK",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "RemoteOnly",
        "appcmd_args": "list config /section:system.web/customErrors /text:mode"
    },
    "custom_item_15": {
        "description": "3.3 Ensure Custom Error Messages are not Off - Applications",
        "info": "When an ASP.NET application fails and causes an HTTP/1.x 500 Internal Server Error, or a feature configuration (such as Request Filtering) prevents a page from being displayed, an error message will be generated. Administrators can choose whether or not the application should display a friendly message to the client, detailed error message to the\nclient, or detailed error message to localhost only. Thetag in the web.config has three modes:\n . On: Specifies that custom errors are enabled. If no defaultRedirect attribute is specified, users see a generic error. The custom errors are shown to the remote clients and to the local host\n . Off: Specifies that custom errors are disabled. The detailed ASP.NET errors are shown to the remote clients and to the local host\n . RemoteOnly: Specifies that custom errors are shown only to the remote clients, and that ASP.NET errors are shown to the local host. This is the default value\nThis is a defense in depth recommendation due to thein the machine.config file overriding any settings for customErrors to be turned Off. It is recommended that customErrors still be turned to On or RemoteOnly.\n\ncustomErrors can be set to On or RemoteOnly without leaking detailed application information to the client. Ensuring that customErrors is not set to Off will help mitigate the risk of malicious persons learning detailed application error and server configuration information.",
        "solution": "customErrors may be set for a server, site, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the customErrors mode to RemoteOnly or On for a Web Site in the IIS Manager GUI:\n 1. Open the IIS Manager GUI and navigate to the site to be configured\n 2. In Features View, find and double-click .NET Error Pages icon\n 3. In the Actions Pane, click Edit Feature Settings\n 4. In modal dialog, choose On or Remote Only for Mode settings\n 5. Click OK",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "RemoteOnly",
        "appcmd_args": "list config {} /section:system.web/customErrors /text:mode",
        "appcmd_list": "list apps"
    },
    "custom_item_16": {
        "description": "3.5 Ensure ASP.NET stack tracing is not enabled - Default",
        "info": "The trace element configures the ASP.NET code tracing service that controls how trace results are gathered, stored, and displayed. When tracing is enabled, each page request generates trace messages that can be appended to the page output or stored in an application trace log.\nThis is a defense in depth recommendation due to thein the machine.config file overriding any settings for ASP.NET stack tracing that are left on. It is recommended that ASP.NET stack tracing still be turned off.\n\nIn an active Web Site, tracing should not be enabled because it can display sensitive configuration and detailed stack trace information to anyone who views the pages in the site. If necessary, the localOnly attribute can be set to true to have trace information displayed only for localhost requests. Ensuring that ASP.NET stack tracing is not on will help mitigate the risk of malicious persons learning detailed stack trace information.",
        "solution": " 1) ensureis enabled in the machine.config.\n 2) Remove all attribute references to ASP.NET tracing by deleting the trace and trace enable attributes.\nPer Page:\nRemove any references to\nTrace='true'\nPer Application:......Default Value:\nThe default value for ASP.NET tracing is off.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config /section:system.web/trace /text:enabled"
    },
    "custom_item_17": {
        "description": "3.5 Ensure ASP.NET stack tracing is not enabled - Applications",
        "info": "The trace element configures the ASP.NET code tracing service that controls how trace results are gathered, stored, and displayed. When tracing is enabled, each page request generates trace messages that can be appended to the page output or stored in an application trace log.\nThis is a defense in depth recommendation due to thein the machine.config file overriding any settings for ASP.NET stack tracing that are left on. It is recommended that ASP.NET stack tracing still be turned off.\n\nIn an active Web Site, tracing should not be enabled because it can display sensitive configuration and detailed stack trace information to anyone who views the pages in the site. If necessary, the localOnly attribute can be set to true to have trace information displayed only for localhost requests. Ensuring that ASP.NET stack tracing is not on will help mitigate the risk of malicious persons learning detailed stack trace information.",
        "solution": " 1) ensureis enabled in the machine.config.\n 2) Remove all attribute references to ASP.NET tracing by deleting the trace and trace enable attributes.\nPer Page:\nRemove any references to\nTrace='true'\nPer Application:......Default Value:\nThe default value for ASP.NET tracing is off.",
        "reference": "800-53|SI-11a.,800-53r5|SI-11a.,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-11b.,LEVEL|2S",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config {} /section:system.web/trace /text:enabled",
        "appcmd_list": "list apps"
    },
    "custom_item_18": {
        "description": "3.6 Ensure 'httpcookie' mode is configured for session state - Default",
        "info": "A session cookie associates session information with client information for that session, which can be the duration of a user's connection to a site. The cookie is passed in a HTTP header together with all requests between the client and server.\nSession information can also be stored in the URL. However, storing session information in this manner has security implications that can open attack vectors such as session hijacking. An effective method used to prevent session hijacking attacks is to force web applications to use cookies to store the session token. This is accomplished by setting the cookieless attribute of the sessionState node to UseCookies or False which will in turn keep session state data out of URI. It is recommended that session state be configured to UseCookies.\n\nCookies that have been properly configured help mitigate the risk of attacks such as session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL; moving session information in URI causes session IDs to show up in proxy logs, and is accessible to client scripting via document.location.",
        "solution": "SessionState can be set to UseCookies by using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the cookieless attribute of the sessionState node to UseCookies in the IIS Manager GUI:\n 1. Open the IIS Manager GUI and navigate desired server, site, or application\n 2. In Features View, find and double-click the Session State icon\n 3. In the Cookie Settings section, choose Use Cookies from the Mode dropdown\n 4. In the Actions Pane, click Apply\nTo use AppCmd.exe to configure sessionState at the server level, the command would look like this:\n%systemroot%\\system32\\inetsrv\\appcmd set config /commit:WEBROOT /section:sessionState /cookieless:UseCookies /cookieName:ASP.NET_SessionID /timeout:20\n\nWhen Appcmd.exe is used to configure theelement at the global level in IIS, the /commit:WEBROOT switch must be included so that configuration changes are made to the root web.config file instead of ApplicationHost.config.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "UseCookies",
        "appcmd_args": "list config /section:system.web/sessionState /text:cookieless"
    },
    "custom_item_19": {
        "description": "3.6 Ensure 'httpcookie' mode is configured for session state - Applications",
        "info": "A session cookie associates session information with client information for that session, which can be the duration of a user's connection to a site. The cookie is passed in a HTTP header together with all requests between the client and server.\nSession information can also be stored in the URL. However, storing session information in this manner has security implications that can open attack vectors such as session hijacking. An effective method used to prevent session hijacking attacks is to force web applications to use cookies to store the session token. This is accomplished by setting the cookieless attribute of the sessionState node to UseCookies or False which will in turn keep session state data out of URI. It is recommended that session state be configured to UseCookies.\n\nCookies that have been properly configured help mitigate the risk of attacks such as session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL; moving session information in URI causes session IDs to show up in proxy logs, and is accessible to client scripting via document.location.",
        "solution": "SessionState can be set to UseCookies by using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the cookieless attribute of the sessionState node to UseCookies in the IIS Manager GUI:\n 1. Open the IIS Manager GUI and navigate desired server, site, or application\n 2. In Features View, find and double-click the Session State icon\n 3. In the Cookie Settings section, choose Use Cookies from the Mode dropdown\n 4. In the Actions Pane, click Apply\nTo use AppCmd.exe to configure sessionState at the server level, the command would look like this:\n%systemroot%\\system32\\inetsrv\\appcmd set config /commit:WEBROOT /section:sessionState /cookieless:UseCookies /cookieName:ASP.NET_SessionID /timeout:20\n\nWhen Appcmd.exe is used to configure theelement at the global level in IIS, the /commit:WEBROOT switch must be included so that configuration changes are made to the root web.config file instead of ApplicationHost.config.",
        "reference": "800-171|3.4.2,800-53|CM-6b.,800-53r5|CM-6b.,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-6b.,LEVEL|2S,NESA|T3.2.1,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "UseCookies",
        "appcmd_args": "list config {} /section:system.web/sessionState /text:cookieless",
        "appcmd_list": "list apps"
    },
    "custom_item_20": {
        "description": "3.7 Ensure 'cookies' are set with HttpOnly attribute - Default",
        "info": "The httpOnlyCookies attribute of the httpCookies node determines if IIS will set the HttpOnly flag on HTTP cookies it sets. The HttpOnly flag indicates to the user agent that the cookie must not be accessible by client-side script (i.e document.cookie). It is recommended that the httpOnlyCookies attribute be set to true.\n\nWhen cookies are set with the HttpOnly flag, they cannot be accessed by client side scripting running in the user's browser. Preventing client-side scripting from accessing cookie content may reduce the probability of a cross site scripting attack materializing into a successful session hijack.",
        "solution": "1. Locate and open the application's web.config file\n          2. Add thetag within:Setting the value of the httpOnlyCookies attribute of the httpCookies element to true will add the HttpOnly flag to all the cookies set by the application. All modern versions of browsers recognize HttpOnly attribute; older versions will either treat them as normal cookies or simply ignore them altogether.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "true",
        "appcmd_args": "list config /section:system.web/httpCookies /text:httpOnlyCookies"
    },
    "custom_item_21": {
        "description": "3.7 Ensure 'cookies' are set with HttpOnly attribute - Applications",
        "info": "The httpOnlyCookies attribute of the httpCookies node determines if IIS will set the HttpOnly flag on HTTP cookies it sets. The HttpOnly flag indicates to the user agent that the cookie must not be accessible by client-side script (i.e document.cookie). It is recommended that the httpOnlyCookies attribute be set to true.\n\nWhen cookies are set with the HttpOnly flag, they cannot be accessed by client side scripting running in the user's browser. Preventing client-side scripting from accessing cookie content may reduce the probability of a cross site scripting attack materializing into a successful session hijack.",
        "solution": "1. Locate and open the application's web.config file\n          2. Add thetag within:Setting the value of the httpOnlyCookies attribute of the httpCookies element to true will add the HttpOnly flag to all the cookies set by the application. All modern versions of browsers recognize HttpOnly attribute; older versions will either treat them as normal cookies or simply ignore them altogether.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "true",
        "appcmd_args": "list config {} /section:system.web/httpCookies /text:httpOnlyCookies",
        "appcmd_list": "list apps"
    },
    "custom_item_22": {
        "description": "3.11 Ensure 'encryption providers' are locked down",
        "info": "By default, whenever a property is encrypted, IIS uses the defaultProvider for encryption defined in machine.config. The IIS local system process (WAS) runs under the context of LOCALSYSTEM and needs access to the application pool passwords. However, by default the IIS_IUSRS security group is granted read access. It is recommended that the IIS_IUSRS group have access to the iisWasKey revoked.\n\nThe iisWasKey is intended for access only by Administrators and SYSTEM. Since the IIS_IUSRS group is granted read access, an attacker compromising an application set to use a principal in the IIS_IUSRS group could potentially gain access to the encryption key(s). Revoking this unnecessary privilege will reduce attack surface and help maintain confidentiality and system/application integrity.",
        "solution": "Removing access to the iisWasKey can be done by using an aspnet_regiis.exe command. The syntax is as follows, and is dependent on the version of .NET being used:\n   %systemroot%\\Microsoft.NET\\Framework\\aspnet_regiis.exe -pr iisWasKey IIS_IUSRS\nTo remove read access to the IIS_IUSRS security group on a system using .NET Framework v2.0:\n 1. Open an elevated command prompt\n 2. Run the following aspnet_regiis.exe command:\n  %systemroot%\\Microsoft.NET\\Framework\\v2.0.50727\\aspnet_regiis.exe -pr iisWasKey IIS_IUSRS\n\nIf running a 64-bit system, also run the following:\n  %systemroot%\\Microsoft.NET\\Framework64\\v2.0.50727\\aspnet_regiis.exe -pr iisWasKey IIS_IUSRS\n\nNote: A unique version of aspnet_regiis.exe is included with each version of the .NET Framework. Since each version of the tool applies only to its associated version of the .NET Framework, be sure to use the appropriate version of the tool.",
        "reference": "800-171|3.1.5,800-53|AC-6,800-53r5|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.4.2(d),CN-L3|8.1.10.6(a),CSF|PR.AC-4,CSF|PR.DS-5,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.2.1|7.1.2,PCI-DSSv4.0|7.2.1,PCI-DSSv4.0|7.2.2,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "[\\s]*BUILTIN\\\\IIS_IUSRS[\\s]*",
        "powershell_args": "Get-Acl %ALLUSERSPROFILE%\\Microsoft\\Crypto\\RSA\\MachineKeys\\76944fb33636aeddb9590521c2e8815a_* | Format-List"
    },
    "custom_item_23": {
        "description": "4.1 Ensure 'maxAllowedContentLength' is configured - Default",
        "info": "The maxAllowedContentLength Request Filter is the maximum size of the http request, measured in bytes, which can be sent from a client to the server. Configuring this value enables the total request size to be restricted to a configured value. It is recommended that the overall size of requests be restricted to a maximum value appropriate for the server, site, or application.\n\nSetting an appropriate value that has been tested for the maxAllowedContentLength filter will lower the impact an abnormally large request would otherwise have on IIS and/or web applications. This helps to ensure availability of web content and services, and may also help mitigate the risk of buffer overflow type attacks in unmanaged components.",
        "solution": "The MaxAllowedContentLength Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, click on the server, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key the maximum content length in bytes that will allow applications to retain their intended functionality, such as 30000000 (approx.\n 28.6 MB)\n\n To set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /requestLimits.maxAllowedContentLength:30000000",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2NS,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(3[0]{7}|[0-2][0-9]{7}|[0-9]{1,7})$",
        "appcmd_args": "list config /section:system.webServer/security/requestFiltering /text:requestLimits.maxAllowedContentLength"
    },
    "custom_item_24": {
        "description": "4.1 Ensure 'maxAllowedContentLength' is configured - Applications",
        "info": "The maxAllowedContentLength Request Filter is the maximum size of the http request, measured in bytes, which can be sent from a client to the server. Configuring this value enables the total request size to be restricted to a configured value. It is recommended that the overall size of requests be restricted to a maximum value appropriate for the server, site, or application.\n\nSetting an appropriate value that has been tested for the maxAllowedContentLength filter will lower the impact an abnormally large request would otherwise have on IIS and/or web applications. This helps to ensure availability of web content and services, and may also help mitigate the risk of buffer overflow type attacks in unmanaged components.",
        "solution": "The MaxAllowedContentLength Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, click on the server, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key the maximum content length in bytes that will allow applications to retain their intended functionality, such as 30000000 (approx.\n 28.6 MB)\n\n To set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /requestLimits.maxAllowedContentLength:30000000",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2NS,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(3[0]{7}|[0-2][0-9]{7}|[0-9]{1,7})$",
        "appcmd_args": "list config {} /section:system.webServer/security/requestFiltering /text:requestLimits.maxAllowedContentLength",
        "appcmd_list": "list apps"
    },
    "custom_item_25": {
        "description": "4.2 Ensure 'maxURL request filter' is configured - Default",
        "info": "The maxURL attribute of theproperty is the maximum length (in Bytes) in which a requested URL can be (excluding query string) in order for IIS to accept. Configuring this Request Filter enables administrators to restrict the length of the requests that the server will accept. It is recommended that a limit be put on the length of URL.\n\nWith a properly configured Request Filter limiting the amount of data accepted in the URL, chances of undesired application behaviors affecting the availability of content and services are reduced.",
        "solution": "The MaxURL Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, click on the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key the maximum URL length in bytes that has been tested with web applications",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(409[0-6]|40[0-8][0-9]|[0-3][0-9]{3}|[0-9]{1,3})$",
        "appcmd_args": "list config /section:system.webServer/security/requestFiltering /text:requestLimits.maxURL"
    },
    "custom_item_26": {
        "description": "4.2 Ensure 'maxURL request filter' is configured - Applications",
        "info": "The maxURL attribute of theproperty is the maximum length (in Bytes) in which a requested URL can be (excluding query string) in order for IIS to accept. Configuring this Request Filter enables administrators to restrict the length of the requests that the server will accept. It is recommended that a limit be put on the length of URL.\n\nWith a properly configured Request Filter limiting the amount of data accepted in the URL, chances of undesired application behaviors affecting the availability of content and services are reduced.\n\nNOTE: Please update MAX_URL with the appropriate value for the local environment.",
        "solution": "The MaxURL Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, click on the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key the maximum URL length in bytes that has been tested with web applications",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(409[0-6]|40[0-8][0-9]|[0-3][0-9]{3}|[0-9]{1,3})$",
        "appcmd_args": "list config {} /section:system.webServer/security/requestFiltering /text:requestLimits.maxURL",
        "appcmd_list": "list apps"
    },
    "custom_item_27": {
        "description": "4.3 Ensure 'MaxQueryString request filter' is configured - Default",
        "info": "The MaxQueryString Request Filter describes the upper limit on the length of the query string that the configured IIS server will allow for websites or applications. It is recommended that values always be established to limit the amount of data will can be accepted in the query string.\n\nWith a properly configured Request Filter limiting the amount of data accepted in the query string, chances of undesired application behaviors such as app pool failures are reduced.",
        "solution": "The MaxQueryString Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, go to the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key in a safe upper bound in the Maximum query string (Bytes) textbox\n\n To set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /requestLimits.maxQueryString:2048",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(204[0-8]|20[0-3][0-9]|[0-1][0-9]{3}|[0-9]{1,3})$",
        "appcmd_args": "list config /section:system.webServer/security/requestFiltering /text:requestLimits.maxQueryString"
    },
    "custom_item_28": {
        "description": "4.3 Ensure 'MaxQueryString request filter' is configured - Applications",
        "info": "The MaxQueryString Request Filter describes the upper limit on the length of the query string that the configured IIS server will allow for websites or applications. It is recommended that values always be established to limit the amount of data will can be accepted in the query string.\n\nWith a properly configured Request Filter limiting the amount of data accepted in the query string, chances of undesired application behaviors such as app pool failures are reduced.",
        "solution": "The MaxQueryString Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, go to the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the Request Limits section, key in a safe upper bound in the Maximum query string (Bytes) textbox\n\n To set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /requestLimits.maxQueryString:2048",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "^(204[0-8]|20[0-3][0-9]|[0-1][0-9]{3}|[0-9]{1,3})$",
        "appcmd_args": "list config {} /section:system.webServer/security/requestFiltering /text:requestLimits.maxQueryString",
        "appcmd_list": "list apps"
    },
    "custom_item_29": {
        "description": "4.4 Ensure non-ASCII characters in URLs are not allowed - Default",
        "info": "This feature is used to allow or reject all requests to IIS that contain non-ASCII characters. When using this feature, Request Filtering will deny the request if high-bit characters are present in the URL. The UrlScan equivalent is AllowHighBitCharacters. It is recommended that requests containing non-ASCII characters be rejected, where possible.\n\nThis feature can help defend against canonicalization attacks, reducing the potential attack surface of servers, sites, and/or applications.",
        "solution": "The AllowHighBitCharacters Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, go to the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the General section, uncheck Allow high-bit characters\n\nNote: Disallowing high-bit ASCII characters in the URL may negatively impact the functionality of sites requiring international language support.\n\nTo set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /allowHighBitCharacters:false",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config /section:system.webServer/security/requestFiltering /text:allowHighBitCharacters"
    },
    "custom_item_30": {
        "description": "4.4 Ensure non-ASCII characters in URLs are not allowed - Applications",
        "info": "This feature is used to allow or reject all requests to IIS that contain non-ASCII characters. When using this feature, Request Filtering will deny the request if high-bit characters are present in the URL. The UrlScan equivalent is AllowHighBitCharacters. It is recommended that requests containing non-ASCII characters be rejected, where possible.\n\nThis feature can help defend against canonicalization attacks, reducing the potential attack surface of servers, sites, and/or applications.",
        "solution": "The AllowHighBitCharacters Request Filter may be set for a server, website, or application using the IIS Manager GUI, using AppCmd.exe commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:\n 1. Open Internet Information Services (IIS) Manager\n 2. In the Connections pane, go to the connection, site, application, or directory to be configured\n 3. In the Home pane, double-click Request Filtering\n 4. Click Edit Feature Settings... in the Actions pane\n 5. Under the General section, uncheck Allow high-bit characters\n\nNote: Disallowing high-bit ASCII characters in the URL may negatively impact the functionality of sites requiring international language support.\n\nTo set this Request Filter using an AppCmd.exe command, run the following command at an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd set config /section:requestfiltering /allowHighBitCharacters:false",
        "reference": "800-53|SI-10,800-53r5|SI-10,CN-L3|8.1.4.4(d),GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|SI-10,ITSG-33|SI-10a.,LEVEL|2S,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "false",
        "appcmd_args": "list config {} /section:system.webServer/security/requestFiltering /text:allowHighBitCharacters",
        "appcmd_list": "list apps"
    },
    "custom_item_31": {
        "description": "7.1 Ensure HSTS Header is set",
        "info": "HTTP Strict Transport Security (HSTS) allows a site to inform the user agent to communicate with the site only over HTTPS. This header takes two parameters: max-age, 'specifies the number of seconds, after the reception of the STS header field, during which the user agent regards the host (from whom the message was received) as a Known HSTS Host [speaks only HTTPS]'; and includeSubDomains. includeSubDomains is an optional directive that defines how this policy is applied to subdomains. If includeSubDomains is included in the header, it provides the following definition: this HSTS Policy also applies to any hosts whose domain names are subdomains of the Known HSTS Host's domain name.  HTTP Strict Transport Security (HSTS) is a simple and widely supported standard to protect visitors by ensuring that their browsers always connect to a website over HTTPS. HSTS exists to remove the need for the common, insecure practice of redirecting users from http:// to https:// URLs. HSTS relies on the User Agent/Browser to enforce the required behavior. All major browsers support it. If the browser doesn't support HSTS, it will be ignored. When a browser knows that a domain has enabled HSTS, it does two things: 1. Always uses an https:// connection, even when clicking on an http:// link or after typing a domain into the location bar without specifying a protocol. 2. Removes the ability for users to click through warnings about invalid certificates. A domain instructs browsers that it has enabled HSTS by returning an HTTP header over an HTTPS connection.",
        "solution": "Any value greater than 0 meets this recommendation. The examples below are specific to 8 minutes but can be adjusted to meet your requirements. To set the HTTP Header at the server level using an AppCmd.exe command, run the following command from an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd.exe set config -section:system.webServer/httpProtocol /+'customHeaders.[name='Strict-Transport-Security',value='max-age=480']' To set the HTTP Header and include subdomains at the server level using an AppCmd.exe command, run the following command from an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd.exe set config -section:system.webServer/httpProtocol /+'customHeaders.[name='Strict-Transport-Security',value='max-age=480; includeSubDomains']' To set the HTTP Header at the Website level using an AppCmd.exe command, run the following command from an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd.exe set config -section:system.webServer/httpProtocol /+'customHeaders.[name='Strict-Transport-Security',value='max-age=480']' To set the HTTP Header and include subdomains at the Website level using an AppCmd.exe command, run the following command from an elevated command prompt: %systemroot%\\system32\\inetsrv\\appcmd.exe set config 'Website' -section:system.webServer/httpProtocol /+'customHeaders.[name='Strict-Transport-Security',value='max-age=480; includeSubDomains']'",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2NS,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "appcmd_args": "list config {} /section:system.webServer/httpProtocol /xml:*",
        "appcmd_list": "list apps"
    },
    "custom_item_32": {
        "description": "Verify IIS 7.0 installed.",
        "value_data": "^Version 7\\.[0][\\s]*$",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp",
        "reg_item": "VersionString"
    },
    "custom_item_33": {
        "description": "7.14 Ensure TLS Cipher Suite ordering is configured",
        "info": "Cipher suites are a named combination of authentication, encryption, message authentication code, and key exchange algorithms used for the security settings of a network connection using TLS protocol. Clients send a cipher list and a list of ciphers that it supports in order of preference to a server. The server then replies with the cipher suite that it selects from the client cipher suite list.\n\n            Cipher suites should be ordered from strongest to weakest in order to ensure that the more secure configuration is used for encryption between the server and client.",
        "solution": "To order the cipher suites correctly, ensure the following key is set to:\n            TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P256\n            TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P256\n            TLS_RSA_WITH_AES_256_CBC_SHA\n            TLS_RSA_WITH_AES_128_CBC_SHA\n            TLS_RSA_WITH_3DES_EDE_CBC_SHA\n            HKLM\\System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002\\Functions",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P256 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P256 TLS_RSA_WITH_AES_256_CBC_SHA TLS_RSA_WITH_AES_128_CBC_SHA TLS_RSA_WITH_3DES_EDE_CBC_SHA",
        "powershell_args": "[string](Get-ItemProperty -Path hklm:System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002).Functions"
    },
    "custom_item_34": {
        "description": "Verify IIS 7.5 installed.",
        "value_data": "^Version 7\\.[5][\\s]*$",
        "reg_key": "HKLM\\Software\\Microsoft\\Inetstp",
        "reg_item": "VersionString"
    },
    "custom_item_35": {
        "description": "7.15 Ensure TLS Cipher Suite ordering is configured",
        "info": "Cipher suites are a named combination of authentication, encryption, message authentication code, and key exchange algorithms used for the security settings of a network connection using TLS protocol. Clients send a cipher list and a list of ciphers that it supports in order of preference to a server. The server then replies with the cipher suite that it selects from the client cipher suite list.\n\n            Cipher suites should be ordered from strongest to weakest in order to ensure that the more secure configuration is used for encryption between the server and client.",
        "solution": "To order the cipher suites correctly, ensure the following key is set to:\n            TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384\n            TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256\n            TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P256\n            TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256\n            TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P256\n            TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P256\n            TLS_RSA_WITH_AES_256_GCM_SHA384\n            TLS_RSA_WITH_AES_128_GCM_SHA256\n            TLS_RSA_WITH_AES_256_CBC_SHA256\n            TLS_RSA_WITH_AES_128_CBC_SHA256\n            TLS_RSA_WITH_AES_256_CBC_SHA\n            TLS_RSA_WITH_AES_128_CBC_SHA\n            TLS_RSA_WITH_3DES_EDE_CBC_SHA\n            HKLM\\System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002\\Functions",
        "reference": "800-171|3.13.11,800-53|SC-13,800-53r5|SC-13,CSF|PR.DS-5,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(iv),HIPAA|164.312(e)(2)(ii),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2",
        "see_also": "https://workbench.cisecurity.org/files/165",
        "value_data": "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P256 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA_P256 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_P256 TLS_RSA_WITH_AES_256_GCM_SHA384 TLS_RSA_WITH_AES_128_GCM_SHA256 TLS_RSA_WITH_AES_256_CBC_SHA256 TLS_RSA_WITH_AES_128_CBC_SHA256 TLS_RSA_WITH_AES_256_CBC_SHA TLS_RSA_WITH_AES_128_CBC_SHA TLS_RSA_WITH_3DES_EDE_CBC_SHA",
        "powershell_args": "[string](Get-ItemProperty -Path hklm:System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002).Functions"
    }
}