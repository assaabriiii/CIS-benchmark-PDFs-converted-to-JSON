{
    "custom_item_1": {
        "description": "1.4.2 Configure Password Encryption",
        "info": "You can enable strong, reversible 128-bit Advanced Encryption Standard (AES) password encryption, also known as type-6 encryption. To start using type-6 encryption, you must enable the AES password encryption feature and configure a master encryption key, which is used to encrypt and decrypt passwords. After you enable AES password encryption and configure a master key, all existing and newly created clear-text passwords for supported applications (currently RADIUS and TACACS+) are stored in type-6 encrypted format, unless you disable type-6 password encryption. You can also configure Cisco NX-OS to convert all existing weakly encrypted passwords to type-6 encrypted passwords.\n\nRationale:\n\nEncryption is a good way to protect data that will be used later. Encrypted data can later be decrypted to its original value. Although encrypting passwords protects them, typically, an application uses the same encryption key for storing all user passwords.\n\nImpact:\n\nEncryption of passwords is used to protect it from being sent over the wire cleartext. By applying encryption you are making it more difficult for an adversary to gain access to your device/network",
        "solution": "Configure a master key to be used with the AES password encryption feature. The key can contain between 16 and 32 alphanumeric characters\n\nswitch# key config-key ascii\nNew Master Key:\nRetype Master Key:\n\nswitch(config)# feature password encryption aes",
        "reference": "800-171|3.5.2,800-171|3.8.5,800-171|3.8.7,800-53|IA-5(1),800-53|MP-5,800-53|MP-7,800-53r5|IA-5(1),800-53r5|MP-5,800-53r5|MP-7,CN-L3|8.5.4.1(c),CSCv7|4.4,CSCv7|5.1,CSCv7|14.8,CSCv8|3.9,CSCv8|5.2,CSF|PR.AC-1,CSF|PR.PT-2,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,ITSG-33|IA-5(1),ITSG-33|MP-5,LEVEL|2M,NESA|T1.4.1,NESA|T5.2.3,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|4.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "feature password encryption aes"
    },
    "custom_item_2": {
        "description": "Check for SNMPv3 engineID",
        "item": "snmp-server engineID remote .+"
    },
    "custom_item_3": {
        "description": "Check for SNMPv3 group v3",
        "item": "snmp-server group .+ v3 .+"
    },
    "custom_item_4": {
        "description": "group v3",
        "item": "snmp-server group .+ v3 .+"
    },
    "custom_item_5": {
        "description": "engineID",
        "item": "snmp-server engineID remote .+"
    },
    "custom_item_6": {
        "description": "1.5.4 Configure SNMP Traps",
        "info": "SNMP relies on an architecture which consists of a manager and an agent. SNMP Managers can be any machine on the network that is running SNMP to collect and process information from the devices on either the LAN or WAN.\n\nRationale:\n\nUtilizing traps can alert the user of issues or compromises in advance. For example if the device is overheating or if an admin users account is being utilized during odd hours.",
        "solution": "Examples of traps\nAll notifications\n\nswitch(config)##switch(config)#snmp-server enable traps\n\nCISCO-AAA-SERVER-MIB\n\nswitch(config)#switch(config)#snmp-server enable traps aaa\n\nENITY-MIB, CISCO-ENTITY-FRU-CONTROL-MIB, CISCO-ENTITY-SENSOR-MIB\n\nswitch(config)#switch(config)#snmp-server enable traps entity\nswitch(config)#switch(config)#snmp-server enable traps entity fru\n\nCISCO-LICENSE-MGR-MIB\n\nswitch(config)#switch(config)#snmp-server enable traps license\n\nIF-MIB\n\nswitch(config)#switch(config)#snmp-server enable traps link\nswitch(config)#CISCO-PSM-MIB\nswitch(config)#switch(config)#snmp-server enable traps port-security\nswitch(config)#snmpv2-MIB\nswitch(config)#switch(config)#snmp-server enable traps switch(config)#snmp\nswitch(config)#switch(config)#snmp-server enable traps switch(config)#snmp authentication\n\nCISCO-FCC-MIB\n\nswitch(config)##switch(config)#snmp-server enable traps fcc\n\nCISCO-DM-MIB\n\nswitch(config)#snmp-server enable traps fcdomain\n\nCISCO-NS-MIB\n\nswitch(config)#snmp-server enable traps fcns\n\nCISCO-FCS-MIB\n\nswitch(config)#snmp-server enable traps fcs discovery-complete\nswitch(config)#snmp-server enable traps fcs request-reject\n\nCISCO-FDMI-MIB\n\nswitch(config)#snmp-server enable traps fdmi\n\nCISCO-FSPF-MIB\n\nswitch(config)#snmp-server enable traps fspf\n\nCISCO-PSM-MIB\n\nswitch(config)#snmp-server enable traps port-security\n\nCISCO-RSCN-MIB\n\nswitch(config)#snmp-server enable traps rscn\nswitch(config)#snmp-server enable traps rscn els\nswitch(config)#snmp-server enable traps rscn ils\n\nCISCO-ZS-MIB\n\nswitch(config)#snmp-server enable traps zone\nswitch(config)#snmp-server enable traps zone default-zone-behavior-change\nswitch(config)#snmp-server enable traps zone merge-failure\nswitch(config)#snmp-server enable traps zone merge-success\nswitch(config)#snmp-server enable traps zone request-reject\nswitch(config)#snmp-server enable traps zone unsupp-mem\n\nDefault Value:\n\nNot configured",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-171|3.14.6,800-171|3.14.7,800-53|CM-7,800-53|MA-4,800-53|SI-4,800-53|SI-4(4),800-53r5|CM-7,800-53r5|MA-4,800-53r5|SI-4,800-53r5|SI-4(4),CN-L3|7.1.2.2(c),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|5.1,CSCv8|4.6,CSCv8|13.6,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-8,CSF|PR.MA-2,CSF|PR.PT-3,CSF|RS.AN-1,CSF|RS.CO-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|CM-7,ITSG-33|MA-4,ITSG-33|SI-4,ITSG-33|SI-4(4),LEVEL|2M,NESA|M1.2.2,NESA|T2.3.4,NESA|T5.4.4,NIAv2|NS32,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.5,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "snmp-server enable traps .+"
    },
    "custom_item_7": {
        "description": "snmp-server host",
        "item": "snmp-server host .+ source-interface .+"
    },
    "custom_item_8": {
        "description": "snmp-server traps/informs",
        "item": "snmp-server source-interface (traps|informs) .+",
        "min_occurrences": "2"
    },
    "custom_item_9": {
        "description": "1.5.6 Do not Configure a Read Write SNMP Community String",
        "info": "SNMP RW (Read-Write) access allows stations with Management access to both read and write SNMP MIB objects.\n\nRationale:\n\nSNMP is typically used for monitoring specific operational characteristics of the switch. These tasks typically only require read access. Permitting RW (Read-Write) access permits SNMP to modify some SNMP values.\n\nImpact:\n\nPermitting SNMP RW Access not only allows 'write' access to some SNMP MIB Objects, which allows a malicious attacker to modify some operational characterstics of the switch. By extension this access allows a malicious actor to collect the entire configuration of the device.",
        "solution": "Only use RO groups for SNMPv2. The most common implementation is 'network-operator', because if you use the legacy syntax:\n\nswitch(config)# snmp-server communityro\n\nthe switch will translate this to the new syntax, using 'network-operator' group\n\nswitch(config)# snmp-server communitygroup network-operator\n\nDefault Value:\n\nSNMP is not configured by default. The default SNMP Groups and permissions are:\n\nswitch# sho snmp group\n\nRole: aaa-db-admin\n\n  Description: Predefined AAA DB admin, has no cli permissions. Allows RESTful A\n\nPI\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: aaa-db-operator\n\n  Description: Predefined AAA DB operator, has no cli permissions. Allows RESTfu\n\nl API\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read\n\nRole: l3-db-admin\n\n  Description: Predefined L3 DB admin, has no cli permissions. Allows RESTful AP\n\nI\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: l3-db-operator\n\n  Description: Predefined L3 DB operator, has no cli permissions. Allows RESTful\n\n API\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read\n\nRole: network-admin\n\n  Description: Predefined network admin role has access to all commands\n\n  on the switch\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: network-operator\n\n  Description: Predefined network operator role has access to all read\n\n  commands on the switch\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read\n\nRole: nxdb-admin\n\n  Description: Predefined nxdb-admin role has no cli permissions.\n\n  Allows json-rpc get and set.\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       deny    command\n\nRole: nxdb-operator\n\n  Description: Predefined nxdb-operator role has no cli permissions.\n\n  Allows json-rpc get.\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       deny    command\n\nRole: vdc-admin\n\n  Description: Predefined vdc admin role has access to all commands within\n\n  a VDC instance\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: vdc-operator\n\n  Description: Predefined vdc operator role has access to all read commands\n\n  within a VDC instance\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read\n\nRole: dev-ops\n\n  Description: Predefined system role for devops access. This role\n\n  cannot be modified.\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  6       permit  command                         conf t ; username *\n\n  5       permit  command                         attach module *\n\n  4       permit  command                         slot *\n\n  3       permit  command                         bcm module *\n\n  2       permit  command                         run bash *\n\n  1       permit  command                         python *\n\nRole: priv-15\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: priv-14\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  1       permit  read-write\n\nRole: priv-13\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-12\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-11\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-10\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-9\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-8\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-7\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-6\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-5\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-4\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-3\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-2\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-1\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\nRole: priv-0\n\n  Description: This is a system defined privilege role.\n\n  Vlan policy: permit (default)\n\n  Interface policy: permit (default)\n\n  Vrf policy: permit (default)\n\n  -------------------------------------------------------------------\n\n  Rule    Perm    Type        Scope               Entity\n\n  -------------------------------------------------------------------\n\n  10      permit  command                         traceroute6 *\n\n  9       permit  command                         traceroute *\n\n  8       permit  command                         telnet6 *\n\n  7       permit  command                         telnet *\n\n  6       permit  command                         ping6 *\n\n  5       permit  command                         ping *\n\n  4       permit  command                         ssh6 *\n\n  3       permit  command                         ssh *\n\n  2       permit  command                         enable *\n\n  1       permit  read",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.7.5,800-53|CM-7,800-53|MA-4,800-53r5|CM-7,800-53r5|MA-4,CSCv7|9.2,CSCv8|4.6,CSF|PR.IP-1,CSF|PR.MA-2,CSF|PR.PT-3,GDPR|32.1.b,HIPAA|164.306(a)(1),ITSG-33|CM-7,ITSG-33|MA-4,LEVEL|2M,NESA|T2.3.4,NESA|T5.4.4,NIAv2|SS15a,PCI-DSSv3.2.1|2.2.2,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|45.2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "snmp-server community .+ (rw|group network-admin)"
    },
    "custom_item_10": {
        "description": "logging server/source-interface",
        "item": "logging (server|source-interface) .+"
    },
    "custom_item_11": {
        "description": "logging level",
        "item": "logging level (all .+|.+ .+)"
    },
    "custom_item_12": {
        "description": "1.6.2 Log all Successful and Failed Administrative Logins",
        "info": "By default failed logins are logged, but successful logins are not logged. This makes any configuration changes or successful malicious activity difficult to correctly attribute.\n\nRationale:\n\nLogging of all device login attempts allows the security team to investigate all login attempts and successful logins as needed. In some organizations and for some switches, even successful logins will be configured to generate an alert that must be compared against authorized changes or assigned tickets. Without logging both successful and failed logins, several important components of any investigation may not be easily available for any subsequent investigation or analysis (userids, source IP addresses, login times and so on).\n\nImpact:\n\nNot logging successful logins means that unauthorized commands changes will be more difficult to attribute to the right person (though changes are logged with the login name by default on NX-OS). It also means that otherwise suspicious but successful logins (either because of the time of login, the source IP or other indicator) are not logged for further investigation.\n\nNot logging unsuccessful logins means that brute force login attempts are not properly logged.",
        "solution": "switch(config)# login level authpriv 5\n\nDefault Value:\n\nBy default failed logins are logged and successful logins are not logged.\n\nAdditional Information:\n\nThe methods in this recommendation are applicable to all NX-OS platforms. Some platforms will also support 'login on-success' and 'login on-failure' commands, but because of inconsistent support the use of these commands are not recommended.",
        "reference": "800-171|3.1.8,800-171|3.1.18,800-171|3.5.3,800-53|AC-7,800-53|AC-19,800-53|IA-2(1),800-53r5|AC-7,800-53r5|AC-19,800-53r5|IA-2(1),CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(b),CSCv7|4.9,CSCv7|16.12,CSCv8|4.10,CSCv8|6.5,CSF|PR.AC-1,CSF|PR.AC-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),ISO/IEC-27001|A.6.2.1,ITSG-33|AC-7,ITSG-33|AC-19,ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM24,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|3.2,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "login on-(failure|success) log",
        "min_occurrences": "2"
    },
    "custom_item_13": {
        "description": "Check for feature netflow",
        "item": "^feature netflow"
    },
    "custom_item_14": {
        "description": "1.6.3 Configure Netflow on Strategic Ports",
        "info": "Netflow allows for detailed logging of transit traffic. For a Layer 3 Netflow configuration, this outlines several values identified as 'keys': source and destination ports and protocols, source and destination IP addresses as well as traffic volumes in any combination. Sometimes QOS values (TOS bits only) is also used as a key. Each combination of Protocol, source port, destination port, source IP, destination IP is called a 'tuple'. The possible keys in a Layer 2 Tuple include source mac address, destination mac address, ethertype and vlan.\n\nIn most cases logging to this level is not recommended for all ports of an NX-OS device, with 10G or faster ports there is just too much data to log and process in a meaningful way, even with sampling (which is required).\n\nHowever, for strategic ports (for instance, something facing a WAN link or traffic constrained server) this can be a good tool for troubleshooting. This sort of logging does take a fair amount of host resources, so if there is an upstream firewall or router, that device is often better suited to be a Netflow initiator, but if for instance the upstream device is owned by a carrier or a client, or is a host that needs this sort of telemetry, most NX-OS devices are certainly capable of providing Netflow telemetry.\n\nOn many NX-OS platforms only inbound Netflow is supported.\n\nRationale:\n\nImpact:\n\nIf monitored graphically, often just a visual inspection of the netflow graphs will highlight anomalous traffic. For instance, a high volume exfiltration from a database server would show a spike of traffic from that database server to a host on the internet (which in most environments is not a normal pattern).\n\nIn many cases the netflow database can be queried directly, so anomalies can be queried for programmatically. However, coding 'what is not normal' is not something that is easily done in procedural languages. AI or ML frameworks such as TensorFlow may be helpful in this situation.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "If needed, either Layer 3 or Layer 2 netflow can be configured.\nLayer 3 IP and IPv6 flow monitors can be applied to VLANs, SVIs, Layer 3 routed interfaces or subinterfaces.\nLayer 2 flow monitors can be applied to a physical interface or trunks\nL3 netflow - typical application to a VLAN is shown\nFirst, enable the netflow feature:\n\nswitch(config)#feature netflow\n\nThe flow record defines what data to record and export. Typical settings are shown, the important thing is that a valid flow record setting exists:\n\nswitch(config)# flow-record FLOW-RECORD\nswitch(config-flow-record)#  match ipv4 protocol\nswitch(config-flow-record)#  match ipv4 source address\nswitch(config-flow-record)#  match ipv4 destination address\nswitch(config-flow-record)#  match transport source-port\nswitch(config-flow-record)#  match transport destination-port\nswitch(config-flow-record)#  collect routing source as\nswitch(config-flow-record)#  collect routing destination as\nswitch(config-flow-record)#  collect transport tcp flags\nswitch(config-flow-record)#  collect counter bytes\nswitch(config-flow-record)#  collect counter packets\n\nThe flow exporter defines the destination and options around sent data. Again, the specific values are not important. The VRF can be specified in the 'destination' line if needed.:\n\nswitch(config)# flow exporter FLOW-EXPORT\nswitch(config-flow-exporter)# transport udp 9996\nswitch(config-flow-exporter)# destination 10.10.10.10\nswitch(config-flow-exporter)# source mgmt 0\nswitch(config-flow-exporter)# version 9\nswitch(config-flow-exporter-version-9)# option exporter-stats timeout 120\nswitch(config-flow-exporter-version-9)# option interface-table timeout 120\n\nThe flow monitor 'ties' the exporter and record together:\n\nswitch(config)# flow monitor FLOW-MONITOR\nswitch(config-flow-monitor)# exporter FLOW-EXPORT\nswitch(config-flow-monitor)#  record FLOW-RECORD\n\nThe sampling rate, 'x packets out of y' can also be defined. Both should be a power of 2 (for instance, 8 out-of 64 is a valid combination)\n\nswitch(config)#sampler FLOWSAMPLER01\nswitch(config-flow-sampler)# mode 8 out-of 64\n\nFinally, apply the monitor and optionally the sampler to a layer 3 interface:\n\nswitch(config-flow-monitor)# int vlan10GCORE01(config-if)# ip flow monitor FLOW-MONITOR input sampler FLOWSAMPLER01\n\n=======================================\n**L2 netflow - typical application to physical interface shown **\nBecause if it's reliance on MAC Addresses, L2 netflow implementations are much less often used\n\nswitch(config)#feature netflow\n\nThe exporter configuration remains the same as L3:\n\nswitch(config)# flow exporter L2_FLOWEXPORTER01\nswitch(config-flow-exporter)# destination[use-vrf management]\nswitch(config-flow-exporter)# transport udpswitch(config-flow-exporter)# source mgmt0\nswitch(config-flow-exporter)# version 9\n\nThe flow record reflects different (layer 2) tuple inputs:\n\nswitch(config)# flow record L2_FLOWRECORD01\nswitch(config-flow-record)#  match datalink ethertype\nswitch(config-flow-record)#  match datalink mac source-address\nswitch(config-flow-record)#  match datalink mac destination-address\nswitch(config-flow-record)#  match datalink vlan\n\nThe flow monitor remains similar:\n\nswitch(config)# flow monitor L2_FLOWMONITOR01\nswitch(config-flow-monitor)# record L2_FLOWRECORD01\nswitch(config-flow-monitor)# exporter L2_FLOWEXPORTER01\n\nThe flow sampler commands remain the same\n\nswitch(config)#sampler FLOWSAMPLER01\nswitch(config-flow-sampler)# modeout-ofFinally, apply the L2 definition to an L2 interface:\n\nswitch(config)# int Ethernet x/yy\nswitch(config-if)# layer2-switched flow monitor L2_FLOWMONITOR01 input sampler FLOWSAMPLER01\n\nDefault Value:\n\nNetflow is not defined by default.",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171|3.6.1,800-171|3.14.6,800-171|3.14.7,800-53|AU-6(1),800-53|AU-7,800-53|IR-4(1),800-53|SI-4,800-53|SI-4(2),800-53|SI-4(4),800-53|SI-4(5),800-53r5|AU-6(1),800-53r5|AU-7,800-53r5|IR-4(1),800-53r5|SI-4,800-53r5|SI-4(2),800-53r5|SI-4(4),800-53r5|SI-4(5),CN-L3|7.1.2.2(c),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(d),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSCv7|6.3,CSCv8|13.1,CSCv8|13.6,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.AE-5,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|PR.PT-1,CSF|RC.RP-1,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,CSF|RS.CO-3,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(b),ITSG-33|AU-6(1),ITSG-33|AU-7,ITSG-33|IR-4(1),ITSG-33|SI-4,ITSG-33|SI-4(2),ITSG-33|SI-4(4),ITSG-33|SI-4(5),LEVEL|2M,NESA|M1.2.2,NESA|M5.2.5,NESA|T8.2.8,NESA|T8.2.9,NIAv2|NS32,PCI-DSSv4.0|10.4.1.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|6.4,SWIFT-CSCv1|6.5,TBA-FIISB|45.2.5",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "flow (exporter|record|monitor)",
        "regex": "$Manual Review Required^",
        "item": ".*"
    },
    "custom_item_15": {
        "description": "1.7.4 Configure NTP Authentication",
        "info": "By default, NTP is a clear text, unauthenticated protocol. However, it can be configured to authenticate time sources. NTP authentication is an upstream protocol only - authenticated clients have assurance that they are receiving correct time, that the ntp packets have not been tampered with.\n\nRationale:\n\nConfiguring authentication ensures that if the server key does not match the key configured on the NTP client, that the client will drop any NTP replies from that server. If multiple keys are configured,",
        "solution": "switch(config)# ntp authenticate\nswitch(config)# ntp authentication-key 42 md5 my-ntp-key\nswitch(config)# ntp trusted-key 42\nswitch(config)# ntp server 132.246.11.231 use-vrf management key 42\n\nDefault Value:\n\nBy default NTP is not configured.\nIf NTP is configured, by default it is unauthenticated.",
        "reference": "800-171|3.1.1,800-171|3.3.6,800-171|3.3.7,800-53|AC-2(1),800-53|AU-7,800-53|AU-8,800-53r5|AC-2(1),800-53r5|AU-7,800-53r5|AU-8,CN-L3|7.1.2.3(c),CN-L3|7.1.3.2(d),CN-L3|8.1.4.3(b),CSCv7|6,CSCv8|8.4,CSCv8|12.5,CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|RS.AN-3,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2(1),ITSG-33|AU-7,ITSG-33|AU-8,LEVEL|2M,NESA|T3.6.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,QCSC-v1|5.2.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,QCSC-v1|15.2,SWIFT-CSCv1|6.4,TBA-FIISB|37.4",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "ntp (authenticate|authentication-key|trusted-key|server .* key .+)",
        "min_occurrences": "4"
    },
    "custom_item_16": {
        "description": "1.8.1 Disable Power on Auto Provisioning (POAP)",
        "info": "PowerOn Auto Provisioning (POAP) allows the switch to be auto-provisioned at the time of power-on. This can be extremely useful in a tightly controlled environment, with a solid 'network as code' mindset and dev-ops procedures in place for network operations.\n\nRationale:\n\nImpact:\n\nWithout solid procedures and a well-controlled environment, POAP provides a malicious actor the ability to compromise a switch as it is being deployed out of the box. This 'day 0' approach to compromising gives the attacker control of the switch from the start - it can be difficult to detect that this has occurred, and may require physical access to gain control back.",
        "solution": "To disable POAP, use the command:\n\nswitch(config)# no boot poap enable\n\nDefault Value:\n\nPOAP is not enabled by default. The 'boot poap' configuration line does not show in the running or startup configuration if it is disabled, only if it is enabled.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|11.1,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "no boot poap enable"
    },
    "custom_item_17": {
        "description": "1.8.2 Disable iPXE (Pre-boot eXecution Environment)",
        "info": "iPXE allows a NX-OS device to boot from the network, usually using HTTP.\n\nRationale:\n\nThis method allows the switch bootup image to be controlled centrally, often using DHCP services.\n\nImpact:\n\nThe risks of using this boot method are obvious. First, DHCP is a broadcast request, so any host (including a malicious host) can provide the DHCP response - the first response 'wins'. This means that a malicious actor can control operating system being booted on the switch. In addition, the HTTP protocol is clear-text, so is susceptible to modification in transit by an attacker. This is a less likely attack however, as the NX-OS boot sequence has multiple checks in place to verify the validity of the OS, and all most succeed for the boot sequence to proceed.",
        "solution": "Setting the boot order explicity to 'bootflash' will remediate a PXE configured device.\n\nswitch(config)# boot order bootflash\n\nYou can also 'no' the current boot order line to revert to the default setting. For instance, to remove the configuration line 'boot order pxe bootflash' command, use\n\nswitch(config)# no boot order pxe bootflash\n\nDefault Value:\n\nBy default the boot order is 'bootflash' only. This default configuration will not show in the configuration.\n\nHowever, entering any valid 'boot order' in the configuration will result it that order being explicit in the configuration, so entering 'boot order bootflash' will result in that showing in the configuration.",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv7|11.3,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "boot order pxe"
    },
    "custom_item_18": {
        "description": "Check for snmp-server",
        "item": "snmp-server .+"
    },
    "custom_item_19": {
        "description": "snmp-server traps/informs",
        "item": "snmp-server source-interface (traps|informs) .+",
        "min_occurrences": "2"
    },
    "custom_item_20": {
        "description": "snmp-server host",
        "item": "snmp-server host .+ source-interface (traps|informs) .+"
    },
    "custom_item_21": {
        "description": "ntp",
        "item": "ntp source-interface .+"
    },
    "custom_item_22": {
        "description": "logging",
        "item": "logging source-interface .+"
    },
    "custom_item_23": {
        "description": "Check for eigrp",
        "item": "router eigrp .+"
    },
    "custom_item_24": {
        "description": "3.1.1.1 Configure EIGRP Authentication on all EIGRP Routing Devices",
        "info": "You can configure authentication between neighbors for EIGRP\n\nRationale:\n\nYou can configure EIGRP authentication for the EIGRP process or for individual interfaces. Interface EIGRP authentication configuration overrides the EIGRP process-level authentication configuration.\n\nBecause EIGRP is a multicast protocol, any device can advertise EIGRP capabilities and routes, and by default all connected EIGRP devices will honor those advertisements. This means that a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.\n\nFor this reason it is important that EIGRP endpoints authenticate to each other, ensuring that only valid routers can participate in the exchange of routes.",
        "solution": "Ensure that you have enabled the EIGRP feature.\nEnsure that all neighbors for an EIGRP process share the same authentication configuration, including the shared authentication key.\nCreate the key-chain for this authentication configuration. See the Cisco NX-OS Security Configuration Guide.\nEnsure that you are in the correct VDC (or use the switchto vdc command)\nConfigure authentication:\n\nswitch(config)# router eigrp [instance-tag]\nswitch(config-router)# address-family {ipv4 | ipv6} unicast\nswitch(config-router)# authentication key-chain [key-chain]\nswitch(config-router)# authentication mode md5\n\nNext assign the interface:\n\nswitch(config)# interface [interface-type slot/port]\nswitch(config-if)# router eigrp [instance-tag]\nswitch(config-if)# authentication key-chain eigrp [instance-tag key-chain]\nswitch(config-if)# authentication mode eigrp [instance-tag] md5\n\nEvery EIGRP routeable interface should be set to either passive-interface, or be configured with authentication keys.\n\nDefault Value:\n\nEIGRP is not configured by default\n\nIf configured, EIGRP authentication is not configured by default.\n\nBy default, if configured, EIGRP both advertises on and listens on all interfaces that fall into the subnets defined in the 'network' statements.",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "router eigrp .+",
        "item": "authentication (key-chain|mode)",
        "min_occurrences": "2"
    },
    "custom_item_25": {
        "description": "3.1.2.2 If Possible, Limit the BGP Routes Accepted from Peers",
        "info": "Once a BGP relationship is established, the BGP process will accept routes from any connected peers and consider those routes to be valid. For this reason, especially in ISP or other carrier situations, it is important that only routes that are valid for any particular peer are accepted for that peer.\n\nRationale:\n\nImpact:\n\nWithout configuring route filtering, any route advertised by any BGP peer is considered valid. For this reason, especially in carrier or ISP situations it is important that route filtering be configured. Without filtering, a misconfigured or compromised peer can easily advertise entire subnets that should be routed elsewhere, either routing them to nul or receiving traffic to the compromised subnet for for interception or modification, then forwarding it on to it's final destination.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "First, define the subnets that will be permitted from the peer PEERNAME (use descriptive, self documenting names in NX-OS constructions where possible). Note that any subnets not listed as permitted are by default denied (there is an implicit 'deny all' at the bottom of the list)\n\nswitch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS description Permitted Subnets from Peer PEERNAME\nswitch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS permit 10.11.11.0/24\nswitch(config)# ip prefix-list PL_PEERNAME_PERMIT_SUBNETS permit 10.11.12.0/24\n\nIn this example above, only 'permits' are defined. Deny lines are also allowed - refusing routes that are not accepted (for instance 'bogon' or 'martian' subnets), and may be more important in some situations, for example if this switch is accepting routes from the public internet. (note that this is not typical deployment scenario for an NX-OS switch)\nNext, create the route-map, will will apply that list:\n\nswitch(config)# route-map RM_BGP_PEERNAME_IN permit 10\nswitch(config-route-map)#   match ip address prefix-list PL_PEERNAME_PERMIT_SUBNETS\n\nFinally, within the BGP configuration, apply that route-map to the BGP peer definition. Note that the 'in' keyword denotes inbound (accepted) information.:\n\nswitch(config)# router bgp 65520\nswitch(config-router)#   router-id 10.10.10.10\nswitch(config-router)#   address-family ipv4 unicast\nswitch(config-router-af)#     network 10.10.10.0/24\nswitch(config-router-af)#   neighbor 10.10.10.11\nswitch(config-router-neighbor)#     remote-as 65521\nswitch(config-router-neighbor)#     address-family ipv4 unicast\nswitch(config-router-neighbor-af)#      route-map RM_BGP_PEERNAME_IN in\n\nDefault Value:\n\nBGP filtering is not enabled by default. By default, all routes received from defined peers are accepted as valid.",
        "context": "router bgp .+",
        "regex": "$Manual Review Required^",
        "item": "route-map .+ in"
    },
    "custom_item_26": {
        "description": "3.1.2.3 Configure BGP Authentication",
        "info": "BGP is a usually configured as a point-to-point / unicast protocol. Configuring authentication as part of the neighbor configuration adds an additional layer of security to the conversation.\n\nRationale:\n\nImpact:\n\nConfiguring authentication adds an MD5 hash to the neighbor negotiation that occurs between two BGP peers. An authentication failure would indicate either a misconfiguration, or possibly an attacker mounting an impersonation attack, masquerading as the BGP peer (possibly by ARP cache poisoning attack) and attempting to then peer up with incorrect credentials.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each BGP neighbor, add the 'password' command to the matching stanza, with a long and complex string. Note that the same password must be used on the matching peer.\nDifferent passwords should be used for each peer.\n\nswitch(config)# router bgp 65520\nswitch(config-router)# neigh 10.10.10.11\nswitch(config-router-neighbor)# password ?\n  0     Specifies an UNENCRYPTED neighbor password will follow\n  3     Specifies an 3DES ENCRYPTED neighbor password will follow\n  7     Specifies a Cisco type 7  ENCRYPTED neighbor password will follow\n  LINE  The UNENCRYPTED (cleartext) neighbor password\n\nswitch(config-router-neighbor)# password somelongcomplexstring\n\nDefault Value:\n\nBy default, BGP authentication is not enabled.",
        "context": "router bgp .+",
        "regex": "$Manual Review Required^",
        "item": "password .+"
    },
    "custom_item_27": {
        "description": "Check for router ospf",
        "item": "router ospf"
    },
    "custom_item_28": {
        "description": "3.1.3.2 Authenticate OSPF peers with MD5 authentication keys",
        "info": "If OSPF is configured, peers can be authenticated using keys. This is not configured by default. If configured, MD5 hashes are recommended as the authentication mechanism. MD5 is the best option for multi-vendor support, and is also the best cryptographic option available in the OSPF standard.\n\nRationale:\n\nImpact:\n\nBecause OSPF is a multicast protocol, any device can advertise OSPF capabilities and routes, and by default all connected OSPF devices will honor those advertisements. This means that a malicious actor can advertise bogus routes to valid hosts or networks, allowing the interception and modification of traffic intended for those hosts or subnets.\n\nFor this reason it is important that OSPF endpoints authenticate to each other, ensuring that only valid routers can participate in the exchange of routes.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "For each OSPF routeable interface, set the message-digest authentication method, and assign the appropriate keychain.\nEach OSPF routeable interface should either have authentication configured or be configured as an OSPF passive interface.\n\nswitch(config)# interface Vlan1\nswitch(config-int)# ip ospf authentication message-digest\nswitch(config-int)#  ip ospf authentication key-chainDefault Value:\n\nBy default, OSPF authentication is not enabled by default.",
        "reference": "800-171|3.1.13,800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-171|3.5.2,800-171|3.13.8,800-53|AC-17(2),800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53|IA-5,800-53|IA-5(1),800-53|SC-8,800-53|SC-8(1),800-53r5|AC-17(2),800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,800-53r5|IA-5,800-53r5|IA-5(1),800-53r5|SC-8,800-53r5|SC-8(1),CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.1(c),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv7|11,CSCv8|3.10,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.a,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),HIPAA|164.312(a)(2)(i),HIPAA|164.312(d),HIPAA|164.312(e)(1),HIPAA|164.312(e)(2)(i),ISO/IEC-27001|A.6.2.2,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|AC-17(2),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,ITSG-33|IA-5,ITSG-33|IA-5(1),ITSG-33|SC-8,ITSG-33|SC-8a.,ITSG-33|SC-8(1),LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T5.2.3,NESA|T5.4.2,NESA|T7.3.3,NESA|T7.4.1,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|AM37,NIAv2|IE8,NIAv2|IE9,NIAv2|IE12,NIAv2|NS5d,NIAv2|NS6b,NIAv2|NS29,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,NIAv2|SS24,PCI-DSSv3.2.1|2.2.2,PCI-DSSv3.2.1|2.3,PCI-DSSv3.2.1|4.1,PCI-DSSv4.0|2.2.7,PCI-DSSv4.0|4.2.1,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|13.2,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.3,SWIFT-CSCv1|2.6,SWIFT-CSCv1|4.1,TBA-FIISB|29.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "interface .+",
        "regex": "$Manual Review Required^",
        "item": "ip ospf authentication (message-digest|key-chain)"
    },
    "custom_item_29": {
        "description": "3.1.4.2 Create and use a single Loopback Address for Routing Protocol Peering",
        "info": "The use of a loopback interface is recommended for use in all routing protocols. This recommendation describes the configuration of the loopback interface. Routing protocol specific configurations are described under the respective routing protocols.\n\nRationale:\n\nLoopback interfaces are always up, and so are not dependent on physical interface link state issues (cabling or other link issues for instance). This means traffic sourced from a loopback interface can take any valid path to establish a routing relationship or to route traffic. Loopback interfaces by their nature cannot 'flap' (toggle between up and down states). Depending on the error condition, most physical interfaces are susceptible to interface flapping.\n\nImpact:\n\nUsing a loopback interface makes a routing device much less susceptible to intermittent or permanent interface failures.",
        "solution": "Creating the loopback interface is a simple process. Addressing the loopback, in particular computing the subnet mask will vary by the organization and application. Often smaller subnets can be used for loopbacks, depending on how many potential peers are possible.\n\nswitch(config)# int loopback 0\nswitch(config-if)# ip address 10.11.11.1 255.255.255.252\n\nIn order to use the loopback interface (rather than the closest interface to the routing peer), it must be explicitly configured in the routing protocol. This is described in the recommendations for each respective routing protocol.\n\nDefault Value:\n\nBy default no loopback interfaces are created on NX-OS devices.",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "item": "interface loopback.+",
        "max_occurrences": "1"
    },
    "custom_item_30": {
        "description": "3.1.4.3 Use Unicast Routing Protocols Only",
        "info": "Unicast routing protocols describe the destination routing peers by IP address. Multicast and Broadcast based routing protocols will discover routing neighbors dynamically. Because of this discovery process, a malicious actor can much more easily establish a peering relationship and hijack the routing protocol.\n\nRationale:\n\nWhile most routing protocols can be configured with authentication, multicast and broadcast routing protocols have an inherent weakness in their 'trust' of any neighbor that advertises or will answer an advertisment.\n\nImpact:\n\nIn multicast and broadcast routing protocols, the router (in this case the NX-OS device) will advertise its presence to all devices on a subnet, soliciting other routers using that same protocol. In that situation, an attacker can simply reply to those advertisements and establish a peering relationship. At that point the attacker can inject any route desired, so that traffic for that destination will route through the malicious router, putting the attacker in a 'monkey in the middle' position, able to eavesdrop on or change any traffic to or from that destination, then forward it on. Tools such as scapy have well-established attack scripts for most broadcast or multicast routing protocols.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Configure unicast routing only, for instance BGP.",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "router (bgp|eigrp|rip|ospf)",
        "regex": "$Manual Review Required^",
        "item": ".*ulticast.*"
    },
    "custom_item_31": {
        "description": "3.3.2 Configure Storm Control",
        "info": "Traffic storm control (also called traffic suppression) allows you to monitor the levels of the incoming broadcast, multicast, and unicast traffic over a 3.9-millisecond interval. During this interval, the traffic level, which is a percentage of the total available bandwidth of the port, is compared with the traffic storm control level that you configured. When the ingress traffic reaches the traffic storm control level that is configured on the port, traffic storm control drops the traffic until the interval ends.\n\nRationale:\n\nWhen the traffic exceeds the configured level, you can configure traffic storm control to perform the following optional corrective actions :\n\nShut down-When ingress traffic exceeds the traffic storm control level that is configured on a port, traffic storm control puts the port into the error-disabled state. To reenable this port, you can use either the shutdown and no shutdown options on the configured interface, or the error-disable detection and recovery feature. You are recommended to use the errdisable recovery cause storm-control command for error-disable detection and recovery along with the errdisable recovery interval command for defining the recovery interval. The interval can range between 30 and 65535 seconds.\n\nTrap-You can configure traffic storm control to generate an SNMP trap when ingress traffic exceeds the configured traffic storm control level. The SNMP trap action is enabled by default. However, storm control traps are not rate-limited by default. You can control the number of traps generated per minute by using the snmp-server enable traps storm-control trap-rate command.\n\nImpact:\n\nThis configuration is normally non-impactful - host network interfaces operating normally do not broadcast at the levels that are normally set in this command.\n\nThis command is primarily meant to protect the switch and more importantly other hosts in a broadcast domain (VLAN) from a network interface that is malfunctioning, either due to a hardware failure or a driver problem.\n\nNote however that this protection can prevent some malicious activity, for instance VLAN wide DOS attacks, higher volume ARP Cache Poisoning attacks and CAM Table overflow attacks.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "To set the broadcast limit in percent (multicast limit shown):\n\nswitch(config)# interface ethernet 1/1\nswitch(config)# storm-control multicast level 10\n\nor to set in packets per second (broadcast limit shown)\n\nswitch(config)# storm-control broadcast level pps 8000\n\nConfigure to send SNMP trap if a broadcast limit is exceeded\n\nswitch(config-if)# storm-control action trap\n\nor to place an interface into an ERR-DISABLE state if a broadcast limit is exceeded:\n\nswitch(config-if)# storm-control action disable\n\nDefault Value:\n\nnot enabled",
        "reference": "800-171|3.3.1,800-171|3.3.2,800-171|3.3.6,800-171|3.4.6,800-171|3.4.7,800-171|3.6.1,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-171|3.14.6,800-171|3.14.7,800-53|AU-6(1),800-53|AU-7,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|IR-4(1),800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53|SI-4,800-53|SI-4(2),800-53|SI-4(4),800-53|SI-4(5),800-53r5|AU-6(1),800-53r5|AU-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|IR-4(1),800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,800-53r5|SI-4,800-53r5|SI-4(2),800-53r5|SI-4(4),800-53r5|SI-4(5),CN-L3|7.1.2.2(c),CN-L3|7.1.2.3(c),CN-L3|7.1.3.3(d),CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CN-L3|8.1.10.6(j),CSCv7|11,CSCv8|12.2,CSCv8|13.1,CSCv8|13.3,CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.AE-5,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.AM-3,CSF|ID.RA-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.IP-8,CSF|PR.PT-1,CSF|PR.PT-3,CSF|PR.PT-4,CSF|RC.RP-1,CSF|RS.AN-1,CSF|RS.AN-3,CSF|RS.CO-2,CSF|RS.CO-3,CSF|RS.RP-1,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),HIPAA|164.312(b),ISO/IEC-27001|A.13.1.3,ITSG-33|AU-6(1),ITSG-33|AU-7,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|IR-4(1),ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,ITSG-33|SI-4,ITSG-33|SI-4(2),ITSG-33|SI-4(4),ITSG-33|SI-4(5),LEVEL|2M,NESA|M1.2.2,NESA|M5.2.5,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NESA|T8.2.8,NESA|T8.2.9,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|NS32,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,PCI-DSSv4.0|10.4.1.1,QCSC-v1|3.2,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,QCSC-v1|11.2,QCSC-v1|13.2,SWIFT-CSCv1|2.3,SWIFT-CSCv1|6.4,SWIFT-CSCv1|6.5,TBA-FIISB|43.1,TBA-FIISB|45.2.5",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "interface .+",
        "regex": "$Manual Review Required^",
        "item": "storm-control .+"
    },
    "custom_item_32": {
        "description": "Check for feature cdp",
        "item": "^feature cdp"
    },
    "custom_item_33": {
        "description": "3.4.2 Configure CDP",
        "info": "The Cisco Discovery Protocol (CDP) is a media-independent and protocol-independent protocol that runs on all Cisco-manufactured equipment including routers, bridges, access and communication servers, and switches. You can use CDP to discover and view information about all the Cisco devices that are directly attached to the device.\n\nEach device that you configure for CDP sends periodic advertisements to a multicast address. Each device advertises at least one address at which it can receive SNMP messages. The advertisements also contain hold-time information, which indicates the length of time that a receiving device should hold CDP information before removing it. You can configure the advertisement or refresh timer and the hold timer.\n\nCDP advertises potentially sensitive information, including the current version of NX-OS. For this reason it is recommended that CDP be disabled on any link that links to equipment not owned by your organization. In more sensitive environments, in particular in carrier or cloud services environments (where the majority of the endpoints are customer controlled hosts), it is recommended to disable CDP entirely\n\nRationale:\n\nCDP advertises potentially sensitive information, including the current version of NX-OS. This information can be used by a malicious actor to identify which vulnerabilities exist on the device, and from there which exploits might be most effective to compromise it. For this reason, enabling CDP is generally not recommended except for troubleshooting or network discovery purposes. In particular, any ports connected to service provider gear, or any system not owned by your organization should have CDP explicitly disabled.\n\nIn more sensitive environments, disable CDP globally.\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Enabling CDP Globally\n\nswitch(config)# cdp enable\n\nEnabling on one interface\n\nswitch(config)# int Ethernet x/y\nswitch(config-if)# cdp enable\n\nTo disable CDP globally:\n\nswitch(config-if)# no cdp enable\n\nTo disable CDP on one interface only:\n\nswitch(config)# int Ethernet x/y\nswitch(config-if)# no cdp enable\n\nDefault Value:\n\nCDP is enabled by default, and is enabled on all interfaces by default.",
        "reference": "800-171|3.4.6,800-171|3.4.7,800-171|3.13.1,800-171|3.13.2,800-171|3.13.5,800-53|CM-7,800-53|CP-6,800-53|CP-7,800-53|PL-8,800-53|PM-7,800-53|SA-8,800-53|SC-7,800-53r5|CM-7,800-53r5|CP-6,800-53r5|CP-7,800-53r5|PL-8,800-53r5|PM-7,800-53r5|SA-8,800-53r5|SC-7,CN-L3|8.1.10.6(j),CSCv7|11,CSCv8|12.2,CSF|DE.CM-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-1,CSF|PR.IP-2,CSF|PR.IP-4,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,GDPR|32.1.c,GDPR|32.1.d,HIPAA|164.306(a)(1),ISO/IEC-27001|A.13.1.3,ITSG-33|CM-7,ITSG-33|CP-6,ITSG-33|CP-7,ITSG-33|SA-8,ITSG-33|SA-8a.,ITSG-33|SC-7,LEVEL|2M,NESA|T2.2.4,NESA|T3.4.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T7.6.5,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,NIAv2|SS3,NIAv2|SS15a,NIAv2|VL2,PCI-DSSv3.2.1|1.1,PCI-DSSv3.2.1|1.2,PCI-DSSv3.2.1|1.2.1,PCI-DSSv3.2.1|1.3,PCI-DSSv3.2.1|2.2.2,PCI-DSSv4.0|1.2.1,PCI-DSSv4.0|1.4.1,QCSC-v1|4.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|5.2.3,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|10.2.1,SWIFT-CSCv1|2.3,TBA-FIISB|43.1",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "interface .+",
        "regex": "$Manual Review Required^",
        "item": "^cdp enable"
    },
    "custom_item_34": {
        "description": "Check for feature fcoe",
        "item": "^feature fcoe"
    },
    "custom_item_35": {
        "description": "3.5.1 Basic Fiber Channel Configuration",
        "info": "Fibre Channel over Ethernet (FCoE) encapsulation allows a physical Ethernet cable to carry standard Fibre Channel traffic within Ethernet frames. In Cisco Nexus devices, an FCoE-capable physical Ethernet interface can carry traffic for one virtual Fibre Channel (vFC) interface. If FCoE functionality is not required, this functionality should be disabled. Note also that this is a licensed feature, so is not available without a purchased license.\n\nRationale:\n\nNOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.",
        "solution": "Enable the FCoE feature globally on the switch:\n\nswitch(config)# feature fcoe\nFC license checked out successfully\n\nfc_plugin extracted successfully\nFC plugin loaded successfully\nFCoE manager enabled successfully\nFC enabled on all modules successfully\nWarning: Ensure class-fcoe is included in qos policy-maps of all types\n\nEnable FCoE on a specific port (not required on all models):\n\nswitch(config)# interface ethernet x/y\nswitch(config-if)# fcoe mode on\n\nset the priority flow mode on a specific port:\n\nswitch(config-if)# priority-flow-control mode auto\n\nFCoE also requires the DCBX (Data Center Bridging Exchange) protocol, which is used to negotiate capabilities between the FCOE endpoints. DCBX is an extension of LLDP, and LLDP is enabled globally and on all interfaces by default.\nIf LLDP is disabled on any particular interface, it can be re-enabled as:\n\nswitch(config-if)# int Ethernet x/y\nswitch(config-if)# lldp transmit\nswitch(config-if)# lldp receive\n\nDefault Value:\n\nThe FCoE feature is not enabled by default. LLDP is enabled globally and on all interfaces by default, so if FCoE is enabled then DCBX is enabled by default",
        "reference": "800-171|3.1.16,800-171|3.1.17,800-171|3.4.1,800-171|3.4.2,800-171|3.4.6,800-171|3.4.7,800-53|AC-18,800-53|AC-18(1),800-53|AC-18(3),800-53|CM-2,800-53|CM-6,800-53|CM-7,800-53|CM-7(1),800-53|CM-9,800-53r5|AC-18,800-53r5|AC-18(1),800-53r5|AC-18(3),800-53r5|CM-2,800-53r5|CM-6,800-53r5|CM-7,800-53r5|CM-7(1),800-53r5|CM-9,CSCv7|11.1,CSCv8|4.2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,CSF|PR.PT-3,CSF|PR.PT-4,GDPR|32.1.b,HIPAA|164.306(a)(1),HIPAA|164.312(a)(1),ITSG-33|AC-18,ITSG-33|AC-18(1),ITSG-33|AC-18(3),ITSG-33|CM-2,ITSG-33|CM-6,ITSG-33|CM-7,ITSG-33|CM-7(1),ITSG-33|CM-9,LEVEL|2M,NESA|T1.2.1,NESA|T1.2.2,NESA|T3.2.5,NESA|T5.4.2,NESA|T7.5.1,NESA|T7.5.3,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|NS33,NIAv2|NS34,NIAv2|NS38,NIAv2|SS15a,NIAv2|SS16,PCI-DSSv3.2.1|2.2.2,QCSC-v1|3.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,SWIFT-CSCv1|2.3",
        "see_also": "https://workbench.cisecurity.org/benchmarks/6524",
        "context": "interface .+",
        "regex": "$Manual Review Required^",
        "item": "(fcoe mode on|priority-flow-control mode auto|lddp)"
    },
    "custom_item_36": {
        "description": "vsan database",
        "context": "vsan database",
        "regex": "$Manual Review Required^",
        "item": "vsan .+"
    },
    "custom_item_37": {
        "description": "interface vfc",
        "context": "interface vfc .+",
        "regex": "$Manual Review Required^",
        "item": "bind .+"
    }
}